{"shortInfo":{"title":"Hexo文章中图片的点击放大fancyBox效果添加过程记录","cover":"\\self_server\\assets\\images\\default_cover2.jpg","date":"2022-06-02T06:51:44.000Z","tags":["Hexo","fancybox"],"hideAtIndex":true,"categories":"前端","id":3804516115,"countWords":298,"readSeconds":29.8,"assetsbaseUrl":"/self_server/assets/"},"content":"# Hexo文章中图片的点击放大fancyBox效果添加过程记录\r\n* 根据文档应该在post模板head中添加:\r\n```html\r\n<script src=\"https://code.jquery.com/jquery-3.3.1.min.js\"></script>\r\n\r\n<link  href=\"/path/to/jquery.fancybox.min.css\" rel=\"stylesheet\">\r\n<script src=\"/path/to/jquery.fancybox.min.js\"></script>\r\n\r\n```\r\n\r\n* 根据文档需要有以下代码才能使图片有点击放大查看的效果\r\n```html\r\n<a data-fancybox=\"gallery\" href=\"big_1.jpg\">\r\n    <img src=\"small_1.jpg\">\r\n</a>\r\n```\r\n\r\n* 于是找到`node_modules/hexo-renderer-marked/renderer.js`文件，修改代码\r\n    * 该文件负责将Markdown转换为html标签\r\n    * 如负责将`![text](/path/to/image.jpg)` 转换为 `<img src=\"/blog/path/to/image.jpg\" alt=\"text\">`\r\n\r\n```js\r\n// Prepend root to image path\r\n  image(href, title, text) {\r\n    const { hexo, options } = this;\r\n    const { relative_link } = hexo.config;\r\n    const { lazyload, prependRoot, postPath } = options;\r\n\r\n    if (!/^(#|\\/\\/|http(s)?:)/.test(href) && !relative_link && prependRoot) {\r\n      if (!href.startsWith('/') && !href.startsWith('\\\\') && postPath) {\r\n        const PostAsset = hexo.model('PostAsset');\r\n        // findById requires forward slash\r\n        const asset = PostAsset.findById(join(postPath, href.replace(/\\\\/g, '/')));\r\n        // asset.path is backward slash in Windows\r\n        if (asset) href = asset.path.replace(/\\\\/g, '/');\r\n      }\r\n      href = url_for.call(hexo, href);\r\n    }\r\n\r\n    //原版代码\r\n    // let out = `<img src=\"${encodeURL(href)}\"`;\r\n    // if (text) out += ` alt=\"${text}\"`;\r\n    // if (title) out += ` title=\"${title}\"`;\r\n    // if (lazyload) out += ' loading=\"lazy\"';\r\n    // out += '>';\r\n    // return out;\r\n\r\n    //为gallery效果而改的代码\r\n    let out = `<a data-fancybox=\"gallery\" href=\"${encodeURL(href)}\"><img src=\"${encodeURL(href)}\"`;\r\n    if (text) out += ` alt=\"${text}\"`;\r\n    if (title) out += ` title=\"${title}\"`;\r\n    if (lazyload) out += ' loading=\"lazy\"';\r\n    out += '></a>';\r\n    \r\n    return out;\r\n\r\n  }\r\n\r\n```\r\n"}