---
title: FOC算法学习与实现笔记-01.克拉克变换
shortTitle: 01.克拉克变换
date: 2024-07-26T23:39:00
article: false 
index: true
---

## 克拉克变换

> 实际上，完成克拉克变换后得到的α和β值，描述的是电机定子内的磁场（力矩和方向）

- 克拉克变换就是把相位差为120度的三相电映射到二维平面上。
- 具体做法就是把三相电看成三个矢量（也反映了三个方向的磁场强度）
- 把三个矢量相加得到一个矢量（也反应了定子产生磁场的方向和强度）
- 这个矢量只需要用两个量（α、β）来表示。

> 电机内三相电的波形和磁场方向
![Alt text](assets/images/21143207_664c3fe74784749626.gif)

> 克拉克变换后电机，α和β的波形和磁场方向
![Alt text](assets/images/21143207_664c3fe79a86d45167.gif)

> 克拉克变换的本质就是把三个矢量相加  
![Alt text](assets/images/2019070809513621.gif)

### 基本形式

#### 基本形式的推导

![Alt text](assets/images/image-1.png)

- 这个推导过程很简单
- 就是分别计算三个分量作用在α轴、β轴上的值。
- 如
  - ia
    - 作用在α轴上 $I_α = \cos{0} * i_a$
    - 作用在β轴上 $I_β = \sin{0} * i_a$
  - ib
    - 作用在α轴上 $I_α= \cos{120} * i_b$
    - 作用在β轴上 $I_β = \sin{120} * i_b$
  - ic
    - 作用在α轴上 $I_α=\cos{-120} * i_c$
    - 作用在β轴上 $I_β=\sin{-120} * i_c$

代数形式：

$$

I_\alpha  = \cos{0\degree} * i_a + \cos{120\degree} * i_b + \cos{240\degree}* i_c  \\
I_\beta   = \sin{0\degree} * i_a + \sin{120\degree} * i_b + \sin{240\degree}* i_c  \\
$$

矩阵形式为：

$$
\left[
    \begin{matrix}
        I_\alpha \\
        I_\beta
    \end{matrix}
\right]
=
\left[
    \begin{matrix}
        \cos{0\degree} & \cos{120\degree} & \cos{240\degree} \\
        \sin{0\degree} & \sin{120\degree} & \sin{240\degree} \\
    \end{matrix}
\right]
\left[
    \begin{matrix}
        i_a \\
        i_b \\
        i_c \\
    \end{matrix}
\right]

$$

> 上面这里特意写成三角函数，因为感觉形式比较优美

简化后的矩阵形式为：

$$
\left[
    \begin{matrix}
        I_\alpha \\
        I_\beta
    \end{matrix}
\right]
=
\left[
    \begin{matrix}
        1 & -\frac{1}{2} & -\frac{1}{2} \\
        0 & \frac{\sqrt{3}}{2} & -\frac{\sqrt{3}}{2} \\
    \end{matrix}
\right]
\left[
    \begin{matrix}
        i_a \\
        i_b \\
        i_c \\
    \end{matrix}
\right]
$$

#### 基本形式的化简

还可以利用基尔霍夫电流定律进一步化简：

$$
i_a+i_b+i_c=0 \\
i_c=-(i_a+i_b)
$$
变换矩阵
$$
\left[
    \begin{matrix}
        I_\alpha \\
        I_\beta
    \end{matrix}
\right]
=
\left[
    \begin{matrix}
        \cos{0\degree} & \cos{120\degree} & \cos{240\degree} \\
        \sin{0\degree} & \sin{120\degree} & \sin{240\degree} \\
    \end{matrix}
\right]
\left[
    \begin{matrix}
        i_a \\
        i_b \\
        -(i_a+i_b) \\
    \end{matrix}
\right]
$$
展开计算
$$
I_\alpha  = \cos{0\degree} * i_a + \cos{120\degree} * i_b + \cos{240\degree}* -(i_a+i_b)  \\
I_\beta   = \sin{0\degree} * i_a + \sin{120\degree} * i_b + \sin{240\degree}* -(i_a+i_b)  \\
$$
简化计算
$$
I_\alpha  = (\cos{0\degree}-\cos{240\degree}) * i_a + (\cos{120\degree}-\cos{240\degree}) * i_b  \\
I_\beta   = (\sin{0\degree}-\sin{240\degree}) * i_a + (\sin{120\degree}-\sin{240\degree}) * i_b  \\
$$
最终矩阵形式：
$$

\left[
    \begin{matrix}
        I_\alpha \\
        I_\beta
    \end{matrix}
\right]
=
\left[
    \begin{matrix}
         (\cos{0\degree}-\cos{240\degree}) & (\cos{120\degree}-\cos{240\degree}) \\
        (\sin{0\degree}-\sin{240\degree}) & (\sin{120\degree}-\sin{240\degree}) \\
    \end{matrix}
\right]
\left[
    \begin{matrix}
        i_a \\
        i_b \\
    \end{matrix}
\right]
$$

三角函数计算：

- $\cos{0^\circ} = 1$
- $\cos{120^\circ} = -\frac{1}{2}$
- $\cos{240^\circ} = -\frac{1}{2}$
- $\sin{0^\circ} = 0$
- $\sin{120^\circ} = \frac{\sqrt{3}}{2}$
- $\sin{240^\circ} = -\frac{\sqrt{3}}{2}$

因此，

$$
\begin{bmatrix}
   I_\alpha \\
   I_\beta
\end{bmatrix}
=
\begin{bmatrix}
   (1 + \frac{1}{2}) & (-\frac{1}{2} + \frac{1}{2}) \\
   (0 + \frac{\sqrt{3}}{2}) & (\frac{\sqrt{3}}{2} + \frac{\sqrt{3}}{2})
\end{bmatrix}
\begin{bmatrix}
   i_a \\
   i_b
\end{bmatrix}
$$

==简化后得到==：

$$
\begin{bmatrix}
   I_\alpha \\
   I_\beta
\end{bmatrix}
=
\begin{bmatrix}
   \frac{3}{2} & 0 \\
   \frac{\sqrt{3}}{2} & \sqrt{3}
\end{bmatrix}
\begin{bmatrix}
   i_a \\
   i_b
\end{bmatrix}
$$

#### 基本形式的逆变换

为了找到给定矩阵的逆矩阵，我们首先需要计算原始矩阵。给定的矩阵为:

$$
\mathbf{A} =
\left[
    \begin{matrix}
        \frac{3}{2} & 0 \\
        \frac{\sqrt{3}}{2} & \sqrt{3}
    \end{matrix}
\right]
$$

接下来，我们需要找到这个矩阵的逆矩阵。对于一个2x2矩阵 $\mathbf{A} = \left[\begin{matrix}a & b \\ c & d\end{matrix}\right]$，其逆矩阵 $\mathbf{A}^{-1}$ 可以通过以下公式计算:

$$
\mathbf{A}^{-1} = \frac{1}{ad-bc} \left[\begin{matrix}d & -b \\ -c & a\end{matrix}\right]
$$

因此, 对于我们的矩阵 $\mathbf{A}$:

$$
\mathbf{A}^{-1} =
\frac{1}{
    \left(
        \frac{3}{2}
    \right)
    \left(
        \sqrt{3}
    \right)
    -
    \left(
        \frac{\sqrt{3}}{2}
    \right)
    \left(
        0
    \right)
    }
\left[
    \begin{matrix}
    \sqrt{3} & 0 \\
    -\frac{\sqrt{3}}{2} & \frac{3}{2}
    \end{matrix}
\right]
$$

$$
\mathbf{A}^{-1} = \frac{1}{\frac{3\sqrt{3}}{2}} \left[\begin{matrix}\sqrt{3} & 0 \\ -\frac{\sqrt{3}}{2} & \frac{3}{2}\end{matrix}\right]
$$

$$
\mathbf{A}^{-1} = \frac{2}{3\sqrt{3}} \left[\begin{matrix}\sqrt{3} & 0 \\ -\frac{\sqrt{3}}{2} & \frac{3}{2}\end{matrix}\right]
$$

$$
\mathbf{A}^{-1} = \frac{2}{3\sqrt{3}} \cdot \frac{\sqrt{3}}{\sqrt{3}} \left[\begin{matrix}\sqrt{3} & 0 \\ -\frac{\sqrt{3}}{2} & \frac{3}{2}\end{matrix}\right]
$$

$$
\mathbf{A}^{-1} = \frac{2}{3\cdot3} \left[\begin{matrix}3 & 0 \\ -\frac{3}{2} & \frac{3\sqrt{3}}{2}\end{matrix}\right]
$$

$$
\mathbf{A}^{-1} = \frac{2}{9} \left[\begin{matrix}3 & 0 \\ -\frac{3}{2} & \frac{3\sqrt{3}}{2}\end{matrix}\right]
$$

$$
\mathbf{A}^{-1} = \left[\begin{matrix}\frac{2}{3} & 0 \\ -\frac{1}{3} & \frac{\sqrt{3}}{3}\end{matrix}\right]
$$

因此, 原始矩阵的==逆矩阵==为:

$$
\mathbf{A}^{-1} =
\left[
    \begin{matrix}
        \frac{2}{3} & 0 \\
        -\frac{1}{3} & \frac{\sqrt{3}}{3}
    \end{matrix}
\right]
$$

因此, 基本形式的逆变换为:

$$
\begin{align*}
  \begin{bmatrix}
     i_a \\
     i_b
  \end{bmatrix}
  &=
  \begin{bmatrix}
      \frac{2}{3} & 0 \\
      -\frac{1}{3} & \frac{\sqrt{3}}{3}
  \end{bmatrix}
  \begin{bmatrix}
     I_\alpha \\
     I_\beta
  \end{bmatrix}\\
  i_c &= -(i_a + i_b)\\
\end{align*}
$$

### 等幅值形式

#### 等幅值形式的推导

- 简单来说，就是添加了一个系数，使得变换前后的电流的幅值都为1
- 先假设流入A相电流1A，则根据基尔霍夫电流定律，流出B相、C相的电流为-1/2A
- 求得Iα为3/2

$$
\left[
    \begin{matrix}
        I_\alpha=\frac{3}{2} \\
        I_\beta=0
    \end{matrix}
\right]

=

\left[
    \begin{matrix}
        \cos{0\degree} & \cos{120\degree} & \cos{240\degree} \\
        \sin{0\degree} & \sin{120\degree} & \sin{240\degree} \\
    \end{matrix}
\right]

\left[
    \begin{matrix}
        i_a=1 \\
        i_b=-\frac{1}{2} \\
        i_c=-\frac{1}{2} \\
    \end{matrix}
\right]
$$

- 为了让幅值相同，所以等式右边乘上一个2/3

$$
\left[
    \begin{matrix}
        I_\alpha=1 \\
        I_\beta=0
    \end{matrix}
\right]
=
\frac{2}{3}
\left[
    \begin{matrix}
        \cos{0\degree} & \cos{120\degree} & \cos{240\degree} \\
        \sin{0\degree} & \sin{120\degree} & \sin{240\degree} \\
    \end{matrix}
\right]

\left[
    \begin{matrix}
        i_a=1 \\
        i_b=-\frac{1}{2} \\
        i_c=-\frac{1}{2} \\
    \end{matrix}
\right]
$$

- 所以得到克拉克变换的 ==等幅值形式== ：

$$
\left[
    \begin{matrix}
        I_\alpha \\
        I_\beta
    \end{matrix}
\right]
=
\frac{2}{3}
\left[
    \begin{matrix}
        \cos{0\degree} & \cos{120\degree} & \cos{240\degree} \\
        \sin{0\degree} & \sin{120\degree} & \sin{240\degree} \\
    \end{matrix}
\right]

\left[
    \begin{matrix}
        i_a \\
        i_b \\
        i_c \\
    \end{matrix}
\right]

\\

\left[
    \begin{matrix}
        I_\alpha \\
        I_\beta
    \end{matrix}
\right]
=
\frac{2}{3}
\left[
    \begin{matrix}
        1 & -\frac{1}{2} & -\frac{1}{2} \\
        0 & \frac{\sqrt{3}}{2} & -\frac{\sqrt{3}}{2} \\
    \end{matrix}
\right]

\left[
    \begin{matrix}
        i_a \\
        i_b \\
        i_c \\
    \end{matrix}
\right]

$$

#### 等幅值形式的化简

通过观察可以发现，等幅值形式就是在基本形式的基础上乘上一个系数，所以这里直接在`化简后的基本形式`的基础上修改。

$$
\begin{bmatrix}
   I_\alpha \\
   I_\beta
\end{bmatrix}
=
\frac{2}{3}
\begin{bmatrix}
   \frac{3}{2} & 0 \\
   \frac{\sqrt{3}}{2} & \sqrt{3}
\end{bmatrix}
\begin{bmatrix}
   i_a \\
   i_b
\end{bmatrix}
$$

#### 等幅值形式的逆运算

$$
\begin{align*}
    \begin{bmatrix}
       i_a \\
       i_b
    \end{bmatrix}
    &=
    \frac{3}{2}
    \begin{bmatrix}
        \frac{2}{3} & 0 \\
        -\frac{1}{3} & \frac{\sqrt{3}}{3}
    \end{bmatrix}
    \begin{bmatrix}
       I_\alpha \\
       I_\beta
    \end{bmatrix}\\
    i_c &= -\frac{3}{2}(i_a + i_b)\\
\end{align*}
$$

### 等功率形式

> 等功率形式就是在基本形式的基础上乘上$\sqrt{\frac{2}{3}}$

### 等功率形式的推导

### 等功率形式的化简

### 等功率形式的逆运算
