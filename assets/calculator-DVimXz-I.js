var wc=Object.defineProperty,Cc=Object.defineProperties;var qc=Object.getOwnPropertyDescriptors;var Ei=Object.getOwnPropertySymbols;var $s=Object.prototype.hasOwnProperty,Ws=Object.prototype.propertyIsEnumerable;var Oo=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),jc=e=>{throw TypeError(e)},wr=Math.pow,js=(e,t,r)=>t in e?wc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,R=(e,t)=>{for(var r in t||(t={}))$s.call(t,r)&&js(e,r,t[r]);if(Ei)for(var r of Ei(t))Ws.call(t,r)&&js(e,r,t[r]);return e},ie=(e,t)=>Cc(e,qc(t));var Vo=(e,t)=>{var r={};for(var n in e)$s.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Ei)for(var n of Ei(e))t.indexOf(n)<0&&Ws.call(e,n)&&(r[n]=e[n]);return r};var $c=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Fr=(e,t,r)=>new Promise((n,i)=>{var o=l=>{try{s(r.next(l))}catch(c){i(c)}},a=l=>{try{s(r.throw(l))}catch(c){i(c)}},s=l=>l.done?n(l.value):Promise.resolve(l.value).then(o,a);s((r=r.apply(e,t)).next())}),Kc=function(e,t){this[0]=e,this[1]=t};var wn=e=>{var t=e[Oo("asyncIterator")],r=!1,n,i={};return t==null?(t=e[Oo("iterator")](),n=o=>i[o]=a=>t[o](a)):(t=t.call(e),n=o=>i[o]=a=>{if(r){if(r=!1,o==="throw")throw a;return a}return r=!0,{done:!1,value:new Kc(new Promise(s=>{var l=t[o](a);l instanceof Object||jc("Object expected"),s(l)}),1)}}),i[Oo("iterator")]=()=>i,n("next"),"throw"in t?n("throw"):i.throw=o=>{throw o},"return"in t&&n("return"),i};var Hc=$c((exports,module)=>{(function(){var desmosEnabledFeatures={GraphingCalculator:!0,FourFunctionCalculator:!0,ScientificCalculator:!0,GeometryCalculator:!0,Calculator3D:!0},desmosVersion="v1.10.1",desmosCommit="dc3b51642fefe7117023dd09be55e59c7040ebdc";(function(global){var elt=document.createElement("style");elt.innerHTML=`@charset "UTF-8";.dcg-calculator-api-container-v1_10 img{height:auto;max-width:100%}.dcg-aria-alert,.dcg-calculator-api-container-v1_10 .dcg-sr-only{position:absolute;left:-1000px;top:-1000px;width:1px;height:1px;text-align:left;overflow:hidden}.dcg-calculator-api-container-v1_10 .dcg-tap-container :not(.dcg-disabled):not(.dcg-cursor-default)[ontap]{cursor:pointer}.dcg-calculator-api-container-v1_10 .dcg-component-checkbox{cursor:pointer;position:relative}.dcg-calculator-api-container-v1_10 .dcg-component-checkbox .dcg-checkbox{border:1px solid #bbb;margin-right:.5em;width:1.1em;height:1.1em;border-radius:3px;vertical-align:middle;display:inline-block;position:relative}.dcg-calculator-api-container-v1_10 .dcg-component-checkbox .dcg-checkbox i{display:none;font-size:115%;position:absolute;top:-.15em;left:.1em;text-shadow:-1px -1px 0 #fff,-1px 1px 0 #fff,1px -1px 0 #fff,1px 1px 0 #fff,0 -1px 0 #fff,0 1px 0 #fff,1px 0 0 #fff,-1px 0 0 #fff}.dcg-calculator-api-container-v1_10 .dcg-component-checkbox .dcg-checkbox-children{position:relative;top:.1em}.dcg-calculator-api-container-v1_10 .dcg-component-checkbox.dcg-hovered:not(.dcg-checked) .dcg-checkbox{border:1px solid #949494}.dcg-calculator-api-container-v1_10 .dcg-component-checkbox.dcg-hovered:not(.dcg-checked) .dcg-checkbox i{display:block;color:#e2e2e2}.dcg-calculator-api-container-v1_10 .dcg-component-checkbox.dcg-checked .dcg-checkbox i{display:block;color:#2f72dc}.dcg-calculator-api-container-v1_10 .dcg-component-checkbox.dcg-checked.dcg-hovered .dcg-checkbox{border:1px solid #949494}.dcg-calculator-api-container-v1_10 .dcg-component-checkbox.dcg-disabled{pointer-events:none;opacity:.5}.dcg-calculator-api-container-v1_10 .dcg-component-checkbox.dcg-disabled .dcg-checkbox{background:#0000001a}.dcg-calculator-api-container-v1_10 .dcg-component-checkbox.dcg-disabled.dcg-checked i{display:block;color:#949494}.dcg-calculator-api-container-v1_10 .dcg-component-checkbox.dcg-small{font-size:85%}.dcg-calculator-api-container-v1_10 .dcg-mq-container{position:relative;display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-mq-container .dcg-mq-placeholder{position:absolute;top:50%;left:0;right:0;line-height:1em;height:1em;margin-top:-.67em;font-size:95%;pointer-events:none;font-family:Symbola,Times New Roman,serif;padding-left:2px;color:var(--dcg-custom-text-color, rgba(0, 0, 0, .47))}.dcg-calculator-api-container-v1_10 .dcg-mq-container .dcg-mq-placeholder .dcg-mq-math-mode{font-size:inherit}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-suffix-degree .dcg-mq-root-block:after{content:"\\b0";vertical-align:top;opacity:.6;margin-left:1px}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-suffix-radian .dcg-mq-root-block:after{content:"rad";font-size:90%;opacity:.6;margin-left:3px}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-mq-editable-field:not(.dcg-no-fadeout){position:relative}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-mq-editable-field:not(.dcg-no-fadeout):after{content:"";position:absolute;top:0;right:0;bottom:0;width:14px;background:linear-gradient(to right,transparent,var(--dcg-custom-background-color, #fff));pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-mq-editable-field:not(.dcg-no-fadeout) .dcg-mq-root-block{padding-right:10px}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-mq-editable-field:not(.dcg-no-fadeout) .dcg-mq-root-block.dcg-mq-editing-overflow-left:before{content:"";position:absolute;top:0;left:0;bottom:0;width:14px;background:linear-gradient(to left,transparent,var(--dcg-custom-background-color, #fff));pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-tap-container:not(body){position:relative}.dcg-calculator-api-container-v1_10 :not(.dcg-focus-visible){outline:none}.dcg-calculator-api-container-v1_10 .dcg-text-selectable{-webkit-user-select:text;user-select:text;cursor:text}@font-face{font-family:Symbola;src:url(data:font/woff2;base64,d09GMgABAAAAACD4ABEAAAAARmAAACCaAAKFHgAAAAAAAAAAAAAAAAAAAAAAAAAAGi4bEByCKAZWAIIECFoJhGURDAryXOQXATYCJAOCUguBLAAEIAWDIAeDdgxAG0M9BezYI7BxADwstyWKqs2cUZSGUSr+rxM4GSLUP2Cd4VFvveoWPPjGGlHRprrWFdMb966Vx8/CCFNDBmwtoif87bvGZ4lgAk4QB4AYOas+gSEQI+APq7A2RsSQ2MUyj5Bktv0xZ71PkiXbMkmy45ADGyc8iTN2aPZndjl/fhbwA/GtDCcAOu2tQClTyjc+tdfyAG2zI8XaRhi5oz1FtBGTVmywwA4wot6lEfHT7THW+eUqdJE1TFfCv0NNfROfyHGvPtVDWMh1C+ubaTuZhFCVYXnh4fP2/lrdyKKA69IEB0nnAQeayADTiBPI7122/N2e5O4o2m6jORwPeXVMZkOduaI0RmMPbDUK61v796sf8W6I9gFumFAYlOTCLldV9UxQxQgkleOT/5lwcTZg6zyToQQJfgD+n6608nszCwaWASvginsKcdGmaUYzkm/mS9obafdAOtaGJBPtXvhQdyEmKQTQJS4Dfbh0eizjylWfsklRBZ7/n9bsfZnsnvdGsY5SHRKNoiskToRky8/Pn0MmDFuy1MzQWobehQLHQanqSpM4bIxWj/ZGwYj5dz/W+mdqtsdpSEQGzAgEeCG79/ffswACYGNwMRpn7YDpYSgjQuV6vsp5wbSN4DHtWkB9d31OELUkNxMg7LlJGQDhiMtXAARIADDFHPV/NegPYLRtkUbbYuOj+gU0JVujKQvOUBcwRcPkyJ2Iv1DWkMoDxxwC63x225GKzUiBPTLHamSIOTJAHulpHF6CY1wTEVlbF8HgDfqcRVkOXGmKIXGbM4YuxrqOP+1k+HzWMjdg2dvxCFg4BLDu0bYCCeiJIgCA7xBx+II0PvjgPMELZbFwAPARQH0B6Je2YgEOcHxaJvq1AvD+sH01gNxGaBIBEBioUpD+4S6A8YsqIHIXIUqlz/gJOVB8pE4wSIKT1pJwJEMSSKKRLEhckpDkRUqijlLnqYvU1/Rj9Kd2OWSAWXtclj6WxqexWeo+PUmJ6Mm2C2fFUUeMY/5M/JH1I/2O/qrLqtUqc5W+Slo1XTVcRa8iVuErgP7Lp7YbQzcGb8T/euu1DIB5/Eb+7z4AuUtdSw9DylsgS9bYDthmUCsz41zZ8jDJHkuzMht0yLeZvwwyvlRG1BEp1mW3owRymJtrYDTAbyovUKZaF8pVQJ71VcxivdsGxodeIQdfEoYfqm+pQozsBrUshqgwY5FUJiRvIA5REcYB/Ux1LFBG5DG5JTXG15whgdhMLJWtGP27oTzcLPtZfimJLlW0PlG1KpSTR+oPKb81Rm1kuCUZQw1Y83KZqt58R6QRQT5RZ6hZ9Tu2psFIsSDbSvomI6uQ9fgnjP7dUCehLiBnKo22UAVTYcuDLfeCm/Wd+hGJcqOrtIyUyjU5xtoGo3UqsUWLkV3oFLfly7BS6RabZWDmSZ4blw6uB3fHn4lyg6Ne9RJs6UItknxVGrFUIMuwVceiLTdScCAkleqi4apLdHvdm0g0Aq9c9ZHK9pVikBCC0Gg8eqXHaAavQCBYK/MJasaokFzWcq2EtoA8RzK/IULchlVsj5wgLgbGgewGxi1JQUvOyb5HrD60rPUZ4IDT8lrjrbkwkXxVV2XBde13pP2UAWMROMHh8WA+ewSQoE5PcW6UZQmXZeSdIIG8GnmEuJz4sUbSAoD4lbeAQDObquoJqmKSsUI3x1C1XDLhawzpyYEG/wIG48Y6/nT5WwD2A4D8FHTHADjbVAFk/+8NPUUxgTEQ0ZQkvC1+T0Nu22KlcRNFbtNahlJxFVU/DIRBc3pHM53yZUA5WzNncxWG3YLPueuoWnt5iMzqqhRyqym4DALHmfBp3q1FJHJjt7ZLOOe6zhsx5zaP3KguXc/bdmSad+Nd19VO4gkjB68lh0QcYmLHBS7nYtfDhBQRxbe8tFZQnPc79Z16dM9K7YkhRAjviC2hpStOHwUXrpVLAAX3yinkZHpRtWol3lh5B37v9O3f2ybVHQLZYNk1uXfEv4DTTSCAVeltgeSM9yk4fu6JhORdf0Ie0poeBj40g0jG1/4f+pjeDHlpS1IfeZ0YdVYkRwkH4iox1xm3d6Yk19sTcnlStC2BGVIK5JjYlsgFmmYBCcynAhnPcsYKsoWaMup4rFUZ2KTeslJDnoAzzhOdK9TlJJaZhfeSl9wtXD2QqVKf90j1jgXbkm/VEqOMoXb5Q+8NebAE1kcLpVguzwOVWF1mSImNh7wQDHlvhgZ7VtymACuQ9aIh650yZLJJnS8nKPZz8WPr84CQFiUrlMJKdbSHsVbskwM7tZg8kQU1LqfmWQw1uo364AiI1W1Yrgf7MKzHwxRUIlfngQL7csW3dT6Of6x45jTeIqlQRPFRo1BTye2qwqDCOb0hpy36QKiY8ufeegyBhxVDku7aGL59ahAm8hASu1Jd9cUkwYExJmaeM0hQDC5a3oYnevJfTqY8WzOjCQjFn1fxtiduMJoMfYPOp8+4B6imgNUZYiWcamQFiY+G4/ZT/O/UUIN63RUWOZDMOatGRw9zqoZmWWHVU34n72CwzWR1nENuThqUTRJfbta+LZCn+ZKjtXN7nm/ICe2qcdYC1CFdOUyZyvvtgZ0aprxxj3cqtrlklJSCROy7FdW2DV+vzjt1UV4IFHwBid5tbrNunUtuyS9K6AStgCkflIrXtQ/f4F1w6m3t7LZsnHDeN7u+K7+skMLt3dH60ymtwRqeGzAExPIi92NbflGuLYDwuBsIQYY3BtXK8xpQtED+0rLg1ISj2lAWMQNZEpUWeZFqxS1dCM8RbshrHgnk3nsCLuhOUwROmCN1THkmFpw6WGG2pzBHV/6TCWRBDkzGTYh5xnPqE9SYtocUdw0IgjRql4VIAOd0wuLd+rrzQMBoAyHonjy1165AXvs5Bjk3XhisreNOpxQ2mgjF1AbR1lFg2m9n0zg32c0McXY/nYwzhznDhkys8rsbQMNFFlCfqUVN2iBI3xJjRzgkr+ur7qJ4OamhNrJ+pTQf8RzSCUzYr7Bi9NRILtS1jlTvzLYSPgrnX5AJKOhSHziOCSHYtYKjFrAu64JrShVZAS8B5e3bAzO2GB2FdEQpKqnf4xmLjcdVa3F83z57G/B2an68Zttu8bvHgff1E3au2XEwJ6oik2qMFoWoIxQgzFc37lxxh/NxBnAk1t2r5rCStIOffkJusLcts+N66NcNdNi3ODkb8nRzTi1KoiG4jY+3GfuedS61PV7vXd4ukdbNNuqah45OksfxXmwYIB+8jGLcXfUt1skKXYSht+PkHR+lCwla9J88shSjbi1Q5CdUC2nBoUIU0KkR2fhvg4AG4FK7eV7ylt1bmArWYb+Fy7byR1dGIa/zul9YYSUjIS2QyxlsPZ6ZK1MSMti0VG8nDNFV6uDtIhG0Qn2bzuabxkWxQyPvClXGwrZAW0YA5sc0KWpu/B+uvyw2hhIEMqaf/0VjdJpEA59Zw+skldc0phAvnfaIigJw33H8rYdPsjaG198ZMR14a1b5W3RKYGVItKwMIhHPnUjRlljmVWzt/UqYmaC0X2wa2P6F8kxoOkRjc2YSUn58ZnFuRi6pKHPJHVs0LCZHMpjW5QdQE+mbrCgKgsKt4hek+5nZegXiCjsTQI8xUbRAAPWrhX06zKCV0qE/yi2NVrNpIge5AXO2Y2eFG1aROmmo9N4cozPuRCFRilZAzbXfckPL6nGnDNyR7ydQKLPrRgyG0XUzJMXHm3K1cvPB4TUZd/ceHocgRiCGoYnHYYosaD4+dAlFFH/hoRzmtNdFsav70s9C0/bAdpq42+TYoIzZwM4zVF3WrGnde6g5Rz3qGaDG7DlN2LBde2hqjgMPHyG7IIKoZBIdguiken8K9a1SKWSqrxAEEp04YWxOtjAvoafnA4mgi1ltHzhu6nEqdBcX6qbqMXSLcyB3Hkfrmjb+SCP2LNv/ygY4XqqXTpT6DRe8/fDr/nLk+Caf4fxPD+CiE/IaJdv1oMT1ECXnKgSMmr0Gi51vyl0vEotCDnr4wHrDa8gemQ7jnG/V9RomUVTiIDH7ThJaje/GEaG4Hd//k+PTccTSLQeuv7sht55pjOsuAKPiNEqymLeZyvzBxzfDfv+hhb5Zh4oLZodGmrMNZuyd0rpcRhPnNB/4lUk2RHY7ePBTeLwkgYetxlZL33lJbIVbnlW4oa3MPbsxk2j5EXjL1QqPbk1OrE84FlQDR5SnMWejt1nXlwZmiAyUohoJcvp0udlW43P/3XTLkS+fMK2hTKGQHCnKxcRJiuLcwSocqtefsOCYIS58sQvUAZeWE9XXX1T/A5sAz0wT3yLkYHAH+1fu9iuTGGcZjHMM3AfjxLmG1Fb/JuvgMkqQc0ORPE8ojcGYQM0kgjpq0uVzm9sSmqC3jrVlZDVUbniKMBv0b8pTnZK3evvfKT5Jd+H/HU4djlFwH/XkZjLEwSlQVAoK7RRcKREzz9ebjuNTR6h+7tW1tYJKp+RN/1FjDHjZcsFGbhNZPObaaQ2aG7ZE1RLv6HaZ5x7Orf695b3eF/QZ77AXbLfHH7i7+r3SZTRqG/J2CPrk2HNGhzI+IDxe/95J6OGfG4/9qI5k+dh6JWW3eWbPtd9cyDuc5nv5Xuv/RRYFvgEJvamLme8brteenPv9z/5GuYz9VX/zUmPtTLGfbYRzbmIMVBiiOU1Bx3r4bPITMYv8zY8ZFl2QLKc/1a2Ha+xMDrZ/2X7I/hwx3G2qpUVUZx4wHTpK8fWoQwmqHZM369uhLV/5IYnLcZ5xV4zvviG73Iu9LZ/XE3Q1b9d2pcqW10MQRirGmc3p688JKcWogWGpgAT/XEOpUnZBxMoZtnueSmd7SNAEqHk1CSQCBwA96SCwYkeVChBUqvZ1NxHt5j31oB0KPy9bPOdsBrtgS1UBBkZzAN5uWGFnnA3k/CAzfVUQhO/FSIP7NEXcGB25NzOmj9HHYMaI5ToxXE1RnzS4F4Mv/ugIPR6A/tHPrqLHshVhRd2Ewm8HpIcv+4oX8ybprKpMX0ifcrHHhXbl5ull2pPQZvPaSJwnzpSdtXXmf9rT0H7K7mpd48ConU3aMt6nuhF9M7P97U+aNPxAMc6rrVwNzfFD0i9T/JCcrb6LcmzxiNOdjQ8MyFaZAzHvZniwrKteOicCTMvdj8bKtGiWOJx4YkINw+EhLZmWPKQ/PPVWzM3fNptq+c8+4KIAyrYQQ9EXXUOBBX14cJM8pTKm2bkwDiYhB9Ciw7KWujEneyqlrr6fIwIs4CZxbfg8F0vk765GW4zz/dji/waAaFYWJz08zjybJo1EioNbZeaekPyWSkK2W1IPKYto21jmwQtR8wxclETHsqTW10Ktk5xiAjJrgsAEw4ZGs/f7de7ROV6W8tX4vCge18qK8Sg8gAl/X12YzIMlLKFqP597xcYeciGMfbfNBV1KYdsmbXgo+637tiuip7VSb1xovhKyYv78a+DAtd4fHF04GVwtS7xzLegMb4VS20GZa0G1d78crhk+W+/Y8ZNuLqD6z8JCWAP84yzNMUXGCeFa3ijlhF5la9GDgMNrN3S6aw4mOXK3H2afSUDCYOvW0Ssrk2gbnXEiiPoJvf+JCpQ2ecpYoFLFnVOBWltRn5tb3y4+oTcbgbgLh+fkwOF38QQAXL2dat1imeH7i6Fe4Xqj2lG7QqXSUPhRLaDibFzwoE6xK8vGaV2y3VgjkLLcojazNVlWG3lMDEn9JOSvoCtX83WTZZ0vEsfLKNy0dEjz9K4N/jzK7sToN9N4dkeC/20BcxDQubc3WKQct5EsK5zThhmSyEjdHt0Ov91dsd05PXwyP3w4P0+CoGyBrQSjtdsDDh3Ket4dAC7gNadgAX0+Av78AXgBu+G6VJ+9dkNlp7rDFv/8ouyHmrYd/PX3iMZcf0ZwKNWFRHKhavxR6C1KYYVQP3dAQbvFXiHqIG0H0UBjsZy+Nd5wHm5guGZFkbXNdfV5gLMdzsBWW7lnr9VRqMsVCATVYMsz+AV0cU5h9k1x3qyCoKn1DOSFanAK2vZ2uU1d2zxvxdz0jd937zizzUuHEPsOt+4P+dO9jF/ysZQTzFgoCfD3l0q9OV7ojtqoVglqLT9d+0OmtK0PRMNnYfKCRWBERHhrRNOcRfxZZvAwEMQ1EnwB2iLqLLDfonVPTwlJhdZZg/wByFsfB/jfONuL+qcxd/BSAonDFPFP/NX8cDE/oXo+TB/+4Vkv+ls0kSgsjRyu8MrzttLpCW313d0q2Zi1rzWyPUfAbPKaDQHisyPPfQYfzgvIC9AmHgPvX8Z7AHPPGYlGGu28MoWUWHjyG/3U7ym1B18HznFzdtW7IXPj3V9/WjX9I0ceZg42rk+Hr60LPe3TFD29e9l9NFaNFuKT7CcWkAOuv2y/WLd/+XNTy9GafXE7TWlvo+oapquWko5KBoHYN79jo1UjMtlI4sUC0NrPgGizvCTNFawq1JWbswnjANXXFLC7nBxCRmiErVlTEvFsxrjP5pmv+Lxt+86IbABLQAvpfDU6PzWMjY+IBTp67QKufPbpZwJZjiYaeJem3TVW2j4GdTXVcWgTE/XGd7sLdKJ039MdU7RqDSEgBIQgajsdwvV5XXbp14GgNf1CyhcWFXjd8frWA9R27Q3Qf1xBaw24EXi49LNv9ua+zKX4dvlQlS2Tf+HN6NjyM6+vRoa5FKGK7+AQwQywfSTyqwrq6PER8jAPxaH0AhPZmgWsrn6RN1l3gpcZtmWLf4W0s9dHKMR8EsdbFtCT7F4b3bXboDfrkurXDERKn/UcftWRWxb2/3hpWM6YtO04Rs7TN/boOfSqM6887L/xsjBlyKYEMOC+Zpm+SasfbHJo8M1Iih5EW/v9c+tIdc3JPwg8MfZ+KlkXuh+3Nfz8299T9hIRp9vV21Ue8K2zdfmyDy/v+YxWi80X8cFb+18IcMtdbfVnns6usX0+v99C3I2ZNbu/eFO5fkxN3HMvuPF7Iz9m1/btal270i99bhytUQjT4K3z4MPHn84O27js6vP7/7fC5mcK+eXVsp2NK8zkT5tb2HTxtqsAoMd4Mzv1++LnDcOOnysGy2byC5yLD3znZNN3gG0fTO8YwWj1dHMwi9ztYkyA4bi2rl5Te/0480fE2l1tyUm9URvpwrlw805aVPImoaEdHcB/Y1EG4oFBVf7/Z6I8s+F7LYUD4LmY4tWkf4o2+jBO+z+fsYv2CxiGj4DPfg4AgOrDX7a4R3yK4l5ALkABXaFvJnvQH1di8NNwCvbTb5Y0nf3/59Zob88+vO7/R8tflw3EKQD9dulqcA3BIJoU/JLcGCXUt3TSiNlNNfNkiSoox/AR6EyFMqqESt/blV41CKBQOaCbKn+DrAwMtGCApffz4r1AMGAjiwHFYV/CdkovIVEz6guA1NhNyLfyyyNHRp1BqyRXtTNypHool85lGphdylp6TYAClaSe+ISHSljXGPpHnhBncunfmEvd5XwQjrmqMjcWEhpbPKXGBgi6mqEa1G5oDWrYh1QE67GNJhj+cbmNRqJfuWzdgKytrOclkxLcK4Zl6mBIQG2SRDr9W23RyJVgiX7M8k9wQsRndrO7SatwrXIe2N+cG1Z4KS/9B85Kz/e//HcaeuRVJdf4qI7mRpj+k2SDgInJR0/fHBkNeaxkSKIIKm2zCSpqU8MkR2GMOSEHAZIC9aTocyY3ix6HVHSMB2Rgs9nrAvjquQGOpve5dd8t0xLZi2HRYGVSoEjKtVNpd6XmMiHNVNKrae1BBsgvyz2akmyPlqJ4iIAapSyQqmgKT8Qm10fv2hlz0h7PbQlpFFefpBBiaBBLDKH2iWbKkogxw2l3Jk7UQdYL7aaIXbuNTAbNzPdOdzJWbO1BNUyQli9di1s4r3OVs1xfz/MTPLRoXyBJorKDcxBTFKVQ4WFExwdIWZ5n22gxvlstwUH9dRLHhwRu3B0G5D2WUIjyCNr4Bmcxv629MTehNvr3tZ/UGp8LhtcZAr4aSMxfbqjp6rjYd0DaOmr0hB7TN53e1cC8HCXCZKTkHj87kqrP46aOUmM8bEnOOijlC7STKDX7CkuZTwhZjKlnaqmx6T/R2DKXxipDlM+h1KsNhFpFSUPrNqrW6DUqpGp57trpm3//UQpXFjelis2/tnZjU+SFYlP2torx1rfhHB9kZDkOnUQsCagE7NFVBUu0SqPLavR9weDMiIH8nZ0G8RRA8hUQIYA6dxDNO2dOepdM2YsqoYBGflFzxO6IzSR1S3bzgW+C5KE9ldwkjRixcICFVYZL0opdWN68r51AmIyrnyUpp0b1XrjEESwe0QqYQUDBh9BJ4aHnucCoJ1QHljY3mqD0iU54jmESJZlskmnYaz9CLotah1atunQc1MNPqkP3C30HsLVGq4jGoVYhGHIZzqgYnGFWOUWDqWP23a+OGUsJ1RBOh89KKeQPYkAjEB50LKF8qVdP9PfP+3TceXsjzEcn3NvbPADOoxtzyIHicJJemjOA0pZu0xYsGwBLTmGFMhnaAwZPTkZ1gO5AO6BW/6H2e3qb1V3TBRsaWV/wN0FG3brlQdWj6v6uEyHWm4q+ucm95rMvSZ5jdTKdMDUlNvd22vSzeA/TTV32H9iSdmtqHvr4Zjs0o2tLYTlJH2l/sNvpPVrsXQwULG8itTrxXTusyKl1gpIC4RIS9XZHbCZUGUrojU4Hh3JiKNS8q1JqBQmZfkRDI0nF1YQJA87BsagFWcdwHMpF44ajPFa7uxcDVAb2xWQ2QogP6RmTLGVcaKwOALlSicilf44nztWQVJ5fVIRYxV3PmzJEj5OQsFHNzrctapkxmAkHyjltbfnqKSImXKV+QWye/3Hu4PHSa9qow9GESvY7RQXlBo+oqdWMKxYea42Pe5unUmOyPWQhKwScm7QNTxpqCeOGq6NV9C8q8DaWYrJjK00G4CVN4bWH0kl0tmk87xDgDFkqN2cngYRiTFgwYO64EU5iGibYwSOJXikGB27c+VhHyEADqjTulCUeNlLfWcL4HemUUh+xjqu2cOB5WlBjcIaeZIdcdKsfZ4kIvKNltZ4FCjsW4DijPdFjem24ZS2NDAZJN2QW1p3rpGRi0pgNWJkZlCuS5YaFsTwZZdpWSzLj1uRZfJL9gtpDlnUutblqaG/lizY4LQX17T5xMElUt5fkURyA74ucSWeaQWzuTript/TKp8PSz+4S251NF2fjK2+BBRaH6RaVNB4MW8bXlscynJm8OEvKMq/+oJsuNR17J4cpl0Jr5JIy9ruot+il3l9fWb/OhVp33bd182Qr1bnZ851ff0rtGUooeJS97reaB2l9vr0p1ZnwrxKuN/BHnjloLyyC0V5dNCr5pctNX7TW0qMT/FjR9BUhuaZ4C+kem5L6ZcMD19WYFkubecM4sdk1DTOtKKLPKj90d1d9Xa1LHq4xpViyjIAcbfyU2fjVO5pzDipeukjcxksIT5b0mUvezcuMy3g8ScmdGRsdF3E9J31wnei81WjRltpd1Q1CtdbaZpiMnDNK4SWhyXF2KZULQ3uuwnA6dW4sbY9lGEWjps2adnydn9101S85HPjoYcnRHqdK4+PsbAYUnqnefI9nVfc0u6b3dLMQezyMlrXsLpk749qX46FiyzH+pFkzXrfGcGPCY+sba1hffHHDvaNL26Xz5mnOCy5M67KdXLoc8gsyPdzoGBrEDclHB9xCsfaDW7Dpwel0Dnnz3f653d2duyfu3oP3RfdM3r39tm236+JS49PDi/3yr85Ljvd4oKZrJJNn8lf6+uqNtzvD7h666Kb/FL+1k0uGrNztfLhWvGXsKAoJOf7Ma7SSbrnnz25UKSMIRZ20UtUmOgczwpwmIItG3QdD+/eLT58Uzh2LpdL8Yh2pH/05/pvhsUogR+2S0V2pBh06wjRuzP7Rpq2CCix1b0QFCzFU2Q7GtJEwMY4xSnNG+waEpQNaMITgMcqykQ9KgGBmb+7FbKQTSDsiVLglafrAS1R3vuECY8BCZmwk9N48IErO61IqQXvZEqIXTMEmKyXeKUgXGKHUTOmV2mguseVVob+KgYTayK6ictJpvfF1mQp0jnrmh7pEyJG7BHY60hgvnSiFvgyNrBDRDkUJuSiJarhSdG6nWggsJ7wJHZbnTprjcmWSMlj4n83tCZvaOWMPCueuQVSNnah3AQD41VXtBvw5xlv+qrprAADAd6JzBQni4f4D/l/575XNBcAxAG21dWPScUf6/+61vdJq8lXtZ1iZwzXl0/BXfPsjP0G+gZNsjgIGeB1R/ha8B2g+VhF2fBBviE6m4IWpDS04xsMlKAhYlo/Hn4Znyp8mv8Ju9G74KBz+ltZAa9lzeHUGJ7lbtFdCh6AlKFm7B0aXHIWRJYC7DUKQe75VjXm5dfQCgU/2NmRaJykPPS2ZhqzsNOxhH4UY3Qv5NLyFfhunNECiBJAU/wOYYzpVSxdotnY/IFEwJANiCK0LAF3GeqkPETItffgbyxE4L4fWD+TYoWyjNxuak8RD6KJcx9FPAKYhricwzr4Ak+zrpmmquqZRBUtRJmDt71D4RwhPTpNAKVESkMgGCvnyLE4WuSC4ukgYhSS2GpQgCXVpsrmFS6zzlFQZKYKwQBRolpLHtWX9CvZyUCJLvAkyxZEueCkKKCq5RZLaZjKGtvh7A3McGubKk1YxJS6TA3eDpTZ0/Dpir0gcneEzFK3dOPkgEimIVwLUoqn6a1oqOQpE7uslycyOLoLqW2SCe9zf/60QNN0I+IGpK1tszlpPgY//RTp06dFnwJARYyZMrQcicscRLUasOB9hGmZhMOBIkZl36LdgMVAoUKJCDQsHjwmmmOHEsIYzvBHQo0+v1yZDx3RNDwOhbwZmaEaY1qEzjM3ETG29gUY0kpHLCxRp1iP5toRnVxm31tjPTEqLoxdthwsE2egRDtZZm+W2GKUiaT1yUT2/SFlaeUdYDpusY5aVdcqyl3PVlYqktdj5VK31zhrFydP8Aek+htY6b71cDxWnSMlMEkEeTVX/kbb6D3Vr1EZ7G/W/u4wXrFr5d6fI0v5ZqRLtRXXWLLtjGsbwbIiM3SChaNQ4vu0QodOLYz9Fv4e2CT7NCJTNI9h+w/xqVeTaFHIfVSCVzS/bYEI9drMMUPXgHBWxmA1L2saXqwILAA==) format("woff2")}.dcg-mq-aria-alert,.dcg-calculator-api-container-v1_10 .dcg-mq-mathspeak{position:absolute;left:-1000px;top:-1000px;width:0px;height:0px;text-align:left;overflow:hidden}.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field{display:-moz-inline-box;display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field .dcg-mq-cursor{border-left:1px solid currentColor;margin-left:-1px;position:relative;z-index:1;padding:0;display:-moz-inline-box;display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field .dcg-mq-cursor.dcg-mq-blink{visibility:hidden}.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-editable-field{border:1px solid gray}.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field.dcg-mq-focused,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-editable-field.dcg-mq-focused{-webkit-box-shadow:#8bd 0 0 1px 2px,inset #6ae 0 0 2px 0;-moz-box-shadow:#8bd 0 0 1px 2px,inset #6ae 0 0 2px 0;box-shadow:#8bd 0 0 1px 2px,inset #6ae 0 0 2px;border-color:#709ac0}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-editable-field{margin:1px}.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field .dcg-mq-latex-command-input{color:inherit;font-family:Courier New,monospace;border:1px solid gray;padding-right:1px;margin-right:1px;margin-left:2px}.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field .dcg-mq-latex-command-input.dcg-mq-empty{background:transparent}.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field .dcg-mq-latex-command-input.dcg-mq-hasCursor{border-color:ActiveBorder}.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field.dcg-mq-empty:after,.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field.dcg-mq-text-mode:after,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-empty:after{visibility:hidden;content:"c"}.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field .dcg-mq-cursor:only-child:after,.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field .dcg-mq-textarea+.dcg-mq-cursor:last-child:after{visibility:hidden;content:"c"}.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field .dcg-mq-text-mode .dcg-mq-cursor:only-child:after{content:""}.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field.dcg-mq-text-mode{overflow-x:auto;overflow-y:hidden}.dcg-calculator-api-container-v1_10 .dcg-mq-root-block,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-root-block{display:-moz-inline-box;display:inline-block;width:100%;padding:2px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;white-space:nowrap;overflow:hidden;vertical-align:middle}.dcg-calculator-api-container-v1_10 .dcg-mq-root-block .dcg-mq-digit,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-root-block .dcg-mq-digit{margin-left:.009em;margin-right:.009em}.dcg-calculator-api-container-v1_10 .dcg-mq-root-block .dcg-mq-group-start,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-root-block .dcg-mq-group-start{margin-left:.11em;margin-right:-.01em}.dcg-calculator-api-container-v1_10 .dcg-mq-root-block .dcg-mq-group-other,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-root-block .dcg-mq-group-other{margin-left:-.01em;margin-right:-.01em}.dcg-calculator-api-container-v1_10 .dcg-mq-root-block .dcg-mq-group-leading-1,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-root-block .dcg-mq-group-leading-1,.dcg-calculator-api-container-v1_10 .dcg-mq-root-block .dcg-mq-group-leading-2,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-root-block .dcg-mq-group-leading-2{margin-left:0;margin-right:-.01em}.dcg-calculator-api-container-v1_10 .dcg-mq-root-block .dcg-mq-group-leading-3,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-root-block .dcg-mq-group-leading-3{margin-left:.036em;margin-right:-.01em}.dcg-calculator-api-container-v1_10 .dcg-mq-root-block.dcg-mq-suppress-grouping .dcg-mq-group-start,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-root-block.dcg-mq-suppress-grouping .dcg-mq-group-start,.dcg-calculator-api-container-v1_10 .dcg-mq-root-block.dcg-mq-suppress-grouping .dcg-mq-group-other,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-root-block.dcg-mq-suppress-grouping .dcg-mq-group-other,.dcg-calculator-api-container-v1_10 .dcg-mq-root-block.dcg-mq-suppress-grouping .dcg-mq-group-leading-1,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-root-block.dcg-mq-suppress-grouping .dcg-mq-group-leading-1,.dcg-calculator-api-container-v1_10 .dcg-mq-root-block.dcg-mq-suppress-grouping .dcg-mq-group-leading-2,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-root-block.dcg-mq-suppress-grouping .dcg-mq-group-leading-2,.dcg-calculator-api-container-v1_10 .dcg-mq-root-block.dcg-mq-suppress-grouping .dcg-mq-group-leading-3,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-root-block.dcg-mq-suppress-grouping .dcg-mq-group-leading-3{margin-left:.009em;margin-right:.009em}.dcg-calculator-api-container-v1_10 .dcg-mq-root-block .dcg-mq-ellipsis-start,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-root-block .dcg-mq-ellipsis-start{margin-left:.14em;margin-right:.009em}.dcg-calculator-api-container-v1_10 .dcg-mq-root-block .dcg-mq-ellipsis-middle,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-root-block .dcg-mq-ellipsis-middle{margin-left:.009em;margin-right:.009em}.dcg-calculator-api-container-v1_10 .dcg-mq-root-block .dcg-mq-ellipsis-end,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-root-block .dcg-mq-ellipsis-end{margin-left:.009em;margin-right:.14em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode{font-variant:normal;font-weight:400;font-style:normal;font-size:115%;line-height:1;display:-moz-inline-box;display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-non-leaf,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-scaled{display:-moz-inline-box;display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode var,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-text-mode,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-nonSymbola{font-family:Times New Roman,Symbola,serif;line-height:.9}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode svg{fill:currentColor;position:absolute;top:0;left:0;width:100%;height:100%}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode *{font-size:inherit;line-height:inherit;margin:0;padding:0;border-color:#000;-webkit-user-select:none;-moz-user-select:none;user-select:none;box-sizing:border-box}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-empty{background:#0003}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-empty.dcg-mq-root-block,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-empty.dcg-mq-quiet-delimiter,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode.dcg-mq-empty{background:transparent}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-text-mode{display:inline-block;white-space:pre}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-text-mode.dcg-mq-hasCursor{box-shadow:inset #a9a9a9 0 .1em .2em;padding:0 .1em;margin:0 -.1em;min-width:1ex}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-font{font:1em Times New Roman,Symbola,serif}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-font *{font-family:inherit;font-style:inherit}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode b,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode b.dcg-mq-font{font-weight:bolder}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode var,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode i,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode i.dcg-mq-font{font-style:italic}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode var.dcg-mq-f{margin-right:.2em;margin-left:.1em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-roman var.dcg-mq-f{margin:0}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode big{font-size:200%}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-int>big{display:inline-block;-webkit-transform:scaleX(.7);-moz-transform:scaleX(.7);-ms-transform:scaleX(.7);-o-transform:scaleX(.7);transform:scaleX(.7);vertical-align:-.16em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-int>.dcg-mq-supsub{font-size:80%;vertical-align:-1.1em;padding-right:.2em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-int>.dcg-mq-supsub>.dcg-mq-sup>.dcg-mq-sup-inner{vertical-align:1.3em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-int>.dcg-mq-supsub>.dcg-mq-sub{margin-left:-.35em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-roman{font-style:normal}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-sans-serif{font-family:sans-serif,Symbola,serif}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-monospace{font-family:monospace,Symbola,serif}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-overline{border-top:1px solid;margin-top:1px}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-underline{border-bottom:1px solid;margin-bottom:1px}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-binary-operator{padding:0 .2em;display:-moz-inline-box;display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-supsub{text-align:left;font-size:90%;vertical-align:-.5em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-supsub.dcg-mq-sup-only{vertical-align:.5em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-supsub.dcg-mq-sup-only>.dcg-mq-sup{display:inline-block;vertical-align:text-bottom}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-supsub .dcg-mq-sup{display:block}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-supsub .dcg-mq-sub{display:block;float:left}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-supsub .dcg-mq-binary-operator{padding:0 .1em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-supsub .dcg-mq-fraction{font-size:70%}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode sup.dcg-mq-nthroot{font-size:80%;vertical-align:.8em;margin-right:-.6em;margin-left:.2em;min-width:.5em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-ghost svg{opacity:.2}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-bracket-middle{margin-top:.1em;margin-bottom:.1em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-bracket-l,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-bracket-r{position:absolute;top:0;bottom:2px}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-bracket-l{left:0}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-bracket-r{right:0}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-bracket-container{position:relative}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-array{vertical-align:middle;text-align:center}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-array>span{display:block}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-operator-name{font-family:Symbola,Times New Roman,serif;line-height:.9;font-style:normal}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode var.dcg-mq-operator-name.dcg-mq-first{padding-left:.2em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode var.dcg-mq-operator-name.dcg-mq-last,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-supsub.dcg-mq-after-operator-name{padding-right:.2em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-fraction{font-size:90%;text-align:center;vertical-align:-.4em;padding:0 .2em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-fraction,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-large-operator,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode x:-moz-any-link{display:-moz-groupbox}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-fraction,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-large-operator,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode x:-moz-any-link,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode x:default{display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-numerator,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-denominator,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-dot-recurring{display:block}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-numerator{padding:0 .1em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-denominator{border-top:1px solid;float:right;width:100%;padding:.1em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-dot-recurring{text-align:center;height:.3em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-sqrt-prefix{position:absolute;top:1px;bottom:.15em;width:.95em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-sqrt-container{position:relative}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-sqrt-stem{border-top:1px solid;margin-top:1px;margin-left:.9em;padding-left:.15em;padding-right:.2em;margin-right:.1em;padding-top:1px}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-diacritic-above{display:block;text-align:center;line-height:.4em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-diacritic-stem{display:block;text-align:center}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-hat-prefix{display:block;text-align:center;line-height:.95em;margin-bottom:-.7em;transform:scaleX(1.5);-moz-transform:scaleX(1.5);-o-transform:scaleX(1.5);-webkit-transform:scaleX(1.5)}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-hat-stem{display:block}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-large-operator{vertical-align:-.2em;padding:.2em;text-align:center}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-large-operator .dcg-mq-from,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-large-operator big,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-large-operator .dcg-mq-to{display:block}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-large-operator .dcg-mq-from,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-large-operator .dcg-mq-to{font-size:80%}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-large-operator .dcg-mq-from{float:right;width:100%}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-editable-field{cursor:text;font-family:Symbola,Times New Roman,serif}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-overarc{border-top:1px solid;-webkit-border-top-right-radius:50% .3em;-moz-border-radius-topright:50% .3em;border-top-right-radius:50% .3em;-webkit-border-top-left-radius:50% .3em;-moz-border-radius-topleft:50% .3em;border-top-left-radius:50% .3em;margin-top:1px;padding-top:.15em}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-overarrow{min-width:.5em;border-top:1px solid;margin-top:1px;padding-top:.2em;text-align:center;position:relative}.dcg-calculator-api-container-v1_10 .dcg-mq-arrow-right-content{position:absolute;right:-.1em;top:-.48em;font-size:.5em}.dcg-calculator-api-container-v1_10 .dcg-mq-arrow-left-content{position:absolute;top:-.48em;left:-.1em;font-size:.5em;-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:"FlipH"}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-selection,.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field .dcg-mq-selection,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-selection .dcg-mq-non-leaf,.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field .dcg-mq-selection .dcg-mq-non-leaf,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-selection .dcg-mq-scaled,.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field .dcg-mq-selection .dcg-mq-scaled{background:#b4d5fe!important}.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-selection.dcg-mq-blur,.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field .dcg-mq-selection.dcg-mq-blur,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-selection.dcg-mq-blur .dcg-mq-non-leaf,.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field .dcg-mq-selection.dcg-mq-blur .dcg-mq-non-leaf,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-selection.dcg-mq-blur .dcg-mq-scaled,.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field .dcg-mq-selection.dcg-mq-blur .dcg-mq-scaled{background:#d4d4d4!important;color:#000;border-color:#000}html.dcg-calculator-api-container-v1_10 body .dcg-mq-math-mode .dcg-mq-selection .dcg-mq-nthroot-container *,html body .dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-selection .dcg-mq-nthroot-container *,html.dcg-calculator-api-container-v1_10 body .dcg-mq-editable-field .dcg-mq-selection .dcg-mq-nthroot-container *,html body .dcg-calculator-api-container-v1_10 .dcg-mq-editable-field .dcg-mq-selection .dcg-mq-nthroot-container *{background:transparent!important}.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field .dcg-mq-textarea,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-textarea{position:relative;-webkit-user-select:text;-moz-user-select:text;user-select:text}.dcg-calculator-api-container-v1_10 .dcg-mq-editable-field .dcg-mq-textarea *,.dcg-calculator-api-container-v1_10 .dcg-mq-math-mode .dcg-mq-textarea *{-webkit-user-select:text;-moz-user-select:text;user-select:text;position:absolute;clip:rect(1em 1em 1em 1em);-webkit-transform:scale(0);-moz-transform:scale(0);-ms-transform:scale(0);-o-transform:scale(0);transform:scale(0);resize:none;width:1px;height:1px;box-sizing:content-box}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view{cursor:pointer;outline:none;border:2px solid currentColor;color:#000;display:inline-block;border-radius:4px;margin-right:2.5px;margin-left:2.5px;margin-bottom:2px;width:26px;height:26px;vertical-align:middle;background:#fff;position:relative;font-size:16px;touch-action:none}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-static-token{cursor:text}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view:not(.dcg-static-token).dcg-focus-visible{box-shadow:0 0 0 3px #2f72dc80!important}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-graph-interactions-disabled{border-style:dashed;opacity:.6}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-light-color{border-color:#0003}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-light-color .dcg-token-background{opacity:1}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-light-color.dcg-selected-token{border-color:#00000080}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-light-color.dcg-selected-token .dcg-token-background{background-color:#00000080}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-light-color:not(.dcg-selected-token) .dcg-token-icon,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-light-color:not(.dcg-selected-token) .dcg-token-label{color:#0003}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-light-color.dcg-hovered:not(.dcg-static-token):not(.dcg-selected-token){border-color:#0003}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-light-color.dcg-hovered:not(.dcg-static-token):not(.dcg-selected-token) .dcg-token-icon,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-light-color.dcg-hovered:not(.dcg-static-token):not(.dcg-selected-token) .dcg-token-label{color:#0003}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-light-color.dcg-depressed:not(.dcg-static-token):not(.dcg-selected-token){border-color:#00000080}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-light-color.dcg-depressed:not(.dcg-static-token):not(.dcg-selected-token) .dcg-token-icon,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-light-color.dcg-depressed:not(.dcg-static-token):not(.dcg-selected-token) .dcg-token-label{color:#00000080}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view>*{pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-label{position:absolute;right:1px;bottom:-1px;font-family:sans-serif;font-size:75%;padding-right:1px;padding-bottom:1px}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view i{font-style:normal}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-assignment-token{border:1px solid #949494;padding:0;text-align:center;width:auto;min-width:26px}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-assignment-token .dcg-token-background{display:none}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-assignment-token.dcg-hovered:not(.dcg-static-token){border:1px solid #949494;box-shadow:0 0 0 1px #949494}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-assignment-token.dcg-selected-token:not(.dcg-static-token){background-color:#fff;border:1px solid #666;box-shadow:0 0 0 1px #666}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-token-has-label .dcg-token-point,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-token-has-label .dcg-token-midpoint,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-token-has-label .dcg-token-intersection,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-token-has-label .dcg-token-glider{position:relative;top:-3px;left:-3px}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-token-has-label .dcg-token-point:after,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-token-has-label .dcg-token-midpoint:after,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-token-has-label .dcg-token-intersection:after,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-token-has-label .dcg-token-glider:after{display:none}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-token-has-label .dcg-token-point:before,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-token-has-label .dcg-token-midpoint:before,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-token-has-label .dcg-token-intersection:before,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-token-has-label .dcg-token-glider:before{display:none}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-selected-token .dcg-token-label{color:#fff}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-background{opacity:.25;display:block;width:100%;height:100%;background:currentColor;position:absolute;top:0;left:0;bottom:0;right:0;border-radius:2px}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-hovered:not(.dcg-static-token):not(.dcg-selected-token) .dcg-token-background{opacity:.4}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-depressed:not(.dcg-static-token):not(.dcg-selected-token) .dcg-token-background{opacity:.5}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-icon{position:absolute;top:0;left:0;bottom:0;right:0;overflow:hidden;text-align:center;line-height:24px}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-point,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-glider,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-intersection,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-midpoint{font-size:140%}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-icon-angle{font-size:110%}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-rotate,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-dilate,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-reflect,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-transformation{font-size:130%;color:#000}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-transformation{font-size:100%}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-rotate{margin-top:1px}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-dilate{font-size:140%;margin-left:-1px}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-reflect:before{position:absolute;top:2px;bottom:2px;left:50%;border-right:1px solid rgba(0,0,0,.2);margin-left:-.5px;content:""}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-glider:before,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-intersection:before,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-midpoint:before{content:"";height:2px;background:currentColor;position:absolute;top:50%;left:50%;margin-top:-1px}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-intersection:after,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-midpoint:after{content:"";height:2px;background:currentColor;position:absolute;top:50%;left:50%;margin-top:-1px}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-glider:before{width:16px;margin-left:-8px;opacity:.7}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-intersection:before{transform:rotate(-45deg);width:20px;margin-left:-10px;opacity:.6}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-intersection:after{transform:rotate(45deg);width:20px;margin-left:-10px;opacity:.6}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-midpoint:before{transform:rotate(0);width:20px;margin-left:-10px;opacity:.6}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-circle{border:2px solid currentColor;width:16px;height:16px;margin-top:3px;margin-left:3px;border-radius:50%}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-perpendicular svg,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-parallel svg,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-translate svg,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-vector svg,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-ray svg,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-line svg,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-segment svg,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-arc svg{fill:none;stroke:currentColor;stroke-width:2px;stroke-linecap:round}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-parallel-parent{fill:none;stroke:currentColor;stroke-opacity:.5;stroke-width:2px;stroke-linecap:round}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-vector-arrowhead{fill:currentColor;stroke:none;stroke-linecap:round;stroke-linejoin:round}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-polygon svg{fill:currentColor;fill-opacity:.2;stroke:currentColor;stroke-width:1.5px;stroke-linejoin:round}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-angles svg,.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-angle svg{fill:none;stroke:currentColor;stroke-width:1.5px;stroke-linecap:round}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-angle-fill{fill:currentColor;fill-opacity:.2;stroke:none}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-angle-arc{fill:none;stroke:currentColor;stroke-width:1.5px}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-directedangle svg{fill:none;stroke:currentColor;stroke-width:1.5px;stroke-linecap:round}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-directedangle-arc{fill:none;stroke:currentColor;stroke-width:1px}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-token-directedangle-arrowhead{fill:none;stroke:currentColor;stroke-width:1px;stroke-linejoin:round}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-selected-token{background-color:currentColor}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-selected-token .dcg-token-icon{color:#fff}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-child-of-hovered-token:not(.dcg-static-token):after{content:"";position:absolute;bottom:100%;left:50%;margin-left:-8px;border:1px solid transparent;border-width:6px 8px;border-bottom-color:#0003}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view.dcg-parent-of-hovered-token:not(.dcg-static-token):after{content:"";position:absolute;top:100%;left:50%;margin-left:-8px;border:1px solid transparent;border-width:6px 8px;border-top-color:#0003}.dcg-calculator-api-container-v1_10 .dcg-geo-token-view .dcg-icon-lock{font-size:.7rem;color:#666;text-shadow:-1px -1px 0 #fff,-1px 1px 0 #fff,1px -1px 0 #fff,1px 1px 0 #fff,0 -1px 0 #fff,0 1px 0 #fff,1px 0 0 #fff,-1px 0 0 #fff;opacity:1;position:absolute;bottom:0;right:0}.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view .dcg-geo-token-view,.dcg-calculator-api-container-v1_10 .dcg-table-container .dcg-geo-token-view,.dcg-calculator-api-container-v1_10 .dcg-clickable-menu-row .dcg-geo-token-view,.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-geo-token-view,.dcg-calculator-api-container-v1_10 .dcg-ticker-settings-container .dcg-geo-token-view,.dcg-calculator-api-container-v1_10 .dcg-slider-container .dcg-geo-token-view{margin:0;transform:scale(.9)}.dcg-calculator-api-container-v1_10 .dcg-audio-trace-line{position:absolute;opacity:50%;background:var(--dcg-trace-color, #aaa)}.dcg-calculator-api-container-v1_10 .dcg-audio-trace-line.dcg-audio-trace-line--horizontal{left:0;right:0;height:4px;top:var(--dcg-trace-coord, -10px)}.dcg-calculator-api-container-v1_10 .dcg-audio-trace-line:not(.dcg-audio-trace-line--horizontal){bottom:0;width:4px;top:0;left:var(--dcg-trace-coord, -10px)}.dcg-calculator-api-container-v1_10 .dcg-mixed-text-math .dcg-mq-math-mode .dcg-mq-root-block{vertical-align:baseline;overflow:visible}.dcg-calculator-api-container-v1_10 .dcg-static-mathquill-view * .dcg-mq-cursor{display:none}.dcg-calculator-api-container-v1_10 .dcg-tooltip-hit-area-container{position:relative;line-height:initial}.dcg-calculator-api-container-v1_10 .dcg-tooltip-hit-area-container.dcg-display-block{width:100%}.dcg-calculator-api-container-v1_10 .dcg-tooltip-hit-area-container:not(.dcg-display-block){display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-tooltip-mount-pt{position:absolute;top:0;left:0}.dcg-calculator-api-container-v1_10 .dcg-tooltip-positioning-container{position:absolute;pointer-events:none;z-index:10000}.dcg-calculator-api-container-v1_10 .dcg-tooltip-positioning-container .dcg-tooltip-message-container{position:absolute;z-index:10000;animation:dcg-fadeIn .3s}.dcg-calculator-api-container-v1_10 .dcg-tooltip-positioning-container .dcg-tooltip-message{max-width:100%;border-radius:4px;padding:5px 8px;font-size:14px;line-height:1.1em;display:inline-block;pointer-events:all;text-align:center;position:relative}.dcg-calculator-api-container-v1_10 .dcg-tooltip-positioning-container .dcg-tooltip-message.dcg-sticky-not-stuck{cursor:pointer}.dcg-calculator-api-container-v1_10 .dcg-tooltip-positioning-container.dcg-tooltip-theme-dark .dcg-tooltip-message{background:#000;color:#fff}.dcg-calculator-api-container-v1_10 .dcg-tooltip-positioning-container.dcg-tooltip-theme-dark .dcg-tooltip-message.dcg-sticky-not-stuck{background:#666}.dcg-calculator-api-container-v1_10 .dcg-tooltip-positioning-container.dcg-tooltip-theme-light .dcg-tooltip-message{background:#fff;color:#000;border:1px solid #bbb;border-radius:5px}.dcg-calculator-api-container-v1_10 .dcg-tooltip-positioning-container.dcg-tooltip-theme-light .dcg-tooltip-message .dcg-static-mathquill-view{width:100%}.dcg-calculator-api-container-v1_10 .dcg-tooltip-positioning-container.dcg-tooltip-theme-light .dcg-tooltip-arrow{transform:rotate(45deg)}.dcg-calculator-api-container-v1_10 .dcg-tooltip-positioning-container.dcg-tooltip-theme-light.dcg-tooltip-gravity-n-s .dcg-tooltip-arrow{transform:translate(-50%) rotate(45deg)}.dcg-calculator-api-container-v1_10 .dcg-tooltip-positioning-container.dcg-tooltip-theme-light.dcg-tooltip-gravity-e-w .dcg-tooltip-arrow{transform:translateY(-50%) rotate(45deg)}.dcg-calculator-api-container-v1_10 .dcg-tooltip-positioning-container .dcg-tooltip-arrow{position:absolute;animation:dcg-fadeIn .3s;z-index:10000}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container{display:flex}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn{color:var(--dcg-custom-text-color, rgba(0, 0, 0, .85));text-align:center;display:flex;justify-content:center;align-items:center;border:1px solid var(--dcg-custom-text-color, rgba(0, 0, 0, .42))}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn i{position:relative;top:1px}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn:not(:last-of-type){border-right:0}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn:not(.dcg-disabled).dcg-hovered:not(.dcg-selected){color:#000}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn:not(.dcg-disabled).dcg-depressed:not(.dcg-selected){background:#0000000a}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn:first-of-type{border-top-left-radius:3px;border-bottom-left-radius:3px}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn:last-of-type{border-top-right-radius:3px;border-bottom-right-radius:3px}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-selected{color:var(--dcg-custom-background-color, #fff);position:relative}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-selected:not(.dcg-disabled){cursor:default}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-disabled{opacity:.4}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-theme-default{flex:1}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-theme-default .dcg-segmented-control-interior{height:34px;line-height:34px;padding:0 8px}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-theme-default.dcg-hovered:not(.dcg-selected):not(.dcg-disabled){border-color:#0000009e}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-theme-default.dcg-selected{border:1px solid var(--dcg-custom-text-color, rgba(0, 0, 0, .65));background:var(--dcg-custom-text-color, rgba(0, 0, 0, .65))}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-theme-mini{border-color:var(--dcg-custom-text-color, #bbb)}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-theme-mini .dcg-segmented-control-interior{padding:4px 6px}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-theme-mini.dcg-hovered:not(.dcg-selected):not(.dcg-disabled){background:#0000000a}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-theme-mini.dcg-depressed:not(.dcg-selected):not(.dcg-disabled){background:#0003}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-theme-mini.dcg-selected{background:var(--dcg-custom-text-color, rgba(47, 114, 220, .15));border-color:var(--dcg-custom-text-color, #2f72dc);color:var(--dcg-custom-background-color, #2f72dc)}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-theme-mini.dcg-selected+.dcg-segmented-control-btn{border-left:1px solid var(--dcg-custom-text-color, #2f72dc)}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-theme-mini.dcg-disabled{pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-theme-mini.dcg-disabled.dcg-selected+.dcg-segmented-control-btn{border-left:1px solid #666}.dcg-calculator-api-container-v1_10 .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-theme-mini.dcg-disabled.dcg-selected{background:#0000001a;border-color:#666;color:#000}@font-face{font-family:Abraham;src:url(data:font/woff2;base64,d09GMgABAAAAAArwAA0AAAAAeWQAAAqVAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP0ZGVE0cGhgGYACCYhEICoHWFIGlFguCSgABNgIkA4QWBCAFiB0HhnQbtF4RlaOBR1GaNk3yZQI3B7YOliFCqWPJhLGMZWhifaqyq2o95GjH/zNVXBL8//9+/5trX7XvFg1IZlYag8ygxJfQVn5CG1XtHP+dNq/yNt2C3pL4S+6clNLJDAzYNFYB91q8EtLut8xTjmIJrIusoXVe+2wOwt9AJDikbwstrP99yLFHAPzz3Kv8zsnN5Bxfj0MY4zVxDermbpqDSlLwlBquUEUKWLKC/ZTqUiAv/D/t978qcBFrJFoxien5xgafh3ry5nPPW2d49/v9Hw2JVH4uSCjEZJZIEf9/TP1e6LRjmpSm8IJIGEpw5KQa/5jvAgTw0rfxI2D948NgeQsBOVTLOj7e9uyLvhKAPWRYBnhUfoneIQzwFPdI+Oj8cmCFe8mSUZEe8FbhFFixwJtglARgCiJ+ox4wBgFwGSMCxjCxHZATY/hAwX0dypZ0AAqmdCgD3cF9d7e9OECwuUJ4vyszdYLtFfgBC2t3WO0Yq4dI/4HIyMrJKygqKauoqqlraGpp6+jq6RsYGhkTJqZm5haWVtYWrFRr9Uaz1e50e/3BcDSeTGfzxXK13mx3+8PxBM7yccuOHAr1vgzaD8LDYGoDzC8AgCAGPGX6fFspovrttY4kxKvIokJxNrafYC3wFQXzMoDa3imAyj7PuH0j8qnRPkDKA1me2uIZck2ci/P3LZ8eCYTQ2dHAgYJD4t0c57oCXMgMXiwMVcTz7cFF6mXKFdrV8uNPyAPUIcow7bqog/BwU4sWfq33xFUv5KpeyNimSmmCgXAd4Wl5+I4e6RUf1B5BNBwGA0LFdXgCmOaszGXOsalSjuHOEeMsZaiJbB7elCdblK7hDvY/4HZe2DbYTHIYJKWFBSlD1AHyIC2Zh5X35/ruazK7L8mG5+XiRrjDwhtMNJwWnmwKzwFcGsQ+EG7K5ILNewxDoRw45boM5BCncUz59T7Brb8i9nKXBjTlnqs+/dVokUHF4cPmbNhy+WjYPjwOERc4p2yKWGwUn6rYW92anaBbixCV440aah2lXq4rCg/Lpfz+V9Qaci2tntJy9bpB8m2+scd873PfY8tkeAhMRuT8adg+4KIb3A8uBH7whzv77EwyjGWkYZdAE/Ew+IfOvTMF9mHaDyIHr93Fr1m+FHnPRrSx+xV2D4qqrtGm9s5BnW1znv7RfabE/WggXINmNgYQaSakNTviPiiH9FmVEv2CbQ7TSmdzikfFnbHgLoo7VXdM9Wa0JhoWwqo7Lvk1UaajFf8ZZ++DGf9ZNg5iis9KYXk3Rl0SANz7O0BzziGlf9Vt8CYyTYHcLIXybsg/38isq/+RrsmwS6UugH7PfRHBffY49ywoZ2rWNF1A3+o/4zzZdPlSUSWteegYNPSifx9ER9VtW8Rh0wjhRgiH/BbjQAr6LyYlY5A4wfuaWP9Yvke4ZlCoPzjwu0IlFwv03HJf8DuQam40vLpI70RDhL30GD++ueym8F+8sZsYpKPjohdvLjtNPBd88i+YfnqTRtN6dSKQ0/wB+juSGt4Lzf6LUfedjnsZp/7l9PJzfGO6spDY+RE+ET5RTORcKoyxfxzSC/poN/a6B9QvS/piIs/78ZVjFF3p7pYigav1cYxuVq2KpJ5u0cZ+ztpGnKhDEfwEVxVS72rtkvoErucAZhio41AJKSQtuqp25mltuiQBqoPGBaFSwQ2n7or5M+4rHGTEYK1BdAk9Pk1YOyOhZ2gFiM0VPhEMN9aHlS0s55hu2VG6a5HAFfvnMssOnNMQktYaWN84dcIEN29kUIq47MYPLf44Xyt6WO3gDAe//czw6eEzseeVJhs90xH2nWwsebJFlTVZi66BOm5nlg1wz4pzslf27+ZgthdYiXECJUtBGAnOumlppur+eSUzuXsu3tfygYXvsJ3exlDo2YvYGVwuDAKIF8MtneDy3QWwgIWbW88dzxY0nJjcbpDRAKAAoKPx1L60XYnyfBfG7tPRpuAy2oPRxtacy3ZaTU61uOASIwl//xzPVJui4FlhFOZZqT1stCuXmDuw5ef9BbsdnN4dKWxXVmcuA98ugHcfMCm5nzhsaXc6Zyn8D/0F/4PLtJZZkbrhN5rlr7W5RXic46/uP3Lzrgb6KnuQMw4m2Gqu/kPnkfsEkH4p81fgnNNhu1fvY7/Vt1b1j3ptsC5JepoMTJ/V4nwTMgrUGXgqvGbU68kxXXI3z9zTS2eOy+pWsiaznuL/dBNNhfmJnReiussqc7f7K1x+baL9PAdOCLuql+Z5/Y4Fh3c7LZ/MaoTks3qK3mHi7Ng35bef2ML8msShaUEvJmH/jSniU6QzYsZ1nF1xcRovOtl8HMx4XLHY/CxD3J6vDnY7TW0ctzRXPRraHrfsxjL2Zrt1e9NlTc7J5SlaVYPG+TSr4MuFHBPTDMBtx4ZWTj5XvWD457P2wNr7ZIDKwajVQnvvVeb3NAUiU8WtyuMT9P5clQNdAFjCoLGSEPgb0AFSF3tTCJVY1zlEZHNyfD1Il223bP9TNcg0HKKkLl84DcpqIWo+218lQ0fOUzwyzmk2wspKaftVNJNRcTmn/40zQ2cOps/PwBP5gDxL5cVEqc7JTiUXjm55Pq1eEawZeraYT8cnHme740pH5HRLtPhwHqtZJjDo6WklfIaH15vssNPvs2352Fd9gthu77bMrxew1/l+HPlK5n//uLgPyw2+OYtzmMbGMeeyrVIc0mzjuU6U86iLXs3ZneQ75WtE3GlktntAXjirqwAAY5QvJAS+Au6CLpsNybZpXmQ6QT2D1T2FD+XDH8F/zW1q/JDC6K4tUn8OdLI5bZKOLzL/mg5BoY5Ta/Tgfj3RVwV/oXTULyk+RgQI3r8LabzGa/Ytzhhf/n7Sy3RuU7MfJkaH1PnNom/D/jiwOxBP6+6VCvfoCNCLm3/Zfp/9hf2xIeqFebEKVvXpuIAe3MYHWa4QsN1zmQNNhb9u0dG0EXHSHhMa7NN54ICZEA4ZSpkjpGHFTCphXimrythWzikVXFDJNddIobvBanKLWqT6YkQ+u+tlWCxgsVGy0x6bhdhnwbwDdvvikOWEOcLUr5hRJUwrZVEZ68rZVcEZlVxyTTE33OAx0ke0FKsG0mAK7BAjR7Qk0dJpyJApg4Z8GZLFyhQnHvxu8CP+jMynPz/j8guSlwM4KV6ifGmi5YD/6/BzAKzQpE2bPlMTlcuTl6dq2rUytbX1TU0WzivntQqurNY6u5MjVzLtpnRtWw7iRp5EKl6ahB130VJJJekKoQN/oqJc2+Lfzy/+hvriX5xvfD8oXD0yOH5Olx9l6iWYUb1Cvc8wnl7rAQgTA3i/cP+vTkxCSkZOQUlFDcOPRABOkBBhIkSJESdBkhRpMmTJkadAkRJlKlSpUadBkxZtOnTp0WfAkBFjBBOmzJizYMmKNRu27Nhz4MiJMxeu3Ljz4MmLNx++/PgLEChIsBChwoSLEClKtBHEiJgQM2JBrIgNsSMORplyFSpVqUYxnCApmmE5XhAlWVE13TAdTpfb4/X5A8FQOBKNxRPJVDqTzeULxZLKspLfcz6EI4StRVJjlAGJycbOwcnFzcPLxx9aHWwAAAAAAAAAAEREREREREREIiIiIiIiIlVCcwEAAA==) format("woff2");font-display:block}.dcg-calculator-api-container-v1_10 :not(.dcg-main)>.dcg-mathquill-wrapper{display:inline-block}.dcg-calculator-api-container-v1_10 :not(.dcg-main)>.dcg-mathquill-wrapper .dcg-braille-input,.dcg-calculator-api-container-v1_10 :not(.dcg-main)>.dcg-mathquill-wrapper .dcg-mq-container{display:block}.dcg-calculator-api-container-v1_10 .dcg-mathquill-wrapper .dcg-mathquill-braille .dcg-braille-input{background:none;width:100%;border:none;font-family:Abraham,serif;font-size:125%;padding:1px 0}.dcg-calculator-api-container-v1_10 .dcg-mathquill-wrapper .dcg-mathquill-braille .dcg-braille-input:focus{outline:none}.dcg-calculator-api-container-v1_10 .dcg-mathquill-wrapper .dcg-mathquill-braille .dcg-inline-braille{position:absolute;left:-1000px;top:-1000px;width:0;height:0;overflow:hidden}.dcg-calculator-api-container-v1_10 .dcg-mathquill-wrapper .dcg-mathquill-braille.dcg-mathquill-braille-overflow-left .dcg-tooltip-hit-area-container:before{content:"";position:absolute;top:0;left:0;bottom:0;width:14px;background:linear-gradient(to left,#fff0,#fff);pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-mathquill-wrapper .dcg-mathquill-braille.dcg-mathquill-braille-overflow-right .dcg-tooltip-hit-area-container:after{content:"";position:absolute;top:0;right:0;bottom:0;width:14px;background:linear-gradient(to right,#fff0,#fff);pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-mathquill-wrapper .dcg-mathquill-braille .dcg-tooltip-hit-area-container{display:block}.dcg-calculator-api-container-v1_10 .dcg-expression-edit-actions{padding-left:5px;padding-right:7px;white-space:nowrap;position:absolute;top:0;right:0;bottom:0;background:var(--dcg-custom-background-color, #fff)}.dcg-calculator-api-container-v1_10 .dcg-expression-edit-actions:not(.dcg-limited-height){bottom:0}.dcg-calculator-api-container-v1_10 .dcg-expression-edit-actions .dcg-graphic{height:100%;background:linear-gradient(to right,rgba(255,255,255,0),var(--dcg-custom-background-color, #fff));position:absolute;top:0;right:100%;width:40px;cursor:default;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-expression-edit-actions .dcg-exp-action-button{margin-left:2px;width:44px;height:44px;padding:12px 10px;text-align:center;margin-top:4px;display:inline-block;font-size:125%;line-height:20px;opacity:.6;border-radius:5px}.dcg-calculator-api-container-v1_10 .dcg-expression-edit-actions .dcg-exp-action-button.dcg-hovered{background:#0000001a}.dcg-calculator-api-container-v1_10 .dcg-expression-edit-actions .dcg-exp-action-button.dcg-depressed{opacity:1}.dcg-calculator-api-container-v1_10 .dcg-expression-edit-actions .dcg-exp-action-button.dcg-selected{background:#000000b3;color:#fff}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom{display:flex;flex-wrap:wrap;row-gap:6px;align-items:start;justify-content:space-between}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom>div{flex-basis:100%;flex-grow:1}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-slider_menu{margin-bottom:2px}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-slider-step-container{margin-left:10px}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-slider-step-container.dcg-disabled-input .dcg-math-field,.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-slider-step-container.dcg-disabled-input .dcg-mathquill-braille{opacity:.3;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-slider-step-label{font-size:85%}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-mq-editable-field{outline:none}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-expression-braille-error{flex-basis:100%;color:#666;margin-left:0;font-size:90%}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-expression-braille-error .dcg-icon-error{font-size:80%;margin-right:5px;color:#fa824c}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-slider_menu{margin-top:-3px}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-expression-footer-title{text-transform:uppercase;font-size:80%;color:var(--dcg-custom-text-color, rgba(0, 0, 0, .5));margin-bottom:4px}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-expression-footer-title-help{padding:10px;color:var(--dcg-custom-text-color, rgba(0, 0, 0, .5));margin:-10px -10px -10px -6px;cursor:pointer;text-decoration:none}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-expression-footer-title-help.dcg-hovered{color:#888}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-expression-footer-title-help.dcg-depressed{color:#000}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-label-container:not(.dcg-label-input-visible){flex-basis:auto}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-label-container:not(.dcg-label-input-visible)+.dcg-evaluation-container{flex-basis:auto;margin-top:-6px}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-component-checkbox{white-space:nowrap}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-component-checkbox .dcg-checkbox-children{white-space:wrap}.dcg-calculator-api-container-v1_10 .dcg-expression-footer-title-help{padding:10px;color:var(--dcg-custom-text-color, rgba(0, 0, 0, .5));margin:-10px -10px -10px -6px;cursor:pointer;text-decoration:none}.dcg-calculator-api-container-v1_10 .dcg-expression-footer-title-help.dcg-hovered{color:#888}.dcg-calculator-api-container-v1_10 .dcg-expression-footer-title-help.dcg-depressed{color:#000}.dcg-calculator-api-container-v1_10 .dcg-expression-footer-title{text-transform:uppercase;font-size:80%;color:var(--dcg-custom-text-color, rgba(0, 0, 0, .5));margin-bottom:2px}.dcg-calculator-api-container-v1_10 .dcg-action-info{cursor:default;color:var(--dcg-custom-text-color, #666);font-size:85%}.dcg-calculator-api-container-v1_10 .dcg-action-info .dcg-click-edit{margin-left:5px;opacity:.6}.dcg-calculator-api-container-v1_10 .dcg-action-info .dcg-click-edit.dcg-hovered{opacity:.8}.dcg-calculator-api-container-v1_10 .dcg-action-info .dcg-click-edit.dcg-depressed{opacity:1}.dcg-calculator-api-container-v1_10 .dcg-distribution-parameters-container .dcg-component-checkbox{font-size:85%}.dcg-calculator-api-container-v1_10 .dcg-cdf-footer-container{margin-top:5px}.dcg-calculator-api-container-v1_10 .dcg-cdf-footer-container .dcg-component-checkbox{margin-bottom:4px}.dcg-calculator-api-container-v1_10 .dcg-cdf-footer-container .dcg-parameter-name{font-size:85%}.dcg-calculator-api-container-v1_10 .dcg-cdf-footer-container .dcg-cdf-evaluation-container{margin-top:5px}.dcg-calculator-api-container-v1_10 .dcg-cdf-footer-container .dcg-inline-math-input-view{margin-left:10px;margin-right:10px}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container{display:flex;justify-content:flex-end;margin-right:5px}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-color-swatch{margin-right:-3px;margin-left:-3px}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-equals{margin-right:-4px;margin-left:-4px;opacity:.55}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-equals .dcg-mq-math-mode{pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-equals.dcg-hovered{opacity:.85}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-evaluation{display:flex}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-evaluation.dcg-hidden{opacity:0}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-evaluation .dcg-static-mathquill-view{cursor:pointer}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-evaluation .dcg-mathquill-wrapper .dcg-mathquill-braille{padding:5px 0}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-evaluation .dcg-mathquill-wrapper .dcg-mathquill-braille .dcg-braille-input{text-align:right;color:#666}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-evaluation .dcg-mathquill-wrapper .dcg-typeset-math{padding:3px 6px;border:1px solid rgba(206,206,206,.8);background:#0000000a;color:var(--dcg-custom-text-color, #222);border-radius:4px}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-evaluation .dcg-typeset-math{display:grid;grid-template:"lhs-equals rhs-firstline" min-content/min-content;align-items:center}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-evaluation .dcg-typeset-math .dcg-evaluation-label-container{grid-area:lhs-equals}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-evaluation .dcg-typeset-math .dcg-evaluation-html{grid-area:rhs-firstline}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-evaluation .dcg-evaluation-label-container{font-weight:400;cursor:pointer;white-space:nowrap}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-evaluation .dcg-evaluation-label-container .dcg-mq-math-mode{cursor:pointer;padding-right:2px}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-evaluation .dcg-evaluation-html{white-space:nowrap;border-top-right-radius:5px;border-bottom-right-radius:5px}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-evaluation .dcg-evaluation-html.dcg-color-evaluation{line-height:0}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-evaluation .dcg-evaluation-html .dcg-evaluation-list{position:relative}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-tooltip-hit-area-container{margin-right:.5rem;animation:dcg-fadeIn .3s forwards;display:flex;align-items:center}.dcg-calculator-api-container-v1_10 .dcg-evaluation-container .dcg-tooltip-hit-area-container .dcg-spinner{cursor:pointer}.dcg-calculator-api-container-v1_10 .dcg-color-swatch{width:30px;height:30px;border-radius:3px;overflow:hidden}.dcg-calculator-api-container-v1_10 .dcg-color-swatch.dcg-light-color{box-shadow:0 0 0 1px #0003 inset}.dcg-calculator-api-container-v1_10 .dcg-container.dcg-inverted-swatches .dcg-color-swatch.dcg-light-color{box-shadow:0 0 0 1px #fff3 inset}.dcg-calculator-api-container-v1_10 .dcg-color-swatch.dcg-hovered:not(.dcg-color-evaluation){box-shadow:0 0 0 2px #0000001a}.dcg-calculator-api-container-v1_10 .dcg-color-swatch.dcg-hovered:not(.dcg-color-evaluation).dcg-light-color{box-shadow:0 0 0 2px #0000001a,0 0 0 1px #0003 inset}.dcg-calculator-api-container-v1_10 .dcg-container.dcg-inverted-swatches .dcg-color-swatch.dcg-hovered:not(.dcg-color-evaluation).dcg-light-color{box-shadow:0 0 0 1px #fff3 inset}.dcg-calculator-api-container-v1_10 .dcg-color-swatch.dcg-depressed:not(.dcg-color-evaluation){box-shadow:0 0 0 2px #0003}.dcg-calculator-api-container-v1_10 .dcg-color-swatch.dcg-depressed:not(.dcg-color-evaluation).dcg-light-color{box-shadow:0 0 0 2px #0003,0 0 0 1px #0003 inset}.dcg-calculator-api-container-v1_10 .dcg-container.dcg-inverted-swatches .dcg-color-swatch.dcg-depressed:not(.dcg-color-evaluation).dcg-light-color{box-shadow:0 0 0 1px #fff3 inset}.dcg-calculator-api-container-v1_10 .dcg-color-swatch.dcg-has-background-image{background:#fff;width:30px;height:30px;overflow:hidden;background-size:30px 30px!important;content:""}.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view{display:inline-block;font-size:95%}.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view .dcg-math-field.dcg-math-field{font-size:100%;border-bottom:1px solid rgba(0,0,0,.2);padding:1px 2px;margin:1px;min-width:35px;max-width:70px}.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view .dcg-math-field.dcg-math-field.dcg-focus,.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view .dcg-math-field.dcg-math-field.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view .dcg-math-field.dcg-math-field.dcg-invalid{border-bottom:2px solid #2f72dc;margin-bottom:0}.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view .dcg-math-field.dcg-math-field.dcg-invalid{border-bottom:2px solid #e15855}.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view .dcg-math-field.dcg-math-field.dcg-hovered:not(.dcg-focus):not(.dcg-invalid):not(.dcg-static-mathquill-view):not(.dcg-focus-visible){border-bottom:2px solid #ccc;margin-bottom:0}.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view.dcg-large-font-inline-math-input{font-size:115%}.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view.dcg-log-scale .dcg-math-field{max-width:100px}.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view .dcg-mathquill-braille.dcg-mathquill-braille{font-size:95%;border-bottom:1px solid rgba(0,0,0,.2);padding:1px 2px;margin:1px;min-width:35px;max-width:35px}.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view .dcg-mathquill-braille.dcg-mathquill-braille.dcg-focus,.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view .dcg-mathquill-braille.dcg-mathquill-braille.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view .dcg-mathquill-braille.dcg-mathquill-braille.dcg-invalid{border-bottom:2px solid #2f72dc;margin-bottom:0}.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view .dcg-mathquill-braille.dcg-mathquill-braille.dcg-invalid{border-bottom:2px solid #e15855}.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view .dcg-mathquill-braille.dcg-mathquill-braille.dcg-hovered:not(.dcg-focus):not(.dcg-invalid):not(.dcg-static-mathquill-view):not(.dcg-focus-visible){border-bottom:2px solid #ccc;margin-bottom:0}.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view .dcg-mathquill-braille.dcg-mathquill-braille .dcg-tooltip-hit-area-container{width:100%}.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view.dcg-full-width-inline-math-input .dcg-math-field,.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view.dcg-full-width-inline-math-input .dcg-mathquill-braille{width:100%;max-width:100%}.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view.dcg-no-border-inline-math-input .dcg-math-field,.dcg-calculator-api-container-v1_10 .dcg-inline-math-input-view.dcg-no-border-inline-math-input .dcg-mathquill-braille{border-bottom:1px solid transparent}.dcg-calculator-api-container-v1_10 .dcg-parameter-suggestion-container{font-size:80%;position:relative;top:-9px;margin-left:2px;white-space:nowrap;width:100%;padding-right:5px;text-overflow:ellipsis;overflow:hidden;color:#666;cursor:default}.dcg-calculator-api-container-v1_10 .dcg-parameter-suggestion-container.dcg-parameter-suggestion-braille{top:-6px}.dcg-calculator-api-container-v1_10 .dcg-parameter-suggestion-container.dcg-hovered .dcg-default-marker{color:#666}.dcg-calculator-api-container-v1_10 .dcg-parameter-suggestion-container.dcg-depressed .dcg-default-marker{color:#333}.dcg-calculator-api-container-v1_10 .dcg-parameter-suggestion-container .dcg-default-marker{color:#00000080;margin-left:.3em}.dcg-calculator-api-container-v1_10 .dcg-parameter-suggestion-container .dcg-parameter-name:not(:last-of-type):after{content:",";margin-right:5px}.dcg-calculator-api-container-v1_10 .dcg-display-domain{font-size:95%;white-space:nowrap}.dcg-calculator-api-container-v1_10 .dcg-learn-more-link{display:inline-block;color:#949494;text-decoration:none;padding:5px;font-size:85%;position:relative;top:1px}.dcg-calculator-api-container-v1_10 .dcg-learn-more-link.dcg-hovered{color:#666}.dcg-calculator-api-container-v1_10 .dcg-learn-more-link.dcg-active{color:#333}.dcg-calculator-api-container-v1_10 .dcg-update-behavior-btn{height:25px;line-height:25px;padding:0 10px;margin-top:3px;margin-right:.3rem;color:#000}.dcg-calculator-api-container-v1_10 .dcg-warning-footer-learn-more{margin-right:.3rem}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-editable-mode-toggle{padding-left:5px}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-label-container{cursor:default;display:flex;align-items:center;min-height:18px}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-label-container input{min-width:5px;font-size:var(--dcg-minimum-input-font-size, inherit);margin-left:5px;flex:1;background:var(--dcg-custom-background-color-shaded);color:var(--dcg-custom-text-color, #000);outline:none;border:1px solid #bbb;border-top:0!important;border-right:0!important;border-left:0!important;color:#000;padding:1px 2px;-webkit-appearance:none;appearance:none;border-radius:0}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-label-container input.dcg-hovered{border-color:#ccc;box-shadow:0 1px #ccc}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-label-container input:focus:not([disabled]){border-color:#2f72dc;box-shadow:0 1px #2f72dc}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-label-container input.dcg-disabled-editable-input{opacity:0;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-label-container input.dcg-readonly{pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-label-container .dcg-computed-label-value{margin-left:2px;color:#949494;flex:1}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-label-container .dcg-computed-label-value .dcg-mq-math-mode{width:100%}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-label-container.dcg-label-visible .dcg-checkbox{color:#666}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-editable-mode-toggle{position:relative;top:-3px}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expression-bottom .dcg-label-container{font-size:100%}.dcg-calculator-api-container-v1_10 .dcg-expression-bottom .dcg-label-container{font-size:80%;color:var(--dcg-custom-text-color, rgba(0, 0, 0, .5));padding-right:6px}.dcg-calculator-api-container-v1_10 .dcg-prompt-rename{display:inline-block;font-size:90%;margin-bottom:-3px}.dcg-calculator-api-container-v1_10 .dcg-prompt-rename .dcg-btn-light-gray{padding:2px 5px;margin-left:6px;margin-right:6px}.dcg-calculator-api-container-v1_10 .dcg-prompt-rename .dcg-reference-count{color:#949494}.dcg-calculator-api-container-v1_10 .dcg-create-sliders{display:flex;flex-wrap:wrap;align-items:center;margin-top:-2px}.dcg-calculator-api-container-v1_10 .dcg-create-sliders .dcg-msg{margin-right:5px;font-size:80%;color:var(--dcg-custom-text-color, rgba(0, 0, 0, .6))}.dcg-calculator-api-container-v1_10 .dcg-create-sliders .dcg-all .dcg-btn-slider{font-style:normal}.dcg-calculator-api-container-v1_10 .dcg-create-sliders .dcg-btn-slider{padding:0 4px!important;min-width:35px;font-family:times;font-size:85%;font-style:italic}.dcg-calculator-api-container-v1_10 .dcg-create-sliders .dcg-btn-slider .dcg-mq-math-mode{pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-create-sliders .dcg-btn-slider.dcg-base-case-btn{font-size:80%}.dcg-calculator-api-container-v1_10 .dcg-create-sliders .dcg-slider-btn-container{display:inline-block;position:relative;margin-right:3px;margin-top:1.5px;margin-bottom:1.5px}.dcg-calculator-api-container-v1_10 .dcg-create-sliders .dcg-slider-btn-container .dcg-btn-slider{line-height:24px}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view{font-size:.8rem;color:var(--dcg-custom-text-color, #222);cursor:default;white-space:pre-wrap}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-statistics{min-width:130px;float:left;margin-bottom:10px}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-residuals{float:left;width:130px;margin-bottom:10px}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-residuals>.dcg-mathquill-wrapper{display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-indented-r-value{padding-left:.8em}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-residual-suggestion{padding:2px 8px;margin-left:7px;line-height:16px;display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-residuals-zoom-view{display:inline-block;animation:dcg-fadeIn .3s;position:relative;top:1px}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-residuals-zoom-view .dcg-icon-zoom-fit{padding:3px;opacity:.5;font-size:.85rem}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-residuals-zoom-view .dcg-icon-zoom-fit.dcg-hovered{opacity:.75}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-residuals-zoom-view .dcg-icon-zoom-fit.dcg-depressed{opacity:1}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-log-mode-toggle{clear:both}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-log-mode-toggle.dcg-visible{display:block}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-log-mode-toggle .dcg-action-log-mode-toggle{cursor:pointer;padding:5px 0;color:#454545;border-radius:4px;display:inline-block;margin-bottom:12px}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-log-mode-toggle .dcg-action-log-mode-toggle .dcg-log-mode-checkbox{width:15px;height:15px;border:1px solid rgba(0,0,0,.2);float:left;margin-right:6px;border-radius:3px;position:relative}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-log-mode-toggle .dcg-action-log-mode-toggle .dcg-log-mode-checkbox i{color:transparent}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-log-mode-toggle .dcg-action-log-mode-toggle.dcg-no-hover-styling{cursor:default}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-log-mode-toggle .dcg-action-log-mode-toggle.dcg-hovered .dcg-log-mode-checkbox{border-color:#aaa}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-log-mode-toggle .dcg-action-log-mode-toggle.dcg-depressed .dcg-log-mode-checkbox{border-color:#666}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-log-mode-toggle .dcg-log-mode-toggle-help{text-decoration:none;color:#0003;padding:10px 6px}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-log-mode-toggle .dcg-log-mode-toggle-help.dcg-hovered{color:#aaa}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-log-mode-toggle .dcg-log-mode-toggle-help.dcg-depressed{color:#666}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-parameters-container{clear:both;padding-bottom:4px}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-parameters-container .dcg-static-mathquill-view{float:left;min-width:130px;padding-right:5px}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-parameters-container .dcg-static-mathquill-view:nth-of-type(odd){clear:both}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-parameter-warning{color:#666;margin-right:5px;margin-bottom:5px}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-parameter-warning i{font-size:85%}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-parameter-warning a{color:#666;text-decoration:underline}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-parameter-warning a.dcg-hovered{color:#000}.dcg-calculator-api-container-v1_10 .dcg-regression-footer-view .dcg-parameter-warning .dcg-btn{padding:2px 5px;margin-top:4px}.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-suggested-zoom-view,.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-residuals-zoom-view,.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-generate-table-view,.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-add-regression-view{position:absolute;bottom:7px;left:50%;font-size:20px;line-height:20px;margin-left:-10px;text-align:center;animation:dcg-fadeIn .3s}.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-suggested-zoom-view i,.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-residuals-zoom-view i,.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-generate-table-view i,.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-add-regression-view i{padding:5px;margin-left:-5px;opacity:.75}.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-suggested-zoom-view i.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-residuals-zoom-view i.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-generate-table-view i.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-add-regression-view i.dcg-hovered{opacity:.9}.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-suggested-zoom-view i.dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-residuals-zoom-view i.dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-generate-table-view i.dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-add-regression-view i.dcg-depressed{opacity:1}.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-suggested-zoom-view i.dcg-icon-create-table,.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-residuals-zoom-view i.dcg-icon-create-table,.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-generate-table-view i.dcg-icon-create-table,.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-add-regression-view i.dcg-icon-create-table{font-size:22px;margin-left:-3px}.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-add-regression-view{bottom:auto;top:15px}.dcg-calculator-api-container-v1_10 .dcg-tab .dcg-add-regression-view:after{content:"";width:1px;background:currentColor;height:20px;position:absolute;top:0;left:9px;transform:rotate(22deg);pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-slider-container{min-height:22px;display:block;position:relative}.dcg-calculator-api-container-v1_10 .dcg-slider{display:flex;margin-left:-15px;justify-content:center;align-items:center}.dcg-calculator-api-container-v1_10 .dcg-disable-slider{opacity:.3}.dcg-calculator-api-container-v1_10 .dcg-slider-interior{flex:1;position:relative;top:-4px;margin-left:7px;margin-right:7px;touch-action:none}.dcg-calculator-api-container-v1_10 .dcg-slider-interior .dcg-thumb{cursor:pointer;z-index:3;border-radius:8px;position:absolute;top:-8px;margin-left:-19px;width:38px;height:38px}.dcg-calculator-api-container-v1_10 .dcg-slider-interior .dcg-thumb:focus{outline:none}.dcg-calculator-api-container-v1_10 .dcg-slider-interior .dcg-thumb:focus:after{position:absolute;top:-4px;left:4px;content:"";pointer-events:none;border:2px solid rgba(47,114,220,.35);border-radius:50%;width:26px;height:26px}.dcg-calculator-api-container-v1_10 .dcg-slider-interior .dcg-thumb .dcg-graphic{position:absolute;top:0;left:8px;border-radius:12px;width:22px;height:22px;background:#2f72dc59}.dcg-calculator-api-container-v1_10 .dcg-slider-interior .dcg-thumb .dcg-center{position:absolute;top:0;left:8px;border-radius:12px;width:22px;height:22px;background:#2f72dc;transform:scale(.25);transition:transform .2s}.dcg-calculator-api-container-v1_10 .dcg-slider-interior .dcg-thumb.dcg-hovered .dcg-center,.dcg-calculator-api-container-v1_10 .dcg-slider-interior .dcg-thumb.dcg-down .dcg-center{transform:scale(1)}.dcg-calculator-api-container-v1_10 .dcg-slider-interior .dcg-zeroMarker{position:absolute;top:2px;z-index:2;width:2px;height:2px;background:#0003;border-radius:2px}.dcg-calculator-api-container-v1_10 .dcg-slider-interior .dcg-track{cursor:pointer;height:22px;position:absolute;left:0;right:0}.dcg-calculator-api-container-v1_10 .dcg-slider-interior .dcg-track .dcg-ticks{position:absolute;top:2px;bottom:0;width:100%}.dcg-calculator-api-container-v1_10 .dcg-slider-interior .dcg-track .dcg-ticks .dcg-tick{position:absolute;top:0;width:2px;height:2px;background-color:#fff;margin-left:0;z-index:1;border-radius:2px}.dcg-calculator-api-container-v1_10 .dcg-slider-interior .dcg-track .dcg-graphic{height:6px;background-color:#0000001a;border-radius:3px;margin-bottom:6px;width:100%}.dcg-calculator-api-container-v1_10 .dcg-slider-container .dcg-minLabel{padding:10px 4px 10px 8px}.dcg-calculator-api-container-v1_10 .dcg-slider-container .dcg-maxLabel{padding:10px 8px 10px 4px}.dcg-calculator-api-container-v1_10 .dcg-slider-container .dcg-minLabel,.dcg-calculator-api-container-v1_10 .dcg-slider-container .dcg-maxLabel{z-index:4;color:var(--dcg-custom-text-color, rgba(0, 0, 0, .5));margin:-10px 0;min-width:26px;text-align:center}.dcg-calculator-api-container-v1_10 .dcg-slider-container .dcg-minLabel .dcg-mq-math-mode,.dcg-calculator-api-container-v1_10 .dcg-slider-container .dcg-maxLabel .dcg-mq-math-mode{font-family:arial,sans-serif;cursor:pointer;font-size:80%;position:relative;top:-1px}.dcg-calculator-api-container-v1_10 .dcg-slider-container .dcg-minLabel.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-slider-container .dcg-maxLabel.dcg-hovered{color:#333}.dcg-calculator-api-container-v1_10 .dcg-slider-container .dcg-minLabel.dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-slider-container .dcg-maxLabel.dcg-depressed{color:#000}.dcg-calculator-api-container-v1_10 .dcg-stats-footer-container{padding-right:5px}.dcg-calculator-api-container-v1_10 .dcg-stats-footer-container ul{width:fit-content;margin-left:auto}.dcg-calculator-api-container-v1_10 .dcg-stats-footer-container li.dcg-value{margin:4px 0 2px;border:1px solid rgba(206,206,206,.8);border-radius:4px;background:#0000000a;opacity:.75;display:flex;align-items:center}.dcg-calculator-api-container-v1_10 .dcg-stats-footer-container li.dcg-value .dcg-row-header{border-right:1px solid rgba(206,206,206,.8);margin-right:5px;width:68px;padding:5px}.dcg-calculator-api-container-v1_10 .dcg-stats-footer-container li.dcg-value .dcg-evaluation .dcg-static-mathquill-view{padding:3px 6px 3px 3px}.dcg-calculator-api-container-v1_10 .dcg-stats-footer-container li.dcg-value+.dcg-value{margin-top:5px}.dcg-calculator-api-container-v1_10 .dcg-ttest-footer-container{cursor:text;padding-right:5px}.dcg-calculator-api-container-v1_10 .dcg-ttest-footer-container ul{width:fit-content;margin-left:auto}.dcg-calculator-api-container-v1_10 .dcg-ttest-footer-container li.dcg-value{margin:4px 0 2px;border:1px solid rgba(206,206,206,.8);border-radius:4px;background:#0000000a;opacity:.75;display:flex}.dcg-calculator-api-container-v1_10 .dcg-ttest-footer-container li.dcg-value .dcg-operator .dcg-static-mathquill-view{border-right:1px solid rgba(206,206,206,.8);margin-right:5px;min-width:35px;text-align:center;padding:3px}.dcg-calculator-api-container-v1_10 .dcg-ttest-footer-container li.dcg-value .dcg-evaluation .dcg-static-mathquill-view{padding:3px 6px 3px 3px}.dcg-calculator-api-container-v1_10 .dcg-ttest-footer-container li.dcg-value+.dcg-value{margin-top:5px}.dcg-calculator-api-container-v1_10 .dcg-visualization-parameters-container{margin-bottom:5px}.dcg-calculator-api-container-v1_10 .dcg-visualization-parameters-container .dcg-smaller-font{font-size:85%;margin-left:2px}.dcg-calculator-api-container-v1_10 .dcg-visualization-parameters-container .dcg-mathquill-wrapper{margin-left:10px;margin-right:10px}.dcg-calculator-api-container-v1_10 .dcg-visualization-parameters-container .dcg-parameter-name{font-size:105%}.dcg-calculator-api-container-v1_10 .dcg-visualization-parameters-container .dcg-component-checkbox{margin-top:6px}.dcg-calculator-api-container-v1_10 .dcg-visualization-parameters-container .dcg-toggle-container{display:inline-block;margin-bottom:5px;margin-right:15px}.dcg-calculator-api-container-v1_10 .dcg-tooltipped-error{color:#e66b3c;font-size:22px;display:inline-block;width:26px;height:26px;text-align:center}.dcg-calculator-api-container-v1_10 .dcg-tooltipped-error:not(.dcg-tooltipped-error__instant){animation:dcg-delayed-fadeIn 1s}.dcg-calculator-api-container-v1_10 .dcg-tooltipped-error.dcg-small{font-size:14px;width:16px;height:16px}.dcg-calculator-api-container-v1_10 .dcg-tooltipped-error.dcg-white{color:#fff}.dcg-calculator-api-container-v1_10 .dcg-tooltipped-error-container.dcg-focus-visible{outline:2px solid #8c29be;border-radius:3px}.dcg-calculator-api-container-v1_10 .dcg-action-icon-view i.dcg-icon-chevron-right{font-size:115%;display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-action-icon-view i.dcg-icon-minus{transform:translate(3.5px,-1px);font-size:90%;display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-action-icon-view.dcg-action-icon-view-animating i.dcg-icon-chevron-right{transition:.15s;transform:rotate(360deg)}@keyframes dcg-fadeAndScaleIn{0%{opacity:0;transform:scale(0)}30%{opacity:0;transform:scale(0)}to{opacity:1;transform:scale(1)}}.dcg-calculator-api-container-v1_10 .dcg-circular-icon-container{width:29px;height:29px;border-radius:50%}.dcg-calculator-api-container-v1_10 .dcg-circular-icon-container .dcg-graph-interaction-disabled{position:absolute;bottom:-1px;right:-1px;font-size:.8rem;color:#949494;z-index:10;text-shadow:-1px -1px 0 #fff,-1px 1px 0 #fff,1px -1px 0 #fff,1px 1px 0 #fff,0 -1px 0 #fff,0 1px 0 #fff,1px 0 0 #fff,-1px 0 0 #fff}.dcg-calculator-api-container-v1_10 .dcg-circular-icon{display:inline-block;width:29px;height:29px;line-height:29px;border-radius:50%;position:relative;overflow:hidden}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-semi-transparent{opacity:.4}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-modifier-fade-in{animation:dcg-fadeAndScaleIn .3s}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-hidden{box-shadow:inset 0 0 3px #0003}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-hidden:before{position:absolute;top:0;left:0;bottom:0;right:0;border:5px solid #949494;border-radius:50%;opacity:.25;content:""}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-hidden.dcg-white-icon:before{border-color:#fff;opacity:.4}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-hidden.dcg-hovered:before{opacity:.3125}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-hidden.dcg-hovered.dcg-white-icon:before{opacity:.5}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-hidden.dcg-depressed:before{opacity:.375}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-hidden.dcg-depressed.dcg-white-icon:before{opacity:.6}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-thick-outline{border:2px solid #000;opacity:.5;color:#000;text-align:center}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-thick-outline.dcg-hovered{opacity:.7}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-thick-outline.dcg-depressed{opacity:.9}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-thick-outline .dcg-icon-folder{position:relative;top:-1px;font-size:110%}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-thick-outline .dcg-icon-sound-wave{position:relative;font-size:180%;top:2.5px}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-thick-outline .dcg-icon-pause{position:relative;top:-1px;left:.25px}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-thick-outline .dcg-icon-volume-up{position:relative;left:.25px;font-size:125%}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-thick-outline .dcg-icon-play{position:relative;top:-1px;left:1.5px}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-thick-outline .dcg-icon-fraction{font-size:20px;position:relative;top:2px}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-thick-outline.dcg-white-icon{color:#fff;border-color:#fff;opacity:.9}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-thick-outline.dcg-white-icon.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-thick-outline.dcg-white-icon.dcg-depressed{opacity:1}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image{background:#fff}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image:after{position:absolute;top:0;left:0;bottom:0;right:0;content:"";border-radius:50%;overflow:hidden;box-shadow:inset 0 0 4px #000000b3}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image .dcg-background-image{width:29px;height:29px;display:inline-block;border-radius:50%;background-size:29px 29px!important}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image i{text-shadow:0 0 6px rgba(0,0,0,.2),0 0 1px rgba(0,0,0,.5)}.dcg-calculator-api-container-v1_10 .dcg-circular-icon .dcg-spinner{position:absolute;left:50%;top:50%;margin-top:-10px;margin-left:-10px}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-colored-icon{box-shadow:inset 0 0 3px #0003;overflow:hidden}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-colored-icon i.dcg-layered-icon{text-shadow:0 0 3px rgba(0,0,0,.2)}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-colored-icon{font-size:35px}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image.dcg-modifier-size-medium,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-colored-icon.dcg-modifier-size-medium{font-size:42.25px}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image.dcg-modifier-size-large,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-colored-icon.dcg-modifier-size-large{font-size:56.75px}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image.dcg-modifier-size-small,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-colored-icon.dcg-modifier-size-small{font-size:32.1px}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image.dcg-modifier-rotated,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-colored-icon.dcg-modifier-rotated{transform:rotate(90deg)}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image i.dcg-layered-icon,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-colored-icon i.dcg-layered-icon{position:absolute;top:-3px;left:-30px;right:-30px;bottom:-3px;color:#fff;line-height:35px;text-align:center}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image i.dcg-layered-icon.dcg-icon-check,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-colored-icon i.dcg-layered-icon.dcg-icon-check{font-size:50%}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image i.dcg-layered-icon.dcg-icon-move,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image i.dcg-layered-icon.dcg-icon-move-vertical,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image i.dcg-layered-icon.dcg-icon-move-horizontal,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image i.dcg-layered-icon.dcg-icon-arrow-right,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-colored-icon i.dcg-layered-icon.dcg-icon-move,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-colored-icon i.dcg-layered-icon.dcg-icon-move-vertical,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-colored-icon i.dcg-layered-icon.dcg-icon-move-horizontal,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-colored-icon i.dcg-layered-icon.dcg-icon-arrow-right{font-size:55%}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image i.dcg-layered-icon.dcg-icon-point,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image i.dcg-layered-icon.dcg-icon-cross,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image i.dcg-layered-icon.dcg-icon-open,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-colored-icon i.dcg-layered-icon.dcg-icon-point,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-colored-icon i.dcg-layered-icon.dcg-icon-cross,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-colored-icon i.dcg-layered-icon.dcg-icon-open{font-size:75%}.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image i.dcg-layered-icon.dcg-icon-points,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-has-background-image i.dcg-layered-icon.dcg-icon-lines-solid,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-colored-icon i.dcg-layered-icon.dcg-icon-points,.dcg-calculator-api-container-v1_10 .dcg-circular-icon.dcg-colored-icon i.dcg-layered-icon.dcg-icon-lines-solid{font-size:68%}.dcg-calculator-api-container-v1_10 .dcg-slow-plotting-icon{position:relative;width:29px;height:29px}.dcg-calculator-api-container-v1_10 .dcg-slow-plotting-icon .dcg-slow-plotting-icon__dot{background:#fff;border-radius:100%;width:3px;height:3px;position:absolute;left:13px;top:13px}@keyframes slow_plotting_icon-1{0%{transform:translate(-14.45505px,14.45505px)}20%{transform:translate(-10.875px,-9.0625px)}40%{transform:translate(-14.5px,5.4868px)}60%{transform:translate(9.0625px)}80%{transform:translate(4.35px)}to{transform:translate(5.7826px,-5.7826px)}}.dcg-calculator-api-container-v1_10 .dcg-slow-plotting-icon .dcg-slow-plotting-icon__dot:nth-of-type(1){animation-duration:3s;animation-name:slow_plotting_icon-1;animation-delay:-1.2s;animation-timing-function:ease-in-out;animation-iteration-count:infinite;transform:translate(-28.9101px)}@keyframes slow_plotting_icon-2{0%{transform:translate(-11.56375px,11.56375px)}20%{transform:translate(-9.50475px,-5.2113px)}40%{transform:translate(-12.151px,1.51235px)}60%{transform:translate(7.3312px,-5.3273px)}80%{transform:translate(5.27075px,-3.7207px)}to{transform:translate(8.67245px,-8.67245px)}}.dcg-calculator-api-container-v1_10 .dcg-slow-plotting-icon .dcg-slow-plotting-icon__dot:nth-of-type(2){animation-duration:3s;animation-name:slow_plotting_icon-2;animation-delay:-1.2s;animation-timing-function:ease-in-out;animation-iteration-count:infinite;transform:translate(-23.1275px)}@keyframes slow_plotting_icon-3{0%{transform:translate(-8.67245px,8.67245px)}20%{transform:translate(-7.92425px,-1.41085px)}40%{transform:translate(-9.23505px,-4.0571px)}60%{transform:translate(2.79995px,-8.6188px)}80%{transform:translate(7.58495px,-7.7662px)}to{transform:translate(11.56375px,-11.56375px)}}.dcg-calculator-api-container-v1_10 .dcg-slow-plotting-icon .dcg-slow-plotting-icon__dot:nth-of-type(3){animation-duration:3s;animation-name:slow_plotting_icon-3;animation-delay:-1.2s;animation-timing-function:ease-in-out;animation-iteration-count:infinite;transform:translate(-17.3449px)}@keyframes slow_plotting_icon-4{0%{transform:translate(-5.7826px,5.7826px)}20%{transform:translate(-6.03925px,2.21995px)}40%{transform:translate(-5.26495px,-7.19925px)}60%{transform:translate(-2.79995px,-8.6188px)}80%{transform:translate(-7.58495px,-7.7662px)}to{transform:translate(-2.8913px,2.8913px)}}.dcg-calculator-api-container-v1_10 .dcg-slow-plotting-icon .dcg-slow-plotting-icon__dot:nth-of-type(4){animation-duration:3s;animation-name:slow_plotting_icon-4;animation-delay:-1.2s;animation-timing-function:ease-in-out;animation-iteration-count:infinite;transform:translate(-11.5652px)}@keyframes slow_plotting_icon-5{0%{transform:translate(-2.8913px,2.8913px)}20%{transform:translate(-3.5815px,5.481px)}40%{transform:translate(-2.35045px,-4.37755px)}60%{transform:translate(-7.3312px,-5.3273px)}80%{transform:translate(-5.27075px,-3.7207px)}to{transform:translate(-5.7826px,5.7826px)}}.dcg-calculator-api-container-v1_10 .dcg-slow-plotting-icon .dcg-slow-plotting-icon__dot:nth-of-type(5){animation-duration:3s;animation-name:slow_plotting_icon-5;animation-delay:-1.2s;animation-timing-function:ease-in-out;animation-iteration-count:infinite;transform:translate(-5.7826px)}@keyframes slow_plotting_icon-6{0%{transform:translate(0)}20%{transform:translateY(7.25px)}40%{transform:translate(0)}60%{transform:translate(-9.0625px)}80%{transform:translate(-4.35px)}to{transform:translate(-8.67245px,8.67245px)}}.dcg-calculator-api-container-v1_10 .dcg-slow-plotting-icon .dcg-slow-plotting-icon__dot:nth-of-type(6){animation-duration:3s;animation-name:slow_plotting_icon-6;animation-delay:-1.2s;animation-timing-function:ease-in-out;animation-iteration-count:infinite;transform:translate(0)}@keyframes slow_plotting_icon-7{0%{transform:translate(2.8913px,-2.8913px)}20%{transform:translate(3.5815px,5.481px)}40%{transform:translate(2.35045px,4.37755px)}60%{transform:translate(-7.3312px,5.3273px)}80%{transform:translate(-5.27075px,3.7207px)}to{transform:translate(-11.56375px,11.56375px)}}.dcg-calculator-api-container-v1_10 .dcg-slow-plotting-icon .dcg-slow-plotting-icon__dot:nth-of-type(7){animation-duration:3s;animation-name:slow_plotting_icon-7;animation-delay:-1.2s;animation-timing-function:ease-in-out;animation-iteration-count:infinite;transform:translate(5.7826px)}@keyframes slow_plotting_icon-8{0%{transform:translate(5.7826px,-5.7826px)}20%{transform:translate(6.03925px,2.21995px)}40%{transform:translate(5.26495px,7.19925px)}60%{transform:translate(-2.79995px,8.6188px)}80%{transform:translate(-7.58495px,7.7662px)}to{transform:translate(-14.45505px,14.45505px)}}.dcg-calculator-api-container-v1_10 .dcg-slow-plotting-icon .dcg-slow-plotting-icon__dot:nth-of-type(8){animation-duration:3s;animation-name:slow_plotting_icon-8;animation-delay:-1.2s;animation-timing-function:ease-in-out;animation-iteration-count:infinite;transform:translate(11.5652px)}@keyframes slow_plotting_icon-9{0%{transform:translate(8.67245px,-8.67245px)}20%{transform:translate(7.92425px,-1.41085px)}40%{transform:translate(9.23505px,4.0571px)}60%{transform:translate(2.79995px,8.6188px)}80%{transform:translate(7.58495px,7.7662px)}to{transform:translate(0)}}.dcg-calculator-api-container-v1_10 .dcg-slow-plotting-icon .dcg-slow-plotting-icon__dot:nth-of-type(9){animation-duration:3s;animation-name:slow_plotting_icon-9;animation-delay:-1.2s;animation-timing-function:ease-in-out;animation-iteration-count:infinite;transform:translate(17.3449px)}@keyframes slow_plotting_icon-10{0%{transform:translate(11.56375px,-11.56375px)}20%{transform:translate(9.50475px,-5.2113px)}40%{transform:translate(12.151px,-1.51235px)}60%{transform:translate(7.3312px,5.3273px)}80%{transform:translate(5.27075px,3.7207px)}to{transform:translate(2.8913px,-2.8913px)}}.dcg-calculator-api-container-v1_10 .dcg-slow-plotting-icon .dcg-slow-plotting-icon__dot:nth-of-type(10){animation-duration:3s;animation-name:slow_plotting_icon-10;animation-delay:-1.2s;animation-timing-function:ease-in-out;animation-iteration-count:infinite;transform:translate(23.1275px)}@keyframes slow_plotting_icon-11{0%{transform:translate(14.45505px,-14.45505px)}20%{transform:translate(10.875px,-9.0625px)}40%{transform:translate(14.5px,-5.4868px)}60%{transform:translate(9.0625px)}80%{transform:translate(4.35px)}to{transform:translate(5.7826px,-5.7826px)}}.dcg-calculator-api-container-v1_10 .dcg-slow-plotting-icon .dcg-slow-plotting-icon__dot:nth-of-type(11){animation-duration:3s;animation-name:slow_plotting_icon-11;animation-delay:-1.2s;animation-timing-function:ease-in-out;animation-iteration-count:infinite;transform:translate(28.9101px)}.dcg-calculator-api-container-v1_10 .dcg-play-pause-icon-view .dcg-circular-icon-container.dcg-disabled{opacity:.5;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-play-pause-icon-view .dcg-slider-menu-container{position:absolute;top:100%;left:-5px;right:-5px;margin-top:4px}.dcg-calculator-api-container-v1_10 .dcg-play-pause-icon-view .dcg-slider-menu-opener{margin-left:1px;padding:5px;text-align:center;font-size:140%;cursor:pointer;opacity:.75}.dcg-calculator-api-container-v1_10 .dcg-play-pause-icon-view .dcg-slider-menu-opener:before{content:"";width:24px;height:24px;border-radius:50%;display:inline-block;position:absolute;top:50%;left:50%;margin-left:-12px;margin-top:-13px;background:currentColor;opacity:0}.dcg-calculator-api-container-v1_10 .dcg-play-pause-icon-view .dcg-slider-menu-opener.dcg-hovered{opacity:.9}.dcg-calculator-api-container-v1_10 .dcg-play-pause-icon-view .dcg-slider-menu-opener.dcg-hovered:before{opacity:.15}.dcg-calculator-api-container-v1_10 .dcg-play-pause-icon-view .dcg-slider-menu-opener.dcg-menu-open{opacity:1}.dcg-calculator-api-container-v1_10 .dcg-play-pause-icon-view .dcg-slider-menu-opener.dcg-menu-open:before{opacity:.3}.dcg-calculator-api-container-v1_10 .dcg-play-pause-icon-view .dcg-slider-menu-opener.dcg-depressed{opacity:1}.dcg-calculator-api-container-v1_10 .dcg-play-pause-icon-view .dcg-slider-menu-opener.dcg-depressed:before{opacity:.4}.dcg-calculator-api-container-v1_10 .dcg-top-level-icon{position:absolute;top:0;right:0;width:calc(1.15rem + 12px);height:calc(1.15rem + 16px);overflow:visible;outline-offset:-4px}.dcg-calculator-api-container-v1_10 .dcg-top-level-icon:not(.dcg-tappable){cursor:default!important}.dcg-calculator-api-container-v1_10 .dcg-top-level-icon i{position:absolute;top:0;right:0;padding:8px 7px 20px 20px;z-index:2;opacity:.2;font-size:115%}.dcg-calculator-api-container-v1_10 .dcg-top-level-icon .dcg-top-level-delete,.dcg-calculator-api-container-v1_10 .dcg-top-level-icon .dcg-icon-replace{cursor:pointer}.dcg-calculator-api-container-v1_10 .dcg-top-level-icon .dcg-top-level-delete.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-top-level-icon .dcg-icon-replace.dcg-hovered{opacity:.6}.dcg-calculator-api-container-v1_10 .dcg-top-level-icon .dcg-top-level-delete.dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-top-level-icon .dcg-icon-replace.dcg-depressed{opacity:.8}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu{min-width:222px}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu.dcg-options-menu,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu.dcg-options-menu,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu.dcg-options-menu,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu.dcg-options-menu{padding-left:0;padding-right:0}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-options-menu-content,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-options-menu-content,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-options-menu-content,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-options-menu-content{animation:dcg-fadeIn .3s}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-options-flex-container,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-options-flex-container,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-options-flex-container,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-options-flex-container{display:flex;margin:5px 0;max-width:200px}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-options-left-side,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-options-left-side,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-options-left-side,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-options-left-side{flex:1}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-options-menu-section,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-options-menu-section,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-options-menu-section,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-options-menu-section{padding-left:10px;padding-right:10px}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-options-menu-section:not(:first-of-type),.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-options-menu-section:not(:first-of-type),.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-options-menu-section:not(:first-of-type),.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-options-menu-section:not(:first-of-type){border-top:1px solid #e2e2e2;padding-top:10px;margin-top:10px}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-options-menu-section:not(:first-of-type).dcg-section-without-title,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-options-menu-section:not(:first-of-type).dcg-section-without-title,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-options-menu-section:not(:first-of-type).dcg-section-without-title,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-options-menu-section:not(:first-of-type).dcg-section-without-title{padding-top:3px}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-point-segmented-option,.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-line-segmented-option,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-point-segmented-option,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-line-segmented-option,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-point-segmented-option,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-line-segmented-option,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-point-segmented-option,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-line-segmented-option{width:33px;height:30px;line-height:30px;color:#949494}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-point-segmented-option.dcg-hovered:not(.dcg-selected),.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-line-segmented-option.dcg-hovered:not(.dcg-selected),.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-point-segmented-option.dcg-hovered:not(.dcg-selected),.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-line-segmented-option.dcg-hovered:not(.dcg-selected),.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-point-segmented-option.dcg-hovered:not(.dcg-selected),.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-line-segmented-option.dcg-hovered:not(.dcg-selected),.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-point-segmented-option.dcg-hovered:not(.dcg-selected),.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-line-segmented-option.dcg-hovered:not(.dcg-selected){color:#666}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-point-segmented-option i,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-point-segmented-option i,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-point-segmented-option i,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-point-segmented-option i{font-size:150%}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-line-segmented-option i,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-line-segmented-option i,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-line-segmented-option i,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-line-segmented-option i{font-size:130%}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-iconed-mathquill-row,.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-clickable-menu-row,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-iconed-mathquill-row,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-clickable-menu-row,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-iconed-mathquill-row,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-clickable-menu-row,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-iconed-mathquill-row,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-clickable-menu-row{padding:7px 0 1px}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-iconed-mathquill-row i,.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-iconed-mathquill-row .dcg-font-size,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-iconed-mathquill-row i,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-iconed-mathquill-row .dcg-font-size,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-iconed-mathquill-row i,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-iconed-mathquill-row .dcg-font-size,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-iconed-mathquill-row i,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-iconed-mathquill-row .dcg-font-size{color:var(--dcg-custom-text-color, #949494);margin-right:5px;cursor:pointer;width:13px;display:inline-block;position:relative;top:2px;line-height:1em}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field{font-size:95%;border-bottom:1px solid rgba(0,0,0,.2);padding:1px 2px;margin:1px;min-width:42px;max-width:60px}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-focus,.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-invalid,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-focus,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-invalid,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-focus,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-invalid,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-focus,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-invalid{border-bottom:2px solid #2f72dc;margin-bottom:0}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-invalid,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-invalid,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-invalid,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-invalid{border-bottom:2px solid #e15855}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-hovered:not(.dcg-focus):not(.dcg-invalid):not(.dcg-static-mathquill-view):not(.dcg-focus-visible),.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-hovered:not(.dcg-focus):not(.dcg-invalid):not(.dcg-static-mathquill-view):not(.dcg-focus-visible),.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-hovered:not(.dcg-focus):not(.dcg-invalid):not(.dcg-static-mathquill-view):not(.dcg-focus-visible),.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-iconed-mathquill-row .dcg-math-field.dcg-math-field.dcg-hovered:not(.dcg-focus):not(.dcg-invalid):not(.dcg-static-mathquill-view):not(.dcg-focus-visible){border-bottom:2px solid #ccc;margin-bottom:0}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-line-thickness-row-3d,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-line-thickness-row-3d,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-line-thickness-row-3d,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu .dcg-line-thickness-row-3d{margin-bottom:8px}.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-clickable-menu-row{font-size:90%;display:flex;align-items:baseline;margin-right:2px}.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-clickable-menu-row .dcg-input-label{color:var(--dcg-custom-text-color, #666)}.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-clickable-menu-row .dcg-mathquill-wrapper{flex:1;overflow:hidden}.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-clickable-menu-row .dcg-math-field.dcg-math-field,.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-clickable-menu-row .dcg-braille-input.dcg-braille-input{font-size:95%;border-bottom:1px solid rgba(0,0,0,.2);padding:1px 2px;margin:1px;min-width:100%;max-width:100%}.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-clickable-menu-row .dcg-math-field.dcg-math-field.dcg-focus,.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-clickable-menu-row .dcg-math-field.dcg-math-field.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-clickable-menu-row .dcg-math-field.dcg-math-field.dcg-invalid,.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-clickable-menu-row .dcg-braille-input.dcg-braille-input.dcg-focus,.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-clickable-menu-row .dcg-braille-input.dcg-braille-input.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-clickable-menu-row .dcg-braille-input.dcg-braille-input.dcg-invalid{border-bottom:2px solid #2f72dc;margin-bottom:0}.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-clickable-menu-row .dcg-math-field.dcg-math-field.dcg-invalid,.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-clickable-menu-row .dcg-braille-input.dcg-braille-input.dcg-invalid{border-bottom:2px solid #e15855}.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-clickable-menu-row .dcg-math-field.dcg-math-field.dcg-hovered:not(.dcg-focus):not(.dcg-invalid):not(.dcg-static-mathquill-view):not(.dcg-focus-visible),.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-clickable-menu-row .dcg-braille-input.dcg-braille-input.dcg-hovered:not(.dcg-focus):not(.dcg-invalid):not(.dcg-static-mathquill-view):not(.dcg-focus-visible){border-bottom:2px solid #ccc;margin-bottom:0}.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-clickable-menu-row .dcg-clickable-info-error-container{margin-left:-20px;width:20px;display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-clickable-list-index-notice{font-size:90%;color:#454545;padding-top:5px;line-height:1.2em;width:200px}.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-clickable-list-index-notice .dcg-btn-light-gray{line-height:inherit}.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-index-variable-marker{padding-left:4px;padding-right:4px;font-size:90%;border:1px solid rgba(0,0,0,.2);border-radius:4px}.dcg-calculator-api-container-v1_10 .dcg-clickable-section .dcg-index-variable-marker:not(.dcg-mathquill-has-focus){background:transparent;pointer-events:none;opacity:.75}.dcg-calculator-api-container-v1_10 .dcg-clickable-image-info-view{display:flex;margin-top:20px;justify-content:space-evenly;align-items:center}.dcg-calculator-api-container-v1_10 .dcg-clickable-image-info-view .dcg-tooltip-hit-area-container{margin-left:5px;margin-right:10px}.dcg-calculator-api-container-v1_10 .dcg-clickable-image-info-view .dcg-clickable-image-state-container{position:relative;color:var(--dcg-custom-text-color, #666);text-align:center}.dcg-calculator-api-container-v1_10 .dcg-clickable-image-info-view .dcg-clickable-image-state-container .dcg-clickable-image-state{background:#fff;background-size:cover;background-repeat:no-repeat;width:60px;height:60px;border-radius:10px;border:1px solid rgba(0,0,0,.2)}.dcg-calculator-api-container-v1_10 .dcg-clickable-image-info-view .dcg-clickable-image-state-container .dcg-clickable-image-state-close{position:absolute;top:-10px;right:-2px;width:25px;height:25px;padding-top:5px;font-size:14px;background:#666;color:#fff;border-radius:50%;opacity:.6}.dcg-calculator-api-container-v1_10 .dcg-clickable-image-info-view .dcg-clickable-image-state-container .dcg-clickable-image-state-close.dcg-hovered{opacity:.8}.dcg-calculator-api-container-v1_10 .dcg-clickable-image-info-view .dcg-clickable-image-state-container .dcg-clickable-image-state-close.dcg-depressed{opacity:1}.dcg-calculator-api-container-v1_10 .dcg-toggle-view{float:right;padding:4px 5px 7px;margin:-4px -5px -7px}.dcg-calculator-api-container-v1_10 .dcg-toggle-view .dcg-toggle-track{padding:5px 15px;margin-top:3px;width:30px;height:10px;background:#ddd;border-radius:10px;position:relative;transition:all .2s}.dcg-calculator-api-container-v1_10 .dcg-toggle-view .dcg-toggle-switch{position:absolute;top:-4px;left:0;width:18px;height:18px;background:#f5f5f5;border-radius:50%;transition:all .2s;box-shadow:0 2px 2px #0003,0 0 3px #0003}.dcg-calculator-api-container-v1_10 .dcg-toggle-view:not(.dcg-toggled).dcg-hovered .dcg-toggle-switch{background:#ebebeb}.dcg-calculator-api-container-v1_10 .dcg-toggle-view:not(.dcg-toggled).dcg-depressed .dcg-toggle-switch{background:#e0e0e0}.dcg-calculator-api-container-v1_10 .dcg-toggle-view.dcg-toggled{transition:all .2s}.dcg-calculator-api-container-v1_10 .dcg-toggle-view.dcg-toggled .dcg-toggle-switch{transition:all .2s;left:12px;background:#666}.dcg-calculator-api-container-v1_10 .dcg-toggle-view.dcg-toggled.dcg-hovered .dcg-toggle-switch{background:#555}.dcg-calculator-api-container-v1_10 .dcg-toggle-view.dcg-toggled.dcg-depressed .dcg-toggle-switch{background:#454545}.dcg-calculator-api-container-v1_10 .dcg-color-picker-container{max-height:185px;overflow-y:auto;margin-right:-10px;padding-right:10px;margin-left:-2px;padding-left:2px;margin-bottom:-2px;padding-bottom:2px}.dcg-calculator-api-container-v1_10 .dcg-color-picker-container .dcg-color-picker-menu{display:grid;grid-template-columns:repeat(6,30px);gap:4px;grid-auto-flow:row;grid-auto-rows:30px;padding-top:4px}.dcg-calculator-api-container-v1_10 .dcg-color-picker-container .dcg-color-picker-menu:first-of-type{margin-top:0}.dcg-calculator-api-container-v1_10 .dcg-color-picker-container .dcg-color-picker-menu .dcg-color-tile{position:relative;outline:none}.dcg-calculator-api-container-v1_10 .dcg-color-picker-container .dcg-color-picker-menu .dcg-color-tile.dcg-focus-visible{box-shadow:0 0 0 2px #2f72dc80!important}.dcg-calculator-api-container-v1_10 .dcg-color-picker-container .dcg-color-picker-menu .dcg-color-tile i.dcg-icon-check{position:absolute;top:50%;left:0;right:0;pointer-events:none;height:20px;line-height:20px;color:#fff;margin-top:-10px;text-align:center}.dcg-calculator-api-container-v1_10 .dcg-color-picker-container .dcg-color-picker-menu .dcg-color-tile i.dcg-icon-check.dcg-light-color{color:#454545}.dcg-calculator-api-container-v1_10 .dcg-color-picker-container .dcg-color-picker-menu .dcg-color-tile i.dcg-icon-check.dcg-mixed-color{text-shadow:0 0 3px rgba(0,0,0,.7)}.dcg-calculator-api-container-v1_10 .dcg-color-picker-container .dcg-color-picker-menu .dcg-color-tile i.dcg-icon-lock{color:#949494;text-shadow:-1px -1px 0 #fff,-1px 1px 0 #fff,1px -1px 0 #fff,1px 1px 0 #fff,0 -1px 0 #fff,0 1px 0 #fff,1px 0 0 #fff,-1px 0 0 #fff;position:absolute;bottom:2px;right:2px;font-size:65%}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view{width:78px;height:78px;display:inline-block;position:relative;transition:transform .1s}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-orientation-option{display:inline-block;width:26px;height:26px;line-height:26px;text-align:center;border-radius:50%;color:#bbb}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-orientation-option.dcg-hovered{color:#666}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-orientation-option.dcg-selected{color:#2f72dc}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-orientation-option.dcg-selected.dcg-hovered{color:#2253a1}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-orientation-option i{position:relative;top:2px}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-label-orientation-below-right,.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-label-orientation-above-right,.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-label-orientation-below-left,.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-label-orientation-above-left{color:#e2e2e2}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-orientation-disabled{pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-label-orientation-below-right{position:absolute;bottom:0;right:0;transform:rotate(225deg)}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-label-orientation-below-left{position:absolute;bottom:0;left:0;transform:rotate(315deg)}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-label-orientation-above-right{position:absolute;top:0;right:0;transform:rotate(135deg)}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-label-orientation-above-left{position:absolute;top:0;left:0;transform:rotate(45deg)}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-label-orientation-left{position:absolute;top:26px;left:0}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-label-orientation-right{position:absolute;top:26px;right:0;transform:rotate(180deg)}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-label-orientation-above{position:absolute;top:0;left:26px;transform:rotate(90deg)}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-label-orientation-below{position:absolute;bottom:0;left:26px;transform:rotate(270deg)}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-label-orientation-center{position:absolute;top:26px;left:26px;font-size:200%}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-label-orientation-center:after{content:"";width:12px;height:12px;border-radius:50%;position:absolute;top:50%;left:50%;background:currentColor;margin-top:-6px;margin-left:-6px;box-shadow:0 0 2px #0003}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-label-orientation-center.dcg-orientation-disabled:not(.dcg-selected):after{background:#fff;width:10px;height:10px;margin-top:-5px;margin-left:-5px;box-shadow:0 0 2px #0003,inset 0 0 0 1px #0000001a}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-vertical-orientation-indicator{width:0;height:0;border:4px solid transparent;border-bottom:15px solid #ddd;position:absolute;top:50%;left:50%;margin-top:-19px;margin-left:-4px}.dcg-calculator-api-container-v1_10 .dcg-label-orientation-view .dcg-vertical-orientation-indicator:after{content:"";width:0;height:0;border:4px solid transparent;border-top:15px solid #ddd;position:absolute;top:50%;left:50%;margin-top:15px;margin-left:-4px}.dcg-calculator-api-container-v1_10 body{-webkit-text-size-adjust:100%}.dcg-calculator-api-container-v1_10 pre{white-space:pre-wrap}.dcg-calculator-api-container-v1_10 button,.dcg-calculator-api-container-v1_10 input,.dcg-calculator-api-container-v1_10 select,.dcg-calculator-api-container-v1_10 textarea{font-family:inherit}.dcg-calculator-api-container-v1_10 button,.dcg-calculator-api-container-v1_10 select{text-transform:none}.dcg-calculator-api-container-v1_10 button{-webkit-appearance:button;appearance:button;cursor:pointer;color:inherit}.dcg-calculator-api-container-v1_10 button[disabled],.dcg-calculator-api-container-v1_10 input[disabled]{cursor:default}.dcg-calculator-api-container-v1_10 input[type=search]{-webkit-appearance:textfield;appearance:textfield;box-sizing:content-box}.dcg-calculator-api-container-v1_10 input[type=search]::-webkit-search-cancel-button,.dcg-calculator-api-container-v1_10 input[type=search]::-webkit-search-decoration{-webkit-appearance:none;appearance:none}.dcg-calculator-api-container-v1_10 button::-moz-focus-inner,.dcg-calculator-api-container-v1_10 input::-moz-focus-inner{border:0;padding:0}.dcg-calculator-api-container-v1_10 table{border-collapse:collapse;border-spacing:0}.dcg-calculator-api-container-v1_10 input::-webkit-outer-spin-button,.dcg-calculator-api-container-v1_10 input::-webkit-inner-spin-button{-webkit-appearance:none;appearance:none;margin:0}.dcg-calculator-api-container-v1_10 .dcg-container{text-align:left;transform-origin:0 0}.dcg-calculator-api-container-v1_10 .dcg-background--light-blue{background:#d7e6ff}.dcg-calculator-api-container-v1_10 .dcg-text--dark-blue{color:#17396e}.dcg-calculator-api-container-v1_10 .dcg-text--centered{text-align:center}.dcg-calculator-api-container-v1_10 .dcg-text--uppercase{text-transform:uppercase}.dcg-calculator-api-container-v1_10 .dcg-unstyled-list{list-style-type:none;margin:0;padding:0}.dcg-calculator-api-container-v1_10 .dcg-unstyled-list li{margin:0;text-indent:0}.dcg-calculator-api-container-v1_10 .dcg-forced-color-none{forced-color-adjust:none}.dcg-calculator-api-container-v1_10 .dcg-unstyled-button{font-family:inherit;font-size:inherit;line-height:inherit;margin:0;overflow:visible;text-transform:none;-webkit-appearance:button;border:none;background-color:unset;padding:0}.dcg-calculator-api-container-v1_10 .dcg-unstyled-link{text-decoration:none!important;color:unset}.dcg-calculator-api-container-v1_10 .dcg-unstyled-heading{margin:0;font-size:inherit;font:inherit;font-weight:inherit}@media (prefers-reduced-motion){.dcg-calculator-api-container-v1_10 .dcg-container *,.dcg-calculator-api-container-v1_10 .dcg-container *:after,.dcg-calculator-api-container-v1_10 .dcg-container *:before{transition:none!important;animation-duration:0ms!important;animation-delay:0ms!important}}.dcg-calculator-api-container-v1_10 .dcg-container.dcg-default-border{border:1px solid rgba(0,0,0,.2)}.dcg-calculator-api-container-v1_10 .dcg-container a,.dcg-calculator-api-container-v1_10 .dcg-container a:hover{text-decoration:none}.dcg-calculator-api-container-v1_10 .dcg-container.dcg-no-graphpaper .dcg-grapher,.dcg-calculator-api-container-v1_10 .dcg-container.dcg-no-graphpaper .dcg-resize-list-btn{display:none}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-grapher.dcg-scale-horizontal{cursor:ew-resize}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-grapher.dcg-scale-vertical{cursor:ns-resize}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-grapher.dcg-scale-both{cursor:nesw-resize}.dcg-calculator-api-container-v1_10 .dcg-grapher-focused{box-shadow:inset 0 0 0 3px #2f72dc99}.dcg-calculator-api-container-v1_10 .dcg-graph-outer{overflow:hidden;position:absolute;top:0;left:0;right:0;bottom:0;outline:none}.dcg-calculator-api-container-v1_10 .dcg-container.dcg-no-expression-topbar .dcg-expression-top-bar{display:none}.dcg-calculator-api-container-v1_10 .dcg-container.dcg-no-expression-topbar .dcg-exppanel-container{padding-top:0}.dcg-calculator-api-container-v1_10 .dcg-container.dcg-no-hyperlinks a[target=_blank]{display:none!important}.dcg-calculator-api-container-v1_10 .dcg-container.dcg-inverted-colors{filter:invert(100%)}.dcg-calculator-api-container-v1_10 .dcg-container.dcg-inverted-swatches .dcg-grapher-3d,.dcg-calculator-api-container-v1_10 .dcg-container.dcg-inverted-swatches .dcg-colored-icon,.dcg-calculator-api-container-v1_10 .dcg-container.dcg-inverted-swatches .dcg-color-swatch,.dcg-calculator-api-container-v1_10 .dcg-container.dcg-inverted-swatches .dcg-color-tile>.dcg-icon-check{filter:invert(100%)}.dcg-calculator-api-container-v1_10 .dcg-container{width:100%;height:100%;position:relative;background:var(--dcg-custom-background-color, #fff);color:var(--dcg-custom-text-color, #000);z-index:0;-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;overflow:hidden;font-family:arial,sans-serif;font-size:16px}.dcg-calculator-api-container-v1_10 .dcg-container *{box-sizing:border-box}.dcg-calculator-api-container-v1_10 .dcg-container.dcg-is-interactive,.dcg-calculator-api-container-v1_10 .dcg-container.dcg-is-interactive .dcg-grapher{touch-action:none}.dcg-calculator-api-container-v1_10 .dcg-graphpaper-branding{position:absolute;bottom:0;right:-8px;width:110px;margin-left:-55px;display:none;z-index:21}.dcg-calculator-api-container-v1_10 .dcg-fullscreen .dcg-graphpaper-branding{display:block;opacity:1}.dcg-calculator-api-container-v1_10 .dcg-fullscreen .dcg-graphpaper-branding .dcg-powered-by,.dcg-calculator-api-container-v1_10 .dcg-fullscreen .dcg-graphpaper-branding i{position:relative;text-shadow:-1px -1px 0 #fff,-1px 1px 0 #fff,1px -1px 0 #fff,1px 1px 0 #fff,0 -1px 0 #fff,0 1px 0 #fff,1px 0 0 #fff,-1px 0 0 #fff}.dcg-calculator-api-container-v1_10 .dcg-expressions-branding,.dcg-calculator-api-container-v1_10 .dcg-graphpaper-branding{text-align:center;font-size:75%;text-decoration:none;line-height:1em;height:45px;overflow:hidden}.dcg-calculator-api-container-v1_10 .dcg-expressions-branding.dcg-unclickable,.dcg-calculator-api-container-v1_10 .dcg-graphpaper-branding.dcg-unclickable{pointer-events:none;z-index:-1}.dcg-calculator-api-container-v1_10 .dcg-expressions-branding .dcg-powered-by,.dcg-calculator-api-container-v1_10 .dcg-graphpaper-branding .dcg-powered-by{color:#0003;text-decoration:none;transition:color .3s;display:block}.dcg-calculator-api-container-v1_10 .dcg-expressions-branding i,.dcg-calculator-api-container-v1_10 .dcg-graphpaper-branding i{color:#0003;font-size:650%;margin-right:2px;line-height:18px;transition:color .3s;height:18px}.dcg-calculator-api-container-v1_10 .dcg-expressions-branding a,.dcg-calculator-api-container-v1_10 .dcg-expressions-branding .dcg-edit-branding,.dcg-calculator-api-container-v1_10 .dcg-graphpaper-branding a,.dcg-calculator-api-container-v1_10 .dcg-graphpaper-branding .dcg-edit-branding{cursor:pointer;display:block;height:50px}.dcg-calculator-api-container-v1_10 .dcg-expressions-branding a.dcg-hovered .dcg-powered-by,.dcg-calculator-api-container-v1_10 .dcg-expressions-branding .dcg-edit-branding.dcg-hovered .dcg-powered-by,.dcg-calculator-api-container-v1_10 .dcg-graphpaper-branding a.dcg-hovered .dcg-powered-by,.dcg-calculator-api-container-v1_10 .dcg-graphpaper-branding .dcg-edit-branding.dcg-hovered .dcg-powered-by{color:#aaa}.dcg-calculator-api-container-v1_10 .dcg-expressions-branding a.dcg-hovered i,.dcg-calculator-api-container-v1_10 .dcg-expressions-branding .dcg-edit-branding.dcg-hovered i,.dcg-calculator-api-container-v1_10 .dcg-graphpaper-branding a.dcg-hovered i,.dcg-calculator-api-container-v1_10 .dcg-graphpaper-branding .dcg-edit-branding.dcg-hovered i{color:#127a3d}.dcg-calculator-api-container-v1_10 .dcg-narrow .dcg-graphpaper-branding,.dcg-calculator-api-container-v1_10 .dcg-no-branding .dcg-expressions-branding,.dcg-calculator-api-container-v1_10 .dcg-no-branding .dcg-graphpaper-branding{display:none}.dcg-calculator-api-container-v1_10 .dcg-button,.dcg-calculator-api-container-v1_10 .dcg-btn-blue,.dcg-calculator-api-container-v1_10 .dcg-btn-red,.dcg-calculator-api-container-v1_10 .dcg-btn-light-gray,.dcg-calculator-api-container-v1_10 .dcg-btn-gray-outline,.dcg-calculator-api-container-v1_10 .dcg-btn-blue-outline,.dcg-calculator-api-container-v1_10 .dcg-btn-pink,.dcg-calculator-api-container-v1_10 .dcg-btn-white-outline,.dcg-calculator-api-container-v1_10 .dcg-btn-purple{border:1px solid transparent;text-decoration:none;padding:0 20px;-webkit-appearance:none;appearance:none;-webkit-user-select:none;user-select:none;border-radius:3px;font:inherit;line-height:2.125rem;cursor:pointer;white-space:nowrap;text-align:center}.dcg-calculator-api-container-v1_10 .dcg-button.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-btn-blue.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-btn-red.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-btn-light-gray.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-btn-gray-outline.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-btn-blue-outline.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-btn-pink.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-btn-white-outline.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-btn-purple.dcg-focus-visible{outline:2px solid #8c29be;outline-offset:3px}.dcg-calculator-api-container-v1_10 .dcg-button.dcg-disabled,.dcg-calculator-api-container-v1_10 .dcg-btn-blue.dcg-disabled,.dcg-calculator-api-container-v1_10 .dcg-btn-red.dcg-disabled,.dcg-calculator-api-container-v1_10 .dcg-btn-light-gray.dcg-disabled,.dcg-calculator-api-container-v1_10 .dcg-btn-gray-outline.dcg-disabled,.dcg-calculator-api-container-v1_10 .dcg-btn-blue-outline.dcg-disabled,.dcg-calculator-api-container-v1_10 .dcg-btn-pink.dcg-disabled,.dcg-calculator-api-container-v1_10 .dcg-btn-white-outline.dcg-disabled,.dcg-calculator-api-container-v1_10 .dcg-btn-purple.dcg-disabled{opacity:.5;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-btn-red,.dcg-calculator-api-container-v1_10 .dcg-btn-blue,.dcg-calculator-api-container-v1_10 .dcg-btn-purple,.dcg-calculator-api-container-v1_10 .dcg-btn-gray-outline,.dcg-calculator-api-container-v1_10 .dcg-btn-blue-outline{color:#fff;box-shadow:inset 0 1px #ffffff1a,inset 0 -1px #0000000a}.dcg-calculator-api-container-v1_10 .dcg-btn-purple,.dcg-calculator-api-container-v1_10 .dcg-btn-red,.dcg-calculator-api-container-v1_10 .dcg-btn-blue{white-space:nowrap}.dcg-calculator-api-container-v1_10 .dcg-btn-purple.dcg-hovered:not(.dcg-disabled),.dcg-calculator-api-container-v1_10 .dcg-btn-purple.dcg-focus-visible:not(.dcg-disabled),.dcg-calculator-api-container-v1_10 .dcg-btn-red.dcg-hovered:not(.dcg-disabled),.dcg-calculator-api-container-v1_10 .dcg-btn-red.dcg-focus-visible:not(.dcg-disabled),.dcg-calculator-api-container-v1_10 .dcg-btn-blue.dcg-hovered:not(.dcg-disabled),.dcg-calculator-api-container-v1_10 .dcg-btn-blue.dcg-focus-visible:not(.dcg-disabled){transition:background .2s}.dcg-calculator-api-container-v1_10 .dcg-btn-purple.dcg-depressed:not(.dcg-disabled),.dcg-calculator-api-container-v1_10 .dcg-btn-red.dcg-depressed:not(.dcg-disabled),.dcg-calculator-api-container-v1_10 .dcg-btn-blue.dcg-depressed:not(.dcg-disabled){box-shadow:none}.dcg-calculator-api-container-v1_10 .dcg-btn-purple{background-color:#7c69b3}.dcg-calculator-api-container-v1_10 .dcg-btn-purple.dcg-hovered:not(.dcg-disabled),.dcg-calculator-api-container-v1_10 .dcg-btn-purple.dcg-focus-visible:not(.dcg-disabled){background:#63548f}.dcg-calculator-api-container-v1_10 .dcg-btn-purple.dcg-depressed:not(.dcg-disabled){background:#4f4372}.dcg-calculator-api-container-v1_10 .dcg-btn-red{background:#ce4945}.dcg-calculator-api-container-v1_10 .dcg-btn-red.dcg-hovered:not(.dcg-disabled),.dcg-calculator-api-container-v1_10 .dcg-btn-red.dcg-focus-visible:not(.dcg-disabled){background:#bc433f}.dcg-calculator-api-container-v1_10 .dcg-btn-red.dcg-depressed:not(.dcg-disabled){background:#b03936}.dcg-calculator-api-container-v1_10 .dcg-btn-blue{background:#2f72dc}.dcg-calculator-api-container-v1_10 .dcg-btn-blue.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-btn-blue.dcg-focus-visible{background:#2457a8}.dcg-calculator-api-container-v1_10 .dcg-btn-blue.dcg-depressed{background:#17396e}.dcg-calculator-api-container-v1_10 .dcg-btn-blue-outline{background:#fff;border:1px solid #2f72dc;color:#2f72dc}.dcg-calculator-api-container-v1_10 .dcg-btn-blue-outline.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-btn-blue-outline.dcg-focus-visible{border-color:#2457a8;box-shadow:0 0 0 1px #2457a8;color:#2253a1}.dcg-calculator-api-container-v1_10 .dcg-btn-blue-outline.dcg-depressed{border-color:#17396e;box-shadow:0 0 0 1px #17396e;color:#17396e;background:#2f72dc1a}.dcg-calculator-api-container-v1_10 .dcg-btn-pink{background:#b92a73;color:#fff}.dcg-calculator-api-container-v1_10 .dcg-btn-pink.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-btn-pink.dcg-focus-visible{background:linear-gradient(0deg,#0000000a 0% 100%),#b92a73}.dcg-calculator-api-container-v1_10 .dcg-btn-pink.dcg-depressed{box-shadow:0 3px 3px inset #0003}.dcg-calculator-api-container-v1_10 .dcg-btn-gray-outline{background:#fff;border:1px solid #949494;color:#666}.dcg-calculator-api-container-v1_10 .dcg-btn-gray-outline.dcg-hovered:not(.dcg-disabled),.dcg-calculator-api-container-v1_10 .dcg-btn-gray-outline.dcg-focus-visible:not(dcg-disabled){border-color:#454545;box-shadow:0 0 0 1px #454545;color:#454545}.dcg-calculator-api-container-v1_10 .dcg-btn-gray-outline.dcg-depressed:not(.dcg-disabled){border-color:#000;box-shadow:0 0 0 1px #000;color:#000;background:#0000001a}.dcg-calculator-api-container-v1_10 .dcg-btn-white-outline{border:1px solid rgba(250,250,250,.8);color:#fafafae6}.dcg-calculator-api-container-v1_10 .dcg-btn-white-outline.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-btn-white-outline.dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-btn-white-outline.dcg-focus-visible{border-color:#fafafae6;box-shadow:0 0 0 1px #fafafae6;color:#fff}.dcg-calculator-api-container-v1_10 .dcg-btn-white-outline.dcg-depressed{background:#fafafa1a}.dcg-calculator-api-container-v1_10 .dcg-btn-light-gray{box-shadow:inset 0 1px #ffffff40,inset 0 -1px #00000005;background:linear-gradient(var(--dcg-custom-background-color, #f6f6f6),var(--dcg-custom-background-color-shaded, #eff2f3));border:1px solid rgba(206,206,206,.8)}.dcg-calculator-api-container-v1_10 .dcg-btn-light-gray.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-btn-light-gray.dcg-focus-visible{background:var(--dcg-custom-background-color-shaded, #eff2f3);border:1px solid #bbb}.dcg-calculator-api-container-v1_10 .dcg-btn-light-gray.dcg-depressed{background:var(--dcg-custom-background-color-shaded, #ccc);border:1px solid #949494;box-shadow:none}.dcg-calculator-api-container-v1_10 .dcg-primary-link{color:#2f72dc;cursor:pointer;text-decoration:underline}.dcg-calculator-api-container-v1_10 .dcg-primary-link.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-primary-link.dcg-focus-visible{color:#2253a1}.dcg-calculator-api-container-v1_10 .dcg-primary-link.dcg-depressed{color:#17396e}.dcg-calculator-api-container-v1_10 .dcg-inverted-colors .dcg-btn-red,.dcg-calculator-api-container-v1_10 .dcg-inverted-colors .dcg-btn-blue{box-shadow:inset 0 -1px #ffffff26,inset 0 1px #0000001a}.dcg-calculator-api-container-v1_10 input.dcg-input-blue-outline,.dcg-calculator-api-container-v1_10 textarea.dcg-input-blue-outline{outline:none;border-radius:3px;border:1px solid #bbb;padding:7px;-webkit-appearance:none;appearance:none;font-size:inherit;box-sizing:border-box}.dcg-calculator-api-container-v1_10 input.dcg-input-blue-outline:focus,.dcg-calculator-api-container-v1_10 textarea.dcg-input-blue-outline:focus{border:1px solid #2f72dc;box-shadow:0 0 0 1px #2f72dc}.dcg-calculator-api-container-v1_10 input.dcg-input-blue-outline::-ms-clear,.dcg-calculator-api-container-v1_10 textarea.dcg-input-blue-outline::-ms-clear{display:none}.dcg-calculator-api-container-v1_10 .dcg-navigation-arrow{color:#949494;font-size:170%;text-decoration:none;margin:0 -5px -5px;padding:10px}.dcg-calculator-api-container-v1_10 .dcg-navigation-arrow.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-navigation-arrow.dcg-focus-visible{color:#666}.dcg-calculator-api-container-v1_10 .dcg-navigation-arrow.dcg-depressed{color:#000}.dcg-calculator-api-container-v1_10 .dcg-blue-link{color:#2f72dc;cursor:pointer;text-decoration:underline}.dcg-calculator-api-container-v1_10 .dcg-blue-link.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-blue-link.dcg-focus-visible{color:#2253a1}.dcg-calculator-api-container-v1_10 .dcg-blue-link.dcg-focus-visible{outline:2px solid #8c29be;outline-offset:3px}.dcg-calculator-api-container-v1_10 .dcg-blue-link.dcg-depressed{color:#17396e}.dcg-calculator-api-container-v1_10 .dcg-gray-link{color:#666;cursor:pointer;text-decoration:underline}.dcg-calculator-api-container-v1_10 .dcg-gray-link.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-gray-link.dcg-focus-visible{color:#454545}.dcg-calculator-api-container-v1_10 .dcg-gray-link.dcg-depressed{color:#000}.dcg-calculator-api-container-v1_10 .dcg-shared-tab-gray-underline{text-align:center;display:inline-block;padding:5px 0;margin:5px 0;color:#666;text-decoration:none}.dcg-calculator-api-container-v1_10 .dcg-shared-tab-gray-underline.dcg-shared-tab-always-underline{border-bottom:3px solid #e2e2e2}.dcg-calculator-api-container-v1_10 .dcg-shared-tab-gray-underline:not(.dcg-shared-tab-always-underline).dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-shared-tab-gray-underline:not(.dcg-shared-tab-always-underline).dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-shared-tab-gray-underline:not(.dcg-shared-tab-always-underline).dcg-selected{padding-bottom:2px}.dcg-calculator-api-container-v1_10 .dcg-shared-tab-gray-underline.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-shared-tab-gray-underline.dcg-focus-visible{border-bottom:3px solid #bbb}.dcg-calculator-api-container-v1_10 .dcg-shared-tab-gray-underline.dcg-depressed{color:#000;border-bottom:3px solid #949494}.dcg-calculator-api-container-v1_10 .dcg-shared-tab-gray-underline.dcg-selected{color:#2f72dc;border-bottom:3px solid #2f72dc;cursor:pointer}.dcg-calculator-api-container-v1_10 input.dcg-shared-input-blue-outline,.dcg-calculator-api-container-v1_10 textarea.dcg-shared-input-blue-outline{outline:none;border-radius:3px;border:1px solid #bbb;padding:7px;-webkit-appearance:none;appearance:none;font:inherit;box-sizing:border-box}.dcg-calculator-api-container-v1_10 input.dcg-shared-input-blue-outline:focus,.dcg-calculator-api-container-v1_10 textarea.dcg-shared-input-blue-outline:focus{border:1px solid #2f72dc;box-shadow:0 0 0 1px #2f72dc}.dcg-calculator-api-container-v1_10 input.dcg-shared-input-blue-outline::-ms-clear,.dcg-calculator-api-container-v1_10 textarea.dcg-shared-input-blue-outline::-ms-clear{display:none}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expressionitem textarea.dcg-smart-textarea,.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expressionitem .dcg-displayTextarea{font-size:113%}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expressionimage .dcg-image-loaded .dcg-mq-math-mode{font-size:130%}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-poi-label{font-size:150%}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-poi-label .dcg-pt{border-width:8px;border-radius:8px;margin-left:-4px;margin-top:-4px}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-poi-label.dcg-hole .dcg-pt{border-width:4px;padding:5px;border-radius:9px}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-poi-label:not(.dcg-tracept) .dcg-pt{border-width:8px;border-radius:8px;margin-left:-3px;margin-top:-3px}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expressionitem .dcg-mq-editable-field,.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expressionitem .dcg-mq-math-mode,.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expressionitem .dcg-slider-container .dcg-mq-math-mode,.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expressionitem .dcg-mathquill-braille{font-size:150%}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expressionitem .dcg-mq-placeholder{margin-top:-.88em}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expressionitem .dcg-fade-container .dcg-evaluation{font-size:135%}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expressionitem .dcg-fade-container .dcg-evaluation .dcg-mq-editable-field,.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expressionitem .dcg-fade-container .dcg-evaluation .dcg-mq-math-mode,.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expressionitem .dcg-fade-container .dcg-evaluation .dcg-mathquill-braille{font-size:100%}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expressionitem .dcg-fade-container .dcg-main:after{width:2px}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expressionitem .dcg-create-sliders{line-height:30px}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expressionitem .dcg-create-sliders .dcg-msg{font-size:1rem}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expressionitem .dcg-create-sliders .dcg-btn-slider,.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expressionitem .dcg-create-sliders .dcg-btn-slider .dcg-mq-math-mode{font-size:1.25rem}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-expressionitem .dcg-slider{bottom:30px}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-display-domain{bottom:12px;font-size:110%}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-slider_menu{bottom:6px}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-slider_menu .dcg-mq-editable-field,.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-slider_menu .dcg-mq-math-mode{font-size:120%}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-slider_menu table{border-collapse:collapse;font-size:20px;margin:0 auto}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-slider_menu table input{font-size:81%}@font-face{font-family:dcg-icons-2024-11-06;src:url(data:font/woff2;base64,d09GMgABAAAAAFf0AAsAAAAAsxwAAFehAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAAg1gRCAqC01iCjRwBNgIkA4RYC4IuAAQgBYQiByAb740lY5tFzCA7AVJ12vwPjqJUz9IoaqIklS/7/48JcowYG3Wg4n9ZqmyjIBCQQHFdrrqoUmTJjr3jSOsoY0nRgSLH7FhLa8fYwU0QG7lBtAUh19nnJThCogIMgB796b+I+5lxV1AIyEPyxQ48tWD3zl3BHzLliVfHdwJXmeOYd33JERr7JPeIbKuq7pnZmY3TswvsAsLO7AImdJOKorIJMN7BKpgCwctmlosGsuffGfJFI8aMF9QL3OtFc7ik3nkpARXd5mfvDUOKg4CDFsgTbN/l/pZipsfwCUOpxDOaPn8jbClQSLuFxiG//B2en9v/uXcbu6uAIYMxYIwcOUbUGljANthGqXQPTBDaRFDBKgRtrARtePjeE1+B+cL/n4L9SiE6EAcnB+HAYVESYA3qVOmV2u4yy0yLTJQi2R5f9BxrAMynmw9r/6qub//TcLferZYEbUkcvKXhk5CvgpwM/aY+t/mxedJm7Xs+UwFuYvWp88P9wu8JCZFKDGLVaGVuSe7LqT8jSPt2BXaJ6P57+iBp5ShkO4kbsssBXXauu1dJLkHgA/GpBCqv60tq5Va2X/J29ygZOMKivBZn/hJWh6Thcl/b6gdj51JzXoUBoQRbmCTnf79fq+/M/jPzVjxktG2oiMW0YnfVsGbJLIk//EOClqDRCY2hZWIlVP7PVLOdwZE6UDrfoy5SdKIcpauSXx9D6TJWduk88+fvYmZ2l1wsQB6wIO9AULIBUGctQcpHgg4EJZ8hHuWQUxUSAAWDlO4ZhO78KMlBwSHnKsXKbmPp0qWr0k0bQizazstaliGJFW9ApY5Sbn1897vHflp/A2JiWjPNMgoRBCzblG3t6+p7x9iqzavYuCqjMFcElJgB/P8CUI7DBcADkJXkJAC8OhuE34MfpeMTO5RjGoIH2+bp9bbrBFEYzz/q5Z0gAoIiAE5uQzJKDFPAMAV9kIOd3fbgPL9XBARnegPsuTKjhYxSHJ3F8hQpVT6i/xojAEKRGCpfYX5fIZaaQaZCJY0DfMeKrUS5r//8/dfnTx8/vH87Ky9X9lzIIm8k/IXWIq7pVNRzE2jgnDcxyj4HoTiCuF1oBw/4IRNBiEIXiCFBDmSQoRcUUCIXsYhDH6ihQx4MWIx8ZEJAHoagEEUYgRKUYlShHDSMcX4LlGgYjAXmRekxiFwKCNgWYTgLsKyqqrMmY3Vuno4QElUsr2sH4CoFEfg9SIBgeOjJA4jFQVJCMYo6hEcUD9yj+pSICUExLOoI0x6KYiGL19KKltG3OLA4VWgHCuLS0ZFyogSjliCMgikdwkHzCY7KKkwrhiVEdCjlUA8AWpfSYyCWkzg51lOp3KCNUJm1s5soyl2q0W43dj7azjG2LwE7r2M7p6ezlpLCC5zsCvj9gU7Z/l4eo4kpszGAseH73Tgu6soMEuas1FjdJMEqCLK3lCipWupYKxOqWK0J1rHUrih2FhBOYG2JbDEOrvvkp4UF01wrEwq6BXnTk5MVrz7dlGGxdF1yPJ9SoofVurZ59rt2qZ3uzBOcEqenolFmP1xZ1lqV4TvGhRPAlMI1NSmhPKUijc1xRl4Xo8ZEG880b44nMbesF3up0Rt1LOCFlXANJzsG5abVTkIXk6lPbm6ayW62a5rZmspRd2cTTU8vGJZ0PG+kQhH/qcQZbVx6N5suO4ETFs9MaOeNchfLShP4E6ZYrdkJdnPSYpaXSpZUc5Jk4HjR53akCRfh+a9T8mYzJcUg6kSR4z2ynJyc1TVvph1P3EZOd/N8Ep/ab+w6SAeAazT+sBMCaRLptNRe0lrPbKXjjQWOsMJO2GyuPc8dnRJZQlhOHMmGU+p26N4kDAJfheaJLUrDgxngRvO8gA4K7Tj9WVdIdfoy3GIa77Sb7U4z93OGpBuQhLcml+XJm5lhb3Mw9drb5z+RGywWmjKkKXLUGACVD9Ak5q/ldqNiAUG4OiKSQgzf6i+i1k0u1ATyZC5kWfODq3FoTVJM8UpFXwyQK4y28J6bvI3CzFQ0++DP/57yocXT9N3P1SqoCCxJw9ecNjGxSPmGccpQ+M94Ke7dTHgpVKmOR9TL9xYuX1WgWadPJaKj4cVcxBvNg6wlUiMSd8lpD270BDINnZFGz6SMGBMoJELUC1asMGTBiEwxzYak6MhxcJQNrcxhahwSQFE4dMhpyhS4TT+ZH0fJnDwUmBSFFfpMaZZm8nQ4PW2zcxVJVPf5NxFUjFUd481/Q83ZEqcal8y4rPy0PUUcjk/HiUskjf3BZcdL6H3OpSq7XDr1BLVFlM4iRGni3ucUMFXzjg3fOcUdgCaQB5JYIyBCQtDbi2SDZitZLD9lCoNda581StkVD236Ffr24lKVgpmQFLJqJ8TJD96P3RfakVUGDZA0KW/EeWFWz8LJ4k2PfFdEPn65cd7W57BiX1VmVz6VUAWgI+sn+8Wqah6/wwrPzSbDTPeapM/k9Bd4el5NR3SY2KN0vKr845BeV6TdqF5xmS36qkwRTFo/y7kDh9BrXiBZdVY72i1u3kd1/6M+9+bpRJ++/5T0vQ/Me3IRRAq7vg07lcPvWjZ2r0X8X8aDN0ia2uxX9pfDwmK2vj2dVTq4/003p7sS7fcrI9rsOm5gPObeIbzk2by4eG3MVRY7/IOSxfJlzQv9VV+q3n3zpTofP3BDClU0nOeiae7kmem8LCct+TSxTdxSTme+xg03oM3+IeIiYOOPQ3QFGUUAwIq6aLia88Ae93FgKJAbDENm8ku/K6REPygQ+KjUqJrIxHfAbWE3TKhzl4X+6w9J7KIzjgWTIp6/MPQIafj4gvlwKZSG5r1oQY7DWriou3MqorzqbOKMW3ESC1DZZmh4T4QA22Ql9xwC2iOgwZBtsxT47h9BBrHLohJKMlCeqWgj/j2hAAs3OsOjSbWcN3skv1RWQUNTSNK33jfx2bvfU6qmXl7B5YezCtmsIri84itu+Gk2ZhrDjA/R5rSGe8NDWfl3p/Irx2wu2Gzujkpo3/dCLxFxDQDIzDhmohCwwDsiMM7gw6/LMVJTSDOsJz9OdwOu1Kw+Bp10evaYRI+XCozzSICW3NeJUPQe4+zyM01mziym6y7DeJJRKMnvFJi0YH8pUphjsJHSreQ4ZcST80ryiDrZPyb+nNwUmBQDvW/tmRrK0+bgtMy+1dU9hKflfZm6ZCJR79F6Xz4s+vZbtcXLj4cOpaTekUsZK0qv0vtCYuRBUqq3C0JSBNKOM2hLHPAKmz0Y3SosdELNAl9XdHxp825qqU9P1jB0ek7JWLt2ern6EDhXKV3CfYARfW9c8Gb+Wt3d4rp6GY48+4RXZkanXGPUUrBlPCsgse5NockYpTdC/DAVmUX/nJSYVgle71OBM9dCIWdc9IH13Y7Mjyz95LJmO6p3jP0UvLJc63eYdmqiQcUq2p1Wb75qjoRAg2xBdQv/EpmTzfPEVwvIQlvUEc1JYjhOBZczsJXG151quGzcx2n0daXQrgFcH2vE5CBhpBZlgToFykRIkDg7eh5dmODmbxvMzA+Q+Xo60DM1eXinYqOvdgRzXwVwvbo1hDyg6XAtdn9/jja9q/ocPAIVlmLFA/Ojjqp9xYGXByWkxkilPqLcqmMFcl9zqJmuKl1o5UonV1Dj7itK2KFVdt2cIyc1G6jgs438kISdCfyMl3Po3U0I0cg/yixEH9G80QRYxwhiOPJ0ZFcLCAkUlSauqk4IsSuWgofNAohhJhWxyB0T6yOoHssxJHqG1wI53Qlidt06++xVYTeoVZe5qLMiailo/ssq4Titrp5VB3HlcIyiftbqda3IA1T62WZ+lqYXi7U+yGgpHG/hfi2U2w+ePGlpW8xYI0mhqrnpxNBBS8a3GJ4pytNqlWdEnY/z4emX1dpOiLrqdjVX9ZjE54Ih9Ebu1QuNE99qJE07yNKFkq5yd961B2RT2GdT18c4tSkwKIj/YGWN/Ml+cfF6Xll/dF+VmVW+4TG2lNTMjqnGkMRv9TSiIT0Fo3uxHZzpX978gl4OdAiR1Qj8TGqRFq6UbWJAmvl4tvZuw0lqQhomtm45vkUKEtFUrSuwdhgSklqJ3RIyObMNMmIX7gApjVCyAuingF+MavNGk3VjQG7xbuYFf2YT4oqbXNtrQYjHxfZDjB0YAC8nTkfEjoumoIkDAsNUYVUrA8+xuyKbhBHT3a1Be0FoHDkOgAJRSxkdgQ/aEMSjTTGFq9ou8Ml5LiErErK5LagyBVZ/OsELKYHdqGANQABoiogmY6Y5ZCdnDG2dUy45bv51HCJZAAsQpWUCKuKbCEACHIVhUobNACFSs1jxFMiuVjSupWNcDv/yUBfkBMMe7ylxabQCEjciKXWdTGnkGqmFhzMbuJyEOKwzU5RiIEYaCpXyOfLREmxqK72qFuJLSYuW5LzUxNrd6oriQMpkGagQBaDVBw8Uz0tWtEeCcd54wS6JK6MGrDQrLKR0YOdBWWysLTupWX68njVoMmTOY7JspH24lRHp+By963BI6OI069Hssb8mhj6nLFblOW9T+Dw2LsfsUX/eHzq67+P6KyWTGzqEzv3eV9BVD78EulOs8muEaAeJBhyJhiG/awyUkwh+BPKcMjnQdMHBIe27IE7t1MgqzBVFUTYCGGnjpDAU2AJanvaXnMJ4cJpLklIOFrAP1QpOAdIw4xVEC7edaIuMGPC18T3VCA6R6QcXv2tkCn0mc82ZmNcmAZAAd4A8zdNkcF3tFmBkbWYKb55VboISRpTwEvn6zNC9Na3YpDAiU7bUtDsdNl2W9TeOFwgJKUBcCdHMNMl5g2tw0P5HrFlAQhGEEblCOA2nMKMoC4aQtpdBQtWIkAPf2YW4hyKkg9s7lR58w72OZ8HtTQEJt7PJ21kEzoMqx/O40V2Dm4MKmttc3XxyN5anXRF5++H2G6tfRCWKU/QOTaBLoMEXWg0puNw15k2d7MjdE8S/UcJEZRSVavEOXPFkIwgKso3Ei/g4qAOpWcQRPyuJdonoK7M5qI0NQ80qRxTQihWKvOl3okVEusaK+JFGzdvSXrddTbfKpx9sCqv4hRLawnPbuhz/gZj6FbCwaB/FrRcoxevBOAQ8xxR7KxapgDTlNT5ywglgQrUA4qUJF1nBGnPCh6gFpH2Iz3bEUC6OQYuPYUJbX3O8M4rZlt1O4cqUldn5XVkasbTE3cV1DPI3Dv3Esg6lH3DYsjLqRGliVmra9tRTDDm9KDJaifBfPw4UT7Ef9HTeWy78ZrQEeI0bRXylno1lyl/0nTYuMJxssU0eG2PWGPDtL2SKTr/FwZ/XBCi6mCnQBdZvJAAHPJOja7F06mN0ehJvRHmg9RxOnun62VN601p+3JJO0B1IyJbhl7YLDrWp+zCWJHE1PaY9A00Mq2b+H3Mr+XRadHSnGt5CUv5u9gXyLt+MRfhLY8V36W2VF4Kc55S2W2Z8+RaUFLDbeLk2skU3E5AtdKk38Uq1Tv7xts4pq1hIQk1GPPnm79+qK47hcq5L4332X82OPI224iJU+Ir1d4YK0GLfQTMiUw4kQ21XR8VCffy6oqevYOTCKndZjVggk5wEt7WcNE2+9QLoLmAVIllL1caSZDp/9IWaLWcYAK1kniyIpSU1hSbNcNmYAOX4v24cljmZEfM0lWT8PIILnsVftuhy4PQ5zAiXl1Wo09DqUPe8pfh4r7r7GNXd98i6cwBVAmNEH2vSSAwdHGEuJqWfKuQpkfiUlJHJXX0VvGBcl+4J3qybLCp4eLpgmJvayTDArbnyPqoyEVxrSIjZRHaMLVcc7rCeMvNkp2AxCfSQme1b4qrVTZ7pZMQF8QvQ+cXzUpBqM6S7xP9KQtc7ixXJnaUFsikiGz6UPwIdWWHAbfoqsWJ60Frj9Xtp7piKGRpKHetU2QSRa8/Uz0WebmEJb6qQhrSw1r8gaHX4x3X8D1X1uX+R1O2KdvhtcmvM7fSz6bHstbF3Rp+P71g4vqtklyUY6RtYjX9NS86IBCCSljKzbkc4Hmb1lhiutICxPjaCT47pzthwWjWypa4qBHre9pnqAB2ZL/8LkbctPojeBRHEdbncauaqsdC9vODactkxU0Ux3ipUcVAc16U09m8DyyOxJpOYR4pTgyyD+SxLBlkvGEmF+l4L3OEWRoeihsh6iMcfwlD7VL2jTKsw3B++CmrH1nYRJffGz+YF7b/5GpXa7f3Fw2mlBLd37ujSaeZAQnclff1u9sZ8E3hVYltjKFdt2hZPZ79YJIYcdEA2K9uaHPjjxZNBBEMn+srI+h/y1jyNYUXVQEqkSJZrLDUv89Ibq6gmo+xytDuiKdY49Wb2ho9fTvxAjwyssgWopA5Zh7+B8pkUfVm03juqFpskn0engXN5WOmu/fmLgyJxMS784KjY6DVrVpK4MqKFfeDP7HlnKgZv8/Hss8jEH7o0JP3UvtKFZeJKQvuTG2mnt8w/XjyNintb7Ak4e7d36jSjRJna7lT1ANeNW38jokHauA90sAREG22Wkj+bF1dv19nzxWmS3txQNokT1qsSrqJ9NjOFHHg1etIUTqnRvmUkWGir1dwCn7muO/eHfOWVgaEZm8UhfSg3U8t2PDkRI72NBRdgY3t4cdNobikzoBDA6Mq85Z2ODY8rGRSSkgBcC9qqTB7hHrUjg516jXihfM3VsJdRKVn2IkKJ5c1w5fwf9C8xEw+Oe/LBYQtEagvPzycbUlqq+nOJEjLZUrZ539RkON0uSbu46FfIUaJ8K6NTX4+a1YKqxDwzML24heMt910RU194UwIl+Cyisau/S7w8udeJ7AUp5Qa63G0cVivrez0pZgsFbp70Y4HaUR5femog3DXHIx1wcF+tYTgm7ejSamjD/zzA+fSckt8jSopVHPu1GXX6i5WYqXFBHYXU2f4xSeIJc75df9Q4fNmsQsom2j8c9naT75H4kRinMoVzBYkCi06vEfCTWdhmp8OkVib1FxbUxJ12OvmuSHq2V/06fPPrd4scKFLjUkR6xK2KVYa1tHNzqozpe0Vfg+rEv7efQwJv0O59epZ7ySx+KpRi8eIFxr8UHdzQSM6Zs+F7W9/Jyvju1lbJsWi8zdvl69UFuQiYzcPibdL+WdwPnJmcvINzmTnnHarNjE59ldXXL2XhzbB4a+c4VotrYsPjvIJ70V6Yx3Y4STx0VsHh/Cvcd7juZpgXWtTcqLyAp5mcM9CWkE4zF2iQj5te1bqjfTbIrvRuuaNSOfKBy0KeNS9XBfupfV3l8BurlBnIU8qefCen6Gv+lnPZz3YwHW1uh52UH0ewVTxcPCVlSIOF9lLt//Bb0OpoXI7JXp2mVNiW+O63DAmUzqVnBDqQnL4fv0OPO8YTKRU4JKegDys8ZKgzOveH5CDgUp+5EZEir0TSxzZSf8Wj6tKHbSyvj2PRqGjiKVtMGtufqMr2D/D/Em4WG22k7gqvV2ljmJ+Gw8khGqpXvTMuOhbevp/9C7VYrVlEVXXszeY2hWyTp98fRvMUqvr6o6QOWzPRqkiKCBLeTxA2IJkyOYY6F4soOkFm810E/wUFBmns5HGvg/4+dRKzzZw41cYo5drjePIPYjGBIBOKQdhnPQDjCywD6fb9L7mFtsHD3KNNri9AumNiPVL3gIDqAhdS9XJWhrVDeBbxQvyd9R9WSsqBnNzoF1F8b/Ca0pGMttesUUn6fDTDFWPJ8fAn8GLemyTkLNzz7pnQkL/T+PlP6TohHbP6mna9b6x+vG/M4drN1oU5zudh2KhiZB4Bh8GW2VeFhk2Y2vjuVDdfTm90txz4Dkrgsw1OErHV+NYiWh6TB6Car0xgyfSlymjfGAmMSDT9/sHKe7nTSPbE+4EZjueZhky+Iy+h57+A8DyQoIdS0rffKWZ4wT6bGZ4zKsKMeH4dYyVcHi0KqyTFCuthekpgguy8sTmoxKmp9D/ElIgUX38LFxfZbI/THjwiYxazQ2JelDat8vrIGgbXg4XK7YxDrM5ahZZAe/POwKw2spmFlIW+5Z+g0MOpWQW8SwY3N+heFj/ffSPYZioOuL4Es4lWTZ6zfavp257VMJjpoGtyw4URZ6iLdxmsowTnH5WazlVrMujyowLWKJAlpVexqGFDKAck1IA+U+qkO+whD9+i5cr4D4iBr4NRJW9SzYvPuU1qJGWYhuYhhADxUZUXQCnRPSrTGpoPAvq8hkZdi7+K2fdTOCnHyCmnCIbbuKkoSjGb9BtAAPKAAVBQZSwpMViQ1FolruXUR6NL2AvIE8Lq7gNiczmbrJoaGWs5iqAxqaKWO2Nl8+uny7zrPGkr3Kgb0WJcVvPuKAynINMYti1Ji0XskuUdk0qh0txpXpjBs63h80VVZk+ulOQD8sJ+3ic11GrVVcGaVeLKNUp9jMJdobItQixgq8SACVyJGuJaZ4DLpElLz+HeLokxjIF6Uqt1uUE01id4dZBhECJf22ZZpc4x2fyFrKL9wosLwpC79PM3vyVGamYqtkz6ZydL47xKTqrmTmuGkz6vnbfMnq/IoLg75G1BVrnpeucqEMp2WiWG1ykZg9FOMZ1RPa03Hto8+nlk+JuUMeQrvm89ZRnhva3tgiQPdsOInI9i7lA9xIP/I52LZbIyz2cB+iPQhD+HgIHyIVMIA9O+0T0fZPatgbgexpLUyS+ucKdrzjcDACyNdtAobBvQmgNxWBO9ZdDq49EoCssiHuDNBZK2r0R8DW7xAlIEYtuBSvyyVhKZtoFkDSxVJqCug2xBAliLHCKb/I47hHKlwn4AUKk7FLzpHvnpGh6iCUTCTkdGNbxiPJlhpA6+wanNQ5vDegwGQZRKpgb7bsKN4V78kA92DMNSE9VUO9FSazQMyBhOH+QfLprSoEhVWGIE4wh76GDxE8MY7mCP85qh7iA7yorkczfc2AJXmgf4c9k7Zzwi/sZLh+eB/nthHFa4bu0kwEdcvCYAiFhOg3T+GiUPKkhBPENeZfEEHYES+rP97cSYDaafWvYs1HPQ0QamQv79gYUrtehF/URi+7m/3kj7J+b6d1h7LbCpQ+Y9x7ydRSPEoUdrSVqJ6cPo+jnAG+VVzClTT/noFlOyl+M6h9d7nQVIPAIVSjQeEX67S5gKaqnvR5Ez6ODiOy3ch8gxDDACiEyEMXLgQcQjDgwiBI8b+nDUBw/rgBSozAo8W+5Z2HdrszvbHHiUF5dalIcc+6lQ7vYs173MeIljlUv2uGOSY6xiWMfxh0pxZfJXahHnlrC+c23PnaScmHQdbdLbvUW6DW8or/fORG5Dy0degLj0f6xG065N8WCdO0eeSpbYL8sNWpVaaD1pBOjjNAlU5Ym1L7OygbZyO8WMtBmLKMC9nPZPRoGYxFxualaVUdXfvx1tklrvJIapjsHZbuTqWzy+H7uszqWfWo6tkWZ+D2lDZ0UIb4nIbA+QIcuLo9y80JNPZLVmSKsVvSCxBqRMzdShHVk1WGFVUCmAGKf1X0l9MEQxJFoqEzqThHebsysMJwrRSo4uTWRoFcFWmoPZJ9CsfQQR8gG+4yU4wgaRtPNPBze4430PP+IA54jCDQqBFcQVeWPzZ6KNQ2WlCNqtA104EFVk4zlxYWY5bIBgwj+4A0QUYdIhsMzn1iDEqUhmqUCcHNC6FSZkgaNNBL1NGw5/BB9jjOnCxZSJR+NdDy1VVLWiyFLrSzscvbAkbCIZvic2SzNv4tu6Prkyam8fVe90zuLMsTzj1vF9g2Tn0w7Xs0j1dgEfzJTnDpuYAvw96+vvQppHcyL9rF/QbCynBnlhUBnwniCTb8LqvuL+rCoNpt6y+wsFm6zK7NrRVVPYub2iN8a2PFpkf/TL3AK5OSTBrZz3iJ5eQFR/UPRQmeuuo73P7UmmZCyfsYEDwvG8g+812+opVfXsYOmPKKGycjqd1OrLN6DUD1R+F/JYj7z9kPSDT37oyyP29r2NNg59vHiPiXx+Ld08MTdSl0/UJTNhRvJ02VS9eLppat6QlyZ6bE7ht8M3ezOjgcmA3LS1Zpuyu6P7HaUr7HyN9RztDIvZDvnHR8csSeRvHqn0wpJH3aj7zuiA+RQIl8hfhGLSW/zm/B04T0yu5Nzu/4di4f20GptXfSYfpY+nibx/drSusv/6CvqLm/RECUKfoZcNnpPAG3VEB2/LYUg21Mn9HwdF9XDMZuTZoRhzOexAOQO245forWFlA9OLWy+VuEM10qJuYcsoxVDsuyteAp3zyDxDUvCWTPqHqBorItDq6qeTehUNcr9auJKQHeDdImwpGDolCdZ3B9JqAEchPEDR0ZyVYpIuZnkXMggYaDhI/cEcJxGhkjHnvbSnIxkKCiP51oDspjPeD9XJhP1BLnpTJsfqz14R4cQulRrlXzBqgDMYtuwwpwAFO+Sohtsa0rDm5kQMMtM60ADLvY7KtHJBPoObXXVznlnnFFFNGQRuppwCRZgqAwn+8Vj7Fs7zXG4Xi/9xJsYCilqTyxDd4P8F8xcuapBjHFQTQwY325RgJqHT5LEyVtqnGJkuD2kVcjwdQ93kBbM9PCcoQxOBUOgh1Y3okx8r8LcCSomMuybOIMKUDclxOawpCHDb9Ywx6ptI1/O+A0OSGKyh4L7go7mBKQkzVZtY/KUjz36g5G+atUJOa5drRPxZ80KTmLbrtYXbe0HlAeAVT2tQxWd/YyXFZJFfyehIunRIzY+LD1X0pSo7sWOrtzKXFzfv/KIJDTsfpXRq08rg+wNj5n2A5xBHPumRym877w+AwXQ84kXIzvm8LBKNQ6+vhKIzmtE23Uy3twX1Zlfc7KmD1CBq1aArSSbSZvfYlNG3fHOTvDYafaTlj7B+qdJ6BLfOUecvqXXViHh0t7hktdvlXleze/WSdfvBNcGpJ+1OpQ0zXc4YcXPxkmU31ibp1MCNubhVuMm8dHD2knlyeEv+WZ/qXrzPeWrq3defjFi8vmaTe/3mbCZmpEr9PLcEl9R6XLMr2Kj3T3ETmL2y1n149tDiMdZsJuCz8FhHMj3LvX8oJZtCRWjPG2suOOASwL+IIMZuhJ7oMCkUPxQEVpVlx82TILNdrtDnCpM4lZMHk+M6/wZ61/UBAFV048WJyGf2oveLPeuyqdLcUIe7NeeK+gNInlpcVNxILC85gwKWQ7twj+E2FlPKcMhQqaaU2O/KMTkydEXhyvteAISkSEM7qEhfFShItxbIzSSW/A+M+FzcaMP/p4CPEdS7BtXWzTw2vm2rz3vnlm2c3jObFbWUfD1lDt49Q7+KsCXPYeJpzuZ/JUzBlmf45ogDbmFdROm9Vm5mEzE8GZ1YTtOhG0vXTKxVG72qLb7++/XuCzflMXeVwawDPZReQa3gqpY/f8t/vurlRdbdett0XasPM1aU8wajZDhvGv9FWJiCjkoQFVpolhGjAFEwV1dfVjrgYujxnfc9TZ1kCaPG5Y0uEx2NREmqka/lRBEidDMk6AHLKyaj4EqitTghVrmPg/1Fhh+ytJUSnIhZSTkmTv4mPOEnXpw0BvoH03JHaXz6I24+PgPHeqQcWDXcec6//xsy4CZGFW3VZp8+cFbFy5kNA2f1ZM3n3LEBStMjjZ3F4ZKo1WcTqavSffi89TnsCxuUWvlOMH/yJ1QB3zz+ql1FQ/HSzVdLa1y8/sP/5IYhHZbJD/w/MR+/+jf6hRc/+dvhd/vsHPyyYK7FYeJMFfD7/Y4xzmq8j6/wdMHNkgBtf6oiPtXHZaGytwjB4xYT86ileYzGtNVycWM2MAtrCsQVBo5JGDi1REsbFRP26x8YY1XstGxkLHpg+wUMGaWhTXvKeuCYoML+AU3MIne/vjvzpbUxZYVVoaxUDP97aQL48NZGTAnPgREOtDzyMGbAQP94MRgw8FL8TQgdu79cxRn+EZMd73XMVwi4qrOJ96BZ2Cj+bDVPLLX0YVFzTVwuleWSVVOWYY49HzbgLoluds/pvKe59UfE8/10V39ZhK3daR7IhwaVKXgWbjNoboXeIpnvJDCnRkZzHJrDDu0Oza6Wc7cD5HAv7rdDXYdSNWTXW5rRAzIiEiAO+0ZDKgBonaXHO9EJfOYsq3VWhqrjO1WIDoU8ZmccJYAmdxR8e6PE49feemtZYgPoqzpPHt8nCNmdhd/6TylwWooOqbCyaLJ3xmi+hNeEJv7LZ1QppAasw5Xkad4XgTBI1T3LWXYfXbDBleQ1phWWhZ27JU6cjlkUIusirhOcnDno8UJNZU4QIpeFEG+XjCyi7CBuj2+FvuGmBQsreZlw/zuJFSqdrHmZAkdSPNpJ4Kk64id6z1nkXRVEMvVIL/3a8kShuvzH0tTE2QUbWuXNT5HYGibldGFHVDvJtwzsT1awXa+qjJ2EsDB1vNXmBfc2N6+8XRwrJY7tOr04dLBSoKhP9MrNyCzO3rhRhmR8wnh4FxkMn9sHDhlLschiY9iLnc92kh1/fMatrtK4eSwQaUVrRf8FhsiNYsFcvoczvTHsmWbg0OQtdCEpG4IBamxpRaw4WhIVmh1ZPDS0UDT5CHXjJw553Q2Ygxmv/miMVcWp41RNSFyoLOz5tyG5xEUG/aeOQ4eM6VhkkRGEFeWtX9/iuVyayInhxJYUbwlHg4GysZziYg74MYkGxmPcW7RBXMcP2tBtCSYQgi2WagKh2jLYEp6UrY1XiCIiRAqbzc4Jj8gZl2qVUgnZ7KSINsHDJKOfobdRXEIfojMG6SUllJS4gwz5sxFE3xjEpGeXbs7ynjCLEyQDp9yU4wcnN3RvIb0c/d7A4PhUMl5+MDMrKlwL5XK/9Lp8HwiCe8dmPIp04sSrbq3Zkc8/d0ditXsG0pjUe9Ta/KFFU6FrmPiyKy6/EL0YlsZkzUIvesTAZvS6jMbopHyMCsxWw2gqPZJrfuj17tS+uvoZaNWUctLnzw/Lh4+FEvesVua/+BCzzKeaAp7FthFmCK8YqlvlyRn8A0JdEj+5uD8DbmcVl3uhB46Oj9anZ5w0TKqD1GI7Y5gyzDx+Y0g0gINvA7QRgf5xQZKfi2NNpr9M4hSZBYgmtIaQfoSfSp4Tex8ydiXW/dzd2p8/sWw9xsbqzGlxpjjgNwpkZFkVRVW2LUlvCJdtdkFBCTL5khze6cxcAHWoGmbf927cYaWuvCKaBKbUGk7RnZAfzou4thInePChlaFUuX9rJ7sUhkIg4Lol+EtnmRpn9TAYA9MyL5akAefTdpyo8gXEqiOXiJaWGsAfjPTgP3f0QVEUN7gKylBa6+aSpbq2r4QvV6SAak18a4mBTckWSUKka0FYXOV1HlYXs9ahnEglull5acVhfve++6advgIDSUJDokTUn1PwOy7qF5ASECtpJrxaUEXl0JaLIrGUouJfn+gXQnv2qC1gLbVNGmZ5HQizaXIOovOBn0iGs2JYIo5gVSO40sdmcch27oM+zlQoaifM7eTAgGsOl5cltuK5YDl+LC7pAyxagiJsoo75ofx+1lmRKDWr+oAoODU7MziDAAoyfSwWdaVtg7Tv2ewzNbG0bOh7Gl4il+pu1A0WvdNZ21zT7ewD/JKu6gMifrG4jC2Shj6tz8Yao9wKoNlDXWdPopGIWtYdiiiTDnWaXj2F5Rq9w6kkCF2i3+m4rE+2z6XPBRh3ej/x9p5ZJZ4Y1rIUAPUmgrQ/UTDtADDonw75HkO+IFjEvWSXyzbL8uxuBNs4ieXzMJf6DcMSHs+1E7v/JvZFjkz6slZCM9qEXXWwT3bJ+ZLxN0T8zbh0xTn/hTk/GJ7vwRJMfuZgvtk9Okr+8oO7+4eX8qho98jTcBP6SiS+6xsG+q+JU1LEVUH00euFbuluaZ2dafLAFgpxuBTekiXc8W9ohwZ4KRs2CEHUzTAYBUGo/PtqzaxGA0FQUp9R3iUHsjoVGt7T2NRhamzMewhIGvHXjGkCKJXOuQHOcmcAQO5WY0zMDIhQrx/lZfKylmbqiTpCikRNVVFbYl69sipqOumub34QutL3r8XWNoP2Ylcty42XkEkYSOJHZ2y+K6yflW7A6CJdgclEZLO5ssuHQQV6/XJTcwxbzraTNdUI5t/3FfGCtINHo6RCEBLV7UtwiaXfey/vpJAHWnE/WhooepCYG6A/15a5GeIqPu4aMDcrg5XaPXp+vDW4csU5xkFAWsMBwFwrVE/e6PTN8nM+6cu+PXtOk6qm10h8N9v9irf5Y3zuBWrzlIxBslz/cTN1yXO0AxuGzS446tbdjD0HNbeNfFsUNlNOtGj0DcriAw+Xl+TArPTBVqt7yHc7nrMVLuRW2QvffTw3ct3WfKvJmNfud68s+frVlQ+pYFtLi5xcTHXGmOrzQwmsuBUiKDSBozzhMoiSwYhfY0NVNexUi7xFpiI6EV65WQFkUStxKYpAKE+pYKUJitWNit8l53tUn+opUgnPFfRJiabAGoY1Fw79ZtJz786BA/IyCMfNekcH8djE2su/A83JZdDH44SvphnaHbjxXJcVNEPzTbzD2Asd4MPK9vML6vdCt0MD3fGXyAsWaIVXO77fARy4GeYcoDfIy2fKHq6ctd8hSrXlEO0M3HJRnUpjHjWGzojG8onispIEwiVQqlNoJlEyZFr9hNOntkHnBOMEWuwtDIPKRJgqYZJ4WGIig1hhDAlocokTXquqjkLGK9MtuUWyC/gMIhDslofqa+sYLVcP1KfyN+t4W/T+GFhDJLDxOO+DN0eKNYj32Zt+YojfSiDanRoaSVPjIs6OSvxg+Vu0jpvdiV3bKZLcG5uqF1vUcftYRgZqSSTulVtR560Yl4MdJan1t2J53AzMoRi+P6huVFc+zbWo/cDVmnUIbt20qy4ZGIMGk8X9eKA+Na397IcDDUXBr5ClJehMfypTqwBNe/yOhxc+juBp58vq1Hy2voR/vgIFG/0IBDvY++zpkWIN7H3mtAQDOWTHtZoWoiWwQy6BCN7osEDhwZtcMcrsY3WlDiuvQyMbPxppPIgqnvWr0PLxr2KK6s/A3cS04o5b0FSUzs2jxckDDenpYbQeFe/O5FmBsEKH1rk2yqe4ARhS28/UrMPj1k33M6DMfqgq/0/F6tSi9gMHGtJdXyGlYukqlQ8MJpW4/ogMC0RVzpYXtx9c6vZbqImkkbNji/k/IND/qIVjVZuvpIPaPPxPzToEWT9dskucgYquNvD/VxUxDESnVM7YyjoYvZqVKiuVm/iq0qFExZiUruwqTKveMwsVfqA0KSalgfFavv8O3A5R3tj+eMuRE4mH/p8cKQiZUyhUnzyMWklzDwcXdYoUoyUKp/9i2dD09r0m/c+PkSur2OJF77PhrbcXhoYFPHxtMnQyXtzWZ9OQArvPXstoqTBnZi0ofG7DZy9/4D338oFo1yeF2uLn0mVp0sE8OR8V3MTTRuEMvoDPz9saGS1buMyQinssO/T8+Wag/iNFPR6wa/dEbRKYas5gH5f6w20d2yXw99vbDk8wGQP3ohOsFh3ZzneKzStVuKPKViZTAQgtJM/M5KSr1AyFTYg9ffHo6JvIUCnzW/8EzpaGUKMeNEQdHgtbHp8QsWLocENUAlDleLxFbVU7sC70Vdb2Pva+LfCbFXTrAH2QDbfaWaHb0ZstlxjtRMvhI4x2ZEvLiYsBQN2WGn3WpHgVwTit0sIyGpJAZQGZNJdhwUC+iuvR0G8nIkHsLTo4FmW85VyxChZJhSFkR+SRkAxhDnjtxA6L4lq55gQEvudkmPgeCXGHgIZwb3b2rxeQVnq44CTMASEumOcYJsbzbQz8bK/AxFCrK2m0DeW5SNbC0ht0+25mEb4khBJxXCFjmNY4cDUBGZGadoA4YsioAxVkDRCh5QhDumRmzS8FTWYRWVbl0Nwgysg21AGPkwCur+5XhMzCQ0hRiAtcTGEuFk8yGJKqUJERFCSZXBw9pRwgwlw97aFgLtEf3LhrmA0oKb+nH803CnwVP0boFYjUBAFRWOKX9xQQYRSmWhDiPI5WXtQBIICRJUJOspcwpnpQqOab8IBz5VZAiH2vM2RWAQIiAgNgUMk3IMXZQgUyiLcYr/SybbGFCnFB18mRWkTpsOQAArYjVt1nC8ESWyQR5gdASOYXhj782pxua7GG8Rk+31O8oEN0IJKT9GRvNS+J4yACoFiI99bvZPgTqRQkvVBZ3/C+rcUGq12rr7+SdWWOc+eBIVNlAFhn3y+jsupKCPH4OPefUcERqeJHtcoqJzxyaPa+ds1xb7MxIH1/gYQruttDzx7InYLTT6l4vP8Xbes72v1dW3YtO6EdGSZIpyVh2BHtAYjBfW1Tf+Y7OEm3dTlTaBHlzJ43Hw1+S7m04BuP9h1vhr9iKm0kSahsqD9qtbPNeiPUnp5fBvLR6x2bwjKEzuf+8hB2hyO1w7sF9nNO3+DIVPGkdRa0Tjo0R57dwDllKkt4scCwx6mnwpowGgoAtZh6naH0JpxcvCGTKvRLIZWWCtdPeFXZ0HOS4K2kd9Ldwd4aNnqB8Y8S5+oWg/9nEilE+K4KLDKZA/5xe9ySko8M9vitKuud5xHcyhzpRgxa7ydIJPt4xhPZVD2Vq0eh9NyvZLuup0+sCUEzVJOzEnek47sTXAAhZp+PY2E6LgjRlhdfZc3Z3GDNsK6UCOYPgVmtKsh62vp2NCjPGeftMydQHdw4MFbsu9PTvLH5u3aSMyk3TWfIE1Ul9os3r8yqiTOp5s6Qy/YcjzGeARB1gJB1+KCbcLib7mgvc8dtzzM2G9wH92UQNsfm5yrXmda6/ef1NGw2ZOw7nGm1hwLAm2zs+ADzAPAJhw5iweuErMOHs6w6aLLgPB5bZ1539hsIIbW24IufMYe31YkZNMuzWGsNhZIRN83kcrQjmoeQRdxip5AZlad1GbIOF5pLzJZ8c6GNDrXIDQoPZhE2ZWpxMzcl3YOHf+Rm3L3YYuM6yMEvaBGd8nOWp8wLANhLDYEMMCvojZZ4W9tpXgbLn3hfr5vuK/dFN0UBEm8X/kn+ks3RTcUfyar8Z5jTIwbHPxsPCOgkQAEAwUMmnh2y9L86YKCVqMiggfX5LREAAIgICNCFxchIoYC0E+qSNnC1zeDqkBx0zvkjFwHg/X/m5dJ/Tu01T01Po/lf7PyWcASaD+x3aD48c3pTwz0EQFeVVnK5AhAPFc/8dPusfdCSdQsjxollatc+gwEGRw7OKCuTE5JKuy5ySP7gD6lHt4KAFd9O987hABEJwJEOKbfvnD1rH7xh3xLgbUcXPHT7QBj1eEprktjEyrKPAKA2RPNVuGSxFligbw1wwD3PK4toOY2gQrLldDiK+Ia4dvrRBdbN9RcBsgP/zdIHOHRLVMtXUZOBQaAh7F8WLnshzv41GwC8FWqkOrDyfuWW+k+GtE6UvbL+ubOvzihpi6fdEleXre2YnN1n1GCGVrPu0MEpT4WV9izNeEl2yvhyuS0ZUzKXtTy3HQFKpioDzIcACG927zvJ20zPtiJAg7GWGVQEBPC6MR2dKyYskugfdezcKdciVlrj9u0dt7Kk6YTiiGKCVqr/zbJjhzHdCtEad+zoeKSXLCQUP5kuJvzGtNbydz5Cxj+6SDqfd+tE5yOe9aLOWxnIo7TWmjkZPOt1PJhB5Fr2So08+gXOIaRLxLcsvZukaQiSquzttdwSSxbi82CrDsFk1QXM70zoIgTO4wnL0pely99Tpen4HDhpNRqIJmgBAMHf2Cal4jylkuH8lSuFoVir8ICVK3PPiCVeeHMSBMEAOZoJAOgMUQpQbrbWCBFtRmsxtVZ2pVaQUl3xKsyQ+dxKvAHKqLQHtg/CNONArhza9o42OKRUgnFN2APbcRoJkG6b1xb4Tkdf/r+VMfjl5W/lN/0KCvLzCfkbj89AD2WlfVi855sjhQX/zPuOv/8g3QuDaI/WPtvaN8hxsLMjruv91/0Yn4p06ozIIWEgsULeGvwuYS7GUX7BKiIAPfwxZIt415hk5MBqIzIkJoM2w8NgLotfYmETdvO53BHYi2LwP9+xSnjJLNnyMFZH9pjp41iPYf82Fw+zxkqhIdZ9IIZXJ0uMNgWfc/UgMQkYDm0qyV30q0R0ZKUWTw8UFoiFQmasDsCniveTjRQVxUjeb1EsD5cqp2SNSfb5kyhqcsNkNVVGAY9PC8lCffMV5uvoKen4mvvj7jju7rh0Kvo180poQqecLNc1j/PuvvRKV8Zg190r0jKXN45vxiB2Kf5tcEwOHvm6xfk/AAs6rizcsOvP+0P62ukqCQxRbx8CEomnXk8F7VAAOp8Ee1AtOiLVuUEB+lzpLh7MtqToeBlV6I0gVwsUKxrRVk5iBWwQB6kTdVaWpMOwNPhtdk+rXCQL9sMoaTTkJNtKA7YOGeRijbKlURsxqxRuL/ciU4W3uUVIYFqdmSnD0yAY0IihZFlToUYNMVmEO0y8inGJu9+Jfh2Eerrd3fL51/n5bmE991zh+xDiW8J1wo9EdwJouDlx+81rsJ1iELavzaqLHNKbYrAHgFTVC60iEc7YA72Lt0y7RcTpuRAoDdIbQQeipmfB2VMTdzcys9ToEgcI1XNLl9QD/rGDQipQaEQiuVwU3MwFqP5hhf0K5w7nOaftzjPNv23KHGKGz4Rocw2JmuywYTGILq5FtWKIKqwJzeuGKjajW0nYfq9Hl3vLewA13WXdiG3cgdt7/v0vhUlyzUkqtsKmyOUjeOGU5hyCwfDpsBMM+2OyXCwnwlw3rYj+7LWPQJdJL4c5RngLdthQFDnGUjwSIZP3WGF7ooHBWJQ7moeBIRQNQsF4r653fVsE+xOjL+nKXX5d7BL/5A2x1H3B+cP+W9zLRdyJNx99xeyavRynPSX0x1LN7yvM2x2Ssl5aiaNyYTiChAnlexHMyeKMVRB2NLEu9OZ4coOiDYPJcpJObD/42457rSE4/IeknMtxIRMmm5OXuuyzEt8jyHBUHm6FpMvlZxDMxlDVRhQmSyy5mCv8cO03lnSJ8g7C4/Vhj1syiH9evbL13v245edwcbwFd4+I2z3KRdyn0x8pxN5FUSBc+TlQ6FcgDKSr8VGVSehXNkbJdrHJJu9zns5Wl8wDGVEgKm++1xvn33K3uK++aa5hwbX5tmnlYrBv6OjujhBiwh1ovCQ0xatx3wF6wjyUXHbOrSv+LjSx/CYg7Ftzy0k7D1UCXUITtY62nZpPE0+7lr6TkksVz15Mai4NfF4wtWvbdKzJFAcvLENyEZQeKimhWqOQvHlDXIxLM4vl42NrG31jlv7N/bIyGxuzqLExOu3L5R07HkzQQMTCEWLBvpzgbFGW6FZpVtCHnXUOWN9uCbEOtgeJDdNDdzyZqfyg0eJwf2YF35ISQLSP0PNMD6oZQ854gg0yL+24R3moH9SeM3wmpAnNa4IrehktCTL8FrNeHoiXjVqNw99YTLcm06pu/gKivS8ialpd0tvaJia8whM9v3zNbjbHLnTpqP9CGt7tYXg6IVpYW+uctqnt6VNx0MGaPPua0WT5/8wFBX/+cmrYM+nZQ5E3f7ZvwFMszt479/Wvy1RK68vbIgjIoO9kMrp9yc4aKTHZB6XoyPOgMvhtiKShveHNFlNnCtVJU6WwOvAT1prs0dlfTaXsGdHAJ4FTmRpVgjAhaI9fApKAxAcMxFioWqWgoq5Ox26prarSLiwMVJpzbheYZ6O0V1BWEqYQyg+zxej46ne2wQVQCE2L2r9gHhXGJBA9Re3g+GY+jbc3RQVtcywShfBBuiyHw05Mi3YPRg1ga9tgxYiN2qyq5edD7NOLAFGFMzM7Fw6bkU9t266euYCADCHp/NtfejqEpDRUA7nBqPTtmFw9XrM+3EZnkXwatoEx5JlkmAOcnnUJUlDyOD69vRxHvc/cV6kcPXE1K8xk6jjmWg/LYalb6Zfjl2cub5mdphS/lirfWT8fO3aE8Px5ITEnFz4+PHm2tfU/XbWKorBRsDJyabHUGI6OK1EfOKqlvtBhS80V82Q1VoBllSrk/SBK48vaZDdWqdSRS09sPL7Eqz81re/UgNxv4MX+fbbetBgh0UBqNFUR5QU8e/f9+387J/MbONVnfpPb6bXkRuPupRxPVeMNlzbZdT650eQ6YiDeWKVSxRerYU92327gxt79iD2vQE7MIq8gGYi8QoU9f/++EXztqb60NEmn8AlTVXwrbZPXFI48t1cXF6vVhcXakJtfSyCCHL2aXilvfkqdcRq6zvuIWOekAh05gbxcduAAJd6uEsfCJNOxZkkTJ9rSvtixPl8CGsjdX2WHTj/5SmfqQpHFW4YT4vYbEmF3qbsOjvHUJrlr0B35CnT7QJQ01fxouBYV/saRQ+s9Y3LJFvOS0LwE7wfbLSg911ZUtKIvF83p9b5wLKEw0cY7V6oCV3weaEN3l4xZrQ/CajXnE6ak450Zg51j41InAgEAeoZ/f6d+OHL2nTtze/g2fPfM98Pfw7+euTN8B/7s5+O3j3OPf3/c+fid42B5U/8yuSQkhLLowNnXpj0bJWHJhcPG9tx42dLt9o2w6eJiKLND2b1XHDaPXiQvXrps29+MgBieG5v4+B6//0upbcx4govAS7e44xPGi8T3fH/9elnw579WnnvpIPJPu9z9JRXWLq6MoYyeIuOl3fFFBnlys6+KtGCPq16nYx3cJOguCyoXbT7ML+QXFtj/qkgAu8i02Q17tRAtpAAKtv0QaYPS2YZB+UKbRR+vaOOf5iffrolRFgoXaiurWmt07Lq6Cod4JdUSMxAfmIAk4PZ4EkTxQVqV1GgGXta9TpmYZSbCWyiZVgoZIAV71zpDg02sTazOy8Ez0l6wRh0xGMq/yRgFzuSbZPib3LHamkMB/nIafId+xylHAgwQ1Z+LFO6WZGHcVciGtPzeSgNTIVD45DbZJ7ATUhJt1SxV8vInE3F2vaP3fxEQ/kqNG/s5jBWX8TRPur1K9S72ER/+WO6EMnu2/yvbqghK+EmeFFqj+poV0LnrBP2sRnP5boUgzcO6k9WPDeSz0uRSYJX5HUpcgiEMT/tccAI5GXKq6vmf1Oslivx26sDbxfPLGWYNV82trFoGNSYz9xatrGzjXDMWqvzlYPbfftTNMDxsf0tSCp5jHDl46eM/MuIkJDEpgXp+bCo1dXz6kkXpa+OmmN8iMB7/8bEFzM28mZ8D/R63BYeIaIl/GSM4P/RRIqY0aCDWdrVQxrIuwSqs8M9b5w/9x761w3bhTyH2RcCpoqhwqNnNLYQehXO31DURQ+nVq6rcLhUWhYYO6iZTw4k2+ZZVxHB6c1WV6Ejz8xxE7a4+d75zj/nStWxWgmv3bl9ZMIhYsLuXx4pPunQteM/gmbPBArktCLb6fpJJn7yhE6egzSv7q6v7+/tp07acKAVt+s2bqdmZZ2P91mzv6Rn0sQz310NxMWPOO1GYZ5bpS5dN5suHf/kmkAeWfJ3bbUMDY/19HXpDX/9Win+T9PWTuWsoTtMTypUnl2aezF+ceTM7Nzs1v5DAvP5k/KcfPrwcG+roNxj6+y8BkTo3d4JPezvV39FhMHQUXb1bOjUzM8EMz79Z+mRGzu+ZsVhqDye998fLD2Nb+zoTF3EYRL896O3x7Lt0YNgyFuhSXjk2DsDs06raq9FzbTRQAIEZt0trVXGtnV2dKk1He0dH43a0rlKDDOp1gXIDViUPvInhbwbKNeCr5cJTBaFcbZDhxnDH8YaRiz/+5xqia2wZrmTQozk1sIlVR6vJhkV5pjyaMsYxx2S0q+TkQEpTXkCk5NYYgZc+gr8s6Yxeq8XJSuAGayYXLwk1yG3DS+uAdpfHaNI6zrffwbWM8fZqt80c67LNLKv73dXzy8irzGsO9gG8ZF5W+uPxv7jcv47/WLps+eM79wLTAtei1Pv+qzCAXXPJNZE1U7mhFpk0biUP/h1YJ5GYPfxvkLz1tWcX76/M4MS21bm717U5xmaU35eNYuMp2N+KKg6Zehe76LpWCwSru2y6p5c0VFxn87PBrP//5LFo796goL37YCc//ZydeAsL3BrGu6vdNsasZtP9/uqhNUdv37jlqOV3r7Vfu7uc/E4DSEBIsgL7m2KICkNCMnTCoZ/LMxxj60J1tX8OHEVggWec+Tr6dcALKu3+0koFOPMzx3XNQrIQqDXLu9URAPQ+A2O/KBQhCAkQMbAgrFH/kGWVXVxZdLf8yoqKy7V9zltd05y3bRHutwh3LTy0NGpRjnCPXTNvm/VC3K41sK/nT+71bcFtt6HnQ3Z4Qv63KRBWxrdTsO2MduwkO7Z83eDZvXnDYbQO2GxDLOwMCPLbvMU5iK6fodOWzQ0NJB+flDYX4YTOBqK3NymlD3O1NS5BqMT6mtq+FFJR7+FDBEIuJoKwsmAUZ4iTbjSGBElD6e1T79+MDX8feSw10ZD4d8Z8/8MhmWT+S++///I+fp7hE4O3tjoMcjiDDhA0cw2sKA0xlpY6RpnM0VFmc5Tj8migLL1gW/Q1MUF9Jmh5eN/C+L9GHwSZINQHyMh7Snj66hq/9PPhRyO/NQXBB0j91u9MIPTtLfFXNEBbBZW67Lp92zZ2aJu5d8QtxVPllhi9uWoRS/myquCvo1GWCneDDx1F7yyNPpcWF4aEpMgfSaOGrON/H1iQasOYLA5Yz1IV2sEoV/jSe9V9KMMM0OR7t0b/p3zj3j0X0CL1o/KNPpekyff2W13dh5puvwC83S3FS3fgDfgl6/enGT5FssOX7OgXSiE+JioSHxm5BGb8lBjfX/Hf6/8eM0e+U402aBa6L8xyzypxL0l2Bzvx04I5wTTxgVHell3jkQIynTRNUshiqUZKOMnOhlhq+ZRgVs3axAzuMZEiT5EJkgn0yCHukFi8vEbv+Zxn0ETdQ3IiL/eSQ44Xo1WampImsbrJpKam296BiAX7k30Ob3dJrKt78emfIdSlk7wjzev6QtRqLfHDPkmleg5kJKTLSrWCSAaeHQ/dUe20Q8vaXxxSZ4Fw93gUDSYnR19flkeNRGP0sJEweUT1103Xec68EV4AL0oeHZ0gj/J3dhWKHwcOv96sNMolwPU6iIblGLa/vBej3B0cGxvcSA8404PhANAUENtg8/iQWHWYCIVD+0jCi8gOZAwJE/hdJwAygBiweDQJQ/QjaoaFlL11DjgG9tQwg/iMmBYFGBpz+yjxGn5yv4wWQyFbyEe7mUxRZxY+AACyeQmMBCY0RU6RGgyiqeWCOiNE0wKBdllkSJILWwe6AiGZ3goFbw13moMo02hy1aQqDAap1L/JQjaZ201LwjaKu0GjhUtQBQiD/O4K/Od+m6+vM3KDITpAP1Fs4v3x43ufpcuO+7IrLPmxjljssfOJ2OMvIGCkxGa/VhtyPyA9jl22q/E8uyhNnVFN5JWUpsVyCwIWJDPvO7OLvDmFwORUexy35azH72hgl4ECXmMKsDxxex4y67d0FgC4K/oeccVd48ur7GiMZ+jY7FjDg2pcxKSf1QPXhiivdPnicHefcYDb6lv754WhIWPQxaHBNA1cnCzxOLLdSZHbw2heLylQzvcQXuRJFuBPlNd3dOoDGjq6pjHtMRgc780nusXlJPnII1h/ZWj4uvVGq4GN2Rp3dWNBC7PlinTRSlhFy3yvd/L3c4/fBegxPEE5EZo2j7cPnYhIn+AHTPQ1ByzmqFmPsATM8JijdC1+T1uDROsdy0cZczLUvUE4C0y0L/YXvQcAy736FQAAua73ByRw8Nenu86yf0kGZ5fya8zKrMigwbAktIh/r3Vhib6njNlmS7sxVz47CZtfcumCtV6I8VX2EODiKEDYieHfGYj2R2WNQZwcJy+qJh985/rOkE3hOl9b7417xi4HFSrGSt7Ab55FGChRrfRyZcu6P7g+OXfr+KIT/GznBoZ0mHiITMtr0CPPFWdsCDUqSWpkRRRkqLhYAtFTMnVxbagGkGIABoaAIJ478t7wDXuVihTNhb/s8Z1jyNuecCymTuBWD6gHuOAOZbg0OA5Vs1WiKTXKxIJYhuCP+/WCAvgjt3PfyGK9e+6eMoPl7Fk5JOtPo+avnL8fXGl4a2HRFVGwcoEyyBCpDUCA2szds23VZeeiQ/qHduiNZhoDrVLjS/oZqK2gikNXlcCDfz2NwXd5gCCY/o5hfenOG6dOH6+5/v7a0zm4LYnEECU4iBm+CHqJ3CrauT+NhVhDwrnJUYxdvAiRejkwi9GZ/A2+gApfce0Vh9EzkXHJxDWhGq8BuIrEIkgZlg/+gDpUM2s3SrHDixvdzeCd5ineEwZvu++tOSF6ytRlj2wq/usXi+MJ8+Enj472vTE/TokDwy93fv3lkorOQwfh26ctT79IL1doeOXrD7AOL+eqOYu/wQ8QgbQr+Mxg+pcz5sG1zzFcGx5kmwzgI0VBks/UwWLSzPfM2n5XZ4yAIFQJ6ja+Wihq8BrP3mZi5kV85wfZe7NnOvOLzMwkhEyq6V3DxaLvp9l46xHbadtlKwa0eTacFZ7lO6Ye0/gem8oMz/TV3B+jRduGkJ/ve/qfvPoPNA/UvmBSQCwlWn5fbxwPE4sD/xiC7sjupAZJ4aHN5tTV2+SKI9tTU+/fUyru/Wyrbt+uCNI5KDmKgkIlpXV6BQfYpTiigi7BQWGvyC2Qc9Qz1sLg1pSSCIjrVYbOxhDfEuk8pVTyi16fSCUjlZKMeZItIpJe0/vP+dkTxxthOir9Fyw4fgAAYVmGYHx5LVxaQJuxz9ftkcxkZMYa+YylwlzppCSelGYuc/I2CN98r6MJWDW8PQ2XlqBfJZrG8SntU6BgZH4EMh6hQypn5Ll63sghAOy2apob51eJNEF78doDs/RIt/x9orDG71+gTG0SuSxNm8jpt+iNNY0NhUZTvGHFUrNUXCjc0uj0kaYg2FMp0/Ya5sRn8vV6bkbdK3ouk30S2GKfQv4AVUEF8Dm9c3h+htudotN1srprBSMXoMRdhISSohkutk46PklRJnC6RT5IBZbA0QRFjVEuprJEKr04I+mlJN0qn7FWEscUOJd4QzMDS5/BQdsC+yKwJNvtDoCFdtuFAA67PdkCi5Kyz4zUyOiuk7IEyu0FzxV8eWsltqyD7vp4QqA52ShNn/BHFxmDxKN6Z9yG9xZOa+tOOYo+G2As9QGU+vc3LUlO+lPd8jQC+Co1F7LbADjr8zHfpA5pASRkynWRDpKf/zGw6mIxz/pqPZBT9RbRXuF0YbG/F90cfQsYIjBcHVS/Gl0ZbWNaIfqXh7VpXiclPITz5BE9Mk/03epAhrILQ7USTfE7bKk5W2Fe5l0c1O0bgpNVfI2RRjaABDzcuLK324epPFCycvLhFjNYWi5XfjoMALQqlwqKwM6HH45Wsg260+UAEGkPgdet984faL9Wg7ysycznVNfiStf52qFPcHNWL0yJVB7TRxV/WyQsCkOp+w3O+LMStBKXsdlnaV67akBlQ5zqVJ6f7gUE5pNZlPkn+StOVHjLvSgDyEgtwwiW7w76VaIzTup9Mqp1PZK1y3+ZmWMqsl5rzNNp04Mh60If/P1u2a0l3mzcZSnNarN7epCBYzBrxcHrxN0BASHoUKXf3Svlw2Y84NJcs4arec2GarR5yy5IzMaM1TPpClLd0vjt7fw0t9SCAsMsu5jL/NkUYH5+pc7NsF/FObTO8UjlpZQ8Gx1WkJDMGeQ4vpiSjnLxhFuDBmoN6HMo99denHx0SXuDJW1gNrCkN7SXHk1e1PoHf4SDvhoDdXDksbd36Ui3cz/odhop9fZ+PAKulIqW2hgCnOAcg/4GTRm9zAXQsM1nsYgLS15x3KSuPVhNlC8Zs3BxWWNee0CSJiYxH7N5OeqBNE4RwA2gziSu4sgjOjlyFePMoylVvMeieOtUaxgFQWCH8JP1p9511HqQbyLhqPlP6z+tB30wn/rpnankBs5ujcvLi8se71Peux8bdWS7Urn9iLueLpodSlCxxSqakSF9tkrF2AWJ2aiw5lLPACZECLyX82reh7mwVxOSrPTT6yg7YAhgfGI44TS8cN3wj1Oucly4axJOzRXbOtt60z2s/I9SyfurV6aWhWQ09UrYgdJKvb8Fu6ThrmuQWLd4kUC1dvmJTJNBuPBMAvDuHR4b7SJ2yj0hZpN++omhTU0FU7FmkeofnIsiueAnwL0k3JiAwqAJAAKYQmgrNIwE+DdRz6Tu9zc8gRACzvivjzquw/gZQTd5ff8FKgAIZ4JcQXB/lz7Xb87FxaLE9v8/U5m8/BcH8PxoevQBnx/tJfjsTIWX1L4uIWHMY5GDzKa5eW5p8R9KR1grKCykeGfXnJMtHnKOC6a22FSJQo4ckctb2/49Xu64O4GE5E5iKsCd3a+oBzEUUgCACwenZBmphwBCxZ+VQWpQJkwGGZEhEgBAcMnoROKEDWM2IHgAChiAoJVorFt+2/07bmnb1qYMKAMHiqofaHOFP1TTW2XQnz/znRWXhgUWLitv0LYXrydu0r11ypTf8kt9srLOL0CLHgBERMerFZqbIlXAS0lIAxkmbWiPEikSgoB311/zW1O0yiV+WkSphtTmRCcSGZmbAAAA1owEgtzQhIHyvok/4eTWg/f+dkKCCICaLHNEdilIARA676qb2e198csJJa+mW3UErM67q4EGLKBeNtgAAQl65nj8woiUkMo5KCMAFu2csnr0ZuZc6ftkM4UIZPZvLYki2qYVAycAYI3StLBjX3jL1DtTec80p0dgqo0DAEREb8qwjlzAiQRJWD084zBTUlru/ACe+d/QTUP/vgYAEMC6a+buYAQmib7XS1/TDAQRnFFbZp/MXGJFa3tKeZTD3KYev2+HiBomJKZU/dAEEAEQCAIiKlA1326cXRKfnVSCRONz7Wt9LmG/40+wIE5piEol8fkCrUPJtQ3VnxKvGn9YLz/hp9TFTyrZZ67dPSEZaURBArsc8mOCEA0ce604ncWMWRG3P7VtPCLSrJD7W+Br/M45POgf6I9JlxyOHOnFhuFtBeDEDW6xK6A9L9BW61snXdWj/aEDFQMEc+1guGLQax/4ubxn5tv7tRo++UtMuHY9gYfSkBypBebw+qt68Php5TtT7o8cVOW+82E+7HPhhTEAaWJOdOb9VYzB6c9xYIO86/ksBI/GMeoMk97S//eJz15+OpMOvZ7+JcYzsR2jpzDjrV9ITnOGD8bYxYFKN88Yt4s7uWojVg3v0GmsZP/+PzP5z18U6FiMjCqjlsf2tjIl9T24aGiZwNMjbWd/jNuCYKgy1BZrGe2+8f7FOQD/AIBrOgCHUoJ5jtzXMF9av7xief2OSfQPbLsI+TXUAoNRNPwKa8biKdjj90xedOOZL0ekea04fGtlXjIOH1uX14rHtVbWxeJxyXmAfbzLmhsR+LJg0RvNsbNcrzpkdbKSnMb8jXfRlTc1SAz6RP0+CG42tXeS59p9R761oMT3mkew/9UnIvZEQM7GgAHPFse/yRs1ZHojViwWcpPtzzJ0AhjNjUaRTprEgns2VXtIJxfsIe2ZfZK8d+Ee8g+2q73BDUeS73rf66ZkHbFg7/hVVrKzsjvUk3isI7kQea8er8fokCjqBYEKjCUJkj7YJhKJnxPT6lMJsyvOGT4lziA99Z67yurcntjj535OKy9buuJkULGSrznqWsDu0i/AHT41Vm/DWFecEIAqPkt/bOdVzLZbylEu7RryiSlRFjt6w5ue/239UmvIbC6OORxxTRfpzV55uHAvZucLYIpCEbjr/YsXhctK46TvP4hCXa3jVHpJaIhBr1KT3iYhZ9yH2U3ZrGywsw6l3VtrelIDsud5ushb2T2eHrIpu9PTmXitqos1kjh43Kxn4cIHDofH43DcP1nHjH0lQq6u6deWXfbRAbMhXEhaqpcofoH34FWHzaM/XLUlXk/8Ze5+KPG+EYwepF+0bmKXsvhMDN5PvG1Oz3XrTofGSazy/IVN2BZdRIQ59G2dSOM/eL/xmrQW+nfeiZ3TxkEVrRI8X/VxPgcA3QFg+cXCMR5j3liM83S7cA0/SfP96j3SiF/DaL4hk8sdr1ki5gPLLk43Uut37xqfO7de3G7soPuLSHWf6SV+o647/5zYNGtu/MBAjxu/fEn5m80dDOADAUOAkMDbfp4UQOI2uPwGPyH+t32UV97zYXo8H3G5ifsts3gu67SVHlFhkq5aN0nQje+qAC1wZRy/ykte4TFBqOH1CdU8Xy34PJ+tZlZ6XFJFqgLzUhqEBj6gdEdFgY//VnXr6K1raW2qqgRO7JTZvX3sBbv35Ikc53qGOgTcHd5z+2b6z3YxFCw7kFF4zF6Tww62r1Nkcn67tF7jP7taKGTFhEhEWsIIKyE5ykJZNe/lVHM7uz+d0Tt/3tGc2p7XslYxqRxVQtZwuEQmM1jl9OOvftZrfLs0OcoiHepSJD2XD/rl20YWXFx0K8sGqlakqrBVXCXqRf5PaiqejBY9f7j+JX6bhx4PLX+z/zZUdTXNa0670ypOXJA27+q8L5yU1o7tnK7C9gd1d/e9dC8ACHVur1HlOe+Updzyxb6mEDeTcw+e/Zv1EuEp8RPjfxKPe8VsWyqcuKKjNowOq/WRUq1WSZRe5JM5CQpOzstBBAIdkjmDBDXAGzgAhN1K7JuzGyfraALr//llkyknULBe1E33afnW8dWIqDFXjNOvkqQZjVU9DPr4ssZao3F0IW9z479e0hTA9ikcs2zWT6mvSNTrT5fVzpIkJ1NjHBdjLIPjMpjMALzMM5fjZ7hsyYLQyeqeIRh4NyGuIiCUCOUud7JOZ2NaMScs8kFMZjaOsymsmNJiVUmgooJlNYm/YsVfs6tLEVy4kW70k9Q6m8oQUKRlfJ0af8jwZDwcn/rKsElLr2IQx6ceMj6lpb31LKtg1a2Ox55vPUQ5Oz7daGAmGZjA470fRysBfKpn8ACAoAmjobLA4M0J6rM2VvCqkz7a5/rWnLd6Tf7iZXJbEjYp3HWrSPeWz/9lq7vz5J65swINvviyNPTHN9pI8x/i1nOtybELFy45BmY+St+2D/4I98vAessYmJwUBn09zjR/MI0GIenUTtQ4R2ly6Yi21k/6cwtFlnCwP3dE3a/rGBYeR8YZjBYrBesmDythkcCF1n7cIklJONxPztdDIRZuhI4zGtKpFc7Yc4UFJdk5OaAc2Z8PANGL5FRXgzJYVux8p90nrZ2Cpz5Q87nmnMB1/FTH4PnWdtxIbiRko0dHuSi7iay0tmbTkeInwMPeCj7vHAlauNneE67GZaaF9e7YgZ2Zw2r78v87nTBr3iv8u9t37f8CQNt1o+hpY8/YvWniz/yBf6mH1ba5WgL38T8raOMN0Hlc/3e+OTuw4ikY4StvulqzvF7jfn5QXEX5T/EBqGO6bXLqOPFt0V2keBlG+iutgk8bfodMXXmI94otwD/4A3dxD98c4b7HD2fK92nKpbzIn02/XwemX3WaHlLT2yLWPzYDkMSSOo5fp6ZPSDoc6fc08B/uMvwFx2w+XXeajPQ9/+J808sYO5omquQOy+L1Ln/jBtNSwod8daR1jqmvXUWni/IUb/NH06eqTQU2cpa13ZtbnMeOVpGdVV3MMLFONh6KZlSxlN8blnddu221mVd43zTbVj7kZZ69/p3ObFGsxaV2ofTzhA8X5OEmjKP0/hUxcLBYuqXvrIaV/87Xu3jrNhCBAPiJX2akC3xqRumPTwGPl3FnOTKX/mZU0G1zZ8K9/52/KPC2Tea/hb8P/7dtTk3xKkwQnH5d3KJKbCa6rOQi5ydv/Dpu7Hk+ld7+MxEXA9eW0acg52Z14mLRDNs/InLaICU0r4MzJ6ExjhEO+F0fDwboLQJw5aoekjHzRRA5SdpPSdpHwAyXhSKnCgf8r4+HRCgUAbjtsB4CGPyE8ux8wc82U6sW/Bw+n8Z5HmclyMnOFxTa1fKyatEN8DMiHMV/FIFTFP16VJU8oVVTblVRvpBbuGnlc2mSL61Y6re6+sWAITe/tiSzSlr8J1M+9qt89W7r5f/fl3WgLLK+hpufeyaaQDLdbm4OdLMa9nycYtGauFi0/uWoBQAAAA==) format("woff2");font-weight:400;font-style:normal;font-display:block}.dcg-calculator-api-container-v1_10 [class^=dcg-icon-],.dcg-calculator-api-container-v1_10 [class*=" dcg-icon-"]{font-family:dcg-icons-2024-11-06!important;speak:never;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.dcg-calculator-api-container-v1_10 .dcg-icon-sparkle:before{content:"\\e936"}.dcg-calculator-api-container-v1_10 .dcg-icon-diamond:before{content:"\\e932"}.dcg-calculator-api-container-v1_10 .dcg-icon-square:before{content:"\\e933"}.dcg-calculator-api-container-v1_10 .dcg-icon-star:before{content:"\\e934"}.dcg-calculator-api-container-v1_10 .dcg-icon-triangle:before{content:"\\e935"}.dcg-calculator-api-container-v1_10 .dcg-icon-folder-open:before{content:"\\e931"}.dcg-calculator-api-container-v1_10 .dcg-icon-assessment-four:before{content:"\\e92e"}.dcg-calculator-api-container-v1_10 .dcg-icon-assessment-graphing:before{content:"\\e92f"}.dcg-calculator-api-container-v1_10 .dcg-icon-assessment-sci:before{content:"\\e930"}.dcg-calculator-api-container-v1_10 .dcg-icon-insert:before{content:"\\e92d"}.dcg-calculator-api-container-v1_10 .dcg-icon-go-to:before{content:"\\e92c"}.dcg-calculator-api-container-v1_10 .dcg-icon-3d:before{content:"\\e926"}.dcg-calculator-api-container-v1_10 .dcg-icon-compass:before{content:"\\e929"}.dcg-calculator-api-container-v1_10 .dcg-icon-ellipsis-vertical:before{content:"\\e91e"}.dcg-calculator-api-container-v1_10 .dcg-icon-scroll:before{content:"\\e913"}.dcg-calculator-api-container-v1_10 .dcg-icon-create-table:before{content:"\\e92b"}.dcg-calculator-api-container-v1_10 .dcg-icon-3d-cube:before{content:"\\e906"}.dcg-calculator-api-container-v1_10 .dcg-icon-3d-perspective:before{content:"\\e92a"}.dcg-calculator-api-container-v1_10 .dcg-icon-headphones:before{content:"\\e928"}.dcg-calculator-api-container-v1_10 .dcg-icon-confetti:before{content:"\\e927"}.dcg-calculator-api-container-v1_10 .dcg-icon-trophy:before{content:"\\e200"}.dcg-calculator-api-container-v1_10 .dcg-icon-clipboard:before{content:"\\e205"}.dcg-calculator-api-container-v1_10 .dcg-icon-arrow-infinite:before{content:"\\e206"}.dcg-calculator-api-container-v1_10 .dcg-icon-arrow-once:before{content:"\\e207"}.dcg-calculator-api-container-v1_10 .dcg-icon-arrow-two-way:before{content:"\\e208"}.dcg-calculator-api-container-v1_10 .dcg-icon-arrow-one-way:before{content:"\\e209"}.dcg-calculator-api-container-v1_10 .dcg-icon-randomize:before{content:"\\e20a"}.dcg-calculator-api-container-v1_10 .dcg-icon-zoom-fit:before{content:"\\e20b"}.dcg-calculator-api-container-v1_10 .dcg-icon-comments:before{content:"\\e20c"}.dcg-calculator-api-container-v1_10 .dcg-icon-lines-solid:before{content:"\\e20d"}.dcg-calculator-api-container-v1_10 .dcg-icon-histogram-fill:before{content:"\\e20e"}.dcg-calculator-api-container-v1_10 .dcg-icon-histogram:before{content:"\\e20f"}.dcg-calculator-api-container-v1_10 .dcg-icon-distribution-fill:before{content:"\\e210"}.dcg-calculator-api-container-v1_10 .dcg-icon-distribution:before{content:"\\e211"}.dcg-calculator-api-container-v1_10 .dcg-icon-dotplot-cross:before{content:"\\e212"}.dcg-calculator-api-container-v1_10 .dcg-icon-dotplot-open:before{content:"\\e213"}.dcg-calculator-api-container-v1_10 .dcg-icon-dotplot-default:before{content:"\\e214"}.dcg-calculator-api-container-v1_10 .dcg-icon-boxplot:before{content:"\\e215"}.dcg-calculator-api-container-v1_10 .dcg-icon-points:before{content:"\\e216"}.dcg-calculator-api-container-v1_10 .dcg-icon-fraction:before{content:"\\e217"}.dcg-calculator-api-container-v1_10 .dcg-icon-cross:before{content:"\\e218"}.dcg-calculator-api-container-v1_10 .dcg-icon-open:before{content:"\\e219"}.dcg-calculator-api-container-v1_10 .dcg-icon-point:before{content:"\\e21a"}.dcg-calculator-api-container-v1_10 .dcg-icon-shaded-inequality-shade2:before{content:"\\e21b"}.dcg-calculator-api-container-v1_10 .dcg-icon-shaded-inequality-dash:before{content:"\\e21c"}.dcg-calculator-api-container-v1_10 .dcg-icon-parametric-filled:before{content:"\\e21f"}.dcg-calculator-api-container-v1_10 .dcg-icon-parametric-solid:before{content:"\\e220"}.dcg-calculator-api-container-v1_10 .dcg-icon-parametric-dashed:before{content:"\\e221"}.dcg-calculator-api-container-v1_10 .dcg-icon-parametric-dotted:before{content:"\\e222"}.dcg-calculator-api-container-v1_10 .dcg-icon-polygon-filled:before{content:"\\e223"}.dcg-calculator-api-container-v1_10 .dcg-icon-polygon-dashed:before{content:"\\e224"}.dcg-calculator-api-container-v1_10 .dcg-icon-polygon-dotted:before{content:"\\e225"}.dcg-calculator-api-container-v1_10 .dcg-icon-polygon-solid:before{content:"\\e226"}.dcg-calculator-api-container-v1_10 .dcg-icon-title:before{content:"\\e227"}.dcg-calculator-api-container-v1_10 .dcg-icon-rocket:before{content:"\\e229"}.dcg-calculator-api-container-v1_10 .dcg-icon-reset:before{content:"\\e22a"}.dcg-calculator-api-container-v1_10 .dcg-icon-desmos:before{content:"\\e22b"}.dcg-calculator-api-container-v1_10 .dcg-icon-download:before{content:"\\e22c"}.dcg-calculator-api-container-v1_10 .dcg-icon-embed:before{content:"\\e22d"}.dcg-calculator-api-container-v1_10 .dcg-icon-export:before{content:"\\e22e"}.dcg-calculator-api-container-v1_10 .dcg-icon-book:before{content:"\\e22f"}.dcg-calculator-api-container-v1_10 .dcg-icon-print:before{content:"\\e230"}.dcg-calculator-api-container-v1_10 .dcg-icon-arrows-two:before{content:"\\e235"}.dcg-calculator-api-container-v1_10 .dcg-icon-arrows-one:before{content:"\\e236"}.dcg-calculator-api-container-v1_10 .dcg-icon-desmos-badge:before{content:"\\e237"}.dcg-calculator-api-container-v1_10 .dcg-icon-move:before{content:"\\e238"}.dcg-calculator-api-container-v1_10 .dcg-icon-move-horizontal:before{content:"\\e239"}.dcg-calculator-api-container-v1_10 .dcg-icon-move-vertical:before{content:"\\e23a"}.dcg-calculator-api-container-v1_10 .dcg-icon-arrow-left:before{content:"\\e23b"}.dcg-calculator-api-container-v1_10 .dcg-icon-arrow-right:before{content:"\\e23c"}.dcg-calculator-api-container-v1_10 .dcg-icon-arrow-enter:before{content:"\\e23d"}.dcg-calculator-api-container-v1_10 .dcg-icon-shift:before{content:"\\e23e"}.dcg-calculator-api-container-v1_10 .dcg-icon-duplicate:before{content:"\\e240"}.dcg-calculator-api-container-v1_10 .dcg-icon-error:before{content:"\\e241"}.dcg-calculator-api-container-v1_10 .dcg-icon-film:before{content:"\\e243"}.dcg-calculator-api-container-v1_10 .dcg-icon-folder:before{content:"\\e245"}.dcg-calculator-api-container-v1_10 .dcg-icon-hamburger:before{content:"\\e246"}.dcg-calculator-api-container-v1_10 .dcg-icon-hide:before{content:"\\e248"}.dcg-calculator-api-container-v1_10 .dcg-icon-home:before{content:"\\e249"}.dcg-calculator-api-container-v1_10 .dcg-icon-keyboard:before{content:"\\e24b"}.dcg-calculator-api-container-v1_10 .dcg-icon-lock:before{content:"\\e24c"}.dcg-calculator-api-container-v1_10 .dcg-icon-minus:before{content:"\\e24d"}.dcg-calculator-api-container-v1_10 .dcg-icon-new-expression:before{content:"\\e24e"}.dcg-calculator-api-container-v1_10 .dcg-icon-new-folder:before{content:"\\e24f"}.dcg-calculator-api-container-v1_10 .dcg-icon-new-image:before{content:"\\e250"}.dcg-calculator-api-container-v1_10 .dcg-icon-new-text:before{content:"\\e252"}.dcg-calculator-api-container-v1_10 .dcg-icon-pause:before{content:"\\e253"}.dcg-calculator-api-container-v1_10 .dcg-icon-pencil:before{content:"\\e254"}.dcg-calculator-api-container-v1_10 .dcg-icon-play:before{content:"\\e255"}.dcg-calculator-api-container-v1_10 .dcg-icon-plus:before{content:"\\e256"}.dcg-calculator-api-container-v1_10 .dcg-icon-question-sign:before{content:"\\e257"}.dcg-calculator-api-container-v1_10 .dcg-icon-redo:before{content:"\\e258"}.dcg-calculator-api-container-v1_10 .dcg-icon-remove:before{content:"\\e259"}.dcg-calculator-api-container-v1_10 .dcg-icon-search:before{content:"\\e25a"}.dcg-calculator-api-container-v1_10 .dcg-icon-settings:before{content:"\\e25b"}.dcg-calculator-api-container-v1_10 .dcg-icon-share:before{content:"\\e25c"}.dcg-calculator-api-container-v1_10 .dcg-icon-show:before{content:"\\e25d"}.dcg-calculator-api-container-v1_10 .dcg-icon-table:before{content:"\\e25e"}.dcg-calculator-api-container-v1_10 .dcg-icon-text:before{content:"\\e25f"}.dcg-calculator-api-container-v1_10 .dcg-icon-twitter:before{content:"\\e261"}.dcg-calculator-api-container-v1_10 .dcg-icon-undo:before{content:"\\e262"}.dcg-calculator-api-container-v1_10 .dcg-icon-world:before{content:"\\e263"}.dcg-calculator-api-container-v1_10 .dcg-icon-wrench:before{content:"\\e264"}.dcg-calculator-api-container-v1_10 .dcg-icon-zoom:before{content:"\\e265"}.dcg-calculator-api-container-v1_10 .dcg-icon-caret-down:before{content:"\\e266"}.dcg-calculator-api-container-v1_10 .dcg-icon-caret-up:before{content:"\\e269"}.dcg-calculator-api-container-v1_10 .dcg-icon-check:before{content:"\\e26a"}.dcg-calculator-api-container-v1_10 .dcg-icon-chevron-left:before{content:"\\e26c"}.dcg-calculator-api-container-v1_10 .dcg-icon-chevron-right:before{content:"\\e26d"}.dcg-calculator-api-container-v1_10 .dcg-icon-delete:before{content:"\\e26f"}.dcg-calculator-api-container-v1_10 .dcg-icon-four-function:before{content:"\\e900"}.dcg-calculator-api-container-v1_10 .dcg-icon-volume-down:before{content:"\\e901"}.dcg-calculator-api-container-v1_10 .dcg-icon-volume-up:before{content:"\\e902"}.dcg-calculator-api-container-v1_10 .dcg-icon-volume:before{content:"\\e903"}.dcg-calculator-api-container-v1_10 .dcg-icon-thin-arrow-right:before{content:"\\e904"}.dcg-calculator-api-container-v1_10 .dcg-icon-thin-arrow-left:before{content:"\\e905"}.dcg-calculator-api-container-v1_10 .dcg-icon-line-dotted:before{content:"\\e907"}.dcg-calculator-api-container-v1_10 .dcg-icon-line-dashed:before{content:"\\e908"}.dcg-calculator-api-container-v1_10 .dcg-icon-line-solid:before{content:"\\e909"}.dcg-calculator-api-container-v1_10 .dcg-icon-mail:before{content:"\\e90a"}.dcg-calculator-api-container-v1_10 .dcg-icon-map:before{content:"\\e90b"}.dcg-calculator-api-container-v1_10 .dcg-icon-metronome:before{content:"\\e90c"}.dcg-calculator-api-container-v1_10 .dcg-icon-metronome-2:before{content:"\\e90d"}.dcg-calculator-api-container-v1_10 .dcg-icon-xy-plane:before{content:"\\e90e"}.dcg-calculator-api-container-v1_10 .dcg-icon-replace:before{content:"\\e90f"}.dcg-calculator-api-container-v1_10 .dcg-icon-angle:before{content:"\\e910"}.dcg-calculator-api-container-v1_10 .dcg-icon-line-thickness:before{content:"\\e911"}.dcg-calculator-api-container-v1_10 .dcg-icon-opacity:before{content:"\\e912"}.dcg-calculator-api-container-v1_10 .dcg-icon-sound-wave:before{content:"\\e914"}.dcg-calculator-api-container-v1_10 .dcg-icon-3d-reorient:before{content:"\\e915"}.dcg-calculator-api-container-v1_10 .dcg-icon-geometry:before{content:"\\e916"}.dcg-calculator-api-container-v1_10 .dcg-icon-graphing:before{content:"\\e917"}.dcg-calculator-api-container-v1_10 .dcg-icon-trashcan:before{content:"\\e918"}.dcg-calculator-api-container-v1_10 .dcg-icon-dilation:before{content:"\\e919"}.dcg-calculator-api-container-v1_10 .dcg-icon-vector:before{content:"\\e91a"}.dcg-calculator-api-container-v1_10 .dcg-icon-rotation:before{content:"\\e91b"}.dcg-calculator-api-container-v1_10 .dcg-icon-matrix:before{content:"\\e91c"}.dcg-calculator-api-container-v1_10 .dcg-icon-scientific:before{content:"\\e91d"}.dcg-calculator-api-container-v1_10 .dcg-icon-test-mode:before{content:"\\e91f"}.dcg-calculator-api-container-v1_10 .dcg-icon-reflection:before{content:"\\e921f"}.dcg-calculator-api-container-v1_10 .dcg-icon-polygon-token:before{content:"\\e920"}.dcg-calculator-api-container-v1_10 .dcg-icon-accessibility:before{content:"\\e921"}.dcg-calculator-api-container-v1_10 .dcg-icon-curved-arrow:before{content:"\\e922"}.dcg-calculator-api-container-v1_10 .dcg-icon-cartesian:before{content:"\\e923"}.dcg-calculator-api-container-v1_10 .dcg-icon-polar:before{content:"\\e924"}.dcg-calculator-api-container-v1_10 .dcg-icon-translation:before{content:"\\e925"}.dcg-calculator-api-container-v1_10 .dcg-popover .dcg-arrow{position:absolute;display:inline-block;width:0;height:0;border-color:transparent;border-style:solid}.dcg-calculator-api-container-v1_10 .dcg-popover .dcg-arrow:after{position:absolute;display:inline-block;width:0;height:0;border-color:transparent;border-style:solid;content:"";z-index:-1}.dcg-calculator-api-container-v1_10 .dcg-popover .dcg-popover-interior{padding:20px;background-color:var(--dcg-custom-background-color, #fff);border:1px solid #bbb;border-radius:6px;box-shadow:0 5px 10px #0003;color:var(--dcg-custom-text-color, #000);margin:-1px;overflow:auto}.dcg-calculator-api-container-v1_10 .dcg-popover .dcg-popover-title{margin-bottom:10px;font-size:1.15rem;border-bottom:2px solid #2f72dc;color:#2f72dc;font-weight:400;background-color:#fff;line-height:normal}.dcg-calculator-api-container-v1_10 .dcg-popover .dcg-popover-title:not(:first-of-type){padding-top:20px}.dcg-calculator-api-container-v1_10 .dcg-popover{z-index:80}.dcg-calculator-api-container-v1_10 .dcg-popover.dcg-top{margin-bottom:10px}.dcg-calculator-api-container-v1_10 .dcg-popover.dcg-right{margin-left:10px}.dcg-calculator-api-container-v1_10 .dcg-popover.dcg-bottom{margin-top:10px}.dcg-calculator-api-container-v1_10 .dcg-popover.dcg-left{margin-right:10px}.dcg-calculator-api-container-v1_10 .dcg-popover.dcg-top .dcg-arrow{bottom:-10px;left:50%;margin-left:-10px;border-width:10px 10px 0;border-top-color:#fff}.dcg-calculator-api-container-v1_10 .dcg-popover.dcg-top .dcg-arrow:after{border-width:11px 11px 0;border-top-color:#0003;bottom:-1px;left:-11px}.dcg-calculator-api-container-v1_10 .dcg-popover.dcg-right .dcg-arrow{top:50%;left:-10px;margin-top:-10px;border-width:10px 10px 10px 0;border-right-color:#fff}.dcg-calculator-api-container-v1_10 .dcg-popover.dcg-right .dcg-arrow:after{border-width:11px 11px 11px 0;border-right-color:#0003;bottom:-11px;left:-1px}.dcg-calculator-api-container-v1_10 .dcg-popover.dcg-bottom .dcg-arrow{top:-14px;margin-left:-14px;border-width:0 14px 14px;border-bottom-color:#fff}.dcg-calculator-api-container-v1_10 .dcg-popover.dcg-bottom .dcg-arrow:after{border-width:0 14px 14px;border-bottom-color:#0003;top:-1px;left:-14px}.dcg-calculator-api-container-v1_10 .dcg-popover.dcg-left .dcg-arrow{top:50%;right:-10px;margin-top:-10px;border-width:10px 0 10px 10px;border-left-color:#fff;border-top-color:transparent}.dcg-calculator-api-container-v1_10 .dcg-popover.dcg-left .dcg-arrow:after{border-width:11px 0 11px 11px;border-left-color:#0003;bottom:-11px;right:-1px}.dcg-calculator-api-container-v1_10 .dcg-constrained-height-popover{position:absolute;top:40px;bottom:2px;right:4px;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-constrained-height-popover .dcg-popover-interior{max-height:100%;pointer-events:auto}@keyframes dcg-pulse-cursor{0%{opacity:1}to{opacity:0;transform:scale(2)}}.dcg-calculator-api-container-v1_10 .dcg-geo-keyboard-cursor{position:absolute;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-geo-keyboard-cursor:before{content:"";position:absolute;width:20px;height:20px;margin-left:-12px;margin-top:-12px;border-radius:50%;border:2px solid gray;animation:dcg-pulse-cursor 2s infinite}.dcg-calculator-api-container-v1_10 .dcg-geo-keyboard-cursor:after{content:"";position:absolute;width:20px;height:20px;margin-left:-12px;margin-top:-12px;border-radius:50%;border:2px solid gray;animation:dcg-pulse-cursor 2s infinite;animation-delay:1s}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header{display:flex;align-items:center;padding:3px;position:relative}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-circular-icon{margin-right:8px;float:left}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-btn-light-gray{border-color:#bbb;padding:3px 5px;font-size:90%;margin-right:4px}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-btn-outline{display:inline-block;padding-left:10px;padding-right:10px;border:1px solid #666;color:#666;border-radius:5px;height:32px;line-height:30px;cursor:pointer}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-btn-outline.dcg-hovered:not(.dcg-disabled){color:#666;border:1px solid #666;box-shadow:0 0 0 1px #666}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-btn-outline.dcg-depressed:not(.dcg-disabled){border:1px solid #000;box-shadow:0 0 0 1px #000;color:#000}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-btn-outline[role=button].dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-navigate-back[role=button].dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-more-options[role=button].dcg-focus-visible{outline:none;box-shadow:0 0 0 2px #2f72dc80!important;border-radius:5px}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-construct-button{font-size:150%;color:#127a3d}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-construct-button .dcg-construct-button-icon{width:24px;height:24px}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-style-button .dcg-color-swatch{width:20px;height:20px;border-radius:4px}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-style-button .dcg-color-swatch.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-style-button .dcg-color-swatch.dcg-depressed{box-shadow:none}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-toolbar-dropdown-button{position:relative;height:48px;width:43px;border-style:solid;border-radius:0;outline:none;border-width:0 1px;border-bottom-width:.5px;border-color:transparent;margin-left:-1px;display:flex;align-items:center;justify-content:center}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-toolbar-dropdown-button.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-toolbar-dropdown-button.dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-toolbar-dropdown-button.dcg-menu-open{background:#fff;border-color:#0003}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-toolbar-dropdown-button.dcg-focus-visible{box-shadow:0 0 0 2px #2f72dc80!important}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-toolbar-dropdown-button.dcg-hovered .dcg-tool-dropdown,.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-toolbar-dropdown-button.dcg-depressed .dcg-tool-dropdown,.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-toolbar-dropdown-button.dcg-menu-open .dcg-tool-dropdown{display:block}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-toolbar-dropdown-button.dcg-hovered .dcg-tool-dropdown{color:#666}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-toolbar-dropdown-button.dcg-depressed .dcg-tool-dropdown{color:#6042a6cc}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-toolbar-dropdown-button.dcg-menu-open .dcg-tool-dropdown{color:#6042a6b3}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-toolbar-dropdown-button .dcg-tool-dropdown{position:absolute;bottom:0;left:0;right:0;color:#666;display:none;text-align:center;line-height:12px}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-toolbar-dropdown-button .dcg-tool-dropdown .dcg-dropdown-icon,.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-toolbar-dropdown-button .dcg-tool-dropdown i{display:inline-block;width:100%}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-toolbar-dropdown-button .dcg-tool-dropdown i{font-size:.65rem}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-toolbar-dropdown-button .dcg-tool-dropdown i.dcg-hovered{color:#6042a6cc}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-show-hide-btn{font-size:.8rem;text-align:center;overflow:hidden;margin-right:10px;height:28px;line-height:28px;border-radius:3px;padding:0 8px}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-show-hide-btn div{max-height:28px;margin-top:-1px;margin-bottom:1px;transition:transform .2s}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-show-hide-btn:not(.dcg-any-visible-objects) div{transform:translateY(-28px)}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-multi-select-icon-button{color:#666;font-size:22px;padding:5px}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-multi-select-icon-button.dcg-construct-button{margin:0;position:relative;top:2px;background:red}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-multi-select-icon-button.dcg-depressed{color:#222}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-label-button .dcg-label-button-icon{margin-left:3px;width:28px;height:18px;background-color:#666;border-radius:2px;-webkit-clip-path:path("M20.4932 1.02857C20.1982 0.642857 19.9032 0.385714 19.4608 0.257143C19.0183 0.128571 18.5758 0 18.1334 0H3.23729C2.49986 0 1.76243 0.257143 1.17248 0.771428C0.582539 1.28571 0.287567 1.92857 0.287567 2.57143V15.4286C0.287567 16.0714 0.582539 16.7143 1.17248 17.2286C1.76243 17.7429 2.49986 18 3.23729 18H17.9859C18.4284 18 19.0183 18 19.3133 17.7429C19.7557 17.4857 20.0507 17.2286 20.3457 16.9714L26.6876 9L20.3457 1.02857H20.4932Z");clip-path:path("M20.4932 1.02857C20.1982 0.642857 19.9032 0.385714 19.4608 0.257143C19.0183 0.128571 18.5758 0 18.1334 0H3.23729C2.49986 0 1.76243 0.257143 1.17248 0.771428C0.582539 1.28571 0.287567 1.92857 0.287567 2.57143V15.4286C0.287567 16.0714 0.582539 16.7143 1.17248 17.2286C1.76243 17.7429 2.49986 18 3.23729 18H17.9859C18.4284 18 19.0183 18 19.3133 17.7429C19.7557 17.4857 20.0507 17.2286 20.3457 16.9714L26.6876 9L20.3457 1.02857H20.4932Z");font-size:.7rem;line-height:18px;text-align:center;padding-right:5px;color:#fff;font-weight:700}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-options-menu-section .dcg-delete-btn{display:flex;align-items:center;font-size:.9rem}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-options-menu-section .dcg-delete-btn i{margin-right:8px;font-size:18px}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-options-menu-section .dcg-component-checkbox .dcg-checkbox-children{color:inherit!important}.dcg-calculator-api-container-v1_10 .dcg-multi-select-header .dcg-options-menu-section .dcg-component-checkbox.dcg-checked .dcg-checkbox i{color:#7c69b3}.dcg-calculator-api-container-v1_10 .dcg-multi-select-options-menu{left:-3px}.dcg-calculator-api-container-v1_10 .dcg-dot-dot-dropdown{position:relative;height:1em;width:1em;display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-options-menu-container{position:absolute;display:none;z-index:61;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-options-menu-container .dcg-options-menu{pointer-events:auto}.dcg-calculator-api-container-v1_10 .dcg-options-menu{padding:10px;position:relative;border:1px solid #d3d3d3;border-radius:7px;box-shadow:0 0 6px #0000001a;background:var(--dcg-custom-background-color, #fff)}.dcg-calculator-api-container-v1_10 .dcg-options-menu button.dcg-focus-visible{outline:none;box-shadow:0 0 0 2px #2f72dc80}.dcg-calculator-api-container-v1_10 .dcg-options-menu button.dcg-disabled,.dcg-calculator-api-container-v1_10 .dcg-options-menu button[aria-disabled=true]{cursor:unset}.dcg-calculator-api-container-v1_10 .dcg-options-menu .dcg-dividing-line-after{padding-bottom:10px;border-bottom:1px solid #e2e2e2;margin-bottom:10px}.dcg-calculator-api-container-v1_10 .dcg-options-menu .dcg-triangle{width:0;height:0;border-style:solid}.dcg-calculator-api-container-v1_10 .dcg-options-menu .dcg-triangle:before{content:"";width:0;height:0;border-style:solid}.dcg-calculator-api-container-v1_10 .dcg-options-menu .dcg-title{margin-bottom:5px;opacity:.65;font-weight:500}.dcg-calculator-api-container-v1_10 .dcg-options-menu .dcg-style-icons,.dcg-calculator-api-container-v1_10 .dcg-options-menu .dcg-component-checkbox{margin-top:5px}.dcg-calculator-api-container-v1_10 .dcg-options-menu .dcg-component-checkbox .dcg-checkbox-children{font-size:90%;color:var(--dcg-custom-text-color, #333)}.dcg-calculator-api-container-v1_10 .dcg-options-menu .dcg-style-icon-container{display:inline-block;width:29px;height:29px;border-radius:50%}.dcg-calculator-api-container-v1_10 .dcg-options-menu .dcg-style-icon-container:not(:last-of-type){margin-right:4px}.dcg-calculator-api-container-v1_10 .dcg-options-menu .dcg-style-icon-container.dcg-disabled{cursor:default!important}.dcg-calculator-api-container-v1_10 .dcg-options-menu .dcg-style-icon-container:not(.dcg-disabled).dcg-hovered:not(.dcg-disabled){box-shadow:0 0 0 2px #0000001a}.dcg-calculator-api-container-v1_10 .dcg-options-menu .dcg-style-icon-container:not(.dcg-disabled).dcg-depressed:not(.dcg-disabled){box-shadow:0 0 0 2px #0003}.dcg-calculator-api-container-v1_10 .dcg-options-menu textarea{width:100%;height:3em;border:1px solid rgba(0,0,0,.2);border-radius:4px;font:inherit;font-size:90%;padding:5px;margin-top:5px;outline:none;position:relative;top:3px;color:var(--dcg-custom-text-color, #000);background:var(--dcg-custom-background-color-shaded, #fff)}.dcg-calculator-api-container-v1_10 .dcg-options-menu textarea.dcg-hovered{border:1px solid #bbb;box-shadow:0 0 0 1px #bbb}.dcg-calculator-api-container-v1_10 .dcg-options-menu textarea:focus{border:1px solid #2f72dc;box-shadow:0 0 0 1px #2f72dc}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-triangle,.dcg-calculator-api-container-v1_10 .dcg-slider-options-view .dcg-triangle,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-triangle,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-triangle{position:absolute;top:12px;left:-9px;border-width:9px 9px 9px 0;border-color:transparent #d3d3d3 transparent transparent}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu .dcg-triangle:before,.dcg-calculator-api-container-v1_10 .dcg-slider-options-view .dcg-triangle:before,.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-triangle:before,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-triangle:before{position:absolute;top:-8px;left:1px;border-width:8px 8px 8px 0;border-color:transparent var(--dcg-custom-background-color, #fff) transparent transparent}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu,.dcg-calculator-api-container-v1_10 .dcg-slider-options-view,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu{left:38px}.dcg-calculator-api-container-v1_10 .dcg-expressions-options-menu,.dcg-calculator-api-container-v1_10 .dcg-slider-options-view{top:-7px}.dcg-calculator-api-container-v1_10 .dcg-image-options-menu{min-width:185px;top:-10px}.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-triangle{position:absolute;top:15px;left:-9px}.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-triangle{position:absolute;top:-9px;left:14px}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools{display:flex;align-items:center;justify-content:space-between;padding:3px}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-getting-started-pointer{position:absolute;top:70px;left:50%;transform:translate(-50%);min-height:50px;color:#949494;font-size:1.1rem;padding-top:12px;pointer-events:none;animation:dcg-fadeIn .3s;white-space:nowrap}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-getting-started-pointer .dcg-curved-icon-container{display:inline-block;font-size:2rem;transform:scaleY(-1) rotate(15deg)}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-getting-started-pointer.dcg-geo-getting-started-has-tool .dcg-curved-icon-container{transform:rotate(15deg);position:relative;top:7px}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-basic-tools-row{display:flex;align-items:center;justify-content:center;position:relative}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-basic-tools-row button{font-size:.9rem;padding:0;background:none}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-basic-tools-row button canvas{margin-left:-4px;margin-right:-4px}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-basic-tools-row button:not(.dcg-dropdown-tool):not([dcg-geo-tool=point]):not([dcg-geo-tool=selection]) canvas{position:relative;top:-1px;transform:scale(.9)}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-basic-tools-row .dcg-icon{position:relative;top:-1px;display:inline-flex;width:42px}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-basic-tools-row .dcg-tool-name{position:absolute;top:100%;left:0;right:0;text-align:center;font-size:1rem;color:#666;font-family:Arial,Helvetica,sans-serif;line-height:1em}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-basic-tools-row .dcg-tool-button-container{height:48px}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-basic-tools-row .dcg-tool-button-container>button{height:48px;border-style:solid;border-radius:0;outline:none;border-width:0 1px;border-bottom-width:.5px;border-color:transparent;margin-left:-1px}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-basic-tools-row .dcg-tool-button-container>button.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-basic-tools-row .dcg-tool-button-container>button.dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-basic-tools-row .dcg-tool-button-container>button.dcg-selected{background:#fff}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-basic-tools-row .dcg-tool-button-container>button.dcg-hovered:not(.dcg-disabled):not(.dcg-selected){border-color:#0003}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-basic-tools-row .dcg-tool-button-container>button.dcg-focus-visible{box-shadow:0 0 0 2px #2f72dc80!important}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-basic-tools-row .dcg-tool-button-container>button.dcg-selected{border-color:#0003}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-basic-tools-row .dcg-tool-button-container>button.dcg-disabled{opacity:.25}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-basic-tools-row .dcg-tool-button-container>button.dcg-will-be-hidden-or-disabled{border-style:dashed;opacity:.9;border-color:#e2e2e2}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-basic-tools-row .dcg-tool-button-container>button.dcg-will-be-hidden-or-disabled.dcg-selected{border-style:solid;border:1px solid #949494;box-shadow:0 0 0 1px #949494}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-geo-basic-tools-row canvas{width:50px;height:50px}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-split-btn{position:relative}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-split-btn.dcg-hovered .dcg-tool-dropdown,.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-split-btn.dcg-depressed .dcg-tool-dropdown,.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-split-btn.dcg-focus-visible .dcg-tool-dropdown,.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-split-btn.dcg-selected .dcg-tool-dropdown{display:block}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-split-btn.dcg-menu-open .dcg-tool-dropdown,.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-split-btn.dcg-selected.dcg-hovered .dcg-tool-dropdown{color:#6042a6b3}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-split-btn .dcg-tool-dropdown{position:absolute;bottom:0;left:0;right:0;color:#666;display:none;text-align:center;height:12px;line-height:12px}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-split-btn .dcg-tool-dropdown .dcg-dropdown-icon,.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-split-btn .dcg-tool-dropdown i{display:inline-block;width:100%}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-split-btn .dcg-tool-dropdown i{font-size:.65rem}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-split-btn .dcg-tool-dropdown i.dcg-hovered{color:#6042a6cc}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-split-btn .dcg-tool-dropdown.dcg-hovered{color:#666}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-split-btn .dcg-tool-dropdown.dcg-depressed i{color:#6042a6cc}.dcg-calculator-api-container-v1_10 .dcg-geo-basic-tools .dcg-mobile-construct-button{padding:10px 12px;text-align:center;float:left}.dcg-calculator-api-container-v1_10 .dcg-options-menu-section-container{display:flex;flex-direction:row}.dcg-calculator-api-container-v1_10 .dcg-options-menu-section-container .dcg-options-menu-section{flex:1 1 100%}.dcg-calculator-api-container-v1_10 .dcg-options-menu-section-container .dcg-options-menu-section+.dcg-options-menu-section{border-left:1px solid rgba(0,0,0,.2)}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown{background:#fff;padding:0!important;position:absolute!important;top:47.5px;border-top-left-radius:0;border-top-right-radius:0;overflow:hidden}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown button.dcg-dropdown-tool{width:100%;display:flex;align-items:center;height:36px;line-height:36px;outline:none;overflow-y:clip;padding-right:15px;min-width:130px}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown button.dcg-dropdown-tool canvas{transform:scale(.75);margin-right:-3px}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown button.dcg-dropdown-tool span{white-space:nowrap;font-size:.9rem}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown button.dcg-dropdown-tool.dcg-focus-visible:not([aria-disabled=true]),.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown button.dcg-dropdown-tool.dcg-hovered:not([aria-disabled=true]){background:#0000001a}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown button.dcg-dropdown-tool.dcg-depressed:not([aria-disabled=true]){background:#0003}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown button.dcg-dropdown-tool.dcg-selected-tool:not([aria-disabled=true]){background:#6042a626}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown button.dcg-dropdown-tool.dcg-hovered:not(.dcg-focus-visible){box-shadow:none}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown button.dcg-dropdown-tool[aria-disabled=true] span,.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown button.dcg-dropdown-tool.dcg-will-be-hidden-or-disabled span{color:#bbb;font-style:italic}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown button.dcg-dropdown-tool.dcg-transformation-tool i{font-size:32px;margin:5px 0;padding:8.75px 6px;position:relative;color:#00000078}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown button.dcg-dropdown-tool.dcg-transformation-tool i.dcg-icon-rotation:after,.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown button.dcg-dropdown-tool.dcg-transformation-tool i.dcg-icon-dilation:after{position:absolute;top:50%;left:50%;width:4px;height:4px;background:#7d69b3;margin-left:-2px;margin-top:-2px;border-radius:50%;content:""}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown button.dcg-dropdown-tool.dcg-transformation-tool i.dcg-icon-vector{transform:rotate(-45deg)}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown button.dcg-dropdown-tool.dcg-transformation-tool i.dcg-icon-reflection:after{position:absolute;top:13px;bottom:14px;left:50%;border-right:1px dashed rgba(47,114,220,.8);content:"";margin-left:-1px}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown button.dcg-dropdown-tool.dcg-transformation-tool i.dcg-icon-reflection:before{z-index:1;position:relative}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown button.dcg-dropdown-tool.dcg-transformation-tool.dcg-hovered i{color:#666}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown button.dcg-dropdown-tool.dcg-transformation-tool.dcg-depressed i{color:#454545}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown .dcg-existing-transformations-container{border-top:1px solid rgba(0,0,0,.2);min-width:200px;max-height:200px;overflow-y:auto;padding:10px 15px 5px 12px;margin:0 -1px;font-size:.9rem}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown .dcg-existing-transformations-container .dcg-geo-token-view{transform:scale(.8);margin:-2px}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown .dcg-transformation-header{margin-bottom:5px}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown .dcg-existing-transformation{padding:2.5px 0;opacity:.8;color:#666;text-align:left}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown .dcg-existing-transformation.dcg-hovered{opacity:1;color:#444}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown .dcg-existing-transformation.dcg-depressed{opacity:1;color:#000}.dcg-calculator-api-container-v1_10 .dcg-select-tools-dropdown .dcg-existing-transformation>div{pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-multi-select-label-menu{background:#fff;position:absolute!important;top:47.5px;border-top-left-radius:0;border-top-right-radius:0;padding-top:0}.dcg-calculator-api-container-v1_10 .dcg-multi-select-label-menu .dcg-label-container{min-height:1.8em;font-size:.9rem}.dcg-calculator-api-container-v1_10 .dcg-multi-select-label-menu .dcg-label-container input{width:100%}.dcg-calculator-api-container-v1_10 .dcg-multi-select-label-menu .dcg-label-container input:focus:not([disabled]){border-color:#7c69b3!important;box-shadow:0 1px #7c69b3!important}.dcg-calculator-api-container-v1_10 .dcg-multi-select-label-menu .dcg-segmented-control-container{margin-top:10px;font-size:.9rem}.dcg-calculator-api-container-v1_10 .dcg-multi-select-label-menu .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-theme-default{border-color:#d4d4d4}.dcg-calculator-api-container-v1_10 .dcg-multi-select-label-menu .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-theme-default.dcg-selected{border-color:#7c69b3;background-color:#7c69b3}.dcg-calculator-api-container-v1_10 .dcg-multi-select-label-menu .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-theme-default.dcg-hovered:not(.dcg-selected){border-color:#7c69b3}.dcg-calculator-api-container-v1_10 .dcg-multi-select-label-menu .dcg-segmented-control-container .dcg-segmented-control-btn.dcg-theme-default.dcg-depressed:not(.dcg-selected){border-color:#7c69b3;background-color:#ece8f4}.dcg-calculator-api-container-v1_10 .dcg-multi-select-label-menu .dcg-segmented-control-container .dcg-segmented-control-container--point:not(.dcg-selected) .dcg-segmented-control-interior:before{color:#7c69b3}.dcg-calculator-api-container-v1_10 .dcg-multi-select-label-menu .dcg-segmented-control-container .dcg-segmented-control-container--point .dcg-segmented-control-interior:before{content:"\\2022";padding-right:5px;vertical-align:bottom;font-size:2.5rem}.dcg-calculator-api-container-v1_10 .dcg-multi-select-label-menu .dcg-multi-select-menu_margin-top-section{margin-top:10px}.dcg-calculator-api-container-v1_10 .dcg-multi-select-label-menu .dcg-component-checkbox{margin-top:8px;font-size:1.1rem}.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu.dcg-multi-select-options-menu{background:#fff;position:absolute!important;top:47.5px;border-top-left-radius:0;border-top-right-radius:0;width:220px}.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu.dcg-multi-select-options-menu .dcg-options-menu-section{padding:0}.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu.dcg-multi-select-options-menu .dcg-options-menu-section>*{margin-bottom:10px;padding:0 10px}.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu.dcg-multi-select-options-menu .dcg-options-menu-section>*:not(:first-of-type){padding-top:10px}.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu.dcg-multi-select-options-menu .dcg-options-menu-section>*:last-of-type,.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu.dcg-multi-select-options-menu .dcg-options-menu-section>*.dcg-move-to-expression-list{margin-bottom:0}.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu.dcg-multi-select-options-menu .dcg-checkbox-section:not(:only-child){border-top:1px solid rgba(0,0,0,.2)}.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu.dcg-multi-select-options-menu .dcg-checkbox-section .dcg-component-checkbox{margin-top:0}.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu.dcg-multi-select-options-menu .dcg-delete-btn{justify-content:center;width:calc(100% - 20px);margin-left:10px}.dcg-calculator-api-container-v1_10 .dcg-generic-options-menu.dcg-multi-select-options-menu .dcg-delete-btn span{overflow:hidden;text-overflow:ellipsis}.dcg-calculator-api-container-v1_10 .dcg-move-to-expression-list{border-top:1px solid rgba(0,0,0,.2);padding-top:10px}.dcg-calculator-api-container-v1_10 .dcg-move-to-expression-list .dcg-move-to-expression-list-title{display:flex;align-items:center;font-size:90%}.dcg-calculator-api-container-v1_10 .dcg-move-to-expression-list .dcg-move-to-expression-list-title:not([role=button]){cursor:default;margin-bottom:10px}.dcg-calculator-api-container-v1_10 .dcg-move-to-expression-list .dcg-move-to-expression-list-title[role=button].dcg-hovered span{text-decoration:underline}.dcg-calculator-api-container-v1_10 .dcg-move-to-expression-list .dcg-move-to-expression-list-flex{display:flex}.dcg-calculator-api-container-v1_10 .dcg-move-to-expression-list .dcg-btn-purple{margin-left:5px;padding:0 8px;font-size:90%;height:30px;line-height:28px}.dcg-calculator-api-container-v1_10 .dcg-move-to-expression-list .dcg-btn-purple.dcg-disabled{pointer-events:none;opacity:.5}.dcg-calculator-api-container-v1_10 .dcg-move-to-expression-list input{padding:0 5px;border:1px solid rgba(0,0,0,.2);outline:none;border-radius:4px;width:100%;font-size:90%}.dcg-calculator-api-container-v1_10 .dcg-move-to-expression-list input.dcg-hovered{border:1px solid rgba(0,0,0,.2);box-shadow:0 0 0 1px #0003}.dcg-calculator-api-container-v1_10 .dcg-move-to-expression-list input:focus{border:1px solid #7c69b3;box-shadow:0 0 0 1px #7c69b3}.dcg-calculator-api-container-v1_10 .dcg-move-to-expression-list .dcg-icon-insert{margin-right:8px;font-size:18px;color:#626262}.dcg-calculator-api-container-v1_10 .dcg-multi-select-style-menu{background:#fff;position:absolute!important;top:47.5px;border-top-left-radius:0;border-top-right-radius:0}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem{display:block;position:relative;margin-top:-1px;border-top:1px solid rgba(206,206,206,.8);border-bottom:1px solid transparent;font-size:100%;border-right:1px solid transparent}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem:not(.dcg-expressionimage){cursor:text}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem .dcg-fade-container{width:100%}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem.dcg-selected,.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem.dcg-dragging{border-color:#6a93d2;border-width:2px 0;border-right:1px solid #6a93d2}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem.dcg-selected .dcg-fade-container,.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem.dcg-dragging .dcg-fade-container{margin-top:-1px;margin-bottom:-1px}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem.dcg-selected .dcg-tab,.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem.dcg-dragging .dcg-tab{color:var(--dcg-custom-text-color, #fff);border-right:1px solid transparent;background:#6a93d2}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem .dcg-expression-bottom.dcg-fadein-bottom{position:relative;animation:dcg-fadeIn .8s;cursor:default;z-index:1}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem .dcg-extend-to-3d-checkbox{margin:2px 0 4px;font-size:.9rem;color:#666}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem .dcg-indent-in-folder{margin-left:53px}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem.dcg-inFolder .dcg-fade-container:after{position:absolute;top:5px;bottom:5px;left:56px;content:"";border-left:1px solid rgba(0,0,0,.2);animation:dcg-fadeIn .3s}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem.dcg-inFolder .dcg-main{margin-left:20px}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem.dcg-inFolder .dcg-indent-in-folder{margin-left:73px}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem.dcg-shell{height:54px;background:#fff}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem .dcg-fade-container{position:relative;padding-bottom:6px}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem .dcg-fade-container .dcg-main{position:relative;padding:15px 35px 9px 53px;white-space:nowrap;font-size:110%;vertical-align:middle}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem .dcg-fade-container .dcg-main .dcg-mq-container,.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem .dcg-fade-container .dcg-main .dcg-math-field{width:100%}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem .dcg-fade-container .dcg-expression-warning{font-size:80%;color:#666;padding-right:8px}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem .dcg-fade-container .dcg-expression-warning .dcg-icon-error{font-size:85%;padding-right:4px}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem .dcg-fade-container .dcg-expression-warning a{color:#666;margin-left:5px;text-decoration:underline}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem .dcg-fade-container .dcg-expression-warning a.dcg-hovered{color:#000}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem .dcg-fade-container .dcg-expression-warning .dcg-btn{padding:2px 5px;margin-top:4px}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem .dcg-tab{display:block;position:absolute;top:0;left:0;bottom:0;padding:1px 2px;font-size:65%;text-align:left;color:var(--dcg-custom-text-color, rgba(0, 0, 0, .5));background:var(--dcg-custom-background-color-shaded, #eee);border-right:1px solid rgba(0,0,0,.06);cursor:move;width:38px;touch-action:none}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionitem.dcg-readonly .dcg-tab{cursor:default}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontext .dcg-icon-text{position:absolute;top:50%;left:50%;margin:-7px 0 0 -7px;font-size:140%;opacity:.25}.dcg-calculator-api-container-v1_10 .dcg-expressiontable{cursor:default}.dcg-calculator-api-container-v1_10 .dcg-expressiontable .dcg-fade-container.dcg-hovered{box-shadow:none}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-readonly{background:var(--dcg-custom-background-color-shaded, #eee)}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-readonly .dcg-parameter-suggestion-container{pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-readonly .dcg-lock-indicator{opacity:1;color:#bbb;text-shadow:-1px -1px 0 #eee,-1px 1px 0 #eee,1px -1px 0 #eee,1px 1px 0 #eee,0 -1px 0 #eee,0 1px 0 #eee,1px 0 0 #eee,-1px 0 0 #eee;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-readonly .dcg-mathquill-wrapper{pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-readonly .dcg-mathquill-wrapper .dcg-tooltip-hit-area-container{pointer-events:auto}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-readonly .dcg-mathquill-wrapper .dcg-tooltip-hit-area-container .dcg-braille-input{pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-readonly .dcg-tabledata .dcg-row .dcg-cell,.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-readonly .dcg-fade-container{cursor:default}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-readonly .dcg-fade-container .dcg-main .dcg-table-container:before,.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-readonly .dcg-fade-container .dcg-main .dcg-tabledata:before{background:transparent}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-readonly .dcg-fade-container .dcg-main .dcg-table-container:after,.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-readonly .dcg-fade-container .dcg-main .dcg-tabledata:after{background:transparent}.dcg-calculator-api-container-v1_10 .dcg-exppanel:not(.dcg-edit-list-mode) .dcg-expressionitem.dcg-readonly{cursor:default}.dcg-calculator-api-container-v1_10 .dcg-exppanel:not(.dcg-edit-list-mode) .dcg-expressionitem.dcg-readonly .dcg-edit-list-mathquill,.dcg-calculator-api-container-v1_10 .dcg-exppanel:not(.dcg-edit-list-mode) .dcg-expressionitem.dcg-readonly .dcg-main{cursor:default}.dcg-calculator-api-container-v1_10 .dcg-exppanel:not(.dcg-edit-list-mode) .dcg-expressionitem.dcg-readonly .dcg-evaluation{z-index:1}.dcg-calculator-api-container-v1_10 .dcg-exppanel:not(.dcg-edit-list-mode) .dcg-expressionitem.dcg-readonly:after{content:"";position:absolute;top:0;right:0;bottom:0;width:18px;background:linear-gradient(to right,rgba(238,238,238,0),var(--dcg-custom-background-color-shaded, #eee) 40%)}.dcg-calculator-api-container-v1_10 .dcg-exppanel:not(.dcg-edit-list-mode) .dcg-expressionitem.dcg-readonly:before{content:"";position:absolute;top:0;left:38px;bottom:0;width:18px;background:linear-gradient(to left,rgba(238,238,238,0),var(--dcg-custom-background-color-shaded, #eee) 40%);z-index:1}.dcg-calculator-api-container-v1_10 .dcg-exppanel:not(.dcg-edit-list-mode) .dcg-expressionitem.dcg-readonly .dcg-main{overflow-x:auto}.dcg-calculator-api-container-v1_10 .dcg-exppanel:not(.dcg-edit-list-mode) .dcg-expressionitem.dcg-readonly .dcg-main .dcg-table-container{overflow:visible}.dcg-calculator-api-container-v1_10 .dcg-exppanel:not(.dcg-edit-list-mode) .dcg-expressionitem.dcg-readonly .dcg-edit-list-mathquill .dcg-static-mathquill-view{padding-right:20px}.dcg-calculator-api-container-v1_10 .dcg-exppanel:not(.dcg-edit-list-mode) .dcg-mathquill-braille-overflow-right .dcg-tooltip-hit-area-container:after{display:none}.dcg-calculator-api-container-v1_10 .dcg-expressionitem:not(.dcg-mathitem).dcg-selected .dcg-top-level-delete{padding-bottom:0;padding-left:0}.dcg-calculator-api-container-v1_10 .dcg-EDIT-LIST-MODE .dcg-exppanel .dcg-top-level-delete,.dcg-calculator-api-container-v1_10 .dcg-EDIT-LIST-MODE .dcg-exppanel .dcg-lock-indicator{display:none}.dcg-calculator-api-container-v1_10 .dcg-EDIT-LIST-MODE .dcg-exppanel .dcg-expressionitem.dcg-expressiontext .dcg-displayTextarea,.dcg-calculator-api-container-v1_10 .dcg-EDIT-LIST-MODE .dcg-exppanel .dcg-expressionitem.dcg-expressionfolder .dcg-displayTextarea{pointer-events:none;opacity:0}.dcg-calculator-api-container-v1_10 .dcg-EDIT-LIST-MODE .dcg-exppanel .dcg-expressionitem.dcg-expressiontext textarea,.dcg-calculator-api-container-v1_10 .dcg-EDIT-LIST-MODE .dcg-exppanel .dcg-expressionitem.dcg-expressionfolder textarea{opacity:1}.dcg-calculator-api-container-v1_10 .dcg-drag-container{position:absolute;top:0;left:0;right:0;z-index:1000}.dcg-calculator-api-container-v1_10 .dcg-drag-container .dcg-expressionitem{background:var(--dcg-custom-background-color, #fff);overflow:hidden;box-shadow:0 0 10px #888;border-color:#6a93d2;border-right:1px solid #6a93d2}.dcg-calculator-api-container-v1_10 .dcg-drag-container .dcg-expressionitem .dcg-indent-in-folder,.dcg-calculator-api-container-v1_10 .dcg-drag-container .dcg-expressionitem .dcg-fade-container:after,.dcg-calculator-api-container-v1_10 .dcg-drag-container .dcg-expressionitem .dcg-main{transition:.3s}.dcg-calculator-api-container-v1_10 .dcg-drag-container .dcg-expressionitem .dcg-tab{background:#6a93d2}.dcg-calculator-api-container-v1_10 .dcg-drag-container .dcg-expressionitem .dcg-num{display:none}.dcg-calculator-api-container-v1_10 .dcg-template-expressioneach .dcg-expressionitem.dcg-dragging{visibility:hidden}.dcg-calculator-api-container-v1_10 .dcg-exppanel.dcg-isDragging .dcg-expressionitem.dcg-new-expression{opacity:0}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-mq-editable-field{border:none;box-shadow:none!important}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-mq-editable-field textarea{resize:none}.dcg-calculator-api-container-v1_10 .dcg-tap-container .dcg-mq-math-mode .dcg-mq-supsub{margin-bottom:-.2em}.dcg-calculator-api-container-v1_10 .dcg-tap-container .dcg-mq-math-mode .dcg-mq-sub{font-size:80%}.dcg-calculator-api-container-v1_10 .dcg-tap-container .dcg-mq-math-mode .dcg-mq-int>.dcg-mq-supsub>.dcg-mq-sub{font-size:100%}.dcg-calculator-api-container-v1_10 .dcg-clear{clear:both}.dcg-calculator-api-container-v1_10 .dcg-has-background-color .dcg-expressionitem{border-top-color:#0003}.dcg-calculator-api-container-v1_10 .dcg-expression-icon-container{position:absolute;top:28px;left:50%;height:29px;width:29px;margin-top:-14.5px;margin-left:-14.5px;text-align:center;line-height:29px;border-radius:50%}.dcg-calculator-api-container-v1_10 .dcg-selected .dcg-expression-icon-container{top:27px}.dcg-calculator-api-container-v1_10 .dcg-mouse-over-closed-poi,.dcg-calculator-api-container-v1_10 .dcg-mouse-over-opened-poi,.dcg-calculator-api-container-v1_10 .dcg-mouse-over-interactive-label,.dcg-calculator-api-container-v1_10 .dcg-mouse-over-clickable-object{cursor:pointer}.dcg-calculator-api-container-v1_10 .dcg-mouse-over-movable-point{cursor:move}.dcg-calculator-api-container-v1_10 .dcg-mouse-over-movable-point-ew{cursor:ew-resize}.dcg-calculator-api-container-v1_10 .dcg-mouse-over-movable-point-ns{cursor:ns-resize}.dcg-calculator-api-container-v1_10 .dcg-mouse-over-closed-poi .dcg-tracept{display:none}.dcg-calculator-api-container-v1_10 .dcg-poi-label.dcg-show-border .dcg-label{border:1px solid #e2e2e2;background:#fff;border-radius:5px;box-shadow:0 0 5px #0003;padding:7px 4px 5px;display:flex;align-items:center}.dcg-calculator-api-container-v1_10 .dcg-poi-label.dcg-editable-label .dcg-math-field{padding:3px 10px}.dcg-calculator-api-container-v1_10 .dcg-poi-label.dcg-editable-label .dcg-resizing-text-input-container input,.dcg-calculator-api-container-v1_10 .dcg-poi-label.dcg-editable-label .dcg-text-input-content{padding:5px 10px}.dcg-calculator-api-container-v1_10 .dcg-poi-label.dcg-editable-label .dcg-editable-label-border{background:#ffffffbf;border-radius:4px;border-width:1px;border-style:solid;padding:1px}.dcg-calculator-api-container-v1_10 .dcg-poi-label.dcg-editable-label .dcg-editable-label-border:not(.dcg-focus):not(.dcg-hovered){border-color:#bbb!important}.dcg-calculator-api-container-v1_10 .dcg-poi-label.dcg-editable-label .dcg-editable-label-border.dcg-empty-label:not(.dcg-focus):not(.dcg-hovered){border-color:#949494!important}.dcg-calculator-api-container-v1_10 .dcg-poi-label.dcg-editable-label .dcg-editable-label-border.dcg-empty-label,.dcg-calculator-api-container-v1_10 .dcg-poi-label.dcg-editable-label .dcg-editable-label-border.dcg-focus{background:#fff}.dcg-calculator-api-container-v1_10 .dcg-poi-label.dcg-editable-label .dcg-editable-label-border.dcg-hovered:not(.dcg-focus){border-style:solid;padding:0;border-width:2px}.dcg-calculator-api-container-v1_10 .dcg-poi-label.dcg-editable-label .dcg-editable-label-border.dcg-focus{padding:0;border-width:2px}.dcg-calculator-api-container-v1_10 .dcg-poi-label .dcg-static-mathquill-view *{-webkit-user-select:none!important;user-select:none!important}.dcg-calculator-api-container-v1_10 .dcg-poi-label{display:inline-block;position:absolute;top:0;left:0;font-size:100%;color:#222}.dcg-calculator-api-container-v1_10 .dcg-poi-label .dcg-pt{display:inline-block;position:absolute;top:-4px;left:-4px;border:4px solid #000;border-radius:4px;width:0;height:0;z-index:0}.dcg-calculator-api-container-v1_10 .dcg-poi-label .dcg-label{position:absolute;z-index:3;white-space:nowrap}.dcg-calculator-api-container-v1_10 .dcg-poi-label .dcg-label .dcg-mq-sqrt-prefix{text-shadow:none}.dcg-calculator-api-container-v1_10 .dcg-poi-label .dcg-label-raw-text{pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-poi-label.dcg-has-outline .dcg-label{text-shadow:-1px -1px 0 #fff,-1px 1px 0 #fff,1px -1px 0 #fff,1px 1px 0 #fff,0 -1px 0 #fff,0 1px 0 #fff,1px 0 0 #fff,-1px 0 0 #fff}.dcg-calculator-api-container-v1_10 .dcg-poi-label:not(.dcg-tracept) .dcg-pt{border-width:5px;border-color:transparent!important;border-radius:5px;opacity:1;top:-5px!important;left:-5px!important;cursor:pointer}.dcg-calculator-api-container-v1_10 .dcg-poi-label:not(.dcg-tracept).dcg-opened .dcg-pt{border-color:#000!important}.dcg-calculator-api-container-v1_10 .dcg-poi-label.dcg-hole .dcg-pt{top:-5px;left:-5px;border-width:2px;padding:3px;background:#fff!important;border-radius:6px}.dcg-calculator-api-container-v1_10 .dcg-poi-label.dcg-hide-dot .dcg-pt{display:none}.dcg-calculator-api-container-v1_10 .dcg-resizing-text-input-container{position:relative;overflow:hidden}.dcg-calculator-api-container-v1_10 .dcg-resizing-text-input-container input{position:absolute;top:1px;left:1px;right:1px;font:inherit;border:0;outline:0;background:transparent;color:inherit}.dcg-calculator-api-container-v1_10 .dcg-resizing-text-input-container:not(.dcg-focus) input::selection{background:transparent}.dcg-calculator-api-container-v1_10 .dcg-resizing-text-input-container.dcg-focus input,.dcg-calculator-api-container-v1_10 .dcg-resizing-text-input-container.dcg-hovered input{position:absolute;top:0;left:0}.dcg-calculator-api-container-v1_10 .dcg-resizing-text-input-container .dcg-text-input-content{min-width:35px;display:inline-block;color:transparent;white-space:pre}.dcg-calculator-api-container-v1_10 .dcg-poi-copy-button{padding:5px 5px 5px 3px;margin:-5px -3px -5px -1px;opacity:.4;line-height:0}.dcg-calculator-api-container-v1_10 .dcg-poi-copy-button.dcg-hovered{opacity:.7}.dcg-calculator-api-container-v1_10 .dcg-poi-copy-button.dcg-depressed{opacity:1}.dcg-calculator-api-container-v1_10 .dcg-3d-debug-root{position:fixed;bottom:0;right:0;z-index:1000;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-3d-debug-root .dcg-3d-debug-container{display:inline-block;position:relative;background-color:green;image-rendering:pixelated}.dcg-calculator-api-container-v1_10 .dcg-3d-debug-root .dcg-3d-debug-container:before{content:attr(dcg-label);position:absolute;top:0;left:0}.dcg-calculator-api-container-v1_10 .dcg-3d-debug-root .dcg-3d-debug-container canvas{border:1px solid red;width:100%;height:100%;transform:scaleY(-1)}.dcg-calculator-api-container-v1_10 .dcg-overgraph-icon-container{z-index:40}.dcg-calculator-api-container-v1_10 .dcg-overgraph-icon-container:not(.dcg-bottom-right){position:absolute;top:5px;left:5px}.dcg-calculator-api-container-v1_10 .dcg-overgraph-icon-container.dcg-bottom-right{position:absolute;bottom:5px;right:5px}.dcg-calculator-api-container-v1_10 .dcg-overgraph-icon{width:37px;height:37px;line-height:40px;font-size:110%;text-shadow:-2px -2px 0 #fff,-2px 2px 0 #fff,2px -2px 0 #fff,2px 2px 0 #fff,0 -2px 0 #fff,0 2px 0 #fff,2px 0 0 #fff,-2px 0 0 #fff;text-align:center;border-radius:5px}.dcg-calculator-api-container-v1_10 .dcg-overgraph-icon.dcg-rotated{transform:rotate(-90deg)}.dcg-calculator-api-container-v1_10 .dcg-overgraph-icon i{opacity:.6}.dcg-calculator-api-container-v1_10 .dcg-overgraph-icon.dcg-hovered{background:#0000001a;text-shadow:none}.dcg-calculator-api-container-v1_10 .dcg-overgraph-icon.dcg-hovered i{opacity:.8}.dcg-calculator-api-container-v1_10 .dcg-overgraph-icon.dcg-depressed{background:#0003;text-shadow:none}.dcg-calculator-api-container-v1_10 .dcg-overgraph-icon.dcg-depressed i{opacity:1}@keyframes dcg-fadeIn-show-keypad{0%{transform:translateY(10px);opacity:0}50%{transform:translateY(10px);opacity:0}to{transform:translate(0);opacity:1}}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-keys-container{position:absolute;bottom:0;z-index:60;width:100%;margin:0 auto;padding:0;transition:opacity .3s}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover{position:absolute;right:8px}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-minimize-keypad .dcg-icon-keyboard,.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-show-keypad .dcg-icon-keyboard{font-size:175%;float:left;margin-right:8px}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-minimize-keypad .dcg-icon-caret-down,.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-minimize-keypad .dcg-icon-caret-up,.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-show-keypad .dcg-icon-caret-down,.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-show-keypad .dcg-icon-caret-up{font-size:75%;line-height:2rem}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-minimize-keypad-container{position:absolute;top:-2.5rem;left:-1px}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-show-keypad-container{z-index:60;position:absolute;bottom:5px;left:5px;animation:dcg-fadeIn-show-keypad .6s}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-minimize-keypad{padding:.25rem 1.25rem;border-top-left-radius:5px;border-top-right-radius:5px}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-show-keypad{padding:4px 14px}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-keys{position:relative;width:100%;max-width:835px;margin:auto;text-align:center}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-keys{font-size:110%}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-keys-background{background:var(--dcg-custom-background-color-shaded, #f0f0f0);border-top:1px solid rgba(0,0,0,.1);box-shadow:0 -1px 3px #0000001a}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-keys-background .dcg-minimize-keypad{background:var(--dcg-custom-background-color-shaded, #f0f0f0);color:var(--dcg-custom-text-color, rgba(0, 0, 0, .7));border:1px solid rgba(0,0,0,.1);border-bottom:1px solid var(--dcg-custom-background-color-shaded, #f0f0f0);box-shadow:0 -1px 3px #0000001a}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-keys-background .dcg-minimize-keypad.dcg-hovered{color:var(--dcg-custom-text-color, rgba(0, 0, 0, .9))}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-keys-background .dcg-minimize-keypad.dcg-depressed{color:var(--dcg-custom-text-color, #000)}.dcg-calculator-api-container-v1_10 .dcg-narrow .dcg-keypad .dcg-functions-popover:not(.dcg-left){position:absolute;margin-left:-70px}.dcg-calculator-api-container-v1_10 .dcg-narrow .dcg-keypad .dcg-functions-popover.dcg-left{right:18%}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-audio-keypad-container{display:flex}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-audio-keypad-column{display:flex;flex:1;flex-direction:column}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-audio-keypad-column .dcg-keypad-btn-container{max-height:40px}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-audio-keypad-column .dcg-keypad-btn-container .dcg-keypad-btn:not(.dcg-btn-short-blue){color:#333}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-playback-column .dcg-btn-playback{height:40px}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-playback-column .dcg-btn-playback .dcg-keypad-btn-container{width:100%}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-playback-column .dcg-key-nav-section-container{height:40px}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-playback-column .dcg-key-nav-section-container .dcg-tooltip-hit-area-container{width:100%}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-playback-column .dcg-key-nav-section-container .dcg-key-nav-section-title-container.dcg-disabled{opacity:.5}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-key-section-title{text-align:left;color:#666;line-height:40px;font-size:90%}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-key-section-title .dcg-tooltip-hit-area-container{margin-left:3px}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-key-section-title .dcg-tooltip-hit-area-container i{font-size:80%;cursor:pointer;display:inline-block;padding:5px}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-key-section-title .dcg-tooltip-hit-area-container.dcg-hovered{color:#333}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-key-section-title .dcg-tooltip-hit-area-container.dcg-depressed{color:#000}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-audio-keypad-spacer{flex:.25}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-content{display:flex;align-items:center;justify-content:center}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-content .dcg-play-icon-container,.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-content .dcg-stop-icon-container{border:2px solid #fff;border-radius:50%;width:22px;height:22px;line-height:22px;text-align:center;font-size:50%;margin-right:5px}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-content .dcg-icon-play{position:relative;top:-1px;left:1.5px}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-content .dcg-stop-icon{background:#fff;display:inline-block;border-radius:1px;width:8px;height:8px;position:relative;top:-1px}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-content .dcg-button-icon:not(.dcg-icon-only){font-size:70%}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-content .dcg-button-icon.dcg-icon-only{font-size:120%}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-key-nav-section{flex:1;display:flex;align-items:center}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-key-nav-section .dcg-keypad-btn-container{width:40px;font-size:80%}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-key-nav-section .dcg-keypad-btn-container i.dcg-icon-volume-up,.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-key-nav-section .dcg-keypad-btn-container i.dcg-icon-volume-down{font-size:115%}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-key-nav-section .dcg-key-nav-section-title-container{display:flex;flex-direction:column;justify-content:center;width:70px;padding:0 5px;font-size:90%}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-key-nav-section .dcg-key-nav-section-title-container .dcg-key-nav-section-title{font-size:75%;color:#666}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-key-nav-section .dcg-key-nav-section-title-container.dcg-poi-section-container .dcg-key-nav-section-title{display:block}@media screen and (max-width: 550px){.dcg-calculator-api-container-v1_10 .dcg-audio-keypad-spacer{max-width:20px}.dcg-calculator-api-container-v1_10 .dcg-audio-keypad-column .dcg-key-nav-section .dcg-key-nav-section-title-container{font-size:80%;width:60px}}@media screen and (max-width: 430px){.dcg-calculator-api-container-v1_10 .dcg-audio-keypad-container{font-size:90%}.dcg-calculator-api-container-v1_10 .dcg-audio-keypad-container .dcg-audio-keypad-column.dcg-playback-column .dcg-key-nav-section .dcg-key-nav-section-title-container{width:40px}.dcg-calculator-api-container-v1_10 .dcg-audio-keypad-container .dcg-audio-keypad-column.dcg-navigation-column .dcg-key-nav-section .dcg-key-nav-section-title-container{width:55px}}@media screen and (max-width: 340px){.dcg-calculator-api-container-v1_10 .dcg-audio-keypad-column.dcg-navigation-column .dcg-key-nav-section .dcg-key-nav-section-title-container{display:none}}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container{height:40px;display:inline-block;position:relative;flex-grow:1}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container.dcg-disabled{opacity:.5}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container.dcg-disabled .dcg-keypad-btn{cursor:default}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn{position:absolute;top:2px;left:2px;right:2px;bottom:2px;display:flex;flex-flow:row;align-items:center;padding:0}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn .dcg-keypad-btn-content{text-align:center;flex:1;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-mq-large-operator,.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-mq-int{font-size:80%}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-mq-large-operator .dcg-mq-sup,.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-mq-large-operator .dcg-mq-sub,.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-mq-large-operator .dcg-mq-to,.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-mq-large-operator .dcg-mq-from,.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-mq-int .dcg-mq-sup,.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-mq-int .dcg-mq-sub,.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-mq-int .dcg-mq-to,.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-mq-int .dcg-mq-from{display:none}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-mq-supsub{font-size:80%}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-mq-sqrt-stem{width:4px;padding:0;background:transparent}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container [dcg-command=shift]{padding-top:2px}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container [dcg-command="/"],.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container [dcg-command="-"]{padding-top:1px}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container [dcg-command="*"]{padding-top:2px}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container [dcg-command=left],.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container [dcg-command=right],.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container [dcg-command=backspace]{font-size:110%;padding-top:2px}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container [dcg-command=enter]{font-size:140%;padding-top:3px}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn .dcg-keypad-btn-content{font-size:90%}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-light-gray{color:#000;box-shadow:inset 0 1px #ffffff40,inset 0 -1px #00000005;background:linear-gradient(#f6f6f6,#f0f0f0);border:1px solid rgba(0,0,0,.1)}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-light-gray.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-light-gray.dcg-focus-visible{background:#ededed;border:1px solid rgba(0,0,0,.13)}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-light-gray.dcg-depressed{background:#e0e0e0;border:1px solid rgba(0,0,0,.15);box-shadow:none}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-light-on-gray{box-shadow:inset 0 1px #ffffff40,inset 0 -1px #00000005;background:linear-gradient(#fff,#fafafa);border:1px solid #d8d8d8;border-radius:2px}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-dark-on-gray{box-shadow:inset 0 1px #ffffff1a,inset 0 -1px #00000005;background:linear-gradient(#00000021,#00000029);border:1px solid #bbb;border-radius:2px}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-tall-blue,.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-short-blue{box-sizing:border-box;border-radius:2px;color:#fff;background:#2f72dc;border:1px solid #4380e0;box-shadow:inset 0 1px #ffffff1a,inset 0 -1px #0000000d}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-tall-blue.dcg-hovered:not(.dcg-disabled),.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-short-blue.dcg-hovered:not(.dcg-disabled){background:#2457a8;transition:background .2s}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-tall-blue.dcg-depressed:not(.dcg-disabled),.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-short-blue.dcg-depressed:not(.dcg-disabled){background:#193d75;border:1px solid #193d75;box-shadow:none}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-tall-blue{height:76px}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container:not(.dcg-disabled) .dcg-keypad-btn.dcg-btn-light-on-gray.dcg-hovered{background:#f5f5f5;border-color:#d8d8d8}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container:not(.dcg-disabled) .dcg-keypad-btn.dcg-btn-light-on-gray.dcg-depressed{background:#ebebeb;border-color:#cfcfcf;box-shadow:none}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container:not(.dcg-disabled) .dcg-keypad-btn.dcg-btn-dark-on-gray.dcg-hovered{background:#00000029}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-keypad-btn-container:not(.dcg-disabled) .dcg-keypad-btn.dcg-btn-dark-on-gray.dcg-depressed{box-shadow:none;background:#00000030}.dcg-calculator-api-container-v1_10 .dcg-inverted-colors .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-light-on-gray{box-shadow:inset 0 -1px #ffffff40,inset 0 1px #00000005;background:linear-gradient(#fafafa,#fff)}.dcg-calculator-api-container-v1_10 .dcg-inverted-colors .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-dark-on-gray{box-shadow:inset 0 -1px #ffffff1a,inset 0 1px #00000005;background:linear-gradient(#00000029,#00000021)}.dcg-calculator-api-container-v1_10 .dcg-has-background-color .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-light-on-gray,.dcg-calculator-api-container-v1_10 .dcg-has-background-color .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-light-gray{background:#ffffff4d;border:0}.dcg-calculator-api-container-v1_10 .dcg-has-background-color .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-light-on-gray.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-has-background-color .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-light-gray.dcg-hovered{background:#ffffff40}.dcg-calculator-api-container-v1_10 .dcg-has-background-color .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-light-on-gray.dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-has-background-color .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-light-gray.dcg-depressed{background:#ffffff26}.dcg-calculator-api-container-v1_10 .dcg-has-background-color .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-dark-on-gray{background:#00000026;border:0}.dcg-calculator-api-container-v1_10 .dcg-has-background-color .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-dark-on-gray.dcg-hovered{background:#0000002e}.dcg-calculator-api-container-v1_10 .dcg-has-background-color .dcg-basic-keypad .dcg-keypad-btn-container .dcg-keypad-btn.dcg-btn-dark-on-gray.dcg-depressed{background:#00000038}.dcg-calculator-api-container-v1_10 .dcg-projector-mode:not(.dcg-narrow) .dcg-keys-container.dcg-smaller-functions-text .dcg-keypad-btn[dcg-command=functions]{font-size:80%}.dcg-calculator-api-container-v1_10 .dcg-keys-container.dcg-small-ABC .dcg-abc-button--one-column .dcg-keypad-btn[dcg-command=ABC]{font-size:90%}.dcg-calculator-api-container-v1_10 .dcg-keys-container.dcg-smaller-ABC .dcg-abc-button--one-column .dcg-keypad-btn[dcg-command=ABC]{font-size:80%}.dcg-calculator-api-container-v1_10 .dcg-keys-container.dcg-smallest-ABC .dcg-abc-button--one-column .dcg-keypad-btn[dcg-command=ABC]{font-size:70%}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad-container{background:#00000012;border:1px solid rgba(0,0,0,.2);border-top:none}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad{margin:0;padding:4px 3px}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-mq-large-operator .dcg-mq-to,.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-mq-large-operator .dcg-mq-from{display:none!important}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-mq-int .dcg-mq-supsub{display:none}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-mq-large-operator,.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-mq-int{font-size:70%;position:relative;top:-1px}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad *{-webkit-user-select:none;user-select:none;-webkit-touch-callout:none}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-half-width-placeholder{flex-grow:.5}.dcg-calculator-api-container-v1_10 .dcg-basic-keypad .dcg-partition-placeholder{width:4%}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-basic-keypad{font-size:150%}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-basic-keypad .dcg-keypad-btn-container{height:52px}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-basic-keypad .dcg-keypad-row .dcg-keypad-btn-container{height:46px}.dcg-calculator-api-container-v1_10 .dcg-projector-mode.dcg-narrow .dcg-basic-keypad .dcg-keypad-row{font-size:90%}.dcg-calculator-api-container-v1_10 .dcg-projector-mode.dcg-narrow .dcg-basic-keypad .dcg-keypad-row .dcg-keypad-btn-container{height:44px}@media screen and (max-width: 470px){.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-sci-func-keypad .dcg-basic-keypad{font-size:115%}}@media screen and (max-width: 330px){.dcg-calculator-api-container-v1_10 .dcg-either-or-btn{font-size:85%;white-space:nowrap}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-basic-keypad{font-size:125%}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-sci-func-keypad .dcg-basic-keypad{font-size:90%}.dcg-calculator-api-container-v1_10 .dcg-projector-mode.dcg-narrow .dcg-basic-keypad .dcg-keypad-row{font-size:70%}}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover{top:-306px}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover .dcg-popover-interior{height:306px!important}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover{padding:0;text-align:left}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover .dcg-popover-interior{background-color:var(--dcg-custom-background-color, #fff);color:var(--dcg-custom-text-color, #000);padding:0;width:310px}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover .dcg-popover-interior .dcg-keypad-btn-container{width:33.3%;float:left;height:42px;float:none;margin-bottom:-5px;overflow:hidden}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover .dcg-popover-interior .dcg-keypad-btn-container .dcg-keypad-btn{font-size:80%!important;white-space:nowrap;color:var(--dcg-custom-text-color, #000)}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover .dcg-popover-section-separator{display:block;clear:both;border-bottom:1px solid #e2e2e2;margin:0 2px 4px;padding-top:4px}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover .dcg-keypad-keys-section,.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover .dcg-keypad-keys-buttons{margin-bottom:-42px}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover .dcg-keypad-keys-section:last-of-type .dcg-keypad-keys-buttons{margin-bottom:7px}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover .dcg-keypad-keys-section{border:1px solid transparent}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover .dcg-keypad-keys-section+.dcg-keypad-keys-section{margin-top:100px}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover .dcg-section-heading{color:var(--dcg-custom-text-color, #666);text-transform:uppercase;font-size:75%;text-align:left;padding:5px;position:sticky;top:0;background:var(--dcg-custom-background-color, #fff);z-index:2}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover .dcg-section-heading .dcg-beta-tag{font-size:70%;background:#8c29be;color:var(--dcg-custom-text-color, #fff);position:relative;top:-.6em;padding:1px 3px;border-radius:4px;margin-left:2px}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover .dcg-section-heading a{color:var(--dcg-custom-text-color, #000);margin-left:5px;opacity:.5}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover .dcg-section-heading a.dcg-hovered{opacity:.6}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover .dcg-section-heading a.dcg-depressed{opacity:.9}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover .dcg-interior-buttons{padding:5px}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover .dcg-option{border-bottom:1px solid rgba(0,0,0,.2);cursor:pointer;margin:4px 1px 0 3px!important;width:60px;height:38px;line-height:28px;text-align:center;line-height:38px;padding:0}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover.dcg-left{top:auto;bottom:5px;right:18%;left:auto}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover.dcg-left .dcg-arrow{top:auto;border-left-color:var(--dcg-custom-background-color, #fff)}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover.dcg-top .dcg-arrow{border-top-color:var(--dcg-custom-background-color, #fff)}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-functions-popover .dcg-popover-interior{width:330px}.dcg-calculator-api-container-v1_10 .dcg-projector-mode .dcg-functions-popover .dcg-interior-buttons{font-size:80%}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover.dcg-two-column .dcg-popover-interior{width:calc(100% + 2px)}.dcg-calculator-api-container-v1_10 .dcg-keypad .dcg-functions-popover.dcg-two-column .dcg-popover-interior .dcg-keypad-btn-container{width:50%}.dcg-calculator-api-container-v1_10 .dcg-keypad-row{padding:0;display:flex;flex-flow:row nowrap;align-items:stretch;margin:0}.dcg-calculator-api-container-v1_10 .dcg-geometry-toolbar-view{position:absolute;top:0;right:0;z-index:39;padding:5px;box-shadow:0 0 5px #0000001a;height:48px;border-bottom:1px solid rgba(0,0,0,.2);background:linear-gradient(#fcfcfc,#eaeaea);display:flex}.dcg-calculator-api-container-v1_10 .dcg-geometry-toolbar-view .dcg-header-left .dcg-tooltip-hit-area-container{float:left}.dcg-calculator-api-container-v1_10 .dcg-geometry-toolbar-view.dcg-after-initial-load .dcg-animate-in-after-initial-load{animation:dcg-fadeIn .3s}.dcg-calculator-api-container-v1_10 .dcg-geometry-toolbar-view .dcg-flex-spacer{flex:1}.dcg-calculator-api-container-v1_10 .dcg-geometry-toolbar-view .dcg-geo-undo-redo-container{display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-geometry-toolbar-view .dcg-geo-undo-redo-container.dcg-overgraph-undo-redo{position:absolute;top:53px;left:5px}.dcg-calculator-api-container-v1_10 .dcg-complex-tool-instruction-view .dcg-step-upcoming span,.dcg-calculator-api-container-v1_10 .dcg-complex-tool-instruction-view .dcg-step-active-icon span{width:16px;height:16px;display:inline-block;border-radius:50%;margin:0 3px}.dcg-calculator-api-container-v1_10 .dcg-complex-tool-instruction-view .dcg-step-upcoming span{border:1px solid rgba(0,0,0,.2);position:relative;top:2px;display:none}.dcg-calculator-api-container-v1_10 .dcg-complex-tool-instruction-view .dcg-step-active-icon span{display:none;background:#2f72dc;line-height:16px;text-align:center;font-size:80%;position:relative;top:-1px;color:#fff}.dcg-calculator-api-container-v1_10 .dcg-complex-tool-instruction-view .dcg-active-step{margin-right:5px;font-size:.9rem}.dcg-calculator-api-container-v1_10 .dcg-complex-tool-instruction-view .dcg-step-upcoming span,.dcg-calculator-api-container-v1_10 .dcg-complex-tool-instruction-view .dcg-active-step{animation:dcg-fadeIn .3s}.dcg-calculator-api-container-v1_10 .dcg-complex-tool-instruction-view .dcg-input-flex-container .dcg-btn-purple{padding:4px 6px;font-size:90%;position:relative;top:1px}.dcg-calculator-api-container-v1_10 .dcg-complex-tool-instruction-view .dcg-input-flex-container .dcg-btn-purple.dcg-disabled{pointer-events:none;opacity:.6}.dcg-calculator-api-container-v1_10 .dcg-complex-tool-instruction-view .dcg-mathquill-wrapper .dcg-mq-container .dcg-math-field{min-width:45px;max-width:45px;border:2px solid rgba(0,0,0,.2);border-radius:5px;padding:4px 0 4px 4px;margin:0 2px 0 4px;font-size:90%}.dcg-calculator-api-container-v1_10 .dcg-complex-tool-instruction-view .dcg-mathquill-wrapper .dcg-mq-container .dcg-math-field .dcg-mq-root-block{padding-right:5px}.dcg-calculator-api-container-v1_10 .dcg-complex-tool-instruction-view .dcg-mathquill-wrapper .dcg-mq-container .dcg-math-field:after{display:none}.dcg-calculator-api-container-v1_10 .dcg-complex-tool-instruction-view .dcg-mathquill-wrapper .dcg-mq-container .dcg-math-field.dcg-hovered{background:#fff}.dcg-calculator-api-container-v1_10 .dcg-complex-tool-instruction-view .dcg-mathquill-wrapper .dcg-mq-container .dcg-math-field.dcg-focus{border:2px solid #7c69b3;background:#fff}.dcg-calculator-api-container-v1_10 .dcg-complex-tool-instruction-view .dcg-mathquill-wrapper .dcg-mq-container .dcg-math-field.dcg-invalid{border:2px solid #e15855}@media (max-width: 450px){.dcg-calculator-api-container-v1_10 .dcg-complex-tool-instruction-view .dcg-active-step-text{font-size:90%}}.dcg-calculator-api-container-v1_10 .dcg-navigate-back{font-size:120%;margin-right:12px;border-right:1px solid rgba(0,0,0,.1);text-align:left;height:34px;padding-left:5px;padding-right:10px;display:flex;align-items:center}.dcg-calculator-api-container-v1_10 .dcg-navigate-back i{color:#949494}.dcg-calculator-api-container-v1_10 .dcg-navigate-back.dcg-hovered i{color:#666}.dcg-calculator-api-container-v1_10 .dcg-navigate-back.dcg-depressed i{color:#222}@media (max-width: 450px){.dcg-calculator-api-container-v1_10 .dcg-navigate-back{border-right:0;margin-right:0;padding-left:0;padding-right:3px}}@keyframes dcg-fadeIn-zoomRestore{0%{transform:scale(.75);opacity:0}to{transform:scale(1);opacity:1}}.dcg-calculator-api-container-v1_10 .dcg-left-pillboxes{position:absolute;left:5px;top:5px;z-index:21;display:flex;gap:5px}.dcg-calculator-api-container-v1_10 .dcg-left-pillboxes.dcg-geometry-toolbar-present{top:53px}.dcg-calculator-api-container-v1_10 .dcg-left-pillboxes .dcg-icon-redo,.dcg-calculator-api-container-v1_10 .dcg-left-pillboxes .dcg-icon-undo{font-size:1.1rem}.dcg-calculator-api-container-v1_10 .dcg-overgraph-pillbox-elements{pointer-events:none;display:flex;gap:5px}.dcg-calculator-api-container-v1_10 .dcg-overgraph-pillbox-elements .dcg-tooltip-hit-area-container{pointer-events:auto}.dcg-calculator-api-container-v1_10 .dcg-overgraph-pillbox-elements .dcg-right-pillbox-elements{display:flex;flex-direction:column;gap:5px}.dcg-calculator-api-container-v1_10 .dcg-overgraph-pillbox-elements .dcg-icon-plus,.dcg-calculator-api-container-v1_10 .dcg-overgraph-pillbox-elements .dcg-icon-minus{font-size:75%}.dcg-calculator-api-container-v1_10 .dcg-overgraph-pillbox-elements .dcg-icon-xy-plane{font-size:150%;line-height:35px}.dcg-calculator-api-container-v1_10 .dcg-overgraph-pillbox-elements .dcg-icon-3d-cube{font-size:135%;line-height:35px}.dcg-calculator-api-container-v1_10 .dcg-overgraph-pillbox-elements .dcg-icon-wrench{position:relative;top:-1px}.dcg-calculator-api-container-v1_10 .dcg-pillbox-btn-interior{height:37px;width:37px;line-height:37px;text-align:center;transition:opacity .3s}.dcg-calculator-api-container-v1_10 .dcg-pillbox-btn-interior.dcg-disabled{opacity:.3;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-action-settings .dcg-icon-lock{position:absolute;bottom:2px;right:2px;font-size:8px;padding:3px;border-radius:50%;color:#fff;background:#000000b3;text-shadow:none}.dcg-calculator-api-container-v1_10 .dcg-pillbox-container{position:absolute;right:5px;top:5px;bottom:0;width:0;z-index:21}.dcg-calculator-api-container-v1_10 .dcg-pillbox-container.dcg-geometry-toolbar-present{top:53px}.dcg-calculator-api-container-v1_10 .dcg-pillbox-container .dcg-overgraph-pillbox-elements{position:absolute;top:0;right:0}.dcg-calculator-api-container-v1_10 .dcg-btn-flat-gray-group .dcg-pillbox-btn-interior{width:100%;height:35px}.dcg-calculator-api-container-v1_10 .dcg-btn-flat-gray-group.dcg-group-vertical{width:37px}.dcg-calculator-api-container-v1_10 .dcg-btn-flat-gray-group.dcg-group-vertical .dcg-tooltip-hit-area-container:not(:last-of-type){border-bottom:1px solid rgba(0,0,0,.1)}.dcg-calculator-api-container-v1_10 .dcg-btn-flat-gray-group.dcg-group-horizontal.dcg-group-horizontal .dcg-tooltip-hit-area-container:not(:last-of-type){border-right:1px solid rgba(0,0,0,.1)}.dcg-calculator-api-container-v1_10 .dcg-action-zoomrestore{animation:dcg-fadeIn-zoomRestore .25s}.dcg-calculator-api-container-v1_10 .dcg-group-horizontal{display:flex;flex-direction:row;width:77px;height:37px}.dcg-calculator-api-container-v1_10 .dcg-btn-flat-gray{background:var(--dcg-custom-background-color-shaded, #ededed);box-shadow:0 0 5px #0000001a;border:1px solid rgba(0,0,0,.1);border-radius:5px;text-shadow:0 1px #fff}.dcg-calculator-api-container-v1_10 .dcg-btn-flat-gray i{opacity:.6}.dcg-calculator-api-container-v1_10 .dcg-btn-flat-gray:not(.dcg-btn-flat-gray-group).dcg-hovered i,.dcg-calculator-api-container-v1_10 .dcg-btn-flat-gray.dcg-btn-flat-gray-group .dcg-tooltip-hit-area-container:not(.dcg-tooltip-disabled).dcg-hovered i{opacity:.9}.dcg-calculator-api-container-v1_10 .dcg-btn-flat-gray:not(.dcg-btn-flat-gray-group).dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-btn-flat-gray:not(.dcg-btn-flat-gray-group).dcg-active,.dcg-calculator-api-container-v1_10 .dcg-btn-flat-gray.dcg-btn-flat-gray-group .dcg-tooltip-hit-area-container:not(.dcg-tooltip-disabled).dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-btn-flat-gray.dcg-btn-flat-gray-group .dcg-tooltip-hit-area-container:not(.dcg-tooltip-disabled).dcg-active{background:var(--dcg-custom-background-color-shaded, #e8e8e8)}.dcg-calculator-api-container-v1_10 .dcg-btn-flat-gray:not(.dcg-btn-flat-gray-group).dcg-depressed i,.dcg-calculator-api-container-v1_10 .dcg-btn-flat-gray:not(.dcg-btn-flat-gray-group).dcg-active i,.dcg-calculator-api-container-v1_10 .dcg-btn-flat-gray.dcg-btn-flat-gray-group .dcg-tooltip-hit-area-container:not(.dcg-tooltip-disabled).dcg-depressed i,.dcg-calculator-api-container-v1_10 .dcg-btn-flat-gray.dcg-btn-flat-gray-group .dcg-tooltip-hit-area-container:not(.dcg-tooltip-disabled).dcg-active i{opacity:1}.dcg-calculator-api-container-v1_10 .dcg-has-background-color .dcg-btn-flat-gray{text-shadow:none}.dcg-calculator-api-container-v1_10 .dcg-settings-view-container{line-height:0}.dcg-calculator-api-container-v1_10 .dcg-settings-view-container .dcg-settings-container{position:absolute;top:2px;right:38px;line-height:1em}.dcg-calculator-api-container-v1_10 .dcg-settings-container{bottom:auto;z-index:61;width:290px}.dcg-calculator-api-container-v1_10 .dcg-settings-container.dcg-left .dcg-arrow{top:18px;border-left-color:var(--dcg-custom-background-color, #fff)}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-popover-interior{padding:10px;background-color:var(--dcg-custom-background-color, #fff);color:var(--dcg-custom-text-color, #000)}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-visual-settings{padding-bottom:10px;border-bottom:1px solid #e2e2e2}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-step-label{font-size:85%;color:var(--dcg-custom-text-color, #454545)}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-top-section-flex{display:flex;padding-top:10px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-top-section-flex .dcg-component-checkbox{margin-top:3px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-top-section-flex .dcg-grid-settings{min-width:110px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-top-section-flex .dcg-grid-settings .dcg-component-checkbox{margin-bottom:2px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-top-section-flex .dcg-top-checkboxes-container .dcg-component-checkbox{margin-bottom:3px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-action-zoom-square{float:left;clear:left;font-size:80%;margin:3px 0;padding:3px 10px;line-height:1.5em}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container{border-top:1px solid #e2e2e2;margin-top:10px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container .dcg-x-axis-title,.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container .dcg-y-axis-title{display:grid;grid-template-columns:55% 45%;font-size:95%;line-height:normal;margin-bottom:2px;margin-top:5px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container .dcg-x-axis-title .dcg-component-checkbox,.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container .dcg-y-axis-title .dcg-component-checkbox{margin-top:1em}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container .dcg-x-axis-title.dcg-y-axis-title,.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container .dcg-y-axis-title.dcg-y-axis-title{margin-top:12px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container .dcg-x-axis-title .dcg-axis-label,.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container .dcg-y-axis-title .dcg-axis-label{position:relative;margin-bottom:-10px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container .dcg-x-axis-title .dcg-axis-label:focus-within label,.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container .dcg-y-axis-title .dcg-axis-label:focus-within label{color:#2f72dc}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container .dcg-x-axis-title .dcg-axis-label label,.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container .dcg-y-axis-title .dcg-axis-label label{position:absolute;padding:0 3px;font-size:85%;left:4px;top:2px;color:var(--dcg-custom-text-color, #666);background:var(--dcg-custom-background-color, #fff);margin:0;line-height:normal}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container .dcg-x-axis-title .dcg-axis-label input,.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container .dcg-y-axis-title .dcg-axis-label input{outline:none;margin-top:.7em;border-radius:5px;width:100%;color:var(--dcg-custom-text-color, #454545);font-size:90%;padding:7px;-webkit-appearance:none;appearance:none;border:1px solid var(--dcg-custom-text-color, rgba(0, 0, 0, .42));background:var(--dcg-custom-background-color, #fff)}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container .dcg-x-axis-title .dcg-axis-label input.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container .dcg-y-axis-title .dcg-axis-label input.dcg-hovered{border:1px solid var(--dcg-custom-text-color, rgba(0, 0, 0, .42));box-shadow:0 0 0 1px var(--dcg-custom-text-color, rgba(0, 0, 0, .42))}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container .dcg-x-axis-title .dcg-axis-label input:focus,.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-axes-settings-container .dcg-y-axis-title .dcg-axis-label input:focus{border:1px solid #2f72dc;box-shadow:0 0 0 1px #2f72dc}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-radiangroup,.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-dimensiongroup,.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-complex-container{border-top:1px solid #e2e2e2;padding-top:10px;margin-top:10px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-displaysizegroup{padding-bottom:10px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-arrows{text-align:center}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-arrows i{font-size:26px;line-height:28px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-circle-icon-group{margin-left:24px;margin-bottom:4px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-circle-icon{display:inline-block;cursor:pointer;width:28px;height:28px;border-radius:14px;box-shadow:0 0 2px #0003 inset;background-color:#f9f9f9;background-size:contain;background-position:center center;background-repeat:no-repeat;color:#777}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-circle-icon.dcg-selected{background-color:#666;color:#ffffffe6;cursor:default}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-circle-icon:not(.dcg-selected).dcg-hovered{box-shadow:inset 0 0 0 2px #0000001a}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-circle-icon:not(.dcg-selected).dcg-depressed{box-shadow:inset 0 0 0 2px #0003}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-circle-icon.dcg-action-cartesian,.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-circle-icon.dcg-action-polar{border:1px solid rgba(0,0,0,.42);overflow:hidden;font-size:26px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-circle-icon.dcg-action-cartesian.dcg-selected,.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-circle-icon.dcg-action-polar.dcg-selected{color:#fff}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-braille-container{margin-top:10px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-braille-container .dcg-braille-options-container{padding-left:28px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-braille-container .dcg-braille-options-container .dcg-braille-options-buttons{margin-top:5px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-interval-interior{margin:0 -6px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-editable-mathquill-container{margin-top:12px;position:relative;white-space:nowrap}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-editable-mathquill-container .dcg-step-container{float:right;margin-bottom:10px}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-editable-mathquill-container .dcg-mathquill-wrapper{display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-settings-container .dcg-editable-mathquill-container .dcg-mathquill-wrapper .dcg-braille-input{max-width:50px;font-size:100%}.dcg-calculator-api-container-v1_10 .dcg-displaysize-large{font-size:150%}.dcg-calculator-api-container-v1_10 .dcg-2dplane-opacity{max-width:50px;margin-left:5px}.dcg-calculator-api-container-v1_10 .dcg-narrow .dcg-settings-container{right:35px;width:260px}.dcg-calculator-api-container-v1_10 .dcg-advanced-graph-settings-view:not(.dcg-three-d-domain) .dcg-checkbox-title{font-size:95%;height:1.5em;line-height:2em;margin-bottom:2px;margin-top:10px;display:flex;align-items:center}.dcg-calculator-api-container-v1_10 .dcg-advanced-graph-settings-view .dcg-log-axes-container{display:grid;grid-template-columns:auto 1fr;grid-template-rows:1fr 1fr;align-items:center;grid-column-gap:5px;grid-row-gap:10px;font-size:90%}.dcg-calculator-api-container-v1_10 .dcg-advanced-graph-settings-view .dcg-advanced-toggle{color:var(--dcg-custom-text-color, #000);padding-top:5px;font-size:95%}.dcg-calculator-api-container-v1_10 .dcg-advanced-graph-settings-view .dcg-advanced-toggle.dcg-disabled{pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-advanced-graph-settings-view .dcg-advanced-toggle.dcg-disabled .dcg-caret-container{opacity:.5}.dcg-calculator-api-container-v1_10 .dcg-advanced-graph-settings-view .dcg-advanced-toggle.dcg-margin-top{margin-top:10px}.dcg-calculator-api-container-v1_10 .dcg-advanced-graph-settings-view .dcg-advanced-toggle .dcg-caret-container{transition:transform .3s;display:inline-block;font-size:90%;margin-right:5px;color:#949494;transform-origin:55% 35%}.dcg-calculator-api-container-v1_10 .dcg-advanced-graph-settings-view .dcg-advanced-toggle:not(.dcg-opened) .dcg-caret-container{transform:rotate(-90deg)}.dcg-calculator-api-container-v1_10 .dcg-advanced-graph-settings-view .dcg-advanced-toggle.dcg-hovered .dcg-caret-container{color:#666}.dcg-calculator-api-container-v1_10 .dcg-advanced-graph-settings-view .dcg-advanced-toggle.dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-advanced-graph-settings-view .dcg-advanced-toggle.dcg-depressed .dcg-caret-container{color:#222}.dcg-calculator-api-container-v1_10 .dcg-advanced-graph-settings-view .dcg-advanced-contents{border-left:1px solid rgba(0,0,0,.2);padding:8px 10px 4px;margin-left:6px;animation:dcg-fadeIn .3s}.dcg-calculator-api-container-v1_10 .dcg-advanced-graph-settings-view .dcg-advanced-contents .dcg-checkbox-title{font-size:90%;margin-top:3px}.dcg-calculator-api-container-v1_10 .dcg-advanced-graph-settings-view .dcg-editable-mathquill-container{margin-top:5px;margin-bottom:5px}.dcg-calculator-api-container-v1_10 .dcg-six-key-checkbox .dcg-component-checkbox{margin:5px 0;display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-refreshable-braille-note{font-size:95%;color:var(--dcg-custom-text-color, #666)}.dcg-calculator-api-container-v1_10 .dcg-refreshable-braille-note a{text-decoration:underline}.dcg-calculator-api-container-v1_10 .dcg-complex-options-section .dcg-complex-enabled-note{font-size:95%;color:#666}.dcg-calculator-api-container-v1_10 .dcg-3d-settings-flex-container{display:flex;flex-direction:row;gap:8px}.dcg-calculator-api-container-v1_10 .dcg-settings-view-3d-container .dcg-show-axis-labels-section{display:flex;flex-wrap:wrap;justify-content:space-between;margin-top:7px;gap:7px}.dcg-calculator-api-container-v1_10 .dcg-settings-view-3d-container .dcg-inline-math-input-view .dcg-math-field.dcg-math-field{border-bottom:1px solid rgba(0,0,0,.2);padding:1px 2px;margin:1px;min-width:35px;max-width:60px}.dcg-calculator-api-container-v1_10 .dcg-settings-view-3d-container .dcg-inline-math-input-view .dcg-math-field.dcg-math-field.dcg-focus,.dcg-calculator-api-container-v1_10 .dcg-settings-view-3d-container .dcg-inline-math-input-view .dcg-math-field.dcg-math-field.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-settings-view-3d-container .dcg-inline-math-input-view .dcg-math-field.dcg-math-field.dcg-invalid{border-bottom:2px solid #2f72dc;margin-bottom:0}.dcg-calculator-api-container-v1_10 .dcg-settings-view-3d-container .dcg-inline-math-input-view .dcg-math-field.dcg-math-field.dcg-invalid{border-bottom:2px solid #e15855}.dcg-calculator-api-container-v1_10 .dcg-settings-view-3d-container .dcg-inline-math-input-view .dcg-math-field.dcg-math-field.dcg-hovered:not(.dcg-focus):not(.dcg-invalid):not(.dcg-static-mathquill-view):not(.dcg-focus-visible){border-bottom:2px solid #ccc;margin-bottom:0}.dcg-calculator-api-container-v1_10 .dcg-settings-view-3d-container .dcg-popover-interior{padding:10px 0}.dcg-calculator-api-container-v1_10 .dcg-settings-view-3d-container .dcg-popover-interior .dcg-displaysizegroup{padding-bottom:3px}.dcg-calculator-api-container-v1_10 .dcg-settings-view-3d-container .dcg-component-checkbox{font-size:95%;margin-top:5px;color:#666}.dcg-calculator-api-container-v1_10 .dcg-settings-view-3d-container .dcg-braille-options-buttons{margin-top:8px}.dcg-calculator-api-container-v1_10 .dcg-local-display-preferences-title{margin-bottom:7px}.dcg-calculator-api-container-v1_10 .dcg-perspective-slider{display:flex;margin-top:5px;gap:7px;align-items:center}.dcg-calculator-api-container-v1_10 .dcg-perspective-slider i.dcg-icon-3d-cube,.dcg-calculator-api-container-v1_10 .dcg-perspective-slider i.dcg-icon-3d-perspective{cursor:pointer;color:#666}.dcg-calculator-api-container-v1_10 .dcg-perspective-slider i.dcg-icon-3d-perspective{font-size:1.5em;position:relative;top:.05em}.dcg-calculator-api-container-v1_10 .dcg-three-d-domain .dcg-options-menu-section-title{height:1.2rem}.dcg-calculator-api-container-v1_10 .dcg-three-d-domain .dcg-axis-label{padding-right:5px;display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-three-d-domain .dcg-axis-label .dcg-mq-math-mode{cursor:inherit}.dcg-calculator-api-container-v1_10 .dcg-three-d-domain .dcg-axis-label-to{margin-right:5px;font-size:95%;color:#666}.dcg-calculator-api-container-v1_10 .dcg-three-d-domain .dcg-three-d-domain-toggle-container{margin-top:4px;display:flex;margin-bottom:-5px}.dcg-calculator-api-container-v1_10 .dcg-three-d-domain.dcg-advanced-graph-settings-view .dcg-advanced-contents{margin-top:-10px}.dcg-calculator-api-container-v1_10 .dcg-three-d-domain.dcg-advanced-graph-settings-view .dcg-advanced-contents .dcg-editable-mathquill-container{margin-top:0}.dcg-calculator-api-container-v1_10 .dcg-three-d-domain .dcg-btn-light-gray,.dcg-calculator-api-container-v1_10 .dcg-three-d-domain .dcg-btn-blue{font-size:.8rem;padding:3px 10px;line-height:1.3rem;display:inline-block;animation:dcg-fadeIn .3s}.dcg-calculator-api-container-v1_10 .dcg-three-d-domain .dcg-action-zoom-recenter{position:relative;color:#000;top:-5px}.dcg-calculator-api-container-v1_10 .dcg-three-d-domain .dcg-z-axis-options.dcg-editable-mathquill-container{margin-bottom:0}.dcg-calculator-api-container-v1_10 .dcg-three-d-domain .dcg-action-zoom-square-3d{margin-top:8px}.dcg-calculator-api-container-v1_10 .dcg-three-d-domain .dcg-flex-container{display:flex}.dcg-calculator-api-container-v1_10 .dcg-three-d-domain .dcg-flex-container :first-child{flex:1}.dcg-calculator-api-container-v1_10 .dcg-toast-view{position:absolute;top:7px;left:50px;right:50px;height:0;text-align:center;z-index:45;overflow:visible;text-shadow:none;color:#222;line-height:1em;transition:.3s opacity}.dcg-calculator-api-container-v1_10 .dcg-toast-view:not(.dcg-visible){opacity:0;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-toast-view.dcg-below-geo-toolbar{top:55px}.dcg-calculator-api-container-v1_10 .dcg-toast-view .dcg-toast-wrapper{pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-toast-view .dcg-toast{display:inline-block;padding:6px 10px;background:#fef2ad;border:1px solid #fed973;border-radius:4px;font-size:85%;box-shadow:0 2px 6px #0000001a;position:relative;pointer-events:auto}.dcg-calculator-api-container-v1_10 .dcg-toast-view .dcg-toast i.dcg-icon-error{display:none}.dcg-calculator-api-container-v1_10 .dcg-toast-view .dcg-toast a.dcg-undo{padding:8px;margin:-8px -8px -8px 0}.dcg-calculator-api-container-v1_10 .dcg-toast-view .dcg-toast i.dcg-icon-remove{font-size:87%;padding:8px;margin:-5px -10px -8px 2px;color:#0003;cursor:pointer;float:right}.dcg-calculator-api-container-v1_10 .dcg-toast-view .dcg-toast i.dcg-icon-remove.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-toast-view .dcg-toast i.dcg-icon-remove:focus{color:#0009}.dcg-calculator-api-container-v1_10 .dcg-toast-view .dcg-toast i.dcg-icon-remove.dcg-depressed{color:#000000b3}.dcg-calculator-api-container-v1_10 .dcg-toast-view .dcg-toast a{margin-left:6px;text-decoration:underline;cursor:pointer;display:inline-block;color:#333;font-weight:600}.dcg-calculator-api-container-v1_10 .dcg-toast-view .dcg-toast a.dcg-hovered{color:#000}.dcg-calculator-api-container-v1_10 .dcg-toast-view .dcg-toast-cover{display:none}.dcg-calculator-api-container-v1_10 .dcg-toast-view[toast-style=error] .dcg-toast{padding-left:28px}.dcg-calculator-api-container-v1_10 .dcg-toast-view[toast-style=error] .dcg-toast i.dcg-icon-error{position:absolute;top:7px;left:10px;color:#fc944c;display:block}.dcg-calculator-api-container-v1_10 .dcg-toast-view[toast-style=cover]{position:absolute;top:0;left:0;right:0;padding-top:5px;height:100%;z-index:999}.dcg-calculator-api-container-v1_10 .dcg-toast-view[toast-style=cover] .dcg-toast-cover{position:absolute;top:0;left:0;bottom:0;right:0;opacity:.3;display:block;background-color:#000}.dcg-calculator-api-container-v1_10 .dcg-drop-image{position:absolute;top:0;right:0;left:0;bottom:0;z-index:42;text-align:center;vertical-align:middle;background:#ffffff80;border:8px dashed #bbb;font-family:sans-serif;color:#bbb;font-size:370%}.dcg-calculator-api-container-v1_10 .dcg-drop-image span{position:absolute;bottom:0;left:0;right:0;top:0;height:3.6em;line-height:1.2em;margin:auto;padding:0 20px}.dcg-calculator-api-container-v1_10 .dcg-exppanel-outer{display:inline-block;overflow-x:visible;margin-left:0}.dcg-calculator-api-container-v1_10 .dcg-exppanel-outer .dcg-exppanel-container{width:100%;-webkit-transform:translateZ(0);position:absolute;top:0;bottom:0;transition:transform .25s ease-out;display:flex;flex-direction:column}.dcg-calculator-api-container-v1_10 .dcg-exppanel-outer .dcg-exppanel-container.dcg-add-shadow{box-shadow:0 -4px 6px #0003;z-index:1}.dcg-calculator-api-container-v1_10 .dcg-show-expressions-tab{opacity:0;animation:dcg-fadeIn .3s forwards;animation-delay:.4s}.dcg-calculator-api-container-v1_10 .dcg-exppanel{flex:1;overflow-x:hidden;overflow-y:auto;overflow-anchor:none;border-right:1px solid rgba(0,0,0,.2);z-index:0;-webkit-overflow-scrolling:touch}.dcg-calculator-api-container-v1_10 .dcg-exppanel .dcg-expressionlist{display:flex;flex-direction:column;min-height:100%}.dcg-calculator-api-container-v1_10 .dcg-narrow .dcg-exppanel-container{z-index:40}.dcg-calculator-api-container-v1_10 .dcg-narrow .dcg-exppanel{border-right:0}.dcg-calculator-api-container-v1_10 .dcg-exp-list-resizer{position:absolute;top:0;right:-12px;bottom:0;width:15px;cursor:ew-resize;z-index:1}.dcg-calculator-api-container-v1_10 .dcg-exp-list-resizer.dcg-depressed{width:215px;right:-112px}.dcg-calculator-api-container-v1_10 .dcg-table-column-menu{left:-9px;top:34px}.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-triangle{border-width:0 9px 9px 9px;border-color:transparent transparent #d3d3d3 transparent}.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-triangle:before{position:absolute;top:1px;left:-8px;border-width:0 8px 8px 8px;border-color:transparent transparent #fff transparent}.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-options-menu__regression-btn-container{text-align:center}.dcg-calculator-api-container-v1_10 .dcg-table-column-menu .dcg-options-menu__regression-btn-container button{width:100%;font-size:.9rem;padding-top:.4rem;padding-bottom:.4rem;line-height:1em}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar{padding:5px;background:#d8d8d8;position:relative}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-search-row{display:flex;align-items:center}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar.dcg-expressions-scrolled{box-shadow:-2px 2px 4px #0000001a;z-index:4}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-search-mathquill-container{flex:1;position:relative;overflow:hidden}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-search-placeholder{opacity:.3;position:absolute;top:50%;left:35px;margin-top:-.5em;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-mq-container{width:100%}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-math-field{padding:6px 30px 6px 6px;margin:1px;border-radius:8px;background:#fff;width:100%;font-size:100%;color:#888;border:1px solid #bbb}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-math-field.dcg-hovered{color:#454545;border:2px solid #949494;margin:0}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-math-field.dcg-mq-focused{color:#000;border:2px solid #2f72dc;margin:0}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-search-mathquill-container .dcg-math-field{padding-left:30px}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-caret-container{font-size:95%;width:25px;padding-left:5px;color:#949494;text-align:left}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-caret-container i{transition:.2s;width:16px;height:16px}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-caret-container.dcg-hovered{color:#666;cursor:pointer}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-caret-container.dcg-collapsed i{display:inline-block;transform:rotate(-90deg)}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-icon-remove,.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-icon-search,.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-icon-replace{opacity:.2}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-icon-remove.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-icon-search.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-icon-replace.dcg-hovered{opacity:.6}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-icon-remove.dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-icon-search.dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-icon-replace.dcg-depressed{opacity:.8}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-icon-replace.dcg-disabled{opacity:0}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-icon-remove,.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-icon-replace{font-size:90%;padding:10px 7px 10px 12px}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-icon-search{pointer-events:none;left:5px;position:absolute;top:50%;right:5px;height:20px;line-height:20px;margin-top:-15px;padding:5px}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-search-replace-icon-container{position:absolute;top:50%;right:5px;margin-top:-9px;font-size:110%}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-search-replace-icon-container .dcg-tooltipped-error{position:relative;top:-1px;left:-2px}.dcg-calculator-api-container-v1_10 .dcg-expression-search-bar .dcg-search-replace-icon-container .dcg-icon-check{color:#2f72dc;margin-right:5px}.dcg-calculator-api-container-v1_10 .dcg-container.dcg-narrow .dcg-expression-top-bar{border-right:0}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-icon-btn,.dcg-calculator-api-container-v1_10 .dcg-container .dcg-geometry-toolbar-view .dcg-icon-btn{width:40px;height:40px;line-height:40px;font-size:1.1rem;display:inline-block;border-radius:5px;text-align:center;margin:-1px;overflow:hidden}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-icon-btn.dcg-constructions-count-link,.dcg-calculator-api-container-v1_10 .dcg-container .dcg-geometry-toolbar-view .dcg-icon-btn.dcg-constructions-count-link{margin-right:4px}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-icon-btn.dcg-rotated,.dcg-calculator-api-container-v1_10 .dcg-container .dcg-geometry-toolbar-view .dcg-icon-btn.dcg-rotated{transform:rotate(-90deg)}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-icon-btn i.dcg-icon-pause,.dcg-calculator-api-container-v1_10 .dcg-container .dcg-geometry-toolbar-view .dcg-icon-btn i.dcg-icon-pause{font-size:80%}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-icon-btn i.dcg-icon-undo,.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-icon-btn i.dcg-icon-redo,.dcg-calculator-api-container-v1_10 .dcg-container .dcg-geometry-toolbar-view .dcg-icon-btn i.dcg-icon-undo,.dcg-calculator-api-container-v1_10 .dcg-container .dcg-geometry-toolbar-view .dcg-icon-btn i.dcg-icon-redo{font-size:120%}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-icon-btn i,.dcg-calculator-api-container-v1_10 .dcg-container .dcg-geometry-toolbar-view .dcg-icon-btn i{opacity:.6}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-icon-btn:not(:last-of-type),.dcg-calculator-api-container-v1_10 .dcg-container .dcg-geometry-toolbar-view .dcg-icon-btn:not(:last-of-type){margin-right:-2px}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-icon-btn.dcg-disabled,.dcg-calculator-api-container-v1_10 .dcg-container .dcg-geometry-toolbar-view .dcg-icon-btn.dcg-disabled{opacity:.3;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-icon-btn.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-icon-btn.dcg-active,.dcg-calculator-api-container-v1_10 .dcg-container .dcg-geometry-toolbar-view .dcg-icon-btn.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-container .dcg-geometry-toolbar-view .dcg-icon-btn.dcg-active{background:#0000001a}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-icon-btn.dcg-hovered i,.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-icon-btn.dcg-active i,.dcg-calculator-api-container-v1_10 .dcg-container .dcg-geometry-toolbar-view .dcg-icon-btn.dcg-hovered i,.dcg-calculator-api-container-v1_10 .dcg-container .dcg-geometry-toolbar-view .dcg-icon-btn.dcg-active i{opacity:.8}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-icon-btn.dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-container .dcg-geometry-toolbar-view .dcg-icon-btn.dcg-depressed{background:#0003}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-icon-btn.dcg-depressed i,.dcg-calculator-api-container-v1_10 .dcg-container .dcg-geometry-toolbar-view .dcg-icon-btn.dcg-depressed i{opacity:1}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar{border-right:1px solid rgba(0,0,0,.2);height:48px;border-bottom:1px solid rgba(0,0,0,.2);line-height:37px;width:100%;transition:box-shadow .2s ease;padding:5px;display:flex;background:var(--dcg-custom-background-color-shaded, linear-gradient(#fcfcfc, #eaeaea))}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar.dcg-expressions-scrolled{box-shadow:-2px 2px 4px #0000001a;z-index:4}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-btn-red,.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-btn-blue{padding:0 15px;display:inline-block;align-self:center;height:35px;line-height:35px}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-center-buttons{text-align:center;flex:1;white-space:nowrap}.dcg-calculator-api-container-v1_10 .dcg-add-expression-container{position:relative;float:left;height:37px}.dcg-calculator-api-container-v1_10 .dcg-in-api-action-opendrawer{float:left}.dcg-calculator-api-container-v1_10 .dcg-add-expression-dropdown.dcg-popover{width:auto}.dcg-calculator-api-container-v1_10 .dcg-add-expression-dropdown.dcg-popover.dcg-bottom{position:absolute;top:43px;left:-3px}.dcg-calculator-api-container-v1_10 .dcg-add-expression-dropdown.dcg-popover.dcg-bottom .dcg-arrow{left:23px;border-bottom-color:var(--dcg-custom-background-color, #fff)}.dcg-calculator-api-container-v1_10 .dcg-add-expression-dropdown.dcg-popover.dcg-right{position:absolute;top:-40px;left:40px}.dcg-calculator-api-container-v1_10 .dcg-add-expression-dropdown.dcg-popover.dcg-right .dcg-arrow{top:60px;border-right-color:var(--dcg-custom-background-color, #fff)}.dcg-calculator-api-container-v1_10 .dcg-add-expression-dropdown.dcg-popover .dcg-popover-interior{padding:4px 0;background-color:var(--dcg-custom-background-color, #fff);color:var(--dcg-custom-text-color, #000)}.dcg-calculator-api-container-v1_10 .dcg-add-expression-dropdown.dcg-popover .dcg-new-item{cursor:pointer;font-size:80%;text-align:left;white-space:nowrap;opacity:.5;padding:8px;line-height:0}.dcg-calculator-api-container-v1_10 .dcg-add-expression-dropdown.dcg-popover .dcg-new-item i{margin:0 8px 0 4px;font-size:205%;vertical-align:middle;width:30px;display:inline-block;text-align:right}.dcg-calculator-api-container-v1_10 .dcg-add-expression-dropdown.dcg-popover .dcg-new-item i.dcg-icon-new-expression{font-size:210%}.dcg-calculator-api-container-v1_10 .dcg-add-expression-dropdown.dcg-popover .dcg-new-item i.dcg-icon-table{font-size:200%}.dcg-calculator-api-container-v1_10 .dcg-add-expression-dropdown.dcg-popover .dcg-new-item i.dcg-icon-new-folder{font-size:190%}.dcg-calculator-api-container-v1_10 .dcg-add-expression-dropdown.dcg-popover .dcg-new-item.dcg-action-newexpression{padding:10px 12px 4px 8px}.dcg-calculator-api-container-v1_10 .dcg-add-expression-dropdown.dcg-popover .dcg-new-item.dcg-hovered{opacity:.8}.dcg-calculator-api-container-v1_10 .dcg-add-expression-dropdown.dcg-popover .dcg-new-item.dcg-depressed{opacity:1}.dcg-calculator-api-container-v1_10 .dcg-add-expression-dropdown.dcg-popover .dcg-new-item.dcg-disabled{opacity:.25}.dcg-calculator-api-container-v1_10 .dcg-constructions-count-link{position:relative}.dcg-calculator-api-container-v1_10 .dcg-constructions-count-link i.dcg-icon-geometry{font-size:40px;position:relative;top:-2px}.dcg-calculator-api-container-v1_10 .dcg-constructions-count-link .dcg-construction-count{position:absolute;bottom:1px;right:1px;background:#949494;box-shadow:0 0 0 1px #eee;color:#fff;border-radius:8px;height:16px;min-width:16px;line-height:16px;padding-left:4px;padding-right:4px;text-align:center;font-size:65%;font-family:arial,sans-serif}.dcg-calculator-api-container-v1_10 .dcg-expression-top-bar .dcg-icon-volume{font-size:22px;position:relative;top:2px}@keyframes dcg-fadeOut-indicator{0%{opacity:.5}99%{opacity:.5}to{opacity:0}}@keyframes dcg-animate-mute-bar{0%{transform:rotate(-45deg) scaleX(0)}to{transform:rotate(-45deg) scale(1)}}@keyframes dcg-pulse-mute-button{0%{opacity:0}20%{opacity:1}80%{opacity:0;transform:scale(1.5)}to{opacity:0;transform:scale(1.5)}}.dcg-calculator-api-container-v1_10 .dcg-global-mute-button .dcg-first-time-animation{visibility:hidden}.dcg-calculator-api-container-v1_10 .dcg-global-mute-button.dcg-has-never-interacted .dcg-first-time-animation{visibility:visible;opacity:.5;animation:dcg-fadeOut-indicator 16s forwards}.dcg-calculator-api-container-v1_10 .dcg-global-mute-button.dcg-has-never-interacted .dcg-first-time-animation:before{content:"";position:absolute;top:4px;left:3.5px;bottom:3px;right:3.5px;border-radius:20%;z-index:0;background:#949494;animation:dcg-pulse-mute-button 2s infinite;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-circular-icon-container.dcg-show-globally-muted{opacity:.6}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-expression-top-bar .dcg-is-muted .dcg-icon-volume:after{content:"";background:currentColor;width:1em;height:2px;position:absolute;top:50%;left:50%;border:1px solid #fff;margin-top:-2px;margin-left:-.55em;transform:rotate(-45deg) scaleX(0);animation:dcg-animate-mute-bar .2s forwards;animation-delay:.1s}.dcg-calculator-api-container-v1_10 .dcg-expressionitem .dcg-caret-container{font-size:95%;position:absolute;top:-1px;left:38px;width:32px;height:48px;color:#949494;padding-left:10px;padding-top:18px;text-align:left;z-index:2}.dcg-calculator-api-container-v1_10 .dcg-expressionitem .dcg-caret-container i{transition:.2s;width:16px;height:16px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem .dcg-caret-container.dcg-hovered{color:#666;cursor:pointer}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-collapsed .dcg-caret-container i{display:inline-block;transform:rotate(-90deg)}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-secretFolder{display:none}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionfolder .dcg-action-toggle-secret-folder,.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionfolder .dcg-action-toggle-in-front-of-everything{cursor:pointer;color:#00000080;font-size:75%;padding:5px;margin:0 -5px -5px 15px;position:relative;z-index:1}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionfolder .dcg-action-toggle-secret-folder.dcg-last-folder-checkbox,.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionfolder .dcg-action-toggle-in-front-of-everything.dcg-last-folder-checkbox{margin-bottom:-10px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionfolder .dcg-fade-container:after{transition:0}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionfolder:not(.dcg-collapsed).dcg-has-items .dcg-fade-container:after{position:absolute;top:35px;bottom:5px;left:56px;content:"";border-left:1px solid rgba(0,0,0,.2);animation:dcg-fadeIn .3s}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionfolder .dcg-main textarea.dcg-smart-textarea,.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionfolder .dcg-main .dcg-displayTextarea{padding-left:20px}.dcg-calculator-api-container-v1_10 .dcg-smart-textarea-container{position:relative;font-size:90%}.dcg-calculator-api-container-v1_10 .dcg-smart-textarea-container textarea.dcg-smart-textarea,.dcg-calculator-api-container-v1_10 .dcg-smart-textarea-container .dcg-displayTextarea{border:0;font:inherit;resize:none;background:transparent;overflow:hidden;outline:none;color:var(--dcg-custom-text-color, #000);white-space:pre-wrap;word-wrap:break-word;width:100%;padding:3px;margin:-1px}.dcg-calculator-api-container-v1_10 .dcg-smart-textarea-container textarea.dcg-smart-textarea{opacity:0;position:absolute;top:1px;left:0;bottom:0;right:0;height:100%}.dcg-calculator-api-container-v1_10 .dcg-smart-textarea-container textarea.dcg-smart-textarea.dcg-empty{opacity:1}.dcg-calculator-api-container-v1_10 .dcg-smart-textarea-container .dcg-displayTextarea:after{content:"|";opacity:0;width:0;overflow:hidden;display:inline-block;height:1px}.dcg-calculator-api-container-v1_10 .dcg-smart-textarea-container .dcg-displayTextarea a{z-index:1;position:relative;color:#2f72dc}.dcg-calculator-api-container-v1_10 .dcg-smart-textarea-container .dcg-displayTextarea a.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-smart-textarea-container .dcg-displayTextarea a .dcg-depressed{color:#2253a1}.dcg-calculator-api-container-v1_10 .dcg-selected .dcg-smart-textarea-container .dcg-displayTextarea{pointer-events:none;opacity:0}.dcg-calculator-api-container-v1_10 .dcg-selected .dcg-smart-textarea-container textarea{opacity:1}.dcg-calculator-api-container-v1_10 .dcg-geo-show-constructions-pane{position:relative;background:var(--dcg-custom-background-color-shaded, #eee)}.dcg-calculator-api-container-v1_10 .dcg-geo-show-constructions-pane.dcg-transient-error,.dcg-calculator-api-container-v1_10 .dcg-geo-show-constructions-pane.dcg-cant-drag-item{opacity:.5}.dcg-calculator-api-container-v1_10 .dcg-geo-show-constructions-pane:after{content:"";background:linear-gradient(to bottom,rgba(238,238,238,0),var(--dcg-custom-background-color-shaded, #eee));height:10px;position:absolute;bottom:0;left:0;right:0;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-geo-show-constructions-pane:before{content:"";background:linear-gradient(to top,rgba(238,238,238,0),var(--dcg-custom-background-color-shaded, #eee));height:10px;position:absolute;top:0;left:0;right:0;z-index:1;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-geo-show-constructions-pane .dcg-token-being-dragged-container{opacity:.3}.dcg-calculator-api-container-v1_10 .dcg-displayed-sections-container{max-height:300px;overflow:auto}.dcg-calculator-api-container-v1_10 .dcg-displayed-sections-container .dcg-displayed-section-level{text-align:left;margin:0 8px;padding:8px 0}.dcg-calculator-api-container-v1_10 .dcg-displayed-sections-container .dcg-displayed-section-level:not(:last-of-type){border-bottom:1px solid rgba(0,0,0,.2);position:relative}.dcg-calculator-api-container-v1_10 .dcg-empty-constructions{padding:12px;text-align:center;color:var(--dcg-custom-text-color, #666);font-style:italic;font-size:90%}.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-options-menu-section-title{color:var(--dcg-custom-text-color, #666)}.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-opacities-menu-flex{display:flex;gap:5px;margin-top:5px}.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-opacities-menu-flex .dcg-opacity-option{height:29px}.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-image-aria-container{padding:0 10px}.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-clickable-image-controls .dcg-clickable-menu-row:first-of-type{margin-top:10px}.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-clickable-image-controls .dcg-clickable-menu-row .dcg-input-label{color:var(--dcg-custom-text-color, #666)}.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-clickable-image-controls .dcg-clickable-menu-row .dcg-math-field.dcg-math-field{font-size:95%;border-bottom:1px solid rgba(0,0,0,.2);padding:1px 2px;margin:1px;min-width:100%;max-width:100%}.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-clickable-image-controls .dcg-clickable-menu-row .dcg-math-field.dcg-math-field.dcg-focus,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-clickable-image-controls .dcg-clickable-menu-row .dcg-math-field.dcg-math-field.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-clickable-image-controls .dcg-clickable-menu-row .dcg-math-field.dcg-math-field.dcg-invalid{border-bottom:2px solid #2f72dc;margin-bottom:0}.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-clickable-image-controls .dcg-clickable-menu-row .dcg-math-field.dcg-math-field.dcg-invalid{border-bottom:2px solid #e15855}.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-clickable-image-controls .dcg-clickable-menu-row .dcg-math-field.dcg-math-field.dcg-hovered:not(.dcg-focus):not(.dcg-invalid):not(.dcg-static-mathquill-view):not(.dcg-focus-visible){border-bottom:2px solid #ccc;margin-bottom:0}.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-clickable-image-controls .dcg-clickable-menu-row input{outline:none;border:1px solid #bbb;border-top:0!important;border-right:0!important;border-left:0!important;color:#000;padding:5px;-webkit-appearance:none;appearance:none;border-radius:0}.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-clickable-image-controls .dcg-clickable-menu-row input.dcg-hovered{border-color:#ccc;box-shadow:0 1px #ccc}.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-clickable-image-controls .dcg-clickable-menu-row input:focus:not([disabled]){border-color:#2f72dc;box-shadow:0 1px #2f72dc}.dcg-calculator-api-container-v1_10 .dcg-image-options-menu .dcg-clickable-image-controls .dcg-clickable-menu-row input{padding-left:0;padding-right:0;font-size:95%;width:120px;margin-top:5px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage .dcg-image-loading,.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage .dcg-image-failed{font-size:100%;padding:1px;color:#888;font-style:italic;line-height:37px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage .dcg-retry-loading-image{color:#407bb5;text-decoration:underline}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage .dcg-image-input-grid{font-size:80%;display:grid;grid-template-columns:min-content 2fr min-content 1fr;width:calc(100% + 20px);max-width:450px;color:var(--dcg-custom-text-color, rgba(0, 0, 0, .5))}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage .dcg-image-input-grid .dcg-mathquill-wrapper{width:100%;padding-right:5px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage .dcg-image-input-grid .dcg-image-input-name,.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage .dcg-image-input-grid .dcg-image-input-mathquill{display:flex;align-self:center;padding-right:5px;overflow:hidden;padding-top:2px;padding-bottom:2px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage .dcg-image-input-grid .dcg-mq-editable-field:not(.dcg-focus){cursor:pointer}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage.dcg-input-focused .dcg-image-input-grid,.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage.dcg-input-focused .dcg-braille-input{color:var(--dcg-custom-text-color, #000)}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage .dcg-image-loaded .dcg-image-title-row{display:flex;justify-content:flex-start}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage .dcg-image-loaded .dcg-image-title-row .dcg-smart-textarea-container{margin-bottom:8px;font-size:85%}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage .dcg-image-loaded .dcg-image-title-row .dcg-smart-textarea-container textarea,.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage .dcg-image-loaded .dcg-image-title-row .dcg-smart-textarea-container .dcg-displayTextarea{padding-top:0;padding-bottom:0;margin:0 10px 0 -1px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage .dcg-image-loaded .dcg-image-title-row .dcg-smart-textarea-container textarea:empty,.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage .dcg-image-loaded .dcg-image-title-row .dcg-smart-textarea-container .dcg-displayTextarea:empty{min-width:8rem}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage .dcg-image-loaded .dcg-action-changeimage{color:var(--dcg-custom-text-color, rgba(0, 0, 0, .5));text-decoration:underline;font-size:80%}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage .dcg-image-loaded .dcg-action-changeimage.dcg-hovered{color:#0009}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage .dcg-image-loaded .dcg-action-changeimage.dcg-depressed{color:#000000b3}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage.dcg-selected .dcg-smart-textarea-container{position:relative;top:-1px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressionimage.dcg-selected .dcg-main{margin-right:-1px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-new-expression{height:54px;position:relative;border-bottom:1px solid transparent;overflow:visible!important}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-new-expression .dcg-new-math-div{position:absolute;top:0;left:0;bottom:0;right:0;cursor:pointer}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-new-expression .dcg-new-math-div .dcg-new-expression-fade{background:linear-gradient(to top,var(--dcg-custom-background-color, #fff),rgba(255,255,255,0) 50%);width:44px;position:absolute;top:0;bottom:0;z-index:3}.dcg-calculator-api-container-v1_10 .dcg-progress-update-legend{padding:.5em}.dcg-calculator-api-container-v1_10 .dcg-progress-update-legend .dcg-hide-progress{float:right}.dcg-calculator-api-container-v1_10 .dcg-legend-section{display:flex;gap:5px}.dcg-calculator-api-container-v1_10 .dcg-legend-section:not(:first-of-type){margin-top:5px}.dcg-calculator-api-container-v1_10 .dcg-progress-swatch{display:inline-block;width:20px;height:20px;border-radius:4px;margin-right:3px}.dcg-calculator-api-container-v1_10 .dcg-progress-analyzing{background:#1446aa59!important}.dcg-calculator-api-container-v1_10 .dcg-progress-graphing{background:#d25a1e59!important}.dcg-calculator-api-container-v1_10 .dcg-progress-unpublished{background:#c8c81459!important}.dcg-calculator-api-container-v1_10 .dcg-slider-options-view{top:-11px;left:42px;min-width:150px;padding:15px}.dcg-calculator-api-container-v1_10 .dcg-slider-options-view .dcg-title{font-size:110%}.dcg-calculator-api-container-v1_10 .dcg-slider-options-view .dcg-slider-speed-menu{margin-top:10px}.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container{font-size:95%}.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container .dcg-action-faster,.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container .dcg-action-slower{color:#666}.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container .dcg-action-faster.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container .dcg-action-slower.dcg-hovered{color:#222}.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container .dcg-action-faster.dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container .dcg-action-slower.dcg-depressed{color:#000}.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container .dcg-action-faster.dcg-disabled,.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container .dcg-action-slower.dcg-disabled{opacity:.25;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container .dcg-action-slower{transform:rotate(180deg)}.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container .dcg-action-faster,.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container .dcg-action-slower{cursor:pointer;font-size:70%;display:inline-block;width:26px;height:26px;text-align:center;line-height:26px;border:1px solid rgba(0,0,0,.2);border-radius:4px}.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container .dcg-action-faster.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container .dcg-action-slower.dcg-hovered{background:#0000000a}.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container .dcg-action-faster.dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container .dcg-action-slower.dcg-depressed{background:#0003}.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container .dcg-action-faster i,.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container .dcg-action-slower i{position:relative;left:1px}.dcg-calculator-api-container-v1_10 .dcg-slider-speed-container .dcg-variable-speed{width:45px;font-size:90%;display:inline-block;text-align:center}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-table-icon-container{position:absolute;top:50%;left:5px;margin-top:-14.5px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-drag-icon{opacity:.4;vertical-align:middle;pointer-events:none;font-size:95%;position:absolute;top:50%;right:4px;margin-top:-10px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-cell-math-content,.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-mathquill-braille{outline:none}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-cell:not(.dcg-non-editable) .dcg-cell-math-content,.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-cell:not(.dcg-non-editable) .dcg-mathquill-braille{max-width:100px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-cell.dcg-computed-cell{background:var(--dcg-custom-background-color-shaded, #f0f0f0)}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-non-editable.dcg-selected{box-shadow:inset 0 0 0 2px #2f72dcb3;background:var(--dcg-custom-background-color-shaded, #f0f0f0)}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-table-container{overflow:hidden;padding-left:15px;padding-right:15px;position:relative}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-table-container:before{position:absolute;top:0;left:0;bottom:0;z-index:1;background:linear-gradient(to left,rgba(255,255,255,0),var(--dcg-custom-background-color, #fff));width:20px;content:""}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-table-container:after{position:absolute;top:0;right:0;bottom:0;background:linear-gradient(to right,rgba(255,255,255,0),var(--dcg-custom-background-color, #fff));width:20px;content:""}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-table-container .dcg-table-sliding-container{transition:transform .15s}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-main{padding-top:20px;padding-bottom:5px;position:relative}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-show-more-row td{border-top:1px solid #e5e5e5;text-align:center;font-size:80%;color:#00000080;padding:8px 0;font-style:italic}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-show-more-row td .dcg-show-more{font-style:normal;font-size:90%;margin-left:.4em;position:relative;z-index:1}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata{position:relative;display:table}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row{display:table-row}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell{display:table-cell}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row:not(:first-of-type) .dcg-cell{border-top:1px solid rgba(0,0,0,.2);padding:7px 20px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row:not(:first-of-type) .dcg-cell.dcg-non-editable:not(.dcg-error){padding:7px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row:not(:first-of-type).dcg-braille-row .dcg-cell{padding:7px 5px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row:nth-of-type(2) .dcg-cell{border-top:1px solid #454545}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row:first-of-type .dcg-cell{vertical-align:bottom;padding:7px 8px 3px;min-width:55px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row:first-of-type .dcg-cell.dcg-error{padding-left:33px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row:first-of-type .dcg-cell.dcg-could-have-icon{min-width:65px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row:first-of-type .dcg-cell.dcg-leave-space-for-icon{padding-left:40px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row:first-of-type .dcg-cell.dcg-leave-space-for-drag-icon{padding-right:20px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row:first-of-type .dcg-cell .dcg-math-field{min-height:29px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row:first-of-type.dcg-braille-row .dcg-cell.dcg-leave-space-for-icon{padding:7px 15px 3px 40px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell{position:relative;text-align:center;vertical-align:middle;font-size:.8rem;min-height:34px;min-width:40px;cursor:text}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell .dcg-braille-input{text-align:center;min-width:40px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell:not(:first-of-type){border-left:1px solid rgba(0,0,0,.2)}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell:nth-of-type(2){border-left:1px solid #454545}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell.dcg-non-editable{cursor:default}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell.dcg-non-editable .dcg-mq-math-mode{pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell:not(.dcg-non-editable):not(.dcg-selected).dcg-empty .dcg-empty-line{position:absolute;width:26px;left:50%;margin-left:-13px;border-top:1px dashed #bbb;bottom:10px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell.dcg-selected:not(.dcg-non-editable) .dcg-inner-border{position:absolute;left:-1px;top:-1px;bottom:-1px;right:-1px;z-index:1;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell.dcg-selected.dcg-non-editable .dcg-mathquill-braille-overflow-left .dcg-tooltip-hit-area-container:before{background:linear-gradient(to left,#f5f5f500,#f5f5f5)}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell.dcg-selected.dcg-non-editable .dcg-mathquill-braille-overflow-right .dcg-tooltip-hit-area-container:after{background:linear-gradient(to right,#f5f5f500,#f5f5f5)}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell.dcg-selected:not(.dcg-non-editable) .dcg-inner-border{border:2px solid #2f72dc}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell .dcg-mq-math-mode{position:relative}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell .dcg-table-icon-error-container{position:absolute;top:50%;left:4px;margin-top:-7px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell.dcg-table-header{font-size:85%;min-height:37px}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell.dcg-table-header .dcg-mathquill-braille{min-height:30px;display:flex;align-items:center}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell.dcg-table-header:not(:first-of-type):not(:last-of-type) .dcg-mq-editable-field,.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell.dcg-table-header:not(:first-of-type):not(:last-of-type) .dcg-static-mathquill-view,.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell.dcg-table-header:not(:first-of-type):not(:last-of-type) .dcg-mathquill-braille,.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell.dcg-table-header.dcg-error .dcg-mq-editable-field,.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell.dcg-table-header.dcg-error .dcg-static-mathquill-view,.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable .dcg-tabledata .dcg-row .dcg-cell.dcg-table-header.dcg-error .dcg-mathquill-braille{text-align:center}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable.dcg-faded-h .dcg-tabledata:after{content:"";position:absolute;top:0;bottom:0;right:0;background:linear-gradient(to left,var(--dcg-custom-background-color, #fff),rgba(255,255,255,0));width:60px;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable.dcg-faded-v .dcg-tabledata:before{content:"";position:absolute;bottom:0;left:0;right:0;height:30px;pointer-events:none;background:linear-gradient(to top,var(--dcg-custom-background-color, #fff),rgba(255,255,255,0));z-index:1}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable.dcg-faded-v .dcg-tabledata .dcg-row:last-of-type .dcg-cell .dcg-empty-line{display:none}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable:not(.dcg-selected).dcg-faded-v .dcg-tabledata .dcg-row:last-of-type{visibility:hidden}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable:not(.dcg-selected).dcg-faded-v .dcg-tabledata .dcg-row:last-of-type .dcg-cell{border-color:transparent}.dcg-calculator-api-container-v1_10 .dcg-expressionitem.dcg-expressiontable:not(.dcg-selected).dcg-faded-v .dcg-tabledata .dcg-row .dcg-cell:last-of-type{border-color:transparent;visibility:hidden}.dcg-calculator-api-container-v1_10 .dcg-table-regression{clear:both;margin-right:-18px}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-regression-footer-view{margin-bottom:-15px}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-dropdown-row{margin:5px 0 0;display:flex;max-width:400px;gap:7px;align-items:center}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-dropdown-row.dcg-dropdown-row__has-column-picker{flex-wrap:wrap}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-dropdown-row .dcg-dropdown-row__plot-and-model{display:flex;align-items:center}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-dropdown-row .dcg-dropdown-row__plot-and-model .dcg-icon-container{width:34px}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-dropdown-row .dcg-dropdown-row__plot-and-model .dcg-tooltipped-error{height:auto}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-dropdown-row .dcg-dropdown-row__plot-and-model .dcg-select-dropdown-container{flex:1}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-dropdown-row .dcg-dropdown-row__breakable{display:flex;gap:7px;align-items:center}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-dropdown-row>:first-child{flex:1}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-dropdown-row .dcg-select-dropdown-container .dcg-dropdown-input{padding:0 8px;min-height:36px}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-dropdown-row .dcg-dropdown-row__column-selector .dcg-dropdown-input .dcg-mixed-text-math{max-width:150px;overflow:hidden;padding-right:10px;position:relative;margin-right:-5px}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-dropdown-row .dcg-dropdown-row__column-selector .dcg-dropdown-input .dcg-mixed-text-math:after{position:absolute;top:0;right:0;bottom:0;width:10px;pointer-events:none;background:linear-gradient(to right,rgba(255,255,255,0),var(--dcg-custom-background-color, #fff));content:""}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-expression-footer-title{font-size:.7rem}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-expression-footer-title__equation{margin-top:.5rem}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-table-regression__dropdown-separator{font-size:.875rem;color:var(--dcg-custom-text-color, #333)}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-icon-remove{opacity:.2;font-size:.9rem;padding:10px;margin:-10px -10px -10px -5px}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-icon-remove.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-icon-remove.dcg-focus-visible{opacity:.6}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-icon-remove.dcg-depressed{opacity:.8}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-break-before{display:inline;padding-left:0}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-break-before:before{content:"\\a";white-space:normal}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-regression-equation{margin-bottom:.5rem;display:flex;overflow:hidden;position:relative;font-size:.8rem}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-regression-equation .dcg-mq-root-block{padding-right:.5em;line-height:1.5em;padding-left:.85em;text-indent:-.7em}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-regression-equation .dcg-mq-root-block .dcg-mq-supsub,.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-regression-equation .dcg-mq-root-block .dcg-mq-fraction,.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-regression-equation .dcg-mq-root-block .dcg-mq-non-leaf{line-height:1em}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-regression-equation .dcg-mq-root-block>*{text-indent:0}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-dot-dot-dropdown{padding:8px;margin:-8px;height:auto;width:auto}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-dropdown-popover__interior{padding:10px 0;font-size:.8rem}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-dropdown-popover__interior .dcg-regression-model{margin:10px 0;font-size:1rem}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-regression-popover__export-to-list{margin-bottom:10px}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-regression-popover__unexportable-warning{color:var(--dcg-custom-text-color, rgba(0, 0, 0, .5));white-space:normal;font-size:.85rem}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-regression-popover__delete,.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-regression-popover__export-to-list{display:block;font-size:.9rem;width:100%;line-height:2rem}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-table-regression-view__custom-model-notice{border-top:1px solid #bbb;padding:8px;font-size:75%;font-style:italic;color:var(--dcg-custom-text-color, #666);white-space:pre-wrap}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-table-regression-view__custom-model-notice .dcg-tilde{font-family:Symbola,Times New Roman,serif;display:inline-block;border:1px solid #bbb;padding:0 7px 0 5px;font-size:1rem;border-radius:4px}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-table-regression-view__custom-model-notice a{text-decoration:underline}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-copy-regression-button{font-size:1rem;color:var(--dcg-custom-text-color, #000);margin-left:5px;height:0;position:relative;top:1px}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-copy-regression-button i{padding:5px;margin:-5px}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-copy-regression-button i,.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-dot-dot-dropdown{cursor:pointer;opacity:.4}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-copy-regression-button i.dcg-hovered,.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-dot-dot-dropdown.dcg-hovered{opacity:.6}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-copy-regression-button i.dcg-depressed,.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-dot-dot-dropdown.dcg-depressed{opacity:1}.dcg-calculator-api-container-v1_10 .dcg-table-regression .dcg-regression-view-source--button{padding-left:1em}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover .dcg-arrow{position:absolute;display:inline-block;width:0;height:0;border-color:transparent;border-style:solid}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover .dcg-arrow:after{position:absolute;display:inline-block;width:0;height:0;border-color:transparent;border-style:solid;content:"";z-index:-1}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover .dcg-popover-interior,.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover__interior{padding:20px;background-color:var(--dcg-custom-background-color, #fff);border:1px solid #bbb;border-radius:6px;box-shadow:0 5px 10px #0003;color:var(--dcg-custom-text-color, #000);margin:-1px;overflow:auto}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover .dcg-popover-title,.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover__title{margin-bottom:10px;font-size:1.15rem;border-bottom:2px solid #2f72dc;color:#2f72dc;font-weight:400;background-color:#fff;line-height:normal}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover .dcg-popover-title:not(:first-of-type),.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover__title:not(:first-of-type){padding-top:20px}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover{position:absolute;z-index:80;margin:1px}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover .dcg-arrow{border-width:14px;transform-style:preserve-3d}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover .dcg-arrow:after{border-width:14px;transform:translateZ(-1px);scale:1.07}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover .dcg-popover-interior{border:1px solid #bbb}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover.dcg-top .dcg-arrow{bottom:-14px;border-bottom-width:0;border-top-color:var(--dcg-custom-background-color, #fff)}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover.dcg-top .dcg-arrow:after{border-bottom-width:0;border-top-color:#bbb;bottom:-1px;left:-14px}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover.dcg-right .dcg-arrow{left:-14px;border-left-width:0;border-right-color:var(--dcg-custom-background-color, #fff)}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover.dcg-right .dcg-arrow:after{border-left-width:0;border-right-color:#bbb;bottom:-14px;left:-1px}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover.dcg-bottom .dcg-arrow{top:-14px;border-top-width:0;border-bottom-color:var(--dcg-custom-background-color, #fff)}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover.dcg-bottom .dcg-arrow:after{border-top-width:0;border-bottom-color:#bbb;top:-1px;left:-14px}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover.dcg-left .dcg-arrow{right:-14px;border-right-width:0;border-left-color:var(--dcg-custom-background-color, #fff)}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover.dcg-left .dcg-arrow:after{border-right-width:0;border-left-color:#bbb;bottom:-14px;right:-1px}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover--with-arrow{margin:0}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover--with-arrow.dcg-top{margin-bottom:14px}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover--with-arrow.dcg-right{margin-left:14px}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover--with-arrow.dcg-bottom{margin-top:14px}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover--with-arrow.dcg-left{margin-right:14px}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover:not(.dcg-dropdown-popover--constrain-height).dcg-left{right:100%}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover:not(.dcg-dropdown-popover--constrain-height).dcg-right{left:100%}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover:not(.dcg-dropdown-popover--constrain-height).dcg-top{bottom:100%}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover:not(.dcg-dropdown-popover--constrain-height).dcg-bottom{top:100%}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover--constrain-height{top:40px;bottom:2px;right:4px;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover--constrain-height .dcg-dropdown-popover__interior{max-height:100%;pointer-events:auto}.dcg-calculator-api-container-v1_10 .dcg-dropdown-popover__interior{padding:10px}.dcg-calculator-api-container-v1_10 .dcg-popover-with-anchor{position:relative;display:inline-block;margin:auto}.dcg-calculator-api-container-v1_10 .dcg-select-dropdown-container{position:relative;display:flex;flex-direction:column;max-height:100%}.dcg-calculator-api-container-v1_10 .dcg-select-dropdown-container .dcg-mixed-text-math{pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-select-dropdown-container .dcg-open-options{color:#949494}.dcg-calculator-api-container-v1_10 .dcg-select-dropdown-container .dcg-open-options.dcg-hovered{color:#0009}.dcg-calculator-api-container-v1_10 .dcg-select-dropdown-container .dcg-open-options.dcg-depressed{color:#000000b3}.dcg-calculator-api-container-v1_10 .dcg-select-dropdown-container .dcg-dropdown-input{outline:none;width:100%;border:2px solid rgba(0,0,0,.2);background:var(--dcg-custom-background-color, #fff);font-size:.875rem;color:var(--dcg-custom-text-color, #333);padding:10px;border-radius:5px 5px 0 0;display:flex;justify-content:space-between;align-items:center;gap:5px}.dcg-calculator-api-container-v1_10 .dcg-select-dropdown-container .dcg-dropdown-input.dcg-results-hidden{border-radius:5px}.dcg-calculator-api-container-v1_10 .dcg-select-dropdown-container .dcg-dropdown-input.dcg-hovered{border-color:#bbb}.dcg-calculator-api-container-v1_10 .dcg-select-dropdown-container .dcg-dropdown-input.dcg-focus-visible{border-color:#2f72dc}.dcg-calculator-api-container-v1_10 .dcg-select-dropdown-container .dcg-options-dropdown__padded-bottom-container{padding-bottom:50px;position:absolute;top:100%;left:0;min-width:100%;z-index:2}.dcg-calculator-api-container-v1_10 .dcg-select-dropdown-container .dcg-select-dropdown-list{margin-top:-1px;max-height:500px;border:1px solid rgba(0,0,0,.2);border-radius:0 0 5px 5px;background:var(--dcg-custom-background-color, #fff);text-align:left;-webkit-overflow-scrolling:touch;overflow-x:hidden;overflow-y:auto;list-style-type:none}.dcg-calculator-api-container-v1_10 .dcg-select-dropdown-container .dcg-select-dropdown-option{padding:7px 10px;font-size:.85rem}.dcg-calculator-api-container-v1_10 .dcg-shared-options-dropdown .dcg-dropdown-explanations{font-size:80%;padding:3px 7px;min-width:190px;opacity:.7}.dcg-calculator-api-container-v1_10 .dcg-shared-options-dropdown .dcg-dropdown-explanations .dcg-explanation{margin-bottom:5px}.dcg-calculator-api-container-v1_10 .dcg-shared-options-dropdown .dcg-dropdown-explanations .dcg-explanation a{color:#2f72dc;white-space:nowrap;margin-bottom:5px}.dcg-calculator-api-container-v1_10 .dcg-shared-options-dropdown .dcg-dropdown-choice{padding:7px;display:block;text-decoration:none;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.dcg-calculator-api-container-v1_10 .dcg-shared-options-dropdown .dcg-dropdown-choice.dcg-standard-link-styling{color:#666}.dcg-calculator-api-container-v1_10 .dcg-shared-options-dropdown .dcg-dropdown-choice.dcg-standard-link-styling.dcg-selected:not(.dcg-disabled),.dcg-calculator-api-container-v1_10 .dcg-shared-options-dropdown .dcg-dropdown-choice.dcg-standard-link-styling.dcg-hovered:not(.dcg-disabled),.dcg-calculator-api-container-v1_10 .dcg-shared-options-dropdown .dcg-dropdown-choice.dcg-standard-link-styling.dcg-depressed:not(.dcg-disabled){color:#000}.dcg-calculator-api-container-v1_10 .dcg-shared-options-dropdown .dcg-dropdown-choice.dcg-focus-visible:not([aria-disabled=true]),.dcg-calculator-api-container-v1_10 .dcg-shared-options-dropdown .dcg-dropdown-choice.dcg-hovered:not([aria-disabled=true]){background:#0000001a}.dcg-calculator-api-container-v1_10 .dcg-shared-options-dropdown .dcg-dropdown-choice.dcg-depressed:not([aria-disabled=true]){background:#0003}.dcg-calculator-api-container-v1_10 .dcg-shared-options-dropdown .dcg-dropdown-choice.dcg-selected:not([aria-disabled=true]){background:#e0eafa}.dcg-calculator-api-container-v1_10 .dcg-shared-options-dropdown .dcg-dropdown-choice.dcg-hovered:not(.dcg-focus-visible){box-shadow:none}.dcg-calculator-api-container-v1_10 .dcg-shared-options-dropdown .dcg-dropdown-choice.dcg-disabled{opacity:.3;cursor:default;background:#0000001a}.dcg-calculator-api-container-v1_10 .dcg-shared-options-dropdown .dcg-dropdown-choice .dcg-option-icon-container{display:inline-block;width:20px;text-align:center;margin-right:10px}.dcg-calculator-api-container-v1_10 .dcg-shared-options-dropdown .dcg-dropdown-choice .dcg-option-icon-container .dcg-option-icon{font-size:90%}.dcg-calculator-api-container-v1_10 .dcg-shared-options-dropdown .dcg-dropdown-choice .dcg-option-subtitle{display:block;margin-left:30px;font-size:80%;text-decoration:underline}@keyframes dcg-tick-metronome{0%{transform:scale(.5) rotate(-20deg)}50%{transform:scale(.5) rotate(20deg)}to{transform:scale(.5) rotate(-20deg)}}.dcg-calculator-api-container-v1_10 .dcg-ticker{padding:5px;position:relative;background:var(--dcg-custom-background-color-shaded, #eee);border-bottom:1px solid rgba(0,0,0,.2);border-right:1px solid rgba(0,0,0,.2);overflow:hidden}.dcg-calculator-api-container-v1_10 .dcg-ticker.dcg-expressions-scrolled{box-shadow:-2px 2px 4px #0000001a;z-index:4}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-circular-icon-container{position:relative}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-icon-remove{position:absolute;top:0;right:0;opacity:.2;font-size:115%;padding:10px 7px 10px 12px}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-icon-remove.dcg-hovered{opacity:.6}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-icon-remove.dcg-depressed{opacity:.8}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-mini-play-pause{transform:scale(.5);transform-origin:bottom right;position:absolute;bottom:-5px;right:-4px;background:#eee;border-radius:50%;border:1px solid #eee}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-icon-metronome-2{font-size:130%;position:relative;left:1px}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-metronome-bar{width:2px;height:24px;transform:scale(.5) rotate(-20deg);transform-origin:bottom center;background:#777;border-radius:2px;position:absolute;bottom:10px;left:50%;box-shadow:0 0 0 1px #eee}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-metronome-bar.dcg-metronome-playing{animation:dcg-tick-metronome infinite .5s ease-in-out}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-container{display:flex;width:calc(100% - 30px)}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-container .dcg-circular-icon-container{font-size:65%;margin-right:10px!important;order:1}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-container .dcg-circular-icon-container.dcg-disabled{opacity:.4;pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-container .dcg-create-sliders{margin-top:5px;width:100%}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal{display:flex;flex:1;order:2;align-items:center;color:var(--dcg-custom-text-color, #666);flex-wrap:wrap;padding:3px 0;overflow:hidden;font-size:95%}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-mathquill-wrapper{color:var(--dcg-custom-text-color, #000);margin-left:4px;font-size:95%}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-definition{max-width:100%;display:flex;align-items:baseline}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-definition .dcg-mathquill-wrapper{margin-right:5px;overflow:hidden;flex:1}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-definition .dcg-math-field.dcg-math-field,.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-definition .dcg-braille-input.dcg-braille-input{border-bottom:1px solid rgba(0,0,0,.2);padding:1px 2px;margin:1px;min-width:75px;max-width:100%}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-definition .dcg-math-field.dcg-math-field.dcg-focus,.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-definition .dcg-math-field.dcg-math-field.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-definition .dcg-math-field.dcg-math-field.dcg-invalid,.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-definition .dcg-braille-input.dcg-braille-input.dcg-focus,.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-definition .dcg-braille-input.dcg-braille-input.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-definition .dcg-braille-input.dcg-braille-input.dcg-invalid{border-bottom:2px solid #2f72dc;margin-bottom:0}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-definition .dcg-math-field.dcg-math-field.dcg-invalid,.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-definition .dcg-braille-input.dcg-braille-input.dcg-invalid{border-bottom:2px solid #e15855}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-definition .dcg-math-field.dcg-math-field.dcg-hovered:not(.dcg-focus):not(.dcg-invalid):not(.dcg-static-mathquill-view):not(.dcg-focus-visible),.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-definition .dcg-braille-input.dcg-braille-input.dcg-hovered:not(.dcg-focus):not(.dcg-invalid):not(.dcg-static-mathquill-view):not(.dcg-focus-visible){border-bottom:2px solid #ccc;margin-bottom:0}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-definition .dcg-math-field.dcg-math-field,.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-definition .dcg-braille-input.dcg-braille-input{padding-right:20px}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-frequency .dcg-math-field.dcg-math-field,.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-frequency .dcg-braille-input.dcg-braille-input{border-bottom:1px solid rgba(0,0,0,.2);padding:1px 2px;margin:1px;min-width:30px;max-width:90px}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-frequency .dcg-math-field.dcg-math-field.dcg-focus,.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-frequency .dcg-math-field.dcg-math-field.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-frequency .dcg-math-field.dcg-math-field.dcg-invalid,.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-frequency .dcg-braille-input.dcg-braille-input.dcg-focus,.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-frequency .dcg-braille-input.dcg-braille-input.dcg-focus-visible,.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-frequency .dcg-braille-input.dcg-braille-input.dcg-invalid{border-bottom:2px solid #2f72dc;margin-bottom:0}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-frequency .dcg-math-field.dcg-math-field.dcg-invalid,.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-frequency .dcg-braille-input.dcg-braille-input.dcg-invalid{border-bottom:2px solid #e15855}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-frequency .dcg-math-field.dcg-math-field.dcg-hovered:not(.dcg-focus):not(.dcg-invalid):not(.dcg-static-mathquill-view):not(.dcg-focus-visible),.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-action-frequency .dcg-braille-input.dcg-braille-input.dcg-hovered:not(.dcg-focus):not(.dcg-invalid):not(.dcg-static-mathquill-view):not(.dcg-focus-visible){border-bottom:2px solid #ccc;margin-bottom:0}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-settings-internal .dcg-clickable-info-error-container{margin-left:-20px;width:20px;display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-toggle-help{text-decoration:none;color:#aaa;padding:10px 6px;font-size:85%;position:relative;top:1px;flex:1}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-toggle-help.dcg-hovered{color:#666}.dcg-calculator-api-container-v1_10 .dcg-ticker .dcg-ticker-toggle-help.dcg-depressed{color:#454545}.dcg-calculator-api-container-v1_10 .dcg-adaptive-peeling-warning{position:absolute;bottom:0;right:0;text-align:center;z-index:60}.dcg-calculator-api-container-v1_10 .dcg-adaptive-peeling-warning .dcg-warning-content{margin:10px;background:#000000b3;border-radius:5px;padding:5px 10px;display:inline-block;color:#fff;font-size:.9rem;-webkit-user-select:all;user-select:all}.dcg-calculator-api-container-v1_10 .dcg-geometry-settings-container.dcg-constrained-height-popover{z-index:61;width:290px;top:53px;right:43px}.dcg-calculator-api-container-v1_10 .dcg-geometry-settings-container.dcg-constrained-height-popover.dcg-no-geometry-header{top:5px}.dcg-calculator-api-container-v1_10 .dcg-geometry-settings-container.dcg-constrained-height-popover .dcg-arrow{top:18px!important}.dcg-calculator-api-container-v1_10 .dcg-geometry-settings-container.dcg-constrained-height-popover .dcg-popover-interior{padding:10px 0;background-color:var(--dcg-custom-background-color, #fff);color:var(--dcg-custom-text-color, #000)}.dcg-calculator-api-container-v1_10 .dcg-geometry-settings-container.dcg-constrained-height-popover .dcg-component-checkbox{font-size:95%;margin-top:5px;color:var(--dcg-custom-text-color, #666);display:inline-block}.dcg-calculator-api-container-v1_10 .dcg-geometry-settings-container.dcg-constrained-height-popover .dcg-lock-viewport-option .dcg-learn-more-link{padding:0 5px}.dcg-calculator-api-container-v1_10 .dcg-geometry-settings-container.dcg-constrained-height-popover .dcg-braille-options-buttons{margin-top:8px}.dcg-calculator-api-container-v1_10 .dcg-author-mode-section .dcg-toolbar-customization{display:flex;align-items:center;font-size:90%;margin-top:10px;white-space:nowrap;color:#666}.dcg-calculator-api-container-v1_10 .dcg-author-mode-section .dcg-toolbar-customization .dcg-segmented-control-container{margin-left:10px;width:100%}.dcg-calculator-api-container-v1_10 .dcg-author-mode-section .dcg-toolbar-customization .dcg-segmented-control-container .dcg-segmented-control-btn{flex:1}.dcg-calculator-api-container-v1_10 .dcg-author-mode-section .dcg-edit-configuration-link-container{text-align:center;padding-top:3px;font-size:90%}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-done-btn{float:right;position:relative;top:-4px}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal h1{font-weight:400;color:#666;padding-bottom:10px}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row{display:grid;grid-template-columns:1fr 2fr;border-bottom:1px solid rgba(0,0,0,.2)}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row .dcg-first-column,.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row .dcg-second-column{border-left:1px solid rgba(0,0,0,.2);padding:5px;display:grid;align-content:center}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row .dcg-second-column{border-right:1px solid rgba(0,0,0,.2)}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row .dcg-second-column.dcg-disabled{background:#eee}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row .dcg-component-checkbox{white-space:nowrap;margin-left:2px;margin-top:0}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row.dcg-configuration-heading-row{background:#0003;border-top:1px solid rgba(0,0,0,.2);align-self:center}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row.dcg-configuration-heading-row .dcg-first-column{text-transform:capitalize;font-family:Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif;font-weight:500}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row.dcg-configuration-heading-row .dcg-first-column,.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row.dcg-configuration-heading-row .dcg-second-column{font-size:95%}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row .dcg-latex-error-container{position:absolute;top:3px;right:3px;z-index:1}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row .dcg-disabled-condition-wrapper{padding:6px;color:#949494}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row .dcg-mathquill-condition-container{padding:0;overflow:hidden;position:relative}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row .dcg-mathquill-condition-container .dcg-math-field.dcg-invalid{padding-right:30px}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row .dcg-mathquill-condition-container .dcg-mq-container{width:100%}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row .dcg-mathquill-condition-container .dcg-math-field{width:100%;padding:6px}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row .dcg-mathquill-condition-container .dcg-math-field.dcg-mq-focused{box-shadow:inset 0 0 0 2px #2f72dc!important}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row .dcg-mathquill-condition-container .dcg-mathquill-braille .dcg-tooltip-hit-area-container{width:100%}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row .dcg-mathquill-condition-container .dcg-mathquill-braille .dcg-tooltip-hit-area-container .dcg-braille-input{width:100%;padding:7px}.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row .dcg-mathquill-condition-container .dcg-mathquill-braille .dcg-tooltip-hit-area-container .dcg-braille-input:focus{box-shadow:inset 0 0 0 2px #2f72dc!important}@media screen and (max-width: 480px){.dcg-calculator-api-container-v1_10 .dcg-custom-toolbar-settings-modal .dcg-configuration-grid-row{display:grid;grid-template-columns:1fr 1fr}}@keyframes dcgSharedFadeInDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1}}@keyframes dcgSharedFadeIn{0%{opacity:0}to{opacity:1}}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container{--dcg-modal-margin: 80px ;--dcg-modal-padding: 30px;--dcg-modal-title-spacing: 16px}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover{position:fixed;top:0;left:0;width:100%;height:100%;z-index:100}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover .dcg-shared-modal-background{position:absolute;top:0;right:0;bottom:0;left:0;background:#000000b3}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover .dcg-shared-modal-transition-container{display:flex;justify-content:center}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover .dcg-shared-modal{position:relative}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-wide .dcg-shared-modal,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-medium .dcg-shared-modal,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-narrow .dcg-shared-modal,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-tiny .dcg-shared-modal{animation:dcgSharedFadeInDown .3s}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-wide .dcg-shared-modal-transition-container,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-medium .dcg-shared-modal-transition-container,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-narrow .dcg-shared-modal-transition-container,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-tiny .dcg-shared-modal-transition-container{margin-top:var(--dcg-modal-margin)}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-wide .dcg-shared-modal-contents-wrapper,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-medium .dcg-shared-modal-contents-wrapper,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-narrow .dcg-shared-modal-contents-wrapper,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-tiny .dcg-shared-modal-contents-wrapper{max-height:calc(100vh - 2 * var(--dcg-modal-margin));overflow-y:auto}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-background,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-fullscreen .dcg-shared-modal{animation:dcgSharedFadeIn .3s}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-wide .dcg-shared-modal{width:800px}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-medium .dcg-shared-modal{width:650px}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-narrow .dcg-shared-modal{width:500px}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-tiny .dcg-shared-modal{width:400px}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-fullscreen .dcg-shared-modal{position:absolute;inset:var(--dcg-modal-margin)}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-fullscreen .dcg-shared-modal .dcg-shared-modal-contents-wrapper{overflow-y:auto;overflow-x:hidden;position:absolute;top:0;right:0;bottom:0;left:0}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover .dcg-shared-close-cross-container{position:absolute;top:-28px;right:-28px}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover .dcg-shared-close-cross{font-size:110%;width:32px;height:32px;border-radius:50%;color:#fff;opacity:.9;display:flex;align-items:center;justify-content:center}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover .dcg-shared-close-cross.dcg-hovered{opacity:1;background:#ffffff26}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover .dcg-shared-close-cross.dcg-depressed{opacity:1;background:#ffffff4d}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover .dcg-shared-modal-contents-wrapper{padding:var(--dcg-modal-padding);background-color:#fff;border-radius:6px;box-shadow:0 0 10px #00000080}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover .dcg-shared-modal-title{display:flex;align-items:stretch;margin:0 0 10px;font-weight:400;font-size:24px;text-align:center}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover .dcg-shared-modal-title.dcg-shared-modal-title--sticky{position:sticky;z-index:1;top:-1px;transform-style:preserve-3d;margin-bottom:calc(var(--dcg-modal-title-spacing) / 2);padding:0;padding-bottom:calc(var(--dcg-modal-title-spacing) / 2)}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover .dcg-shared-modal-title.dcg-shared-modal-title--sticky:before{content:"";position:absolute;top:calc(var(--dcg-modal-padding) * -1);left:calc(var(--dcg-modal-padding) * -1);transform:translateZ(-1px);width:calc(100% + 2 * var(--dcg-modal-padding));height:calc(100% + var(--dcg-modal-padding));background-color:#fff}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover .dcg-shared-modal-title.dcg-shared-modal-title--sticky.dcg-shared-modal-title--stuck:before{box-shadow:0 1px 2px #0000000d}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover .dcg-shared-left-align-title{text-align:left}.dcg-calculator-api-container-v1_10 .dcg-shared-back-button{position:relative;top:2px;border:unset;padding:0 4px 0 0;margin-right:6px;background-color:unset}.dcg-calculator-api-container-v1_10 .dcg-shared-back-button.dcg-hovered .dcg-shared-back-button__icon,.dcg-calculator-api-container-v1_10 .dcg-shared-back-button.dcg-focus-visible .dcg-shared-back-button__icon{color:#454545}.dcg-calculator-api-container-v1_10 .dcg-shared-back-button__icon{font-size:18px;color:#bbb}@media screen and (max-width: 850px){.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-wide .dcg-shared-modal{width:auto;margin:0;position:absolute;top:var(--dcg-modal-margin);left:37px;right:37px}}@media screen and (max-width: 700px){.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-medium .dcg-shared-modal{width:auto;margin:0;position:absolute;top:var(--dcg-modal-margin);left:37px;right:37px}}@media screen and (max-width: 600px){.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover:not(.dcg-shared-modal-tiny) .dcg-shared-modal-background{background-color:#333}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover.dcg-shared-modal-wide .dcg-shared-modal-transition-container,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover.dcg-shared-modal-medium .dcg-shared-modal-transition-container,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover.dcg-shared-modal-narrow .dcg-shared-modal-transition-container{margin-top:0}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover .dcg-shared-modal-transition-container{height:100%}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover.dcg-shared-modal-wide .dcg-shared-modal,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover.dcg-shared-modal-fullscreen .dcg-shared-modal,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover.dcg-shared-modal-medium .dcg-shared-modal,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover.dcg-shared-modal-narrow .dcg-shared-modal{position:absolute;top:42px;inset-inline:0;bottom:0;width:auto;margin:0}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover.dcg-shared-modal-wide .dcg-shared-modal .dcg-shared-close-cross-container,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover.dcg-shared-modal-fullscreen .dcg-shared-modal .dcg-shared-close-cross-container,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover.dcg-shared-modal-medium .dcg-shared-modal .dcg-shared-close-cross-container,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover.dcg-shared-modal-narrow .dcg-shared-modal .dcg-shared-close-cross-container{right:5px;top:-38px}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover.dcg-shared-modal-wide .dcg-shared-modal .dcg-shared-modal-contents-wrapper,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover.dcg-shared-modal-fullscreen .dcg-shared-modal .dcg-shared-modal-contents-wrapper,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover.dcg-shared-modal-medium .dcg-shared-modal .dcg-shared-modal-contents-wrapper,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover.dcg-shared-modal-narrow .dcg-shared-modal .dcg-shared-modal-contents-wrapper{border-radius:0;position:absolute;top:0;right:0;bottom:0;left:0;overflow-y:auto;overflow-x:hidden;max-height:unset}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover:not(.dcg-shared-has-close-button).dcg-shared-modal-wide .dcg-shared-modal,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover:not(.dcg-shared-has-close-button).dcg-shared-modal-fullscreen .dcg-shared-modal,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover:not(.dcg-shared-has-close-button).dcg-shared-modal-medium .dcg-shared-modal,.dcg-calculator-api-container-v1_10 .dcg-shared-modal-container .dcg-shared-modal-cover:not(.dcg-shared-has-close-button).dcg-shared-modal-narrow .dcg-shared-modal{top:0}}@media screen and (max-width: 460px){.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-tiny{--dcg-modal-padding: 20px}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-tiny .dcg-shared-modal-background{background-color:#333}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-tiny .dcg-shared-modal{position:absolute;right:0;bottom:0;left:0;top:42px;width:unset}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-tiny .dcg-shared-modal .dcg-shared-close-cross-container{right:5px;top:-38px}.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover.dcg-shared-modal-tiny .dcg-shared-modal-contents-wrapper{position:absolute;top:0;right:0;bottom:0;left:0;overflow-y:auto;overflow-x:hidden;max-height:unset;border-radius:0}}@media screen and (max-height: 450px) and (orientation: landscape){.dcg-calculator-api-container-v1_10 .dcg-shared-modal-cover{--dcg-modal-margin: 40px}}.dcg-calculator-api-container-v1_10 .dcg-performance-meter{position:absolute;z-index:1;right:0;bottom:0}.dcg-aria-alert{position:absolute;left:-1000px;top:-1000px;width:1px;height:1px;text-align:left;overflow:hidden}@media (prefers-reduced-motion){.dcg-calculator-api-container-v1_10 *,.dcg-calculator-api-container-v1_10 *:after,.dcg-calculator-api-container-v1_10 *:before{transition:none!important;animation-duration:0ms!important;animation-delay:0ms!important}}.dcg-calculator-api-container-v1_10 .dcg-calc-basic-main-wrapper{height:100%;width:100%;position:relative}.dcg-calculator-api-container-v1_10 .dcg-calc-basic-main{height:100%;width:100%;background:var(--dcg-custom-background-color, #fff);color:var(--dcg-custom-text-color, #000);display:flex;flex-direction:column;flex-wrap:nowrap;border-radius:2px;font-family:Arial,sans-serif}.dcg-calculator-api-container-v1_10 .dcg-calc-basic-main *{box-sizing:border-box}.dcg-calculator-api-container-v1_10 .dcg-calc-basic-main.dcg-no-hyperlinks a[target=_blank]{display:none!important}@keyframes dcg-fadePulse{0%{opacity:0;transform:scale(.7)}50%{transform:scale(1.1)}to{opacity:1;transform:scale(1)}}.dcg-calculator-api-container-v1_10 .dcg-basic-list-container{flex:1;display:flex;flex-direction:column;overflow:auto;border-top:1px solid rgba(0,0,0,.2)}.dcg-calculator-api-container-v1_10 .dcg-basic-list-container .dcg-basic-list{width:100%}.dcg-calculator-api-container-v1_10 .dcg-basic-list-container .dcg-basic-list.dcg-projector-mode{font-size:150%}.dcg-calculator-api-container-v1_10 .dcg-basic-list-container .dcg-basic-list.dcg-projector-mode .dcg-braille-input input,.dcg-calculator-api-container-v1_10 .dcg-basic-list-container .dcg-basic-list.dcg-projector-mode .dcg-braille-evaluation input{font-size:135%}.dcg-calculator-api-container-v1_10 .dcg-basic-list-container .dcg-basic-list-placeholder{flex:1;border-right:1px solid rgba(0,0,0,.2);border-left:1px solid rgba(0,0,0,.2);position:relative;overflow:hidden}.dcg-calculator-api-container-v1_10 .dcg-basic-list-container .dcg-basic-list-placeholder .dcg-answer-hint{transition:opacity 1s;padding:10px 30px 10px 10px;width:200px;opacity:.7;position:absolute;bottom:0;right:0;text-align:right;animation:dcg-fadePulse .3s}.dcg-calculator-api-container-v1_10 .dcg-basic-list-container .dcg-basic-list-placeholder .dcg-answer-hint i{position:absolute;bottom:10px;right:-5px;font-size:2rem;color:#949494}.dcg-calculator-api-container-v1_10 .dcg-inverted-colors .dcg-settings-dropdown .dcg-popover-interior{box-shadow:none}@media screen and (max-height: 350px){.dcg-calculator-api-container-v1_10 .dcg-basic-list-container .dcg-basic-list-placeholder .dcg-answer-hint{width:100%}}@keyframes dcg-fadeIn{0%{opacity:0}to{opacity:1}}@keyframes dcg-delayed-fadeIn{0%{opacity:0}80%{opacity:0}to{opacity:1}}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-basic-expression .dcg-mq-container .dcg-mq-editable-field{width:100%}.dcg-calculator-api-container-v1_10 .dcg-container .dcg-basic-expression .dcg-mq-container .dcg-mq-editable-field:after{position:absolute;top:1px;right:0;bottom:1px}.dcg-calculator-api-container-v1_10 .dcg-basic-expression{min-height:56px;border:1px solid rgba(0,0,0,.2);margin-top:-1px;position:relative;display:flex;align-items:center;width:100%}.dcg-calculator-api-container-v1_10 .dcg-basic-expression:not(:first-of-type){border-top-color:transparent}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-focused{border-color:#2f72dc;box-shadow:inset 0 0 0 1px #2f72dc;z-index:1}.dcg-calculator-api-container-v1_10 .dcg-basic-expression:first-of-type{margin-top:0}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-exp-output-container{padding-right:5px}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-exp-output-container .dcg-tooltipped-error-container{margin-right:5px}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io{flex-wrap:wrap;padding:2px}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io input{background:transparent}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-mq-math-mode{padding:0}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-braille-input input,.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-braille-evaluation input,.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-braille-error input{border:none;width:100%}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-braille-error{padding-right:5px}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-braille-input input{outline:none}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-braille-evaluation input:focus{outline:1px dotted #000}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-braille-error input{border:1px solid transparent}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-braille-error input:focus{color:#000;outline:1px dotted #000}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-braille-input input,.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-braille-evaluation input{font-family:Abraham,serif;font-size:163%;padding:8px 8px 0}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-basic-expression-error{font-size:140%}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-braille-error{position:absolute;top:-.8em;right:0;width:100%}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-braille-error textarea{width:100%;text-align:right;color:#666;font-size:80%;border:none;resize:none;animation:dcg-delayed-fadeIn 1s}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-braille-error textarea:focus{outline:dotted 1px #666;color:#000}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-braille-input,.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-braille-evaluation-container,.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-exp-mathquill-container,.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-exp-output-container{flex:1 1 40%}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-braille-evaluation-container{position:relative}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-braille-evaluation input,.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-exp-output-container,.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-braille-error{text-align:right}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-exp-mathquill-container{padding:8px}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-exp-mathquill-container,.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-exp-output-container{font-size:90%;color:#666}.dcg-calculator-api-container-v1_10 .dcg-basic-expression.dcg-braille-io .dcg-exp-output-container{padding:8px}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-exp-mathquill-container{flex:1;overflow:hidden;margin-right:1px}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-exp-mathquill-container .dcg-mq-container{width:100%}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-mq-math-mode{padding:12px 5px 12px 15px;outline:none!important;box-shadow:none!important;border:0}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-basic-expression-error{color:#e66b3c;font-size:130%}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-basic-expression-value{animation:dcg-fadeIn .5s}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-basic-expression-value.dcg-basic-evaluation-gray .dcg-static-mathquill-view{color:#666}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-basic-expression-value .dcg-basic-fraction-toggle{font-size:20px;display:inline-block;width:29px;height:29px;border:2px solid #000;opacity:.5;color:#000;text-align:center;border-radius:50%;margin:0 5px}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-basic-expression-value .dcg-basic-fraction-toggle i{position:relative;top:2px}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-basic-expression-value .dcg-basic-fraction-toggle.dcg-hovered{opacity:.7}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-basic-expression-value .dcg-basic-fraction-toggle.dcg-depressed{opacity:.9}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-basic-expression-value .dcg-basic-fraction-toggle.dcg-selected{background:#000;opacity:.5;color:#fff}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-basic-expression-value .dcg-basic-fraction-toggle.dcg-selected.dcg-hovered{opacity:.7}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-basic-expression-value .dcg-basic-fraction-toggle.dcg-selected.dcg-depressed{opacity:.9}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-slider-container{height:40px;width:250px;max-width:100%;padding-right:3px}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-mq-ans{border:2px solid #2f72dc;color:#2f72dc;background-color:#2f72dc26;padding:.2em .4em;display:inline-block;border-radius:4px;margin-right:1px;margin-bottom:2px;min-width:30px;text-align:center;text-overflow:ellipsis;vertical-align:middle;position:relative}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-mq-ans sup{font-size:80%}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-mq-ans:after{box-sizing:border-box;content:"ans";position:absolute;bottom:-.5em;left:50%;font-size:60%;width:1.9em;overflow:hidden;text-align:center;margin-left:-.95em;color:#2f72dc;border:1px solid #2f72dc;background:#fff;padding:0;border-radius:3px;height:1em;line-height:.9em}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-mq-ans.dcg-invalid{border-color:#e66b3c;background:#e66b3c1a;color:#e66b3c}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-mq-ans.dcg-invalid i{font-style:normal;font-size:80%}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-mq-ans.dcg-invalid:after{color:#e66b3c;border-color:#e66b3c}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-mq-selection .dcg-mq-ans{background:#2f72dc;color:#fff}.dcg-calculator-api-container-v1_10 .dcg-basic-expression .dcg-mq-selection .dcg-mq-ans.dcg-invalid{background:#e66b3c}.dcg-calculator-api-container-v1_10 .dcg-calc-basic-main.dcg-projector-mode .dcg-mq-ans:after{position:absolute;bottom:-.3em;left:50%;height:.9em;line-height:.8em}.dcg-calculator-api-container-v1_10 .dcg-calc-basic-main.dcg-projector-mode .dcg-basic-expression.dcg-braille-io .dcg-braille-error{font-size:90%}.dcg-calculator-api-container-v1_10 .dcg-braille-io-keypad-container{padding-top:4px}.dcg-calculator-api-container-v1_10 .dcg-braille-io-keypad-container .dcg-braille-io-keypad{color:#666;border-top:1px solid rgba(0,0,0,.2);padding:10px;display:flex}.dcg-calculator-api-container-v1_10 .dcg-braille-io-keypad-container .dcg-braille-io-keypad a{color:#2f72dc}.dcg-calculator-api-container-v1_10 .dcg-braille-io-keypad-container .dcg-braille-io-keypad a.dcg-hovered{color:#2253a1}.dcg-calculator-api-container-v1_10 .dcg-braille-io-keypad-container .dcg-braille-io-keypad a.dcg-depressed{color:#17396e}.dcg-calculator-api-container-v1_10 .dcg-braille-io-keypad-container .dcg-braille-io-keypad .dcg-braille-examples-table-container{color:#454545;padding:10px 10px 0}.dcg-calculator-api-container-v1_10 .dcg-braille-io-keypad-container .dcg-braille-io-keypad .dcg-braille-examples-table-container .dcg-more-examples-link{text-align:center}.dcg-calculator-api-container-v1_10 .dcg-braille-io-keypad-container .dcg-braille-io-keypad .dcg-braille-examples-table-container table{margin-bottom:10px;border:1px solid rgba(0,0,0,.2)}.dcg-calculator-api-container-v1_10 .dcg-braille-io-keypad-container .dcg-braille-io-keypad .dcg-braille-examples-table-container table th{background:#00000012}.dcg-calculator-api-container-v1_10 .dcg-braille-io-keypad-container .dcg-braille-io-keypad .dcg-braille-description{flex:1;display:flex;padding:10px 0 10px 10px}.dcg-calculator-api-container-v1_10 .dcg-braille-io-keypad-container .dcg-braille-io-keypad .dcg-braille-description .dcg-braille-title{font-size:130%;color:#333}.dcg-calculator-api-container-v1_10 .dcg-braille-io-keypad-container .dcg-braille-io-keypad .dcg-braille-description .dcg-braille-info-text{font-size:95%;margin-bottom:10px;line-height:1.2em}.dcg-calculator-api-container-v1_10 .dcg-braille-io-keypad-container .dcg-braille-io-keypad .dcg-braille-description .dcg-btn-blue{padding:0 12px}.dcg-calculator-api-container-v1_10 .dcg-scientific-calculator .dcg-braille-io-keypad .dcg-braille-description,.dcg-calculator-api-container-v1_10 .dcg-four-function-calculator .dcg-braille-io-keypad .dcg-braille-description{flex-direction:column}.dcg-calculator-api-container-v1_10 .dcg-scientific-calculator .dcg-braille-io-keypad .dcg-braille-description .dcg-braille-title,.dcg-calculator-api-container-v1_10 .dcg-four-function-calculator .dcg-braille-io-keypad .dcg-braille-description .dcg-braille-title{margin-bottom:10px}.dcg-calculator-api-container-v1_10 .dcg-scientific-calculator .dcg-braille-io-keypad .dcg-braille-description .dcg-btn-blue,.dcg-calculator-api-container-v1_10 .dcg-four-function-calculator .dcg-braille-io-keypad .dcg-braille-description .dcg-btn-blue{margin-right:auto}.dcg-calculator-api-container-v1_10 .dcg-narrow.dcg-calc-basic-main-wrapper .dcg-braille-io-keypad{flex-direction:column;text-align:center;align-items:center}.dcg-calculator-api-container-v1_10 .dcg-narrow.dcg-calc-basic-main-wrapper .dcg-braille-io-keypad .dcg-braille-description{flex-flow:row wrap;justify-content:center;align-items:center;padding:10px}.dcg-calculator-api-container-v1_10 .dcg-narrow.dcg-calc-basic-main-wrapper .dcg-braille-io-keypad .dcg-braille-description .dcg-braille-title{margin:0 10px}.dcg-calculator-api-container-v1_10 .dcg-narrow.dcg-calc-basic-main-wrapper .dcg-braille-io-keypad .dcg-braille-description .dcg-btn-blue{order:1;margin-right:0}.dcg-calculator-api-container-v1_10 .dcg-narrow.dcg-calc-basic-main-wrapper .dcg-braille-io-keypad .dcg-braille-description .dcg-braille-info-text{order:2;width:100%;margin:5px 0 0}.dcg-calculator-api-container-v1_10 .dcg-narrow.dcg-calc-basic-main-wrapper .dcg-braille-io-keypad .dcg-braille-examples-table-container th,.dcg-calculator-api-container-v1_10 .dcg-narrow.dcg-calc-basic-main-wrapper .dcg-braille-io-keypad .dcg-braille-examples-table-container td{padding:2px 5px}.dcg-calculator-api-container-v1_10 .dcg-narrow.dcg-calc-basic-main-wrapper .dcg-braille-io-keypad .dcg-braille-examples-table-container tr:nth-of-type(3){display:none}.dcg-calculator-api-container-v1_10 .dcg-short.dcg-calc-basic-main-wrapper .dcg-braille-io-keypad{height:170px;padding:3px}.dcg-calculator-api-container-v1_10 .dcg-short.dcg-calc-basic-main-wrapper .dcg-braille-io-keypad .dcg-braille-examples-table-container table{margin-bottom:5px}.dcg-calculator-api-container-v1_10 .dcg-short.dcg-calc-basic-main-wrapper .dcg-braille-io-keypad .dcg-braille-examples-table-container tr:last-of-type{display:none}.dcg-calculator-api-container-v1_10 .dcg-short.dcg-narrow.dcg-calc-basic-main-wrapper .dcg-braille-io-keypad{font-size:90%}.dcg-calculator-api-container-v1_10 .dcg-short.dcg-narrow.dcg-calc-basic-main-wrapper .dcg-braille-io-keypad .dcg-braille-description{padding-bottom:5px}.dcg-calculator-api-container-v1_10 .dcg-short.dcg-narrow.dcg-calc-basic-main-wrapper .dcg-braille-io-keypad .dcg-braille-description .dcg-btn-blue{padding:5px 8px}.dcg-calculator-api-container-v1_10 .dcg-short.dcg-narrow.dcg-calc-basic-main-wrapper .dcg-braille-io-keypad .dcg-more-examples-link{display:none}.dcg-calculator-api-container-v1_10 .dcg-short.dcg-narrow.dcg-calc-basic-main-wrapper .dcg-braille-io-keypad .dcg-braille-examples-table-container{padding-top:0}.dcg-calculator-api-container-v1_10 .dcg-short.dcg-narrow.dcg-calc-basic-main-wrapper .dcg-braille-io-keypad .dcg-braille-examples-table-container td{height:35px}.dcg-calculator-api-container-v1_10 table.dcg-braille-examples-table{border-collapse:collapse}.dcg-calculator-api-container-v1_10 table.dcg-braille-examples-table tr:not(:last-of-type){border-bottom:1px solid rgba(0,0,0,.2)}.dcg-calculator-api-container-v1_10 table.dcg-braille-examples-table th{font-family:Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif;font-weight:500}.dcg-calculator-api-container-v1_10 table.dcg-braille-examples-table th,.dcg-calculator-api-container-v1_10 table.dcg-braille-examples-table td{padding:5px 8px}.dcg-calculator-api-container-v1_10 table.dcg-braille-examples-table th:not(:last-of-type),.dcg-calculator-api-container-v1_10 table.dcg-braille-examples-table td:not(:last-of-type){border-right:1px solid rgba(0,0,0,.2)}.dcg-calculator-api-container-v1_10 table.dcg-braille-examples-table th:not(:first-of-type),.dcg-calculator-api-container-v1_10 table.dcg-braille-examples-table td:not(:first-of-type){text-align:center}.dcg-calculator-api-container-v1_10 table.dcg-braille-examples-table td{height:45px}.dcg-calculator-api-container-v1_10 table.dcg-braille-examples-table .dcg-braille-font{font-family:Abraham;font-size:110%}.dcg-calculator-api-container-v1_10 table.dcg-braille-examples-table .dcg-key-press{border:1px solid rgba(0,0,0,.2);background:#fff9;border-radius:3px;width:25px;height:25px;line-height:23px;text-align:center;display:inline-block;margin-right:2px;vertical-align:middle}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-bar{height:40px;background-color:#00000012;border-left:1px solid rgba(0,0,0,.2);border-right:1px solid rgba(0,0,0,.2)}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-bar .dcg-keypad-control-bar-contents{display:flex;flex-flow:row nowrap;align-items:stretch;flex-shrink:0;padding-top:2px}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-bar .dcg-spacer{flex-grow:1}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-bar .dcg-spacer-2{flex-grow:2}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-bar .dcg-radiangroup{align-content:center;padding:0 5px}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-bar .dcg-radiangroup .dcg-segmented-control-interior{min-width:42px;font-size:.8rem;text-transform:uppercase}.dcg-calculator-api-container-v1_10 .dcg-calc-basic-main-wrapper:not(.dcg-narrow) .dcg-projector-mode .dcg-keypad-control-bar{height:52px}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-btn{flex-grow:1;min-width:40px;text-align:center;color:var(--dcg-custom-text-color, rgba(0, 0, 0, .6));font-size:.875rem}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-btn.dcg-narrow-control-btn{max-width:80px}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-btn.dcg-selectable-btn{padding:0 5px;height:38px;line-height:40px}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-btn:not(.dcg-selectable-btn){height:32px;line-height:32px;margin:5px;border-radius:5px}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-btn.dcg-disabled{color:#00000026;cursor:default}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-btn:not(.dcg-disabled):not(.dcg-selectable-btn).dcg-hovered{color:var(--dcg-custom-text-color, rgba(0, 0, 0, .8));background:#0000001a}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-btn:not(.dcg-disabled):not(.dcg-selectable-btn).dcg-depressed{color:var(--dcg-custom-text-color, #000);background:#0000002e}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-btn[dcg-command=settings] i{font-size:120%;position:relative;top:1px}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-btn[dcg-command=backspace] i,.dcg-calculator-api-container-v1_10 .dcg-keypad-control-btn[dcg-command=undo] i,.dcg-calculator-api-container-v1_10 .dcg-keypad-control-btn[dcg-command=redo] i{font-size:150%;position:relative;top:3px}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-btn[dcg-command=clear]{width:50px;white-space:nowrap}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-btn[dcg-command=clearall]{width:50px;line-height:inherit;display:flex;align-items:center;justify-content:center}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-bar .dcg-keypad-control-btn:not(.dcg-disabled).dcg-selectable-btn{position:relative}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-bar .dcg-keypad-control-btn:not(.dcg-disabled).dcg-selectable-btn:after{position:absolute;bottom:0;left:0;right:0;content:"";height:0;background:#2f72dc80}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-bar .dcg-keypad-control-btn:not(.dcg-disabled).dcg-selectable-btn.dcg-hovered:not(.dcg-selected){color:var(--dcg-custom-text-color, #000)}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-bar .dcg-keypad-control-btn:not(.dcg-disabled).dcg-selectable-btn.dcg-hovered:not(.dcg-selected):after{height:4px;transition:height .2s}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-bar .dcg-keypad-control-btn:not(.dcg-disabled).dcg-selectable-btn.dcg-selected{color:var(--dcg-custom-text-color, #000)}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-bar .dcg-keypad-control-btn:not(.dcg-disabled).dcg-selectable-btn.dcg-selected:after{height:4px;background:#2f72dc}.dcg-calculator-api-container-v1_10 .dcg-keypad-control-bar .dcg-keypad-control-btn:not(.dcg-disabled).dcg-selectable-btn:first-of-type{margin-left:6px}.dcg-calculator-api-container-v1_10 .dcg-narrow.dcg-calc-basic-main-wrapper .dcg-keypad-control-btn{min-width:25px}.dcg-calculator-api-container-v1_10 .dcg-narrow.dcg-calc-basic-main-wrapper .dcg-keypad-control-btn[dcg-command=clearall],.dcg-calculator-api-container-v1_10 .dcg-narrow.dcg-calc-basic-main-wrapper .dcg-keypad-control-btn[dcg-command=clear]{width:50px}.dcg-calculator-api-container-v1_10 .dcg-calc-basic-main-wrapper:not(.dcg-narrow) .dcg-projector-mode .dcg-keypad-control-btn{font-size:150%;height:44px;line-height:44px}.dcg-calculator-api-container-v1_10 .dcg-calc-basic-main-wrapper:not(.dcg-narrow) .dcg-projector-mode .dcg-radiangroup .dcg-segmented-control-interior{font-size:150%}.dcg-calculator-api-container-v1_10 .dcg-calc-basic-main-wrapper:not(.dcg-narrow) .dcg-projector-mode .dcg-keypad-control-btn[dcg-command=clearall],.dcg-calculator-api-container-v1_10 .dcg-calc-basic-main-wrapper:not(.dcg-narrow) .dcg-projector-mode .dcg-keypad-control-btn[dcg-command=clear]{width:75px}.dcg-calculator-api-container-v1_10 .dcg-calc-basic-main-wrapper:not(.dcg-narrow) .dcg-projector-mode .dcg-keypad-control-btn[dcg-command=clearall]{line-height:20px}.dcg-calculator-api-container-v1_10 .dcg-calc-basic-main-wrapper:not(.dcg-narrow) .dcg-projector-mode .dcg-keypad-control-btn[dcg-command=settings] i{top:4px}.dcg-calculator-api-container-v1_10 .dcg-calc-basic-main-wrapper:not(.dcg-narrow) .dcg-projector-mode .dcg-keypad-control-btn[dcg-command=backspace] i,.dcg-calculator-api-container-v1_10 .dcg-calc-basic-main-wrapper:not(.dcg-narrow) .dcg-projector-mode .dcg-keypad-control-btn[dcg-command=undo] i,.dcg-calculator-api-container-v1_10 .dcg-calc-basic-main-wrapper:not(.dcg-narrow) .dcg-projector-mode .dcg-keypad-control-btn[dcg-command=redo] i{top:5px}.dcg-calculator-api-container-v1_10 .dcg-calc-basic-main-wrapper:not(.dcg-narrow) .dcg-projector-mode .dcg-selectable-btn{top:4px}.dcg-calculator-api-container-v1_10 .dcg-basic-settings-container{position:relative;flex-grow:1}.dcg-calculator-api-container-v1_10 .dcg-basic-settings-container .dcg-keypad-control-btn.dcg-selected{color:#333;background:#0000001a}.dcg-calculator-api-container-v1_10 .dcg-settings-dropdown{font-size:95%;color:#333;width:280px;position:absolute;bottom:50px;right:5px;-webkit-user-select:none;user-select:none}.dcg-calculator-api-container-v1_10 .dcg-settings-dropdown .dcg-popover-interior{display:flex;flex-direction:column;gap:10px}.dcg-calculator-api-container-v1_10 .dcg-settings-dropdown .dcg-settings-menu-option{cursor:pointer}.dcg-calculator-api-container-v1_10 .dcg-settings-dropdown .dcg-settings-menu-option .dcg-disabled{cursor:default}.dcg-calculator-api-container-v1_10 .dcg-settings-dropdown .dcg-displaysize-large{font-size:150%}.dcg-calculator-api-container-v1_10 .dcg-settings-dropdown .dcg-braille-container{padding-left:26px}.dcg-calculator-api-container-v1_10 .dcg-settings-dropdown .dcg-braille-container .dcg-braille-options-buttons{margin-top:10px}.dcg-calculator-api-container-v1_10 .dcg-settings-dropdown .dcg-complex-container{border-top:1px solid #e2e2e2;padding-top:10px}.dcg-calculator-api-container-v1_10 .dcg-settings-dropdown.dcg-popover .dcg-popover-interior{padding:10px;background-color:var(--dcg-custom-background-color, #fff);color:var(--dcg-custom-text-color, #000)}.dcg-calculator-api-container-v1_10 .dcg-settings-dropdown.dcg-popover .dcg-popover-interior:after{content:"";position:absolute;bottom:-7px;right:18px;border-width:7px;border-bottom-width:0;border-style:solid;border-color:var(--dcg-custom-background-color, #fff) transparent transparent;line-height:0}.dcg-calculator-api-container-v1_10 .dcg-settings-dropdown.dcg-popover .dcg-popover-interior:before{content:"";position:absolute;bottom:-8px;right:17px;border-width:8px;border-bottom-width:0;border-style:solid;border-color:#bbb transparent transparent;line-height:0}.dcg-calculator-api-container-v1_10 .dcg-settings-dropdown.dcg-point-left{position:absolute;top:-30px;left:-280px}.dcg-calculator-api-container-v1_10 .dcg-settings-dropdown.dcg-point-left.dcg-popover .dcg-popover-interior:after{content:"";position:absolute;right:-7px;top:43px;border-width:7px;border-right-width:0;border-style:solid;border-color:transparent transparent transparent var(--dcg-custom-background-color, #fff);line-height:0}.dcg-calculator-api-container-v1_10 .dcg-settings-dropdown.dcg-point-left.dcg-popover .dcg-popover-interior:before{content:"";position:absolute;right:-8px;top:42px;border-width:8px;border-right-width:0;border-style:solid;border-color:transparent transparent transparent #bbb;line-height:0}.dcg-calculator-api-container-v1_10 .dcg-scientific-calculator.dcg-narrow .dcg-settings-dropdown.dcg-popover:not(.dcg-point-left) .dcg-popover-interior:after{right:10px}.dcg-calculator-api-container-v1_10 .dcg-scientific-calculator.dcg-narrow .dcg-settings-dropdown.dcg-popover:not(.dcg-point-left) .dcg-popover-interior:before{right:9px}.dcg-calculator-api-container-v1_10 .dcg-version-number{color:#666;font-size:90%;text-align:center;margin-top:15px}.dcg-calculator-api-container-v1_10 .dcg-download-button.dcg-disabled{pointer-events:none}.dcg-calculator-api-container-v1_10 .dcg-download-button.dcg-primary-link{display:flex;align-items:center;margin-top:5px}.dcg-calculator-api-container-v1_10 .dcg-download-button.dcg-primary-link span{text-decoration:underline}.dcg-calculator-api-container-v1_10 .dcg-download-button.dcg-primary-link .dcg-icon-download{margin-right:10px}.dcg-calculator-api-container-v1_10 .dcg-narrower .dcg-sci-func-keypad--complex{font-size:80%}
`,document.getElementsByTagName("head")[0].appendChild(elt);var _Desmos;typeof module=="object"&&typeof module.exports=="object"?(_Desmos={},module.exports=_Desmos):(_Desmos=typeof Desmos!="undefined"?Desmos:{},global.Desmos=_Desmos),function(){var Desmos=_Desmos;Desmos.config||(Desmos.config={}),typeof desmosEnabledFeatures=="object"&&(Desmos.enabledFeatures=desmosEnabledFeatures),typeof desmosLocales=="object"&&(Desmos.locales=desmosLocales),typeof desmosLocaleData=="object"&&(Desmos.localeData=desmosLocaleData),Desmos.commit=desmosCommit,Desmos.version=desmosVersion,(()=>{const __dcg_shared_module_source__='// shared.js\n  (() => {\n    const __dcg_chunk_exports__ = {};var AF=Object.create;var sx=Object.defineProperty;var _F=Object.getOwnPropertyDescriptor;var LF=Object.getOwnPropertyNames;var wF=Object.getPrototypeOf,FF=Object.prototype.hasOwnProperty;var _5=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(t,n)=>(typeof require!="undefined"?require:t)[n]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw Error(\'Dynamic require of "\'+e+\'" is not supported\')});var L5=(e,t)=>()=>(e&&(t=e(e=0)),t);var w5=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ia=(e,t)=>{for(var n in t)sx(e,n,{get:t[n],enumerable:!0})},VF=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of LF(t))!FF.call(e,s)&&s!==n&&sx(e,s,{get:()=>t[s],enumerable:!(r=_F(t,s))||r.enumerable});return e};var F5=(e,t,n)=>(n=e!=null?AF(wF(e)):{},VF(t||!e||!e.__esModule?sx(n,"default",{value:e,enumerable:!0}):n,e));var V5=(()=>{for(var e=new Uint8Array(128),t=0;t<64;t++)e[t<26?t+65:t<52?t+71:t<62?t-4:t*4-205]=t;return n=>{for(var r=n.length,s=new Uint8Array((r-(n[r-1]=="=")-(n[r-2]=="="))*3/4|0),i=0,o=0;i<r;){var a=e[n.charCodeAt(i++)],u=e[n.charCodeAt(i++)],c=e[n.charCodeAt(i++)],l=e[n.charCodeAt(i++)];s[o++]=a<<2|u>>4,s[o++]=u<<4|c>>2,s[o++]=c<<6|l}return s}})();var Z1=function(){{let e=function(){},t=["log","info","warn","error","assert","dir","clear","profile","profileEnd","time","timeEnd","group","groupCollapsed","groupEnd","trace"],n={},r=function(s){typeof window!="undefined"&&window.console&&window.console[s]?n[s]=function(){Function.prototype.apply.call(window.console[s],window.console,arguments)}:n[s]=e};return t.forEach(r),n}}(),G5=Z1,{log:k5,warn:H5,error:z5,assert:U5,dir:q5,clear:$5,profile:Y5,profileEnd:X5,time:Z5,timeEnd:W5,group:j5,groupCollapsed:J5,groupEnd:Q5,trace:K5}=Z1;var Oo={};ia(Oo,{DEFAULT_COMPLEX_EVALUATION_LABEL_OPTIONS:()=>yx,DEFAULT_EVALUATION_LABEL_OPTIONS:()=>CD,canDisplayAsFraction:()=>SD,complexNumberLabel:()=>Ic,complexPlainMathNumberLabel:()=>gx,formatSymbol:()=>X,identifierToHTML:()=>OV,identifierToLatex:()=>qr,latexToIdentifier:()=>no,numericLabel:()=>Zm,point:()=>PV,trimLatex:()=>oa,truncatedHTMLLabel:()=>vD,truncatedLatexLabel:()=>kl,truncatedPlainmathLabel:()=>Gl,value:()=>fx});function W1(e,t,n){if(e=_l(e),n>0){let r=_l(t);return e<r&&(e+=2*Math.PI),(e-r)/n}else{let r=_l(t+n);return e<r&&(e+=2*Math.PI),1+(e-r)/n}}function Bm(e,t,n){e=_l(e);let r=_l(t),s=_l(t+n);if(n<0){let i=r;r=s,s=i}return r<s?r<=e&&e<=s:r<=e||e<=s}function _l(e){let t=2*Math.PI;return(e%t+t)%t}function tY(e,t){if(!(isNaN(e)||isNaN(t)))return e>=0?Math.atan(t/e):Math.atan(t/e)+Math.PI}var Oi=Math.hypot;function Va(e,t){return e>0==t>0?e+.5*(t-e):.5*(e+t)}function GF(e,t,n,r,s,i){return e*r+t*s+n*i}function to(e,t,n,r,s,i,o,a,u){let c=Oi(o-r,a-s,u-i);return c===0?0:GF((e-r)/c,(t-s)/c,(n-i)/c,(o-r)/c,(a-s)/c,(u-i)/c)}function kF(e,t,n,r,s,i){let o=to(e,t,0,n,r,0,s,i,0);return o<=0?[n,r]:o>=1?[s,i]:[n+o*(s-n),r+o*(i-r)]}function HF(e,t,n,r,s,i,o,a,u){let c=to(e,t,n,r,s,i,o,a,u);return c<=0?[r,s,i]:c>=1?[o,a,u]:[r+c*(o-r),s+c*(a-s),i+c*(u-i)]}function rY(e,t,n,r,s,i,o,a){let u=to(e,t,0,n,r,0,s,i,0);return u<=0&&!o?[n,r]:u>=1&&!a?[s,i]:[n+u*(s-n),r+u*(i-r)]}function j1(e,t,n,r,s,i){let o=kF(e,t,n,r,s,i);return Oi(e-o[0],t-o[1])}function J1(e,t,n,r,s,i,o,a,u){let c=HF(e,t,n,r,s,i,o,a,u);return Oi(e-c[0],t-c[1],n-c[2])}function sY(e,t,n,r,s,i,o){let a=Math.atan2(t-r,e-n);if(Bm(a,i,o-i))return[s*Math.cos(a)+n,s*Math.sin(a)+r]}function si(e,t,n=1){if(e===t)return!0;if(!isFinite(e)||!isFinite(t))return!1;if(n>50)throw new Error("Within "+(52-n)+" bits isn\'t really approximate any more");let r=Math.max(Math.max(Math.abs(e),Math.abs(t)),1),s=n===1?.5:Math.pow(.5,n);return r===r+s*Math.abs(t-e)}function iY(e){return Math.round(e-.5)+.5}function Ba(e,t=1e6){if(e===1/0)return{n:1/0,d:1};if(e===-1/0)return{n:-1/0,d:1};if(!isFinite(e))return{n:NaN,d:1};let n,r=0,s=1,i=1,o=0,a,u;for(;n=Math.floor(e),a=n*s+r,u=n*o+i,!(u>t||(r=s,i=o,s=a,o=u,e===n));)e=1/(e-n);return{n:s,d:o}}var Gm=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},zm=Array.prototype,ax=Object.prototype,Q1=typeof Symbol!="undefined"?Symbol.prototype:null,aY=zm.push,sD=zm.slice,km=ax.toString,zF=ax.hasOwnProperty,UF=Array.isArray,K1=Object.keys,eD=Object.create,iD=Gm.isNaN,qF=Gm.isFinite,ix=function(){};function Nr(e){if(e instanceof Nr)return e;if(!(this instanceof Nr))return new Nr(e);this._wrapped=e}var uY=Nr.VERSION="1.10.2";function Um(e,t,n){if(t===void 0)return e;switch(n==null?3:n){case 1:return function(r){return e.call(t,r)};case 3:return function(r,s,i){return e.call(t,r,s,i)};case 4:return function(r,s,i,o){return e.call(t,r,s,i,o)}}return function(){return e.apply(t,arguments)}}function oD(e,t,n){return e==null?bV:Ga(e)?Um(e,t,n):Bl(e)&&!Vl(e)?xV(e):bD(e)}Nr.iteratee=aD;function aD(e,t){return oD(e,t,1/0)}function vo(e,t,n){return Nr.iteratee!==aD?Nr.iteratee(e,t):oD(e,t,n)}function Ni(e,t){return t=t==null?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),r=Array(n),s=0;s<n;s++)r[s]=arguments[s+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r);case 2:return e.call(this,arguments[0],arguments[1],r)}var i=Array(t+1);for(s=0;s<t;s++)i[s]=arguments[s];return i[t]=r,e.apply(this,i)}}function $F(e){if(!Bl(e))return{};if(eD)return eD(e);ix.prototype=e;var t=new ix;return ix.prototype=null,t}function uD(e){return function(t){return t==null?void 0:t[e]}}function wl(e,t){return e!=null&&zF.call(e,t)}function cD(e,t){for(var n=t.length,r=0;r<n;r++){if(e==null)return;e=e[t[r]]}return n?e:void 0}var YF=Math.pow(2,53)-1,du=uD("length");function Ri(e){var t=du(e);return typeof t=="number"&&t>=0&&t<=YF}function Fl(e,t,n){t=Um(t,n);var r,s;if(Ri(e))for(r=0,s=e.length;r<s;r++)t(e[r],r,e);else{var i=gi(e);for(r=0,s=i.length;r<s;r++)t(e[i[r]],i[r],e)}return e}function qm(e,t,n){t=vo(t,n);for(var r=!Ri(e)&&gi(e),s=(r||e).length,i=Array(s),o=0;o<s;o++){var a=r?r[o]:o;i[o]=t(e[a],a,e)}return i}function lD(e){var t=function(n,r,s,i){var o=!Ri(n)&&gi(n),a=(o||n).length,u=e>0?0:a-1;for(i||(s=n[o?o[u]:u],u+=e);u>=0&&u<a;u+=e){var c=o?o[u]:u;s=r(s,n[c],c,n)}return s};return function(n,r,s,i){var o=arguments.length>=3;return t(n,Um(r,i,4),s,o)}}var cY=lD(1),lY=lD(-1);function XF(e,t,n){var r=[];return t=vo(t,n),Fl(e,function(s,i,o){t(s,i,o)&&r.push(s)}),r}function pY(e,t,n){t=vo(t,n);for(var r=!Ri(e)&&gi(e),s=(r||e).length,i=0;i<s;i++){var o=r?r[i]:i;if(!t(e[o],o,e))return!1}return!0}function dY(e,t,n){t=vo(t,n);for(var r=!Ri(e)&&gi(e),s=(r||e).length,i=0;i<s;i++){var o=r?r[i]:i;if(t(e[o],o,e))return!0}return!1}function Ll(e,t,n,r){return Ri(e)||(e=Md(e)),(typeof n!="number"||r)&&(n=0),eV(e,t,n)>=0}var fY=Ni(function(e,t,n){var r,s;return Ga(t)?s=t:Vl(t)&&(r=t.slice(0,-1),t=t[t.length-1]),qm(e,function(i){var o=s;if(!o){if(r&&r.length&&(i=cD(i,r)),i==null)return;o=i[t]}return o==null?o:o.apply(i,n)})});function pD(e,t){return qm(e,bD(t))}function ZF(e,t,n){var r=-1/0,s=-1/0,i,o;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=Ri(e)?e:Md(e);for(var a=0,u=e.length;a<u;a++)i=e[a],i!=null&&i>r&&(r=i)}else t=vo(t,n),Fl(e,function(c,l,p){o=t(c,l,p),(o>s||o===-1/0&&r===-1/0)&&(r=c,s=o)});return r}function mY(e,t,n){var r=1/0,s=1/0,i,o;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=Ri(e)?e:Md(e);for(var a=0,u=e.length;a<u;a++)i=e[a],i!=null&&i<r&&(r=i)}else t=vo(t,n),Fl(e,function(c,l,p){o=t(c,l,p),(o<s||o===1/0&&r===1/0)&&(r=c,s=o)});return r}function yY(e){return WF(e,1/0)}function WF(e,t,n){if(t==null||n)return Ri(e)||(e=Md(e)),e[nD(e.length-1)];var r=Ri(e)?cV(e):Md(e),s=du(r);t=Math.max(Math.min(t,s),0);for(var i=s-1,o=0;o<t;o++){var a=nD(o,i),u=r[o];r[o]=r[a],r[a]=u}return r.slice(0,t)}function gY(e,t,n){var r=0;return t=vo(t,n),pD(qm(e,function(s,i,o){return{value:s,index:r++,criteria:t(s,i,o)}}).sort(function(s,i){var o=s.criteria,a=i.criteria;if(o!==a){if(o>a||o===void 0)return 1;if(o<a||a===void 0)return-1}return s.index-i.index}),"value")}function $m(e,t){return function(n,r,s){var i=t?[[],[]]:{};return r=vo(r,s),Fl(n,function(o,a){var u=r(o,a,n);e(i,o,u)}),i}}var hY=$m(function(e,t,n){wl(e,n)?e[n].push(t):e[n]=[t]}),bY=$m(function(e,t,n){e[n]=t}),xY=$m(function(e,t,n){wl(e,n)?e[n]++:e[n]=1});function TY(e){return e==null?0:Ri(e)?e.length:gi(e).length}var IY=$m(function(e,t,n){e[n?0:1].push(t)},!0);function Tc(e,t,n,r){r=r||[];for(var s=r.length,i=0,o=du(e);i<o;i++){var a=e[i];if(Ri(a)&&(Vl(a)||Hm(a)))if(t)for(var u=0,c=a.length;u<c;)r[s++]=a[u++];else Tc(a,t,n,r),s=r.length;else n||(r[s++]=a)}return r}function PY(e,t){return Tc(e,t,!1)}var EY=Ni(function(e,t){return cx(e,t)});function ux(e,t,n,r){hV(t)||(r=n,n=t,t=!1),n!=null&&(n=vo(n,r));for(var s=[],i=[],o=0,a=du(e);o<a;o++){var u=e[o],c=n?n(u,o,e):u;t&&!n?((!o||i!==c)&&s.push(u),i=c):n?Ll(i,c)||(i.push(c),s.push(u)):Ll(s,u)||s.push(u)}return s}var MY=Ni(function(e){return ux(Tc(e,!0,!0))});var cx=Ni(function(e,t){return t=Tc(t,!0,!0),XF(e,function(n){return!Ll(t,n)})});function jF(e){for(var t=e&&ZF(e,du).length||0,n=Array(t),r=0;r<t;r++)n[r]=pD(e,r);return n}var CY=Ni(jF);function dD(e){return function(t,n,r){n=vo(n,r);for(var s=du(t),i=e>0?0:s-1;i>=0&&i<s;i+=e)if(n(t[i],i,t))return i;return-1}}var JF=dD(1),QF=dD(-1);function KF(e,t,n,r){n=vo(n,r,1);for(var s=n(t),i=0,o=du(e);i<o;){var a=Math.floor((i+o)/2);n(e[a])<s?i=a+1:o=a}return i}function fD(e,t,n){return function(r,s,i){var o=0,a=du(r);if(typeof i=="number")e>0?o=i>=0?i:Math.max(i+a,o):a=i>=0?Math.min(i+1,a):i+a+1;else if(n&&i&&a)return i=n(r,s),r[i]===s?i:-1;if(s!==s)return i=t(sD.call(r,o,a),gV),i>=0?i+o:-1;for(i=e>0?o:a-1;i>=0&&i<a;i+=e)if(r[i]===s)return i;return-1}}var eV=fD(1,JF,KF),DY=fD(-1,QF);function SY(e,t){if(t==null||t<1)return[];for(var n=[],r=0,s=e.length;r<s;)n.push(sD.call(e,r,r+=t));return n}function mD(e,t,n,r,s){if(!(r instanceof t))return e.apply(n,s);var i=$F(e.prototype),o=e.apply(i,s);return Bl(o)?o:i}var tV=Ni(function(e,t,n){if(!Ga(e))throw new TypeError("Bind must be called on a function");var r=Ni(function(s){return mD(e,r,t,this,n.concat(s))});return r}),Ym=Ni(function(e,t){var n=Ym.placeholder,r=function(){for(var s=0,i=t.length,o=Array(i),a=0;a<i;a++)o[a]=t[a]===n?arguments[s++]:t[a];for(;s<arguments.length;)o.push(arguments[s++]);return mD(e,r,this,this,o)};return r});Ym.placeholder=Nr;var vY=Ni(function(e,t){t=Tc(t,!1,!1);var n=t.length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=t[n];e[r]=tV(e[r],e)}});var yD=Ni(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)}),OY=Ym(yD,Nr,1);function NY(e,t,n){var r,s,i,o,a=0;n||(n={});var u=function(){a=n.leading===!1?0:rD(),r=null,o=e.apply(s,i),r||(s=i=null)},c=function(){var l=rD();!a&&n.leading===!1&&(a=l);var p=t-(l-a);return s=this,i=arguments,p<=0||p>t?(r&&(clearTimeout(r),r=null),a=l,o=e.apply(s,i),r||(s=i=null)):!r&&n.trailing!==!1&&(r=setTimeout(u,p)),o};return c.cancel=function(){clearTimeout(r),a=0,r=s=i=null},c}function RY(e,t,n){var r,s,i=function(a,u){r=null,u&&(s=e.apply(a,u))},o=Ni(function(a){if(r&&clearTimeout(r),n){var u=!r;r=setTimeout(i,t),u&&(s=e.apply(this,a))}else r=yD(i,t,this,a);return s});return o.cancel=function(){clearTimeout(r),r=null},o}function nV(e){return function(){return!e.apply(this,arguments)}}function rV(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}}var AY=Ym(rV,2),gD=!{toString:null}.propertyIsEnumerable("toString"),tD=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function hD(e,t){var n=tD.length,r=e.constructor,s=Ga(r)&&r.prototype||ax,i="constructor";for(wl(e,i)&&!Ll(t,i)&&t.push(i);n--;)i=tD[n],i in e&&e[i]!==s[i]&&!Ll(t,i)&&t.push(i)}function gi(e){if(!Bl(e))return[];if(K1)return K1(e);var t=[];for(var n in e)wl(e,n)&&t.push(n);return gD&&hD(e,t),t}function lx(e){if(!Bl(e))return[];var t=[];for(var n in e)t.push(n);return gD&&hD(e,t),t}function Md(e){for(var t=gi(e),n=t.length,r=Array(n),s=0;s<n;s++)r[s]=e[t[s]];return r}function sV(e){for(var t={},n=gi(e),r=0,s=n.length;r<s;r++)t[e[n[r]]]=n[r];return t}function px(e,t){return function(n){var r=arguments.length;if(t&&(n=Object(n)),r<2||n==null)return n;for(var s=1;s<r;s++)for(var i=arguments[s],o=e(i),a=o.length,u=0;u<a;u++){var c=o[u];(!t||n[c]===void 0)&&(n[c]=i[c])}return n}}var iV=px(lx),oV=px(gi);function aV(e,t,n){return t in n}var uV=Ni(function(e,t){var n={},r=t[0];if(e==null)return n;Ga(r)?(t.length>1&&(r=Um(r,t[1])),t=lx(e)):(r=aV,t=Tc(t,!1,!1),e=Object(e));for(var s=0,i=t.length;s<i;s++){var o=t[s],a=e[o];r(a,o,e)&&(n[o]=a)}return n}),_Y=Ni(function(e,t){var n=t[0],r;return Ga(n)?(n=nV(n),t.length>1&&(r=t[1])):(t=qm(Tc(t,!1,!1),String),n=function(s,i){return!Ll(t,i)}),uV(e,n,r)}),LY=px(lx,!0);function cV(e){return Bl(e)?Vl(e)?e.slice():iV({},e):e}function lV(e,t){var n=gi(t),r=n.length;if(e==null)return!r;for(var s=Object(e),i=0;i<r;i++){var o=n[i];if(t[o]!==s[o]||!(o in s))return!1}return!0}function ox(e,t,n,r){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var s=typeof e;return s!=="function"&&s!=="object"&&typeof t!="object"?!1:pV(e,t,n,r)}function pV(e,t,n,r){e instanceof Nr&&(e=e._wrapped),t instanceof Nr&&(t=t._wrapped);var s=km.call(e);if(s!==km.call(t))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return Q1.valueOf.call(e)===Q1.valueOf.call(t)}var i=s==="[object Array]";if(!i){if(typeof e!="object"||typeof t!="object")return!1;var o=e.constructor,a=t.constructor;if(o!==a&&!(Ga(o)&&o instanceof o&&Ga(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],r=r||[];for(var u=n.length;u--;)if(n[u]===e)return r[u]===t;if(n.push(e),r.push(t),i){if(u=e.length,u!==t.length)return!1;for(;u--;)if(!ox(e[u],t[u],n,r))return!1}else{var c=gi(e),l;if(u=c.length,gi(t).length!==u)return!1;for(;u--;)if(l=c[u],!(wl(t,l)&&ox(e[l],t[l],n,r)))return!1}return n.pop(),r.pop(),!0}function ws(e,t){return ox(e,t)}function wY(e){return e==null?!0:Ri(e)&&(Vl(e)||dV(e)||Hm(e))?e.length===0:gi(e).length===0}function Ai(e){return function(t){return km.call(t)==="[object "+e+"]"}}var Vl=UF||Ai("Array");function Bl(e){var t=typeof e;return t==="function"||t==="object"&&!!e}var Hm=Ai("Arguments"),Ga=Ai("Function"),dV=Ai("String"),fV=Ai("Number"),FY=Ai("Date"),VY=Ai("RegExp"),BY=Ai("Error"),mV=Ai("Symbol"),GY=Ai("Map"),kY=Ai("WeakMap"),HY=Ai("Set"),zY=Ai("WeakSet");(function(){Hm(arguments)||(Hm=function(e){return wl(e,"callee")})})();var yV=Gm.document&&Gm.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof yV!="function"&&(Ga=function(e){return typeof e=="function"||!1});function UY(e){return!mV(e)&&qF(e)&&!iD(parseFloat(e))}function gV(e){return fV(e)&&iD(e)}function hV(e){return e===!0||e===!1||km.call(e)==="[object Boolean]"}function bV(e){return e}function bD(e){return Vl(e)?function(t){return cD(t,e)}:uD(e)}function xV(e){return e=oV({},e),function(t){return lV(t,e)}}function nD(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}var rD=Date.now||function(){return new Date().getTime()},xD={"&":"&amp;","<":"&lt;",">":"&gt;",\'"\':"&quot;","\'":"&#x27;","`":"&#x60;"},TV=sV(xD);function TD(e){var t=function(i){return e[i]},n="(?:"+gi(e).join("|")+")",r=RegExp(n),s=RegExp(n,"g");return function(i){return i=i==null?"":""+i,r.test(i)?i.replace(s,t):i}}var ID=TD(xD),qY=TD(TV);var IV=0;function $Y(e){var t=++IV+"";return e?e+t:t}var YY=Nr.templateSettings={evaluate:/<%([\\s\\S]+?)%>/g,interpolate:/<%=([\\s\\S]+?)%>/g,escape:/<%-([\\s\\S]+?)%>/g};function PD(e,t){return e._chain?Nr(t).chain():t}Fl(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=zm[e];Nr.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e==="shift"||e==="splice")&&n.length===0&&delete n[0],PD(this,n)}});Fl(["concat","join","slice"],function(e){var t=zm[e];Nr.prototype[e]=function(){return PD(this,t.apply(this._wrapped,arguments))}});Nr.prototype.value=function(){return this._wrapped};Nr.prototype.valueOf=Nr.prototype.toJSON=Nr.prototype.value;Nr.prototype.toString=function(){return String(this._wrapped)};function fx(e,t=e,n=!1){if(isNaN(e)||!isFinite(e))return{string:"undefined",latex:"undefined",value:e};if(e===0)return{string:"0",latex:"0",value:e};Math.abs(e)>Math.abs(t)&&(t=e);let r=Ba(e/Math.PI,24),s,i,o,a,u,c,l=n?DV(t):CV(t);if(l&&si(r.n/r.d*Math.PI,e,3))return r.n===0?(s="0",a="0"):r.n===1?(s="\\u03C0",a="\\\\pi"):r.n===-1?(s="-\\u03C0",a="-\\\\pi"):(s=r.n.toString()+"\\u03C0",a=r.n.toString()+"\\\\pi"),r.d===1?(i="",u=""):(i="/"+r.d.toString(),u=r.d.toString()),o=s+i,u===""?c=a:a[0]==="-"?c=`-\\\\frac{${a.slice(1)}}{${u}}`:c=`\\\\frac{${a}}{${u}}`,{string:o,latex:c,value:r.n/r.d*Math.PI};if(l)return o=MV(ED(e.toFixed(dx(t)))),{string:o,latex:o,value:parseFloat(o)};{let p=mx(e.toExponential(dx(t/e))).split("e"),f=p[0]==="1"&&n?"10":p[0]+"\\xD710",d=p[1].replace("+","");return o=mx(e.toExponential(dx(t/e))).replace("+",""),c=`${p[0]}\\\\times10^{${d}}`,{string:o,latex:c,mantissa:f,superscript:d,value:parseFloat(o)}}}function PV(e,t,n,r){let s=fx(e,t),i=fx(r(s.value),n);return[s,i]}var EV=/\\.?0+$/;function ED(e){return e.indexOf(".")===-1?e:e.replace(EV,"")}function mx(e){let t=/\\.?0+e/;return e.replace(t,"e")}function MV(e){return e==="-0"?"0":e}function CV(e){return e=Math.abs(e),1e-4<e&&e<1e7}function DV(e){return e=Math.abs(e),.001<e&&e<1e4}var SV=5,vV=5;function dx(e){return e=Math.abs(e),e=Math.max(e,1e-16),Math.max(SV,Math.floor(vV+1.5-Math.log10(e)))}var MD={zeroCutoff:0,smallCutoff:.001,bigCutoff:1e6,digits:10,displayAsFraction:!1,addEllipses:!1,alwaysEmitImaginary:!1,spaceConstrained:!1},CD={smallCutoff:1e-6,bigCutoff:1e9,digits:12},yx={...CD,smallCutoff:1e-4,bigCutoff:1e6,digits:9,scientificNotationDigits:4,spaceConstrained:!0};function DD(e){return 1e6/Math.sqrt(Math.abs(e))}function SD(e){let t=DD(e);if(t<1||t>1e12)return!1;let{n,d:r}=Ba(e,t);return r===1?!1:e===e+Math.pow(2,-3)*Math.abs(n/r-e)}function Zm(e,t){var g;let{zeroCutoff:n,smallCutoff:r,bigCutoff:s,digits:i,displayAsFraction:o,addEllipses:a,spaceConstrained:u}={...MD,...t},c=(g=t==null?void 0:t.scientificNotationDigits)!=null?g:i-2;if(isNaN(e)||!isFinite(e))return{type:"undefined"};if(e===0||Math.abs(e)<n)return{type:"decimal",value:"0"};let p=mx(e.toExponential(c)).match(/([\\d\\.\\-]+)e\\+?([\\d\\-]+)/);if(!p)return{type:"undefined"};let f=parseInt(p[2],10),d=f>=i;if(SD(e)&&o){let m=Ba(e,DD(e));return{type:"fraction",numerator:m.n.toString(),denominator:m.d.toString()}}else{if(Math.abs(e)>s||Math.abs(e)<r||d)return{type:"scientific",mantissa:p[1],exponent:p[2]};{let m=ED(e.toPrecision(u&&f<0?i+f:i));return e!==Number(m)&&a&&(m+="..."),{type:"decimal",value:m}}}}function vD(e,t){let n=Zm(e,t);switch(n.type){case"undefined":return"undefined";case"decimal":return n.value;case"scientific":return n.mantissa+"<span class=\'dcg-cross\'>\\xD7</span>10<sup>"+n.exponent+"</sup>";case"fraction":return n.denominator==="1"?n.numerator:`${n.numerator}/${n.denominator}`;default:return n}}function Gl(e,t){let n=Zm(e,t);switch(n.type){case"undefined":return"undefined";case"decimal":return n.value;case"scientific":return n.mantissa+" * 10^"+n.exponent;case"fraction":return n.denominator==="1"?n.numerator:`${n.numerator}/${n.denominator}`;default:return n}}function kl(e,t){let n=Zm(e,t);switch(n.type){case"undefined":return"undefined";case"decimal":return n.value;case"scientific":return n.mantissa+"\\\\times10^{"+n.exponent+"}";case"fraction":return n.denominator==="1"?n.numerator:n.numerator[0]==="-"?`-\\\\frac{${n.numerator.slice(1)}}{${n.denominator}}`:`\\\\frac{${n.numerator}}{${n.denominator}}`;default:return n}}function X(e){if(e.startsWith("_base_case")){let[n,r,s]=e.split(":"),i=[];for(let o of s.split(",")){let a=parseFloat(o);isNaN(a)?i.push(X(o)):i.push(Gl(a))}return`${X(r)}(${i.join(",")})`}e=e.replace("\\\\","");let t={alpha:"\\u03B1",beta:"\\u03B2",gamma:"\\u03B3",delta:"\\u03B4",epsilon:"\\u03F5",varepsilon:"\\u03B5",zeta:"\\u03B6",eta:"\\u03B7",theta:"\\u03B8",vartheta:"\\u03D1",iota:"\\u03B9",kappa:"\\u03BA",varkappa:"\\u03F0",lambda:"\\u03BB",mu:"\\u03BC",xi:"\\u03BE",pi:"\\u03C0",varpi:"\\u03D6",rho:"\\u03C1",varrho:"\\u03F1",sigma:"\\u03C3",varsigma:"\\u03C2",tau:"\\u03C4",phi:"\\u03D5",varphi:"\\u03C6",chi:"\\u03C7",psi:"\\u03C8",omega:"\\u03C9",Gamma:"\\u0393",Delta:"\\u0394",Theta:"\\u0398",Lambda:"\\u039B",Xi:"\\u039E",Pi:"\\u03A0",Sigma:"\\u03A3",Phi:"\\u03A6",Psi:"\\u03A8",Omega:"\\u03A9",div:"\\xF7",cdot:"\\u22C5",times:"\\xD7",lt:"<",gt:">",le:"\\u2264",ge:"\\u2265",sim:"\\u223C",ldots:"\\u2026",prime:"\\u2032",approx:"\\u2248",to:"\\u2192","->":"\\u2192","<=":"\\u2264",">=":"\\u2265"};return t.hasOwnProperty(e)?t[e]:e}function qr(e){let t=e.match(/^\\$(\\d+)$/);if(t)return`\\\\token{${t[1]}}`;let n=e.split("_"),r="";return n[0].length>1&&(r+="\\\\"),r+=n[0],n[1]&&(r+="_{"+n[1]+"}"),r}function OV(e){if(!e)return"";let t=e.split("_");t[0]=X(t[0]);let n=t.map(ID);return n[1]&&(n[1]="<sub>"+n[1]+"</sub>"),n.join("")}function no(e){let t=e.match(/\\\\token\\{(\\d+)\\}/);return t?`$${t[1]}`:(e=e.replace(/\\\\operatorname\\{(.*)\\}/,"$1"),e.replace(/[{}\\\\]/g,""))}function oa(e){return e.replace(/^(\\\\ |\\s|\\\\space(?![a-zA-Z]))+/,"").replace(/(\\\\ |\\s|\\\\space(?![a-zA-Z]))+$/,"")}function Ic(e,t={},n="latex"){let r={...MD,...t},{alwaysEmitImaginary:s}=r,i=n==="latex"?kl:vD,[o,a]=[e[0]!==0?i(e[0],r):void 0,e[1]!==0||s?i(Math.abs(e[1]),r):void 0];return o==="undefined"||a==="undefined"?"undefined":o&&a?`${o}${e[1]>=0?"+":"-"}${a!=="1"?`${a}`:""}i`:a?`${e[1]>=0?"":"-"}${a!=="1"?`${a}`:""}i`:o!=null?o:"0"}function gx(e,t={}){let[n,r]=[e[0]!==0?Gl(e[0],t):void 0,e[1]!==0?Gl(Math.abs(e[1]),t):void 0];if(n==="undefined"||r==="undefined")return"undefined";let s=r!=null&&r.includes(" * ")||r!=null&&r.includes("/")?" ":"";return n&&r?`${n}${e[1]>0?" + ":" - "}${r!=="1"?`${r}${s}`:""}i`:r?`${e[1]>0?"":"-"}${r!=="1"?`${r}${s}`:""}i`:n!=null?n:"0"}var Ht={};ia(Ht,{actionMergeFreeVariable:()=>OT,addArgumentsToDefinition:()=>Zd,addTypeError:()=>Fx,adjacentMixedNumber:()=>Ty,adjacentNumbers:()=>eI,andTypeError:()=>Xx,ansUndefined:()=>EP,assignmentsUnsupported:()=>tf,badEqualitySlice:()=>ca,badForInputListDependency:()=>OP,badForIntervalDependency:()=>NP,badImplicitCall:()=>xy,badIntegralBoundDependency:()=>xP,badLogExponent:()=>hI,badProductBoundDependency:()=>lP,badSampleSize:()=>IP,badSumBoundDependency:()=>cP,badSymbolContext:()=>Kd,badTrigExponent:()=>gI,badTupleDimensions:()=>KT,baseCaseCannotDependOnRecursiveParameter:()=>Ox,baseCaseTooComplicatedUsePiecewise:()=>wd,baseCasesMustAllHaveSameReturnType:()=>Ld,binaryOperatorMissingOperand:()=>$d,blankExpression:()=>Xd,boxplotBreadthInvalid:()=>kT,boxplotOffsetInvalid:()=>GT,cannotAssignColor:()=>HI,cannotRedefine:()=>Zl,cannotRestrict:()=>kI,cannotRestrictWithEquality:()=>zI,cannotSubscript:()=>EI,cantCombineSphericalAndCylindrical:()=>Oy,cdfMaxInvalid:()=>FI,cdfMaxLessThanMin:()=>VI,cdfMinInvalid:()=>wI,cdfRequiresArguments:()=>zT,cdfTooManyArguments:()=>UT,clickableObjectAlreadyAssigned:()=>WV,clickableObjectAssignmentNotDefined:()=>ZV,clickableObjectAssignmentNotIdentifier:()=>jV,clickableObjectInvalidExpression:()=>JV,colonMissingCondition:()=>TI,colorArity:()=>XT,combineTypeError:()=>yy,comparatorTypeError:()=>Yx,complexPlottedTableCell:()=>zV,complicatedDoubleInequality:()=>Ly,complicatedPolarImplicit:()=>WI,computedColumnHeader:()=>UP,constantUnsupported:()=>_c,coordinateAccessTypeError:()=>jx,customRegressionsUnsupported:()=>CP,cycle:()=>MI,deeplyNested:()=>_T,dependsOnDeletedGeoObject:()=>GP,derivativeMissingBody:()=>hP,derivativeTypeError:()=>dT,derivativeTypeErrorRespect:()=>fT,derivativeVariableTypeError:()=>mT,differentialWithSuperscript:()=>fP,distributionAsFunction:()=>Vy,divideTypeError:()=>Hx,domainMaxInvalid:()=>_I,domainMaxLessThanMin:()=>LI,domainMinInvalid:()=>AI,dotLHSConstantNumberError:()=>ly,dotLHSTypeError:()=>tT,dotRHSPropertyError:()=>nT,duplicateFunctionParameter:()=>II,duplicateUpdateRules:()=>CT,eachBaseCaseArgumentMustBeSimple:()=>ay,emptyParen:()=>Yd,emptyPipe:()=>yI,emptyRadical:()=>dI,emptyRadicalIndex:()=>fI,emptySquareBracket:()=>mI,emptySubscript:()=>Ey,emptySuperscript:()=>aI,equationRequired:()=>wy,equationsUnsupported:()=>Ua,eventHandlerTypeError:()=>kd,expectedArgumentToBeButFound:()=>Lx,exponentTypeError:()=>zx,featureUnavailable:()=>rf,fractionEmpty:()=>oI,fractionMissingDenominator:()=>iI,fractionMissingNumerator:()=>sI,fractionsUnavailable:()=>Uy,functionDefinitionsUnsupported:()=>nf,functionNameAsParameter:()=>PI,functionNotDefined:()=>Dy,functionOnlyWorksInComplexMode:()=>VD,functionRequiresNumberOfArguments:()=>_x,functionTypeError:()=>Hs,functionUnsupported:()=>Li,geometryLengthTypeError:()=>Kx,getLogInternalErrors:()=>GV,gpuLongProduct:()=>BT,gpuLongSum:()=>VT,gpuMaxListSize:()=>Oc,gpuUnsupportedFunction:()=>Xl,gpuUnsupportedIntegral:()=>FT,gpuVariableListLength:()=>mu,gpuVariableProduct:()=>hy,gpuVariableSum:()=>gy,heterogeneousList:()=>Hd,identifierAsFunction:()=>Iy,identifierIsNotFunction:()=>Py,illegalBinWidth:()=>Qd,illegalDotCall:()=>Gd,implicitsDisabled:()=>ZI,incorrectProductLowerBound:()=>uP,incorrectSumLowerBound:()=>aP,indexTypeError:()=>Bd,inequalitiesDisabled:()=>Ry,inequalitiesUnsupported:()=>Lc,integralArgumentTypeError:()=>pT,integralLowerBoundTypeError:()=>cT,integralMissingBody:()=>gP,integralMissingBound:()=>pP,integralMissingDifferential:()=>dP,integralUpperBoundTypeError:()=>lT,internal:()=>U,invalidDependentFirstTableColumn:()=>UV,invalidDoubleEquality3d:()=>JI,invalidDoubleInequality3d:()=>jI,invalidDoubleInequalityVariables:()=>Ay,invalidFirstTableColumn:()=>eP,invalidFunctionName:()=>zy,invalidHalfEmptyRange:()=>sP,invalidImplicitVariables:()=>Ac,invalidImplicitVariables3d:()=>YI,invalidInequalityVariables:()=>$I,invalidIntervalComprehensionArity:()=>HP,invalidIntervalComprehensionParameter:()=>Jl,invalidIntervalComprehensionReturnType:()=>kP,invalidLHS:()=>UI,invalidNestedIntervalComprehension:()=>zP,invalidOperatorName:()=>cI,invalidRegressionParameter:()=>tP,invalidSubscript:()=>uI,invalidTableEntry:()=>Wd,invalidTableHeader:()=>KI,listComprehensionIncorrectInput:()=>vP,listComprehensionInputListTypeError:()=>SP,listTypeError:()=>vc,logScaleBoxPlot:()=>AT,logScaleDotPlot:()=>RT,logScaleHistogram:()=>NT,logScaleTypeError:()=>Yl,logbaseUnsupported:()=>MP,malformedList:()=>QT,malformedPoint:()=>JT,matrixAddDimensions:()=>KV,matrixAssignment:()=>QV,matrixElementTypeError:()=>sB,matrixFractionalPower:()=>nB,matrixInvalidVariable:()=>iB,matrixMultiplyDimensions:()=>tB,matrixPowerDimensions:()=>rB,matrixSubtractDimensions:()=>eB,maxListSize:()=>zd,methodRequiresList:()=>so,mismatchedBraces:()=>bP,mismatchedDoubleInequality:()=>_y,mixedComparatorChain:()=>qx,mixedRestrictionEquation:()=>wT,multipleEqualityRestrictions:()=>LT,multiplyDefined:()=>Wl,multiplyTypeError:()=>Vd,multiplyTypeError2D:()=>Gx,multiplyTypeError3D:()=>kx,multiplyTypeErrorCross:()=>Bx,negativeTypeError:()=>Ux,nonArithmeticRange:()=>Jd,nonListDoubleReducer:()=>jd,nonListParameterizedReducer:()=>rP,nonSquareDeterminant:()=>qV,nonSquareInverse:()=>YV,nonSquareTrace:()=>$V,opaque:()=>Fd,optimizationError:()=>nP,orTypeError:()=>Zx,parameterAlreadyDefined:()=>Sy,parenthesesUnavailable:()=>DP,pdfWrongArity:()=>HT,percentMissingOf:()=>TP,piecewiseBranchTypeError:()=>gT,piecewiseConditionTypeError:()=>fy,piecewiseMissingCondition:()=>bI,piecewisePartMissingCondition:()=>xI,pointTypeError:()=>Wx,pointsUnsupported:()=>Fc,polygonTwoNumbersError:()=>Ud,polygonUnsupportedIn3d:()=>ky,primeVariableTypeError:()=>yT,primeWithoutParen:()=>Cy,primedFunctionArity:()=>Nc,productArgumentTypeError:()=>uT,productInfiniteBoundError:()=>dy,productLowerBoundTypeError:()=>oT,productMissingBody:()=>yP,productMissingBound:()=>oP,productUpperBoundTypeError:()=>aT,randomArity:()=>$T,randomFromBroadcastDistribution:()=>YT,recursionCyclicDependency:()=>Nx,recursionDoesNotTerminate:()=>Rx,recursionInRegression:()=>xT,recursiveDepthExceeded:()=>Ax,recursiveFunctionCannotDependOnFreeVariable:()=>vx,recursiveFunctionMissingBaseCase:()=>oy,recursiveFunctionMissingBaseCaseWithMetadata:()=>Sx,regressionTypeError:()=>PT,regressionsUnsupported:()=>wc,selfReferentialBaseCase:()=>CI,selfReferentialFunctions:()=>Rc,setLogInternalErrors:()=>Dx,shadowedIndex:()=>vy,shadowedIntegrationVariable:()=>By,shadowedListComprehensionInput:()=>qy,singleVariableImplicitEquationsDisabled:()=>XI,singularInverse:()=>XV,sliderLimitReferencesExport:()=>SI,sliderMaxInvalid:()=>OI,sliderMaxLessThanMin:()=>NI,sliderMinInvalid:()=>vI,sliderStepInvalid:()=>RI,substitutionAmbiguousComma:()=>yu,substitutionBodyAction:()=>aB,substitutionBodyDependsOnRegression:()=>FP,substitutionDuplicateSymbol:()=>VP,substitutionFunctionLHS:()=>uf,substitutionIllegalLHS:()=>af,substitutionInvalidAssignments:()=>of,substitutionLocalLHS:()=>wP,substitutionNested:()=>$y,substitutionRecursiveCallLHS:()=>BP,substitutionTypeError:()=>oB,substitutionUnsupportedInterval:()=>Yy,subtractTypeError:()=>Vx,sumArgumentTypeError:()=>iT,sumInfiniteBoundError:()=>py,sumLowerBoundTypeError:()=>rT,sumMissingBody:()=>mP,sumMissingBound:()=>iP,sumUpperBoundTypeError:()=>sT,superscriptWithPrime:()=>pI,tableEntryTypeError:()=>bT,tableHeaderTypeError:()=>hT,tableRegressionInvalidData:()=>IT,tableRegressionLogWithNegative:()=>HV,tableRegressionTypeError:()=>TT,tdistWrongArity:()=>qT,threeDLengthTypeError:()=>eT,tickerMinStepNonNegativeNumber:()=>DI,tokenWithSubscript:()=>tI,tooManyArguments:()=>by,tooManyVariables:()=>rn,transformationDefinitionTypeError:()=>Jx,transformationTypeError:()=>Qx,ttestListTooShort:()=>jl,unaryOperatorMissingLeft:()=>nI,unaryOperatorMissingRight:()=>rI,unexpectedEquality:()=>wx,unexpectedInequality:()=>cy,unexpectedPrime:()=>My,unexpectedSubscript:()=>lI,unexpectedSymbol:()=>ks,unexportableTableRegression:()=>qP,unplottableEqualityChain:()=>QI,unplottableLongInequalityChain:()=>$x,unplottablePolarFunction:()=>qI,unrecognizedSymbol:()=>uy,updateRuleFunctionLHS:()=>vT,updateRuleIllegalLHS:()=>ST,updateRuleLocalLHS:()=>my,updateRuleNonIdentifierLHS:()=>MT,updateRuleTypeError:()=>ET,updateRuleUndefinedLHS:()=>DT,useRForCylindricalCoordinates:()=>GI,useRhoForSphericalCoordinates:()=>BI,variableAsFunction:()=>Fy,variableLengthDistributionList:()=>sf,variableLengthIntegralDependsOnIntegrationVariable:()=>LP,variableLengthProductBodyDependsOnIndex:()=>_P,variableLengthSumBodyDependsOnIndex:()=>AP,variableLengthTopLevelList:()=>RP,variableSeed:()=>PP,variableUnsupported:()=>Hy,variablesUnsupported:()=>ef,warnComplexImplicit:()=>Ny,writeIntegral:()=>Gy,wrongArity:()=>Ao,wrongArityLengthAsCount:()=>ZT,wrongDoubleReducerArity:()=>qd,wrongParameterizedReducerArity:()=>WT,zeroArgReducer:()=>jT});function Cd(e){return{__isLocalizableNumericValue:!0,value:e}}function WY(e){return e&&e.__isLocalizableNumericValue}function E(e,t){return{key:e,vars:t}}var ka=()=>({type:"empty"}),dr=()=>NV([-1/0,1/0]),aa=()=>bi([-1/0,1/0]),bi=e=>Wm(e,!0),NV=e=>Wm(e,!1),Wm=(e,t)=>isNaN(e[0])||isNaN(e[1])||e[1]<e[0]?ka():{type:"interval",bounds:e,tight:t};function Fs(e){return e.type==="empty"}function hi(e){return Fs(e)||e.tight}var Hl=(e,t)=>{if(t===0)return e>0?aa():ka();let n=-e/t,r=t<0?[-1/0,n]:[n,1/0];return bi(r)},Gn=(e,t)=>{if(Fs(e)||Fs(t))return ka();let n=[Math.max(e.bounds[0],t.bounds[0]),Math.min(e.bounds[1],t.bounds[1])],r=hi(e)&&hi(t);return Wm(n,r)},Sd=(e,t)=>{if(Fs(e))return t;if(Fs(t))return e;let n=[Math.min(e.bounds[0],t.bounds[0]),Math.max(e.bounds[1],t.bounds[1])],r;return!hi(e)&&!hi(t)?r=!1:hi(e)&&!hi(t)?r=e.bounds[0]<=t.bounds[0]&&e.bounds[1]>=t.bounds[1]:!hi(e)&&hi(t)?r=t.bounds[0]<=e.bounds[0]&&t.bounds[1]>=e.bounds[1]:r=e.bounds[0]<=t.bounds[1]&&t.bounds[0]<=e.bounds[1],Wm(n,r)},OD=(e,t,n)=>{if(Fs(e))return n;let r=Gn(e,t);return hi(e)?(e.bounds[0]>-1/0&&(r=Sd(r,Gn(bi([-1/0,e.bounds[0]]),n))),e.bounds[1]<1/0&&(r=Sd(r,Gn(bi([e.bounds[1],1/0]),n)))):r=Sd(r,Gn(n,dr())),r};function Vs(e,t,n){return{input:e,start:t,end:n}}function No(e,t){return Vs(e,t,t)}function Bs(e,t){if(e.input!==t.input)throw new Error("Programming Error: cannot form a span on different inputs");return Vs(e.input,e.start,t.end)}function Yn(e){return e.input.slice(e.start,e.end)}var Ie={};ia(Ie,{Action:()=>ut,AngleMarker:()=>Le,Any:()=>Qt,Arc:()=>ie,Bool:()=>De,BroadcastableArg:()=>ey,Circle:()=>ce,Complex:()=>R,DirectedAngleMarker:()=>ye,Distribution:()=>Lt,EmptyList:()=>$e,ErrorType:()=>Ro,Line:()=>fe,ListArgType:()=>Km,ListOfAngleMarker:()=>On,ListOfAny:()=>pn,ListOfArc:()=>Fn,ListOfBool:()=>Xn,ListOfCircle:()=>Wn,ListOfColor:()=>rr,ListOfComplex:()=>Ue,ListOfDirectedAngleMarker:()=>Nn,ListOfDistribution:()=>Zn,ListOfLine:()=>jn,ListOfMapInterval2DComplex:()=>jr,ListOfMapInterval2DPoint:()=>Xr,ListOfMapInterval2DPoint3D:()=>Zr,ListOfMapIntervalComplex:()=>Wr,ListOfMapIntervalPoint:()=>$r,ListOfMapIntervalPoint3D:()=>Yr,ListOfNumber:()=>ne,ListOfNumberNC:()=>ro,ListOfPoint:()=>Pt,ListOfPoint3D:()=>fr,ListOfPolygon:()=>In,ListOfRay:()=>Vn,ListOfRestriction:()=>Gs,ListOfSegment:()=>xn,ListOfSegment3D:()=>mr,ListOfSphere3D:()=>Ar,ListOfTone:()=>cs,ListOfTransformation:()=>Rr,ListOfTriangle3D:()=>yr,ListOfVector:()=>Jn,ListOfVector3D:()=>gr,MapInterval2DComplex:()=>Mr,MapInterval2DPoint:()=>Pr,MapInterval2DPoint3D:()=>Er,MapIntervalComplex:()=>or,MapIntervalPoint:()=>sr,MapIntervalPoint3D:()=>ir,NoCoerceComplexToReal:()=>Nd,Number:()=>I,NumberNC:()=>Te,Point:()=>N,Point3D:()=>z,Polygon:()=>xe,RGBColor:()=>Kt,Ray:()=>Ne,Restriction:()=>Gt,SeedType:()=>ft,Segment:()=>de,Segment3D:()=>wt,Sphere3D:()=>Hn,Tone:()=>Pn,Transformation:()=>Re,Triangle3D:()=>Rn,TupleTypeMap:()=>zl,UNKNOWN_RETURN_TYPE:()=>FV,Union:()=>Qn,Vector:()=>le,Vector3D:()=>ke,allListTypes:()=>ii,allTupleTypes:()=>hx,allValueTypes:()=>RV,angleTypes:()=>Tx,assertTypeIsOneOf:()=>za,broadcastArg:()=>oi,broadcastable:()=>Ae,commonCoerceableType:()=>fu,commonCoerceableTypeWithBroadcast:()=>Ha,elementType:()=>Ve,getAllowedTypesForArg:()=>Ad,hasListType:()=>wn,hasMapType:()=>Ix,isEligibleForBroadcast:()=>ty,isGeometryType:()=>vd,isList:()=>j,isMapOrListOfMap:()=>ua,isMultipliableElementType:()=>bx,isOneOf:()=>Od,isSubType:()=>_i,isSubTypeOrCoercible:()=>kn,isSubTypeOrNonComplexCoercible:()=>Ec,isSummableElementType:()=>$l,isTypeOrListOfType:()=>se,isValidOnLogScales:()=>Ul,listArg:()=>Rd,listType:()=>vn,mapType:()=>Px,multipliableElementTypes:()=>Jm,prettyPrint:()=>oe,repr:()=>at,signature:()=>kt,straightTypes:()=>Qm,summableElementTypes:()=>ql,typeSatisfiesArgType:()=>ny,typeSatisfiesArgTypeUncoerced:()=>Mc,valueTypes:()=>RD,variadicMinCount:()=>_r,vectorTypes:()=>xx});function jm(e,t){return t?vn(e):e}function _i(e,t){return e===$e&&j(t)||t===pn&&j(e)||t===Qt&&!j(e)?!0:e===t}function kn(e,t){if(e===void 0)return!1;if(_i(e,t))return!0;j(e)&&j(t)&&t!==$e&&(e=Ve(e),t=Ve(t));let n=t;switch(e){case Le:case ye:case Gt:case I:case R:return n===I||n===R;default:return!1}}function Ec(e,t){return t===I&&e===R||t===ne&&e===Ue?!1:kn(e,t)}function fu(e,t){if(_i(e,t))return t;if(_i(t,e))return e;let n=j(e);if(n!=j(t))return;let r=jm(R,n);if(e===r&&kn(t,r))return r;if(t===r&&kn(e,r))return r;let s=jm(I,n);if(kn(e,s)&&kn(t,s)){let i=jm(Le,n),o=jm(ye,n);return e===i&&t===o||e===o&&t===i?void 0:s}}function Ha(e,t){return j(e)&&wn(t)?fu(e,vn(t)):wn(e)&&j(t)?fu(vn(e),t):fu(e,t)}var Qt=0,I=1,De=2,N=3,Lt=4,ut=5,pn=6,ne=7,Xn=8,Pt=9,Zn=10,$e=11,Ro=12,ft=13,Kt=14,rr=15,xe=16,In=17,de=18,xn=19,ce=20,Wn=21,ie=22,Fn=23,fe=24,jn=25,Ne=26,Vn=27,Le=28,On=29,ye=30,Nn=31,Re=32,Rr=33,le=34,Jn=35,Gt=36,Gs=37,R=38,Ue=39,Pn=50,cs=51,z=100,fr=101,wt=102,mr=103,Rn=104,yr=105,Hn=106,Ar=107,ke=108,gr=109,sr=200,ir=201,Pr=202,Er=203,$r=204,Yr=205,Xr=206,Zr=207,or=208,Mr=209,Wr=210,jr=211,RD={Any:Qt,Number:I,Bool:De,Complex:R,ListOfComplex:Ue,Point:N,Point3D:z,Distribution:Lt,Action:ut,ListOfAny:pn,ListOfNumber:ne,ListOfBool:Xn,ListOfPoint:Pt,ListOfPoint3D:fr,ListOfDistribution:Zn,EmptyList:$e,ErrorType:Ro,SeedType:ft,RGBColor:Kt,ListOfColor:rr,Polygon:xe,ListOfPolygon:In,Segment:de,ListOfSegment:xn,Circle:ce,ListOfCircle:Wn,Arc:ie,ListOfArc:Fn,Line:fe,ListOfLine:jn,Ray:Ne,ListOfRay:Vn,Vector:le,ListOfVector:Jn,Restriction:Gt,ListOfRestriction:Gs,AngleMarker:Le,ListOfAngleMarker:On,DirectedAngleMarker:ye,ListOfDirectedAngleMarker:Nn,Transformation:Re,ListOfTransformation:Rr,Segment3D:wt,ListOfSegment3D:mr,Triangle3D:Rn,ListOfTriangle3D:yr,Sphere3D:Hn,ListOfSphere3D:Ar,Vector3D:ke,ListOfVector3D:gr,Tone:Pn,ListOfTone:cs,MapIntervalPoint:sr,MapIntervalComplex:or,MapIntervalPoint3D:ir,MapInterval2ToPoint:Pr,MapInterval2ToComplex:Mr,MapInterval2DPoint3D:Er,ListOfMapIntervalPoint:$r,ListOfMapIntervalComplex:Wr,ListOfMapIntervalPoint3D:Yr,ListOfMapInterval2ToPoint:Xr,ListOfMapInterval2ToComplex:jr,ListOfMapInterval2DPoint3D:Zr},zl={[N]:[I,I],[z]:[I,I,I],[R]:[I,I]},Qn=class e{constructor(t,{coerceComplexToReal:n}){this.types=t;this.coerceComplexToReal=n}static of(t,n={coerceComplexToReal:!0}){return new e(t,n)}getTypes(){return this.types}},RV=Object.values(RD),AV=Object.keys(zl).map(parseFloat),hx=Qn.of(AV);function at(e){switch(e){case Qt:return"Any";case I:return"Number";case De:return"Bool";case R:return"Complex";case N:return"Point";case z:return"Point3D";case Lt:return"Distribution";case ut:return"Action";case pn:return"ListOfAny";case ne:return"ListOfNumber";case Xn:return"ListOfBool";case Ue:return"ListOfComplex";case Pt:return"ListOfPoint";case fr:return"ListOfPoint3D";case Zn:return"ListOfDistribution";case $e:return"EmptyList";case Ro:return"ErrorType";case ft:return"SeedType";case Kt:return"RGBColor";case rr:return"ListOfColor";case xe:return"Polygon";case In:return"ListOfPolygon";case de:return"Segment";case xn:return"ListOfSegment";case ce:return"Circle";case Wn:return"ListOfCircle";case ie:return"Arc";case Fn:return"ListOfArc";case fe:return"Line";case jn:return"ListOfLine";case Ne:return"Ray";case Vn:return"ListOfRay";case le:return"Vector";case Jn:return"ListOfVector";case Gt:return"Restriction";case Gs:return"ListOfRestriction";case Le:return"Angle";case On:return"ListOfAngle";case ye:return"DirectedAngle";case Nn:return"ListOfDirectedAngle";case Re:return"Transformation";case Rr:return"ListOfTransformation";case wt:return"Segment3D";case mr:return"ListOfSegment3D";case ke:return"Vector3D";case gr:return"ListOfVector3D";case Rn:return"Triangle3D";case yr:return"ListOfTriangle3D";case Hn:return"Sphere3D";case Ar:return"ListOfSphere3D";case Pn:return"Tone";case cs:return"ListOfTone";case sr:return"MapIntervalPoint";case or:return"MapIntervalComplex";case ir:return"MapIntervalPoint3D";case Pr:return"MapInterval2ToPoint";case Mr:return"MapInterval2ToComplex";case Er:return"MapInterval2DPoint3D";case $r:return"ListOfMapIntervalPoint";case Wr:return"ListOfMapIntervalComplex";case Yr:return"ListOfMapIntervalPoint3D";case Xr:return"ListOfMapInterval2ToPoint";case jr:return"ListOfMapInterval2ToComplex";case Zr:return"ListOfMapInterval2DPoint3D";default:let t=e;throw new Error(`Invalid type: ${t}`)}}function oe(e,t){var r;let n=(r=t==null?void 0:t.specifyPointDimensions)!=null?r:!1;switch(e){case Qt:return E("shared-calculator-label-value-type-any");case I:return E("shared-calculator-label-value-type-number");case De:return E("shared-calculator-label-value-type-bool");case R:return E("shared-calculator-label-value-type-complex");case N:return n?E("shared-calculator-label-value-type-point2d"):E("shared-calculator-label-value-type-point");case z:return E("shared-calculator-label-value-type-point3d");case Lt:return E("shared-calculator-label-value-type-distribution");case ut:return E("shared-calculator-label-value-type-action");case pn:return E("shared-calculator-label-value-type-list-of-any");case ne:return E("shared-calculator-label-value-type-list-of-numbers");case Xn:return E("shared-calculator-label-value-type-list-of-bool");case Ue:return E("shared-calculator-label-value-type-list-of-complex");case Pt:return n?E("shared-calculator-label-value-type-list-of-2d-points"):E("shared-calculator-label-value-type-list-of-points");case fr:return E("shared-calculator-label-value-type-list-of-3d-points");case Zn:return E("shared-calculator-label-value-type-list-of-distributions");case $e:return E("shared-calculator-label-value-type-empty-list");case Ro:return E("shared-calculator-label-value-type-error");case ft:return E("shared-calculator-label-value-type-seed");case Kt:return E("shared-calculator-label-value-type-color");case rr:return E("shared-calculator-label-value-type-list-of-colors");case xe:return E("shared-calculator-label-value-type-polygon");case In:return E("shared-calculator-label-value-type-list-of-polygons");case de:return E("shared-calculator-label-value-type-segment");case xn:return E("shared-calculator-label-value-type-list-of-segments");case ce:return E("shared-calculator-label-value-type-circle");case Wn:return E("shared-calculator-label-value-type-list-of-circles");case ie:return E("shared-calculator-label-value-type-arc");case Fn:return E("shared-calculator-label-value-type-list-of-arcs");case fe:return E("shared-calculator-label-value-type-line");case jn:return E("shared-calculator-label-value-type-list-of-lines");case Ne:return E("shared-calculator-label-value-type-ray");case Vn:return E("shared-calculator-label-value-type-list-of-rays");case le:return E("shared-calculator-label-value-type-vector");case Jn:return E("shared-calculator-label-value-type-list-of-vectors");case Gt:return E("shared-calculator-label-value-type-restriction");case Gs:return E("shared-calculator-label-value-type-list-of-restrictions");case Le:return E("shared-calculator-label-value-type-angle");case On:return E("shared-calculator-label-value-type-list-of-angles");case ye:return E("shared-calculator-label-value-type-directed-angle");case Nn:return E("shared-calculator-label-value-type-list-of-directed-angles");case Re:return E("shared-calculator-label-value-type-transformation");case Rr:return E("shared-calculator-label-value-type-list-of-transformations");case wt:return E("shared-calculator-label-value-type-segment3d");case mr:return E("shared-calculator-label-value-type-list-of-segment3d");case ke:return E("shared-calculator-label-value-type-vector3d");case gr:return E("shared-calculator-label-value-type-list-of-vector3d");case Rn:return E("shared-calculator-label-value-type-triangle3d");case yr:return E("shared-calculator-label-value-type-list-of-triangle3d");case Hn:return E("shared-calculator-label-value-type-sphere3d");case Ar:return E("shared-calculator-label-value-type-list-of-sphere3d");case Pn:return E("shared-calculator-label-value-type-tone");case cs:return E("shared-calculator-label-value-type-list-of-tone");case sr:case Pr:return E("shared-calculator-label-value-type-lambda-point");case or:case Mr:return E("shared-calculator-label-value-type-lambda-complex");case ir:case Er:return E("shared-calculator-label-value-type-lambda-point3d");case $r:case Xr:return E("shared-calculator-label-value-type-list-of-lambda-point");case Wr:case jr:return E("shared-calculator-label-value-type-list-of-lambda-complex");case Yr:case Zr:return E("shared-calculator-label-value-type-list-of-lambda-point3d");default:let s=e;throw new Error(`Invalid type: ${s}`)}}var _V=[pn,ne,Xn,Ue,Gs,Pt,fr,Zn,$e,rr,In,xn,Wn,Fn,jn,Vn,Jn,On,Nn,Rr,mr,gr,yr,Ar,cs,$r,Wr,Yr,Xr,jr,Zr],ii=Qn.of(_V,{coerceComplexToReal:!1}),eX={[pn]:Qt,[$e]:I,[ne]:I,[Xn]:De,[Ue]:R,[Gs]:Gt,[Pt]:N,[fr]:z,[Zn]:Lt,[rr]:Kt,[In]:xe,[xn]:de,[Wn]:ce,[Fn]:ie,[jn]:fe,[Vn]:Ne,[Jn]:le,[On]:Le,[Nn]:ye,[Rr]:Re,[mr]:wt,[gr]:ke,[yr]:Rn,[Ar]:Hn,[cs]:Pn,[$r]:sr,[Wr]:or,[Yr]:ir,[Xr]:Pr,[jr]:Mr,[Zr]:Er};function j(e){switch(e){case void 0:return!1;case pn:case ne:case Xn:case Ue:case Gs:case Pt:case fr:case Zn:case rr:case In:case xn:case Wn:case Fn:case jn:case Vn:case Jn:case On:case Nn:case Rr:case mr:case gr:case yr:case Ar:case cs:case $r:case Wr:case Yr:case Xr:case jr:case Zr:return!0;case $e:return!0;case Qt:case I:case De:case R:case Gt:case N:case z:case Lt:case Ro:case ft:case Kt:case ut:case xe:case de:case ce:case ie:case fe:case Ne:case le:case Le:case ye:case Re:case wt:case ke:case Rn:case Pn:case Hn:case sr:case or:case ir:case Pr:case Mr:case Er:return!1;default:throw new Error(`Invalid type: ${e}`)}}function Ve(e){switch(e){case $e:case ne:return I;case Xn:return De;case Ue:return R;case Gs:return Gt;case Pt:return N;case fr:return z;case Zn:return Lt;case rr:return Kt;case In:return xe;case mr:return wt;case gr:return ke;case yr:return Rn;case Ar:return Hn;case pn:return Qt;case xn:return de;case Wn:return ce;case Fn:return ie;case jn:return fe;case Vn:return Ne;case Jn:return le;case On:return Le;case Nn:return ye;case Rr:return Re;case cs:return Pn;case $r:return sr;case Wr:return or;case Yr:return ir;case Xr:return Pr;case jr:return Mr;case Zr:return Er;case Qt:case I:case De:case R:case N:case z:case Lt:case Ro:case ft:case Kt:case ut:case xe:case de:case ce:case ie:case fe:case Ne:case le:case Gt:case Le:case ye:case Re:case wt:case ke:case Rn:case Hn:case Pn:case sr:case or:case ir:case Pr:case Mr:case Er:throw new Error("Type "+at(e)+" does not implement elementType.");default:let t=e;throw new Error(`Invalid type: ${t}`)}}function vn(e){switch(e){case Qt:return pn;case I:return ne;case De:return Xn;case R:return Ue;case Gt:return Gs;case N:return Pt;case z:return fr;case Lt:return Zn;case Kt:return rr;case xe:return In;case de:return xn;case ce:return Wn;case ie:return Fn;case fe:return jn;case Ne:return Vn;case le:return Jn;case Le:return On;case ye:return Nn;case Re:return Rr;case wt:return mr;case ke:return gr;case Rn:return yr;case Hn:return Ar;case Pn:return cs;case sr:return $r;case or:return Wr;case ir:return Yr;case Pr:return Xr;case Mr:return jr;case Er:return Zr;case $e:case ne:case Xn:case Ue:case Gs:case Pt:case fr:case Zn:case rr:case In:case xn:case Wn:case Fn:case jn:case Vn:case Jn:case On:case Nn:case Rr:case mr:case gr:case yr:case Ar:case pn:case cs:case Ro:case ft:case ut:case $r:case Wr:case Yr:case Xr:case jr:case Zr:throw new Error("Type "+at(e)+" does not implement listType.");default:let t=e;throw new Error(`Invalid type: ${t}`)}}function wn(e){switch(e){case Qt:case I:case De:case R:case Gt:case N:case z:case Lt:case Kt:case xe:case de:case ce:case ie:case fe:case Ne:case le:case Le:case ye:case Re:case wt:case ke:case Rn:case Hn:case Pn:case sr:case or:case ir:case Pr:case Mr:case Er:return!0;case $e:case ne:case Xn:case Ue:case Gs:case Pt:case fr:case Zn:case rr:case In:case xn:case Wn:case Fn:case jn:case Vn:case Jn:case On:case Nn:case Rr:case mr:case gr:case yr:case Ar:case pn:case cs:case $r:case Wr:case Yr:case Xr:case jr:case Zr:case ft:case ut:case Ro:return!1;default:throw new Error(`Invalid type: ${e}`)}}function vd(e){if(e===void 0)return!1;switch(e){case N:case xe:case de:case ce:case ie:case fe:case Ne:case le:case Le:case ye:case Re:return!0;default:return!1}}function Ul(e){switch(e){case I:case Qt:case De:case R:case Gt:case N:case Lt:case ut:case pn:case ne:case Xn:case Ue:case Gs:case Pt:case Zn:case $e:case Ro:case ft:case Kt:case rr:case Pn:case cs:return!0;case z:case fr:case wt:case mr:case ke:case gr:case Rn:case yr:case Hn:case Ar:case xe:case In:case de:case xn:case ce:case Wn:case ie:case Fn:case fe:case jn:case Ne:case Vn:case le:case Jn:case Le:case On:case ye:case Nn:case Re:case Rr:case sr:case or:case ir:case Pr:case Mr:case Er:case $r:case Wr:case Yr:case Xr:case jr:case Zr:return!1;default:let t=e;throw new Error(`Invalid type: ${t}`)}}function Od(e,t){for(let n of t)if(e===n)return!0;return!1}var ql=[I,R,N,z];function $l(e){return ql.includes(e)}var Jm=[I,R];function bx(e){return Jm.includes(e)}var Qm=Qn.of([fe,Ne,de,le]),xx=Qn.of([le,ke]),Tx=Qn.of([Le,ye]);function se(e,t){return e===void 0?!1:e===t?!0:j(e)?e===$e?!0:Ve(e)===t:!1}function ua(e){return Od(e,[sr,or,ir,Pr,Mr,Er,$r,Wr,Yr,Xr,jr,Zr])}var AD={[N]:sr,[R]:or,[z]:ir},LV={[N]:Pr,[R]:Mr,[z]:Er};function Ix(e){return AD[e]!==void 0}function Px(e,t){let n=t===1?AD[e]:LV[e];if(n===void 0)throw new Error(`Unexpected return type for map: ${at(e)}`);return n}function za(e,t){if(!Od(e,t))throw new Error(`Programming error: expected one of ${t.map(at)} but found ${e&&at(e)} instead.`)}var FV=Symbol("UNKNOWN_RETURN_TYPE");function _D(e){return typeof e=="object"&&e.type==="variadic"}function _r(e,t){return{type:"variadic",initial:new Array(t).fill(e),rest:e}}var Ex=class{constructor(t,n){this.argTypes=t;this.productContext=n;this.minArity=this.argTypes.length,this.maxArity=this.argTypes.length}argTypeAtIndex(t){if(!(t>this.argTypes.length-1))return this.argTypes[t]}matches(t){return LD(this,t)}satisfiesPolicy(t){return t.is3dProduct()?this.productContext["3d"]:t.isGeometryEnabled()?this.productContext.geometry:this.productContext.graphing}},Mx=class{constructor(t,n){this.productContext=n;this.maxArity=void 0;this.initial=t.initial,this.rest=t.rest,this.minArity=this.initial.length}argTypeAtIndex(t){return t<this.initial.length?this.initial[t]:this.rest}matches(t){return LD(this,t)}satisfiesPolicy(t){return t.is3dProduct()?this.productContext["3d"]:t.isGeometryEnabled()?this.productContext.geometry:this.productContext.graphing}};function LD(e,t){return e.maxArity!==void 0&&e.maxArity<t.length?!1:!!t.every((n,r)=>{if(n===void 0)return!0;let s=e.argTypeAtIndex(r);return s===void 0?!1:ny(n,s)})}var Nd=class{constructor(t){this.arg=t;this.coerceComplexToReal=!1}getTypes(){return typeof this.arg=="number"?[this.arg]:this.arg.getTypes()}},Te=new Nd(I),ro=new Nd(ne),Km=class{constructor(t){typeof t=="number"?(this.coerceComplexToReal=t===I,this.nodeTypes=[vn(t)]):(this.coerceComplexToReal=t.coerceComplexToReal,this.nodeTypes=t.getTypes().map(vn))}getTypes(){return this.nodeTypes}};function Rd(e){return new Km(e)}var ey=class{constructor(t){if(typeof t=="number")this.coerceComplexToReal=t===I,this.nodeTypes=[t,vn(t)];else{this.coerceComplexToReal=t.coerceComplexToReal,this.nodeTypes=[];for(let n of t.getTypes())this.nodeTypes.push(n,vn(n))}}getTypes(){return this.nodeTypes}};function ty(e){return typeof e=="number"?wn(e):e instanceof Qn?e.types.every(ty):!1}function oi(e){return new ey(e)}function kt(e,t={}){let n={geometry:!0,"3d":!0,graphing:!0,...t};return _D(e)?new Mx(e,n):new Ex(e,n)}function Ae(e,t={}){return _D(e)?kt({type:"variadic",initial:e.initial.map(oi),rest:oi(e.rest)},t):kt(e.map(oi),t)}function ny(e,t){if(typeof t=="number")return kn(e,t);{let n=t.getTypes();return t.coerceComplexToReal?n.some(r=>kn(e,r)):n.some(r=>Ec(e,r))}}function Mc(e,t){return typeof t=="number"?_i(e,t):t.getTypes().some(r=>_i(e,r))}function Ad(e,t){let n=new Set;for(let r of e){let s=r.argTypeAtIndex(t);if(s===void 0)continue;let i=VV(s);for(let o of i)n.add(o)}return[...n]}function VV(e){return typeof e=="number"?[e]:e.getTypes()}function BV(e){return!e||e[0].type==="none"&&e[1].type==="none"?"NONE":e[1].type==="none"?"X":e[0].type==="none"?"Y":"XY"}function wD(e,t){let n=BV(t);switch(e){case"NONE":return"NONE";case"AUTO":return n;case"XY":return n;case"X":return n==="X"||n==="XY"?"X":"NONE";case"Y":return n==="Y"||n==="XY"?"Y":"NONE";default:return"NONE"}}var Yt=class{constructor(){this.localFrameID=void 0;this._dependencies=[],this._optionalDependencies=[],this._updateSymbols=[],this._scope={definitions:[],dependencies:[],substitutionDependencies:[],scopes:[]},this._exports=[],this.metaData={extraDepNodes:[]},this.userData={}}getDefaultDragMode(t){return"NONE"}setInputSpan(t){this._inputSpan=t}getInputString(){return this._inputSpan===void 0?"":Yn(this._inputSpan)}getInputSpan(){return this._inputSpan}shouldExportAns(){return!1}getAnsVariable(){return this.shouldExportAns()&&this.userData&&this.userData.hasOwnProperty("index")?["ans_"+this.userData.index]:[]}addDependency(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._scope.dependencies.indexOf(t)===-1&&this._scope.dependencies.push(t)}addDependencies(t){for(let n=0;n<t.length;n++)this.addDependency(t[n])}addOptionalDependencies(t){for(let n=0;n<t.length;n++){let r=t[n];this._dependencies.indexOf(r)===-1&&this._dependencies.push(r),this._optionalDependencies.indexOf(r)===-1&&this._optionalDependencies.push(r)}}addUpdateSymbol(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._updateSymbols.indexOf(t)===-1&&this._updateSymbols.push(t)}addSubstitutionDependencies(t){for(let n=0;n<t.length;n++){let r=t[n];if(this._dependencies.indexOf(r)===-1)throw new Error("Programming error: substitution dependency "+r+" must also be registered as a regular dependency");this._scope.substitutionDependencies.indexOf(r)===-1&&this._scope.substitutionDependencies.push(r)}}mergeDependencies(...t){for(let n=0;n<t.length;n++){let r=t[n];for(let s=0;s<r._dependencies.length;s++)this._dependencies.indexOf(r._dependencies[s])===-1&&this._dependencies.push(r._dependencies[s]);for(let s=0;s<r._updateSymbols.length;s++)this._updateSymbols.indexOf(r._updateSymbols[s])===-1&&this._updateSymbols.push(r._updateSymbols[s]);for(let s=0;s<r._scope.dependencies.length;s++)this._scope.dependencies.indexOf(r._scope.dependencies[s])===-1&&this._scope.dependencies.push(r._scope.dependencies[s]);for(let s=0;s<r._scope.substitutionDependencies.length;s++)this._scope.substitutionDependencies.indexOf(r._scope.substitutionDependencies[s])===-1&&this._scope.substitutionDependencies.push(r._scope.substitutionDependencies[s]);this.addOptionalDependencies(r.getOptionalDependencies()),Array.prototype.push.apply(this._scope.scopes,r._scope.scopes)}}mergeDependenciesInScope(t,n,r,s){let i=r.getScope(),o={kind:t,definitions:n,dependencies:i.dependencies,substitutionDependencies:i.substitutionDependencies,scopes:i.scopes,functionDefinitionSymbol:s==null?void 0:s.functionDefinitionSymbol};this._scope.scopes.push(o);for(let a=0;a<r._dependencies.length;a++){let u=r._dependencies[a];!n.includes(u)&&!this._dependencies.includes(u)&&this._dependencies.push(u)}for(let a=0;a<r._updateSymbols.length;a++)this._updateSymbols.indexOf(r._updateSymbols[a])===-1&&this._updateSymbols.push(r._updateSymbols[a]);this.addOptionalDependencies(r.getOptionalDependencies())}getDependencies(){return this._dependencies}graphmodeDependencies(t,n){return this.getDependencies()}getOptionalDependencies(){return this._optionalDependencies}getUpdateSymbols(){return this._updateSymbols}getScope(){return this._scope}dependsOn(t){return this._dependencies.indexOf(t)>-1}getExports(t){let n=this._exports||[];if(this.userData&&"id"in this.userData){let r=this.userData.id;n=n.concat(["idref_"+r])}return t.ansEnabled()&&(n=n.concat(this.getAnsVariable())),n}getLegalExports(t){return this.getExports(t).filter(n=>!t.assignmentForbidden(n))}exportsSymbol(t){return this._exports.indexOf(t)>-1}exportTo(t,n,r){let s=[],i=this.getLegalExports(t);for(let o=0;o<i.length;o++){let a=i[o];if(r[a])return s;r[a]=n.blocksExport?n:this,s.push(a)}return s}getOperator(){return this.operator||"="}isInequality(){return!1}isShadeBetween(){return!1}getEvaluationInfo(){return!1}shouldPromoteToSlider(t){return!1}getSliderVariables(t,n,r){let s=t.sliderVariables(r!=null?r:n.getDependencies());return n.valueType===N||n.valueType===Pt||n.valueType===z||n.valueType===fr||n.valueType===R||n.valueType===Ue?t.is3dPolicy()?s.includes("t")&&!s.includes("u")&&!s.includes("v")?s.filter(i=>i!="t"):!s.includes("t")&&(s.includes("u")||s.includes("v"))?s.filter(i=>i!="u"&&i!="v"):s:s.filter(i=>!t.validParametricVariable(i)):s}getCompiledDerivative(){let t=this.getDependencies();return this.takeDerivative(t[0]||"x").getCompiledFunction()}asValue(){}boundDomain(t){return dr()}getCursorContext(){}polynomialOrder(t){}getPolynomialCoefficients(t){}asTypedValue(){}asCompilerValue(){}substitute(t){}getExpressionType(t,n){}tableInfo(t,n){}analyze(t,n,r){throw U(`Node ${this.type} does not define analyze.`)}analyzeFourFunction(t,n,r){}analyzeScientific(t,n,r){}analyzeSingleExpressionScientific(t,n,r){}getGraphMode(t,n){}getMoveStrategy(t,n,r,s){}};var v=class extends Yt{constructor(n){super();this.isError=!0;this._msg=n,this.blocksExport=!0}evaluateOnce(n){return this._msg}getError(){return this._msg}setDependencies(n){return this.addDependencies(n),this}setActionValue(n){this.actionValue=n}allowExport(){return this.blocksExport=!1,this}setCursorContext(n){this.cursorContext=n}getCursorContext(){return this.cursorContext}};var _d={real:!0,imag:!0,conj:!0,arg:!0},FD=Object.keys(_d);var Cc=class{constructor(t){this.singleExpression=t.singleExpression}isGeometryEnabled(){return!1}is3dProduct(){return!1}is3dPolicy(){return!1}isComplexEnabled(){return!1}isRecursionEnabled(){return!1}polygonUnsupportedPreferTriangle(){return!1}areAllScalesLinear(){return!0}assignmentForbidden(t){return t.slice(0,3)!=="ans"}isValidSlider(t){return!1}sliderVariables(){return[]}graphingEnabled(){return!1}ansEnabled(){return!this.singleExpression}dimensionVarsEnabled(){return!1}disabledFeatures(){return["Sum","Product","Integral","List","Derivative","Piecewise","Restriction","Norm","Exponent","PercentOf","Substitution"]}shouldIncludeFunctionParametersInRandomSeed(){return!0}};var iy=!1;function Dx(e){iy=e}function GV(){return iy}function kV(...e){iy&&console.error(...e)}function U(e){if(iy){let t=e instanceof Error?e:new Error(`${e}`);return kV(t.stack),new v(E("shared-calculator-error-internal-error",{msg:t.message}))}return new v(E("shared-calculator-error-parse-error"))}function oy(e){let t=e.length,n=e[0];return new v(E("shared-calculator-error-recursion-missing-base-case",{count:Cd(t),lastSymbol:X(n),symbols:e.slice(1).map(r=>X(r)).join("\', \'")}))}function Sx(e,t){let n=oy(e);return n.recursionMetadata=t,n}function vx(e){return new v(E("shared-calculator-error-recursion-base-case-free-variable",{freeVariable:X(e)}))}function Ox(e){return new v(E("shared-calculator-error-recursion-base-case-free-variable",{freeVariable:X(e)}))}function Ld({blockExport:e}){let t=new v(E("shared-calculator-error-recursion-base-case-same-type"));return e||t.allowExport(),t}function wd(){return new v(E("shared-calculator-error-recursion-base-case-too-complicated"))}function ay(){return new v(E("shared-calculator-error-recursion-base-case-argument-non-number"))}function Nx(){return new v(E("shared-calculator-error-recursion-does-not-terminate"))}function Rx(){return new v(E("shared-calculator-error-recursion-does-not-terminate"))}function Ax(){return new v(E("shared-calculator-error-recursion-depth-limit-exceeded"))}function _x(e,t){return new v(E("shared-calculator-error-recursion-wrong-arity",{fnSymbol:X(e),count:Cd(t)}))}function Lx(e,t,n,{blockExport:r}){let s=new v(E("shared-calculator-error-recursion-argument-type",{index:e+1,expectedType:t,foundType:n}));return r||s.allowExport(),s}function Fd(){return new v(E("shared-calculator-error-parse-error"))}function uy(e){return e=X(e),new v(E("shared-calculator-error-unrecognized-symbol",{symbol:e}))}function cy(){return new v(E("shared-calculator-error-unexpected-inequality"))}function wx(){return new v(E("shared-calculator-error-unexpected-equality"))}function ks(e){return e=X(e),new v(E("shared-calculator-error-unexpected-symbol",{symbol:e}))}function Fx(e,{blockExport:t}){let n=new v(E("shared-calculator-error-add-type-error",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function Vx(e,{blockExport:t}){let n=new v(E("shared-calculator-error-subtract-type-error",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function Vd(e,{blockExport:t}){let n=new v(E("shared-calculator-error-multiply-type-error",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function Bx(e,{blockExport:t}){let n=new v(E("shared-calculator-error-multiply-type-error-cross",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function Gx(e,{blockExport:t}){let n=new v(E("shared-calculator-error-multiply-type-error-2d",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function kx(e,{blockExport:t}){let n=new v(E("shared-calculator-error-multiply-type-error-3d",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function Hx(e,{blockExport:t}){let n=new v(E("shared-calculator-error-divide-type-error",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function zx(e,{blockExport:t}){let n=new v(E("shared-calculator-error-exponent-type-error",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function Ux(e,{blockExport:t}){let n=new v(E("shared-calculator-error-negative-type-error",{symbol:e[0]}));return t||n.allowExport(),n}function qx(){return new v(E("shared-calculator-error-mixed-comparator-chain"))}function $x(){return new v(E("shared-calculator-error-unplottable-long-inequality-chain"))}function Yx(e,{blockExport:t}){let n=new v(E("shared-calculator-error-comparator-type-error",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function Xx(e,{blockExport:t}){let n=new v(E("shared-calculator-error-operator-type-error",{symbol:"and",symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function Zx(e,{blockExport:t}){let n=new v(E("shared-calculator-error-operator-type-error",{symbol:"or",symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function vc(e,{blockExport:t}){let n=new v(E("shared-calculator-error-list-type-error",{symbol1:e[0]}));return t||n.allowExport(),n}function Wx(e,{blockExport:t}){let n=new v(E("shared-calculator-error-point-type-error",{symbol1:e,symbol2:oe(N)}));return t||n.allowExport(),n}function Bd(e,{blockExport:t}){let n=new v(E("shared-calculator-error-index-type-error",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function jx(e,t,{blockExport:n}){let r=new v(E("shared-calculator-error-coordinate-access-type-error",{coordinate:t,symbol:e[0]}));return n||r.allowExport(),r}function Hs(e,t,{blockExport:n}){let r;switch(t.length){case 1:r=new v(E("shared-calculator-error-function-type-error-1",{fn:X(e),arg:t[0]}));break;case 2:r=new v(E("shared-calculator-error-function-type-error-2",{fn:X(e),arg1:t[0],arg2:t[1]}));break;default:r=new v(E("shared-calculator-error-function-type-error-many",{fn:X(e)}));break}return n||r.allowExport(),r}var Cx={translate:"translation",rotate:"rotation",dilate:"dilation",reflect:"reflection"};function Jx(e,t,n,{blockExport:r}){let s=[];if(n.maxArity===void 0)return Hs(e,t,{blockExport:r});for(let a=1;a<n.argTypes.length;a++){let u=n.argTypes[a];typeof u=="number"?s.push(oe(u)):s.push(oe(u.getTypes()[0]))}let i="";switch(s.length){case 1:i=E(t.length>s.length?"shared-calculator-error-transformation-definition-expected-types-use-fewer-1":"shared-calculator-error-transformation-definition-expected-types-1",{arg:s[0]});break;case 2:i=E(t.length>s.length?"shared-calculator-error-transformation-definition-expected-types-use-fewer-2":"shared-calculator-error-transformation-definition-expected-types-2",{arg1:s[0],arg2:s[1]});break}let o;switch(t.length){case 1:o=new v(E(t.length<s.length?"shared-calculator-error-transformation-definition-type-error-use-more-1":"shared-calculator-error-transformation-definition-type-error-1",{fn:X(Cx[e]),arg:t[0],expectedTypeMessage:i}));break;case 2:o=new v(E(t.length<s.length?"shared-calculator-error-transformation-definition-type-error-use-more-2":"shared-calculator-error-transformation-definition-type-error-2",{fn:X(Cx[e]),arg1:t[0],arg2:t[1],expectedTypeMessage:i}));break;default:o=new v(E("shared-calculator-error-transformation-definition-type-error-many",{fn:X(Cx[e])}));break}return r||o.allowExport(),o}function Qx(e,t,{blockExport:n}){let r;switch(t.length){case 1:r=new v(E("shared-calculator-error-transformation-type-error-1",{fn:X(e),arg:t[0]}));break;case 2:r=new v(E("shared-calculator-error-transformation-type-error-2",{fn:X(e),arg1:t[0],arg2:t[1]}));break;default:r=new v(E("shared-calculator-error-transformation-type-error-many",{fn:X(e)}));break}return n||r.allowExport(),r}function Kx(e,t,{blockExport:n}){let r=X(e),s=X("count"),i=new v(E("shared-calculator-error-geometry-length-type-error",{fn:r,alternativeFn:s,arg:t}));return n||i.allowExport(),i}function eT(e,t,{blockExport:n}){let r=X(e),s=X("count"),i=new v(E("shared-calculator-error-3d-length-type-error",{fn:r,alternativeFn:s,arg:t}));return n||i.allowExport(),i}function Gd(e){return new v(E("shared-calculator-error-illegal-dot-call",{symbol:X(e)}))}function tT(e,t,{blockExport:n}){let r=new v(E("shared-calculator-error-dot-lhs-type-error",{symbol:X(e),type:t}));return n||r.allowExport(),r}function ly(){return new v(E("shared-calculator-error-dot-lhs-constant-number"))}function nT(e){return new v(E("shared-calculator-error-dot-rhs-property-error",{symbol:X(e)}))}function rT(e,{blockExport:t}){let n=new v(E("shared-calculator-error-sum-lower-bound-type-error",{symbol:e[0]}));return t||n.allowExport(),n}function sT(e,{blockExport:t}){let n=new v(E("shared-calculator-error-sum-upper-bound-type-error",{symbol:e[0]}));return t||n.allowExport(),n}function py(){return new v(E("shared-calculator-error-sum-infinite-bound-type-error"))}function iT(e,{blockExport:t}){let n=new v(E("shared-calculator-error-sum-argument-type-error",{symbol:e[0]}));return t||n.allowExport(),n}function oT(e,{blockExport:t}){let n=new v(E("shared-calculator-error-product-lower-bound-type-error",{symbol:e[0]}));return t||n.allowExport(),n}function aT(e,{blockExport:t}){let n=new v(E("shared-calculator-error-product-upper-bound-type-error",{symbol:e[0]}));return t||n.allowExport(),n}function dy(){return new v(E("shared-calculator-error-product-infinite-bound-type-error"))}function uT(e,{blockExport:t}){let n=new v(E("shared-calculator-error-product-argument-type-error",{symbol:e[0]}));return t||n.allowExport(),n}function cT(e,{blockExport:t}){let n=new v(E("shared-calculator-error-integral-lower-bound-type-error",{symbol:e[0]}));return t||n.allowExport(),n}function lT(e,{blockExport:t}){let n=new v(E("shared-calculator-error-integral-upper-bound-type-error",{symbol:e[0]}));return t||n.allowExport(),n}function pT(e,{blockExport:t}){let n=new v(E("shared-calculator-error-integral-argument-type-error",{symbol:e[0]}));return t||n.allowExport(),n}function dT(e,{blockExport:t}){let n=new v(E("shared-calculator-error-derivative-type-error",{symbol:e[0]}));return t||n.allowExport(),n}function fT(e,{blockExport:t}){let n=new v(E("shared-calculator-error-derivative-type-error-respect",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function mT(e,t,{blockExport:n}){let r=new v(E("shared-calculator-error-derivative-variable-type-error",{symbol1:X(e),symbol2:t[0]}));return n||r.allowExport(),r}function yT(e,t,{blockExport:n}){let r=new v(E("shared-calculator-error-prime-variable-type-error",{symbol1:X(e),symbol2:t[0]}));return n||r.allowExport(),r}function fy(e,{blockExport:t}){let n=new v(E("shared-calculator-error-piecewise-condition-type-error",{symbol1:oe(De),symbol2:e[0]}));return t||n.allowExport(),n}function gT(e,{blockExport:t}){let n=new v(E("shared-calculator-error-piecewise-branch-type-error",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function hT(e){return new v(E("shared-calculator-error-table-header-type-error",{symbol:e[0]}))}function bT(e){return new v(E("shared-calculator-error-table-entry-type-error",{symbol:e[0]}))}function xT(){return new v(E("shared-calculator-error-regression-recursion"))}function TT(e){return new v(E("shared-calculator-error-table-regression-type-error",{symbol:e}))}function IT(){return new v(E("shared-calculator-error-table-regression-invalid-data"))}function HV(){return new v(E("shared-calculator-error-table-regression-log-with-negative"))}function PT(e){return new v(E("shared-calculator-error-regression-type-error",{symbol1:e[0],symbol2:e[1]}))}function ET(e){return new v(E("shared-calculator-error-update-rule-type-error",{symbol:e}))}function MT(){return new v(E("shared-calculator-error-update-rule-non-identifier-lhs",{arrow:"\\u2192",example:"a"}))}function CT(e){return new v(E("shared-calculator-error-duplicate-update-rules",{symbol:X(e)}))}function DT(e){return new v(E("shared-calculator-error-update-rule-undefined-lhs",{symbol:X(e)}))}function ST(e){return new v(E("shared-calculator-error-update-rule-illegal-lhs",{symbol:X(e)}))}function vT(e){return new v(E("shared-calculator-error-update-rule-function-lhs",{symbol:X(e)}))}function my(e){return new v(E("shared-calculator-error-update-rule-local-lhs",{symbol:X(e)}))}function OT(e){let t=e.filter(n=>n.scope==="free").map(n=>n.symbol);return new v(E("shared-calculator-error-action-merge-free-variable",{symbol:X(t[0]||"")})).setDependencies(t).allowExport()}function kd(e){return new v(E("shared-calculator-error-event-handler-type-error",{example:"a\\u2192a+1"}))}function Hd({blockExport:e}){let t=new v(E("shared-calculator-error-heterogeneous-list"));return e||t.allowExport(),t}function yy(e,{blockExport:t}){let n=new v(E("shared-calculator-error-combine-type-error",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function Yl(e){return new v(E("shared-calculator-error-log-scale-type-error",{symbol:e})).allowExport()}function NT(){return new v(E("shared-calculator-error-log-scale-histogram"))}function RT(){return new v(E("shared-calculator-error-log-scale-dot-plot"))}function AT(){return new v(E("shared-calculator-error-log-scale-box-plot"))}function _T(){return new v(E("shared-calculator-error-deeply-nested")).allowExport()}function LT(){return new v(E("shared-calculator-error-3d-multiple-equality-restrictions")).allowExport()}function wT(){return new v(E("shared-calculator-error-3d-mixed-restriction-equation")).allowExport()}function ca(){return new v(E("shared-calculator-error-3d-bad-equality-slice")).allowExport()}function mu(e){return new v(E("shared-calculator-error-gpu-variable-list-length",{symbol:X(e.filter(t=>t.symbol!=="globalRandomSeed")[0].symbol)}))}function gy(e){return new v(E("shared-calculator-error-gpu-variable-sum",{symbol:X(e[0].symbol)}))}function hy(e){return new v(E("shared-calculator-error-gpu-variable-product",{symbol:X(e[0].symbol)}))}function Xl(e){return new v(E("shared-calculator-error-gpu-function-unsupported",{symbol:X(e)}))}function FT(){return new v(E("shared-calculator-error-gpu-integral-unsupported"))}function VT(){return new v(E("shared-calculator-error-gpu-long-sum",{maxTermCount:1e3.toLocaleString()}))}function BT(){return new v(E("shared-calculator-error-gpu-long-product",{maxTermCount:1e3.toLocaleString()}))}function Oc(){return new v(E("shared-calculator-error-gpu-max-list-size",{maxListSize:100 .toLocaleString()}))}function zd(){return new v(E("shared-calculator-error-max-list-size",{maxListSize:1e4.toLocaleString()})).allowExport()}function Ud(){return new v(E("shared-calculator-error-two-numbers-error"))}function GT(){return new v(E("shared-calculator-error-boxplot-offset-invalid"))}function kT(){return new v(E("shared-calculator-error-boxplot-breadth-invalid"))}function by(e,t){return new v(E("shared-calculator-error-too-many-arguments",{symbol:e,max:t}))}function HT(){let e=E("shared-calculator-error-pdf-wrong-arity-recommendation"),t=E("shared-calculator-error-pdf-wrong-arity",{recommendation:e});return new v(t)}function zT(){let e=E("shared-calculator-error-cdf-wrong-arity-recommendation"),t=E("shared-calculator-error-cdf-wrong-arity",{recommendation:e});return new v(t)}function UT(){let e=E("shared-calculator-error-cdf-too-many-arguments-recommendation"),t=E("shared-calculator-error-cdf-too-many-arguments",{recommendation:e});return new v(t)}function qT(){return new v(E("shared-calculator-error-tdist-wrong-arity"))}function $T(){return new v(E("shared-calculator-error-random-arity"))}function YT(){return new v(E("shared-calculator-error-random-from-broadcast-distribution"))}function XT(e){let t=e==="rgb"?[150,30,100]:[180,.5,.5],n=E("shared-calculator-error-color-arity-recommendation",{recommendation:X(e)+"("+t.join(", ")+")"}),r=E("shared-calculator-error-color-arity",{symbol:e,recommendation:n});return new v(r)}function Ao(e,t,n,r){e=X(e);let s,i;if(t===1)i=r.includeUsageExample?E("shared-calculator-error-wrong-arity-supplement",{recommendation:r.usageExample||e+"(x)"}):"",n>1?s=E("shared-calculator-error-wrong-arity-single-arg-too-many",{dependency:e,supplement:i}):s=E("shared-calculator-error-wrong-arity-single-arg-too-few",{dependency:e,supplement:i});else{let o=[],a=r.usageExample;if(!a){for(let u=0;u<t;u++)o[u]=u+1;a=X(e)+"("+o.join(", ")+")"}i=r.includeUsageExample?E("shared-calculator-error-wrong-arity-supplement",{recommendation:a}):"",s=E("shared-calculator-error-wrong-arity-many-arg",{dependency:e,assignment_arity:t,supplement:i})}return new v(s)}function ZT(){let e=E("shared-calculator-error-wrong-arity-supplement",{recommendation:"length(x)"}),t=E("shared-calculator-error-wrong-arity-single-arg-too-few",{dependency:"length",supplement:e});return new v(t)}function WT(e){return new v(E("shared-calculator-error-wrong-two-arg-arity",{symbol:X(e),recommendation:X(e)+"([1,2,3], 1)"}))}function qd(e){return new v(E("shared-calculator-error-wrong-two-arg-arity",{symbol:X(e),recommendation:X(e)+"([1,2,3], [3,2,1])"}))}function Nc(){return new v(E("shared-calculator-error-primed-function-arity"))}function jT(e){return new v(E("shared-calculator-error-zero-arg-reducer",{symbol:X(e)}))}function JT(){return new v(E("shared-calculator-error-malformed-point"))}function QT(){return new v(E("shared-calculator-error-malformed-list"))}function KT(e){return new v(E("shared-calculator-error-bad-tuple-dimensions",{symbol:e}))}function xy(e){return e=X(e),new v(E("shared-calculator-error-bad-implicit-call",{symbol:e}))}function eI(e,t){return new v(E("shared-calculator-error-adjacent-numbers",{left:e,right:t}))}function Ty(e){return new v(E("shared-calculator-error-adjacent-mixed-number",{mixedNumber:e}))}function tI(){return new v(E("shared-calculator-error-token-with-subscript"))}function Iy(e){return e=X(e),new v(E("shared-calculator-error-identifier-as-function",{symbol:e}))}function Py(e){return e=X(e),new v(E("shared-calculator-error-identifier-is-not-function",{symbol:e}))}function $d(e){return e=X(e),e==="%"&&(e="% of"),new v(E("shared-calculator-error-binary-operator-missing-operand",{symbol:e}))}function nI(e){return e=X(e),new v(E("shared-calculator-error-unary-operator-missing-left",{symbol:e}))}function rI(e){return e=X(e),new v(E("shared-calculator-error-unary-operator-missing-right",{symbol:e}))}function sI(){return new v(E("shared-calculator-error-fraction-missing-numerator"))}function iI(){return new v(E("shared-calculator-error-fraction-missing-denominator"))}function oI(){return new v(E("shared-calculator-error-fraction-empty"))}function Ey(){return new v(E("shared-calculator-error-empty-subscript"))}function aI(){return new v(E("shared-calculator-error-empty-superscript"))}function uI(e){return e=X(e),new v(E("shared-calculator-error-invalid-subscript",{symbol:e}))}function cI(){return new v(E("shared-calculator-error-invalid-operator-name"))}function lI(){return new v(E("shared-calculator-error-unexpected-subscript"))}function pI(){return new v(E("shared-calculator-error-superscript-with-prime"))}function My(){return new v(E("shared-calculator-error-unexpected-prime"))}function Cy(){return new v(E("shared-calculator-error-prime-without-paren"))}function dI(){return new v(E("shared-calculator-error-empty-radical"))}function fI(){return new v(E("shared-calculator-error-empty-radical-index"))}function Yd(){return new v(E("shared-calculator-error-empty-paren"))}function mI(){return new v(E("shared-calculator-error-empty-square-bracket"))}function yI(){return new v(E("shared-calculator-error-empty-pipe"))}function gI(e){let t=e+"^2",n=e+"^-1";return new v(E("shared-calculator-error-bad-trig-exponent",{form1:t,form2:n}))}function hI(e){let t=e+"^2";return new v(E("shared-calculator-error-bad-log-exponent",{form:t}))}function bI(){return new v(E("shared-calculator-error-piecewise-missing-condition"))}function xI(){return new v(E("shared-calculator-error-piecewise-part-missing-condition"))}function TI(){return new v(E("shared-calculator-error-colon-missing-condition"))}function Xd(){let e=new v(E("shared-calculator-error-blank-expression"));return e.silent=!0,e}function Dy(e){return e=X(e),new v(E("shared-calculator-error-function-not-defined",{dependency:e}))}function Sy(e){return e=X(e),new v(E("shared-calculator-error-parameter-already-defined",{dependency:e}))}function II(e){return e=X(e),new v(E("shared-calculator-error-duplicate-function-parameter",{dependency:e}))}function PI(e){return e=X(e),new v(E("shared-calculator-error-function-name-as-parameter",{dependency:e}))}function Zl(e,t){return e=X(e),t===void 0?new v(E("shared-calculator-error-cannot-redefine",{symbol:e})):new v(E("shared-calculator-error-cannot-redefine-root",{symbol:e,symbolRoot:t}))}function EI(e){return e=X(e),new v(E("shared-calculator-error-cannot-subscript",{symbol:e}))}function Wl(e){return e=X(e),new v(E("shared-calculator-error-multiply-defined",{dependency:e}))}function vy(e){return e=X(e),new v(E("shared-calculator-error-shadowed-index",{symbol:e}))}function MI(e){e=e.map(X);let t=e.pop()||"",n=new v(E("shared-calculator-error-dependency-cycle",{symbols:e.join("\', \'"),lastSymbol:t}));return n.isCyclicDependencyError=!0,n}function Rc(e,t){let n=e.length,r=e[0];return t.suggestAlternativeFunctionName&&n==1?new v(E("shared-calculator-error-self-referential-suggest-alternative",{symbol:X(r)})):new v(E("shared-calculator-error-self-referential-functions",{symbols:e.slice(1).map(s=>X(s)).join("\', \'"),lastSymbol:X(r),count:Cd(n)}))}function CI(e){return new v(E("shared-calculator-error-self-referential-base-case",{symbol:X(e)}))}function DI(){return new v(E("shared-calculator-error-ticker-min-step-nonnegative"))}function SI(e){return new v(E("shared-calculator-error-slider-limit-references-export",{symbol:X(e)}))}function vI(){return new v(E("shared-calculator-error-slider-min-invalid"))}function OI(){return new v(E("shared-calculator-error-slider-max-invalid"))}function NI(){return new v(E("shared-calculator-error-slider-max-less-than-min"))}function RI(){return new v(E("shared-calculator-error-slider-step-invalid"))}function AI(){return new v(E("shared-calculator-error-domain-min-invalid"))}function _I(){return new v(E("shared-calculator-error-domain-max-invalid"))}function LI(){return new v(E("shared-calculator-error-domain-max-less-than-min"))}function wI(){return new v(E("shared-calculator-error-cdf-min-invalid"))}function FI(){return new v(E("shared-calculator-error-cdf-max-invalid"))}function VI(){return new v(E("shared-calculator-error-cdf-max-less-than-min"))}function BI(){return new v(E("shared-calculator-error-use-rho-for-spherical-coordinates"))}function GI(){return new v(E("shared-calculator-error-use-r-for-cylindrical-coordinates"))}function Oy(){return new v(E("shared-calculator-error-cant-combine-spherical-and-cylindrical"))}function rn(e){if(e=e.map(X),e.length===0)return new v(E("shared-calculator-error-too-many-variables-no-symbols"));let t=e.pop()||"";return e.length>0?new v(E("shared-calculator-error-too-many-variables-many-symbols",{variables:e.join("\', \'"),lastVariable:t})):new v(E("shared-calculator-error-too-many-variables-one-symbol",{variable:t}))}function kI(e){return new v(E("shared-calculator-error-cannot-restrict",{variable:X(e)}))}function HI(e){return new v(E("shared-calculator-error-cannot-assign-color",{variable:X(e)}))}function zI(e){return new v(E("shared-calculator-error-cannot-restrict-with-equality",{variable:X(e)}))}function Zd(e,t,n){e=e.map(X),t=X(t),n=n.map(X);let r=t+"("+n.join(",")+","+e.join(",")+")",s=e.pop()||"",i={symbols:e.join("\', \'"),lastSymbol:s,newSignature:r};return e.length?new v(E("shared-calculator-error-add-arguments-to-definition-many",i)):new v(E("shared-calculator-error-add-arguments-to-definition-one",i))}function UI(e){return e=X(e),new v(E("shared-calculator-error-invalid-lhs",{symbol:e}))}function qI(){return new v(E("shared-calculator-error-unplottable-polar-function"))}function $I(){return new v(E("shared-calculator-error-invalid-inequality-variables"))}function Ac(){return new v(E("shared-calculator-error-invalid-implicit-variables"))}function YI(){return new v(E("shared-calculator-error-invalid-implicit-variables-3d"))}function XI(){return new v(E("shared-calculator-error-single-variable-implicit-equations-disabled"))}function ZI(){return new v(E("shared-calculator-error-implicits-disabled"))}function Ny(e){let t=new v(e==="="?E("graphing-calculator-error-nan-blame-complex-coercion"):E("shared-calculator-error-complex-operation-undefined",{symbol:X(e)}));return t.warning=t.getError(),t.silent=!0,t}function zV(){return new v(E("shared-calculator-error-complex-table-point-coordinate"))}function Ry(){return new v(E("shared-calculator-error-inequalities-disabled"))}function WI(){return new v(E("shared-calculator-error-complicated-polar-implicit"))}function jI(){return new v(E("shared-calculator-error-invalid-double-inequality-3d"))}function JI(){return new v(E("shared-calculator-error-invalid-double-equality-3d"))}function QI(){return new v(E("shared-calculator-error-unplottable-chained-equality"))}function Ay(){return new v(E("shared-calculator-error-invalid-double-inequality-variables"))}function _y(){return new v(E("shared-calculator-error-mismatched-double-inequality",{example:"1 < y < 2"}))}function Ly(){return new v(E("shared-calculator-error-complicated-double-inequality"))}function wy(e){return e?(e=X(e),new v(E("shared-calculator-error-equation-required-symbol",{lhs:e+"="}))):new v(E("shared-calculator-error-equation-required"))}function Fy(e){return e=X(e),new v(E("shared-calculator-error-variable-as-function",{dependency:e}))}function Vy(e){return e=X(e),new v(E("shared-calculator-error-distribution-as-function",{symbol:e}))}function KI(e){return new v(E("shared-calculator-error-invalid-table-header",{supplement:e}))}function Wd(e){return new v(E("shared-calculator-error-invalid-table-entry",{supplement:e}))}function eP(){return new v(E("shared-calculator-error-invalid-first-table-column",{most:"\'y\', \'r\',",last:"\'\\u03B8\'"}))}function UV(){return new v(E("shared-calculator-error-invalid-dependent-first-table-column"))}function tP(e){return new v(E("shared-calculator-error-invalid-regression-parameter",{symbol:X(e)}))}function nP(){return new v(E("shared-calculator-error-optimization-error"))}function jd(e,{blockExport:t}){let n=new v(E("shared-calculator-error-non-list-double-reducer",{symbol:X(e),recommendation:X(e)+"([1,2,3], [3,2,1])"}));return t||n.allowExport(),n}function rP(e,{blockExport:t}){let n=new v(E("shared-calculator-error-non-list-parameterized-reducer",{symbol:X(e),recommendation:X(e)+"([1,2,3], 1)"}));return t||n.allowExport(),n}function so(e,{blockExport:t}){let n=new v(E("shared-calculator-error-method-requires-list",{symbol:X(e),recommendation:X(e)+"([1,2,3])"}));return t||n.allowExport(),n}function Jd(){return new v(E("shared-calculator-error-non-arithmetic-range")).allowExport()}function sP(){return new v(E("shared-calculator-error-invalid-half-empty-range"))}function iP(){return new v(E("shared-calculator-error-sum-missing-bound"))}function oP(){return new v(E("shared-calculator-error-product-missing-bound"))}function aP(){return new v(E("shared-calculator-error-incorrect-sum-lower-bound"))}function uP(){return new v(E("shared-calculator-error-incorrect-product-lower-bound"))}function cP(e){return new v(E("shared-calculator-error-bad-sum-bound-dependency",{symbol:X(e)}))}function lP(e){return new v(E("shared-calculator-error-bad-product-bound-dependency",{symbol:X(e)}))}function pP(){return new v(E("shared-calculator-error-integral-missing-bound"))}function dP(){return new v(E("shared-calculator-error-integral-missing-differential"))}function fP(){return new v(E("shared-calculator-error-differential-with-superscript"))}function mP(){return new v(E("shared-calculator-error-sum-missing-body"))}function yP(){return new v(E("shared-calculator-error-product-missing-body"))}function gP(){return new v(E("shared-calculator-error-integral-missing-body"))}function hP(){return new v(E("shared-calculator-error-derivative-missing-body"))}function bP(e,t){return e=X(e),t=X(t),new v(E("shared-calculator-error-mismatched-braces",{symbol1:e,symbol2:t}))}function By(e){return new v(E("shared-calculator-error-shadowed-integration-variable",{symbol:X(e)}))}function xP(e){return new v(E("shared-calculator-error-bad-integral-bound-dependency",{symbol:X(e)}))}function TP(){return new v(E("shared-calculator-error-percent-missing-of"))}function Qd(e){return e=X(e),new v(E("shared-calculator-error-illegal-bin-width",{symbol:e}))}function jl(e){return e=X(e),new v(E("shared-calculator-error-ttest-list-too-short",{symbol:e}))}function IP(){return new v(E("shared-calculator-error-bad-sample-size"))}function PP(e){return new v(E("shared-calculator-error-variable-seed",{symbol:X(e[0].symbol)})).setDependencies(e.filter(t=>t.scope==="free").map(t=>t.symbol)).allowExport()}function Kd(e){return new v(E("shared-calculator-error-bad-symbol-context",{symbol:X(e)}))}function Gy(){return new v(E("shared-calculator-error-write-integral",{command:"integral",symbol:"\\u222B"}))}function EP(){return new v(E("shared-calculator-error-ans-undefined"))}function ef(e){return new v(E("shared-calculator-error-variables-unsupported",{variable:X(e)}))}function ky(){return new v(E("shared-calculator-error-polygon-unsupported-in-3d"))}function VD(e){return new v(E("shared-calculator-error-function-only-works-in-complex",{symbol:X(e)}))}function Li(e,t){return t!=null&&t.is3dPolicy()&&e==="polygon"?ky():!!t&&!(t!=null&&t.isGeometryEnabled())&&!(t instanceof Cc)&&!t.isComplexEnabled()&&FD.indexOf(e)!==-1?VD(e):new v(E("shared-calculator-error-function-unsupported",{symbol:X(e)}))}function MP(){return new v(E("shared-calculator-error-logbase-unsupported"))}function _c(e){return new v(E("shared-calculator-error-constant-unsupported",{symbol:X(e)}))}function Hy(e){return new v(E("shared-calculator-error-variable-unsupported",{symbol:X(e)}))}function zy(e){return new v(E("shared-calculator-error-variable-invalid-function-name",{symbol:X(e)}))}function tf(){return new v(E("shared-calculator-error-assignments-unsupported"))}function nf(){return new v(E("shared-calculator-error-function-definition-unsupported"))}function Ua(){return new v(E("shared-calculator-error-equations-unsupported"))}function Lc(){return new v(E("shared-calculator-error-inequalities-unsupported"))}function wc(){return new v(E("shared-calculator-error-regressions-unsupported"))}function CP(){return new v(E("shared-calculator-error-custom-regressions-unsupported"))}function Fc(){return new v(E("shared-calculator-error-points-unsupported"))}function rf(){return new v(E("shared-calculator-error-feature-unavailable"))}function Uy(){return new v(E("basic-calculator-error-fractions-unavailable"))}function DP(){return new v(E("basic-calculator-error-parentheses-unavailable"))}function qV(){return new v(E("shared-calculator-error-non-square-determinant"))}function $V(){return new v(E("shared-calculator-error-non-square-trace"))}function YV(){return new v(E("shared-calculator-error-non-square-inverse"))}function XV(){return new v(E("shared-calculator-error-non-singular-inverse"))}function ZV(e){return new v(E("shared-calculator-error-clickable-object-assignment-not-defined",{symbol:e}))}function WV(e){return new v(E("shared-calculator-error-multiply-defined",{dependency:e}))}function jV(){return new v(E("shared-calculator-error-clickable-object-assignment-not-identifier"))}function JV(){return new v(E("shared-calculator-error-clickable-object-invalid-expression"))}function QV(){return new v(E("shared-calculator-error-matrix-assignment"))}function KV(){return new v(E("shared-calculator-error-matrix-add-dimensions"))}function eB(){return new v(E("shared-calculator-error-matrix-subtract-dimensions"))}function tB(){return new v(E("shared-calculator-error-matrix-multiply-dimensions"))}function nB(){return new v(E("shared-calculator-error-matrix-fractional-power"))}function rB(){return new v(E("shared-calculator-error-matrix-power-dimensions"))}function sB(e){return new v(E("shared-calculator-error-matrix-element-type-error",{arg:e[0]}))}function iB(e){return new v(E("shared-calculator-error-matrix-invalid-variable",{symbol:X(e)}))}function SP(e,t,n,{blockExport:r}){let s="[1...10]";n&&!/[\\\\]/.test(n)&&(s=`[${n}]`);let i=new v(E("shared-calculator-error-list-comprehension-input-type-error",{identifier:e,actual:t,example:s}));return r||i.allowExport(),i}function vP(){return new v(E("shared-calculator-error-incorrect-list-comprehension-input"))}function qy(e){return e=X(e),new v(E("shared-calculator-error-shadowed-list-comprehension-input",{symbol:e}))}function OP(e){return e=X(e),new v(E("shared-calculator-error-bad-for-input-list-dependency",{symbol:e}))}function NP(e){return e=X(e),new v(E("shared-calculator-error-bad-for-interval-dependency",{symbol:e}))}function RP(e){let t=e.filter(n=>n.scope==="free").map(n=>n.symbol);return new v(E("shared-calculator-error-variable-length-top-level-list",{symbol:X(t[0]||"")})).setDependencies(t).allowExport()}function sf(e){return new v(E("shared-calculator-error-variable-length-distribution-list",{symbol:e[0].symbol})).setDependencies(e.filter(t=>t.scope==="free").map(t=>t.symbol))}function AP(e){return new v(E("shared-calculator-error-variable-length-sum-body-depends-on-index",{symbol:e}))}function _P(e){return new v(E("shared-calculator-error-variable-length-product-body-depends-on-index",{symbol:e}))}function LP(e){return new v(E("shared-calculator-error-variable-length-integral-depends-on-integration-var",{symbol:e}))}function oB(e,t){return new v(E("shared-calculator-error-substitution-type-error",{actual:oe(e),expected:oe(t)}))}function of(){return new v(E("shared-calculator-error-substitution-invalid-assignments"))}function wP(e){return new v(E("shared-calculator-error-substitution-local-lhs",{symbol:X(e)}))}function af(e){return new v(E("shared-calculator-error-substitution-illegal-lhs",{symbol:X(e)}))}function uf(e){return new v(E("shared-calculator-error-substitution-function-lhs",{symbol:X(e)}))}function FP(e,t,n){return new v(E("shared-calculator-error-substitution-body-regression-parameter-dependency",{globalVariable:X(e),regressionParameter:X(t),operator:n}))}function aB(){return new v(E("shared-calculator-error-substitution-body-action"))}function $y(){return new v(E("shared-calculator-error-substitution-nested"))}function yu(e){return new v(E("shared-calculator-error-substitution-ambiguous-comma",{operation:e}))}function VP(e){return new v(E("shared-calculator-error-substitution-duplicate-assignment",{symbol:X(e)}))}function BP(e,t,n){return new v(E("shared-calculator-error-substitution-recursive-call-lhs",{operator:e,globalVariable:X(t),fnSymbol:X(n)}))}function GP(){return new v(E("shared-calculator-error-depends-on-deleted-geo-object"))}function kP(e){return new v(E("shared-calculator-error-invalid-interval-comprehension-return-type",{type:oe(e)}))}function HP(e,t){return new v(E("shared-calculator-error-bad-interval-comprehension-arity",{type:oe(e),count:Cd(t)}))}function Jl(e){return new v(E("shared-calculator-error-invalid-interval-comprehension-invalid-bound",{identifier:e}))}function zP(){return new v(E("shared-calculator-error-nested-interval-comprehension"))}function Yy(){return new v(E("shared-calculator-error-substitution-unsupported-interval"))}function UP(e){return new v(E("shared-calculator-error-table-regression-invalid-export-identifier",{latex:"`"+e+"`"}))}function qP(e){return new v(e.length===1?E("graphing-calculator-error-table-regression-unexportable-reserved-variable-single",{variable:"`"+e[0]+"`"}):E("graphing-calculator-error-table-regression-unexportable-reserved-variables-many"))}function We(e){return Object.keys(e)}function Tn(e){return Object.create(e)}var BD=Symbol("DEPENDENCY_ORDER");function GD(e){let t=e[BD];if(!t)throw U("Missing dependency order.");return t}function $P(e,t){e[BD]=t}function gu(e){return typeof e!="object"||!e?!1:e.type==="Action"}function bX(e){return j(e.valueType)}var Gi={};ia(Gi,{LruCache:()=>up,RECURSIVE_COMPUTATION_LIMIT:()=>JS,RECURSIVE_DEPTH_LIMIT:()=>Df,RecursiveFunctionResult:()=>jS,SYMBOL_DIVERGES:()=>WS,TerminationStatus:()=>QS,_complexGCD:()=>i0,acosh:()=>YS,acot:()=>s3,acoth:()=>d3,acsc:()=>i3,acsch:()=>p3,addTangentAngle:()=>$2,addTangentArc:()=>q2,addTangentCircle:()=>U2,addTangentLine:()=>k2,addTangentPolygon:()=>B2,addTangentRay:()=>H2,addTangentSegment:()=>Ng,addTangentSegmentThreeD:()=>G2,addTangentTransformation:()=>Y2,addTangentVector:()=>z2,angleMarkerMultiplier:()=>S2,angleMarkerRawDelta:()=>D2,angleStart:()=>P2,angleVertex:()=>I2,anglebisector:()=>aG,arc:()=>h2,arcArcIntersection:()=>tG,arcCenter:()=>yp,arcCircleIntersection:()=>eG,arcFirstPoint:()=>b2,arcGlider:()=>Dv,arcLineIntersection:()=>Ov,arcMiddlePoint:()=>x2,arcOmega:()=>gp,arcThirdPoint:()=>T2,arg:()=>GG,argMax:()=>k3,argMin:()=>G3,asec:()=>o3,asech:()=>l3,asinh:()=>XS,atanh:()=>ZS,basePointFromVector:()=>c2,basePointFromVectorThreeD:()=>d2,bernoulliTable:()=>tv,binomSample:()=>C3,binomcdf:()=>S3,binompdf:()=>Cg,center:()=>y2,chooseNonIncidentPoint:()=>J2,circle:()=>m2,circleArcIntersection:()=>K2,circleCircleIntersection:()=>Mf,circleGlider:()=>Z2,circleLineIntersection:()=>JE,clamp:()=>hr,coerceComplexToReal:()=>s0,coerceRealToComplex:()=>rk,common_log:()=>KB,compareComplexLexicographic:()=>mv,complex:()=>zt,complexAcos:()=>Hv,complexAcosh:()=>Uv,complexAcot:()=>QG,complexAcoth:()=>tk,complexAcsc:()=>JG,complexAcsch:()=>ek,complexAsec:()=>jG,complexAsech:()=>KG,complexAsin:()=>r0,complexAsinh:()=>zv,complexAtan:()=>CE,complexAtanh:()=>xg,complexCeil:()=>sk,complexCommonLog:()=>e3,complexCos:()=>Vv,complexCosh:()=>kv,complexCot:()=>YG,complexCoth:()=>WG,complexCsc:()=>$G,complexCsch:()=>ZG,complexDivide:()=>Du,complexExp:()=>HG,complexFloor:()=>qv,complexFromPolarRounded:()=>Eu,complexGCD:()=>SE,complexLCM:()=>vE,complexListGCD:()=>YB,complexListLCM:()=>XB,complexLog:()=>ME,complexLogbase:()=>sv,complexMod:()=>ik,complexMultiplyPoints:()=>Av,complexPow:()=>UG,complexPowReal:()=>wv,complexReciprocal:()=>Is,complexRound:()=>ap,complexSec:()=>qG,complexSech:()=>XG,complexSin:()=>Fv,complexSinh:()=>Gv,complexSortPerm:()=>L3,complexSqrt:()=>Lv,complexTan:()=>Bv,complexTanh:()=>n0,composeTransformation:()=>bG,conj:()=>Zc,corr:()=>Og,cos:()=>Mn,cosh:()=>fp,cot:()=>r3,cotDerivative:()=>nv,coth:()=>c3,cov:()=>z3,covp:()=>bv,csc:()=>n3,csch:()=>u3,dilation:()=>yG,directedAngleMarker:()=>Mv,directedAngleStart:()=>M2,directedAngleVertex:()=>E2,directedCoterminalAngle:()=>Cv,distance:()=>pp,distanceThreeD:()=>Y3,elementsAt:()=>OG,erf:()=>N3,erfcx:()=>Za,executeRecursiveFunction:()=>HB,expm1:()=>LB,factorial:()=>ma,frequency:()=>AG,gcd:()=>lg,getArcDetails:()=>Rg,getBroadcastTargetElements:()=>BB,getRecursiveDepthLimit:()=>VB,handleRecursionLimitExceeded:()=>ev,hsv:()=>X3,hypot:()=>Ts,identity:()=>f2,imag:()=>BG,invBinom:()=>cv,invNorm:()=>BE,invPoisson:()=>uv,invT:()=>lv,invUniform:()=>A3,invertTransformation:()=>xG,isDegenerateArc:()=>YE,itscore:()=>dv,ittest:()=>kE,lcm:()=>xE,line:()=>i2,lineArcIntersection:()=>vv,lineCircleIntersection:()=>jE,lineGlider:()=>ZE,lineLineIntersection:()=>Sv,listGCD:()=>qB,listLCM:()=>$B,listLength:()=>_3,listMax:()=>Sg,listMin:()=>Dg,log:()=>QB,log1p:()=>mp,log_base:()=>dg,lowerQuantileIndex:()=>F3,lowerQuartileIndex:()=>B3,mad:()=>H3,mathVector:()=>Iv,mathVectorThreeD:()=>Pv,md5Spyable:()=>$S,mean:()=>ya,median:()=>gv,mod:()=>Yc,nCr:()=>Pu,nPr:()=>pg,normalSample:()=>E3,normalcdf:()=>I3,normalpdf:()=>_E,parallel:()=>iG,peelableCoerceComplexToReal:()=>nk,perpendicular:()=>oG,pointDet:()=>_v,pointDot:()=>uG,pointPerp:()=>cG,poissonSample:()=>D3,poissoncdf:()=>v3,poissonpdf:()=>lp,polyGamma:()=>rv,polygon:()=>Z3,polygonArea:()=>qE,polygonEdgeByParameter:()=>W2,polygonEdges:()=>K3,polygonGlider:()=>j2,polygonInteriorDirectedAngles:()=>s2,polygonInteriorUndirectedAngles:()=>r2,polygonPerimeter:()=>e2,pow:()=>FB,quad:()=>$3,quantile:()=>fv,quartile:()=>Xc,quartileIndex:()=>vg,radius:()=>g2,random:()=>wE,randomPerm:()=>FE,rank:()=>PE,rawTransform:()=>lG,rawTransformConj:()=>pG,ray:()=>o2,rayGlider:()=>EE,real:()=>VG,recursionCacheKey:()=>bE,recursionDiverges:()=>KS,recursionMissingCacheEntry:()=>kB,recursionSuccess:()=>GB,reflection:()=>hG,restriction:()=>wG,restrictionToBoolean:()=>FG,rgb:()=>xv,rotation:()=>gG,scaleTangentAngle:()=>V2,scaleTangentArc:()=>F2,scaleTangentCircle:()=>w2,scaleTangentLine:()=>_2,scaleTangentPolygon:()=>A2,scaleTangentRay:()=>L2,scaleTangentSegment:()=>XE,scaleTangentTransformation:()=>R2,sec:()=>t3,sech:()=>a3,segment:()=>$E,segmentGlider:()=>WE,segmentThreeD:()=>W3,segmentThreeDGlider:()=>X2,select:()=>vG,serializeNonNumericSeedPart:()=>LE,shuffle:()=>P3,sign:()=>NE,sin:()=>dn,sinh:()=>jc,sortPerm:()=>Jc,spearman:()=>U3,sphere:()=>J3,sqrtxsqm1:()=>UB,sqrtxsqp1:()=>zB,stats:()=>HE,stdev:()=>fg,stdevp:()=>q3,supplementAngle:()=>O2,tSample:()=>M3,tan:()=>AE,tanh:()=>OE,tcdf:()=>ug,testingOnlySetRecursiveDepthLimit:()=>RE,toFraction:()=>wB,tone:()=>RG,total:()=>m3,tpdf:()=>Mg,transformAngleMarker:()=>SG,transformArc:()=>CG,transformCircle:()=>MG,transformLine:()=>IG,transformPoint:()=>oo,transformPolygon:()=>DG,transformRay:()=>PG,transformScaleFactor:()=>fG,transformSegment:()=>t0,transformVector:()=>EG,transformWithoutTranslation:()=>dG,translation:()=>mG,triangle:()=>j3,tscore:()=>pv,ttest:()=>GE,undirectedAngleMarker:()=>C2,undirectedCoterminalAngle:()=>v2,uniformSample:()=>Mu,uniformcdf:()=>O3,uniformpdf:()=>VE,uniquePerm:()=>NG,upperQuantileIndex:()=>w3,upperQuartileIndex:()=>V3,validateRangeLength:()=>zE,validateSampleCount:()=>UE,variance:()=>hv,varp:()=>Sf,vector:()=>a2,vectorDisplacementAsPoint:()=>u2,vectorThreeD:()=>l2,vectorThreeDDisplacementAsPoint:()=>p2,vertices:()=>Q3,volume:()=>_G});var kD=function(){"use strict";function e(g,m){let h=(g&65535)+(m&65535);return(g>>16)+(m>>16)+(h>>16)<<16|h&65535}function t(g,m){return g<<m|g>>>32-m}function n(g,m,h,x,T,b){return e(t(e(e(m,g),e(x,b)),T),h)}function r(g,m,h,x,T,b,M){return n(m&h|~m&x,g,m,T,b,M)}function s(g,m,h,x,T,b,M){return n(m&x|h&~x,g,m,T,b,M)}function i(g,m,h,x,T,b,M){return n(m^h^x,g,m,T,b,M)}function o(g,m,h,x,T,b,M){return n(h^(m|~x),g,m,T,b,M)}function a(g,m){g[m>>5]|=128<<m%32,g[(m+64>>>9<<4)+14]=m;let h,x,T,b,M,P=1732584193,D=-271733879,S=-1732584194,O=271733878;for(h=0;h<g.length;h+=16)x=P,T=D,b=S,M=O,P=r(P,D,S,O,g[h],7,-680876936),O=r(O,P,D,S,g[h+1],12,-389564586),S=r(S,O,P,D,g[h+2],17,606105819),D=r(D,S,O,P,g[h+3],22,-1044525330),P=r(P,D,S,O,g[h+4],7,-176418897),O=r(O,P,D,S,g[h+5],12,1200080426),S=r(S,O,P,D,g[h+6],17,-1473231341),D=r(D,S,O,P,g[h+7],22,-45705983),P=r(P,D,S,O,g[h+8],7,1770035416),O=r(O,P,D,S,g[h+9],12,-1958414417),S=r(S,O,P,D,g[h+10],17,-42063),D=r(D,S,O,P,g[h+11],22,-1990404162),P=r(P,D,S,O,g[h+12],7,1804603682),O=r(O,P,D,S,g[h+13],12,-40341101),S=r(S,O,P,D,g[h+14],17,-1502002290),D=r(D,S,O,P,g[h+15],22,1236535329),P=s(P,D,S,O,g[h+1],5,-165796510),O=s(O,P,D,S,g[h+6],9,-1069501632),S=s(S,O,P,D,g[h+11],14,643717713),D=s(D,S,O,P,g[h],20,-373897302),P=s(P,D,S,O,g[h+5],5,-701558691),O=s(O,P,D,S,g[h+10],9,38016083),S=s(S,O,P,D,g[h+15],14,-660478335),D=s(D,S,O,P,g[h+4],20,-405537848),P=s(P,D,S,O,g[h+9],5,568446438),O=s(O,P,D,S,g[h+14],9,-1019803690),S=s(S,O,P,D,g[h+3],14,-187363961),D=s(D,S,O,P,g[h+8],20,1163531501),P=s(P,D,S,O,g[h+13],5,-1444681467),O=s(O,P,D,S,g[h+2],9,-51403784),S=s(S,O,P,D,g[h+7],14,1735328473),D=s(D,S,O,P,g[h+12],20,-1926607734),P=i(P,D,S,O,g[h+5],4,-378558),O=i(O,P,D,S,g[h+8],11,-2022574463),S=i(S,O,P,D,g[h+11],16,1839030562),D=i(D,S,O,P,g[h+14],23,-35309556),P=i(P,D,S,O,g[h+1],4,-1530992060),O=i(O,P,D,S,g[h+4],11,1272893353),S=i(S,O,P,D,g[h+7],16,-155497632),D=i(D,S,O,P,g[h+10],23,-1094730640),P=i(P,D,S,O,g[h+13],4,681279174),O=i(O,P,D,S,g[h],11,-358537222),S=i(S,O,P,D,g[h+3],16,-722521979),D=i(D,S,O,P,g[h+6],23,76029189),P=i(P,D,S,O,g[h+9],4,-640364487),O=i(O,P,D,S,g[h+12],11,-421815835),S=i(S,O,P,D,g[h+15],16,530742520),D=i(D,S,O,P,g[h+2],23,-995338651),P=o(P,D,S,O,g[h],6,-198630844),O=o(O,P,D,S,g[h+7],10,1126891415),S=o(S,O,P,D,g[h+14],15,-1416354905),D=o(D,S,O,P,g[h+5],21,-57434055),P=o(P,D,S,O,g[h+12],6,1700485571),O=o(O,P,D,S,g[h+3],10,-1894986606),S=o(S,O,P,D,g[h+10],15,-1051523),D=o(D,S,O,P,g[h+1],21,-2054922799),P=o(P,D,S,O,g[h+8],6,1873313359),O=o(O,P,D,S,g[h+15],10,-30611744),S=o(S,O,P,D,g[h+6],15,-1560198380),D=o(D,S,O,P,g[h+13],21,1309151649),P=o(P,D,S,O,g[h+4],6,-145523070),O=o(O,P,D,S,g[h+11],10,-1120210379),S=o(S,O,P,D,g[h+2],15,718787259),D=o(D,S,O,P,g[h+9],21,-343485551),P=e(P,x),D=e(D,T),S=e(S,b),O=e(O,M);return[P,D,S,O]}function u(g){let m,h="",x=g.length*32;for(m=0;m<x;m+=8)h+=String.fromCharCode(g[m>>5]>>>m%32&255);return h}function c(g){let m,h=[];for(h[(g.length>>2)-1]=void 0,m=0;m<h.length;m+=1)h[m]=0;let x=g.length*8;for(m=0;m<x;m+=8)h[m>>5]|=(g.charCodeAt(m/8)&255)<<m%32;return h}function l(g){return u(a(c(g),g.length*8))}function p(g){let m="0123456789abcdef",h="",x,T;for(T=0;T<g.length;T+=1)x=g.charCodeAt(T),h+=m.charAt(x>>>4&15)+m.charAt(x&15);return h}function f(g){return unescape(encodeURIComponent(g))}function d(g){return l(f(g))}function y(g){return p(d(g))}return y}();function wi(e,t,n){return e>0==t>0?n===1?t:e+n*(t-e):e*(1-n)+t*n}function ar(e,t,n){return[wi(e[0],t[0],n),wi(e[1],t[1],n)]}function Fi(e,t,n){return[wi(e[0],t[0],n),wi(e[1],t[1],n),wi(e[2],t[2],n)]}function cf(e,t){return[e[0]+t[0],e[1]+t[1]]}function HD(e,t){return[e[0]-t[0],e[1]-t[1]]}function YP(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]}function XP(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function qa(e,t){return Ql(YP(e,t))}function Xy(e,t,n){return[wi(e[0],t[0],n[0]),wi(e[1],t[1],n[1])]}function zD(e,t){return[e[0]*t,e[1]*t]}function Ql(e){let[t,n,r]=e;return t*t+n*n+r*r}function Kl(e,t){let n=e[1]*t[2]-e[2]*t[1],r=e[2]*t[0]-e[0]*t[2],s=e[0]*t[1]-e[1]*t[0],i=Math.sqrt(n*n+r*r+s*s);return[n/i,r/i,s/i]}function ep(e,t,n){e=Math.fround(e),t=Math.fround(t),n=Math.fround(n);let r=Math.fround(e*e+t*t+n*n);return isFinite(r)&&r!=0}function la([e,t,n]){return isFinite(e)&&isFinite(t)&&isFinite(n)}function xi(e,t){let n;e>t&&(n=e,e=t,t=n);let r=e>0,s=t>0,i=Math.abs(e)>.01,o=Math.abs(t)>.01;if(i||o)return Va(e,t);if(e===0)return t*Math.abs(t);if(t===0)return e*Math.abs(e);if(r!==s)return 0;let a=r?Math.sqrt(e*t):-Math.sqrt(e*t);return a>=e&&t>=a?a:Va(e,t)}function QP(e,t,n,r,s){if(!(isNaN(t)||isNaN(r)||t<0==r<0))for(;;){let i=xi(e,n),o=s(i);if(!isFinite(o))return;if(i===e||i===n)return Math.abs(t)<=Math.abs(r)?[e,t]:[n,r];if(o===0)return pf(e,t,i,o,n,r,s);t<0!=o<0?(n=i,r=o):(e=i,t=o)}}function QD(e,t,n,r,s){if(!(ZP(t)||ZP(r))&&WP(t,r))for(;;){let i=xi(e,n),o=s(i);if(ZP(o))return;if(i===e||i===n)return i;if(WP(t,o))n=i,r=o;else if(WP(o,r))e=i,t=o;else return}}function ZP(e){for(let t of e)if(isNaN(t))return!0;return!1}function WP(e,t){for(let n=0;n<e.length;n++)if(!uB(e[n],t[n]))return!1;return!0}function uB(e,t){return e<=0&&t>=0||e>=0&&t<=0}function pf(e,t,n,r,s,i,o){let a;if(!isFinite(r))return;isFinite(t)||(a=xs(e,t,n,r,o),a!==void 0&&(e=a,t=o(e))),isFinite(i)||(a=xs(n,r,s,i,o),a!==void 0&&(s=a,i=o(a)));let u,c;t===r?u=[e,t]:u=UD(e,t,n,r,o,r),i===r?c=[s,i]:c=UD(n,r,s,i,o,r);let l;return u&&c&&(l=xi(u[0],c[0])),l!==void 0?[l,o(l)]:void 0}function xs(e,t,n,r,s){if(isFinite(t)!==isFinite(r))for(;;){let i=xi(e,n),o=s(i);if(i===e||i===n)return isFinite(t)?e:n;isFinite(o)!==isFinite(t)?(n=i,r=o):(e=i,t=o)}}function Zy(e,t,n,r,s){if(la(t)!==la(r))for(;;){let i=xi(e,n),o=s(i);if(i===e||i===n)return la(t)?e:n;la(o)!==la(t)?(n=i,r=o):(e=i,t=o)}}function UD(e,t,n,r,s,i){if(t===i!=(r===i))for(;;){let o=xi(e,n),a=s(o);if(o===e||o===n)return t===i?[e,t]:[n,r];a===i!=(t===i)?(n=o,r=a):(e=o,t=a)}}function KD(e,t,n,r,s,i,o){if(e<n&&n<s&&isFinite(t)&&isFinite(r)&&isFinite(i)&&t!==r&&r!==i&&r>t==r>i)for(;;){let a=xi(e,n),u=o(a),c=xi(n,s),l=o(c);if(!isFinite(u)||!isFinite(l))return;if(a===e||a===n||c===n||c===s)return u>r==r>t?[a,u]:l>r==r>t?[c,l]:[n,r];if(u===r||l===r)return pf(e,t,n,r,s,i,o);r>t&&u>t&&u>r||r<t&&u<t&&u<r?(s=n,i=r,n=a,r=u):r>t&&l>r&&l>i||r<t&&l<r&&l<i?(e=n,t=r,n=c,r=l):(e=a,t=u,s=c,i=l)}}function Vi([e,t],[n,r]){return(n-e)*(n-e)+(r-t)*(r-t)}function qD(e,t,n,r,s,i){let o=i(e),a=i(t),u=i(n),c=Vi(o,r),l=Vi(a,r),p=Vi(u,r);if(!(t<=e||n<=t)&&!(!isFinite(c)||!isFinite(l)||!isFinite(p))&&!(l>=c||l>=p))for(;;){if(Math.abs(u[0]-o[0])<s&&Math.abs(u[1]-o[1])<s)return[e,n];let f=xi(e,t),d=i(f),y=Vi(d,r),g=xi(t,n),m=i(g),h=Vi(m,r);if(!isFinite(y)||!isFinite(h))return;if(f===e||f===t||g===t||g===n)return y<l&&y<h?[f,f]:h<y&&h<l?[g,g]:[t,t];if((y===l||h===l)&&(t=.5*(f+t),a=i(t),l=Vi(a,r),y===l||h===l))return[e,n];y<l&&y<h?([n,t]=[t,f],[u,a]=[a,d],[p,l]=[l,y]):h<y&&h<l?([e,t]=[t,g],[o,a]=[a,m],[c,l]=[l,h]):([e,n]=[f,g],[o,u]=[d,m],[c,p]=[y,h])}}function $D(e,t,n){return t===void 0&&(t=-1/0),n===void 0&&(n=1/0),Math.min(n,Math.max(t,e))}function jP(e,t,n,r,s,i){let o;if(r!==void 0&&s!==void 0){let p=.5*(r+s);o=n+.01*(n<p?s-r:r-s)}else o=Math.abs(n)>1?n*1.00001:n+1e-5;let a=e(n),u=e(o),c=Vi(a,t),l=Vi(u,t);if(!(!isFinite(c)||!isFinite(l))){if(c===l)return[n,o];for(l>c&&([n,o]=[o,n],[a,u]=[u,a],[c,l]=[l,c]);isFinite(n)&&isFinite(o)&&n!==o;){if(s!==void 0&&o>s)return[s,s];if(r!==void 0&&o<r)return[r,r];let p=n+3*(o-n),f=e(p),d=Vi(f,t);if(!isFinite(d))return[n,o];if(d===l)return[n,o];if(d>l){let y=o>n?qD(n,o,p,t,i,e):qD(p,o,n,t,i,e);return y&&[$D(y[0],r,s),$D(y[1],r,s)]}[n,c,o,l]=[o,l,p,d]}return[n,o]}}function YD(e,t,n,r){return n?r?Math.min(Vi(e(r[0]),t),Vi(e(r[1]),t))<Math.min(Vi(e(n[0]),t),Vi(e(n[1]),t)):!1:!0}function EX(e,t,n,r,s,i){let o=jP(e,t,n,r,s,i);if(r!==void 0){let a=jP(e,t,r,r,s,i);YD(e,t,o,a)&&(o=a)}if(s!==void 0){let a=jP(e,t,s,r,s,i);YD(e,t,o,a)&&(o=a)}return o}function XD(e,t,n,r,s,i,o,a){let u=Math.abs(r-t),c=Math.abs(i-r),l=Math.abs(a-i);return u>c&&u>l?[e,n]:l>c&&l>u?[s,o]:[n,s]}function tp(e,t,n,r,s,i,o,a=0){if(!((n-e)*(s-n)<=0)&&!(!isFinite(e)||!isFinite(n)||!isFinite(s))&&!(!isFinite(t)||!isFinite(i))){if(!isFinite(r)){let u=xs(e,t,n,r,o),c=xs(n,r,s,i,o);return u===void 0||c===void 0?void 0:[u,c]}if(!(Math.abs(r-((s-n)*t+(n-e)*i)/(s-e))<a))for(;;){let u=xi(e,n),c=o(u),l=xi(n,s),p=o(l),f=Math.abs(c-Va(t,r)),d=Math.abs(r-Va(c,p)),y=Math.abs(p-Va(r,i));if(f<=a&&d<=a&&y<=a)return;if(!isFinite(c)){let g=xs(e,t,u,c,o),m=xs(u,c,s,i,o);return g===void 0||m===void 0?void 0:[g,m]}if(!isFinite(p)){let g=xs(e,t,l,p,o),m=xs(l,p,s,i,o);return g===void 0||m===void 0?void 0:[g,m]}if((u===e||u===n)&&(l===n||l===s))return Math.abs(r-t)>Math.abs(i-r)?[e,n]:[n,s];if(u===e||u===n)return XD(e,t,n,r,l,p,s,i);if(l===n||l===s)return XD(e,t,u,c,n,r,s,i);f>y&&f>=d?(s=n,i=r,n=u,r=c):y>f&&y>=d?(e=n,t=r,n=l,r=p):(e=u,t=c,s=l,i=p)}}}var $a=(Math.sqrt(5)-1)/2;function lf(e,t){return e>0==t>0?e+$a*(t-e):(1-$a)*e+$a*t}function hu(e,t){let n;e>t&&(n=e,e=t,t=n);let r=e>0,s=t>0,i=Math.abs(e)>.01,o=Math.abs(t)>.01;if(i||o)return lf(e,t);if(e===0)return t*Math.abs(t);if(t===0)return e*Math.abs(e);if(r!==s)return 0;let a=r?Math.sqrt(e*t):-Math.sqrt(e*t);return a>=e&&t>=a?a:lf(e,t)}function eS(e,t,n,r,s,i){if(!isFinite(e)||!isFinite(n)||!isFinite(t)||!isFinite(r))return;e>n&&([e,t,n,r]=[n,r,e,t]);let o=hu(e,n),a=s(o);if(Math.abs(a-lf(t,r))<=i)return;let u=hu(e,o),c=s(u);for(;;){let l=Math.abs(c-lf(t,a)),p=Math.abs(a-lf(r,c));if(l<=i&&p<=i)return;if(l>p){if(n=o,r=a,o=u,a=c,u=hu(e,o),c=s(u),u===e||u===o)return WD(e,t,o,a,n,r);if(!isFinite(c))return ZD(e,t,u,c,n,r,s)}else{if(e=u,t=c,u=o,c=a,o=hu(n,o),a=s(o),o===n||o===u)return WD(e,t,u,c,n,r);if(!isFinite(a))return ZD(e,t,o,a,n,r,s)}}}function ZD(e,t,n,r,s,i,o){let a=xs(e,t,n,r,o),u=xs(n,r,s,i,o);if(!(a===void 0||u===void 0))return[a,u]}function WD(e,t,n,r,s,i){return Math.abs(r-t)>Math.abs(i-r)?[e,n]:[n,s]}function JP(e,t,n){let r=e[0]*(1-$a)+t[0]*$a-n[0],s=e[1]*(1-$a)+t[1]*$a-n[1],i=e[2]*(1-$a)+t[2]*$a-n[2];return r*r+s*s+i*i}function Wy(e,t,n,r,s,i,o,a){if(!isFinite(e)||!isFinite(n)||!la(t)||!la(r))return;e>n&&([e,t,n,r]=[n,r,e,t]);let u=hu(e,n),c=s(u),l=i*i;if(JP(t,r,c)<=l)return;let p=hu(e,u),f=s(p);for(;;){let d=JP(t,c,f),y=JP(r,f,c);if(d<=l&&y<=l)return n-e<a?p:void 0;if(d>y){if(n=u,r=c,u=p,c=f,p=hu(e,u),f=s(p),p===e||u-p<=o)return JD(e,t,u,c,n,r);if(!la(f))return jD(e,t,p,f,n,r,s)}else{if(e=p,t=f,p=u,f=c,u=hu(n,u),c=s(u),u===n||u-p<=o)return JD(e,t,p,f,n,r);if(!la(c))return jD(e,t,u,c,n,r,s)}}}function jD(e,t,n,r,s,i,o){let a=Zy(e,t,n,r,o),u=Zy(n,r,s,i,o);if(!(a===void 0||u===void 0))return[a,u]}function JD(e,t,n,r,s,i){return qa(r,t)>qa(i,r)?[e,n]:[n,s]}var df=class{constructor(t){this.comparator=t;this._data=[]}size(){return this._data.length}queue(t){let n=this._data.length;for(this._data.push(t);n>0;){let r=n-1>>>1;if(this.comparator(this._data[n],this._data[r])<0){let s=this._data[r];this._data[r]=this._data[n],this._data[n]=s,n=r}else break}}dequeue(){let t=this._data[0],n=this._data.pop();if(this._data.length>0&&n!==void 0){this._data[0]=n;let r=0,s=this._data.length-1;for(;;){let i=(r<<1)+1,o=i+1,a=r;if(i<=s&&this.comparator(this._data[i],this._data[a])<0&&(a=i),o<=s&&this.comparator(this._data[o],this._data[a])<0&&(a=o),a!==r){let u=this._data[a];this._data[a]=this._data[r],this._data[r]=u,r=a}else break}}return t}peek(){return this._data[0]}clear(){this._data.length=0}};function lB(e,t){let n=e.start[1]-e.end[1],r=e.end[0]-e.start[0],s=t.start[1]-t.end[1],i=t.end[0]-t.start[0],o=n*e.end[0]+r*e.end[1],a=s*t.end[0]+i*t.end[1],u=n*i-s*r;if(u!==0)return(n*a-s*o)/u}function pB(e,t,n){if(n.xSlope>=t.xSlope)return;if(t.scanlineX===n.scanlineX)return e;let r=t.start[1]>t.end[1]?t.start:t.end,s=n.start[1]>n.end[1]?n.start:n.end,i=r[1];if(s[1]<r[1]){if(i=s[1],KP(i,t)<s[0])return}else if(r[1]<s[1]){let a=KP(i,n);if(r[0]<a)return}else if(r[0]<s[0])return;let o=lB(t,n);if(o!==void 0)return Math.max(Math.min(o,i),e)}function KP(e,t){let n=t.end[0],r=t.start[0],s=t.end[1],i=t.start[1];if(s===e)return n;if(i===e)return r;{let o=(e-s)/(i-s),a=(1-o)*n+o*r;if(n<r){if(a<=n)return n;if(r<=a)return r}else{if(a<=r)return r;if(n<=a)return n}return a}}function eE(e){let t=0,n=0,r=!1,s=0;for(let{scanlineX:i,isClockwise:o}of e)o?s+=1:s-=1,s!==0&&!r?(r=!0,n=i):s===0&&r&&(r=!1,t+=i-n);return t}var ff=class{constructor(t){this.scanlineY=-1/0;let n=1;this.activeEdges=[],this.events=new df((r,s)=>r.y-s.y),this.scanlineY=-1/0,this.polygonLength=t.length-1;for(let r=t.length-1;r>=1;r--){let s=t[r],i=t[r-1],o={id:n++,index:r-1,end:s,start:i,scanlineX:0,xSlope:1/0,isClockwise:i[1]>s[1],skipIntersectionWith:{}};i[1]>s[1]?(this.events.queue({type:"+",y:s[1],edge:o}),this.events.queue({type:"-",y:i[1],edge:o}),o.xSlope=(i[0]-s[0])/(i[1]-s[1]),o.scanlineX=s[0]):s[1]>i[1]?(this.events.queue({type:"+",y:i[1],edge:o}),this.events.queue({type:"-",y:s[1],edge:o}),o.xSlope=(s[0]-i[0])/(s[1]-i[1]),o.scanlineX=i[0]):this.events.queue({type:"h",y:i[1],edge:o})}}nextScanline(){var i;let t,n=this.events.peek();if(!n)return;if(n.y<=this.scanlineY)throw new Error("Programming error: expected next event to begin a new scanline");this.scanlineY=n.y,this.updateActiveEdgeScanlineIntersections();let r=eE(this.activeEdges),s=[];for(;t=this.events.dequeue();)if(t.type==="x"?this.swapActiveEdges(t):t.type==="+"?this.insertActiveEdge(t):t.type==="-"&&this.removeActiveEdge(t),s.push(t),((i=this.events.peek())==null?void 0:i.y)!==this.scanlineY)return{y:this.scanlineY,activeEdges:this.activeEdges,lengthBeforeProcessingEvents:r,events:s}}updateActiveEdgeScanlineIntersections(){let t=-1/0;for(let n of this.activeEdges){let r=KP(this.scanlineY,n);r<t?r=t:t=r,n.scanlineX=r}}insertActiveEdge(t){let n=this.activeEdges,r=t.edge,s=t.y,{xSlope:i,scanlineX:o}=r,a;for(a=0;a<n.length;a++){let u=n[a];if(o<u.scanlineX||o===u.scanlineX&&i<=u.xSlope)break}n.splice(a,0,r),this.checkIntersection(s,n[a-1],r),this.checkIntersection(s,r,n[a+1])}checkIntersection(t,n,r){if(!n||!r||n.index===(r.index+1)%this.polygonLength||r.index===(n.index+1)%this.polygonLength)return;if(n.id<r.id){if(n.skipIntersectionWith[r.id])return}else if(r.skipIntersectionWith[n.id])return;let s=pB(t,n,r);if(s===void 0)return;n.id<r.id?n.skipIntersectionWith[r.id]=!0:r.skipIntersectionWith[n.id]=!0;let i={type:"x",y:s,edge1:n,edge2:r};this.events.queue(i)}removeActiveEdge(t){let n=this.activeEdges,r=t.edge,s=t.y,i=n.indexOf(r);n.splice(i,1),this.checkIntersection(s,n[i-1],n[i])}swapActiveEdges(t){let n=this.activeEdges,r=t.edge1,s=t.edge2,i=t.y,o=n.indexOf(r),a=o+1;o===-1||n[a]!==s?r.id<s.id?delete r.skipIntersectionWith[s.id]:delete s.skipIntersectionWith[r.id]:(n[o]=s,n[a]=r,this.checkIntersection(i,n[o-1],s),this.checkIntersection(i,r,n[a+1]))}static debugEvent(t){let n=`y=${t.y} `;return n+=t.type==="x"?`[x ${t.edge1.index}/${t.edge2.index}]`:`[${t.type} ${t.edge.index}] (${t.edge.end})-(${t.edge.start})`,n}debugState(){return`y=${this.scanlineY}\n${this.activeEdges.map(t=>`[${t.index}] ${t.scanlineX}`)}`}};function dB(e){let t=e.slice(0,2),n=e.slice(-2);return t[0]!==n[0]||t[1]!==n[1]?[...e,...t]:e}function vX(e,t){if(!e)return!1;let n=dB(e),[r,s]=t,i=0;for(let o=n.length-1;o>=3;o-=2){let a=n[o-3],u=n[o-2],c=n[o-1],l=n[o];u>s!=l>s&&r<(c-a)*(s-u)/(l-u)+a&&(u>l?i+=1:u<l&&(i-=1))}return i!==0}function nS(e){if(e.length<4||e[0][0]!==e[e.length-1][0]||e[0][1]!==e[e.length-1][1])return 0;let t=new ff(e),n,r=0,s;for(;s=t.nextScanline();){let i=s.lengthBeforeProcessingEvents;n&&(r+=.5*(s.y-n.y)*(i+n.length)),n={y:s.y,length:eE(s.activeEdges)}}return r}function rS(e){if(!e.length)return[];if(e[0][0]!==e[e.length-1][0]||e[0][1]!==e[e.length-1][1])throw new Error("Programming error: expected last point to be a duplicate of the first point.");for(let f=0;f<e.length-1;f++)if(e[f][0]===e[f+1][0]&&e[f][1]===e[f+1][1])throw new Error(`Programming error: unexpected duplicate point at ${f+1}`);let t=new ff(e),n=e.slice(0,-1).map(()=>0),r;for(;r=t.nextScanline();)for(let f of r.events){let d={};if(f.type==="h"){let y=f.edge;d[y.index]={xMin:Math.min(y.end[0],y.start[0]),xMax:Math.max(y.end[0],y.start[0]),dx:y.end[0]-y.start[0]}}else if(f.type==="x"){let y=f.edge1,g=f.edge2,m=tS([y.start,y.end],[g.start,g.end]),h=m>0?-1:m<0?1:0;n[y.index]+=h,n[g.index]-=h}for(let y of r.activeEdges){let g=y.end[1]-y.start[1];for(let m in d){let{xMin:h,xMax:x,dx:T}=d[m];if(h<y.scanlineX&&y.scanlineX<x){let b=T*g,M=b>0?-1:b<0?1:0;n[m]+=M,n[y.index]-=M}}}}let s=e.slice(0,-1).map(()=>0),i=e[0][1],o=0;for(let f=1;f<e.length;f++)e[f][1]<i&&(i=e[f][1],o=f);let a=e.length-1,u=o>0?o-1:a-1,c=(o+1)%a,p=tS([e[u],e[o]],[e[o],e[c]])>0?1:0;s[o]=p>0?-1:1;for(let f=0;f<a-1;f++){let d=(o+f)%a;p+=n[d],s[(d+1)%a]=p>0?-1:1}return s}function tS(e,t){let n=e[1][0]-e[0][0],r=e[1][1]-e[0][1],s=t[1][0]-t[0][0],i=t[1][1]-t[0][1];return n*i-r*s}var fB=tp,jy=xs,mB=3.154019550531224,sS=Math.pow(2,-13),bu=sS*sS,iS=bu*bu,tE=bu,rE=32,_o=[],xu=[];function yB(e,t){for(let n=rE;n>0;n--){let r=mB/rE*n,s=Math.sinh(r),i=Math.cosh(Math.PI/2*s),o=1/(Math.exp(Math.PI/2*s)*i),a=Math.cosh(r)/(i*i);e.push(o),t.push(a)}}yB(_o,xu);var uS=0;for(let e=0;e<xu.length;e++)uS+=xu[e];var Jy=1/(1+2*uS);function zs(e,t,n){return .5*(t*(2-n)+e*n)}function gB(e,t,n){let r=.5*(t+n),s=fB(t,e(t),r,e(r),n,e(n),e);return s?.5*(s[0]+s[1]):r}function mf(e,t,n,r,s){return{x1:e,x2:t,value:n,error:r,minerror:s}}function oS(e,t,n){let r=Math.abs(e(zs(t,n,bu))),s=Math.abs(e(zs(t,n,2*bu))),i=Math.abs(e(zs(t,n,4*bu)));return r<bu||s<bu?!1:r>1.95*s&&s>1.95*i}function nE(e,t,n){let r=zs(n,t,_o[0]),s=zs(t,n,_o[0]),i=e(r),o=e(s),a=zs(t,n,1),u=e(a),c,l;if(isFinite(u)&&!isFinite(i)){if(c=jy(r,i,a,u,e),Math.abs((c-t)/(n-t))>tE)return mf(t,n,NaN,NaN,NaN);t=c,i=e(t)}if(isFinite(u)&&!isFinite(o)){if(l=jy(a,u,s,o,e),Math.abs((l-n)/(n-t))>tE)return mf(t,n,NaN,NaN,NaN);n=l,o=e(n)}if(isFinite(i)&&isFinite(o)&&!isFinite(u)){if(c=jy(r,i,a,u,e),l=jy(a,u,s,o,e),Math.abs((l-c)/(n-t))>tE)return mf(t,n,NaN,NaN,NaN);u=.5*(c+l)}if(oS(e,t,n)||oS(e,n,t))return mf(t,n,NaN,NaN,NaN);let p=u,f=0,d=0,y=0,g=0,m=0,h=0;for(let _=0;_<rE;_+=4)m=e(zs(t,n,_o[_])),h=e(zs(n,t,_o[_])),g=Math.max(g,Math.abs(m),Math.abs(h)),f+=xu[_]*(m+h),m=e(zs(t,n,_o[_+1])),h=e(zs(n,t,_o[_+1])),g=Math.max(g,Math.abs(m),Math.abs(h)),y+=xu[_+1]*(m+h),m=e(zs(t,n,_o[_+2])),h=e(zs(n,t,_o[_+2])),g=Math.max(g,Math.abs(m),Math.abs(h)),d+=xu[_+2]*(m+h),m=e(zs(t,n,_o[_+3])),h=e(zs(n,t,_o[_+3])),g=Math.max(g,Math.abs(m),Math.abs(h)),y+=xu[_+3]*(m+h);let x=p+f,T=x+d,b=T+y,M=Math.abs(d-x),P=Math.abs(y-T),D=Jy*(n-t)*b,S=Jy*Math.abs(n-t)*g*xu[0],O;return M===0?O=Jy*Math.abs(n-t)*P:O=Jy*Math.abs(n-t)*P*(P/M)*(P/M),O=Math.max(O,S),mf(t,n,D,O,S)}function aS(e){let t=-1/0,n=-1/0,r=-1,s=0;for(let i=0;i<e.length;i++){let o=e[i];s+=o.value,o.error>t&&(t=o.error,r=i),o.minerror>n&&(n=o.minerror)}return{maxerror:t,maxminerror:n,maxindex:r,totalvalue:s}}function yf(e,t,n,r=32){if(isNaN(t)||isNaN(n))return NaN;let s=1;if(t>n){let a=t;t=n,n=a,s=-1}if(t===1/0&&n===1/0)return NaN;if(t===-1/0&&n===-1/0)return NaN;if(t===-1/0&&n===1/0)return s*yf(a=>e(a/((1+a)*(1-a)))*(1+a*a)/((1+a)*(1+a)*(1-a)*(1-a)),-1,1,r);if(t===-1/0)return s*yf(a=>-e(n-a/(1-a))/((1-a)*(1-a)),1,0,r);if(n===1/0)return s*yf(a=>e(t+a/(1-a))/((1-a)*(1-a)),0,1,r);let i=[nE(e,t,n)],o=aS(i);for(let a=1;a<r&&!(Math.abs(o.maxerror/o.totalvalue)<=32*iS||o.maxerror<=32*iS||o.maxerror<=32*o.maxminerror||!isFinite(o.maxerror)||!isFinite(o.maxminerror));a++){let u=i[i.length-1];i[i.length-1]=i[o.maxindex],i[o.maxindex]=u;let c=i.pop(),l=gB(e,zs(c.x2,c.x1,.125),zs(c.x1,c.x2,.125));i.push(nE(e,c.x1,l)),i.push(nE(e,l,c.x2)),o=aS(i)}return!isFinite(o.maxerror)||!isFinite(o.maxminerror)?NaN:Math.abs(o.totalvalue)<=10*o.maxminerror?0:s*o.totalvalue}function Ya(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Tu(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function da(){}var Iu=.7,Gc=1/Iu,np="\\\\s*([+-]?\\\\d+)\\\\s*",gf="\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*",pa="\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*",bB=/^#([0-9a-f]{3,8})$/,xB=new RegExp(`^rgb\\\\(${np},${np},${np}\\\\)$`),TB=new RegExp(`^rgb\\\\(${pa},${pa},${pa}\\\\)$`),IB=new RegExp(`^rgba\\\\(${np},${np},${np},${gf}\\\\)$`),PB=new RegExp(`^rgba\\\\(${pa},${pa},${pa},${gf}\\\\)$`),EB=new RegExp(`^hsl\\\\(${gf},${pa},${pa}\\\\)$`),MB=new RegExp(`^hsla\\\\(${gf},${pa},${pa},${gf}\\\\)$`),cS={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ya(da,hf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:lS,formatHex:lS,formatHex8:CB,formatHsl:DB,formatRgb:pS,toString:pS});function lS(){return this.rgb().formatHex()}function CB(){return this.rgb().formatHex8()}function DB(){return hS(this).formatHsl()}function pS(){return this.rgb().formatRgb()}function hf(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=bB.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?dS(t):n===3?new Lr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Qy(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Qy(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=xB.exec(e))?new Lr(t[1],t[2],t[3],1):(t=TB.exec(e))?new Lr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=IB.exec(e))?Qy(t[1],t[2],t[3],t[4]):(t=PB.exec(e))?Qy(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=EB.exec(e))?yS(t[1],t[2]/100,t[3]/100,1):(t=MB.exec(e))?yS(t[1],t[2]/100,t[3]/100,t[4]):cS.hasOwnProperty(e)?dS(cS[e]):e==="transparent"?new Lr(NaN,NaN,NaN,0):null}function dS(e){return new Lr(e>>16&255,e>>8&255,e&255,1)}function Qy(e,t,n,r){return r<=0&&(e=t=n=NaN),new Lr(e,t,n,r)}function bf(e){return e instanceof da||(e=hf(e)),e?(e=e.rgb(),new Lr(e.r,e.g,e.b,e.opacity)):new Lr}function kc(e,t,n,r){return arguments.length===1?bf(e):new Lr(e,t,n,r==null?1:r)}function Lr(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Ya(Lr,kc,Tu(da,{brighter(e){return e=e==null?Gc:Math.pow(Gc,e),new Lr(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Iu:Math.pow(Iu,e),new Lr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Lr(Bc(this.r),Bc(this.g),Bc(this.b),eg(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:fS,formatHex:fS,formatHex8:SB,formatRgb:mS,toString:mS}));function fS(){return`#${Vc(this.r)}${Vc(this.g)}${Vc(this.b)}`}function SB(){return`#${Vc(this.r)}${Vc(this.g)}${Vc(this.b)}${Vc((isNaN(this.opacity)?1:this.opacity)*255)}`}function mS(){let e=eg(this.opacity);return`${e===1?"rgb(":"rgba("}${Bc(this.r)}, ${Bc(this.g)}, ${Bc(this.b)}${e===1?")":`, ${e})`}`}function eg(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Bc(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Vc(e){return e=Bc(e),(e<16?"0":"")+e.toString(16)}function yS(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Lo(e,t,n,r)}function hS(e){if(e instanceof Lo)return new Lo(e.h,e.s,e.l,e.opacity);if(e instanceof da||(e=hf(e)),!e)return new Lo;if(e instanceof Lo)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,s=Math.min(t,n,r),i=Math.max(t,n,r),o=NaN,a=i-s,u=(i+s)/2;return a?(t===i?o=(n-r)/a+(n<r)*6:n===i?o=(r-t)/a+2:o=(t-n)/a+4,a/=u<.5?i+s:2-i-s,o*=60):a=u>0&&u<1?0:o,new Lo(o,a,u,e.opacity)}function tg(e,t,n,r){return arguments.length===1?hS(e):new Lo(e,t,n,r==null?1:r)}function Lo(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Ya(Lo,tg,Tu(da,{brighter(e){return e=e==null?Gc:Math.pow(Gc,e),new Lo(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Iu:Math.pow(Iu,e),new Lo(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,s=2*n-r;return new Lr(sE(e>=240?e-240:e+120,s,r),sE(e,s,r),sE(e<120?e+240:e-120,s,r),this.opacity)},clamp(){return new Lo(gS(this.h),Ky(this.s),Ky(this.l),eg(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=eg(this.opacity);return`${e===1?"hsl(":"hsla("}${gS(this.h)}, ${Ky(this.s)*100}%, ${Ky(this.l)*100}%${e===1?")":`, ${e})`}`}}));function gS(e){return e=(e||0)%360,e<0?e+360:e}function Ky(e){return Math.max(0,Math.min(1,e||0))}function sE(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}var ng=Math.PI/180,rg=180/Math.PI;var sg=18,bS=.96422,xS=1,TS=.82521,IS=4/29,rp=6/29,PS=3*rp*rp,vB=rp*rp*rp;function ES(e){if(e instanceof fa)return new fa(e.l,e.a,e.b,e.opacity);if(e instanceof Xa)return CS(e);e instanceof Lr||(e=bf(e));var t=uE(e.r),n=uE(e.g),r=uE(e.b),s=iE((.2225045*t+.7168786*n+.0606169*r)/xS),i,o;return t===n&&n===r?i=o=s:(i=iE((.4360747*t+.3850649*n+.1430804*r)/bS),o=iE((.0139322*t+.0971045*n+.7141733*r)/TS)),new fa(116*s-16,500*(i-s),200*(s-o),e.opacity)}function cE(e,t,n,r){return arguments.length===1?ES(e):new fa(e,t,n,r==null?1:r)}function fa(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}Ya(fa,cE,Tu(da,{brighter(e){return new fa(this.l+sg*(e==null?1:e),this.a,this.b,this.opacity)},darker(e){return new fa(this.l-sg*(e==null?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=bS*oE(t),e=xS*oE(e),n=TS*oE(n),new Lr(aE(3.1338561*t-1.6168667*e-.4906146*n),aE(-.9787684*t+1.9161415*e+.033454*n),aE(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function iE(e){return e>vB?Math.pow(e,1/3):e/PS+IS}function oE(e){return e>rp?e*e*e:PS*(e-IS)}function aE(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function uE(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function OB(e){if(e instanceof Xa)return new Xa(e.h,e.c,e.l,e.opacity);if(e instanceof fa||(e=ES(e)),e.a===0&&e.b===0)return new Xa(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*rg;return new Xa(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function MS(e,t,n,r){return arguments.length===1?OB(e):new Xa(e,t,n,r==null?1:r)}function Xa(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function CS(e){if(isNaN(e.h))return new fa(e.l,0,0,e.opacity);var t=e.h*ng;return new fa(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Ya(Xa,MS,Tu(da,{brighter(e){return new Xa(this.h,this.c,this.l+sg*(e==null?1:e),this.opacity)},darker(e){return new Xa(this.h,this.c,this.l-sg*(e==null?1:e),this.opacity)},rgb(){return CS(this).rgb()}}));var OS=-.14861,lE=1.78277,pE=-.29227,ig=-.90649,xf=1.97294,DS=xf*ig,SS=xf*lE,vS=lE*pE-ig*OS;function NB(e){if(e instanceof Hc)return new Hc(e.h,e.s,e.l,e.opacity);e instanceof Lr||(e=bf(e));var t=e.r/255,n=e.g/255,r=e.b/255,s=(vS*r+DS*t-SS*n)/(vS+DS-SS),i=r-s,o=(xf*(n-s)-pE*i)/ig,a=Math.sqrt(o*o+i*i)/(xf*s*(1-s)),u=a?Math.atan2(o,i)*rg-120:NaN;return new Hc(u<0?u+360:u,a,s,e.opacity)}function dE(e,t,n,r){return arguments.length===1?NB(e):new Hc(e,t,n,r==null?1:r)}function Hc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Ya(Hc,dE,Tu(da,{brighter(e){return e=e==null?Gc:Math.pow(Gc,e),new Hc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Iu:Math.pow(Iu,e),new Hc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*ng,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),s=Math.sin(e);return new Lr(255*(t+n*(OS*r+lE*s)),255*(t+n*(pE*r+ig*s)),255*(t+n*(xf*r)),this.opacity)}}));function zc(e,t){if(!isFinite(e)||!isFinite(t))return NaN;if(e=Math.round(e),t=Math.round(t),e<0&&(e=-e),t<0&&(t=-t),t>e){let r=t;t=e,e=r}if(t===0)return e;let n=e%t;for(;n>0;)e=t,t=n,n=e%t;return t}function Uc(e,t){if(isNaN(e)&&t===0)return NaN;if(e>=0||t===Math.floor(t))return Math.pow(e,t);let n=Ba(t,100);return si(n.n/n.d,t,2)&&n.d%2===1?(n.n%2===0?1:-1)*Math.pow(-e,t):NaN}var fE=[De,Gt,I,R,N,z,wt,ke,Rn,Hn,ut,Kt,xe,de,ce,ie,fe,Ne,le,Le,ye,Re,Pn],AB=new Set(fE),Tf=Qn.of(fE.filter(e=>wn(e))),If=Qn.of(fE.filter(e=>!wn(e)));function io(e){return AB.has(e)}function NS(e){return io(e)}function ls(e){return AS(e,NaN)}function RS(e){return AS(e,0)}function AS(e,t){switch(e){case I:return t;case N:return[t,t];case z:return[t,t,t];case wt:case ke:return[[t,t,t],[t,t,t]];case Rn:return[[t,t,t],[t,t,t],[t,t,t]];case Hn:return[[[t,t,t],[t,t,t],[t,t,t]],t];case Kt:return[t,t,t];case ut:return{type:"Action",updateRules:{}};case de:case Ne:case fe:return[[t,t],[t,t]];case le:return[[t,t],[t,t]];case ce:return[[t,t],t];case ie:return[[t,t],[t,t],[t,t]];case De:case Gt:return!1;case xe:return[];case Re:return[[t,t],[t,t],!1];case Le:case ye:return[[t,t],t,t,t];case Pn:return[t,t];case R:return[t,t];default:let n=e;throw new Error(`${n} does not have a ${t===0?"zero":"NaN"} type.`)}}function _S(e,t){return ws(ls(e),t)}var $S={spy:kD},{cosh:fp,sinh:jc,tanh:OE,acosh:YS,asinh:XS,atanh:ZS,expm1:LB,log1p:mp,sign:NE,hypot:Ts}=Math,wB=Ba,lg=zc,FB=Uc,WS=Symbol("DIVERGES"),jS=(n=>(n[n.SUCCESS=0]="SUCCESS",n[n.MISSING_CACHE_ENTRY=1]="MISSING_CACHE_ENTRY",n))(jS||{}),Tg=class Tg{constructor(t=Tg.defaultLimit,n){this.limit=t;this.computeSize=n;this.currentSize=0;this.cache=new Map}get(t){let n=this.cache.get(t);return n&&(this.cache.delete(t),this.cache.set(t,n)),n==null?void 0:n.value}set(t,n){let r=this.computeSize?this.computeSize(n):1;if(this.currentSize+r>=this.limit){let s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(t,{size:r,value:n})}};Tg.defaultLimit=1e5;var up=Tg,Df=1e4,JS=Df*2;function VB(){return Df}function RE(e){Df=e}var QS=(n=>(n[n.DoesNotTerminate=0]="DoesNotTerminate",n[n.DepthLimitExceeded=1]="DepthLimitExceeded",n))(QS||{});function KS(e,t){if(io(t))return e.recursionTerminationStatus=0,ls(t);throw Rx()}function ev(e,t){if(io(t))return e.recursionTerminationStatus=1,ls(t);throw Ax()}var LS=new WeakMap;function BB(e){let t=LS.get(e);return t||(t=new Set(e),LS.set(e,t)),t}function bE(e){return`${e.fn}:${JSON.stringify(e.args)}`}function GB(e,t){return{status:0,result:[e,t]}}function kB(e){return{status:1,stackFrame:e}}function HB(e,t,n,r){let s=e.recursiveFunctionCache||new up,i=[];i.push(r);let o=0;for(;i.length>0;){if(i.length>Df||o++>JS)return ev(e,n);let a=i.pop(),{fn:u,args:c}=a,l=t[u](s,...c);if(l===WS)return KS(e,n);if((l==null?void 0:l.status)===1)i.push({fn:u,args:c}),i.push(l.stackFrame);else{let p=bE(a);s.set(p,l.result)}}return s.get(bE(r))[0]}var zB=function(e){let t=e*e;return 1+t===1?1:1+t===t?Math.abs(e):Math.sqrt(t+1)},UB=function(e){let t=e*e;return t<1?NaN:t-1===t?Math.abs(e):Math.sqrt(t-1)};function hr(e,t,n){return Math.max(t,Math.min(n,e))}function Yc(e,t){let n=e%t;return e*t<0&&n!==0?n+t:n}function xE(e,t){if(e=Math.round(e),t=Math.round(t),!isFinite(e)||!isFinite(t))return NaN;if(e===0&&t===0)return 0;let n=lg(e,t);return Math.abs(e/n*t)}function qB(e){if(e.length===0)return NaN;if(e.length===1)return lg(e[0],0);let t=e[0];for(let n=1;n<e.length;n++)t=lg(t,e[n]);return t}function $B(e){if(e.length===0)return NaN;if(e.length===1)return xE(e[0],1);let t=e[0];for(let n=1;n<e.length;n++)t=xE(t,e[n]);return t}function YB(e){if(e.length===0)return[NaN,NaN];if(e.length===1)return SE(e[0],[0,0]);let t=e[0];for(let n=1;n<e.length;n++)t=SE(t,e[n]);return t}function XB(e){if(e.length===0)return[NaN,NaN];if(e.length===1)return vE(e[0],[1,0]);let t=e[0];for(let n=1;n<e.length;n++)t=vE(t,e[n]);return t}function Pu(e,t){if(isNaN(e))return e;if(isNaN(t))return t;if(!isFinite(e)&&!isFinite(t))return NaN;if(t===0||e===t)return 1;if(e===0)return Bi(t);let n=isFinite(e)&&e===Math.round(e),r=isFinite(t)&&t===Math.round(t);if(e<0&&t<0&&e-t<0)return n&&r?0:Bi(e-t)*Bi(t)/(Bi(e)*Pu(-e,-t));if(e<0&&t>0&&e-t<0)return n&&r?Math.pow(-1,t)*Pu(t-e-1,t):Bi(e-t)/Bi(e)*Pu(-(e-t),t);if(e<0&&t<0&&e-t>0)return n&&r?Math.pow(-1,e-t)*Pu(-t-1,e-t):Bi(t)/Bi(e)*Pu(-t,-e);if(e>0&&t<0&&e-t>0){let a=Math.abs(e)>Math.abs(t)?-t:e;return Bi(t)/Pu(e-t,a)}if(e>0&&t>0&&e-t<0)return Bi(e-t)/Pu(t,e);if(e<0||t<0||e-t<0||e<15&&t<15&&e-t<15)return pg(e,t)/ma(t);let s=Ti(e)-Ti(t)-Ti(e-t)-(e-t)*mp(-t/e),i=Math.sqrt(e/(2*Math.PI*t*(e-t)))*Math.pow(e/t,t)*Math.exp(s);return n&&r&&e>0&&t>0&&e-t>0?Math.round(i):i}function pg(e,t){if(isNaN(e))return e;if(isNaN(t))return t;if(!isFinite(e)&&!isFinite(t))return NaN;if(t===0)return 1;if(e===0)return 1/ma(-t);if(e===t)return ma(e);let n=isFinite(e)&&e===Math.round(e),r=isFinite(t)&&t===Math.round(t);if(e<0&&e-t<0)return n&&r?Math.pow(-1,t)*pg(t-e-1,t):Bi(e-t)/Bi(e)*pg(-(e-t),t);if(e<0||e-t<0||e<15&&e-t<15)return ma(e)/ma(e-t);let s=Ti(e)-Ti(e-t)-(e-t)*mp(-t/e),i=Math.sqrt(e/(e-t))*Ig(e,t)*Math.exp(s);return n&&r&&e>0&&t>0&&e-t>0?Math.round(i):i}function ma(e){if(e===-1/0)return NaN;let t=Math.round(e)===e;if(e<0)return t?1/0:1/(Bi(e)*wS(-e));let n=wS(e);return t?Math.round(n):n}function wS(e){return e>171?1/0:e<14?ZB(e):JB(e)}function ZB(e){let t=4.077131788261185,n=7.024675027156382,r=6.657107767450176,s=3.766266976716022,i=1.2792371666711133,o=.24304596436338005,a=.020049769312165774,u=4.154347453162709,c=7.270007565107539,l=6.97805297331391,p=3.989651532924167,f=1.367176195613119,d=.26175627691546965,y=.021742722739397567,g=1+e*(t+e*(n+e*(r+e*(s+e*(i+e*(o+e*a)))))),m=1+e*(u+e*(c+e*(l+e*(p+e*(f+e*(d+e*y)))))),h=e+1,x=1-(h-e);return Ig(h,e)*Math.sqrt(h+(2*e+1)*x)*(g/m)}var WB=Math.pow(2,27)+1;function jB(e){let t=WB*e;return t-(t-e)}var mE=.3678794428706169,yE=-16991745912462731e-25;function Ig(e,t){let n=jB(e),r=e-n,s=e*(mE+yE);if(s===0)return Math.pow(e/Math.E,t);let i=n*mE-s+n*yE+r*mE+r*yE;return Math.pow(s,t)*(1+t*(i/s))}function JB(e){return Ig(e,e)*Math.sqrt(2*Math.PI*e)*Math.exp(ov(e))}var tv=[1/6,-1/30,1/42,-1/30,5/66,-691/2730,7/6,-3617/510,43867/798,-174611/330,854513/138,-236364091/2730,8553103/6,-23749461029/870];function nv(e,t){if(e!==Math.floor(e))return NaN;if(e<0)return NaN;if(e===0)return 1/AE(t);let n=dn(t);if(e===1)return-1/(n*n);let r=Mn(t);if(e===2)return 2*r/(n*n*n);let s=[0,2],i=[];for(let a=3;a<=e;a++){i=[];for(let u=0;u<a;u++){let c=0,l=0;u>0&&(c=(a-u+1)*s[u-1]),u+2<a&&(l=(u+1)*s[u+1]),i.push(-(c+l))}s=i}let o=0;for(let a=e-1;a>=0;a--)o=i[a]+r*o;return o/Math.pow(n,e+1)}function rv(e,t){if(e<0)return NaN;if(e!==Math.floor(e))return NaN;let n=e%2===0?-1:1;if(t<0)return-n*rv(e,1-t)-Math.pow(Math.PI,e+1)*nv(e,Math.PI*t);let r=ma(e),s=0,i=Math.pow(t,-(e+1));for(;t<10;)s+=i,t++,i=Math.pow(t,-(e+1));s+=e===0?-Math.log(t):i*t/e,s+=.5*i;let o=tv,a=e+1,u=2,c=i*t*a/u,l=1/(t*t);for(let p=1;p<=14;p++)c*=l,s+=c*o[p-1],a++,u++,c*=a/u,a++,u++,c*=a/u;return r*n*s}function QB(e){let t=Math.log(e);return Math.exp(Math.round(t))===e?Math.round(t):t}function dg(e,t){if(t===0)return NaN;let n;return t===Math.E?n=Math.log(e):t===2&&Math.log2?n=Math.log2(e):t===10&&Math.log10?n=Math.log10(e):n=Math.log(e)/Math.log(t),Math.pow(t,Math.round(n))===e?Math.round(n):n}function KB(e){return dg(e,10)}function sv(e,t){let[n,r]=e,[s,i]=t;return i===0&&s===0?[NaN,NaN]:n===0&&r===0?[-1/0,0]:i===0&&r===0&&s>0?n>0?zt(dg(n,s),0):zt(dg(-n,s),Math.PI/Math.log(s)):Du(ME(e),ME(t))}function e3(e){return sv(e,[10,0])}var iv=1/Math.PI;function Pg(e){return e>1e12?!1:Math.round(iv*e)*Math.PI===e}function Eg(e){if(e>1e12)return!1;let t=Math.round(2*iv*e);return t%2===1&&t*Math.PI===2*e}function dn(e){return Pg(Math.abs(e))?0:Math.sin(e)}function Mn(e){return Eg(Math.abs(e))?0:Math.cos(e)}function AE(e){let t=Math.abs(e);return Pg(t)?0:Eg(t)?1/0:Math.tan(e)}function t3(e){return Eg(Math.abs(e))?1/0:1/Math.cos(e)}function n3(e){return Pg(Math.abs(e))?1/0:1/Math.sin(e)}function r3(e){let t=Math.abs(e);return Pg(t)?1/0:Eg(t)?0:1/Math.tan(e)}function s3(e){return e>0?Math.atan(1/e):Math.PI/2-Math.atan(e)}function i3(e){return Math.asin(1/e)}function o3(e){return Math.acos(1/e)}function a3(e){return 1/fp(e)}function u3(e){return 1/jc(e)}function c3(e){return 1/OE(e)}function l3(e){return YS(1/e)}function p3(e){return XS(1/e)}function d3(e){return ZS(1/e)}function f3(e){if(e===0||isNaN(e))return e;if(!isFinite(e))return NaN;if(e===Math.floor(e))return e>0?0:-0;let t=Math.round(2*e),n=-.5*t+e,r=t&2?-1:1,s=t&1?Math.cos(Math.PI*n):Math.sin(Math.PI*n);return r*s}function Bi(e){return e===1/0||e===-1/0?0:e===0?1:f3(e)/(Math.PI*e)}function ya(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}function m3(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function TE(e){return e>50?Math.exp(.5*((1-e)*mp(-1/(e-1))-1)+Ti(.5*(e-1))-Ti(.5*(e-2)))*Math.sqrt((1-1/e)/(2*Math.PI)):e/(e+1)*ma((e+1)/2)/(ma(e/2)*Math.sqrt(e*Math.PI))}function cp(e,t,n=e-t){if(Math.abs(n)<.1*(e+t)){let r=n/(e+t),s=n*n/(e+t),i=2*e*r;for(let o=1;o<10;o++){i*=r*r;let a=s+i/(2*o+1);if(a==s)return a;s=a}}return e*Math.log(e/t)+t-e}var y3=[0,.08106146679532726,.0413406959554093,.02767792568499834,.020790672103765093,.016644691189821193,.013876128823070748,.01189670994589177,.010411265261972096,.009255462182712733,.00833056343336287,.007573675487951841,.00694284010720953,.006408994188004207,.0059513701127588475,.005554733551962801];function Ti(e){return e>15?ov(e):e<0?NaN:e===Math.floor(e)?y3[e]:Math.log(ma(e)/(Ig(e,e)*Math.sqrt(2*Math.PI*e)))}function ov(e){let t=.08333333333333333,n=.002777777777777778,r=.0007936507936507937,s=.0005952380952380953,i=.0008417508417508417,o=e*e;return(t-(n-(r-(s-i/o)/o)/o)/o)/e}function Mg(e,t){return t<=0?NaN:TE(t)*Math.pow(1+e*e/t,-((t+1)/2))}function qc(e,t){if(t>0)return 1-qc(e,-t);if(t===-1/0)return 0;if(t===0)return .5;if(e>=40&&t>-1)return .5+TE(e)*g3(e,t);if(t/e<-1e3){let r=t*t;return TE(e)*Math.pow(e,.5*(e-1))*Math.pow(Math.abs(t),-e)*(1-e*e*(e+1)*(1/(2+e)+e*(e+3)/(4*(4+e)*r))/(2*r))}let n=Math.sqrt(t*t+e);return h3((t+n)/(2*n),e/2,e/2)}function g3(e,t){let n=t*t/e,r=t,s=r;for(let i=1;i<=15;i++)r*=-(2*i-1)/(2*i+1)*(.5*(e+1)+i-1)/i*n,s+=r;return s}function ug(e,t,n){return n<=0?NaN:e===-1/0?qc(n,t):e>0&&t>0?qc(n,-e)-qc(n,-t):qc(n,t)-qc(n,e)}function h3(e,t,n){if(e<0||e>1)throw new RangeError("First argument must be between 0 and 1.");if(t===1&&n===1)return e;if(e===0)return 0;if(e===1)return 1;if(t===0)return 1;if(n===0)return 0;{let r=Ti(t+n)-Ti(t)-Ti(n)-cp(t,(t+n)*e)-cp(n,(t+n)*(1-e),(t+n)*e-t),s=Math.exp(r)*Math.sqrt(t*n/(2*Math.PI*(t+n)));return e<(t+1)/(t+n+2)?s*FS(e,t,n)/t:1-s*FS(1-e,n,t)/n}}function FS(e,t,n){let r=Math.pow(2,-52),s=1e-300,i=t+n,o=t+1,a=t-1,u=1,c=1-i*e/o;Math.abs(c)<s&&(c=s),c=1/c;let l=c;for(let p=1;p<=100;p++){let f=2*p,d=p*(n-p)*e/((a+f)*(t+f));c=1+d*c,Math.abs(c)<s&&(c=s),u=1+d/u,Math.abs(u)<s&&(u=s),c=1/c,l*=c*u,d=-(t+p)*(i+p)*e/((t+f)*(o+f)),c=1+d*c,Math.abs(c)<s&&(c=s),u=1+d/u,Math.abs(u)<s&&(u=s),c=1/c;let y=c*u;if(l*=y,Math.abs(y-1)<=r)return l}return l}function b3(e,t){let n=Math.pow(2,-52),r=1e-300,s=1,i=e,o=s/i,a=s/r,u=1/i,c=2,l=0,p=i,f=-(e-1),d=0;do f-=1,p+=1,u=u*f*t+p,u===0&&(u=r),a=p+f*t/a,a===0&&(a=r),u=1/u,l=a*u,o=o*l,d+=1,p+=1,u=u*d*t+p,u===0&&(u=r),a=p+d*t/a,a===0&&(a=r),u=1/u,l=a*u,o*=l,c+=2;while(c<100&&Math.abs(l-1)>n);return o}function x3(e,t){let n=Math.pow(2,-52),r=1e-300,s=1,i=t+1-e,o=s/i,a=s/r,u=1/i,c=2,l=0,p=i;do{let f=-(c-1)*(c-e-1);p+=2,u=u*f+p,u===0&&(u=r),a=p+f/a,a===0&&(a=r),u=1/u,l=a*u,o*=l,c+=1}while(c<100&&Math.abs(l-1)>n);return o}function T3(e,t){let n=t/e,r=NE(t-e)*Math.sqrt(2*cp(1,n)),s=[1,-.3333333333333333,.08333333333333333,-.014814814814814815,.0011574074074074073,.0003527336860670194,-.0001787551440329218,3919263178522438e-20,-2185448510679992e-21,-185406221071516e-20,8296711340953087e-22,-17665952736826078e-23,6707853543401498e-24,10261809784240309e-24,-4382036018453353e-24,914769958223679e-24,-25514193994946248e-27,-5830772132550426e-26,24361948020667415e-27,-50276692801141755e-28,11004392031956135e-29,3371763262400985e-28,-1392388722418162e-28,28534893807047445e-30,-5139111834242572e-31,-19752288294349442e-31,8099521156704561e-31],i=s.length-2,o=0,a=0,u=0,c=0;for(;i>=0;i--)u=(i+2)*o/e+s[i+1],c=r*c+u,o=a,a=u;if(c=e/(e+o)*c,t<e){let l=Math.exp(-.5*e*r*r)*(.5*Za(-r*Math.sqrt(e/2))-c/Math.sqrt(2*Math.PI*e));return isFinite(l)?1-l:1}else{let l=Math.exp(-.5*e*r*r)*(.5*Za(r*Math.sqrt(e/2))+c/Math.sqrt(2*Math.PI*e));return isFinite(l)?l:0}}function VS(e,t,n){return(e-t)/(Math.SQRT2*Math.abs(n))}function Pf(e){return e<0?.5*Math.exp(-e*e)*Za(-e):1-.5*Math.exp(-e*e)*Za(e)}function I3(e,t,n,r){let s=VS(t,n,r);if(e===-1/0)return Pf(s);let i=VS(e,n,r);return i>0&&s>0?Pf(-i)-Pf(-s):Pf(s)-Pf(i)}function _E(e,t,n){return 1/Math.sqrt(2*Math.PI*n*n)*Math.exp(-(e-t)*(e-t)/(2*n*n))}function LE(e,t){return`t${e}:${bg(t)}`}function wE(e){let t=$S.spy(e),n=parseInt(t.slice(0,8),16)&2097151,r=parseInt(t.slice(8,16),16);return(n*4294967296+r)/9007199254740992}function av(e,t){for(let n=t.length-1;n>0;n--){let r=e+"::sc"+n,s=Math.floor(wE(r)*(n+1)),i=t[n];t[n]=t[s],t[s]=i}}function P3(e,t){let n=t.slice();return av(e,n),n}function FE(e,t){let n=[];for(let r=0;r<t;r++)n.push(r);return av(e,n),n}function Mu(e,t,n){return wE(e)*(n-t)+t}function E3(e,t,n){let r=0,s,i,o,a;do s=e+"::sc"+r,r+=1,i=Mu(s,0,1)*2-1,s=e+"::sc"+r,r+=1,o=Mu(s,0,1)*2-1,a=i*i+o*o;while(a>=1||a===0);let u=Math.sqrt(-2*Math.log(a)/a);return t+n*i*u}function M3(e,t){if(t<=0)return NaN;let n=0,r,s,i,o;do r=e+"::sc"+n,n+=1,s=Mu(r,0,1)*2-1,r=e+"::sc"+n,n+=1,i=Mu(r,0,1)*2-1,o=s*s+i*i;while(o>1);let a=s*s/o,u=t*(Math.pow(o,-2/t)-1);return r=e+"::sc"+n,n+=1,(Mu(r,0,1)<.5?-1:1)*Math.sqrt(a*u)}function C3(e,t,n){return t=hr(Math.round(t),0,1/0),t===1/0?NaN:(n=hr(n,0,1),cv(Mu(e,0,1),t,n))}function D3(e,t){return t<0?NaN:uv(Mu(e,0,1),t)}function cg(e,t,n){return e>=t?1:e<0?0:e<Math.floor((t+1)*n)?BS(e,t,n):1-BS(t-e-1,t,1-n)}function BS(e,t,n){let r=(1-n)/n,s=Cg(e,t,n),i=s;for(;e>0&&(s*=e/(t-e+1)*r,i+s!==i);e--)i+=s;return i}function S3(e,t,n,r){return n=hr(Math.round(n),0,1/0),n===1/0?NaN:(r=hr(r,0,1),t<0?0:(e=Math.ceil(e),t=Math.floor(t),e===-1/0?cg(t,n,r):cg(t,n,r)-cg(e-1,n,r)))}function Cg(e,t,n){if(e=Math.round(e),t=hr(Math.round(t),0,1/0),t===1/0)return NaN;if(n=hr(n,0,1),e<0||e>t)return 0;if(n===0)return e===0?1:0;if(n===1)return e===t?1:0;if(e===0)return Math.exp(t*mp(-n));if(e===t)return Math.pow(n,t);let r=Ti(t)-Ti(e)-Ti(t-e)-cp(e,t*n)-cp(t-e,t*(1-n),t*n-e);return Math.exp(r)*Math.sqrt(t/(2*Math.PI*e*(t-e)))}function lp(e,t){return t<0?NaN:(e=Math.round(e),e<0?0:t===0?e===0?1:0:e===0?Math.exp(-t):Math.exp(-Ti(e)-cp(e,t))/Math.sqrt(2*Math.PI*e))}function Ef(e,t){if(isNaN(e)||isNaN(t))return NaN;if(e===1/0)return 1;if(e=Math.floor(e),e<0)return 0;if(t===0)return 1;if(e+1>12&&2.35*(e+1)>t&&.3*(e+1)<t)return T3(e+1,t);if(e+1>=t){let n=b3(e+1,t);return isFinite(n)?1-t*lp(e,t)*n:1}else{let n=x3(e+1,t);return isFinite(n)?t*lp(e,t)*n:0}}function v3(e,t,n){return n<0?NaN:(e=Math.ceil(e),t=Math.floor(t),t<0?0:e===-1/0?Ef(t,n):Ef(t,n)-Ef(e-1,n))}function VE(e,t,n){return n<=t?NaN:e<t||e>n?0:1/(n-t)}function GS(e,t,n){return n<=t?NaN:e<t?0:e>n?1:(e-t)/(n-t)}function O3(e,t,n,r){return GS(t,n,r)-GS(e,n,r)}function N3(e){let t=-e*e;return t<-750?e>=0?1:-1:e>=.065?1-Math.exp(t)*Za(e):e<=-.065?Math.exp(t)*Za(-e)-1:e*(1.1283791670955126+t*(.37612638903183754+t*(.11283791670955126+t*(.026866170645131252+t*.005223977625442188))))}function Za(e){let t=.9999999999999999,n=2.224574423459406,r=2.444115549920689,s=1.7057986861852539,i=.8257463703357973,o=.28647031042892007,a=.07124513844341643,u=.012296749268608364,c=.001347817214557592,l=7263959403471071e-20,p=1,f=3.352953590554884,d=5.227518529742423,y=5.003720878235473,g=3.266590890998987,m=1.5255421920765353,h=.5185887413188858,x=.12747319185915415,T=.02185979575963238,b=.0023889438122503674,M=.00012875032817508128;if(e<0)return e<-6.1?2*Math.exp(e*e):2*Math.exp(e*e)-Za(-e);if(e>50){let P=.5641895835477563,D=e*e;return e>5e7?P/e:P*(D*(D+4.5)+2)/(e*(D*(D+5)+3.75))}else{let P=t+e*(n+e*(r+e*(s+e*(i+e*(o+e*(a+e*(u+e*(c+e*l)))))))),D=p+e*(f+e*(d+e*(y+e*(g+e*(m+e*(h+e*(x+e*(T+e*(b+e*M)))))))));return P/D}}function BE(e){let t=-39.6968302866538,n=220.946098424521,r=-275.928510446969,s=138.357751867269,i=-30.6647980661472,o=2.50662827745924,a=-54.4760987982241,u=161.585836858041,c=-155.698979859887,l=66.8013118877197,p=-13.2806815528857,f=-.00778489400243029,d=-.322396458041136,y=-2.40075827716184,g=-2.54973253934373,m=4.37466414146497,h=2.93816398269878,x=.00778469570904146,T=.32246712907004,b=2.445134137143,M=3.75440866190742,P=.02425,D,S,O;return e>.5?-BE(1-e):e===.5?0:e<0?NaN:e===0?-1/0:(e<P?(D=Math.sqrt(-2*Math.log(e)),O=(((((f*D+d)*D+y)*D+g)*D+m)*D+h)/((((x*D+T)*D+b)*D+M)*D+1)):(D=e-.5,S=D*D,O=(((((t*S+n)*S+r)*S+s)*S+i)*S+o)*D/(((((a*S+u)*S+c)*S+l)*S+p)*S+1)),O-Math.sqrt(2*Math.PI)*(.5*Za(-O/Math.SQRT2)-Math.exp(.5*O*O)*e))}function uv(e,t){if(t<0||e<0||e>1)return NaN;if(t===0||e===0)return 0;if(e===1)return 1/0;let n=-1,r=Math.ceil(t);for(;Ef(r,t)<e;)r=2*r;let s=Math.floor(n+(r-n)/2);for(;n<s&&s<r;)Ef(s,t)<e?n=s:r=s,s=Math.floor(n+(r-n)/2);return r}function cv(e,t,n){if(t!==Math.round(t))return NaN;if(n<0||n>1)return NaN;if(e<0||e>1)return NaN;if(e===0)return 0;if(e===1)return t;if(t===0)return 0;if(n===1)return t;if(n===0)return 0;let r=-1,s=t,i=Math.floor(r+(s-r)/2);for(;r<i&&i<s;)cg(i,t,n)<e?r=i:s=i,i=Math.floor(r+(s-r)/2);return s}function lv(e,t){if(isNaN(t)||t<=0||e<0||e>1)return NaN;if(e===0)return-1/0;if(e===1)return 1/0;if(t===1||t===2||t===4)return gE(t,e);let n,r;if(e===.5)return 0;if(e>.5)n=t>1?BE(e):gE(1,e),r=t>1?gE(1,e):Math.pow(Mg(0,t)*Math.pow(t,(t-1)/2)/(1-e),1/t);else return-lv(1-e,t);return R3(t,e,n,r)}function gE(e,t){let n=4*t*(1-t);switch(e){case 1:return Math.tan(Math.PI*(t-.5));case 2:return 2*(t-.5)*Math.sqrt(2/n);case 4:let r=Math.cos(Math.acos(Math.sqrt(n))/3)/Math.sqrt(n);return NE(t-.5)*2*Math.sqrt(r-1);default:throw new Error("_invTSimple() must be called with 1, 2, or 4 df.")}}function R3(e,t,n,r){if(!isFinite(n)||!isFinite(r))return NaN;let s=n,i=r;for(;;){let o=xi(s,i),a=qc(e,o);if(o===s||o===i)return a>t?s:i;a<t?s=o:i=o}}function A3(e,t,n){return e<0||e>1||n<=t?NaN:e===0?t:e===1?n:t+e*(n-t)}function pv(e,t){let n=fg(e);return(ya(e)-t)*Math.sqrt(e.length)/n}function dv(e,t){let n=e.length,r=ya(e),s=fg(e),i=t.length,o=ya(t),a=fg(t),u=Math.sqrt(((n-1)*s*s+(i-1)*a*a)/(n+i-2));return(r-o)/(u*Math.sqrt(1/n+1/i))}function op(e,t,n){return n<0?ug(-1/0,e,t):n>0?ug(-1/0,-e,t):2*ug(-1/0,-Math.abs(e),t)}function GE(e,t){arguments.length===1&&(t=0);let n=pv(e,t),r=e.length-1;return{lessThan:op(n,r,-1),greaterThan:op(n,r,1),notEqual:op(n,r,0)}}function kE(e,t){let n=dv(e,t),r=e.length+t.length-2;return{lessThan:op(n,r,-1),greaterThan:op(n,r,1),notEqual:op(n,r,0)}}function HE(e){return{min:Dg(e),q1:Xc(e,1),median:gv(e),q3:Xc(e,3),max:Sg(e)}}function _3(e){return e.length}function Dg(e){if(e.length<1)return NaN;let t=e[0];if(isNaN(t))return NaN;for(let n=1;n<e.length;n++){if(isNaN(e[n]))return NaN;e[n]<t&&(t=e[n])}return t}function Sg(e){if(e.length<1)return NaN;let t=e[0];if(isNaN(t))return NaN;for(let n=1;n<e.length;n++){if(isNaN(e[n]))return NaN;e[n]>=t&&(t=e[n])}return t}function fv(e,t){if(!isFinite(t)||t<0||t>1)return NaN;if(e.some(isNaN))return NaN;if(e.length===0)return NaN;let n=e.length,r=Jc(e),s=t*(n-1);return Math.floor(s)===s?e[r[s]]:(Math.ceil(s)-s)*e[r[Math.floor(s)]]+(s-Math.floor(s))*e[r[Math.ceil(s)]]}function Xc(e,t){if(!isFinite(t)||t<0||t>4)return NaN;if(e.some(isNaN))return NaN;let n=Jc(e),r=vg(e,t),s=Math.floor(r),i=Math.ceil(r);return(e[n[s]]+e[n[i]])/2}function IE(e,t){let n=e-t;return Number.isNaN(n)?+Number.isNaN(e)-+Number.isNaN(t):n}function mv(e,t){return IE(e[0],t[0])||IE(e[1],t[1])}function yv(e){let t=[];for(let n=0;n<e;n++)t.push(n);return t}function Jc(e){return yv(e.length).sort((t,n)=>IE(e[t],e[n]))}function L3(e){return yv(e.length).sort((t,n)=>mv(e[t],e[n]))}function vg(e,t){t=Math.round(t);let n=e.length,r=n%2===1,s;return n===1?0:(t===0&&(s=0),t===2&&(s=(n-1)/2),t===4&&(s=n-1),t===1&&(s=r?(n+1)/4-1:(n+2)/4-1),t===3&&(s=r?(3*n+3)/4-1:(3*n+2)/4-1),s===void 0?NaN:s)}function w3(e,t){return Jc(e)[Math.ceil(t*(e.length-1))]+1}function F3(e,t){return Jc(e)[Math.floor(t*(e.length-1))]+1}function V3(e,t){return Jc(e)[Math.ceil(vg(e,t))]+1}function B3(e,t){return Jc(e)[Math.floor(vg(e,t))]+1}function gv(e){return fv(e,.5)}function G3(e){if(e.length<1)return 0;let t=e[0];if(isNaN(t))return 0;let n=0;for(let r=1;r<e.length;r++){if(isNaN(e[r]))return 0;e[r]<t&&(n=r,t=e[r])}return n+1}function k3(e){if(e.length<1)return 0;let t=e[0];if(isNaN(t))return 0;let n=0;for(let r=1;r<e.length;r++)if(e[r]>=t){if(isNaN(e[r]))return 0;n=r,t=e[r]}return n+1}function Sf(e){let t=ya(e),n=0;for(let r=0;r<e.length;r++){let s=e[r]-t;n+=s*s}return n/e.length}function H3(e){let t=ya(e),n=0;for(let r=0;r<e.length;r++)n+=Math.abs(e[r]-t);return n/e.length}function hv(e){let t=e.length;return Sf(e)*t/(t-1)}function bv(e,t){let n=Math.min(e.length,t.length);e.length!==n&&(e=e.slice(0,n)),t.length!==n&&(t=t.slice(0,n));let r=ya(e),s=ya(t),i=0;for(let o=0;o<n;o++)i+=(e[o]-r)*(t[o]-s);return i/n}function z3(e,t){let n=Math.min(e.length,t.length);return bv(e,t)*n/(n-1)}function Og(e,t){let n=Math.min(e.length,t.length);e.length!==n&&(e=e.slice(0,n)),t.length!==n&&(t=t.slice(0,n));let r=ya(e),s=ya(t),i=0,o=0,a=0;for(let u=0;u<n;u++){let c=e[u]-r,l=t[u]-s;i+=c*c,o+=l*l,a+=c*l}return a/Math.sqrt(i*o)}function zE(e,t,n,r){let s=e[0];for(let o=2;o<e.length;o++){let a=V(Ps(ai(e[o],s),n));if(!si(a,o,10))return 0}let i=V(r);for(let o=0;o<t.length-1;o++){let a=V(Ps(ai(t[o],s),n));if(!si(a,i-t.length+o,10))return 0}return!isFinite(i)||i<e.length||i<t.length?0:i}function UE(e){return e<0||!isFinite(e)?0:e}function PE(e){let t=e.length;if(t===0)return[];let n=[],r=[];for(let a=0;a<t;a++)r.push([e[a],a]);r.sort((a,u)=>{let c=a[0],l=u[0];return c===1/0&&l===1/0||c===-1/0&&l===-1/0?0:c-l});let s=0,i=1,o=1;for(;s<t;){let a=s;for(;a<t-1&&r[a][0]===r[a+1][0];)a+=1;o=a-s+1;let u;for(a=0;a<o;a++)u=r[s+a][1],n[u]=isNaN(e[u])?NaN:i+.5*(o-1);i+=o,s+=o}return n}function U3(e,t){let n=Math.min(e.length,t.length);return e.length!==n&&(e=e.slice(0,n)),t.length!==n&&(t=t.slice(0,n)),Og(PE(e),PE(t))}function fg(e){return Math.sqrt(hv(e))}function q3(e){return Math.sqrt(Sf(e))}var $3=yf;function pp(e,t){return Ts(t[0]-e[0],t[1]-e[1])}function Y3(e,t){return Ts(t[0]-e[0],Ts(t[1]-e[1],t[2]-e[2]))}function xv(e,t,n){return[hr(Math.round(e),0,255),hr(Math.round(t),0,255),hr(Math.round(n),0,255)]}function X3(e,t,n){isFinite(e)||(e=0),t=hr(t,0,1),n=hr(n,0,1);let r=n*(1-t/2);r===0||r===1?t=0:t=(n-r)/Math.min(r,1-r);let{r:s,g:i,b:o}=tg(e,t,r).rgb();return xv(s,i,o)}function Z3(e){return e}function W3(e,t){return[e,t]}function j3(e,t,n){return[e,t,n]}function J3(e,t){return[e,t]}function Q3(e){return e}function K3(e){let t=[];if(e.length===0)return[];for(let n=0;n<e.length-1;n++)t.push([e[n],e[n+1]]);return t.push([e[e.length-1],e[0]]),t}function qE(e){if(e.length==0)return 0;let t=[...e,e[0]];return nS(t)}function e2(e){let t=0;for(let n=0;n<e.length-1;n++){let[r,s]=e[n],[i,o]=e[n+1];t+=Oi(i-r,o-s)}if(e.length>1){let[n,r]=e[e.length-1],[s,i]=e[0];t+=Oi(s-n,i-r)}return t}function t2(e){let t=!1;for(let n=0;n<e.length;n++){let r=(n+1)%e.length;e[n][0]===e[r][0]&&e[n][1]===e[r][1]&&(t=!0)}return t?e.filter((n,r)=>{let s=e[r===0?e.length-1:r-1];return n[0]!==s[0]||n[1]!==s[1]}):e}function n2(e){let[t,n,r,s]=e;return[t,r>=0?n:n+r,r>=0?r:-r,s]}function Tv(e,t,n){if(e.length===0)return[];if(e=t2(e),e.length===0)return[];let r=rS([...e,e[0]]),s=[];for(let i=0;i<e.length;i++){let o=e[i>0?i-1:e.length-1],a=e[i],u=e[i<e.length-1?i+1:0],c=r[i]===1,l=N2(o,a,u,c?"counterclockwise":"clockwise",n);s.push(t?l:n2(l))}return s}function r2(e,t){return Tv(e,!1,t)}function s2(e,t){return Tv(e,!0,t)}function $E(e,t){return[e,t]}var i2=$E,o2=$E;function a2(e,t){let n=[t[0]-e[0],t[1]-e[1]],r=[e[0],e[1]];return Iv(n,r)}function Iv(e,t){return[e,t]}function u2(e){return e[0]}function c2(e){return e[1]}function l2(e,t){let n=[t[0]-e[0],t[1]-e[1],t[2]-e[2]],r=[e[0],e[1],e[2]];return Pv(n,r)}function Pv(e,t){return[e,t]}function p2(e){return e[0]}function d2(e){return e[1]}function f2(e){return e}function m2(e,t){return[e,t]}function y2(e){return e[0]}function g2(e){return e[1]}function h2(e,t,n){return[e,t,n]}function yp([e,t,n]){let[r,s]=e,[i,o]=t,[a,u]=n,c=i*i+o*o,l=(r*r+s*s-c)/2,p=(c-a*a-u*u)/2,f=(r-i)*(o-u)-(i-a)*(s-o);f=1/f;let d=(l*(o-u)-p*(s-o))*f,y=((r-i)*p-(i-a)*l)*f;return[d,y]}function b2(e){return e[0]}function x2(e){return e[1]}function T2(e){return e[2]}function gp(e){let[[t,n],[r,s],[i,o]]=e,a=r-t,u=s-n,c=i-r,l=o-s;return 2*Math.atan2(a*l-c*u,a*c+u*l)}function YE(e){let t=Math.abs(gp(e));return t<1e-9||t>2*Math.PI-1e-9}function I2(e){return e[0]}function P2(e){return e[1]}function E2(e){return e[0]}function M2(e){return e[1]}function Ev(e){return Math.abs(e)===Math.PI?Math.PI:Yc(e+Math.PI,2*Math.PI)-Math.PI}function Mv(e,t,n,r){return[e,Ev(t),n,r]}function C2([e,t,n,r]){return[e,t,n,r]}function D2(e){return e[2]}function S2(e){return e[3]}function Cv(e){let[t,n,r,s]=e,i=Math.PI*2,o=r===0?i:r>0?r-i:r+i;return[t,n,o,s]}function v2(e){let[t,n,r,s]=Cv(e);return[t,n,r,s]}function O2(e){let[t,n,r,s]=e,i=r>=0?Math.PI-r:-Math.PI-r;return[t,Ev(n+r),i,s]}function N2(e,t,n,r,s){let i=e[0]-t[0],o=e[1]-t[1],a=n[0]-t[0],u=n[1]-t[1],c=Math.atan2(o,i),l=Math.atan2(i*u-o*a,i*a+o*u),p=2*Math.PI;return r==="clockwise"?l-=l<0?0:p:r==="counterclockwise"&&(l+=l<0?p:0),Mv(t,c,l,s)}function R2(e,t){let[[n,r],[s,i],o]=e;return[[n*t,r*t],[s*t,i*t],o]}function A2(e,t){let n=new Array(e.length);for(let r=0;r<n.length;r++){let s=e[r];n[r]=[s[0]*t,s[1]*t]}return n}function XE(e,t){let[[n,r],[s,i]]=e;return[[t*n,t*r],[t*s,t*i]]}var _2=XE,L2=XE;function w2(e,t){let[[n,r],s]=e;return[[t*n,t*r],t*s]}function F2(e,t){let[[n,r],[s,i],[o,a]]=e;return[[t*n,t*r],[t*s,t*i],[t*o,t*a]]}function V2(e,t){let[[n,r],s,i,o]=e;return[[t*n,t*r],t*s,t*i,o]}function B2(e,t){if(e.length!==t.length)throw new Error("Polygon tangent must be added to polygon of same length.");let n=new Array(e.length);for(let r=0;r<n.length;r++){let s=e[r],i=t[r];n[r]=[s[0]+i[0],s[1]+i[1]]}return n}function Ng(e,t){let[[n,r],[s,i]]=e,[[o,a],[u,c]]=t;return[[n+o,r+a],[s+u,i+c]]}function G2(e,t){let[[n,r,s],[i,o,a]]=e,[[u,c,l],[p,f,d]]=t;return[[n+u,r+c,s+l],[i+p,o+f,a+d]]}var k2=Ng,H2=Ng,z2=Ng;function U2(e,t){let[[n,r],s]=e,[[i,o],a]=t;return[[n+i,r+o],s+a]}function q2(e,t){let[[n,r],[s,i],[o,a]]=e,[[u,c],[l,p],[f,d]]=t;return[[n+u,r+c],[s+l,i+p],[o+f,a+d]]}function $2(e,t){let[[n,r],s,i,o]=e,[[a,u],c,l]=t;return[[n+a,r+u],s+c,i+l,o]}function Y2(e,t){let[[n,r],[s,i],o]=e,[[a,u],[c,l]]=t;return[[n+a,r+u],[s+c,i+l],o]}function ZE(e,t){let[[n,r],[s,i]]=e;return[(1-t)*n+t*s,(1-t)*r+t*i]}function WE(e,t){return ZE(e,hr(t,0,1))}function X2(e,t){t=hr(t,0,1);let[[n,r,s],[i,o,a]]=e;return[(1-t)*n+t*i,(1-t)*r+t*o,(1-t)*s+t*a]}function EE(e,t){return ZE(e,hr(t,0,1/0))}function Z2(e,t){let[[n,r],s]=e,i=Math.min(1,Math.max(0,t));return[n+s*Math.cos(2*Math.PI*i),r+s*Math.sin(2*Math.PI*i)]}function Dv(e,t){let n=Rg(e);if(!n)return[NaN,NaN];if(n.type==="segment")return WE([e[0],e[2]],t);if(n.type==="rays")return t<=0?EE([n.start1,n.end1],-t):t>=1?EE([n.start2,n.end2],t-1):[NaN,NaN];t=Math.min(1,Math.max(0,t));let r=yp(e),s=gp(e),i=Math.atan2(e[0][1]-r[1],e[0][0]-r[0]),o=pp(r,e[0]),a=i+t*s;return[r[0]+o*Math.cos(a),r[1]+o*Math.sin(a)]}function W2(e,t){if(isNaN(t)||e.length===0)return[[NaN,NaN],[NaN,NaN]];if(t<0||t>=e.length)return[e[0],e[0]];let n=Math.floor(t);return[e[n],e[(n+1)%e.length]]}function j2(e,t){if(isNaN(t)||e.length===0)return[NaN,NaN];if(t<0||t>=e.length)return e[0];let n=Math.floor(t);return WE([e[n],e[(n+1)%e.length]],t-n)}function Rg(e){let[t,n,r]=e,[[s,i],[o,a],[u,c]]=[t,n,r];if(isNaN(s)||isNaN(i)||isNaN(o)||isNaN(a)||isNaN(u)||isNaN(c))return;let l=yp([t,n,r]),p=pp(l,t);if(isFinite(p)&&!YE([t,n,r])){let f=Math.atan2(t[1]-l[1],t[0]-l[0]),d=f+gp([t,n,r]);return{type:"arc",center:l,radius:p,startAngle:f,endAngle:d}}else{let f=to(o,a,0,s,i,0,u,c,0);return f<0||f>1?{type:"rays",start1:[s,i],end1:[s+(s-u),i+(i-c)],start2:[u,c],end2:[u+(u-s),c+(c-i)]}:{type:"segment",start:[s,i],end:[u,c]}}}function J2(e,t,n){let s=pp(e,t);if(s>1e-9)return t;let i=pp(e,n);return i>1e-9?n:isNaN(s)&&isNaN(i)?[NaN,NaN]:e}function Mf(e,t){let[[n,r],s]=e,[[i,o],a]=t,u=Ts(i-n,o-r),c=u*u,l=s*s,p=a*a,[f,d,y]=[u,s,a].sort((M,P)=>P-M),g=f+d+y,m=y-(f-d),h=y+(f-d),x=f+(d-y),T=.01,b;return m<0&&f+T*m===f||h<0&&f+T*h===f||x<0&&f+T*x===f?b=0:b=Math.sqrt(g*m*h*x)/4,[(i+n)/2+(i-n)*(l-p)/(2*c)+-2*(o-r)*b/c,(o+r)/2+(o-r)*(l-p)/(2*c)+2*(i-n)*b/c]}function mg(e,t,n){let[[r,s],i]=e,[[o,a],[u,c]]=t,l=o-r,p=u-r,f=a-s,d=c-s,y=u-o,g=c-a,m=y*y+g*g,h=Ts(y,g),x=l*d-p*f,T=i*h,b=T+x,M=T-x,P=.01,D;if(b<0&&T+P*b===T||M<0&&T+P*M===T?D=0:D=b*M,D<0)return[NaN,NaN];let S=Math.sqrt(D);return[r+(x*g+n*y*S)/m,s+(-x*y+n*g*S)/m]}function Q2(e,t){let[[n,r],[s,i]]=e,[[o,a],[u,c]]=t,l=i-r,p=n-s,f=c-a,d=o-u,y=l*n+p*r,g=f*o+d*a,m=l*d-f*p,h=m/(Ts(l,p)*Ts(f,d));return m===0||1+.1*h===1?[NaN,NaN]:[(d*y-p*g)/m,(l*g-f*y)/m]}function jE(e,t,n=0){let r=mg(t,e,-1);if(Cu(r,e,n,!0))return r;{let s=mg(t,e,1);return Cu(s,e,n,!0)?s:[NaN,NaN]}}function JE(e,t,n=0){let r=mg(e,t,1);if(Cu(r,t,n,!1))return r;{let s=mg(e,t,-1);return Cu(s,t,n,!1)?s:[NaN,NaN]}}function Sv(e,t,n=0){let r=Q2(e,t);return!Cu(r,e,n,!0)||!Cu(r,t,n,!1)?[NaN,NaN]:r}function K2(e,t,n=0){let r=Nv(t,e,n,-1);return dp(r,t,n,!1)?r:[NaN,NaN]}function vv(e,t,n=0){let r=Rv(t,e,n,-1);return!Cu(r,e,n,!0)||!dp(r,t,n,!1)?[NaN,NaN]:r}function eG(e,t,n=0){let r=Nv(e,t,n,1);return dp(r,e,n,!0)?r:[NaN,NaN]}function Ov(e,t,n=0){let r=Rv(e,t,n,1);return!dp(r,e,n,!0)||!Cu(r,t,n,!1)?[NaN,NaN]:r}function tG(e,t,n=0){let r=nG(e,t,n);return!dp(r,e,n,!0)||!dp(r,t,n,!1)?[NaN,NaN]:r}function nG(e,t,n){let r=gg(e);if(hg(r))return vv(r,t,n);let s=gg(t);return hg(s)?Ov(e,s,n):QE(()=>Mf(r,s),()=>Mf(s,r),i=>KE(-1,yg(e,i),yg(t,i)))}function Nv(e,t,n,r){let s=gg(e);return hg(s)?r>0?JE(t,s,n):jE(s,t,n):QE(()=>Mf(s,t),()=>Mf(t,s),i=>KE(r,yg(e,i),rG(t,i)))}function Rv(e,t,n,r){let s=gg(e);return hg(s)?Sv(s,t,n):QE(()=>JE(s,t,n),()=>jE(t,s,n),i=>KE(r,yg(e,i),sG(t)))}function QE(e,t,n){let r=e();if(n(r))return r;let s=t();return n(s)?s:[NaN,NaN]}function KE(e,t,n){return e*_v(t,n)>0}function yg(e,[t,n]){let[r,s]=yp(e);return gp(e)>0?[s-n,t-r]:[n-s,r-t]}function rG([[e,t]],[n,r]){return[t-r,n-e]}function sG([[e,t],[n,r]]){return[n-e,r-t]}function gg(e){let t=yp(e),n=pp(t,Dv(e,0));return isFinite(n)&&!YE(e)?[t,n]:[e[0],e[2]]}function hg(e){return Array.isArray(e[1])}function dp([e,t],n,r,s){let[i,o]=yp(n);return(s?(r&3)===0:(r&12)===0)||Bm(Math.atan2(t-o,e-i),Math.atan2(n[0][1]-o,n[0][0]-i),gp(n))}function Cu([e,t],[[n,r],[s,i]],o,a){let u=to(e,t,0,n,r,0,s,i,0),[c,l]=a?[(o&1)===0,(o&2)===0]:[(o&4)===0,(o&8)===0];return!isNaN(u)&&(u>=0||c)&&(u<=1||l)}function iG(e,t){let[[n,r],[s,i]]=e,[o,a]=t;return[[o,a],[o+(s-n),a+(i-r)]]}function oG(e,t){let[[n,r],[s,i]]=e,[o,a]=t;return[[o,a],[o+(i-r),a-(s-n)]]}function aG(e){let[t,n,r]=e,[s,i]=t,o=Mn(n+r/2),a=dn(n+r/2);return[[s,i],[s+o,i+a]]}function Av(e,t){let[n,r]=e,[s,i]=t;return[n*s-r*i,n*i+s*r]}function e0(e,t){let[n,r,s]=e,[i,o]=n,[a,u]=t;return s&&(u=-u),o===0?[i*a,i*u]:[i*a-o*u,i*u+a*o]}function _v(e,t){let[n,r]=e,[s,i]=t;return n*i-s*r}function uG(e,t){let[n,r]=e,[s,i]=t;return n*s+r*i}function cG(e){let[t,n]=e;return[-n,t]}function lG(e,t){return[e,t,!1]}function pG(e,t){return[e,t,!0]}function dG(e){return[e[0],[0,0],e[2]]}function fG(e){return e[0]}function mG(e){return[[1,0],e,!1]}function yG(e,t){let[n,r]=e;return[[t,0],[(1-t)*n,(1-t)*r],!1]}function gG(e,t){let[n,r]=e,s=Math.cos(t),i=Math.sin(t);return[[s,i],[n*(1-s)+r*i,r*(1-s)-n*i],!1]}function hG(e){let[[t,n],[r,s]]=e,i=r-t,o=s-n,a=i*i+o*o,u=(i*i-o*o)/a,c=2*i*o/a;return[[u,c],[(1-u)*t-c*n,(1+u)*n-c*t],!0]}function bG(e,t){let n=e[2],[r,s,i]=t;return[e0(e,r),oo(e,s),i!==n]}function xG(e){let[[t,n],[r,s],i]=e,o=t*t+n*n,a=t/o,u=-n/o,c=-(t/o*r+n/o*s),l=-(t/o*s-n/o*r);return i&&(u=-u,l=-l),[[a,u],[c,l],i]}function oo(e,t){let[n,r]=e0(e,t),[s,i]=e[1];return[n+s,r+i]}function TG(e,t){let[n,r,s]=e;return s?-t:t}function t0(e,t){let[n,r]=t;return[oo(e,n),oo(e,r)]}var IG=t0,PG=t0;function EG(e,t){let[n,r]=t;return[e0(e,n),oo(e,r)]}function MG(e,t){let[n,r]=t,[[s,i]]=e;return[oo(e,n),Ts(s,i)*r]}function CG(e,t){let[n,r,s]=t;return[oo(e,n),oo(e,r),oo(e,s)]}function DG(e,t){let n=[];for(let r of t)n.push(oo(e,r));return n}function SG(e,t){let[n,r,s]=t,i=oo(e,n),[o,a,u]=e,[c,l]=oo([o,[0,0],u],[Math.cos(r),Math.sin(r)]),p=Math.atan2(l,c),f=TG(e,s);return[i,p,f,t[3]]}function vG(e,t){let n=[];for(let r=0;r<Math.min(e.length,t.length);r++)t[r]&&n.push(e[r]);return n}function OG(e,t){let n=[];for(let r of t)n.push(e[r]);return n}function NG(e){let t=[],n={};for(let r=0;r<e.length;r++){let s=e[r],i=bg(s);n.hasOwnProperty(i)||(n[i]=!0,t.push(r))}return t}function RG(e,t){return[e,t]}function AG(e){return e[0]}function _G(e){return e[1]}function bg(e){if(Array.isArray(e))return`[${e.map(bg).join(",")}]`;switch(typeof e){case"string":return e;case"boolean":case"number":return e.toString();case"object":if(LG(e)){let n=[];for(let r of We(e.updateRules))n.push(`"${r}": ${bg(e.updateRules[r].value)}`);return`{${n.join(",")}}`}else return V(e).toString();default:return e}}function LG(e){return typeof e!="object"||!e?!1:e.type==="Action"}function wG(e){return e}function FG(e){return e}function zt(e,t){return isNaN(e)||isNaN(t)?[NaN,NaN]:[e,t]}function Eu(e,t){return isNaN(e)||isNaN(t)?zt(NaN,NaN):e===0?zt(0,0):zt(e*Mn(t),e*dn(t))}function VG([e,t]){return e}function BG([e,t]){return t}function GG([e,t]){return vf(t,e)}function Zc([e,t]){return[e,-t]}function Du(e,t){let[n,r]=t;return Math.abs(r)<=Math.abs(n)?HS(e,t):Zc(HS(kS(e),kS(t)))}function kS([e,t]){return[t,e]}function HS([e,t],[n,r]){let s=r/n,i=1/(n+r*s);return s===0?zt((e+r*(t/n))*i,(t-r*(e/n))*i):zt((e+t*s)*i,(t-e*s)*i)}function Lv([e,t]){return Wc(e,t)}function Wc(e,t){let n=Math.sqrt(.5*(Math.abs(e)+Ts(e,t)));return n===1/0&&(n=2*Math.sqrt(.5*(Math.abs(.25*e)+Ts(.25*e,.25*t)))),n===0||!isFinite(t)?zt(n,t):e>0?zt(n,.5*(t/n)):(t<0&&(n=-n),zt(.5*(t/n),n))}function Is(e){return Du(zt(1,0),e)}function Cf(e){return 0+e}function vf(e,t){return Math.atan2(Cf(e),Cf(t))}function kG(e,t){let n=e*e+t*t;if(n===1/0)return Math.log(Math.hypot(.5*e,.5*t))+Math.LN2;if(n===0)return Math.log(Math.hypot(e,t));if(.5<n&&n<3){let r=Math.max(e,t),s=Math.min(e,t);return .5*Math.log1p((r+1)*(r-1)+s*s)}else return .5*Math.log(n)}function ME([e,t]){return zt(kG(e,t),vf(t,e))}function HG([e,t]){let n=Math.exp(e);return t===0?zt(n,0):Eu(n,t)}function zG([e,t]){return zt((e+t)*(e-t),2*e*t)}function zS(e,t){t=t>>>0;let[n,r]=e,s=1,i=0;for(;t;){for(;!(t&1);){let u=(n+r)*(n-r),c=2*n*r;n=u,r=c,t=t>>>1}let o=n*s-r*i,a=n*i+s*r;s=o,i=a,t=t-1>>>0}return zt(s,i)}function UG(e,t){let[n,r]=t;if(r===0)return wv(e,n);let[s,i]=e;if(isNaN(s)||isNaN(i)||isNaN(n)||isNaN(r))return zt(NaN,NaN);let o=Ts(s,i),a=vf(i,s),u=Math.pow(o,n)*Math.exp(-a*r),c=Math.log(o)*r+a*n;return isFinite(u)?Eu(u,c):Eu(Math.exp(n*Math.log(o)-a*r),c)}function wv(e,t){let[n,r]=e;if(isNaN(n)||isNaN(r)||isNaN(t))return zt(NaN,NaN);switch(t){case-1:return Is(e);case 0:return zt(1,0);case .5:return Lv(e);case 1:return e}return r===0?Number.isInteger(t)||n>=0?zt(Math.pow(n,t),0):Eu(Math.pow(-n,t),Math.PI*t):n===0?r>=0?Eu(Math.pow(r,t),.5*Math.PI*t):Eu(Math.pow(-r,t),-.5*Math.PI*t):t===2?zG(e):t===(t|0)?t<0?Is(zS(e,-t)):zS(e,t):Eu(Math.pow(Math.hypot(n,r),t),t*vf(r,n))}function Fv([e,t]){return zt(dn(e)*fp(t),Mn(e)*jc(t))}function Vv([e,t]){return zt(Mn(e)*fp(t),-dn(e)*jc(t))}function Bv([e,t]){let[n,r]=n0([-t,e]);return[r,-n]}function Gv([e,t]){return zt(jc(e)*Mn(t),fp(e)*dn(t))}function kv([e,t]){return zt(fp(e)*Mn(t),jc(e)*dn(t))}function n0([e,t]){let n=AE(t),r=OE(e);if(!isFinite(n))return zt(1/r,1/n);let s=n*n,i=1+s,o=jc(e),a=o*o,u=r*r;return zt(i*r/(1+s*u),n/(1+i*a))}function qG(e){return Is(Vv(e))}function $G(e){return Is(Fv(e))}function YG(e){return Is(Bv(e))}function XG(e){return Is(kv(e))}function ZG(e){return Is(Gv(e))}function WG(e){return Is(n0(e))}function r0([e,t]){let n=Wc(1-e,-t),r=Wc(1+e,t);return zt(Math.atan(e/Cf($c(n,r)[0])),Math.asinh($c(Zc(n),r)[1]))}function Hv([e,t]){let n=Wc(1-e,-t),r=Wc(1+e,t);return zt(2*Math.atan(n[0]/Cf(r[0])),Math.asinh($c(Zc(r),n)[1]))}function CE([e,t]){let[n,r]=xg([-t,e]);return[r,-n]}function zv([e,t]){let[n,r]=r0([-t,e]);return[r,-n]}function Uv([e,t]){let n=Wc(e-1,t),r=Wc(e+1,t);return zt(Math.asinh($c(Zc(n),r)[0]),2*Math.atan(n[1]/Cf(r[0])))}function xg([e,t]){if(e<0){let[n,r]=qS(-e,-t);return[-n,-r]}else return qS(e,t)}var US=Math.sqrt(Number.MAX_VALUE)/4;function qS(e,t){if(e>US||Math.abs(t)>US)return zt(Is([e,t])[0],t<=0?-Math.PI/2:Math.PI/2);if(e===1){if(t===0)return zt(1/0,0);let n=Math.abs(t),r=Math.log(Math.sqrt(Math.sqrt(4+t*t))/Math.sqrt(n)),s=(Math.PI/2+Math.atan(n/2))/2;return t<0!=s<0&&(s=-s),zt(r,s)}else return zt(mp(4*e/((1-e)**2+t**2))/4,-vf(-2*t,(1-e)*(1+e)-t**2)/2)}function jG(e){return Hv(Is(e))}function JG(e){return r0(Is(e))}function QG(e){if(e[0]>0)return CE(Is(e));let[t,n]=CE(e);return zt(Math.PI/2-t,-n)}function KG(e){let[t,n]=e;return t===0&&n===0?zt(1/0,0):Uv(Is(e))}function ek(e){let[t,n]=e;return t===0&&n===0?zt(1/0,0):zv(Is(e))}function tk(e){return e[0]>0?Zc(xg(Zc(Is(e)))):xg(Is(e))}function s0([e,t]){return t===0?e:NaN}function nk([e,t],n){var r,s;return t===0?((r=n.goodCoercionCount)!=null||(n.goodCoercionCount=0),n.goodCoercionCount++,e):(isNaN(t)||((s=n.badCoercionCount)!=null||(n.badCoercionCount=0),n.badCoercionCount++),NaN)}function rk(e){return isNaN(e)?[NaN,NaN]:[e,0]}function qv([e,t]){let n=Math.floor(e),r=Math.floor(t);if(!isFinite(n)||!isFinite(r))return[n,r];let s=e-n,i=t-r;return s+i<1?[n,r]:s>=i?[n+1,r]:[n,r+1]}function sk([e,t]){let n=qv([-e,-t]);return[-n[0],-n[1]]}function ap(e){return[Math.round(e[0]),Math.round(e[1])]}function ik(e,t){let[n,r]=e,[s,i]=t;if(!isFinite(n)||!isFinite(r)||isNaN(s)||isNaN(i))return[NaN,NaN];if(!isFinite(s)&&!isFinite(i))return e;if(s===1/0)return og(n,r,i);if(s===-1/0){let[f,d]=og(-n,-r,-i);return[-f,-d]}else if(i===1/0){let[f,d]=og(r,-n,-s);return[-d,f]}else if(i===-1/0){let[f,d]=og(-r,n,s);return[d,-f]}let o=DE(t),a=n*s+r*i,u=r*s-n*i,c=Yc(a,o),l=Yc(u,o);c+l<o||(c>=l?c-=o:l-=o);let p=Du([c,l],[s,-i]);return Number.isInteger(n)&&Number.isInteger(r)&&Number.isInteger(s)&&Number.isInteger(i)?[Math.round(p[0]),Math.round(p[1])]:p}function og(e,t,n){return e+t<0?e>=t?zt(e-n,1/0):zt(1/0,t+n):[e,t]}function DE([e,t]){return e*e+t*t}function SE(e,t){if(!isFinite(e[0])||!isFinite(e[1])||!isFinite(t[0])||!isFinite(t[1]))return[NaN,NaN];e=ap(e),t=ap(t);let n=i0(e,t);return $v(n)}function i0(e,t){let n=[1,0];for(e=[e[0],e[1]],t=[t[0],t[1]];;){let r=DE(e),s=DE(t);if(r===1||s===1)return n;if(r===0)return $c(t,n);if(s===0)return $c(e,n);if(r===s&&ak(e,t))return $c(e,n);switch(ag(e[0])<<3|ag(e[1])<<2|ag(t[0])<<1|ag(t[1])){case 0:sp(e),sp(t),ok(n);break;case 1:case 2:sp(e);break;case 4:case 8:sp(t);break;case 3:sp(e),ip(t),hE(n);break;case 12:ip(e),sp(t),hE(n);break;case 14:case 13:ip(e);break;case 7:case 11:ip(t);break;case 15:ip(e),ip(t),hE(n);break;case 5:case 10:e=[.5*(e[0]-t[0]),.5*(e[1]-t[1])],t=[e[0]+t[0],e[1]+t[1]];break;case 6:case 9:e=[.5*(e[0]+t[1]),.5*(e[1]-t[0])],t=[e[0]-t[1],e[1]+t[0]];break}}}function ok(e){e[0]*=2,e[1]*=2}function sp(e){e[0]*=.5,e[1]*=.5}function hE(e){let t=e[0]-e[1];e[1]=e[1]+e[0],e[0]=t}function ip(e){let t=.5*(e[0]+e[1]);e[1]=.5*(e[1]-e[0]),e[0]=t}function ag(e){return e%2==0?0:1}function $c(e,t){let[n,r]=e,[s,i]=t;return zt(n*s-r*i,n*i+s*r)}function ak(e,t){return e[0]==t[0]&&e[1]==t[1]||e[0]==-t[0]&&e[1]==-t[1]||e[0]==-t[1]&&e[1]==t[0]||e[0]==t[1]&&e[1]==-t[0]}function $v(e){let[t,n]=e;return t>=0&&n<0?[-n,t]:t<0&&n<=0?[-t,-n]:t<=0&&n>0?[n,-t]:e}function vE(e,t){if(!isFinite(e[0])||!isFinite(e[1])||!isFinite(t[0])||!isFinite(t[1]))return[NaN,NaN];if(e[0]===0&&e[1]===0||t[0]===0&&t[1]===0)return[0,0];if(!isFinite(e[0])||!isFinite(e[1])||!isFinite(t[0])||!isFinite(t[1]))return[NaN,NaN];e=ap(e),t=ap(t);let n=i0(e,t),r=ap(Du(e,n)),s=Av(r,t);return $v(s)}function hp(e,t){return{n:e,d:t}}function an(e){return typeof e=="object"&&typeof e.n=="number"&&typeof e.d=="number"}var Of=Math.pow(2,53)-1;function Qc(e){let t=e.match(/^(-)?(\\d*)?(?:\\.(\\d*))?$/);if(!t)return NaN;let n=t[1],r=t[2],s=t[3];if(!r&&!s)return NaN;let i=!!n;if(s){let o=s.replace(/0+$/,""),a=o.length,u=Math.pow(10,a),c=parseInt(r||"0",10)*u+parseInt(o||"0",10);return c>Of||u>Of?parseFloat(e):Se(i?-c:c,u)}else{let o=parseInt(r,10);return o>Of?parseFloat(e):Se(i?-o:o,1)}}function V(e){return an(e)?e.n/e.d:+e}function Ii(e){return an(e)?!1:isNaN(e)}function Se(e,t){if(!isFinite(e)||!isFinite(t)||t===0||Math.floor(e)!==e||Math.floor(t)!==t||Math.abs(e)>Of||Math.abs(t)>Of)return e/t;t<0&&(e=-e,t=-t);let n=zc(e,t);return hp(e/n,t/n)}function Us(e){return an(e)?hp(-e.n,e.d):-e}function Yv(e){return an(e)?hp(Math.abs(e.n),Math.abs(e.d)):Math.abs(e)}function Xv(e){return an(e)?e.n===0?e.d/e.n:hp(e.n<0?-e.d:e.d,Math.abs(e.n)):1/e}function qs(e,t){if(!an(e)||!an(t))return V(e)+V(t);let n=zc(e.d,t.d);return Se(e.n*(t.d/n)+t.n*(e.d/n),e.d/n*t.d)}function wr(e,t){if(!an(e)||!an(t))return V(e)*V(t);let n=zc(e.n,t.d),r=zc(t.n,e.d);return Se(e.n/n*(t.n/r),e.d/r*(t.d/n))}function ai(e,t){return qs(e,Us(t))}function Ps(e,t){return!an(e)||!an(t)?V(e)/V(t):wr(e,Xv(t))}function uk(e,t){let n=e,r=t;if(t.n<0&&(r=Us(t),n=Xv(e)),!an(n)||!an(r))return Uc(V(e),V(t));if(e=n,t=r,t.d===1)return Se(Math.pow(e.n,t.n),Math.pow(e.d,t.n));let s=e.n<0;if(s&&t.d%2!==1)return NaN;let o=(s?-1:1)*Math.round(Math.pow(Math.abs(e.n),1/t.d)),a=Math.round(Math.pow(Math.abs(e.d),1/t.d));return Math.pow(o,t.d)!==e.n||Math.pow(a,t.d)!==e.d?Uc(V(e),V(t)):Se(Math.pow(o,t.n),Math.pow(a,t.n))}function Zv(e,t){if(!an(e)||!an(t))return Uc(V(e),V(t));let n=uk(e,t);return an(n)?n:Uc(V(e),V(t))}function Wv(e){if(!an(e))return Math.sqrt(e);let t=Math.round(Math.sqrt(e.n)),n=Math.round(Math.sqrt(e.d));return t*t!==e.n||n*n!==e.d?Math.sqrt(V(e)):Se(t,n)}function jv(e,t){if(!an(e)||!an(t)){let r=V(e),s=V(t);Yc(r,s)}let n=ai(e,wr(t,hp(Math.floor(V(Ps(e,t))),1)));return an(n)?n:Yc(V(e),V(t))}function Jv(e){let t=hp(0,1);for(let n of e)t=qs(t,n);return t}var Q=class extends Yt{constructor(t,n){if(!Array.isArray(t))throw new TypeError("Argument to expression constructor must be an Array.");super(),this.args=t,(!n||!n.skipRegisterDependencies)&&this.registerDependencies()}shouldExportAns(){return!0}registerDependencies(){for(let t=0;t<this.args.length;t++)this.mergeDependencies(this.args[t])}copyWithArgs(t){throw new Error(`Programming Error: copyWithArgs not implemented for ${this.constructor.name}`)}};var Et=class extends Q{constructor(n){super([]);this.isConstant=!0;typeof n=="number"&&(n=Se(n,1)),this._constantValue=n}asValue(){let n=this._constantValue;return typeof n=="boolean"?n:V(n)}asCompilerValue(){return this._constantValue}scalarExprString(){return this.asValue()>0?String(this.asValue()):"("+String(this.asValue())+")"}getEvaluationInfo(){return[{val:this.asValue()}]}isNaN(){let n=this.asValue();return typeof n=="number"&&isNaN(n)}};function c0(e){if(!an(e))throw new Error("Programming Error: numeric constants should be rational");return{type:1,valueType:I,value:e}}var vu=c0(Se(0,1)),Kc=c0(Se(1,1)),Nf=c0(Se(1,2));function pt(e){return e.map(t=>Ae(t))}function Su(e){return e.map(t=>kt(t))}function ee(e,t){var d,y,g,m,h;let n=t==null?void 0:t.defaultArguments,r=1/0,s=0,i=(d=n==null?void 0:n.length)!=null?d:0;for(let x of e){let T=x.minArity-i;T<r&&(r=T);let b=(y=x.maxArity)!=null?y:1/0;b>s&&(s=b)}let o=(g=t==null?void 0:t.fallthroughUnlessDistribution)!=null?g:!1,a=(m=t==null?void 0:t.allowDotCall)!=null?m:!1,u=(h=t==null?void 0:t.isSeeded)!=null?h:!1,c=t==null?void 0:t.minArityExampleArgs,l=t==null?void 0:t.maxArityExampleArgs,p=t==null?void 0:t.dotMinArityExampleArgs,f=t==null?void 0:t.dotMaxArityExampleArgs;return{minArity:r,getSignatures:x=>e.filter(T=>T.satisfiesPolicy(x)),maxArity:s,defaultArguments:n,fallthroughUnlessDistribution:o,minArityExampleArgs:c,maxArityExampleArgs:l,dotMinArityExampleArgs:p,dotMaxArityExampleArgs:f,allowDotCall:a,isSeeded:u}}function wo(){return ee(pt([{type:"variadic",initial:[],rest:Qt}]),{})}var Ag=Qn.of([de,ce,fe,Ne,ie]),o0=Qn.of([de,fe,Ne,le]),bp=Qn.of([N,de,ce,fe,Ne,le,ie,xe,Le,ye,Re]),a0=Qn.of([...ii.types.filter(e=>e!==Zn),Lt]),u0=Qn.of([Qt,pn],{coerceComplexToReal:!1});function el(e){return!!Fo[e]}function An(e){return[kt([Rd(e)]),kt([e]),Ae({type:"variadic",initial:[e,e],rest:e})]}function xp(e){return[kt([Rd(e),Rd(e)])]}var Fo={midpoint:ee([...pt([[N,N],[de]]),...pt([[z,z],[wt]])],{allowDotCall:!0}),segment:ee([Ae([N,N]),Ae([z,z])]),vector:ee([Ae([N,N]),Ae([z,z])]),sphere:ee([Ae([N,I]),Ae([z,I])]),distance:ee(pt([[N,N],[z,z]])),glider:ee(pt([[Qn.of([de,ce,fe,Ne,ie,xe]),I]])),circle:ee(pt([[N,de],[N,N],[N,I]]),{}),center:ee(pt([[ce],[ie]]),{allowDotCall:!0}),radius:ee(pt([[ce],[ie]]),{allowDotCall:!0}),intersection:ee(pt([[Ag,Ag]])),strictintersection:ee(pt([[Ag,Ag]])),parallel:ee(pt([[o0,N]])),perpendicular:ee(pt([[o0,N]])),anglebisector:ee(pt([[Tx]])),start:ee([Ae([le]),Ae([ke])],{allowDotCall:!0}),end:ee([Ae([le]),Ae([ke])],{allowDotCall:!0}),length:ee([kt([ii],{geometry:!1,"3d":!1}),Ae([wt]),Ae([ke]),Ae([de]),Ae([le]),Ae([ie]),kt({type:"variadic",initial:[Qt],rest:Qt},{geometry:!1,"3d":!1})],{allowDotCall:!0}),translate:ee(pt([[bp,le],[bp,N,N]])),dilate:ee(pt([[bp,N,I]])),rotate:ee(pt([[bp,N,I]])),reflect:ee(pt([[bp,o0]])),apply:ee(pt([[Re,bp]])),points:ee([]),lines:ee([]),circles:ee([]),arcs:ee([]),polygons:ee([]),rays:ee([]),vectors:ee([]),angle:ee(pt([[N,N,N]])),directedangle:ee(pt([[N,N,N]])),angles:ee(Su([[xe]]),{allowDotCall:!0}),directedangles:ee(Su([[xe]]),{allowDotCall:!0}),coterminal:ee(pt([[Le],[ye]])),round:ee([...pt([[Te],[Te,I]]),...pt([[R],[R,I]])]),mod:ee([...pt([[Te,Te]]),...pt([[R,R]])]),floor:ee([...pt([[Te]]),...pt([[R]])]),ceil:ee([...pt([[Te]]),...pt([[R]])]),abs:ee([...pt([[Te]]),...pt([[R]])]),sign:ee([Ae([Te]),Ae([R])]),real:ee([Ae([R])],{allowDotCall:!0}),imag:ee([Ae([R])],{allowDotCall:!0}),conj:ee([...pt([[Te]]),...pt([[R]])]),exp:ee([Ae([Te]),Ae([R])]),sin:ee([Ae([Te]),Ae([R])]),cos:ee([Ae([Te]),Ae([R])]),tan:ee([Ae([Te]),Ae([R])]),sinh:ee([Ae([Te]),Ae([R])]),cosh:ee([Ae([Te]),Ae([R])]),tanh:ee([Ae([Te]),Ae([R])]),sec:ee([Ae([Te]),Ae([R])]),csc:ee([Ae([Te]),Ae([R])]),cot:ee([Ae([Te]),Ae([R])]),sech:ee([Ae([Te]),Ae([R])]),csch:ee([Ae([Te]),Ae([R])]),coth:ee([Ae([Te]),Ae([R])]),arctan:ee([Ae([Te]),Ae([R]),...pt([[I,I]])]),arcsinh:ee([Ae([Te]),Ae([R])]),arccot:ee([Ae([Te]),Ae([R])]),arccsch:ee([Ae([Te]),Ae([R])]),nthroot:ee([...pt([[I,I]])]),complexNthRoot:ee([...pt([[R,R]])]),sort:ee(Su([[ro],[Ue],[ii,ro],[ii,Ue]]),{minArityExampleArgs:"([3,2,1])",maxArityExampleArgs:"([1,2,3],[3,2,1])",dotMaxArityExampleArgs:"([3,4])",allowDotCall:!0}),shuffle:ee(Su([[ft,ii],[ft,ii,I]]),{minArityExampleArgs:"([1,2,3])",maxArityExampleArgs:"([1,2,3],2)",dotMaxArityExampleArgs:"(2)",allowDotCall:!0,isSeeded:!0}),join:ee(Su([{type:"variadic",initial:[u0,u0],rest:u0}]),{minArityExampleArgs:"([1,2],[3,4])",dotMinArityExampleArgs:"([3,4])",allowDotCall:!0}),unique:ee(Su([[Qn.of(ii.types.filter(e=>e!==Zn&&e!==pn),{coerceComplexToReal:!1})]]),{minArityExampleArgs:"([1,2,3])",maxArityExampleArgs:"([1,2,3])",allowDotCall:!0}),normaldist:ee(pt([[I,I]]),{defaultArguments:[vu,Kc]}),tdist:ee(pt([[I]])),binomialdist:ee(pt([[I,I]]),{defaultArguments:[Nf]}),poissondist:ee(pt([[I]])),uniformdist:ee(pt([[I,I]]),{defaultArguments:[vu,Kc]}),pdf:ee(pt([[Lt,I]]),{allowDotCall:!0}),cdf:ee(pt([[Lt,I],[Lt,I,I]]),{allowDotCall:!0}),median:ee([...pt([[Lt]]),...An(I)],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),stdev:ee([...pt([[Lt]]),...An(Te),...An(R)],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),stdevp:ee([...An(Te),...An(R)],{allowDotCall:!0}),var:ee([...pt([[Lt]]),...An(Te),...An(R)],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),cov:ee([...xp(Te),...xp(R)]),covp:ee([...xp(Te),...xp(R)]),corr:ee([...xp(Te),...xp(R)]),quantile:ee([...pt([[Lt,I]]),kt([ne,oi(I)])],{fallthroughUnlessDistribution:!0,allowDotCall:!0,minArityExampleArgs:"([1,2,3], 1)",maxArityExampleArgs:"([1,2,3], 1)",dotMinArityExampleArgs:"(x)",dotMaxArityExampleArgs:"(x)"}),random:ee([kt([ft]),...Su([[ft,I],[ft,I,I],[ft,a0],[ft,a0,I],[ft,a0,I,I]])],{allowDotCall:!0,isSeeded:!0}),polygon:ee([kt([]),...An(N),...Su([[ne,ne],[I,ne],[ne,I]])]),total:ee([...An(Te),...An(R),...An(N),...An(z)],{allowDotCall:!0}),mean:ee([Ae([Lt]),...An(Te),...An(R),...An(N),...An(z)],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),varp:ee([Ae([Lt]),...An(Te),...An(R)],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),mad:ee([...An(Te),...An(R)]),lcm:ee([...An(Te),...An(R)],{allowDotCall:!0}),gcd:ee([...An(Te),...An(R)],{allowDotCall:!0}),min:ee([...An(I)],{allowDotCall:!0}),max:ee([...An(I)],{allowDotCall:!0}),histogram:wo(),dotplot:wo(),boxplot:wo(),ttest:wo(),ittest:wo(),stats:wo(),det:wo(),inv:wo(),transpose:wo(),rref:wo(),trace:wo()};function ck(e){switch(e){case"default":case"trig":case"inverseTrig":case"trig2":case"never-broadcast":return[I];case"reducer":return[ne];case"doubleReducer":return[ne,ne];case"parameterizedReducer":return[ne,I];case"color":return[I,I,I]}}function lk(e){switch(e){case"default":case"trig":case"inverseTrig":case"trig2":case"doubleReducer":case"color":case"never-broadcast":return!1;case"reducer":case"parameterizedReducer":return!0}}function pk(e,t,n){return e==="reducer"?1/0:t+n}function A(e,t,n){var d,y,g,m,h;n===void 0&&(n={});let r=(d=n.tag)!=null?d:"default",s=(y=n.argumentTypes)!=null?y:ck(r),i=n.defaultArguments?n.defaultArguments.length:0,o=s.length-i,a=pk(r,o,i),u=(g=n.allowDotCall)!=null?g:lk(r),c=(m=n.noPeel)!=null?m:!1,{defaultArguments:l,minArityExampleArgs:p,maxArityExampleArgs:f}=n;return{module:e,symbol:t,argumentTypes:s,defaultArguments:l,returnType:(h=n.returnType)!=null?h:I,tag:r,minArity:o,maxArity:a,allowDotCall:u,noPeel:c,minArityExampleArgs:p,maxArityExampleArgs:f}}function Ou(e){let t;return e in Bn&&(t=Bn[e].tag),t==="trig"||t==="trig2"||t==="inverseTrig"?!0:e==="angle"||e==="angles"||e==="directedangle"||e==="directedangles"||e==="rotate"}var Bn={sin:A("BuiltIn","sin",{tag:"trig"}),cos:A("BuiltIn","cos",{tag:"trig"}),tan:A("BuiltIn","tan",{tag:"trig"}),cot:A("BuiltIn","cot",{tag:"trig"}),sec:A("BuiltIn","sec",{tag:"trig"}),csc:A("BuiltIn","csc",{tag:"trig"}),arcsin:A("Math","asin",{tag:"inverseTrig"}),arccos:A("Math","acos",{tag:"inverseTrig"}),arctan:A("Math","atan2",{argumentTypes:[I,I],tag:"inverseTrig"}),arccot:A("BuiltIn","acot",{tag:"inverseTrig"}),arcsec:A("BuiltIn","asec",{tag:"inverseTrig"}),arccsc:A("BuiltIn","acsc",{tag:"inverseTrig"}),sinh:A("BuiltIn","sinh"),cosh:A("BuiltIn","cosh"),tanh:A("BuiltIn","tanh"),coth:A("BuiltIn","coth"),sech:A("BuiltIn","sech"),csch:A("BuiltIn","csch"),arcsinh:A("BuiltIn","asinh"),arccosh:A("BuiltIn","acosh"),arctanh:A("BuiltIn","atanh"),arccoth:A("BuiltIn","acoth"),arcsech:A("BuiltIn","asech"),arccsch:A("BuiltIn","acsch"),sqrt:A("Math","sqrt"),rtxsqpone:A("BuiltIn","sqrtxsqp1"),rtxsqmone:A("BuiltIn","sqrtxsqm1"),hypot:A("BuiltIn","hypot",{argumentTypes:[I,I]}),log:A("BuiltIn","common_log"),logbase:A("BuiltIn","log_base",{argumentTypes:[I,I]}),ln:A("BuiltIn","log"),exp:A("Math","exp"),floor:A("Math","floor"),complexFloor:A("BuiltIn","complexFloor",{argumentTypes:[R],returnType:R}),ceil:A("Math","ceil"),complexCeil:A("BuiltIn","complexCeil",{argumentTypes:[R],returnType:R}),round:A("Math","round"),complexRound:A("BuiltIn","complexRound",{argumentTypes:[R],returnType:R}),abs:A("Math","abs"),sign:A("BuiltIn","sign"),mod:A("BuiltIn","mod",{argumentTypes:[I,I]}),complexMod:A("BuiltIn","complexMod",{argumentTypes:[R,R],returnType:R}),nCr:A("BuiltIn","nCr",{argumentTypes:[I,I]}),nPr:A("BuiltIn","nPr",{argumentTypes:[I,I]}),factorial:A("BuiltIn","factorial"),polyGamma:A("BuiltIn","polyGamma",{argumentTypes:[I,I]}),lcm:A("BuiltIn","listLCM",{tag:"reducer"}),complexLCM:A("BuiltIn","complexListLCM",{argumentTypes:[Ue],returnType:R,tag:"reducer"}),gcd:A("BuiltIn","listGCD",{tag:"reducer"}),complexGCD:A("BuiltIn","complexListGCD",{argumentTypes:[Ue],returnType:R,tag:"reducer"}),distance:A("BuiltIn","distance",{argumentTypes:[N,N]}),polygon:A("BuiltIn","polygon",{tag:"reducer",argumentTypes:[Pt],returnType:xe}),area:A("BuiltIn","polygonArea",{argumentTypes:[xe]}),perimeter:A("BuiltIn","polygonPerimeter",{argumentTypes:[xe]}),pointDet:A("BuiltIn","pointDet",{argumentTypes:[N,N]}),pointDot:A("BuiltIn","pointDot",{argumentTypes:[N,N]}),pointPerp:A("BuiltIn","pointPerp",{argumentTypes:[N],returnType:N}),complexMultiplyPoints:A("BuiltIn","complexMultiplyPoints",{argumentTypes:[N,N],returnType:N}),segment:A("BuiltIn","segment",{argumentTypes:[N,N],returnType:de}),line:A("BuiltIn","line",{argumentTypes:[N,N],returnType:fe}),ray:A("BuiltIn","ray",{argumentTypes:[N,N],returnType:Ne}),vector:A("BuiltIn","vector",{argumentTypes:[N,N],returnType:le}),vectorThreeD:A("BuiltIn","vectorThreeD",{argumentTypes:[z,z],returnType:ke}),mathVector:A("BuiltIn","mathVector",{argumentTypes:[N,N],returnType:le}),mathVectorThreeD:A("BuiltIn","mathVectorThreeD",{argumentTypes:[z,z],returnType:ke}),vectorDisplacementAsPoint:A("BuiltIn","vectorDisplacementAsPoint",{argumentTypes:[le],returnType:N}),vectorThreeDDisplacementAsPoint:A("BuiltIn","vectorThreeDDisplacementAsPoint",{argumentTypes:[ke],returnType:z}),basePointFromVector:A("BuiltIn","basePointFromVector",{argumentTypes:[le],returnType:N}),basePointFromVectorThreeD:A("BuiltIn","basePointFromVectorThreeD",{argumentTypes:[ke],returnType:z}),circle:A("BuiltIn","circle",{argumentTypes:[N,I],returnType:ce}),center:A("BuiltIn","center",{argumentTypes:[ce],returnType:N,allowDotCall:!0}),radius:A("BuiltIn","radius",{argumentTypes:[ce],returnType:I,allowDotCall:!0}),arc:A("BuiltIn","arc",{argumentTypes:[N,N,N],returnType:ie}),arcCenter:A("BuiltIn","arcCenter",{argumentTypes:[ie],returnType:N}),arcFirstPoint:A("BuiltIn","arcFirstPoint",{argumentTypes:[ie],returnType:N}),arcMiddlePoint:A("BuiltIn","arcMiddlePoint",{argumentTypes:[ie],returnType:N}),arcThirdPoint:A("BuiltIn","arcThirdPoint",{argumentTypes:[ie],returnType:N}),arcOmega:A("BuiltIn","arcOmega",{argumentTypes:[ie],returnType:I}),undirectedAngleMarker:A("BuiltIn","undirectedAngleMarker",{argumentTypes:[ye],returnType:Le}),directedAngleMarker:A("BuiltIn","directedAngleMarker",{argumentTypes:[N,I,I,I],returnType:ye}),directedCoterminalAngle:A("BuiltIn","directedCoterminalAngle",{argumentTypes:[ye],returnType:ye}),undirectedCoterminalAngle:A("BuiltIn","undirectedCoterminalAngle",{argumentTypes:[Le],returnType:Le}),supplement:A("BuiltIn","supplementAngle",{argumentTypes:[ye],returnType:ye}),directedAngleMarkerRawDelta:A("BuiltIn","angleMarkerRawDelta",{argumentTypes:[ye],returnType:I}),undirectedAngleMarkerRawDelta:A("BuiltIn","angleMarkerRawDelta",{argumentTypes:[Le],returnType:I}),directedAngleMarkerMultiplier:A("BuiltIn","angleMarkerMultiplier",{argumentTypes:[ye],returnType:I}),undirectedAngleMarkerMultiplier:A("BuiltIn","angleMarkerMultiplier",{argumentTypes:[Le],returnType:I}),polygonInteriorUndirectedAngles:A("BuiltIn","polygonInteriorUndirectedAngles",{argumentTypes:[xe,I],returnType:On,allowDotCall:!0,tag:"never-broadcast"}),polygonInteriorDirectedAngles:A("BuiltIn","polygonInteriorDirectedAngles",{argumentTypes:[xe,I],returnType:Nn,allowDotCall:!0,tag:"never-broadcast"}),vertices:A("BuiltIn","vertices",{argumentTypes:[xe],returnType:Pt,allowDotCall:!0,tag:"never-broadcast"}),segments:A("BuiltIn","polygonEdges",{argumentTypes:[xe],returnType:xn,allowDotCall:!0,tag:"never-broadcast"}),scaleTangentTransformation:A("BuiltIn","scaleTangentTransformation",{argumentTypes:[Re,I],returnType:xe}),scaleTangentPolygon:A("BuiltIn","scaleTangentPolygon",{argumentTypes:[xe,I],returnType:xe}),scaleTangentSegment:A("BuiltIn","scaleTangentSegment",{argumentTypes:[de,I],returnType:de}),scaleTangentLine:A("BuiltIn","scaleTangentLine",{argumentTypes:[fe,I],returnType:fe}),scaleTangentRay:A("BuiltIn","scaleTangentRay",{argumentTypes:[Ne,I],returnType:Ne}),scaleTangentCircle:A("BuiltIn","scaleTangentCircle",{argumentTypes:[ce,I],returnType:ce}),scaleTangentArc:A("BuiltIn","scaleTangentArc",{argumentTypes:[ie,I],returnType:ce}),scaleTangentDirectedAngleMarker:A("BuiltIn","scaleTangentAngle",{argumentTypes:[ye,I],returnType:ye}),scaleTangentUndirectedAngleMarker:A("BuiltIn","scaleTangentAngle",{argumentTypes:[Le,I],returnType:Le}),addTangentPolygon:A("BuiltIn","addTangentPolygon",{argumentTypes:[xe,xe],returnType:xe}),addTangentSegment:A("BuiltIn","addTangentSegment",{argumentTypes:[de,de],returnType:de}),addTangentSegmentThreeD:A("BuiltIn","addTangentSegmentThreeD",{argumentTypes:[wt,wt],returnType:wt}),addTangentLine:A("BuiltIn","addTangentLine",{argumentTypes:[fe,fe],returnType:fe}),addTangentRay:A("BuiltIn","addTangentRay",{argumentTypes:[Ne,Ne],returnType:Ne}),addTangentVector:A("BuiltIn","addTangentVector",{argumentTypes:[le,le],returnType:le}),addTangentCircle:A("BuiltIn","addTangentCircle",{argumentTypes:[ce,ce],returnType:ce}),addTangentArc:A("BuiltIn","addTangentArc",{argumentTypes:[ie,ie],returnType:ie}),addTangentTransformation:A("BuiltIn","addTangentTransformation",{argumentTypes:[Re,Re],returnType:Re}),addTangentDirectedAngleMarker:A("BuiltIn","addTangentAngle",{argumentTypes:[ye,ye],returnType:ye}),addTangentUndirectedAngleMarker:A("BuiltIn","addTangentAngle",{argumentTypes:[Le,Le],returnType:Le}),segmentGlider:A("BuiltIn","segmentGlider",{argumentTypes:[de,I],returnType:N}),segmentThreeDGlider:A("BuiltIn","segmentThreeDGlider",{argumentTypes:[wt,I],returnType:z}),lineGlider:A("BuiltIn","lineGlider",{argumentTypes:[fe,I],returnType:N}),rayGlider:A("BuiltIn","rayGlider",{argumentTypes:[Ne,I],returnType:N}),circleGlider:A("BuiltIn","circleGlider",{argumentTypes:[ce,I],returnType:N}),arcGlider:A("BuiltIn","arcGlider",{argumentTypes:[ie,I],returnType:N}),polygonEdgeByParameter:A("BuiltIn","polygonEdgeByParameter",{argumentTypes:[xe,I],returnType:de}),polygonGlider:A("BuiltIn","polygonGlider",{argumentTypes:[xe,I],returnType:N}),chooseNonIncidentPoint:A("BuiltIn","chooseNonIncidentPoint",{argumentTypes:[N,N,N],returnType:N}),circleCircleIntersection:A("BuiltIn","circleCircleIntersection",{argumentTypes:[ce,ce,I],returnType:N}),circleArcIntersection:A("BuiltIn","circleArcIntersection",{argumentTypes:[ce,ie,I],returnType:N}),circleLineIntersection:A("BuiltIn","circleLineIntersection",{argumentTypes:[ce,fe,I],returnType:N}),arcCircleIntersection:A("BuiltIn","arcCircleIntersection",{argumentTypes:[ie,ce,I],returnType:N}),arcArcIntersection:A("BuiltIn","arcArcIntersection",{argumentTypes:[ie,ie,I],returnType:N}),arcLineIntersection:A("BuiltIn","arcLineIntersection",{argumentTypes:[ie,fe,I],returnType:N}),lineCircleIntersection:A("BuiltIn","lineCircleIntersection",{argumentTypes:[fe,ce,I],returnType:N}),lineArcIntersection:A("BuiltIn","lineArcIntersection",{argumentTypes:[fe,ie,I],returnType:N}),lineLineIntersection:A("BuiltIn","lineLineIntersection",{argumentTypes:[fe,fe,I],returnType:N}),lineFromSegment:A("BuiltIn","identity",{argumentTypes:[de],returnType:fe}),lineFromRay:A("BuiltIn","identity",{argumentTypes:[Ne],returnType:fe}),parallel:A("BuiltIn","parallel",{argumentTypes:[fe,N],returnType:fe}),perpendicular:A("BuiltIn","perpendicular",{argumentTypes:[fe,N],returnType:fe}),anglebisector:A("BuiltIn","anglebisector",{argumentTypes:[Le],returnType:Ne}),directedanglebisector:A("BuiltIn","anglebisector",{argumentTypes:[ye],returnType:Ne}),rawTransform:A("BuiltIn","rawTransform",{argumentTypes:[N,N],returnType:Re}),rawTransformConj:A("BuiltIn","rawTransformConj",{argumentTypes:[N,N],returnType:Re}),transformWithoutTranslation:A("BuiltIn","transformWithoutTranslation",{argumentTypes:[Re],returnType:Re}),transformScaleFactor:A("BuiltIn","transformScaleFactor",{argumentTypes:[Re],returnType:N}),translation:A("BuiltIn","translation",{argumentTypes:[N],returnType:Re}),dilation:A("BuiltIn","dilation",{argumentTypes:[N,I],returnType:Re}),rotation:A("BuiltIn","rotation",{tag:"trig2",argumentTypes:[N,I],returnType:Re}),reflection:A("BuiltIn","reflection",{argumentTypes:[fe],returnType:Re}),compose:A("BuiltIn","composeTransformation",{argumentTypes:[Re,Re],returnType:Re}),inverse:A("BuiltIn","invertTransformation",{argumentTypes:[Re],returnType:Re}),transformPoint:A("BuiltIn","transformPoint",{argumentTypes:[Re,N],returnType:N}),transformSegment:A("BuiltIn","transformSegment",{argumentTypes:[Re,de],returnType:de}),transformLine:A("BuiltIn","transformLine",{argumentTypes:[Re,fe],returnType:fe}),transformRay:A("BuiltIn","transformRay",{argumentTypes:[Re,Ne],returnType:Ne}),transformVector:A("BuiltIn","transformVector",{argumentTypes:[Re,le],returnType:le}),transformCircle:A("BuiltIn","transformCircle",{argumentTypes:[Re,ce],returnType:ce}),transformArc:A("BuiltIn","transformArc",{argumentTypes:[Re,ie],returnType:ie}),transformPolygon:A("BuiltIn","transformPolygon",{argumentTypes:[Re,xe],returnType:xe}),transformAngleMarker:A("BuiltIn","transformAngleMarker",{argumentTypes:[Re,Le],returnType:Le}),transformDirectedAngleMarker:A("BuiltIn","transformAngleMarker",{argumentTypes:[Re,ye],returnType:ye}),distanceThreeD:A("BuiltIn","distanceThreeD",{argumentTypes:[z,z]}),segmentThreeD:A("BuiltIn","segmentThreeD",{argumentTypes:[z,z],returnType:wt}),triangle:A("BuiltIn","triangle",{argumentTypes:[z,z,z],returnType:Rn}),sphere:A("BuiltIn","sphere",{argumentTypes:[z,I],returnType:Hn}),mean:A("BuiltIn","mean",{tag:"reducer"}),total:A("BuiltIn","total",{tag:"reducer"}),stdev:A("BuiltIn","stdev",{tag:"reducer"}),stdevp:A("BuiltIn","stdevp",{tag:"reducer"}),mad:A("BuiltIn","mad",{tag:"reducer"}),count:A("BuiltIn","listLength",{tag:"reducer",argumentTypes:[pn],noPeel:!0}),listMin:A("BuiltIn","listMin",{tag:"reducer"}),listMax:A("BuiltIn","listMax",{tag:"reducer"}),min:A("Math","min",{argumentTypes:[I,I],returnType:I}),max:A("Math","max",{argumentTypes:[I,I],returnType:I}),argmin:A("BuiltIn","argMin",{tag:"reducer",noPeel:!0}),argmax:A("BuiltIn","argMax",{tag:"reducer",noPeel:!0}),median:A("BuiltIn","median",{tag:"reducer"}),var:A("BuiltIn","variance",{tag:"reducer"}),varp:A("BuiltIn","varp",{tag:"reducer"}),cov:A("BuiltIn","cov",{tag:"doubleReducer"}),covp:A("BuiltIn","covp",{tag:"doubleReducer"}),corr:A("BuiltIn","corr",{tag:"doubleReducer"}),spearman:A("BuiltIn","spearman",{tag:"doubleReducer"}),quantile:A("BuiltIn","quantile",{tag:"parameterizedReducer"}),quartile:A("BuiltIn","quartile",{tag:"parameterizedReducer"}),upperQuantileIndex:A("BuiltIn","upperQuantileIndex",{tag:"parameterizedReducer"}),lowerQuantileIndex:A("BuiltIn","lowerQuantileIndex",{tag:"parameterizedReducer"}),quartileIndex:A("BuiltIn","quartileIndex",{tag:"parameterizedReducer"}),upperQuartileIndex:A("BuiltIn","upperQuartileIndex",{tag:"parameterizedReducer"}),lowerQuartileIndex:A("BuiltIn","lowerQuartileIndex",{tag:"parameterizedReducer"}),normalcdf:A("BuiltIn","normalcdf",{argumentTypes:[I,I,I,I],defaultArguments:[vu,Kc]}),normalpdf:A("BuiltIn","normalpdf",{argumentTypes:[I,I,I],defaultArguments:[vu,Kc]}),binomcdf:A("BuiltIn","binomcdf",{argumentTypes:[I,I,I,I],defaultArguments:[Nf]}),binompdf:A("BuiltIn","binompdf",{argumentTypes:[I,I,I],defaultArguments:[Nf]}),poissoncdf:A("BuiltIn","poissoncdf",{argumentTypes:[I,I,I]}),poissonpdf:A("BuiltIn","poissonpdf",{argumentTypes:[I,I,I]}),uniformcdf:A("BuiltIn","uniformcdf",{argumentTypes:[I,I,I,I],defaultArguments:[vu,Kc]}),uniformpdf:A("BuiltIn","uniformpdf",{argumentTypes:[I,I,I],defaultArguments:[vu,Kc]}),invT:A("BuiltIn","invT",{argumentTypes:[I,I]}),invPoisson:A("BuiltIn","invPoisson",{argumentTypes:[I,I]}),invBinom:A("BuiltIn","invBinom",{argumentTypes:[I,I,I]}),invUniform:A("BuiltIn","invUniform",{argumentTypes:[I,I,I]}),tpdf:A("BuiltIn","tpdf",{argumentTypes:[I,I]}),tcdf:A("BuiltIn","tcdf",{argumentTypes:[I,I,I]}),erf:A("BuiltIn","erf"),invNorm:A("BuiltIn","invNorm"),tscore:A("BuiltIn","tscore",{tag:"parameterizedReducer",defaultArguments:[vu]}),normalSample:A("BuiltIn","normalSample",{argumentTypes:[ft,I,I]}),uniformSample:A("BuiltIn","uniformSample",{argumentTypes:[ft,I,I]}),tSample:A("BuiltIn","tSample",{argumentTypes:[ft,I]}),poissonSample:A("BuiltIn","poissonSample",{argumentTypes:[ft,I]}),binomSample:A("BuiltIn","binomSample",{argumentTypes:[ft,I,I]}),rgb:A("BuiltIn","rgb",{returnType:Kt,tag:"color"}),hsv:A("BuiltIn","hsv",{returnType:Kt,tag:"color"}),tone:A("BuiltIn","tone",{argumentTypes:[I,I],returnType:Pn,defaultArguments:[Nf],minArityExampleArgs:"(440)",maxArityExampleArgs:"(440, 0.5)"}),validateRangeLength:A("BuiltIn","validateRangeLength",{returnType:I,argumentTypes:[ne,ne,I,I],tag:"never-broadcast",noPeel:!0}),validateSampleCount:A("BuiltIn","validateSampleCount",{returnType:I,argumentTypes:[I]}),select:A("BuiltIn","select",{argumentTypes:[pn,Xn],returnType:e=>e[0],tag:"never-broadcast",noPeel:!0}),shuffle:A("BuiltIn","shuffle",{argumentTypes:[ft,pn],returnType:e=>e[1],tag:"never-broadcast"}),sortPerm:A("BuiltIn","sortPerm",{argumentTypes:[ne],returnType:ne,tag:"never-broadcast",noPeel:!0}),complexSortPerm:A("BuiltIn","complexSortPerm",{argumentTypes:[Ue],returnType:ne,tag:"never-broadcast",noPeel:!0}),elementsAt:A("BuiltIn","elementsAt",{argumentTypes:[pn,ne],returnType:e=>e[0],tag:"never-broadcast",noPeel:!0}),uniquePerm:A("BuiltIn","uniquePerm",{argumentTypes:[pn],returnType:ne,tag:"never-broadcast",noPeel:!0}),restriction:A("BuiltIn","restriction",{argumentTypes:[De],returnType:Gt}),restrictionToBoolean:A("BuiltIn","restrictionToBoolean",{argumentTypes:[Gt],returnType:De}),complex:A("BuiltIn","complex",{argumentTypes:[I,I],returnType:R}),arg:A("BuiltIn","arg",{argumentTypes:[R],returnType:I}),complexDivide:A("BuiltIn","complexDivide",{argumentTypes:[R,R],returnType:R}),peelableCoerceComplexToReal:A("BuiltIn","coerceComplexToReal",{argumentTypes:[R],returnType:I}),coerceComplexToReal:A("BuiltIn","coerceComplexToReal",{argumentTypes:[R],returnType:I}),coerceRealToComplex:A("BuiltIn","coerceRealToComplex",{argumentTypes:[I],returnType:R}),complexSqrt:A("BuiltIn","complexSqrt",{argumentTypes:[R],returnType:R}),complexLn:A("BuiltIn","complexLog",{argumentTypes:[R],returnType:R}),complexLogbase:A("BuiltIn","complexLogbase",{argumentTypes:[R,R],returnType:R}),complexLog:A("BuiltIn","complexCommonLog",{argumentTypes:[R],returnType:R}),complexExp:A("BuiltIn","complexExp",{argumentTypes:[R],returnType:R}),complexPow:A("BuiltIn","complexPow",{argumentTypes:[R,R],returnType:R}),complexSin:A("BuiltIn","complexSin",{argumentTypes:[R],returnType:R}),complexCos:A("BuiltIn","complexCos",{argumentTypes:[R],returnType:R}),complexTan:A("BuiltIn","complexTan",{argumentTypes:[R],returnType:R}),complexSinh:A("BuiltIn","complexSinh",{argumentTypes:[R],returnType:R}),complexCosh:A("BuiltIn","complexCosh",{argumentTypes:[R],returnType:R}),complexTanh:A("BuiltIn","complexTanh",{argumentTypes:[R],returnType:R}),complexSec:A("BuiltIn","complexSec",{argumentTypes:[R],returnType:R}),complexCsc:A("BuiltIn","complexCsc",{argumentTypes:[R],returnType:R}),complexCot:A("BuiltIn","complexCot",{argumentTypes:[R],returnType:R}),complexSech:A("BuiltIn","complexSech",{argumentTypes:[R],returnType:R}),complexCsch:A("BuiltIn","complexCsch",{argumentTypes:[R],returnType:R}),complexCoth:A("BuiltIn","complexCoth",{argumentTypes:[R],returnType:R}),complexArcsin:A("BuiltIn","complexAsin",{argumentTypes:[R],returnType:R}),complexArccos:A("BuiltIn","complexAcos",{argumentTypes:[R],returnType:R}),complexArctan:A("BuiltIn","complexAtan",{argumentTypes:[R],returnType:R}),complexArcsec:A("BuiltIn","complexAsec",{argumentTypes:[R],returnType:R}),complexArccsc:A("BuiltIn","complexAcsc",{argumentTypes:[R],returnType:R}),complexArccot:A("BuiltIn","complexAcot",{argumentTypes:[R],returnType:R}),complexArcsinh:A("BuiltIn","complexAsinh",{argumentTypes:[R],returnType:R}),complexArccosh:A("BuiltIn","complexAcosh",{argumentTypes:[R],returnType:R}),complexArctanh:A("BuiltIn","complexAtanh",{argumentTypes:[R],returnType:R}),complexArcsech:A("BuiltIn","complexAsech",{argumentTypes:[R],returnType:R}),complexArccsch:A("BuiltIn","complexAcsch",{argumentTypes:[R],returnType:R}),complexArccoth:A("BuiltIn","complexAcoth",{argumentTypes:[R],returnType:R}),angleVertex:A("BuiltIn","angleVertex",{argumentTypes:[Le],returnType:N}),angleStart:A("BuiltIn","angleStart",{argumentTypes:[Le],returnType:I}),directedAngleVertex:A("BuiltIn","angleVertex",{argumentTypes:[ye],returnType:N}),directedAngleStart:A("BuiltIn","angleStart",{argumentTypes:[ye],returnType:I})},Ip={sqrt:"complexSqrt",ln:"complexLn",log:"complexLog",logbase:"complexLogbase",exp:"complexExp",sin:"complexSin",cos:"complexCos",tan:"complexTan",sinh:"complexSinh",cosh:"complexCosh",tanh:"complexTanh",sec:"complexSec",csc:"complexCsc",cot:"complexCot",sech:"complexSech",csch:"complexCsch",coth:"complexCoth",arcsin:"complexArcsin",arccos:"complexArccos",arctan:"complexArctan",arcsec:"complexArcsec",arccsc:"complexArccsc",arccot:"complexArccot",arcsinh:"complexArcsinh",arccosh:"complexArccosh",arctanh:"complexArctanh",arcsech:"complexArcsech",arccsch:"complexArccsch",arccoth:"complexArccoth",floor:"complexFloor",ceil:"complexCeil",mod:"complexMod",nthroot:"complexNthRoot",sortPerm:"complexSortPerm"},dk={sqrt:!0,ln:!0,log:!0,logbase:!0,arcsin:!0,arccos:!0,arcsec:!0,arccsc:!0,arccosh:!0,arctanh:!0,arcsech:!0,arccoth:!0,nthroot:!0};function _g(e,t){return e.isComplexEnabled()&&t in dk?Ip[t]:t}function Tp(e){return!!Bn[e]}function Rf(e,t){let n=el(t)?Fo[t]:void 0;if(!n&&!Tp(t))return;let r=[];return n&&(r=[...n.getSignatures(e)]),Tp(t)&&!n&&r.push(...l0(t)),r}function l0(e){var s;let t=[],n=Bn[e],r=(s=n.returnType)!=null?s:I;switch(n.tag){case"reducer":{if(Array.isArray(n.argumentTypes)&&typeof n.argumentTypes[0]=="number"&&j(n.argumentTypes[0])&&typeof r=="number"&&wn(r)){let i=n.argumentTypes[0],o=Ve(i);t.push(...An(o))}else throw new Error(`Programming error: declared argumentTypes for built-in function ${e} is not consistent with "reducer"`);break}case"parameterizedReducer":{if(t.push(kt(n.argumentTypes)),Array.isArray(n.argumentTypes)&&n.argumentTypes.length===2){let i=n.argumentTypes[1];t.push(kt([n.argumentTypes[0],typeof i=="number"&&wn(i)?oi(i):i]))}break}case"doubleReducer":case"never-broadcast":{t.push(kt(n.argumentTypes));break}default:{t.push(kt(n.argumentTypes.map(i=>ty(i)?oi(i):i)));break}}return t}var we=class extends Q{constructor(t){super([]),this._symbol=no(t),this._errorSymbol=this._symbol,this.addDependency(this._symbol)}setInputSpan(t){super.setInputSpan(t),this._errorSymbol=no(this.getInputString())}getInputSpan(){return this._inputSpan===void 0?Vs(this._symbol,0,this._symbol.length):this._inputSpan}};var gn=class extends Q{constructor(t,n){super(n,{skipRegisterDependencies:!0}),typeof t=="string"&&(t=new we(t)),this._identifier=t,this._symbol=t._symbol,this._errorSymbol=t._errorSymbol==="logbase"?"log":t._errorSymbol,this.registerDependencies()}registerDependencies(){this.addDependency(this._symbol),super.registerDependencies(),Ou(this._symbol)&&this.addDependency("trigAngleMultiplier")}};var ao=class extends Q{slot(t){return this.args[t]}};var p0={pi:new Et(Math.PI),tau:new Et(2*Math.PI),e:new Et(Math.E),trigAngleMultiplier:new Et(Se(1,1)),infty:new Et(1/0),identityTransformation:new gn("translation",[new ao([new Et(0),new Et(0)])])};var Lg=class extends Yt{constructor(){super(...arguments);this.isFunction=!0}},tl,tt={};for(tl of We(p0))tt[tl]=p0[tl];for(tl of We(Bn))tt[tl]=new Lg;for(tl of We(Fo))tt[tl]=new Lg;var Jr={"<":{inclusive:!1,direction:-1},"!=":{inclusive:!1,direction:0},">":{inclusive:!1,direction:1},"<=":{inclusive:!0,direction:-1},"=":{inclusive:!0,direction:0},">=":{inclusive:!0,direction:1}};function nl(e,t){switch(t){case-1:return e?"<=":"<";case 0:return e?"=":"!=";case 1:return e?">=":">";default:throw"Programming error.  Comparators must have a direction of -1, 0, or 1"}}var Es=class extends Q{};var uo=class e extends Q{constructor(n,r){super(r);this.operator=n;this._difference=Jr[this.operator].direction===-1?new Es([r[1],r[0]]):new Es([r[0],r[1]])}static create(n){class r extends e{constructor(i){super(n,i)}}return r}asComparator(){return this}isInequality(){return Jr[this.operator].direction!==0}};var ps={"<":uo.create("<"),">":uo.create(">"),"<=":uo.create("<="),">=":uo.create(">="),"=":uo.create("=")};var Nu=class extends Yt{constructor(t,n){super(),this.mergeDependencies(t,n),this._lhs=t,this._rhs=n,this._difference=new Es([this._lhs,this._rhs])}asComparator(){return new ps["="]([this._lhs,this._rhs])}};var Cr=class extends Yt{constructor(n,r,s,i){super();this.recursionInfo=i;this.externalBaseCases=[];this.isFunction=!0;this._symbol=n._symbol,this._argSymbols=r.map(o=>o._symbol);for(let o of this._argSymbols)if(o===this._symbol)throw PI(o);this._exports=[this._symbol],this._expression=s,this.mergeDependenciesInScope(this.type,[this._symbol].concat(this._argSymbols),this._expression,{functionDefinitionSymbol:this._symbol}),this.combinedDependencies=super.getDependencies()}getDependencies(){return this.combinedDependencies}setExternalBaseCases(n){this.externalBaseCases=[...n],this.combinedDependencies=[...super.getDependencies()];for(let r of n){let s=r.getRef();s&&this.combinedDependencies.push(s)}}getExternalBaseCases(){return this.externalBaseCases}getSliderVariables(n,r){let s=this._argSymbols;return super.getSliderVariables(n,r).filter(i=>s.indexOf(i)===-1)}asEquation(){let n=this._argSymbols.map(s=>new we(s)),r=new Nu(new gn(new we(this._symbol),n),this._expression);return r.userData=this.userData,r.metaData=this.metaData,r}};var Qr=class e extends Yt{constructor(n,r,s,i,o){super();this.specifiedArg=s;this.rhs=i;this.originalNode=o;if(this._symbol=n,this._argSymbols=r.map(a=>a._symbol),this._expression=i,this.userData=o.userData,this.metaData=o.metaData,this._inputSpan=o._inputSpan,this.mergeDependenciesInScope("FunctionDefinition",this._argSymbols,this._expression,{functionDefinitionSymbol:this._symbol}),s.valid){let a=s.functionDefArgSymbols.slice();a[s.argIndex]=s.argValue.toString(),this.ref=`_base_case:${n}:${a.join(",")}`,this._exports=[this.ref]}else{let a=this._exports.find(u=>u.indexOf("idref")!==-1);a&&(this.ref=a)}}static fromCallAssignment(n,r){let s=r._lhs;if(!(s instanceof gn))return;let i=n[s._symbol];if(!i||!(i instanceof Cr))return;if(s.args.length!==i._argSymbols.length)return new e(i._symbol,[],{valid:!1,error:_x(i._symbol,i._argSymbols.length)},r._rhs,r);let o,a=[];for(let u=0;u<s.args.length;u++){let c=s.args[u];if(c instanceof Et){if(o){o={valid:!1,error:wd()};break}o={valid:!0,argIndex:u,functionDefArgSymbols:i._argSymbols,argValue:c.asValue(),argSymbol:i._argSymbols[u]}}else if(c instanceof we)if(c._symbol!==i._argSymbols[u]){o={valid:!1,error:ay()};break}else a.push(c);else{o={valid:!1,error:ay()};break}}if(o)return new e(i._symbol,a,o,r._rhs,r)}getRef(){return this.ref}getSliderVariables(n,r){let s=this._argSymbols;return super.getSliderVariables(n,r).filter(i=>s.indexOf(i)===-1)}};var Wa=class extends Yt{constructor(t,n,r,s,i){super(),this.parameters=t,this.residuals=n,this.statistics=r,this.model=s,this.isModelValid=i.isModelValid,this.residualVariable=i.residualVariable,this.residualSuggestionId=i.residualSuggestionId,this.shouldSuggestLogMode=i.shouldSuggestLogMode,this.isLinear=i.isLinear,this.parameterWarning=i.parameterWarning,this.displayPrecision=i.displayPrecision,this._exports=[this.residualVariable];for(let o of We(t))this._exports.push(o);this.mergeDependencies(s)}getCompiledFunction(){return this.model.getCompiledFunction.apply(this.model,arguments)}getCompiledDerivative(){return this.model.getCompiledDerivative.apply(this.model,arguments)}};function Af(e){return e.type==="FunctionDefinition"}function Qv(e){return e.type==="FunctionCall"}function ki(e){return e.type==="Identifier"}function Hi(e){return e.type==="Table"}function _f(e){return e.type==="Image"}function Kr(e){return e.type==="Error"}function ui(e){return e.type==="Regression"}function ga(e){return e.type==="TableColumn"}function ha(e){return e.type==="TableColumnValue"}var Pp=class extends Yt{constructor(n,r){super();this.isRegression=!0;this.tableRegressionData=void 0;this._lhs=n,this.isLhsSimple=n instanceof we,this._logLhs=new gn("ln",[n]),this._rhs=r,this._difference=new Es([n,r]),this._logDifference=new Es([new gn("ln",[n]),new gn("ln",[r])]),this.mergeDependencies(n,r)}getExportsFromConcrete(n,r){if(Kr(r))return[];let s=[];for(let i of We(r.parameters))n.assignmentForbidden(i)||s.push(i);return n.assignmentForbidden(r.residualVariable)||s.push(r.residualVariable),s}exportTo(n,r,s){if(r.isError)return[];if(!(r instanceof Wa))throw U(`Expected optimized regression but got ${r.type}.`);let i=[];for(let o of We(r.parameters))n.assignmentForbidden(o)||(i.push(o),s[o]=s[o]?Wl(o):r.parameters[o]);return n.assignmentForbidden(r.residualVariable)?[]:(s[r.residualVariable]=r.residuals,i.push(r.residualVariable),i)}getSliderVariables(){return[]}analyzeRegression(n,r,s,i,o){throw U(`Node ${this.type} does not define analyzeRegression.`)}};var co=class extends Yt{constructor(n,r,s,i){super();this.tableID=s;this.columnIndex=i;this.headerDependencies=new Set;this.cellDependencies=new Set;this.header=n,this.values=r,this.registerDependencies(),this._exports=this.computeExports(),this.localFrameID=s}registerDependencies(){this.mergeDependencies(this.header),this.mergeDependencies.apply(this,this.values);for(let n of this.header.getDependencies())this.headerDependencies.add(n);for(let n of this.header.getOptionalDependencies())this.headerDependencies.add(n);for(let n of this.values){for(let r of n.getDependencies())this.cellDependencies.add(r);for(let r of n.getOptionalDependencies())this.cellDependencies.add(r)}}computeExports(){return this.header instanceof we?[this.header._symbol]:[]}_exportSymbolsTo(n,r,s){if(n.length===0)return;let i=this.getExportValue(r,s);this.header instanceof we&&!this.isFreeVariable(s)&&(n=n.filter(o=>o!==this.header._symbol));for(let o of n)s.hasOwnProperty(o)||(s[o]=i)}getExportValue(n,r){return this.isFreeVariable(r)||n.blocksExport?n:this.header}isFreeVariable(n){return this.header instanceof we&&GD(n).definitionLevel[this.header._symbol]===1}exportTo(n,r,s){let i=this.getLegalExports(n);return this._exportSymbolsTo(i,r,s),i}exportToLocal(n,r,s){this._exportSymbolsTo(this.getExports(n),r,s)}};function mk(e){return e instanceof Qr?{type:2}:Af(e)?{type:1,rhsDependencies:e._expression.getDependencies(),fnSymbol:e._symbol}:{type:0}}function yk(e,t,n,r){var s;if(t instanceof Pp){let i=r==null?void 0:r.get(n);if(i)return{exports:i,dependencies:{type:"simple",localFrameID:void 0,dependencies:[]}}}if(t instanceof co){let i=t.header instanceof we?t.header._symbol:void 0;return{exports:t.getLegalExports(e),dependencies:{type:"table-column",localFrameID:t.localFrameID,headerIdent:i,headerDependencies:t.headerDependencies,cellDependencies:t.cellDependencies}}}return{exports:t.getLegalExports(e),dependencies:{type:"simple",localFrameID:ui(t)?(s=t.tableRegressionData)==null?void 0:s.tableId:t.localFrameID,dependencies:t.getDependencies()}}}function gk(e,t){if(t.localFrameID!==void 0)return{frameID:t.localFrameID,exports:t.getExports(e)}}function Lf(e,t,n,r){let s=hk(e,t,r),i=xk(s);return Ik(e,s,i,n)}function hk(e,t,n){let r={};for(let s of Object.keys(t)){let i=t[s],{exports:o,dependencies:a}=yk(e,i,s,n),u=gk(e,i);r[s]={meta:mk(i),exports:o,dependencies:a,local:u}}return r}function d0(e,t,n){var r,s,i,o;(s=(r=e.assignments)[t])!=null||(r[t]=[]),e.assignments[t].push(n),e.assignments[t].length>1&&(e.multiplyDefined[t]=!0),(o=(i=e.exports)[n])!=null||(i[n]=[]),e.exports[n].push(t)}function bk(e,t){let n=e.get(t),r=n!=null?n:{assignments:{},multiplyDefined:{},exports:{}};return n||e.set(t,r),r}function xk(e){let t=new Map,n={},r={assignments:{},exports:{},multiplyDefined:{}};for(let s of We(e)){let i=e[s];if(i.local===void 0)for(let o of i.exports)tt[o]||(n[o]=0,d0(r,o,s))}for(let s of We(e)){let i=e[s];if(i.local===void 0)continue;for(let a of i.exports)tt[a]||n[a]!==0&&(n[a]=1,d0(r,a,s));let o=bk(t,i.local.frameID);for(let a of i.local.exports)tt[a]||n[a]!==0&&(n[a]=1,d0(o,a,s))}return{exports:r.exports,assignments:r.assignments,definitionLevel:n,multiplyDefined:r.multiplyDefined,localAssignments:t}}function Tk(e,t,n){var r,s;if(t!==void 0){let i=(r=e.localAssignments.get(t))==null?void 0:r.assignments[n];if(i)return i}return(s=e.assignments[n])!=null?s:[]}function Kv(e,t){var n;return(n=e.multiplyDefined[t])!=null?n:!1}function Ik(e,t,n,r){let s=[],i=new Set,o={},a=new Set,u={},c=0,l=[],p=[];for(let g of r)u.hasOwnProperty(g)||f(g);function f(g){u[g]=u[g]||{};let m=u[g],h;m.id=g,m.index=c,m.lowlink=c,l.push(m),m.instack=!0,c++;let x=t[g],T;x.dependencies.type==="simple"?T=x.dependencies.dependencies:!x.dependencies.headerIdent||n.definitionLevel[x.dependencies.headerIdent]===0?T=x.dependencies.headerDependencies:T=x.dependencies.cellDependencies;for(let b of T){let M=x.dependencies.localFrameID,P=Tk(n,M,b);for(let D of P)u.hasOwnProperty(D)?(h=u[D],h.instack&&(m.lowlink=Math.min(m.lowlink,h.index))):(f(D),h=u[D],m.lowlink=Math.min(m.lowlink,h.lowlink))}if(m.lowlink===m.index)if(h=l.pop(),h.instack=!1,h===m)d(m.id);else{let b=[h.id];for(;h=l.pop(),h.instack=!1,b.push(h.id),h!==m;);y(b)}}function d(g){p.push(g);let m=t[g];if(m.meta.type===1){let h=m.meta.fnSymbol;!e.assignmentForbidden(h)&&m.meta.rhsDependencies.includes(h)&&!Kv(n,h)&&(o[g]=[g],a.add(h))}}function y(g){var b;let m=[],h=!0,x=[],T=new Set;for(let M=g.length-1;M>=0;M--){let P=g[M],D=t[P];for(let S of D.exports)m.push({symbol:S,localFrameID:(b=D.local)==null?void 0:b.frameID});T.add(P),p.push(P),D.meta.type===1&&!Kv(n,D.meta.fnSymbol)?x.push(P):h=!1,D.meta.type===2&&i.add(P)}if(h){for(let M of[...T])o[M]=x;for(let{symbol:M}of m)a.add(M)}s.push(m)}return{resolved:p,exports:n.exports,assignments:n.assignments,definitionLevel:n.definitionLevel,multiplyDefined:n.multiplyDefined,cycles:s,recursiveFunctionGroups:o,recursiveFunctionSymbols:a,recursiveFunctionBaseCasesWithCycles:i,localDependencyOrder:n.localAssignments}}function eO(e){let t=function(...r){return new e(...r)};t.prototype=e.prototype;let n=Object.getOwnPropertyNames(e);for(let r of n){let s=e[r];if(typeof s=="function")try{t[r]=s}catch(i){}}return t}var Ep=class extends Q{};var Fg=class extends we{};var ja=class extends Yt{constructor(t,n){super(),t instanceof we?this._symbol=t._symbol:this._symbol=t,this.mergeDependencies(n),this._expression=n,this._exports=this.computeExports()}shouldExportAns(){return!0}computeExports(){let t=this._symbol,n=this.getDependencies();for(let r=0;r<n.length;r++)if(n[r]===t)return[];return[t]}isEquation(t,n){let r=this._symbol,s=r==="x"||r==="y",i=r==="r"||r==="z",o=r==="rho",a=n.getDependencies(),u=this.graphmodeDependencies(t,n);return o||i||s&&a.includes("z")?u.includes(r):a.includes(r)}asEquation(){let t=new Nu(new we(this._symbol),this._expression);return t.userData=this.userData,t.metaData=this.metaData,t}shouldPromoteToSlider(t){if(!this._expression.isConstant||this._expression.is_mixed_number)return!1;let n=this._expression.asValue();return typeof n!="number"||!isFinite(n)?!1:t.isValidSlider(this._symbol)}};var Mp=class extends Q{constructor(t){super(t),this._symbol=t[0]._symbol,this._lhs=t[0],this._rhs=t[1]}};var Ru=class extends Q{};var Cp=class extends Q{constructor(t){super(t),this._symbol="boxplot"}};var Fr=class extends Q{};function Pk(e,t){let n=Jr[e[0]].direction===-1?new Es([t[1],t[0]]):new Es([t[0],t[1]]);switch(e.length){case 0:throw new Error("Programming Error: ComparatorChain must have at least one comparator");case 1:return n;case 2:return new Fr([new ps[e[1]](t.slice(1)),n,new Et(NaN)]);default:return new Fr([new Au(e.slice(1),t.slice(1)),n,new Et(NaN)])}}var Au=class extends Q{constructor(n,r){super(r);this.symbols=n;if(n.length<1)throw"Programming Error: ComparatorChain must have at least one comparator.";if(r.length!==n.length+1)throw"Programming Error: ComparatorChain must have one more arg than symbols";if(n.includes("=")&&!n.every(s=>s==="="))throw qx();this._difference=Pk(n,r)}isInequality(){return!this.symbols.includes("=")}};var rl=class extends Q{constructor(n){let r=n.map(s=>new we("\\\\idref_{"+s+"}"));super(r);this.constructedObjectIds=n;this._exports.push("construction")}};var Dp=class extends Q{};var sl=class extends Q{constructor(t,n){super(n),t instanceof we?this._symbol=t._symbol:this._symbol=new we(t)._symbol,this.addDependency(this._symbol)}};var Sp=class extends Q{};var Ms=class extends Q{registerDependencies(){if(super.registerDependencies(),this.args[1].type==="Identifier"){let t=this.args[1]._symbol;Ou(t)&&this.addDependency("trigAngleMultiplier")}}};var _u=class extends Q{};var vp=class extends Q{constructor(t){super(t),this._symbol="dotplot"}};var Vg=class extends Yt{constructor(t){super();let[n,r,s,i,o]=t;this.args=t,this._symbol=s._symbol,this._operators=[r,i],this._expressions=[n,o];let a=nl(Jr[r].inclusive&&Jr[t[3]].inclusive,Jr[t[1]].direction);this._indicator=new ps[a]([t[0],t[4]]),this.addDependency(this._symbol),this.mergeDependencies(this._expressions[0],this._expressions[1])}isInequality(){return!0}isShadeBetween(){return!0}};var Lu=class extends Q{};var il=class extends Q{constructor(t,n){super(n),this.seed=n[0],this.userSeed=n[1],this.tag=t}asValue(){return this.seed.asValue()+"::"+this.tag+this.userSeed.asValue()}};var wu=class extends Q{registerDependencies(){if(super.registerDependencies(),this.args[0].type==="Identifier"){let t=this.args[0]._symbol;Ou(t)&&this.addDependency("trigAngleMultiplier")}}};var Fu=class extends Q{registerDependencies(){if(this.addDependency("factorial"),super.registerDependencies(),this.args[0].type==="Identifier"){let t=this.args[0]._symbol;Ou(t)&&this.addDependency("trigAngleMultiplier")}}};var Op=class extends Q{constructor(t){super(t),this._symbol="histogram"}};var Bg=class extends Yt{constructor(n,r){super();this.isImage=!0;this.center=n.center,this.radianAngle=n.radianAngle,this.width=n.width,this.height=n.height,this.opacity=n.opacity,this.moveStrategy=r,this.mergeDependencies(this.center,this.radianAngle,this.width,this.height,this.opacity)}};var Np=class extends Q{constructor(t){super(t),this._symbol="ittest"}};var Rp=class extends Q{constructor(t){super(t,{skipRegisterDependencies:!0}),this._differential=t[0],this.registerDependencies()}registerDependencies(){for(let t=1;t<=3;t++)this.mergeDependenciesInScope(this.type,[this._differential._symbol],this.args[t])}};function hn(e,t){let n=e.getInstruction(t);switch(n.type){case 1:return Vo(n.value);default:throw new Error(`Unexpected opcode ${n.type}.`)}}function Vo(e){if(Array.isArray(e))return e.map(Vo);switch(typeof e){case"boolean":case"number":case"string":return e;case"object":if(gu(e)){let t={};for(let n of We(e.updateRules)){let r=e.updateRules[n];t[n]={value:Vo(r.value),valueType:r.valueType}}return{type:"Action",updateRules:t}}else return V(e);default:throw new Error("Unexpected value: "+e)}}function ge(e){return e.type<=4}function tO(e){return!ge(e)}function es(e){switch(e.type){case 21:case 23:case 19:case 50:case 53:return!0;default:return!1}}function ds(e){switch(e.type){case 20:case 22:case 24:case 51:case 54:return!0;default:return!1}}function Gg(e){switch(e.type){case 20:case 22:case 24:case 51:return!0;default:return!1}}function Vr(e,t){let n=new Array(t);for(let s=0;s<t;s++)n[s]=!1;n[t]=!0;let r=t;for(;r>0;){r=0;for(let s=t;s>=0;s--){if(!n[s])continue;let i=e.getInstruction(s);if(!ge(i))for(let o of e.getDirectDependencies(i))o>s&&!n[o]&&o>r&&(r=o),n[o]=!0}}return n}function nO(e,t){let n=new Array(t);for(let s=0;s<t;s++)n[s]=!1;n[t]=!0;let r=t;for(;r>0;){r=0;for(let s=t;s>=0;s--){if(!n[s])continue;let i=e.getInstruction(s);if(!ge(i))if(i.type===33)n[i.args[1]]=!0,n[i.args[2]]=!0;else for(let o of e.getDirectDependencies(i))o>s&&!n[o]&&(r=o),n[o]=!0}}return n}function fs(e,t){var s;let n=[],r=[];for(let i=0;i<t;i++)r.push(!1);r.push(!0);for(let i=t;i>=0;i--){if(!r[i])continue;let o=e.getInstruction(i);if(o.type===2)n.push({symbol:e.argNames[i],scope:"free"});else if(es(o))switch(o.type){case 21:n.push({symbol:o.callData.indexSymbol,scope:"integral"});break;case 19:n.push({symbol:o.callData.indexSymbol,scope:o.callData.type});break;case 23:if(((s=o.context)==null?void 0:s.type)==="list-comprehension")for(let u of o.context.callData.inputListSymbols)n.push({symbol:u,scope:"comprehension"});break;case 50:for(let u of o.callData.parameterSymbols)n.push({symbol:u,scope:"map"});break;case 53:{let u=e.getInstruction(o.args[0]);for(let c of u.parameterSymbols)n.push({symbol:c,scope:"recursive-function"});break}default:let a=o;throw new Error(`Programming Error: unexpected loop instruction ${a.type}`)}else o.type===3&&o.symbol&&n.push({symbol:o.symbol,scope:"symbolic-var"});if(!ge(o))for(let a of e.getDirectDependencies(o))r[a]=!0}return n.reverse()}function Vu(e,t){return ol(e,[t],0,e.instructionsLength()-1)}function ol(e,t,n,r){let s=[];for(let o=n;o<=r;o++)s[o]=!1;for(let o of t)s[o]=!0;let i=Math.min(...t);for(let o=0;o<=1;o++){let a=!1;for(let u=i+1;u<e.instructionsLength();u++){let c=e.getInstruction(u);if(ge(c)||s[u])continue;let l=!1;for(let p of e.getDirectDependencies(c))if(s[p]){l=!0;break}if(s[u]=l,l&&c.type===20&&!s[c.args[0]]){let p=c.args[0],f=c.args.length-1;for(let d=0;d<f;d++){let y=c.args[1+d],g=p+1+d;s[y]&&(s[g]=!0,a=!0)}}}if(!a)break}return s}function rO(e){if(e.isConstant())return;let t=[];for(let i=0;i<e.getReturnIndex();i++)e.getInstruction(i).type===44&&t.push(i);if(t.length===0)return;let n=Vr(e,e.getReturnIndex()),r=[];for(let i=0;i<e.argNames.length;i++)n[i]&&r.push(i);let s=ol(e,r,0,e.getReturnIndex());for(let i of t)if(n[i]&&s[i])throw PP(fs(e,i))}function ms(e){if(!Bo(e))throw new Error("Programming error: expected an array but found "+typeof e)}function Bo(e){return Array.isArray(e)}function sO(e){if(Bo(e))for(let{compiled:t}of e)t&&f0(t)}function $Z(e){if(Bo(e))for(let{compiled:t}of e)t&&Mk(t)}function f0(e){delete e.fn}function Mk(e){e.fn=wf(e.args,e.source,e.constants,e.executionMetadata)}function wf(e,t,n,r){let i=`var fn = (function(${e.join(",")}){"use strict"; ${t}});\nfn.__meta = __meta;\nreturn fn;\n`;return new Function("BuiltIn","ErrorMsg","_C","__meta",i)(Gi,Ht,n,r)}function oO(e,t,n){let r="",s=(e.instructionsLength()-1).toString().length,i=0,o=!1,a=Vr(e,t);for(let u=0;u<e.instructionsLength();u++){let c=e.getInstruction(u),l=n.comments[u]||"";if(ds(c)&&(i-=1),!a[u]&&!n.printUnreferencedInstructions||c.type===0)o||(r+=`${iO(u,s)}: ${g0(2*i)}...\n`),o=!0;else{o=!1;let p=`${iO(u,s)}: ${g0(2*i)}${al(e,u)}`;l&&(p+=" ".repeat(Math.max(0,36-p.length)),p+=`	# ${l}`),r+=p+`\n`}es(c)&&(i+=1)}return r}function al(e,t){let n=e.getInstruction(t);switch(n.type){case 0:return ts(n.type);case 2:return`${ts(n.type)} ${at(n.valueType)} ${e.argNames[t]}`;case 3:return`${ts(n.type)} ${at(n.valueType)}`;case 1:return`${ts(n.type)} ${at(n.valueType)} ${y0(n.value)}`;case 37:case 42:return`${ts(n.type)} ${at(n.valueType)} ${n.symbol} ${n.args.join(" ")}`;case 44:return`${ts(n.type)} ${at(n.valueType)} ${n.tag} ${n.args.join(" ")}`;case 48:return`${ts(n.type)} ${at(n.valueType)} ${n.args.join(" ")}`;case 16:return`${ts(n.type)} ${at(n.valueType)} (${n.index}) ${n.args.join(" ")}`;case 50:return`${ts(n.type)} ${at(n.valueType)} ${n.args.join(" ")} (${n.callData.parameterSymbols.join(",")})`;case 4:{let s=n.signature.argTypes.map(i=>at(i)).join(", ");return`${ts(n.type)} ${at(n.valueType)} ${n.symbol}(${s}) [group ${n.recursionGroup.join(" ")}]`}case 8:case 9:case 10:case 11:case 13:case 12:case 14:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 32:case 31:case 33:case 38:case 39:case 40:case 41:case 47:case 49:case 51:case 53:case 54:case 55:case 15:return`${ts(n.type)} ${at(n.valueType)} ${n.args.join(" ")}`;default:let r=n;throw new Error(`Unexpected opcode ${r.type}`)}}function ts(e){switch(e){case 0:return"Noop";case 1:return"Constant";case 8:return"Add";case 9:return"Subtract";case 10:return"Multiply";case 11:return"Divide";case 12:return"Exponent";case 13:return"RawExponent";case 14:return"Negative";case 19:return"BeginLoop";case 20:return"EndLoop";case 21:return"BeginIntegral";case 22:return"EndIntegral";case 23:return"BeginBroadcast";case 24:return"EndBroadcast";case 25:return"Equal";case 26:return"Less";case 27:return"Greater";case 28:return"LessEqual";case 29:return"GreaterEqual";case 31:return"Or";case 32:return"And";case 33:return"Piecewise";case 38:return"List";case 39:return"ListAccess";case 40:return"DeferredListAccess";case 41:return"InboundsListAccess";case 37:return"NativeFunction";case 42:return"Distribution";case 2:return"LoadArg";case 47:return"BlockVar";case 48:return"BroadcastResult";case 3:return"SymbolicVar";case 44:return"ExtendSeed";case 49:return"Action";case 50:return"BeginMap";case 51:return"EndMap";case 4:return"FunctionHeader";case 53:return"BeginFunction";case 54:return"EndFunction";case 55:return"FunctionCall";case 15:return"Tuple";case 16:return"Slot";default:let t=e;throw new Error(`Unexpected opcode ${t.type}`)}}function y0(e){if(Array.isArray(e))return`[${e.map(y0).join(",")}]`;switch(typeof e){case"string":return e;case"boolean":case"number":return e.toString();case"object":if(gu(e)){let t=[];for(let n of We(e.updateRules))t.push(`"${n}": ${y0(e.updateRules[n].value)}`);return`{${t.join(", ")}}`}else return`${e.n}/${e.d}`;default:throw new Error("Unexpected value: "+e)}}function iO(e,t){let n=e.toString();return g0(t-n.length)+n}function g0(e){let t="";for(let n=0;n<e;n++)t+=" ";return t}function fn(e){return`_${e}`}function Ap(e){return`_${e}_thunk_computed`}function _p(e){return`_${e}_thunk_function`}function kg(e){return`_${e}_next`}function aO(e){return`_${e}_next1`}function h0(e,t){return`_${e}_${t}`}function b0(e){return`_${e}_inner`}function uO(e){return`_${e}_cache`}function cO(e){return`_${e}_key`}function Hg(e){return`_${e}_computationMetrics`}function lO(e){return`_${e}_out`}function pO(e){return`_${e}_computationMetrics`}function dO(e){return`_${e}_cacheEntry`}function fO(e){return`_${e}_args`}function Ff(e,t){return`_${e}_prev_${t}`}function mO(e){return`_${e}_computationDepth`}function yO(e){return`_${e}_computationCount`}function Je(e){return e.type===1}function gO(e){if(!Je(e))throw new Error(`Programming error: expected constant instruction but found ${ts(e.type)} instead.`)}var T0=class{constructor(t,n){this.chunk=t;this.recursiveFunctionGroup=n;this.referencesFrom={};this.referencesTo={};this.baseCases={};for(let c of Object.values(n))this.referencesFrom[c]=[],this.referencesTo[c]=[],this.baseCases[c]=[];let{dependsOnRecursiveCall:r,iterationParameterIndex:s,recursiveReferences:i}=vk(this.chunk,this.recursiveFunctionGroup);for(let c of i)this.referencesFrom[c.from].push(c),this.referencesTo[c.to].push(c);this.iterationParameterIndex=s;let{baseCases:o,isEveryBranchRecursiveOrBaseCase:a,isUnconditionallyRecursive:u}=Sk(t,n,r,s);this.isEveryBranchRecursiveOrBaseCase=a,this.isUnconditionallyRecursive=u;for(let c of o)this.baseCases[c.fn].push(c)}hasRecursiveReferences(){for(let t of Object.values(this.referencesFrom))if(t.length>0)return!0;return!1}getBaseCasesForFunction(t){return this.baseCases[t]}getReferencesFrom(t){return this.referencesFrom[t]}getReferencesTo(t){return this.referencesTo[t]}getAllReferences(){let t=[];for(let n of Object.values(this.referencesFrom))t.push(...n);return t}};function Dk(e,t,n){if(t===void 0)return;let r=e.getInstruction(n),s=e.getInstruction(r.args[0]);if(s.type!==25)return;let[i,o]=s.args,a;if(i===t)a=o;else if(o===t)a=i;else return;let u=e.getInstruction(a);if(Je(u)&&u.valueType===I)return u.value}function Sk(e,t,n,r){let s=[],i=!0,o=!0;for(let a in t){let u=t[a],l=e.getInstruction(u).endIndex,f=e.getInstruction(l).args[0],d=r!==void 0?f+r+1:void 0,y={[l]:!0};for(let g=l;g>f;g--){if(!y[g])continue;let m=e.getInstruction(g);if(!ge(m)){if(m.type===33){let h=m.args[1],x=m.args[2];if(!n[h]||!n[x]){i=!1;let b=Dk(e,d,g);b!==void 0&&!n[h]?s.push({fn:u,argValue:b}):o=!1}}for(let h of m.args)y[h]=!0}}}return s.sort((a,u)=>V(a.argValue)-V(u.argValue)),{baseCases:s,isUnconditionallyRecursive:i,isEveryBranchRecursiveOrBaseCase:o}}var x0=Symbol("NON_ITERATIVE");function vk(e,t){let n=new Set(Object.values(t)),r={},s=[],i;for(let o in t){let a=t[o],c=e.getInstruction(a).endIndex,p=e.getInstruction(c).args[0],f=Vr(e,c);for(let d=p;d<c;d++){let y=e.getInstruction(d);if(!ge(y)&&f[d]){if(y.type===55&&n.has(y.args[0])){r[d]=!0;let g=I0(e,p,y);g?(g.iterationParameterIndex!==void 0&&(i!==void 0&&i!==g.iterationParameterIndex?i=x0:i=g.iterationParameterIndex),s.push(g.ref)):i=x0}for(let g of e.getDirectDependencies(y))if(r[g]){r[d]=!0;break}}}}return i===void 0&&Object.values(t).every(o=>e.getInstruction(o).signature.argTypes.length===1)&&(i=0),{dependsOnRecursiveCall:r,iterationParameterIndex:i===x0?void 0:i,recursiveReferences:s}}function I0(e,t,n){let r=e.getInstruction(t),s,i;for(let o=1;o<n.args.length;o++){let a=n.args[o],u=e.getInstruction(a),c,l;if(u.type===9&&s===void 0){let d=e.getInstruction(u.args[1]);if(!(d.type===1&&d.valueType===I))return;l=V(d.value),c=u.args[0]}else l=0,c=a;let p=e.getInstruction(c);if(!(p.type===47&&p.args[0]===t&&o===c-t)||l!==Math.floor(l)||l<0)return;if(s===void 0)i=l,l!==0&&(s=o-1);else if(l!==0)return}if(i!==void 0)return{ref:{from:r.args[0],to:n.args[0],iterationParameterOffset:i},iterationParameterIndex:s}}function hO(e,t){var c,l;let n=new T0(e,t),r={};for(let p in n.recursiveFunctionGroup){let f=n.recursiveFunctionGroup[p],d=n.getBaseCasesForFunction(f);if(d.length===0)continue;let y=V(d[0].argValue),g=1;for(;g<d.length&&V(d[g].argValue)===V(d[g-1].argValue)+1;)g++;let m=d.slice(g).map(h=>V(h.argValue));r[p]={min:y,consecutiveCount:g,additional:m}}let s={},i=-1/0,o=1/0;if(n.iterationParameterIndex!==void 0&&n.isEveryBranchRecursiveOrBaseCase){let p=new Map;for(let f of Object.values(n.recursiveFunctionGroup)){let d=e.getInstruction(f).symbol,y=-1/0;for(let g of n.getReferencesTo(f))y=Math.max(y,g.iterationParameterOffset);if(isFinite(y)&&(s[d]=y),y>0){let g=r[e.getInstruction(f).symbol],m=(c=g==null?void 0:g.min)!=null?c:-1/0;p.set(f,{min:m+y,max:m+((l=g==null?void 0:g.consecutiveCount)!=null?l:0)})}}for(let{min:f,max:d}of p.values())i=Math.max(i,f),o=Math.min(o,d)}let a={};for(let p in n.recursiveFunctionGroup){let f=n.recursiveFunctionGroup[p],d=e.getInstruction(f);a[p]=d.parameterSymbols}let u={};for(let p in n.recursiveFunctionGroup){let f=n.recursiveFunctionGroup[p],d=e.getInstruction(f);u[p]=d.signature.argTypes.map((y,g)=>g===n.iterationParameterIndex&&n.isEveryBranchRecursiveOrBaseCase&&!n.isUnconditionallyRecursive?1:0)}if(n.iterationParameterIndex!==void 0&&isFinite(i)&&i<=o){let p=Ok(n);return{canIterate:!0,parameterSymbols:a,baseCaseInfo:r,maxRecursiveCallOffsets:s,iterationParameterIndex:n.iterationParameterIndex,domainInfo:u,loopStart:i,order:p}}else return{canIterate:!1,parameterSymbols:a,baseCaseInfo:r,maxRecursiveCallOffsets:s,iterationParameterIndex:n.iterationParameterIndex,domainInfo:u}}function Ok(e){if(e.iterationParameterIndex===void 0)throw U("Programming error: no recursive parameter");let n=Object.values(e.recursiveFunctionGroup),r=new Map,s=new Map,i=u=>{let c=new Set;for(let l of e.getReferencesTo(u))l.iterationParameterOffset===0&&c.add(l.from);return[...c]};n.forEach(u=>{let c=i(u);r.set(u,c);for(let l of c)s.set(l,(s.get(l)||0)+1);s.has(u)||s.set(u,0)});let o=[];s.forEach((u,c)=>{u===0&&o.push(c)});let a=[];for(;o.length>0;){let u=o.shift();a.push(u),(r.get(u)||[]).forEach(l=>{let p=l,f=s.get(p)-1;s.set(p,f),f===0&&o.push(p)})}if(a.length!==n.length)throw Nx();return a}function zg(e,t){let n;for(let o=t,a=0;o>0;o--){let u=e.getInstruction(o);if(u.type===53&&a===0){n=o;break}u.type===54&&a++,u.type===53&&a--}if(n===void 0)return!1;let r=e.getInstruction(t),s=e.getInstruction(r.args[0]),i=e.getInstruction(n).args[0];return s.recursionGroup.includes(i)}function Ug(e){for(let t=0;t<e.argCoeffs.length;t++)if(V(e.argCoeffs[t])!==0)return!1;return!0}var qg=Se(0,1),bO=Se(1,1);function $g(e){if(e.op==="&&")return{op:"||",values:e.values.map($g)};if(e.op==="||")return{op:"&&",values:e.values.map($g)};switch(e.condition){case">0":return{op:"comparator",value:Cs._neg(e.value),condition:">=0"};case">=0":return{op:"comparator",value:Cs._neg(e.value),condition:">0"};case"=0":return{op:"comparator",value:e.value,condition:"!=0"};case"!=0":return{op:"comparator",value:e.value,condition:"=0"}}}function P0(e,t){let n=[];return e.op==="&&"?n.push(...e.values):n.push(e),t.op==="&&"?n.push(...t.values):n.push(t),{op:"&&",values:n}}var Cs;(c=>{function e(l,p){if(!(l===void 0||p===void 0))return t(l,p)}c.add=e;function t(l,p){let f=[];for(let d=0;d<l.argCoeffs.length;d++)f.push(qs(l.argCoeffs[d],p.argCoeffs[d]));return{argCoeffs:f,constantCoeff:qs(l.constantCoeff,p.constantCoeff)}}c._add=t;function n(l,p){if(!(l===void 0||p===void 0))return r(l,p)}c.sub=n;function r(l,p){let f=[];for(let d=0;d<l.argCoeffs.length;d++)f.push(ai(l.argCoeffs[d],p.argCoeffs[d]));return{argCoeffs:f,constantCoeff:ai(l.constantCoeff,p.constantCoeff)}}c._sub=r;function s(l){if(l!==void 0)return i(l)}c.neg=s;function i(l){let p=[];for(let f=0;f<l.argCoeffs.length;f++)p.push(Us(l.argCoeffs[f]));return{argCoeffs:p,constantCoeff:Us(l.constantCoeff)}}c._neg=i;function o(l,p){if(l===void 0||p===void 0)return;let f=Ug(l),d=Ug(p);if(!f&&!d)return;d||([l,p]=[p,l]);let y=[];for(let g=0;g<l.argCoeffs.length;g++)y.push(wr(l.argCoeffs[g],p.constantCoeff));return{argCoeffs:y,constantCoeff:wr(l.constantCoeff,p.constantCoeff)}}c.mul=o;function a(l,p){if(l===void 0||p===void 0||!Ug(p))return;let d=[];for(let y=0;y<l.argCoeffs.length;y++)d.push(Ps(l.argCoeffs[y],p.constantCoeff));return{argCoeffs:d,constantCoeff:Ps(l.constantCoeff,p.constantCoeff)}}c.div=a;function u(l,p){if(!(l===void 0||p===void 0||!Ug(p)))return V(p.constantCoeff)===0?{argCoeffs:new Array(l.argCoeffs.length).fill(qg),constantCoeff:bO}:V(p.constantCoeff)===1?l:void 0}c.pow=u})(Cs||(Cs={}));var Yg=class{constructor(t,n,r,s){this.chunk=t;this.coefficientTable=[];this.conditionTable=[];this.ZERO_COEFFS=new Array(n.length).fill(qg),this.mask=ol(t,n,r,s);for(let i=0;i<n.length;i++){let o=[];for(let a=0;a<n.length;a++)o.push(i===a?bO:qg);this.coefficientTable[n[i]]={argCoeffs:o,constantCoeff:qg}}}coeffs(t){let n=this.coefficientTable[t];if(n!==void 0)return n;let r,s=this.chunk.getInstruction(t);return s.type===1&&s.valueType===I?r={argCoeffs:this.ZERO_COEFFS,constantCoeff:s.value}:this.mask[t]?r=this._coeffs(t):r=void 0,this.coefficientTable[t]=r,r}_coeffs(t){let n=this.chunk.getInstruction(t);switch(n.type){case 8:{let[s,i]=n.args;return Cs.add(this.coeffs(s),this.coeffs(i))}case 9:{let[s,i]=n.args;return Cs.sub(this.coeffs(s),this.coeffs(i))}case 14:{let s=n.args[0];return Cs.neg(this.coeffs(s))}case 10:{let[s,i]=n.args;return Cs.mul(this.coeffs(s),this.coeffs(i))}case 11:{let[s,i]=n.args;return Cs.div(this.coeffs(s),this.coeffs(i))}case 12:case 13:{let[s,i]=n.args;return Cs.pow(this.coeffs(s),this.coeffs(i))}case 26:case 28:case 27:case 29:case 33:case 0:case 23:case 2:case 1:case 25:case 32:case 31:case 15:case 16:case 38:case 39:case 40:case 41:case 37:case 42:case 21:case 22:case 19:case 20:case 24:case 48:case 47:case 3:case 44:case 49:case 50:case 51:case 4:case 53:case 54:case 55:return;default:let r=n;throw new Error(`Unexpected opcode ${r.type}`)}}condition(t){let n=this.conditionTable[t];if(n!==void 0)return n;let r;return this.mask[t]?r=this._condition(t):r=void 0,this.conditionTable[t]=r,r}_condition(t){let n=this.chunk.getInstruction(t);switch(n.type){case 26:{let[s,i]=n.args,o=Cs.sub(this.coeffs(i),this.coeffs(s));return o===void 0?void 0:{op:"comparator",value:o,condition:">0"}}case 28:{let[s,i]=n.args,o=Cs.sub(this.coeffs(i),this.coeffs(s));return o===void 0?void 0:{op:"comparator",value:o,condition:">=0"}}case 27:{let[s,i]=n.args,o=Cs.sub(this.coeffs(s),this.coeffs(i));return o===void 0?void 0:{op:"comparator",value:o,condition:">0"}}case 29:{let[s,i]=n.args,o=Cs.sub(this.coeffs(s),this.coeffs(i));return o===void 0?void 0:{op:"comparator",value:o,condition:">=0"}}case 25:{let[s,i]=n.args,o=Cs.sub(this.coeffs(s),this.coeffs(i));return o===void 0?void 0:{op:"comparator",value:o,condition:"=0"}}case 32:{let s=n.args.map(i=>this.condition(i));return s.some(i=>i===void 0)?void 0:{op:"&&",values:s}}case 31:{let s=n.args.map(i=>this.condition(i));return s.some(i=>i===void 0)?void 0:{op:"||",values:s}}case 8:case 9:case 14:case 10:case 11:case 12:case 13:case 33:case 0:case 23:case 2:case 1:case 15:case 16:case 38:case 39:case 40:case 41:case 37:case 42:case 21:case 22:case 19:case 20:case 24:case 48:case 47:case 3:case 44:case 49:case 50:case 51:case 4:case 53:case 54:case 55:return;default:let r=n;throw new Error(`Unexpected opcode ${r.type}`)}}};function TO(e,t,n,r){let s=t.reachConditions[n];if(s!==void 0)return IO(e,t,r,s)}function IO(e,t,n,r){let s=t.argBlockvars;if(r.op==="||"||r.op==="&&"){let i=[];for(let o of r.values){let a=IO(e,t,n,o);if(a===void 0)return;i.push(a)}return i.length===0?r.op==="&&"?"true":"false":`(${i.join(r.op)})`}switch(r.condition){case">0":case">=0":{let o=`(${xO(e,r.value,s)}${r.condition})`,a=E0(e,r.value,s,n);return`(${o}&&${a})`}case"!=0":{let i=xO(e,r.value,s),o=`(${i}>0)`,a=E0(e,r.value,s,n),u=`(${i}<0)`,c=E0(e,Cs._neg(r.value),s,n);return`((${o}&&${a})||(${u}&&${c}))`}case"=0":return}}function E0(e,t,n,r){let s=[];for(let i=0;i<n.length;i++){let o=V(t.argCoeffs[i]),a=e.referenceArg(n[i]),u=e.referenceArg(r[i]);o>0?s.push(`${u}>=${a}`):o<0&&s.push(`${u}<=${a}`)}return s.length===0?!0:`(${s.join("&&")})`}function xO(e,t,n){let r="";for(let s=0;s<n.length;s++){let i=e.printValue(t.argCoeffs[s],I),o=e.referenceArg(n[s]);r+=`${i}*${o}+`}return r+=e.printValue(t.constantCoeff,I),`(${r})`}var Jt;(r=>(r.Noop=0,r.Inline=1,r.Block=2))(Jt||(Jt={}));function M0(e){switch(e.type){case Jt.Noop:return"";case Jt.Inline:return e.source+`;\n`;case Jt.Block:return e.source}}function PO(e,t,n){if(e.glsl)throw U("GLSL function not implemented");let{chunk:r,referenced:s}=e,i=t.args[0],o=r.getInstruction(i),a=o.signature.argTypes;if(e.isTailFunction[i])return{type:Jt.Noop,nextIdx:o.endIndex+1};e.enterFunction(t,n,0);let u="";for(let c=0;c<a.length;c++){let l=n+c+1;s[l]&&(u+=`${fn(l)}=${h0(i,c)};\n`)}return{type:Jt.Block,source:Nk(e,t,n,u),nextIdx:n+1}}function Nk(e,t,n,r){let{chunk:s}=e,i=t.args[0],o=s.getInstruction(i),a=o.signature.argTypes,u="";for(let d=0;d<a.length;d++)d>0&&(u+=","),u+=h0(i,d);let c=b0(i),l=uO(i),p=cO(i),f=Hg(i);return`\n    const ${p}=${a.length===1&&o.signature.argTypes[0]===I?"({fn, args}) => `${fn}:${args[0]}`":"({fn, args}) => `${fn}:${JSON.stringify(args)}`"};\n\n    const ${c}=((${l}, ${u}) => {\n      ${Lp(e,n+1,o.endIndex-1)}\n      const ${f} = {depth: 0, count: 0};\n      const cache = ${l};\n      ${r}\n    `}function EO(e,t,n){let r=n+1,s=t.args[0],o=e.chunk.getInstruction(s).args[0];if(e.isTailFunction[o])throw U("Unexpected tail recursive function");let a=Rk(e,t),{referenced:u}=e;return u[n]&&(a+=`${fn(n)}=${e.referenceArg(t.args[0])};\n`),e.exitFunction(),{type:Jt.Block,source:a,nextIdx:r}}function Rk(e,t){let n=t.args[0],r=e.chunk.getInstruction(n),s=r.args[0],i=lO(s),o=Hg(s),a=r.valueType;return`\n${o}.count++;\n${o}.depth++;\nlet ${i};\nif ((${o}.depth > BuiltIn.RECURSIVE_DEPTH_LIMIT) || (${o}.count > BuiltIn.RECURSIVE_COMPUTATION_LIMIT)) {\n  ${i}=BuiltIn.handleRecursionLimitExceeded(__meta, ${a});\n} else {\n  ${i}=${e.referenceArg(t.args[1])};\n}\nreturn BuiltIn.recursionSuccess(${i},${o});\n});\n`}function Vf(e,t){return`{ fn: ${e}, args: ${t} }`}function MO(e,t,n){let r=n+1,{chunk:s}=e,i=t.args[0],o=s.getInstruction(i),u=s.getInstruction(o.endIndex).args[0],c=t.args.slice(1).map(m=>e.referenceArg(m)),l=fn(n),p=fO(n),f=pO(n),d=dO(n),y=s.getInstruction(u),g=s.getInstruction(y.args[0]);if(zg(s,n)){if(e.recursiveFunctionInfo.length<1)throw U("Expected recursive function info");let m=e.recursiveFunctionInfo[e.recursiveFunctionInfo.length-1],h="",x=TO(e,m,n,t.args.slice(1));if(e.isTailFunction[i]){let P=y.valueType;x&&(h=`\nif (${x}) {\n            return BuiltIn.recursionDiverges(__meta, ${P});\n          }`);let D=g.signature.argTypes,S=h+`\n`;S+="looping=true";for(let O=0;O<D.length;O++){let _=kg(u+O+1);S+=`,\n${_}=${c[O]}`}return h?{type:Jt.Block,source:S+`;\n`,nextIdx:r}:{type:Jt.Inline,source:S,nextIdx:r}}else if(m.executionMode===1){let P=s.getInstruction(s.getInstruction(m.fn).endIndex),D=I0(s,P.args[0],t);if(!D)throw U("Expected valid iteration reference");let S=Ff(D.ref.to,D.ref.iterationParameterOffset);return{type:Jt.Inline,source:`${l}=${S}`,nextIdx:r}}x&&(h=`\nif (${x}) {\n          return BuiltIn.SYMBOL_DIVERGES;\n        }`);let T=Hg(m.fn),b=Vf(i,p),M=`\n      const ${p} = ([${c.join(",")}]);\n      ${h}\n      const ${d} = cache.get(BuiltIn.recursionCacheKey(${b}));\n      if (${d} === undefined) {\n        return BuiltIn.recursionMissingCacheEntry(${b});\n      }\n      ${l} = ${d}[0];\n      const ${f} = ${d}[1];\n      if (${f}.count > ${T}.count) {\n        ${T}.count = ${f}.count;\n      }\n      if (${f}.depth > ${T}.depth) {\n        ${T}.depth = ${f}.depth;\n      }\n    `;return{type:Jt.Block,source:M,nextIdx:r}}else{let m=`{${g.recursionGroup.map(b=>`${b}: ${b0(b)}`).join(",")}}`,h=e.chunk.getRecursionStructure(y.args[0]);if(e.isTailFunction[i])return Ak(e,t,n);if(h.canIterate)return _k(e,t,n,h,{innerFunctionsMap:m});let x=Vf(i,`[${c.join(",")}]`),T=`${l}=BuiltIn.executeRecursiveFunction(\n      __meta,\n      ${m},\n      ${y.valueType},\n      ${x}\n    )`;return{type:Jt.Inline,source:T,nextIdx:r}}}var CO=Symbol("UPDATED_IN_BODY");function DO(e){let t="";for(let n of e){let r="declare"in n?`let ${n.declare}`:fn(n.reference),s=n.initializeRHS;t+=`${r}=${s};\n`}return t}function SO(e){let t="",n="";for(let r of e){let s="declare"in r?r.declare:fn(r.reference);r.updateRHS!==CO&&(t&&(t+=",",n+=","),t+=`${s}`,n+=`${r.updateRHS}`)}return`[${t}]=[${n}]`}function Ak(e,t,n){let r=t.args[0],s=e.chunk.getInstruction(r),i=e.chunk.getInstruction(s.endIndex),o=i.args[0],a=e.chunk.getInstruction(o),u=a.valueType,c=fn(n),l=[];e.enterFunction(a,o,2);let p=Xg(e,o,s.endIndex).source;e.exitFunction();let f=mO(n),d=yO(n);l.push({declare:f,initializeRHS:"0",updateRHS:`${f}+1`},{declare:d,initializeRHS:"0",updateRHS:`${d}+1`});for(let g=1;g<t.args.length;g++){let m=o+g;if(!e.referenced[m])continue;let h=kg(m);l.push({reference:m,initializeRHS:e.referenceArg(t.args[g]),updateRHS:h},{declare:h,initializeRHS:void 0,updateRHS:CO})}let y=`${c}=(() => {\n    ${Lp(e,o+1,s.endIndex-1)}\n\n    let looping = true;\n    ${DO(l)}\n    while (looping) {\n      looping = false;\n\n      ${p}\n\n      if (looping) {\n        ${SO(l)}\n      }\n\n      if ((${f} > BuiltIn.RECURSIVE_DEPTH_LIMIT) || (${d} > BuiltIn.RECURSIVE_COMPUTATION_LIMIT)) {\n        return BuiltIn.handleRecursionLimitExceeded(__meta, ${u});\n      };\n    }\n\n    return ${e.referenceArg(i.args[1])}\n  })()`;return{type:Jt.Inline,source:y,nextIdx:n+1}}function _k(e,t,n,r,s){let i=t.args[0],o=e.chunk.getInstruction(i),a=e.chunk.getInstruction(o.endIndex),u=a.args[0],c=fn(n),l=[],p="",f,{iterationParameterIndex:d,loopStart:y,order:g}=r,m=r.maxRecursiveCallOffsets,h=u+d+1,x=fn(h),T=t.args[d+1],b=`(${y})`,M=e.chunk.getInstruction(T),P=(M.type===39||M.type===41)&&e.chunk.getInstruction(M.args[1]).type===23?M.args[0]:void 0,D=`(${e.referenceArg(T)})-${b}`,S,O;if(P!==void 0){let G=e.referenceArg(P);S=`BuiltIn.listMax(\n      (${G}).filter(\n        x => isFinite(x) &&\n        Math.floor(x - ${b}) === (x - ${b})\n      )\n    )`,O=`BuiltIn.getBroadcastTargetElements(${G}).has(${x})`}else S=`(${e.referenceArg(T)})`,O="false";l.push({reference:h,initializeRHS:`(${b})`,updateRHS:`${x}+1`}),f="";for(let G of g){let k=e.chunk.getInstruction(G),Z=k.endIndex,F=e.chunk.getInstruction(Z),Y=F.args[0],re=e.chunk.getInstruction(Y);for(let he=1;he<t.args.length;he++){let K=Y+he;if(!e.referenced[K])continue;let Oe=fn(K);he===d+1?f+=`${Oe}=${e.referenceArg(h)};\n`:p+=`${Oe}=${e.referenceArg(t.args[he])};\n`}p+=Lp(e,Y+1,k.endIndex-1);let Ee=m[k.symbol];if(Ee!==void 0)for(let he=1;he<=Ee;he++){let K=Ff(G,he),Oe=he===1?e.referenceArg(F.args[1]):Ff(G,he-1),te=t.args.slice(1).map((J,W)=>W===d?y-he:e.referenceArg(J)),Ze=Vf(G,`[${te.join(",")}]`),dt=`BuiltIn.executeRecursiveFunction(\n            __meta,\n            ${s.innerFunctionsMap},\n            ${re.valueType},\n            ${Ze}\n          )`,me=`(\n          broadcastOutputMap\n            ? (broadcastOutputMap[BuiltIn.recursionCacheKey(${Ze})] = ${dt})\n            : ${dt}\n        )`;l.push({declare:K,initializeRHS:me,updateRHS:Oe})}e.enterFunction(re,Y,1),f+=Xg(e,Y,k.endIndex).source,e.exitFunction(),f+=`const ${Ff(G,0)}=${e.referenceArg(F.args[1])};\n`}let _=t.args.slice(1).map(G=>e.referenceArg(G)),L=t.args.slice(1).map((G,k)=>k===d?x:e.referenceArg(G)),w=`${c}=(() => {\n    ${p}\n    const broadcastOutputMap = ${P!==void 0?"__meta.iterativeRecursionOutputs":"undefined"};\n\n    ${DO(l)}\n\n    const outerStackFrame = ${Vf(i,`[${_.join(",")}]`)};\n\n    if (broadcastOutputMap) {\n        const cacheEntry = broadcastOutputMap[BuiltIn.recursionCacheKey(outerStackFrame)];\n        if (cacheEntry !== undefined) {\n          return cacheEntry;\n        }\n      }\n\n\n    const targetLoopSteps = ${D}\n    if (targetLoopSteps < 0 || Math.floor(targetLoopSteps) !== targetLoopSteps) {\n      return BuiltIn.executeRecursiveFunction(\n        __meta,\n        ${s.innerFunctionsMap},\n        ${o.valueType},\n        outerStackFrame\n      );\n    }\n\n    const loopEnd = ${S};\n\n    let result;\n    while (true) {\n      ${f}\n\n      result = ${e.referenceArg(a.args[1])};\n\n      if (broadcastOutputMap && ${O}) {\n        const key = BuiltIn.recursionCacheKey(${Vf(i,`[${L.join(",")}]`)});\n        broadcastOutputMap[key] = result;\n      }\n\n      if (${x} < loopEnd) {\n        ${SO(l)}\n      } else {\n        break;\n      }\n    }\n\n    ${P===void 0?"return result;":`const cached = broadcastOutputMap[BuiltIn.recursionCacheKey(outerStackFrame)];\n          if (cached === undefined) {\n            return BuiltIn.recursionDiverges(__meta, ${o.valueType});\n          }\n          return cached;\n          `}\n  })()`;return{type:Jt.Inline,source:w,nextIdx:n+1}}function Zg(e){let{chunk:t}=e,n=Lp(e,t.argNames.length,t.instructionsLength()-1),r=0;for(;r<t.instructionsLength();){let s=t.getInstruction(r),i=C0(e,s,r);n+=M0(i),r=i.nextIdx}return n+=`return ${e.referenceArg(t.getReturnIndex())};`,n}function Lk(e,t){let{chunk:n}=e,r=[],s=e.thunkName(t),i=e.thunkEnd(s),o=Ap(s),a=_p(s),u="",c=!1,l=!1;e.wantToInlineThunk(s)||(l=!0);let p=t;for(;p<=i;){let f=n.getInstruction(p),d=p===t?vO(e,f,p):C0(e,f,p);switch(d.type){case Jt.Noop:break;case Jt.Inline:c&&(u+=`,\n`),u+=d.source,c=!0;break;case Jt.Block:c&&(u+=`;\n`),c=!1,u+=d.source,l=!0;break}r.push(u),p=d.nextIdx}if(u===""&&(u="0",l=!1),l){let f=`${o}=false;${a}=()=>{\n${o}=true;\n\n      ${u}${c?";":""}\n    };\n`;return{type:Jt.Block,source:f,nextIdx:p}}else return e.inlineThunk(s,u),{type:Jt.Noop,nextIdx:p}}function C0(e,t,n){return e.isThunkBegin(n)?Lk(e,n):vO(e,t,n)}function vO(e,t,n){let r=n+1;if(!e.referenced[n])return{type:Jt.Noop,nextIdx:r};switch(t.type){case 0:case 47:case 48:case 22:case 49:case 4:return{type:Jt.Noop,nextIdx:r};case 21:if(e.glsl)throw FT();return Fk(e,t,n);case 2:return e.inlineSource(n,e.chunk.argNames[n]),{type:Jt.Noop,nextIdx:r};case 23:return{type:Jt.Block,source:Vk(e,t,n),nextIdx:r};case 24:return{type:Jt.Block,source:Bk(e,t,n),nextIdx:r};case 19:return{type:Jt.Block,source:Gk(e,t,n),nextIdx:r};case 20:return{type:Jt.Block,source:kk(e,t,n),nextIdx:r};case 50:return{type:Jt.Block,source:Hk(e,t,n),nextIdx:r};case 51:return{type:Jt.Block,source:zk(e,t,n),nextIdx:r};case 53:return PO(e,t,n);case 54:return EO(e,t,n);case 33:{let s=e.referenceArg(t.args[0]),i=e.referencePiecewiseBranch(t.args[1]),o=e.referencePiecewiseBranch(t.args[2]);if(!(i.thunkDependencies.some(p=>e.isEarlyReturningThunk(p))||o.thunkDependencies.some(p=>e.isEarlyReturningThunk(p)))){let p=e.emitTernary(s,i.expression,o.expression,t);return e.shouldInline(n)?(e.inlineSource(n,`(${p})`),{type:Jt.Noop,nextIdx:r}):{type:Jt.Inline,source:`${fn(n)}=${p}`,nextIdx:r}}let u=fn(n),c=p=>{if(p.length===0)return"";let f="";for(let d of p){let y=e.inlinedThunks[d];if(y!==void 0){let g=`(${y},void 0)`;f!==""?f=`(${f}||${g})`:f=g}else{let g=Ap(d),m=_p(d);f!==""&&(f+="||"),f+=`(${g} ? undefined : ${m}())`}}return f="const earlyReturn ="+f,f+=`;\nif (earlyReturn !== undefined) return earlyReturn;\n`,f},l=`if (${s}) {\n          ${c(i.thunkDependencies)}${u} = ${i.rawExpression};\n        } else {\n          ${c(o.thunkDependencies)}${u} = ${o.rawExpression};\n        }`;return{type:Jt.Block,source:l,nextIdx:r}}case 55:return MO(e,t,n);default:{let s=Uk(e,t,n);return e.shouldInline(n)?(e.inlineSource(n,`(${s})`),{type:Jt.Noop,nextIdx:r}):{type:Jt.Inline,source:`${fn(n)}=${s}`,nextIdx:r}}}}function Xg(e,t,n){let{chunk:r,referenced:s}=e,i="",o=t+1;for(;o<n;){if(!s[o]){o=o+1;continue}let a=r.getInstruction(o),u=C0(e,a,o);i+=M0(u),o=u.nextIdx}return{type:Jt.Block,source:i,nextIdx:o}}function wk(e,t,n){let{endIndex:r}=t,{chunk:s}=e,i=`function(${fn(n)}) {\n`,o=n+1,a=r-1;i+=Lp(e,o,a),i+=Xg(e,n,r).source;let u=s.getInstruction(r);return i+=`return ${e.referenceArg(u.args[1])};\n}`,i}function Fk(e,t,n){let r="BuiltIn.quad(";r+=wk(e,t,n),r+=`,${e.referenceArg(t.args[0])},${e.referenceArg(t.args[1])})`;let{endIndex:s}=t,i=s+1;return e.shouldInline(i)?(e.inlineSource(i,r),{type:Jt.Noop,nextIdx:t.endIndex}):{type:Jt.Inline,source:`${fn(s+1)}=${r}`,nextIdx:t.endIndex}}function Lp(e,t,n){let{chunk:r,referenced:s}=e,i="",o=!1;for(let a=t;a<=n;a++){if(!e.glsl&&e.isThunkBegin(a)){let c=e.thunkName(a);i+=`${o?",":"var "}${Ap(c)}`,i+=`,${_p(c)}`,o=!0}let u=r.getInstruction(a);if(!(u.type===0||u.type===24||u.type===20||!s[a])){if(u.type===21){let{endIndex:c}=u;a=c,e.shouldInline(c+1)&&a++;continue}if(!e.shouldInline(a)&&(i+=e.emitVarDeclaration(a,o),o=!0,u.type===53)){let{endIndex:c}=u;a=c-1;continue}}}return o&&(i+=`;\n`),i}function Vk(e,t,n){let{glsl:r,chunk:s,referenced:i}=e,o=fn(n),a=s.getInstruction(t.endIndex),u=e.referenceArg(t.args[0]),c="";for(let p=1;p<a.args.length;p++){let f=t.endIndex+p;if(!i[f]||s.getInstruction(f).type!==48)continue;let y=fn(f);r||(c+=`${y}=[];\n`)}return r||(c+=`if(${u}>${1e4}) throw ErrorMsg.maxListSize();\n`),c+=`for(${o}=1${r?".0":""};${o}<=${u};${o}++){\n`,c}function Bk(e,t,n){let{glsl:r,chunk:s,referenced:i}=e,o="";for(let a=1;a<t.args.length;a++){let u=n+a;if(u>=s.instructionsLength()||!i[u]||s.getInstruction(u).type!==48)continue;let c=fn(n+a),l=e.referenceArg(t.args[a]);if(r){let p=e.referenceArg(t.args[0]);o+=`${c}[int(${p})-1]=${l};\n`}else o+=`${c}.push(${l});\n`}return o+=`}\n`,o}function Gk(e,t,n){let{chunk:r,referenced:s}=e,i=fn(n);e.beforeBeginLoop(t);let o=`${e.referenceArg(t.args[0])}`,a=`${e.referenceArg(t.args[1])}`,u=`if(${o}>${a}){\n`;for(let c=2;c<t.args.length;c++){let l=t.endIndex+c-1;if(l>=r.instructionsLength()||!s[l]||r.getInstruction(l).type!==47)continue;let p=fn(l);u+=`${p}=${e.referenceArg(t.args[c])};\n`}u+=e.checkFiniteBounds(t,o,a),u+=`}else{\n`;for(let c=2;c<t.args.length;c++){let l=n+c-1;if(!s[l]||r.getInstruction(l).type!==47)continue;let p=fn(l);u+=`${p}=${e.referenceArg(t.args[c])};\n`}return u+=`${i}=${o};\n`,u+="while (true) {",u}function kk(e,t,n){let{chunk:r,referenced:s}=e,i=r.getInstruction(t.args[0]),o=`${e.referenceArg(i.args[1])}`,a=fn(t.args[0]),u=`${a}++;`;u+=`if (${a}<=${o}) {\n`;let c=new Map,l=[];for(let p=1;p<t.args.length;p++){let f=t.args[0]+p;if(!s[f]||r.getInstruction(f).type!==47)continue;let d=t.args[p];c.set(f,e.referenceArg(d)),l[d]=e.isDirectlyReferencedByName(d)}for(let[p,f]of c.entries())if(l[p]){let d=aO(p);u+=e.emitImmediateAssignment(p,d,f),c.set(p,d)}for(let[p,f]of c.entries())u+=`${fn(p)}=${f};\n`;u+=`} else {\n`;for(let p=1;p<t.args.length;p++){let f=n+p;if(f>=r.instructionsLength()||!s[f]||r.getInstruction(f).type!==47)continue;let d=fn(f);u+=`${d}=${e.referenceArg(t.args[p])};\n`}return u+=`break;\n`,u+=`}\n}\n`,u+=`}\n`,u}function Hk(e,t,n){let{glsl:r}=e;if(r)throw U("GLSL map not implemented yet");let s=fn(t.endIndex+1),i=[];for(let a=0;a<t.callData.parameterSymbols.length;a++){let u=fn(n+a+1);i.push(u)}let o=i.join(",");return`${s}=(${o}) => {\n`}function zk(e,t,n){let r=`return ${e.referenceArg(t.args[1])}`;return r+=`}\n`,r}function Uk(e,t,n){switch(t.type){case 1:return e.emitConstant(t);case 8:case 9:case 10:case 11:case 12:case 13:case 25:case 26:case 27:case 28:case 29:case 31:case 32:return e.emitBinary(t,e.referenceArg(t.args[0]),e.referenceArg(t.args[1]));case 14:{let s=e.referenceArg(t.args[0]);return e.emitNeg(s)}case 15:{let s=t.valueType;switch(s){case N:case R:return e.emitVec2(e.referenceArg(t.args[0]),e.referenceArg(t.args[1]));case z:return e.emitVec3(e.referenceArg(t.args[0]),e.referenceArg(t.args[1]),e.referenceArg(t.args[2]));default:let i=s;throw new Error(`Unexpected tuple type ${i}`)}}case 16:{let s=e.chunk.getInstruction(t.args[0]).valueType;switch(s){case N:case z:case R:return e.emitVecAccess(e.referenceArg(t.args[0]),t.index);default:let i=s;throw new Error(`Unexpected tuple type ${i}`)}}case 38:return e.emitList(t.args.map(s=>e.referenceArg(s)),t);case 40:case 42:case 3:throw new Error(`Programming Error: expect ${ts(t.type)} to be removed before emitting code.`);case 39:{let s=t.valueType;return e.emitListAccess(e.referenceArg(t.args[0]),e.referenceArg(t.args[1]),e.printValue(ls(s),s),t)}case 41:return e.emitInboundsListAccess(e.referenceArg(t.args[0]),e.referenceArg(t.args[1]));case 37:{let s=t.args.map(i=>e.referenceArg(i));return!e.glsl&&(n===e.chunk.getReturnIndex()&&t.symbol==="coerceComplexToReal"||t.symbol==="peelableCoerceComplexToReal")?`BuiltIn.peelableCoerceComplexToReal(${s.join(",")},__meta)`:e.emitNativeFunction(s,t)}case 44:return e.emitExtendSeed(e.referenceArg(t.args[0]),e.chunk.getInstruction(t.args[1]).valueType,e.referenceArg(t.args[1]),t.tag);case 2:case 0:case 21:case 22:case 19:case 20:case 23:case 24:case 47:case 48:case 49:case 50:case 51:case 53:case 54:case 33:case 55:case 4:throw new Error(`Unexpected opcode ${t.type}`);default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function OO(e,t,n,r){let s=e.getInstruction(n.args[0]);if(s.recursionGroup.length>1)return[];let i=s.endIndex,o=e.getInstruction(i),a=new Yg(e,r,t,i),u=[];for(let l=1;l<o.args.length;l++)u[o.args[l]]={op:"&&",values:[]};for(let l=i-1;l>t;l--){let p=u[l];if(p===void 0)continue;let f=e.getInstruction(l);if(!ge(f))if(f.type===33){u[f.args[0]]=p;let d=a.condition(f.args[0]);d!==void 0&&(u[f.args[1]]=P0(p,d),u[f.args[2]]=P0(p,$g(d)))}else for(let d of f.args)u[d]=p}let c=[];e:for(let l=i-1;l>=t;l--){let p=e.getInstruction(l);if(p.type!==55)continue;let f=e.getInstruction(p.args[0]);if(l>f.endIndex)continue;let d=p.args.slice(1);if(d.length!==f.signature.argTypes.length)throw new Error("Programming error: Non-matching arg length");let y=u[l];if(y!==void 0){if(y.op==="&&"&&y.values.length===0)throw new Error("Programming error: Recursive call unconditionally executed");for(let g=0;g<d.length;g++){if(e.getInstruction(d[g]).valueType!==I)continue e;let m=a.coeffs(d[g]);if(m===void 0||!qk(m,g)||V(m.argCoeffs[g])<-1)continue e}c[l]=y}}return c}function qk(e,t){for(let n=0;n<e.argCoeffs.length;n++)if(n!==t&&V(e.argCoeffs[n])!==0)return!1;return!0}function NO(e,t){let n=e.getReturnIndex(),r=new Array(n),s=new Array(n).fill(!1);for(let o=0;o<=n;o++){let a=e.getInstruction(o);es(a)||ds(a)||a.type===48||a.type===47&&e.getInstruction(a.args[0]).type!==22||a.type===0||a.type===55?r[o]=2:r[o]=0}r[n]===0&&(r[n]=1,s[n]=!0);let i=0;for(let o=n;o>=0;o--){if(!t[o])continue;let a=e.getInstruction(o);if(a.type===54?i++:a.type===53&&i--,ge(a))continue;if(a.type===19||a.type===20||a.type===24||a.type===54||a.type===39||a.type===55)for(let c of a.args){let l=e.getInstruction(c);r[c]===0&&l.type===1&&l.valueType===I?(r[c]=1,s[c]=!0):(r[c]=2,s[c]=!1)}else{for(let c of a.args)switch(r[c]){case 0:r[c]=1,s[c]=!0;break;case 1:case 2:r[c]=2,s[c]=!1;break}i>0&&a.type===33&&(r[o]=2,s[o]=!1)}}return s}function RO(e,t){if(t.recursionGroup.length>1)return!1;let n=t.endIndex,r=e.getInstruction(n);if(r.type!==54)throw new Error("Programming Error: end of BeginFunction is not EndFunction");let[s,...i]=r.args;if(i.length!==1)return!1;let o=e.getInstruction(s);if(o.type!==53)throw new Error("Programming Error: start of EndFunction is not BeginFunction");let a=o.args[0],u={};u[i[0]]=!0;for(let c=n-1;c>=s;c--){let l=e.getInstruction(c);switch(l.type){case 55:if(!u[c])return!1;if(l.args[0]!==a)throw new Error("recursionGroup.length == 1 contradicted");break;case 33:u[c]&&(u[l.args[1]]=!0,u[l.args[2]]=!0);break;default:break}}return!0}function $k(e,t){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}var Wg=class{constructor(t,n,r){this.chunk=t;this.referenced=n;this.shouldInline=r;this.thunkSets=[];this.thunkStarts=[];this.thunkEnds=[];this._isThunkEnd=[];this.piecewiseReferencedCount=[];this.dependencyThunkNames=[];this.parentFunctionStart=[];let s=t.getReturnIndex();for(let a=0;a<=t.instructionsLength();a++)this.thunkSets[a]=new Set;let i=t.argNames.length,o=[];for(let a=i;a<=t.getReturnIndex();a++){let u=t.getInstruction(a);this.parentFunctionStart[a]=o[o.length-1],u.type===53?o.push(a):u.type===54&&o.pop()}this.markThunkSets(i,s,[s],"always"),this.markThunks(i,s)}isThunkBegin(t){return this.thunkStarts[t]===t}isThunkEnd(t){return!!this._isThunkEnd[t]}containingThunkName(t){return this.thunkStarts[t]}thunkEnd(t){return this.thunkEnds[t]}isEarlyReturningThunk(t){let n=this.parentFunctionStart[t];return this.isThunkBegin(t)&&n!==void 0}dependencyThunkNamesForPiecewiseBranch(t){return this.dependencyThunkNames[t]}wantToInlineThunk(t){let n=this.thunkSets[t];if(n!=="always"&&n.size===1){for(let r of n)if(this.piecewiseReferencedCount[r]!==1)return!1;return!0}return!1}printChunkWithThunkInfo(){for(let t=0;t<=this.chunk.getReturnIndex();t++){let n=this.thunkSets[t],r=n==="always"?"always":`{${[...n].sort().join(",")}}`;if(this.isThunkBegin(t)&&(r+=" beginThunk"),this.isThunkEnd(t))r+=" endThunk";else{let s=this.containingThunkName(t);s!==void 0&&(r+=` start:${s}`)}this.shouldInline[t]&&(r+="	[inline]"),this.chunk.comments[t]=r}return this.chunk.print(this.chunk.getReturnIndex())}markThunkSets(t,n,r,s){let{chunk:i,referenced:o,thunkSets:a,piecewiseReferencedCount:u}=this;for(let l of r)a[l]="always";function c(l,p){let f=a[l];if(f!=="always"){if(p==="always"){a[l]=p;return}for(let d of p)f.add(d)}}for(let l=n;l>=t;l--){if(!o[l])continue;let p=i.getInstruction(l);if(ge(p))continue;let f=a[l];if(ds(p)){let d=p.args[0];this.markThunkSets(d+1,l-1,p.args.slice(1),f),l=d+1;continue}for(let d=0;d<p.args.length;d++){let y=p.args[d];if(y<t)c(y,s);else if(d>0&&p.type===33){let g=a[y];g!=="always"&&g.add(y);let m=u[y];u[y]=(m!=null?m:0)+1}else c(y,f)}}}markThunks(t,n){var a,u;let{chunk:r,thunkSets:s}=this,i,o;for(let c=t;c<=n;c=o){let l=r.getInstruction(c),p=Yk(this.chunk,l),f,d;if(p){let y=c+1,g=p.innerEndIndex-1;this.markThunks(y,g),d=s[p.innerEndIndex],o=p.outerEndIndex+1,f=this.thunkDecision(i,c,this.referenced[p.innerEndIndex],l.type===21&&this.shouldInline[p.outerEndIndex],d)}else d=s[c],o=c+1,f=this.thunkDecision(i,c,this.referenced[c],this.shouldInline[c],d);if(i!==void 0&&f.shouldEndThunk&&(this.markEndThunk(c-1,i),i=void 0),f.shouldStartThunk&&d!=="always"){for(let y of d)(u=(a=this.dependencyThunkNames)[y])!=null||(a[y]=[]),this.dependencyThunkNames[y].push(c);i={start:c,set:d}}if(i!==void 0&&(this.thunkStarts[c]=i.start,p))for(let y=p.innerEndIndex;y<=p.outerEndIndex;y++)this.thunkStarts[y]=i.start}i!==void 0&&this.markEndThunk(n,i)}thunkDecision(t,n,r,s,i){let o=this.chunk.getInstruction(n);if(o.type===33&&(s=!1),s||!r)return{shouldEndThunk:!1,shouldStartThunk:!1};if(i==="always")return{shouldEndThunk:t!==void 0,shouldStartThunk:!1};let a=o.type===1||o.type===47,u=i.size>0&&!a,c=t!==void 0&&!$k(i,t.set);return{shouldEndThunk:c,shouldStartThunk:(c||t===void 0)&&u}}markEndThunk(t,n){let{referenced:r}=this;for(;t>=0&&!r[t];)t--;this._isThunkEnd[t]=!0,this.thunkEnds[n.start]=t}};function Yk(e,t){if(es(t)){let n=t.endIndex,r=e.getInstruction(n);if(r===void 0)return;if(Gg(r))return{outerEndIndex:n+r.args.length-1,innerEndIndex:n};if(r.type===54)return{outerEndIndex:n,innerEndIndex:n}}}var wp=class{constructor(t,n){this.chunk=t;this.glsl=n;this.inlinedSource=[];this.inlinedThunks=[];this.recursiveFunctionInfo=[];this.isTailFunction=[];let r=t.getReturnIndex();this.referenced=Vr(t,r),this._shouldInline=NO(t,this.referenced),!this.glsl&&t.computeNeedsThunking()&&(this.thunks=new Wg(t,this.referenced,this._shouldInline));for(let s=0;s<=r;s++){let i=t.getInstruction(s);if(i.type===4){if(!this.referenced[s])continue;this.isTailFunction[s]=RO(t,i),i.recursionGroup=i.recursionGroup.filter(o=>this.referenced[o])}}}isThunkBegin(t){return!!this.thunks&&this.thunks.isThunkBegin(t)}isThunkEnd(t){return!!this.thunks&&this.thunks.isThunkEnd(t)}isEarlyReturningThunk(t){return!!this.thunks&&this.thunks.isEarlyReturningThunk(t)&&this.inlinedThunks[t]===void 0}thunkName(t){var n;return(n=this.thunks)==null?void 0:n.containingThunkName(t)}thunkEnd(t){return this.thunks.thunkEnd(t)}shouldInline(t){return this._shouldInline[t]}inlineSource(t,n){this.inlinedSource[t]=n}wantToInlineThunk(t){return!!this.thunks&&this.thunks.wantToInlineThunk(t)}inlineThunk(t,n){this.inlinedThunks[t]=n}referenceArg(t){let n=this.inlinedSource[t];return n!==void 0?n:fn(t)}isDirectlyReferencedByName(t){return this.inlinedSource[t]===void 0}referencePiecewiseBranch(t){var o;let n=this.referenceArg(t),r=(o=this.thunks)==null?void 0:o.dependencyThunkNamesForPiecewiseBranch(t);if(!r||r.length===0)return{expression:n,rawExpression:n,thunkDependencies:[]};let s=[],i="";for(let a of r){let u=this.inlinedThunks[a];if(u!==void 0)i&&(i+=","),i+=u;else{let c=Ap(a),l=_p(a),p=`${c}||${l}()`;i&&(i+=","),i+=`${p}`}s.push(a)}return{expression:"("+i+","+n+")",rawExpression:n,thunkDependencies:s}}enterFunction(t,n,r){let s=t.args[0],i=this.chunk.getInstruction(s),o=[];for(let u=0;u<i.signature.argTypes.length;u++)o.push(n+u+1);let a=OO(this.chunk,n,t,o);this.recursiveFunctionInfo.push({fn:s,argBlockvars:o,reachConditions:a,returnType:t.valueType,executionMode:r})}exitFunction(){this.recursiveFunctionInfo.pop()}};function jg(e){let t=new D0(e),n=Zg(t);return t.finish(n)}var D0=class extends wp{constructor(n){super(n,!1);this.constants=[]}finish(n){return{source:n,constants:this.constants}}printValue(n){return AO(n)}beforeBeginLoop(){}checkFiniteBounds(n,r,s){let i=`}else if(!isFinite(${s}-${r})){\n`;for(let o=2;o<n.args.length;o++){let a=n.endIndex+o-1;if(a>=this.chunk.instructionsLength()||!this.referenced[a])continue;let u=this.chunk.getInstruction(a);if(u.type!==47)continue;let c=fn(a);io(u.valueType)?i+=`${c}=${this.printValue(ls(u.valueType))};\n`:i+=`throw new Error(\'Cannot set ${c} of type ${at(u.valueType)} to NaN value\');\n`}return i}emitConstant(n){return n.valueType===I||n.valueType===De||n.valueType===N||n.valueType===z?this.printValue(n.value):(this.constants.push(Vo(n.value)),`_C[${this.constants.length-1}]`)}emitNeg(n){return`-${n}`}emitTernary(n,r,s){return`${n}?${r}:${s}`}emitVec2(n,r){return`[${n},${r}]`}emitVec3(n,r,s){return`[${n},${r},${s}]`}emitVecAccess(n,r){return`${n}[${r}]`}emitBinary(n,r,s){switch(n.type){case 8:return`${r}+${s}`;case 9:return`${r}-${s}`;case 10:return`${r}*${s}`;case 11:return`${r}/${s}`;case 12:return`BuiltIn.pow(${r},${s})`;case 13:return`Math.pow(${r},${s})`;case 25:return`${r}===${s}`;case 26:return`${r}<${s}`;case 28:return`${r}<=${s}`;case 27:return`${r}>${s}`;case 29:return`${r}>=${s}`;case 31:return`${r}||${s}`;case 32:return`${r}&&${s}`;default:throw new Error("Programming Error: invalid binary opcode.")}}emitList(n){return`[${n.join(",")}]`}emitListAccess(n,r,s){let i=`${n}.length`,o=`Math.floor(${r})`;return`(${o}>=1&&${o}<=${i})?${n}[${o}-1]:${s}`}emitInboundsListAccess(n,r){return`${n}[${r}-1]`}emitNativeFunction(n,r){let s=Bn[r.symbol];return`${s.module}.${s.symbol}(${n.join(",")})`}emitExtendSeed(n,r,s,i){let o=r===I?s:`BuiltIn.serializeNonNumericSeedPart(${r},${s})`;return`${n}+\'::${i}\'+${o}`}emitVarDeclaration(n,r){let s=r?",":"var ";return s+=fn(n),s}emitImmediateAssignment(n,r,s){return`var ${r}=${s};`}emitFunctionCall(n,r,s,i){return`${n}(${r}, ${s}, ${i.join(",")})`}};function AO(e){if(Array.isArray(e))return`[${e.map(AO).join(",")}]`;switch(typeof e){case"boolean":case"number":return e.toString();case"string":return`${JSON.stringify(e)}`;case"object":if(gu(e))throw new Error("Action values cannot be compiled");return V(e).toString();default:throw new Error("Unexpected value: "+e)}}function Jg(e){let t=e.getInstruction(e.getReturnIndex());if(t.type!==47)throw new Error(`Expected BlockVar, got ${t.type}`);let n=e.getInstruction(t.args[0]);if(n.type!==51)throw new Error(`Expected EndMap, got ${n.type}`);let r=j(t.valueType)?Ve(t.valueType):t.valueType,s=e.getInstruction(n.args[0]);if(s.type!==50)throw new Error(`Expected BeginMap, got ${s.type}`);let i=[];for(let p of s.args){let f=e.getInstruction(p);if(!Je(f)||f.valueType!==I)throw U("Programming error: interval bounds must be constant numbers");i.push(V(f.value))}let o,a;r===sr||r===or||r===ir?(o=["t"],a={type:"1d",min:i[0],max:i[1]}):(o=["u","v"],a={type:"2d",uMin:i[0],uMax:i[1],vMin:i[2],vMax:i[3]});let u=jg(e),c=`\n  const mapFn = (function() {\n    "use strict";\n    ${u.source}\n  })();\n  return mapFn(${o.join(",")});\n`,l={};return{args:o,source:c,constants:u.constants,executionMetadata:l,fn:wf(o,c,u.constants,l),domain:a}}function Xk(e){for(let t=0;t<this.length;t++)e(this.elementAt(t),t)}function Zk(e){let t=[];for(let n=0;n<this.length;n++)t.push(e(this.elementAt(n),n));return t}var on=class e extends Yt{constructor(n){super();this.isError=!1;this.eachElement=Xk;this.mapElements=Zk;if(n.getError())throw new Error("Programming error: IRExpression should not be constructed with an error chunk");if(this.warning=n.getWarning(),this._chunk=n,this.valueType=n.getReturnType(),this.addDependencies(n.getLiveArgNames()),this.isList=j(this.valueType),this.isList&&(this.length=this._chunk.getConstantListLength(),this.length===void 0))throw RP(n.getListLengthDependencies());rO(n);let r=n.isConstant();this.isConstant=r&&(this.valueType===I||this.valueType===De),this.isTypedConstant=r,this.isEmptyAction=r&&this.valueType===ut&&Object.keys(n.asValue().updateRules).length===0}shouldExportAns(){return!0}getCompiledFunction(n){return ua(this.valueType)?Jg(this._chunk):this._chunk.getCompiledFunction(n)}getRestrictedFunctionForGLSL(n,r){return this._chunk.getRestrictedFunctionForGLSL(n,r)}polynomialOrder(n){return this._chunk.polynomialOrder(n,{allowRestriction:!0,allowClosedBlockReferences:!1})}getPolynomialCoefficients(n){let r=this._chunk.getPolynomialCoefficients(n),s=r.chunk,i=r.coefficients,o=[];for(let a=0;a<i.length;a++){let u=s.copy();u.setReturnIndex(i[a]),u.fuseBroadcast(),o.push(new e(u))}return o}takeDerivative(n){let r=this._chunk.copy().takeDerivative(n).fuseBroadcast();return new e(r)}gradient(n){let r=this._chunk.copy().gradient(n).fuseBroadcast();return new e(r)}toImplicitBool(){let n=this._chunk.copy();return n.GreaterEqual([n.getReturnIndex(),n.Constant(0)]),n.fuseBroadcast(),new e(n)}interpretWithParameters(n){let r,s=this._chunk.argNames;if(n.length===s.length)r=n;else{r=[];let i=this.getDependencies();for(let o=0,a=0;o<s.length;o++)i[a]===s[o]?(r.push(n[a]),a+=1):r.push(void 0)}return this._chunk.interpretWithParameters(r)}substituteConstantArguments(n){return new e(this._chunk.substituteConstantArguments(n))}boundDomain(n){return this._chunk.boundDomain(n)}asValue(){if(this._chunk.isConstant())return this._chunk.asValue();if(this.isList){let n=[],r=Vo(ls(Ve(this.valueType)));for(let s=0;s<this.length;s++)n.push(r);return n}else return Vo(ls(this.valueType))}asTypedValue(){return{valueType:this.valueType,value:this.asValue()}}asCompilerValue(){return this._chunk.asCompilerValue()}isNaN(){return typeof this.asValue()=="number"&&isNaN(this.asValue())}getEvaluationInfo(){return this._chunk.isConstant()&&this.getDependencies().length===0&&(se(this.valueType,I)||se(this.valueType,De)||se(this.valueType,R))?[{val:this.asValue()}]:!1}findLinearSubset(n){return this._chunk.findLinearSubset(n)}deriveRegressionRestrictions(){let n=this._chunk.deriveRegressionRestrictions();return n===this._chunk?this:new e(n)}getCursorContext(){return this._chunk.getCursorContext()}getRecursiveFunctionMetadata(){let n=this._chunk.getInstruction(this._chunk.getReturnIndex());if(n.type===55)return this._chunk.getRecursiveFunctionMetadata(n.args[0])}coerceToNumericIfPossible(){if(se(this.valueType,Le)||se(this.valueType,ye)||se(this.valueType,R)){let n=this._chunk.copy(),r=n.getReturnIndex();return n.coerceToNumericIfPossible()===r?this:new e(n)}else return this}slot(n){let r=this._chunk.copy();return r.setReturnIndex(r.Slot(n,[r.getReturnIndex()])),new e(r)}};function Wk(e){let t=1/0;for(let n=0;n<e.length;n++)(e[n].isList||e[n].isBroadcast)&&(t=Math.min(t,e[n].length));return t}var Bf=class Bf extends Q{constructor(n){super(n);this.isList=!0;this.length=n.length}asValue(){let n=[];for(let r=0;r<this.args.length;r++)n.push(this.args[r].asValue());return n}asCompilerValue(){let n=[];for(let r=0;r<this.args.length;r++)n.push(this.args[r].asCompilerValue());return n}getEvaluationInfo(){if(this.args.every(n=>n.isConstant))return[{val:this.args.map(n=>n.asValue())}]}};Bf.eachArgs=function(n,r){let s=Wk(n);if(!isFinite(s)){r(n);return}for(let i=0;i<s;i++){let o=[];for(let a=0;a<n.length;a++)o.push(n[a].isList||j(n[a].valueType)?n[a].elementAt(i):n[a]);r(o,i)}},Bf.wrap=function(n){return n.isList||j(n.valueType)?n:new Bf([n])};var lo=Bf;var Go=class extends Q{constructor(t){super(t),this.list=t[0],this.index=t[1]}};var Ja=class extends Q{constructor(n,r,s,i,o=[]){super([n,r].concat(s),{skipRegisterDependencies:!0});this.shouldCoerceToList=i;this.parameters=o;this._index=n,this._body=r,this._inputLists=s,this.registerDependencies()}registerDependencies(){let n=[];for(let i of this._inputLists){let o=i._symbol;n.push(o)}for(let i of this.parameters){let o=i.identifier._symbol;n.push(o)}this.addOptionalDependencies(n);let s=[this._index._symbol,...n];for(let i of this._inputLists)this.mergeDependenciesInScope(this.type,s,i.args[1]);for(let i of this.parameters)this.mergeDependenciesInScope(this.type,s,i.bounds[0]),this.mergeDependenciesInScope(this.type,s,i.bounds[1]);this.mergeDependenciesInScope(this.type,s,this._body)}};var Qg=class extends Et{constructor(){super(...arguments);this.is_mixed_number=!0}};var Kg=class extends ao{constructor(n,r,s){super(n);this.isTypedConstant=!0;this.isMovablePoint=!0;this.moveStrategy=r,this.defaultDragMode=s,this.valueType=N}asValue(){return[+this.args[0].asValue(),+this.args[1].asValue()]}asTypedValue(){return{valueType:this.valueType,value:this.asValue()}}asCompilerValue(){return[this.args[0].asCompilerValue(),this.args[1].asCompilerValue()]}};var Fp=class extends Q{};var Vp=class extends Q{};var Bp=class extends Q{};var Gp=class extends Q{};var kp=class extends Q{};var ul=class extends Q{constructor(t,n){super(n),this.order=t}};var Bu=class extends Q{constructor(t){super(t,{skipRegisterDependencies:!0}),this._index=t[0],this.registerDependencies()}registerDependencies(){for(let t=1;t<=3;t++)this.mergeDependenciesInScope(this.type,[this._index._symbol],this.args[t])}};var Hp=class extends Bu{constructor(){super(...arguments);this.in_place_operator="*=";this.starting_value=1}evaluateConstant(n){let r=1+Math.round(n[1])-Math.round(n[0]);return r<=0?this.starting_value:Math.pow(n[2],r)}update(n,r){return n*r}};var zp=class extends Q{constructor(t){super(t),this.beginning=t[0],this.end=t[1]}isHalfEmpty(){return this.end&&this.end.args&&this.end.args.length===0}};var eh=class extends Lu{};var cl=class extends Q{constructor(n){let r=new Et(n);super([r]);this.value=n;this._constantNode=r}asValue(){return this._constantNode.asValue()}asCompilerValue(){return this._constantNode.asCompilerValue()}};var Up=class extends Q{};var ll=class extends Q{constructor(n){typeof n!="string"&&(n=""+n);super([]);this.isString=!0;this._stringValue=n}asValue(){return this._stringValue}};var Gu=class extends gn{constructor(t,n){super(t,n),this.seed=n[0]}};var th=class extends ja{constructor(n,r){super(new we(n._symbol),n._expression);this.isSlider=!0;this.setInputSpan(n._inputSpan),this.sliderAssignment=n,this.sliderMin=r.sliderMin,this.sliderMax=r.sliderMax,this.sliderSoftMin=r.sliderSoftMin,this.sliderSoftMax=r.sliderSoftMax,this.sliderStep=r.sliderStep,this.sliderIsPlayingOnce=r.sliderIsPlayingOnce,this.sliderMin&&this.mergeDependencies(this.sliderMin),this.sliderMax&&this.mergeDependencies(this.sliderMax),this.sliderStep&&this.mergeDependencies(this.sliderStep)}shouldPromoteToSlider(n){return!1}asAssignment(){return new ja(this._symbol,this._expression)}};var nh=class extends Yt{constructor(t,n,r,s){super(),this._symbol=t,this._expression=n,this.otherVariableSolutionData=r,this.mergeDependencies(n),this.branchMultiplier=s}};var qp=class extends Q{constructor(t){super(t),this._symbol="stats"}};var xa=class extends Q{constructor(t,n){super([t].concat(n),{skipRegisterDependencies:!0}),this._body=t,this._assignments=n,this.registerDependencies()}registerDependencies(){let t=[];for(let n=0;n<this._assignments.length;n++){let r=this._assignments[n],s=r._lhs,i=r._rhs;if(ki(s)){let o=r._symbol;t.push(o),this.mergeDependencies(i)}else if(Qv(s))this.mergeDependencies(r);else throw new Error(`Unexpected LHS in assignment expression: ${s.type}`);this.addSubstitutionDependencies(i.getDependencies())}this.addOptionalDependencies(t),this.mergeDependenciesInScope(this.type,t,this._body)}};var $p=class extends Bu{constructor(){super(...arguments);this.in_place_operator="+=";this.starting_value=0}evaluateConstant(n){let r=1+Math.round(n[1])-Math.round(n[0]);return r<=0?this.starting_value:r*n[2]}update(n,r){return n+r}};var Yp=class extends Yt{constructor(n,r,s,i){super();this.calcColumns=r;this.regression=s;this.exportPenalty=1;this.isTable=!0;this.columns=n,this.mergeDependencies.apply(this,n),this.localFrameID=i}getExports(){return[]}getColumnIdsForGraphing(){return this.columns.map(n=>n.userData.id)}getColumnStatementIds(){return this.calcColumns.map(n=>n.userData.id)}getRegressionId(){var n;return(n=this.regression)==null?void 0:n.userData.id}};var rh=class extends Yt{constructor(t){super(),this.handler=t.handler,this.minStep=t.minStep,this.mergeDependencies(this.handler),this.mergeDependencies(this.minStep)}};var Xp=class extends Q{constructor(t){super(t),this._symbol="ttest"}};var Zp=class extends Q{constructor(t){super(t,{skipRegisterDependencies:!0}),this._symbol=t[0]._symbol,this._expression=t[1],this.registerDependencies()}registerDependencies(){this.addUpdateSymbol(this._symbol),this.mergeDependencies(this._expression)}};var ku=class extends Yt{constructor(t,n){super(),this._symbol=t._symbol,this.mergeDependencies(t,n),this._lhs=t,this._rhs=n}asComparator(){return new ps["="]([this._lhs,this._rhs])}};var br="i",ko=class extends Q{constructor(){super([])}};var pl=class extends Q{constructor(n,r,s){super(n);this.isTypedConstant=!0;this.isMovablePoint=!0;this.moveStrategy=r,this.defaultDragMode=s,this.valueType=R}asValue(){return[+this.args[0].asValue(),+this.args[1].asValue()]}asTypedValue(){return{valueType:this.valueType,value:this.asValue()}}asCompilerValue(){return[this.args[0].asCompilerValue(),this.args[1].asCompilerValue()]}getEvaluationInfo(){return[{val:this.asValue()}]}};var Ho=class extends Q{constructor(t,n){super(n),this.symbol=t}};function lt(e,t){switch(e){case I:case De:return new C.Constant(t);case ft:return new C.Seed(t);case R:return new C.Add([lt(I,t[0]),new C.Multiply([lt(I,t[1]),new C.ImaginaryUnit])]);case N:return new C.ParenSeq([lt(I,t[0]),lt(I,t[1])]);case z:return new C.ParenSeq([lt(I,t[0]),lt(I,t[1]),lt(I,t[2])]);case wt:return new C.FunctionCall("segment",[lt(z,t[0]),lt(z,t[1])]);case ke:return new C.FunctionCall("vector",[lt(z,t[0]),lt(z,t[1])]);case Rn:return new C.FunctionCall("triangle",[lt(z,t[0]),lt(z,t[1]),lt(z,t[2])]);case Hn:return new C.FunctionCall("sphere",[lt(z,t[0]),lt(I,t[1])]);case Kt:return new C.FunctionCall("rgb",[lt(I,t[0]),lt(I,t[1]),lt(I,t[2])]);case xe:return new C.FunctionCall("polygon",[lt(Pt,t)]);case de:return new C.FunctionCall("segment",[lt(N,t[0]),lt(N,t[1])]);case fe:return new C.FunctionCall("line",[lt(N,t[0]),lt(N,t[1])]);case Ne:return new C.FunctionCall("ray",[lt(N,t[0]),lt(N,t[1])]);case le:return new C.FunctionCall("mathVector",[lt(N,t[0]),lt(N,t[1])]);case ce:return new C.FunctionCall("circle",[lt(N,t[0]),lt(I,t[1])]);case ie:return new C.FunctionCall("arc",[lt(N,t[0]),lt(N,t[1]),lt(N,t[2])]);case Le:return new C.FunctionCall("angle",[lt(N,t[0]),lt(I,t[1]),lt(I,t[2])]);case ye:return new C.FunctionCall("directedangle",[lt(N,t[0]),lt(I,t[1]),lt(I,t[2])]);case $e:case ne:case Xn:case Ue:case Pt:case rr:case In:case xn:case jn:case Vn:case Jn:case On:case Nn:case Wn:case Fn:case fr:case mr:case gr:case yr:case Ar:case cs:{let r=[],s=Ve(e);for(let i of t)r.push(lt(s,i));return new C.List(r)}case Qt:case Lt:case pn:case Zn:case ut:case Re:case Rr:case Ro:case sr:case or:case ir:case Pr:case Mr:case Er:case $r:case Wr:case Yr:case Xr:case jr:case Zr:case Gt:case Gs:throw new Error(`Programming error: cannot create parse node from valueType: ${at(e)}`);case Pn:return new C.FunctionCall("tone",[lt(I,t[0]),lt(I,t[1])]);default:let n=e;throw new Error(`Programming error: unexpected valueType: ${at(n)}`)}}function jk(e){if(!e.isTypedConstant)return new Et(NaN);let t=e.asTypedValue();return t?lt(t.valueType,t.value):new Et(NaN)}function Jk(e){if(!e.isTypedConstant)return NaN;let t=e.asTypedValue();if(!t)return NaN;switch(t.valueType){case I:return t.value;case R:return t.value;default:throw U(`Unexpected type ${at(t.valueType)} in column.`)}}var dl=class extends lo{constructor(n,r){super(n.map(jk));this.rawArgs=n;this.headerSymbol=r;this.isIndependent=r!==void 0}asValueMixed(){return this.rawArgs.map(Jk)}};function ae(e,t){let n=eO(e);return n.prototype.type=t,n}var Qk={Base:ae(Yt,"Base"),Expression:ae(Q,"Expression"),Error:ae(v,"Error"),Constant:ae(Et,"Constant"),MixedNumber:ae(Qg,"MixedNumber"),Identifier:ae(we,"Identifier"),Ans:ae(Fg,"Ans"),ImaginaryUnit:ae(ko,"ImaginaryUnit"),List:ae(lo,"List"),TableColumnValue:ae(dl,"TableColumnValue"),Range:ae(zp,"Range"),ListAccess:ae(Go,"ListAccess"),DotAccess:ae(Ms,"DotAccess"),Construction:ae(rl,"Construction"),ParenSeq:ae(ao,"ParenSeq"),MovableComplexNumber:ae(pl,"MovableComplexNumber"),MovablePoint:ae(Kg,"MovablePoint"),NamedCoordinateAccess:ae(Ho,"NamedCoordinateAccess"),BareSeq:ae(Ru,"BareSeq"),Norm:ae(Bp,"Norm"),BaseComparator:ae(uo,"BaseComparator"),ComparatorChain:ae(Au,"ComparatorChain"),DoubleInequality:ae(Vg,"DoubleInequality"),RepeatedOperator:ae(Bu,"RepeatedOperator"),Sum:ae($p,"Sum"),Product:ae(Hp,"Product"),Integral:ae(Rp,"Integral"),AssignmentExpression:ae(Mp,"AssignmentExpression"),ListComprehension:ae(Ja,"ListComprehension"),FunctionCall:ae(gn,"FunctionCall"),RecursiveFunctionBaseCase:ae(Qr,"RecursiveFunctionBaseCase"),SeededFunctionCall:ae(Gu,"SeededFunctionCall"),FunctionExponent:ae(wu,"FunctionExponent"),FunctionFactorial:ae(Fu,"FunctionFactorial"),Prime:ae(ul,"Prime"),Piecewise:ae(Fr,"Piecewise"),Restriction:ae(Up,"Restriction"),Derivative:ae(sl,"Derivative"),UpdateRule:ae(Zp,"UpdateRule"),Substitution:ae(xa,"Substitution"),Histogram:ae(Op,"Histogram"),DotPlot:ae(vp,"DotPlot"),BoxPlot:ae(Cp,"BoxPlot"),TTest:ae(Xp,"TTest"),IndependentTTest:ae(Np,"IndependentTTest"),Stats:ae(qp,"Stats"),Assignment:ae(ja,"Assignment"),FunctionDefinition:ae(Cr,"FunctionDefinition"),CallAssignment:ae(ku,"CallAssignment"),Equation:ae(Nu,"Equation"),Regression:ae(Pp,"Regression"),Image:ae(Bg,"Image"),Ticker:ae(rh,"Ticker"),Slider:ae(th,"Slider"),RegressionParameter:ae(cl,"RegressionParameter"),Table:ae(Yp,"Table"),TableColumn:ae(co,"TableColumn"),SolvedEquation:ae(nh,"SolvedEquation"),OptimizedRegression:ae(Wa,"OptimizedRegression"),Seed:ae(ll,"Seed"),ExtendSeed:ae(il,"ExtendSeed"),IRExpression:ae(on,"IRExpression"),Add:ae(Ep,"Add"),Subtract:ae(Es,"Subtract"),Multiply:ae(Fp,"Multiply"),DotMultiply:ae(_u,"DotMultiply"),CrossMultiply:ae(Dp,"CrossMultiply"),Divide:ae(Sp,"Divide"),Exponent:ae(Lu,"Exponent"),Negative:ae(Vp,"Negative"),Or:ae(Gp,"Or"),PercentOf:ae(kp,"PercentOf"),RawExponent:ae(eh,"RawExponent"),Comparator:{"<":ae(ps["<"],"Comparator[\'<\']"),">":ae(ps[">"],"Comparator[\'>\']"),"<=":ae(ps["<="],"Comparator[\'<=\']"),">=":ae(ps[">="],"Comparator[\'>=\']"),"=":ae(ps["="],"Comparator[\'=\']")}},C=Qk;var F1={};ia(F1,{parse:()=>Mi,setInput:()=>$A});var Dr={xmin:-5,xmax:5,ymin:-5,ymax:5,zmin:-5,zmax:5};function S0(e,t){let n=Math.round(1e6*e)/1e6;return Math.abs(n-e)<t?n:e}function $j(e){let t=!0,n=!0,r=!0;return e.hardMin!==void 0&&e.target<e.hardMin&&(t=!1),e.hardMax!==void 0&&e.target>e.hardMax&&(n=!1),e.step&&sh({target:e.target,step:e.step,hardMin:t?e.hardMin:void 0,hardMax:n?e.hardMax:void 0})!==e.target&&(r=!1),{min:t,max:n,step:r}}function sh(e){let{target:t,hardMin:n,hardMax:r,step:s}=e,i=1e-10;if(n!==void 0&&r!==void 0&&(i=Math.min(i,Math.abs(r-n)/1e3)),s&&(i=Math.min(i,s/10)),n!==void 0&&(n=S0(n,i)),r!==void 0&&(r=S0(r,i)),e.forceSliderToMax&&r!==void 0&&(t=r),n>r||t<=n)return n;if(t>=r)return r;if(s){let a=n!==void 0?n:0,u=Math.round((t-a)/s);t=s*u+a}let o=S0(t,i);return(s||n===o||r===o)&&(t=o),t<=n?n:t>=r?r:t}function _O(e){let{storedMax:t,sliderValue:n,hardMin:r,step:s}=e,i=e.is3d?Dr.xmax:10;if(t>i&&(i=t),n>i&&(i=n),r>i&&(i=r),s){let o=sh({target:i,hardMin:r,hardMax:void 0,step:s});o>=i?i=o:i=o+s}return i}var Qa={coerceToNumber:"all"};C.Base.prototype.tryGetConcreteTree=function(e,t,n={}){let r;try{r=this.getConcreteTree(e,t,n)}catch(s){s instanceof C.Base?r=s:r=U(s)}return r};C.Base.prototype.getConcreteTree=function(e,t,n={}){let r=this.buildIRExpression(e,t,{coerceToNumber:n.coerceToNumber});if(r.isError)throw r;return r};C.DoubleInequality.prototype.getConcreteTree=function(e,t){return new this.constructor([new C.Piecewise([this._indicator,this._expressions[0],new Et(NaN)]).getConcreteTree(e,t),this._operators[0],new we(this._symbol),this._operators[1],new C.Piecewise([this._indicator,this._expressions[1],new Et(NaN)]).getConcreteTree(e,t)])};C.Error.prototype.getConcreteTree=function(e,t){return this};function Gf(e,t){return e.isError?e:t.indexOf(e.valueType)===-1?Fd():e}C.Image.prototype.getConcreteTree=function(e,t){let n=this.center.tryGetConcreteTree(e,t),r=this.radianAngle.tryGetConcreteTree(e,t,Qa),s=this.width.tryGetConcreteTree(e,t,Qa),i=this.height.tryGetConcreteTree(e,t,Qa),o=this.opacity.tryGetConcreteTree(e,t,Qa),a=[N,Pt,$e],u=[I,ne,$e];return n=Gf(n,a),r=Gf(r,u),s=Gf(s,u),i=Gf(i,u),o=Gf(o,u),new C.Image({center:n,radianAngle:r,width:s,height:i,opacity:o},this.moveStrategy)};C.Ticker.prototype.getConcreteTree=function(e,t){let n=this.handler.tryGetConcreteTree(e,t);!n.isError&&n.valueType!==ut&&(n=kd(oe(n.valueType)));let r=n.getDependencies().filter(s=>!(e.graphingEnabled()&&e.validActionVariable(s)));return r.length&&(n=rn(e.sliderVariables(r)).setDependencies(r)),new C.Ticker({handler:n,minStep:this.minStep.tryGetConcreteTree(e,t,Qa)})};function v0(e,t,n){if(!t){n.valids[e]=!0;return}let r=t.getDependencies();if(t.isError)n.errors[e]=!0;else if(r.length>0){n.errors[e]=!0;for(let s=0;s<r.length;s++)r[s]===n.exportedSymbol?n.errors.cycle=!0:n.missingVars.push(r[s])}else n.values[e]=+t.asValue();n.valids[e]=isFinite(n.values[e]),n.valids[e]||(n.values[e]=void 0)}function ih(e){return e&&e.valueType===ne&&e.length===1&&e.args?e.args[0]:e}C.Slider.prototype.getConcreteTree=function(e,t){let n=this._expression.getConcreteTree(e,t),r=ih(this.sliderMin&&this.sliderMin.tryGetConcreteTree(e,t,Qa)),s=ih(this.sliderMax&&this.sliderMax.tryGetConcreteTree(e,t,Qa)),i=ih(this.sliderStep&&this.sliderStep.tryGetConcreteTree(e,t,Qa)),o={exportedSymbol:this._symbol,errors:{},values:{},valids:{},missingVars:[],errMsg:void 0};if(v0("min",r,o),v0("max",s,o),v0("step",i,o),i&&o.valids.step&&(o.values.step===0?delete o.values.step:o.values.step=Math.abs(o.values.step)),o.errors.cycle?n=SI(o.exportedSymbol):(o.errors.min||!o.valids.min?o.errMsg=vI():o.errors.max||!o.valids.max?o.errMsg=OI():(o.errors.step||!o.valids.step)&&(o.errMsg=RI()),o.values.min>o.values.max&&(o.valids.min=!1,o.valids.max=!1,o.errMsg||(o.errMsg=NI()))),n.isConstant){let u=t.initialEvaluation&&t.initialEvaluation.asValue()&&this.sliderIsPlayingOnce,c=o.values.max,l=+n.asValue(),p=o.values.min,f=o.values.step;if(u&&!isFinite(c)){let m=ih(this.sliderSoftMax&&this.sliderSoftMax.tryGetConcreteTree(e,t,Qa));m&&(c=_O({storedMax:+m.asValue(),sliderValue:l,step:f,hardMin:p,is3d:e.is3dProduct()}))}let d=sh({target:l,hardMin:p,hardMax:c,step:f,forceSliderToMax:!!u}),y=Qc(d.toString()),g=isFinite(V(y))?y:d;n=new Et(g).getConcreteTree(e,t)}return n.sliderInfo=o,n};function LO(e,t){if(!t[this._symbol])throw Li(this._symbol,e);let n=this.args.map(r=>r.getConcreteTree(e,t));if(n.length>0){if(n.length===1&&n.push(new C.Constant(1).getConcreteTree(e,t)),n[1].getDependencies().length)throw Qd(this._symbol).setDependencies(n[1].getDependencies());if(n[1].valueType!==I)throw Qd(this._symbol);let r=n[1].asValue();if(!isFinite(r)||r<=0)throw Qd(this._symbol)}return this.typeCheck(e,n),new this.constructor(n)}C.Histogram.prototype.getConcreteTree=LO;C.DotPlot.prototype.getConcreteTree=LO;C.BoxPlot.prototype.getConcreteTree=function(e,t){if(!t[this._symbol])throw Li(this._symbol,e);let n=this.args.map(r=>r.getConcreteTree(e,t));return this.typeCheck(e,n),n.length===1&&(n[0].valueType===ne||n[0].valueType===$e)?new this.constructor(n):U("Failed to copmile BoxPlot")};function O0(e,t){if(!t[this._symbol])throw Li(this._symbol,e);let n=this.args.map(r=>r.getConcreteTree(e,t));return this.typeCheck(e,n),new this.constructor(n)}C.TTest.prototype.getConcreteTree=O0;C.IndependentTTest.prototype.getConcreteTree=O0;C.Stats.prototype.getConcreteTree=O0;C.Table.prototype.getConcreteTree=function(e,t){let n=[];for(let i of this.columns){let o=ga(i)&&ki(i.header)?t[i.header._symbol]:void 0;o&&ha(o)?n.push(o):n.push(i.tryGetConcreteTree(e,t))}let r=1;for(let i of n)i.isList&&(r=Math.max(i.length,r));let s=[];for(let i of n)s.push(eH(i,r));return new C.Table(s,this.calcColumns,this.regression,this.localFrameID)};function eH(e,t){if(Kr(e))return e;if(ha(e))return e;if(e.isList){let n;if(e instanceof lo)n=e.mapElements(r=>r);else if(e instanceof on)n=e.mapElements(r=>r);else return U(`Unexpected parse node type ${e.type} with isList: true`);return new C.TableColumnValue(n,void 0)}else if(e.isTypedConstant){let n=[];for(let r=0;r<t;r++)n.push(e);return new dl(n,void 0)}else return U(`Invalid column: expected an error, constant, or list but got:\n ${e.repr("",1)}`)}C.TableColumn.prototype.getConcreteTree=function(e,t){var r;let n=this.header.tableError();if(n)return KI(n);if(this.header instanceof C.Identifier){let s=t[this.header._symbol];if(s&&t.hasOwnProperty(this.header._symbol)&&Kr(s))return s}if(this.isFreeVariable(t)){if(this.columnIndex===0){let i=this.header._symbol;if(!e.validFirstColumnVariable(i))return eP()}let s=[];for(let i=0;i<this.values.length;i++){if(this.values[i].tableError()){s.push(Wd(this.values[i].tableError()));continue}let o=this.values[i].tryGetConcreteTree(e,t);o.isError?s.push(o):o.tableError()?s.push(Wd(o.tableError())):o.valueType===I||o.valueType===R?s.push(o):s.push(bT([oe(o.valueType)]))}for(let i=0;i<s.length;i++){if(s[i].isError)continue;let o=this.values[i]&&this.values[i].tableError();if(o){s[i]=Wd(o);continue}let a=s[i].getDependencies();a.length&&(s[i]=rn(a).setDependencies(a))}return new dl(s,this.header._symbol)}else{let s=this.header.getConcreteTree(e,t,{coerceToNumber:"all-except-complex"});return!s.isError&&s.valueType!==I&&s.valueType!==ne&&s.valueType!==R&&s.valueType!==Ue&&s.valueType!==$e?hT([oe((r=s.valueType)!=null?r:Qt)]):s.getDependencies().length>0?rn(s.getDependencies()).setDependencies(s.getDependencies()):s}};var Ka;function wO(e){Ka=e}function FO(){Ka&&(Ka.cacheHits+=1)}function VO(){Ka&&(Ka.cacheMisses+=1)}function BO(){Ka&&(Ka.cacheWrites+=1)}function GO(){Ka&&(Ka.cacheReads+=1)}var kO={segment:!0,ray:!0,vector:!0,line:!0,circle:!0,arc:!0,polygon:!0,glider:!0,midpoint:!0,intersection:!0,strictintersection:!0,perpendicular:!0,parallel:!0,translate:!0,rotate:!0,dilate:!0,reflect:!0,apply:!0,segments:!0,vertices:!0,angle:!0,angles:!0,directedangle:!0,directedangles:!0,clockwise:!0,counterclockwise:!0,reflex:!0,start:!0,end:!0,anglebisector:!0};function zo(e){switch(e.type){case"simple":return;case"list-access":return e.listIndex;case"polygon-edge":return zo(e.polygon);case"arbitrary-expression":return;default:throw new Error(`Unexpected parent type: ${e.type}`)}}function Ta(e){switch(e.type){case"simple":case"list-access":return e.identifier;case"polygon-edge":return Ta(e.polygon);default:throw new Error(`Unexpected parent type: ${e.type}`)}}var Wp={simple:e=>({type:"simple",identifier:e}),listAccess:(e,t)=>({type:"list-access",identifier:e,listIndex:t}),polygonEdge:(e,t)=>({type:"polygon-edge",polygon:{type:"simple",identifier:e},edgeIndex:t}),polygonListItemEdge:(e,t)=>({type:"polygon-edge",polygon:{type:"list-access",identifier:e,listIndex:t.listIndex},edgeIndex:t.edgeIndex}),arbitraryExpression:e=>({type:"arbitrary-expression",latex:e.getInputString()})};function tH(e){return e!==void 0&&e in kO}function kf(e){return tH(e)?e==="rotate"||e==="dilate"||e==="translate"||e==="reflect"?!0:!1:!1}function oh(e){if(e instanceof Go&&e.list instanceof we&&e.index instanceof Et)return Wp.listAccess(e.list._symbol,e.index.asValue());if(e instanceof Go&&e.list instanceof Ms&&e.index instanceof Et){let t=e.list.args[0],n=e.list.args[1];if(t instanceof we&&n instanceof we&&n._symbol==="segments")return Wp.polygonEdge(t._symbol,e.index.asValue());if(t instanceof Go&&t.list instanceof we&&t.index instanceof Et)return Wp.polygonListItemEdge(t.list._symbol,{listIndex:t.index.asValue(),edgeIndex:e.index.asValue()})}return e.type==="Identifier"?Wp.simple(e._symbol):Wp.arbitraryExpression(e)}function ah(e){let t={},n=e;if((n instanceof ja||n instanceof Cr)&&(t.identifier=n._symbol,n=n._expression),n instanceof Go&&n.index instanceof Et&&(t.listAccess=n.index.asValue(),n=n.list),n instanceof gn){let r=n._symbol,s=n.args[0]instanceof we?n.args[0]._symbol:void 0;if(kf(r)&&e instanceof Cr&&s&&e._argSymbols.some(i=>i===s))t.tree={symbol:r,parents:n.args.slice(1).map(oh)};else if(kO[r])t.tree={symbol:r,parents:n.args.map(oh)};else{let i=Wp.simple(n._symbol);t.tree={symbol:"apply",parents:[i,...n.args.map(oh)]}}}else if(n instanceof Ms){let r=n.args.map(oh);r.length===2&&r[1]&&r[1].type==="simple"&&r[1].identifier==="segments"?t.tree={symbol:"segments",parents:[r[0]]}:r.length===2&&r[1]&&r[1].type==="simple"&&r[1].identifier==="start"?t.tree={symbol:"start",parents:[r[0]]}:r.length===2&&r[1]&&r[1].type==="simple"&&r[1].identifier==="end"&&(t.tree={symbol:"end",parents:[r[0]]})}return t}function UO(e,t,n,r,s){let i=se(n,ce)||se(n,ie),o=se(s,ce)||se(s,ie);if(!i&&!o)return;let a=zO(e,t,n),u=zO(e,r,s),c=a.filter(l=>{let p=Ta(l);return p?u.some(f=>ws(l,f))&&!!e.lookup(p):!1});for(let l of a)HO(e,l,r)&&c.every(p=>!ws(l,p))&&c.push(l);for(let l of u)HO(e,l,t)&&c.every(p=>!ws(l,p))&&c.push(l);if(c.length===1)return c[0]}function HO(e,t,n){let r=Ta(t),s=r!==void 0?e.lookup(r):void 0,i=s&&e.getGeometryTree(s);return((i==null?void 0:i.symbol)==="glider"||(i==null?void 0:i.symbol)==="intersection"||(i==null?void 0:i.symbol)==="strictintersection"||(i==null?void 0:i.symbol)==="midpoint")&&(i==null?void 0:i.parents.some(o=>{if(o.type==="arbitrary-expression")return!1;let a=Ta(o);return a&&e.resolvesTo(a,n)&&(zo(t)===void 0||zo(o)===void 0||zo(o)===zo(t))}))}function zO(e,t,n){var i;let r=[],s=((i=e.getGeometryTree(t))==null?void 0:i.parents)||[];for(let o=0;o<s.length;o++){let a=s[o];if(se(n,ce)&&o===0||a.type==="arbitrary-expression"||a.type==="polygon-edge")continue;let u=Ta(a);if(!u)continue;let c=e.lookup(u);c&&e.isPointOrListOfPoints(c)&&r.push(a)}return r}function jp(e){if(e.length===0)return $e;if(e.includes(R))return Ue;let t=e[0];if(t!==I&&kn(t,I))for(let n of e){let r=fu(t,n);r!==void 0&&(t=r)}return wn(t)?vn(t):pn}function qO(e){let t=[];for(let n of e)n!==$e&&(j(n)?t.push(Ve(n)):t.push(n));return jp(t)}function uh(e,t){if(j(e)){let n=Ve(e);for(let r=0;r<t.length;r++)if(Br(n,t[r]))return!0;return!1}return Br(e,t)}function Br(e,t){switch(e){case I:return Ii(t);case Gt:return t;case R:case N:{let[n,r]=t;return Ii(n)||Ii(r)}case z:{let[n,r,s]=t;return Ii(n)||Ii(r)||Ii(s)}case Kt:{let[n,r,s]=t;return Ii(n)||Ii(r)||Ii(s)}case xe:{for(let n of t)if(Br(N,n))return!0;return!1}case Hn:{let[n,r]=t;return Br(z,n)||Br(I,r)}case Rn:{let[n,r,s]=t;return Br(z,n)||Br(z,r)||Br(z,s)}case wt:case ke:{let[n,r]=t;return Br(z,n)||Br(z,r)}case de:case fe:case Ne:case le:{let[n,r]=t;return Br(N,n)||Br(N,r)}case ce:{let[n,r]=t;return Br(N,n)||Br(I,r)}case ie:{let[n,r,s]=t;return Br(N,n)||Br(N,r)||Br(N,s)}case Le:case ye:{let[n,r,s]=t;return Br(N,n)||Br(I,r)||Br(I,s)}case ut:return Object.keys(t.updateRules).length===0;case De:case Lt:case ft:case Re:case sr:case or:case ir:case Pr:case Mr:case Er:return!1;case Pn:{let[n,r]=t;return Ii(n)||Ii(r)}default:throw new Error("Type cannot contain a NaN value: "+oe(e)+".")}}function po(e,t){return e.pushLeafInstruction(t)}function _n(e,t,n){switch(t.type){case 8:return e.Add(n);case 9:return e.Subtract(n);case 10:return e.Multiply(n);case 11:return e.Divide(n);case 12:return e.Exponent(n);case 13:return e.RawExponent(n);case 14:return e.Negative(n);case 25:return e.Equal(n);case 26:return e.Less(n);case 27:return e.Greater(n);case 28:return e.LessEqual(n);case 29:return e.GreaterEqual(n);case 31:return e.Or(n);case 32:return e.And(n);case 33:return e.Piecewise(n);case 47:return e.BlockVar(t.valueType,n);case 48:return e.BroadcastResult(t.valueType,n);case 15:return e.TupleOfType(t.valueType,n);case 16:return e.Slot(t.index,n);case 37:return e.NativeFunction(t.symbol,n);case 42:return e.Distribution(t.symbol,n);case 21:return e.BeginIntegral(t.callData,n);case 22:return e.EndIntegral(n);case 23:return e.BeginBroadcast(n,t.context);case 24:return e.EndBroadcast(n);case 19:return e.BeginLoop(t.callData,n);case 20:return e.EndLoop(n);case 38:return e.List(n);case 39:return e.ListAccess(n);case 40:return e.DeferredListAccess(n);case 41:return e.InboundsListAccess(n);case 44:return e.ExtendSeed(t.tag,n);case 49:return e.Action(t.symbols,n);case 50:return e.BeginMap(t.callData,n);case 51:return e.EndMap(n);case 53:return e.BeginFunction(n);case 54:return e.EndFunction(n);case 55:return e.FunctionCall(n);default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function $O(e,t,n){let r=e.argNames.indexOf(t);if(r===-1)return 0;let s=ns(e,r,n);return ln(s,e.getReturnIndex())}function ns(e,t,{allowRestriction:n,allowClosedBlockReferences:r}){return{chunk:e,argIndex:t,orderTable:[],mask:Vu(e,t),allowRestriction:n,allowClosedBlockReferences:r}}function ln(e,t){let n=e.orderTable[t];if(n!==void 0)return n;let r=nH(e,t);return e.orderTable[t]=r,r}function nH(e,t){let{chunk:n,mask:r,argIndex:s,allowRestriction:i,allowClosedBlockReferences:o}=e;if(!o&&n.isInClosedBlock(t))return 1/0;if(t===s)return 1;if(!r[t])return 0;let a=n.getInstruction(t);if(es(a)||ds(a))return 1/0;switch(a.type){case 8:case 9:case 26:case 28:case 27:case 29:{let[c,l]=a.args;return Math.max(ln(e,c),ln(e,l))}case 10:{let[c,l]=a.args;return ln(e,c)+ln(e,l)}case 14:return ln(e,a.args[0]);case 11:{let[c,l]=a.args;return ln(e,l)>0?1/0:ln(e,c)}case 12:case 13:{let[c,l]=a.args,p=n.getInstruction(l);if(ln(e,c)===0&&ln(e,l)===0)return 0;if(p.type===1){let f=V(p.value);return f===Math.round(f)&&f>0?ln(e,c)*f:1/0}else return 1/0}case 33:{let c=n.getInstruction(a.args[2]);return i&&c.type===1&&isNaN(V(c.value))?ln(e,a.args[1]):1/0}case 16:case 37:case 2:case 0:case 1:case 25:case 32:case 31:case 15:case 38:case 39:case 40:case 41:case 42:case 48:case 47:case 3:case 44:case 49:case 4:case 55:return 1/0;default:let u=a;throw new Error(`Unexpected opcode ${u.type}`)}}function YO(e,t){let n=e.argNames.indexOf(t),r=e.getReturnIndex(),s=fo(ns(e,n,{allowRestriction:!0,allowClosedBlockReferences:!1}),r);if(ln(s.orderCtx,r)>2)throw new Error("Programming Error: cannot compute polynomial coefficients for polynomials of order greater than 2");let i=Kn(s,r),o=!1;for(let a=0;a<e.instructionsLength();a++)e.getInstruction(a).type===33&&s.mask[a]&&(o=!0);return{chunk:s.newChunk,coefficients:i,mappedArgIndex:s.valueMap[n],mappedReturnIndex:s.valueMap[r],isRestrictedPolynomial:o}}function fo(e,t){let{chunk:n,argIndex:r}=e,s=Vr(n,t);if(n.isInClosedBlock(r))throw new Error("Programming Error: cannot find polynomial coefficients of an instruction in a closed block");let i,o;r>=0&&r<n.argNames.length?(i=n.argNames.slice(),o=n.argTypes.slice(),i.splice(r,1),o.splice(r,1)):(i=n.argNames,o=n.argTypes);let a=new Ia({argNames:i,argTypes:o}),u=[];for(let d=0;d<n.instructionsLength();d++){if(!s[d])continue;let y=n.getInstruction(d);if(y.type===2)d<r||r<0?u[d]=d:d===r?u[d]=a.SymbolicVar(n.argTypes[d]):u[d]=d-1;else if(ge(y))u[d]=po(a,y);else{let g=[];for(let m of y.args)g.push(u[m]);u[d]=_n(a,y,g)}}let c=[],l=a.Constant(0),p=a.Constant(1),f=a.Constant(NaN);return{chunk:n,newChunk:a,orderCtx:e,coefficientTable:c,mask:e.mask,valueMap:u,argIndex:r,zero:l,one:p,nan:f}}function Kn(e,t){let{newChunk:n,orderCtx:r,coefficientTable:s,mask:i,valueMap:o,argIndex:a,zero:u,one:c,nan:l}=e,p=s[t];if(p!==void 0)return p;let f;for(i[t]?t===a?f=[u,c]:ln(r,t)>2?f=[l]:f=rH(e,t):f=[o[t]];f.length>1;){let d=n.getInstruction(f[f.length-1]);if(d.type===1&&V(d.value)===0)f.pop();else break}if(f.length===0)throw new Error("Programming Error: coefficients cannot be empty");return s[t]=f,f}function rH(e,t){let n=e.chunk.getInstruction(t),{newChunk:r}=e;switch(n.type){case 8:{let[i,o]=n.args,a=Kn(e,i),u=Kn(e,o),c=a.length-1,l=u.length-1,p=[];for(let f=0;f<=Math.max(c,l);f++)c>=f&&l>=f?p.push(r.Add([a[f],u[f]])):p.push(c>l?a[f]:u[f]);return p}case 9:case 26:case 28:case 27:case 29:{let[i,o]=n.args;(n.type===26||n.type==28)&&([i,o]=[o,i]);let a=Kn(e,i),u=Kn(e,o),c=a.length-1,l=u.length-1,p=[];for(let f=0;f<=Math.max(c,l);f++)c>=f&&l>=f?p.push(r.Subtract([a[f],u[f]])):p.push(c>l?a[f]:r.Negative([u[f]]));return p}case 14:{let i=n.args[0],o=Kn(e,i),a=[];for(let u=0;u<o.length;u++)a.push(r.Negative([o[u]]));return a}case 10:{let[i,o]=n.args,a=Kn(e,i),u=Kn(e,o),c=a.length-1,l=u.length-1,p=[];for(let f=0;f<=c;f++)for(let d=0;d<=l;d++){if(f+d>2)continue;let y=r.Multiply([a[f],u[d]]),g=p[f+d];g===void 0?p[f+d]=y:p[f+d]=r.Add([g,y])}return p}case 11:{let[i,o]=n.args,a=Kn(e,i),u=Kn(e,o),c=[];for(let l=0;l<a.length;l++)c.push(r.Divide([a[l],u[0]]));return c}case 12:case 13:{let[i,o]=n.args,a=Kn(e,i),u=Kn(e,o);if(a.length-1===0)return[r.RawExponent([a[0],u[0]])];let l=r.getInstruction(u[0]);switch(V(l.value)){case 0:return[r.Constant(1)];case 1:return a;case 2:return[r.Multiply([a[0],a[0]]),r.Multiply([r.Constant(2),r.Multiply([a[0],a[1]])]),r.Multiply([a[1],a[1]])]}}case 33:return Kn(e,n.args[1]);case 37:case 16:case 0:case 23:case 2:case 1:case 25:case 32:case 31:case 15:case 38:case 39:case 40:case 41:case 42:case 21:case 22:case 19:case 20:case 24:case 48:case 47:case 3:case 44:case 49:case 50:case 51:case 4:case 53:case 54:case 55:throw new Error(`Cannot find polynomial coefficients of opcode ${n.type} that depends on symbol.`);default:let s=n;throw new Error(`Unexpected opcode ${s.type}`)}}function XO(e,t,n){let r=e.argNames.indexOf(t);if(r===-1){let o=e.getInstruction(n);return o.type===1?R0(o.valueType,o.value):dr()}let s=ns(e,r,{allowRestriction:!0,allowClosedBlockReferences:!1}),i=sH(s,n);return Ds(i,n)}function sH(e,t){let{chunk:n,mask:r}=e;return{chunk:n,mask:r,orderCtx:e,domainTable:[],index:t}}function Ds(e,t){let{domainTable:n}=e,r=n[t];if(r!==void 0)return r;let s=iH(e,t);return n[t]=s,s}function iH(e,t){let{chunk:n,mask:r,orderCtx:s}=e,i=n.getInstruction(t);switch(i.type){case 1:return R0(i.valueType,i.value);case 3:case 2:return i.valueType===I?aa():dr();case 0:return dr();case 31:return Sd(Ds(e,i.args[0]),Ds(e,i.args[1]));case 32:case 8:case 9:case 10:return Gn(Ds(e,i.args[0]),Ds(e,i.args[1]));case 11:{let o=Gn(Ds(e,i.args[0]),Ds(e,i.args[1])),a=n.getInstruction(i.args[1]);return a.type===1&&a.valueType===I&&V(a.value)!==0?o:Gn(dr(),o)}case 14:return Ds(e,i.args[0]);case 15:{let o=i.valueType;switch(o){case N:case z:return oH(e,i.args);case R:return N0(e,i.args);default:let a=o;throw new Error(`Unexpected tuple type ${a}`)}}case 12:case 13:case 47:case 48:case 16:case 42:case 21:case 22:case 23:case 24:case 19:case 20:case 39:case 40:case 41:case 44:case 50:case 51:case 54:case 55:return N0(e,i.args);case 4:case 53:return dr();case 49:return dr();case 38:return i.args.length===1?Ds(e,i.args[0]):dr();case 25:return dr();case 33:return OD(Ds(e,i.args[0]),Ds(e,i.args[1]),Ds(e,i.args[2]));case 26:case 27:case 28:case 29:{if(!r[t])return aa();let o=Gn(Ds(e,i.args[0]),Ds(e,i.args[1]));if(ln(s,t)>1)return Gn(dr(),o);let a=e.coefficientCtx;a===void 0&&(a=fo(s,e.index),e.coefficientCtx=a);let u=a.newChunk,c=Kn(a,t),[l,p]=c;if(!Je(u.getInstruction(l)))return Gn(dr(),o);let f=hn(u,l);if(isNaN(f))return ka();if(p===void 0)return i.type===28||i.type===29?f>=0?o:ka():f>0?o:ka();{let d=hn(u,p);return Gn(o,Hl(f,d))}}case 37:switch(i.symbol){case"restriction":case"restrictionToBoolean":return Ds(e,i.args[0]);case"count":return aa();default:return Bn[i.symbol].noPeel?dr():N0(e,i.args)}}}function oH(e,t){let n=aa();for(let r of t)n=Gn(n,Ds(e,r));return n}function N0(e,t){let n=dr();for(let r of t)n=Gn(n,Ds(e,r));return n}function R0(e,t){if(j(e))return t.length===1?R0(Ve(e),t[0]):dr();switch(e){case I:case N:case z:return uh(e,t)?ka():aa();case De:return t?aa():ka();default:return dr()}}var Hf=[oi(I),oi(I)],A0=[...Pi([[Te,Te],[R,R],[N,I],[I,N],[I,le],[I,ke],[le,I],[ke,I],[z,I],[I,z],[Gt,Tf],[Tf,Gt]]),kt([Gt,If]),kt([If,Gt])],_0={Negative:Pi([[Te],[R],[N],[le],[ke],[z]]),Add:Pi([[Te,Te],[R,R],[N,N],[le,le],[ke,ke],[z,z]]),Subtract:Pi([[Te,Te],[R,R],[N,N],[le,le],[ke,ke],[z,z]]),Multiply:A0,DotMultiply:[...Pi([[le,le],[ke,ke],[z,z]]),...A0],CrossMultiply:[...Pi([[ke,ke],[z,z]]),...Pi([[Te,Te],[R,R],[N,I],[I,N],[le,I],[I,le],[ke,I],[I,ke],[Gt,Tf],[Tf,Gt]]),kt([Gt,If]),kt([If,Gt])],Divide:Pi([[Te,Te],[R,R],[N,I],[le,I],[ke,I],[z,I]]),Exponent:Pi([[Te,Te],[R,R]]),"Comparator[\'=\']":[kt(Hf)],"Comparator[\'>\']":[kt(Hf)],"Comparator[\'<\']":[kt(Hf)],"Comparator[\'>=\']":[kt(Hf)],"Comparator[\'<=\']":[kt(Hf)],ComparatorChain:Pi([{type:"variadic",initial:[I,I],rest:I}]),PercentOf:A0,Norm:Pi([[I],[N],[z],[le],[ke]]),ListAccess:[kt([ii,oi(Qn.of([De,I]))])],Integral:Pi([[I,I,Qn.of(ql,{coerceComplexToReal:!1})]])};function Pi(e){return e.map(t=>Ae(t))}function ch(e,t,n){if(t instanceof lo){let r=n.filter(i=>i!==void 0);if(r.length===0)return;let s=jp(r);return j(s)&&s!==pn?Hu([kt({type:"variadic",initial:[],rest:Ve(s)})],n):[]}else if(t instanceof gn||t instanceof Gu||t instanceof Ms){let r=t instanceof Ms?t.args[1]._symbol:t._symbol;if(!r)return;let s=Rf(e,r);return s?Hu(s,n):void 0}else if(t instanceof Fr){let[r,s,i]=n,o=s!==void 0&&i!==void 0?Ha(s,i):void 0;!o&&i===I&&t.args[2]instanceof Et&&t.args[2].isNaN()&&(i=void 0);let a;if(o!==void 0)a=o;else if(s!==void 0)a=s;else if(i!==void 0)a=i;else return;j(a)&&(a=Ve(a));let u=wn(a)?oi(a):a;return Hu([kt([oi(De),u,u])],[n[0],s,i])}else if(e.is3dProduct()&&t instanceof _u){let r=[..._0.DotMultiply,Ae([N,N])];return Hu(r,n)}else if(t instanceof ao){let r=[kt({type:"variadic",initial:[ut],rest:ut}),Ae([I,I])];return e.is3dProduct()&&r.push(Ae([I,I,I])),Hu(r,n)}else if(t instanceof Ru){let r=[kt({type:"variadic",initial:[ut],rest:ut})],s=n.filter(i=>i!==void 0&&i!==I);if(s.length>0){let i=jp(s);j(i)&&i!==pn&&r.push(kt({type:"variadic",initial:[],rest:Ve(i)}))}return Hu(r,n)}else if(t instanceof Ho){let r=t.symbol,s;switch(r){case"x":case"y":s=Pi([[N],[z]]);break;case"z":{s=Pi([[z]]);break}default:{let i=r;throw new Error(`Programming Error: unexpected named coordinate: \'${i}\'.`)}}return Hu(s,n)}else if(t.type in _0&&n.some(r=>r!==void 0)){let r=_0[t.type];return r?Hu(r,n):void 0}}function Hu(e,t){return e.filter(n=>n.matches(t))}function WO(e,t,n,r){if(!JO(e,n,r))return;let s=t.type;switch(s){case"Comparator[\'>\']":case"Comparator[\'<\']":case"Comparator[\'>=\']":case"Comparator[\'<=\']":{e.setWarning(E("shared-calculator-error-complex-operation-undefined",{symbol:X(t.operator)}));break}case"ComparatorChain":{let[i]=t.symbols;if(i===void 0||i==="=")break;e.setWarning(E("shared-calculator-error-complex-operation-undefined",{symbol:X(i)}));break}case"ParenSeq":e.setWarning(E("shared-calculator-error-complex-point-coordinate"));break;case"Integral":switch(QO(e,n,r)){case 0:e.setWarning(E("shared-calculator-error-integral-lower-bound-type-error",{symbol:oe(e.getInstruction(n[0]).valueType)}));break;case 1:e.setWarning(E("shared-calculator-error-integral-upper-bound-type-error",{symbol:oe(e.getInstruction(n[1]).valueType)}));break;default:break}break;case"ListAccess":e.setWarning(E("shared-calculator-error-complex-list-access"));break;case"CrossMultiply":case"DotMultiply":case"Multiply":case"PercentOf":if(n.length!==2)break;e.setWarning(E("shared-calculator-error-multiply-type-error",ZO(e,n)));break;case"Divide":if(n.length!==2)break;e.setWarning(E("shared-calculator-error-divide-type-error",ZO(e,n)));break;case"Sum":case"Product":case"Range":break;case"DotAccess":case"FunctionCall":case"SeededFunctionCall":break;case"Comparator[\'=\']":case"Add":case"Subtract":case"Exponent":case"Negative":case"Or":case"Piecewise":case"Restriction":case"List":case"TableColumnValue":case"Norm":case"BareSeq":case"NamedCoordinateAccess":case"Ans":case"Constant":case"ImaginaryUnit":case"Assignment":case"RecursiveFunctionBaseCase":case"MixedNumber":case"Identifier":case"Construction":case"ListComprehension":case"FunctionExponent":case"FunctionFactorial":case"Prime":case"Derivative":case"UpdateRule":case"Substitution":case"FunctionDefinition":case"Slider":case"RegressionParameter":case"Seed":case"ExtendSeed":break;default:}}function jO(e,t,n,r,s){if(t==="sort"){let i;if(r.length===1)i=r[0];else if(r.length===2)i=r[1];else return;KO(e.getInstruction(i))&&e.setWarning(E("shared-calculator-error-complex-sort",{symbol:X(n)}));return}if(JO(e,r,s))switch(t){case"factorial":case"erf":case"nCr":case"nPr":e.setWarning(E("shared-calculator-error-complex-operation-unimplemented",{symbol:X(n)}));break;case"round":e.setWarning(E("shared-calculator-error-complex-round",{symbol:X(n)}));break;default:e.setWarning(E("shared-calculator-error-complex-operation-undefined",{symbol:X(n)}));break}}function JO(e,t,n){return QO(e,t,n)!==-1}function QO(e,t,n){if(n.length===0)return-1;let r=n[0];for(let s=0;s<t.length;s++){let i=t[s],o=r.argTypeAtIndex(s);if(!(o===I||o===ne||typeof o=="object"&&o.coerceComplexToReal))continue;let u=e.getInstruction(i);if(KO(u))return s}return-1}function KO(e){if(e.type!==1)return!1;switch(e.valueType){case R:return V(e.value[1])!==0;case Ue:return e.value.some(t=>V(t[1])!==0);default:return!1}}function ZO(e,t){let n=e.getInstruction(t[0]),r=e.getInstruction(t[1]);return{symbol1:oe(n.valueType),symbol2:oe(r.valueType)}}function tN(e,t,n,r,s,i){var x,T,b,M;if(n=_g(t,n),!el(n)&&!Tp(n)||kf(n))return;let o,a=!1,u=!1,c=0,l=[],p=[],f=s.map(P=>e.getInstruction(P).valueType),d=el(n)?Fo[n]:void 0;if(d&&(a=d.isSeeded,o=void 0,l.push(...d.getSignatures(t)),c=(T=(x=d.defaultArguments)==null?void 0:x.length)!=null?T:0,p=lh(l,f,c),u=d.allowDotCall),p.length===0&&(d!=null&&d.fallthroughUnlessDistribution)&&f.length>0&&se(f[0],Lt))l=l.filter(P=>{let D=P.argTypeAtIndex(0);return D===void 0?!1:Mc(Lt,D)}),p=[];else if(Tp(n)&&p.length===0){let P=Bn[n];o=P.tag,l.push(...l0(n)),c=(M=(b=P.defaultArguments)==null?void 0:b.length)!=null?M:0,p=lh(l,f,c),u=u||P.allowDotCall}let y=Math.min(...l.map(P=>P.minArity)),g=Math.max(...l.map(P=>{var D;return(D=P.maxArity)!=null?D:1/0})),m=s,h=s;if(a&&(h=m=s.slice(1),y-=1,g-=1),i){if(!u)throw Gd(r);let P=e.getInstruction(m[0]).valueType;if(!j(P)&&P!==wt&&P!==ke&&P!==Lt&&P!==Pn&&(P===N||!vd(P))&&n!=="real"&&n!=="imag")throw tT(r,oe(P),{blockExport:e.areAllArgsConstant([m[0]])});r="."+r,h=m.slice(1),y-=1,g-=1}if((t.isGeometryEnabled()||t.is3dPolicy())&&n==="length"&&h.length===1&&j(e.getInstruction(h[0]).valueType)){let P=t.is3dPolicy()?eT:Kx;if(p.length===0)throw P(r,Pa(e,h)[0],{blockExport:e.areAllArgsConstant(h)});if(h.length===1&&e.getInstruction(h[0]).valueType===$e)throw P(r,Pa(e,h)[0],{blockExport:e.areAllArgsConstant(h)})}if(p.length>0){jO(e,n,r,s,p);return}throw L0(e,{symbol:n,errorSymbol:r,providedArgs:h,argsWithoutSeed:m,isDotCall:i,minArity:y,maxArity:g,defaultArgumentCount:c,builtInTag:o,signatures:l})}function L0(e,{symbol:t,errorSymbol:n,providedArgs:r,argsWithoutSeed:s,isDotCall:i,minArity:o,maxArity:a,defaultArgumentCount:u,builtInTag:c,signatures:l}){if(c==="doubleReducer"&&r.length===2){if(!j(e.getInstruction(r[0]).valueType)||!j(e.getInstruction(r[1]).valueType))throw jd(t,{blockExport:e.areAllArgsConstant(r)})}else if(c==="parameterizedReducer"&&!i&&r.length===2&&!j(e.getInstruction(r[0]).valueType))throw rP(t,{blockExport:e.areAllArgsConstant([r[0]])});if(t==="logbase"&&r.length!==2)return Ao("log",1,r.length-1,{includeUsageExample:!0});if(t==="random")return $T();if(r.length<o||r.length>a){let{dotMinArityExampleArgs:g,dotMaxArityExampleArgs:m,minArityExampleArgs:h,maxArityExampleArgs:x}=aH(t),T,b;if(r.length<o?(b=o-u,i&&g?T=n+g:h&&(T=n+h)):(b=a,i&&m?T=n+m:x&&(T=n+x)),i&&(c==="parameterizedReducer"||t==="pdf"||t==="cdf"))return Ao(n,b,r.length,{includeUsageExample:!0,usageExample:T});if(c==="reducer"&&r.length===0)return jT(n);if(c==="doubleReducer")return qd(n);if(c==="parameterizedReducer")return WT(n);if(c==="color")return XT(n);if(el(t))switch(t){case"pdf":return HT();case"cdf":return r.length<o?zT():UT();case"tdist":return qT();case"length":case"round":case"floor":case"ceil":case"abs":case"sign":case"mod":case"gcd":case"lcm":case"min":case"max":case"midpoint":case"segment":case"vector":case"sphere":case"distance":case"circle":case"center":case"radius":case"glider":case"intersection":case"strictintersection":case"parallel":case"perpendicular":case"anglebisector":case"start":case"end":case"angle":case"directedangle":case"angles":case"directedangles":case"apply":case"translate":case"reflect":case"dilate":case"rotate":case"normaldist":case"poissondist":case"binomialdist":case"uniformdist":case"total":case"mean":case"median":case"stdev":case"stdevp":case"var":case"varp":case"covp":case"cov":case"corr":case"mad":case"quantile":case"sort":case"shuffle":case"join":case"unique":case"polygon":case"coterminal":case"real":case"imag":case"conj":case"exp":case"sin":case"cos":case"tan":case"sinh":case"cosh":case"tanh":case"sec":case"csc":case"cot":case"sech":case"csch":case"coth":case"arccot":case"arcsinh":case"arccsch":case"arctan":case"nthroot":case"complexNthRoot":return eN(n,b,l,r.map(P=>e.getInstruction(P).valueType),T);case"points":case"lines":case"circles":case"polygons":case"rays":case"vectors":case"arcs":throw ks(n);case"histogram":case"dotplot":case"boxplot":case"ttest":case"ittest":case"stats":case"det":case"inv":case"transpose":case"rref":case"trace":throw U(`Unexpected arity error for ${t}`);default:let M=t;throw new Error(`Unexpected compiler function ${M}`)}return eN(n,b,l,r.map(M=>e.getInstruction(M).valueType),T)}if(t==="polygon"&&r.length===2&&e.getInstruction(r[0]).valueType===I&&e.getInstruction(r[1]).valueType===I)return Ud();let p=[],f=[];for(let g=0;g<s.length;g++){let m=s[g],h=c!==void 0&&c!=="doubleReducer"&&c!=="never-broadcast"&&!(c==="parameterizedReducer"&&g===0)&&t!=="polygon",x=e.getInstruction(m).valueType;j(x)&&h&&(x=Ve(x)),p.push(x),f.push(oe(x))}let d=e.areAllArgsConstant(s),y=nN(t);if(y&&!rN(t,l,p)){let g=new v(y);return d?g:g.allowExport()}return Hs(n,f,{blockExport:d})}function eN(e,t,n,r,s){let i=nN(e);return i&&!rN(e,n,r)?new v(i):Ao(e,t,r.length,{includeUsageExample:!i,usageExample:s})}function aH(e){return el(e)?Fo[e]:Tp(e)?Bn[e]:{}}function lh(e,t,n){return e.filter(r=>r.matches(t)&&t.length+n>=r.minArity)}function nN(e){switch(e){case"midpoint":return E("shared-calculator-error-required-arguments-midpoint");case"intersection":return E("shared-calculator-error-required-arguments-intersection");case"segment":case"line":case"ray":case"distance":return E("shared-calculator-error-required-arguments-points",{symbol:e,count:2});case"parallel":case"perpendicular":return E("shared-calculator-error-required-arguments-perpendicular",{symbol:e});case"circle":return E("shared-calculator-error-required-arguments-circle");case"arc":case"angle":case"directedangle":return E("shared-calculator-error-required-arguments-points",{symbol:e,count:3});case"triangle":return E("shared-calculator-error-required-arguments-triangle");case"polygon":return E("shared-calculator-error-required-arguments-polygon");case"glider":return E("shared-calculator-error-required-arguments-glider");case"vector":return E("shared-calculator-error-required-arguments-vector");case"length":return E("shared-calculator-error-required-arguments-length");case"area":case"perimeter":case"vertices":case"angles":case"directedangles":case"segments":return E("shared-calculator-error-required-arguments-area",{symbol:e});case"radius":case"center":return E("shared-calculator-error-required-arguments-radius",{symbol:e});case"anglebisector":case"coterminal":return E("shared-calculator-error-required-arguments-coterminal",{symbol:e});case"supplement":return E("shared-calculator-error-required-arguments-supplement");case"start":case"end":return E("shared-calculator-error-required-arguments-start",{symbol:e});case"dilate":case"rotate":return E("shared-calculator-error-required-arguments-dilate",{symbol:e});case"reflect":return E("shared-calculator-error-required-arguments-reflect");case"translate":return E("shared-calculator-error-required-arguments-translate");case"sphere":return E("shared-calculator-error-required-arguments-sphere")}}function rN(e,t,n){return e==="polygon"&&(t=t.filter(s=>s.maxArity!==1)),t.some(s=>s.maxArity===0||n.length<s.minArity?!1:n.every((i,o)=>{let a=s.argTypeAtIndex(o);return a===void 0?!0:ny(i,a)}))}function Pa(e,t){let n=[];for(let r of t)n.push(oe(e.getInstruction(r).valueType));return n}function zu(e,t){let n=[];for(let r of t){let s=e.getInstruction(r).valueType,i=j(s)?Ve(s):s;n.push(oe(i))}return n}function gt(e,t,n){return se(e.getInstruction(t).valueType,n)}function Uo(e,t,n,r){var l,p;let s=n.type;if(s==="FunctionCall"||s==="SeededFunctionCall"||s==="DotAccess"){let f,d;if(n instanceof Ms&&(n.args[1]instanceof we||n.args[1]instanceof gn))f=n.args[1]._symbol,d=(l=n.args[1]._errorSymbol)!=null?l:f;else if(n instanceof gn||n instanceof Gu)f=n._symbol,d=(p=n._errorSymbol)!=null?p:f;else return;if(f==="polygon"&&t.polygonUnsupportedPreferTriangle())throw ky();if(f==="length"&&!t.isGeometryEnabled()&&!t.is3dPolicy()&&r.length===0)throw ZT();tN(e,t,f,d,r,n instanceof Ms);return}let i=r.map(f=>e.getInstruction(f).valueType),o=ch(t,n,i);if(!o)return;let a=Math.min(...o.map(f=>f.minArity));if(o.length>0&&r.length>=a){WO(e,n,r,o);return}let u=uH(s,i,{specifyPointDimensions:n instanceof Ho&&n.symbol==="z"}),c=e.areAllArgsConstant(r);switch(s){case"Add":throw Fx(u,{blockExport:c});case"Subtract":throw Vx(u,{blockExport:c});case"CrossMultiply":throw t.is3dProduct()&&i.length===2&&(se(i[0],N)&&se(i[1],N)||se(i[0],I)&&se(i[1],z)||se(i[0],z)&&se(i[1],I))?Bx(u,{blockExport:c}):Vd(u,{blockExport:c});case"DotMultiply":throw Vd(u,{blockExport:c});case"Multiply":{if(t.is3dProduct()&&i.length===2){if(se(i[0],z)&&se(i[1],z))throw kx(u,{blockExport:c});if(se(i[0],N)&&se(i[1],N))throw Gx(u,{blockExport:c})}throw Vd(u,{blockExport:c})}case"Divide":throw Hx(u,{blockExport:c});case"Exponent":throw zx(u,{blockExport:c});case"Negative":throw Ux(u,{blockExport:c});case"Comparator[\'=\']":case"Comparator[\'>\']":case"Comparator[\'<\']":case"Comparator[\'>=\']":case"Comparator[\'<=\']":case"ComparatorChain":throw Yx(u,{blockExport:c});case"Or":throw Zx(u,{blockExport:c});case"Piecewise":throw se(i[0],De)?gT([oe(e.getInstruction(r[1]).valueType),oe(e.getInstruction(r[2]).valueType)],{blockExport:e.areAllArgsConstant([r[1],r[2]])}):fy(u,{blockExport:e.areAllArgsConstant([r[0]])});case"Restriction":throw fy(u,{blockExport:c});case"List":case"TableColumnValue":{sN(e,r);break}case"ListAccess":throw Bd(u,{blockExport:c});case"Norm":throw Hs("abs",u,{blockExport:c});case"ParenSeq":{let f=i.indexOf(ut)!==-1,d=i.some(g=>g!==ut);if(f&&d)throw yy([oe(i[0]),oe(i[1])],{blockExport:c});if(i.length!==2&&(!t.is3dProduct()||i.length!==3)){let g=t.is3dPolicy()?3:2;throw KT(g)}let y=i.find(g=>!se(g,I));throw y!==void 0?Wx(oe(y),{blockExport:c}):U("Unexpected error type checking ParenSeq")}case"BareSeq":{if(i.length===0)throw Yd();if(i.length===1)throw U("Length-1 BareSeq is impossible");let f=i[0],d=i.find(y=>y!==f);if(d)throw yy([oe(f),oe(d)],{blockExport:c});if(f===I)throw r.length===2?JT():QT();sN(e,r);break}case"NamedCoordinateAccess":throw jx(u,"."+n.symbol,{blockExport:c});case"Integral":{let[f,d,y]=i,g=j(f)?Ve(f):f,m=j(d)?Ve(d):d;throw kn(g,I)?kn(m,I)?pT([oe(y)],{blockExport:c}):lT([oe(d)],{blockExport:c}):cT([oe(f)],{blockExport:c})}case"Ans":case"Constant":case"ImaginaryUnit":case"Assignment":case"RecursiveFunctionBaseCase":case"MixedNumber":case"Identifier":case"Construction":case"Range":case"Sum":case"Product":case"ListComprehension":case"FunctionExponent":case"FunctionFactorial":case"Prime":case"Derivative":case"UpdateRule":case"Substitution":case"FunctionDefinition":case"Slider":case"RegressionParameter":case"Seed":case"ExtendSeed":case"PercentOf":return;default:{let f=s;throw new Error(`Unexpected node type: ${f}`)}}}function sN(e,t){if(t.length===0)return;let n=e.getInstruction(t[0]).valueType;if(!wn(n))throw vc([oe(n)],{blockExport:Je(e.getInstruction(t[0]))});let r=e.areAllArgsConstant(t);for(let s of t){let i=e.getInstruction(s).valueType;if(!wn(i))throw vc([oe(i)],{blockExport:r});if(i!==n)throw Hd({blockExport:r})}}function uH(e,t,n){switch(e){case"Add":case"Subtract":case"Multiply":case"Divide":case"Exponent":case"Negative":case"Comparator[\'<\']":case"Comparator[\'>\']":case"Comparator[\'=\']":case"Comparator[\'<=\']":case"Comparator[\'>=\']":case"NamedCoordinateAccess":return t.map(r=>oe(r,n));case"ComparatorChain":{for(let r=0;r<t.length;r++)if(!kn(t[r],I)&&!kn(t[r],ne))return r===0?[oe(t[r]),oe(t[r+1])]:[oe(t[r-1]),oe(t[r])];return t.map(r=>oe(r))}case"ListAccess":case"Constant":case"ImaginaryUnit":case"MixedNumber":case"Identifier":case"Ans":case"List":case"TableColumnValue":case"Range":case"Construction":case"ParenSeq":case"BareSeq":case"Norm":case"Sum":case"Product":case"Integral":case"ListComprehension":case"FunctionExponent":case"FunctionFactorial":case"Prime":case"Piecewise":case"Restriction":case"Derivative":case"UpdateRule":case"Substitution":case"Assignment":case"RecursiveFunctionBaseCase":case"FunctionDefinition":case"Slider":case"RegressionParameter":case"Seed":case"ExtendSeed":case"DotMultiply":case"CrossMultiply":case"Or":case"PercentOf":return t.map(r=>oe(r));default:{let r=e;throw new Error(`Unexpected node type: ${r}`)}}}function iN(e,t){let n=e.getInstruction(t);if(ge(n))return;let r=kt(w0(e,n).expectedTypes);if(n.type===49){for(let u of n.args){let c=e.getInstruction(u).valueType;if(!se(c,I)&&!se(c,R)&&!se(c,N)&&!se(c,z)&&!se(c,Kt)&&!se(c,xe)&&!se(c,de)&&!se(c,fe)&&!se(c,Ne)&&!se(c,le)&&!se(c,ce)&&!se(c,ie)&&!se(c,Le)&&!se(c,Pn)&&!se(c,ye))throw ET(oe(c))}let a={};for(let u of n.symbols){if(a[u])throw CT(u);a[u]=!0}return}let s=[];for(let a=0;a<n.args.length;a++){let u=e.getInstruction(n.args[a]).valueType,c=r.argTypeAtIndex(a);(c===void 0||!Mc(u,c))&&s.push(n.args[a])}if(s.length===0)return;let i=Pa(e,n.args),o=e.areAllArgsConstant(n.args);switch(n.type){case 32:throw Xx(i,{blockExport:o});case 22:case 21:case 44:case 31:case 15:case 16:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 25:case 26:case 27:case 28:case 29:case 38:case 39:case 40:case 41:case 37:case 42:case 33:case 48:case 47:case 23:case 24:case 19:case 20:case 50:case 51:case 53:case 54:case 55:throw U(`Invalid argument types for opcode ${n.type}`);default:{let a=n;throw new Error(`Unexpected opcode: ${a.type}`)}}}function w0(e,t,n=!1){switch(t.type){case 8:case 9:case 10:case 11:return n&&t.args.length>0&&e.getInstruction(t.args[0]).valueType===N?{expectedTypes:[N,N]}:{expectedTypes:[I,I]};case 12:case 13:case 25:case 26:case 27:case 28:case 29:return{expectedTypes:[I,I]};case 14:return{expectedTypes:[I]};case 31:return{expectedTypes:[De,De]};case 32:return{expectedTypes:[De,De]};case 33:return{expectedTypes:[De,t.valueType,t.valueType]};case 15:return{expectedTypes:zl[t.valueType]};case 21:return{expectedTypes:[I,I]};case 22:{let r=e.getInstruction(t.args[1]).valueType;return $l(r)?{expectedTypes:[I,r]}:{expectedTypes:[I,I]}}case 38:{let r=t.valueType,s=Ve(r);return{expectedTypes:{type:"variadic",initial:[],rest:s}}}case 39:case 40:case 41:return{expectedTypes:[pn,I]};case 37:{let r=t.symbol,s=Bn[r],i=s.argumentTypes;return s.tag==="reducer"&&!cH(e,t.args)&&Array.isArray(i)&&typeof i[0]=="number"&&j(i[0])?{isReducerWithNoListArgs:!0,expectedTypes:{type:"variadic",initial:[],rest:Ve(i[0])}}:{expectedTypes:i}}case 44:{let r=e.getInstruction(t.args[1]).valueType;return{expectedTypes:[ft,r]}}case 47:return{expectedTypes:t.args.map(r=>e.getInstruction(r).valueType)};case 23:return{expectedTypes:[I]};case 19:return{expectedTypes:t.args.map(r=>{let s=e.getInstruction(r).valueType;return s===De||(t.callData.type==="sum"?$l(s):bx(s))?s:I})};case 50:{let r=t.callData.parameterSymbols.length,s=[];for(let i=0;i<r;i++)s.push(I,I);return{expectedTypes:s}}case 24:case 20:case 51:{let r=[I];for(let s=1;s<t.args.length;s++)r.push(e.getInstruction(t.args[s]).valueType);return{expectedTypes:r}}case 42:return{expectedTypes:t.args.map(()=>I)};case 48:case 49:return{expectedTypes:t.args.map(r=>e.getInstruction(r).valueType)};case 53:return{expectedTypes:[t.valueType]};case 54:return{expectedTypes:t.args.map(r=>e.getInstruction(r).valueType)};case 55:return{expectedTypes:t.args.map(r=>e.getInstruction(r).valueType)};case 16:return{expectedTypes:[hx]};default:{let r=t;throw new Error(`Unexpected opcode: ${r.type}`)}}}function cH(e,t){for(let n of t)if(j(e.getInstruction(n).valueType))return!0;return!1}function oN(e){let t=e.getReturnIndex(),n=e.getInstruction(t);if(ge(n))return t;let r=w0(e,n),s=kt(r.expectedTypes),i=F0(e,n.args,[s]);if(r.isReducerWithNoListArgs){let o=pH(e,i.didCoerce?i.args:n.args),a=vn(r.expectedTypes.rest);if(_i(o,a)){i.didCoerce?e.replaceInstructionWithNoop(t):e.popInstruction();let u=e.List(n.args);return e.copyInstructionWithArgs(n,[u])}}else i.didCoerce&&(e.replaceInstructionWithNoop(t),e.copyInstructionWithArgs(n,i.args));return e.getReturnIndex()}function F0(e,t,n){let r=!1,s=[];for(let i=0;i<t.length;i++){let o=Ad(n,i),a=t[i],u=e.getInstruction(a).valueType,c=a;o.every(l=>!_i(u,l))&&(se(o[0],I)?c=zi(e,a):se(o[0],R)&&(c=lH(e,a))),c!==a&&(r=!0),s.push(c)}return r?{didCoerce:r,args:s}:{didCoerce:!1}}function zi(e,t,n={}){var s;let r=e.getInstruction(t);return r.valueType===$e?t:se(r.valueType,Le)?uN(e,t):se(r.valueType,ye)?aN(e,t):se(r.valueType,Gt)?e.Piecewise([e.NativeFunction("restrictionToBoolean",[t]),e.Constant(1),e.Constant(NaN)]):se(r.valueType,R)?(s=n.peelableCoerce)!=null&&s?e.NativeFunction("peelableCoerceComplexToReal",[t]):e.NativeFunction("coerceComplexToReal",[t]):t}function fl(e,t){let n=e.getInstruction(t);return n.valueType===$e||se(n.valueType,R)?t:zi(e,t)}function lH(e,t){let n=e.getInstruction(t);if(n.valueType===$e)return t;if(se(n.valueType,I))return e.NativeFunction("coerceRealToComplex",[t]);if(se(n.valueType,R))return t;if(kn(n.valueType,I)||kn(n.valueType,ne)){let r=zi(e,t);return e.NativeFunction("coerceRealToComplex",[r])}return t}function pH(e,t){let n=e.getInstruction(t[0]).valueType;if(!wn(n))return pn;for(let r of t)if(e.getInstruction(r).valueType!==n)return pn;return vn(n)}function ph(e,t,n){let r=e.getInstruction(n);if(!ge(r)){for(let o of r.args)if(!Je(e.getInstruction(o)))return!0}if(t<n)return!Je(e.getInstruction(t));let s=[!0];for(let o=n+1;o<=t;o++)s.push(!1);let i=[t];for(;i.length;){let o=i.pop();if(s[o-n])continue;s[o-n]=!0;let a=e.getInstruction(o);if(!ge(a))for(let u of a.args){let c=e.getInstruction(u);if(u<n){let l=e.getInstruction(u);if(l.type===4)continue;if(!Je(l))return!0}else{if(e.getInstruction(u).type===50)return!0;if(c.type===3)return!0;s[u-n]||i.push(u)}}}return!1}function qo(e,t,n){let r=qn(e,t);if(r===void 0)throw new Error(`${n}\nNon-constant instruction: "${al(e,ur(e,t))}"`);return r}function qn(e,t){let n=ml(e,t,void 0,void 0);if(!(n<0))return n}function ml(e,t,n,r){var a;let s=n&&n[t];if(s)return s;let i=e.getInstruction(t),o;switch(i.type){case 38:o=i.args.length;break;case 1:o=i.value.length;break;case 48:{o=(a=i.constantLength)!=null?a:-1;break}}return o===void 0&&(n=n||{},o=dH(e,i,n,r||new Set)),n&&(n[t]=o),o}function dH(e,t,n,r){switch(t.type){case 33:{let s=ml(e,t.args[1],n,r),i=ml(e,t.args[2],n,r);return s===i?s:-1}case 37:switch(t.symbol){case"elementsAt":return ml(e,t.args[1],n,r);case"sortPerm":case"complexSortPerm":return ml(e,t.args[0],n,r);case"shuffle":return ml(e,t.args[1],n,r);default:return-1}case 55:{if(r&&r.has(t.args[0]))return-1;r.add(t.args[0]);let s=e.dereferenceFunctionHeader(t.args[0]);if(s!==void 0){let i=e.getInstruction(s);return ml(e,i.args[1],n,r)}return-1}default:{if(j(t.valueType))return-1;throw new Error(`Programming Error: cannot find the list length of ${ts(t.type)} ${oe(t.valueType)}.`)}}}function ur(e,t){let n=e.getInstruction(t);if(!j(n.valueType))throw new Error(`Programming Error: cannot find the list length of ${e.printInstruction(t)}`);switch(n.type){case 38:return e.Constant(n.args.length);case 1:return e.Constant(n.value.length);case 48:{let r=e.getInstruction(n.args[0]);return e.getInstruction(r.args[0]).args[0]}case 37:switch(n.symbol){case"elementsAt":return ur(e,n.args[1]);case"sortPerm":case"complexSortPerm":return ur(e,n.args[0]);case"shuffle":return ur(e,n.args[1])}}return e.NativeFunction("count",[t])}function Jp(e,t){let n=[];for(let o of t)j(e.getInstruction(o).valueType)&&n.push(o);if(n.length===0)return;if(n.length===1)return ur(e,n[0]);let r=[];for(let o of n)r.push(qn(e,o));let s,i=1/0;for(let o=0;o<r.length;o++){let a=n[o],u=r[o];if(u===void 0)return e.NativeFunction("listMin",[e.List(n.map(c=>ur(e,c)))]);u<i&&(s=a,i=u)}return s!==void 0?ur(e,s):e.Constant(i)}function zf(e,t,n){let r=e.getInstruction(t);if(j(r.valueType)){let s=qn(e,t);if(n=Math.floor(n),isNaN(n)||n<0||s!==void 0&&n>=s){let i=Ve(r.valueType);return e.NanOfType(i)}return r.type===38?r.args[n]:r.type===1&&j(r.valueType)?e.ConstantOfType(Ve(r.valueType),r.value[n]):s!==void 0?e.InboundsListAccess([t,e.Constant(n+1)]):e.ListAccess([t,e.Constant(n+1)])}else throw new Error(`Cannot access elements of ${oe(r.valueType)}`)}function dh(e,t,n){let r=e.getInstruction(t);if(n.length===0)return e.ConstantOfType(r.valueType,[]);if(r.type===1&&j(r.valueType)){let s=[],i=Ve(r.valueType);for(let o of n){let a=Math.floor(o);isNaN(a)||a<0||a>=qo(e,t,"Programming error: expected Constant list instruction to have constant length.")?s.push(ls(i)):s.push(r.value[a])}return e.ConstantOfType(r.valueType,s)}else if(r.type===38){let s=[];for(let i of n){let o=Math.floor(i);if(isNaN(o)||o<0||o>=qo(e,t,"Programming error: expected List instruction to have constant length.")){let a=Ve(r.valueType);s.push(e.NanOfType(a))}else s.push(r.args[o])}return e.List(s)}else{let s=[],i=!0,o=qn(e,t);for(let u of n){let c=Math.floor(u);s.push(e.Constant(c+1)),(isNaN(c)||c<0||o===void 0||c>=o)&&(i=!1)}let a=[t,e.List(s)];return i?e.InboundsListAccess(a):e.ListAccess(a)}}function Gr(e,t){let n=e.getInstruction(t);if(n.type!==48)return t;let r=n.args[0],s=e.getInstruction(r),i=s.args[0],o=!1;for(let u=i+1;u<r;u++){let c=e.getInstruction(u);if(c.type===40&&c.args[1]===i){o=!0;break}}if(!o)return t;let a=[];for(let u=i;u<=r+s.args.length-1;u++){let c=e.getInstruction(u);if(ge(c))a.push(e.copyInstruction(c));else{let l=[];for(let p of c.args)l.push(p>=i?a[p-i]:p);c.type===40?a.push(e.InboundsListAccess(l)):a.push(e.copyInstructionWithArgs(c,l))}}return e.getReturnIndex()}function V0(e,t){return!an(e)&&isNaN(e)||!an(t)&&isNaN(t)?[NaN,NaN]:[e,t]}function fh(e){return zt(V(e[0]),V(e[1]))}function cN([e,t]){return an(e)&&an(t)}function lN(e,t){if(!cN(e)||!cN(t))return Du(fh(e),fh(t));let[n,r]=e,[s,i]=t,o=qs(wr(s,s),wr(i,i)),a=qs(wr(n,s),wr(r,i)),u=ai(wr(r,s),wr(n,i)),c=Ps(a,o),l=Ps(u,o);return!an(c)||!an(l)?Du(fh(e),fh(t)):V0(c,l)}function B0(e,t,n){let r;return mh(t)?r=k0(t,n):r=dN(t,n),e.ConstantOfType(t,r)}function G0(e){return mh(e)||pN(e)}function mh(e){switch(e){case $e:case ne:case Xn:case Ue:case Gs:case Pt:case xn:case Wn:case Fn:case Vn:case Jn:case jn:case In:case On:case Nn:case fr:case gr:case yr:case Ar:case mr:case rr:case cs:case Rr:return!0;default:return!1}}function pN(e){switch(e){case I:case De:case R:case Gt:case N:case de:case ce:case ie:case Ne:case le:case fe:case xe:case Le:case ye:case z:case ke:case Rn:case Hn:case wt:case Kt:case Pn:case Re:case ut:case ft:return!0;default:return!1}}function k0(e,t){if(e===$e)return[];let n=Ve(e);if(!pN(n))throw new Error(`Programming error: unexpected element type ${at(n)} for list type ${at(e)}.`);let r=[];for(let s=0;s<t.length;s++){let i=dN(n,t[s]);r.push(i)}return r}function dN(e,t){if(e===I)return Se(t,1);if(e===N||e===R){let[n,r]=t;return[Se(n,1),Se(r,1)]}else if(e===z){let[n,r,s]=t;return[Se(n,1),Se(r,1),Se(s,1)]}else return t}function H0(e,t){return qs(e,t)}function z0(e,t){return ai(e,t)}function U0(e,t){return wr(e,t)}function q0(e,t){return Ps(e,t)}function Uf(e,t){return V(e)===Math.E?Math.exp(V(t)):Zv(e,t)}var mH=Uf;function $0(e){return Us(e)}function yH(e,t){return t[e]}function Y0(e,t){return V(e)===V(t)}function X0(e,t){return V(e)<V(t)}function Z0(e,t){return V(e)>V(t)}function W0(e,t){return V(e)<=V(t)}function j0(e,t){return V(e)>=V(t)}function mN(e,t){return e||t}function yN(e,t){return e&&t}function gH(e,t,n){let r=Math.floor(V(n))-1;return!isFinite(r)||r<0||r>=t.length?ls(e):t[r]}function J0(e,t,n,r){an(r)&&(r=V(r));let s=n===I||n===ft?r:LE(n,r);return`${t}::${e}${s}`}function Q0(e,t){switch(e){case"mod":return jv(t[0],t[1]);case"abs":return Yv(t[0]);case"sqrt":return Wv(t[0]);case"total":return Jv(t[0]);case"count":return t[0].length;case"validateRangeLength":{let n=t[0],r=t[1],s=t[2],i=t[3],o=zE(n,r,s,i);if(o===0)throw Jd();return o}case"validateSampleCount":{let n=Vo(t[0]),r=UE(n);if(r===0&&n!==0)throw IP();return r}case"select":case"elementsAt":case"uniquePerm":{let n=Bn[e];return Gi[n.symbol].apply(null,t)}case"complex":return V0(t[0],t[1]);case"complexDivide":return lN(t[0],t[1]);default:{let n=Bn[e];return(n.module==="Math"?Math:Gi)[n.symbol].apply(null,Vo(t))}}}function gN(e,t){let n=Array(t+1);return St(e,t,n)}function hN(e,t,n){let r=Array(t+1);for(let s=0;s<n.length;s++)r[s]=n[s];return St(e,t,r)}function bN(e,t,n){if(t.constantLength)return t.constantLength;let r=t.args[0],i=e.getInstruction(r).args[0],o=e.getInstruction(i);return V(St(e,o.args[0],n))}function xN(e,t,n,r){let s=e.getInstruction(t),i=bN(e,s,r);if(!isFinite(n)||n<0||n>=i)return ls(Ve(s.valueType));let o=s.args[0],a=t-o,u=e.getInstruction(o),c=u.args[0],l=u.args[a];r[c]=n+1;let p=St(e,l,r);for(let f=c;f<=o;f++)r[f]=void 0;return p}function hH(e,t,n){let r=e.getInstruction(t),s=r.args[0],i=e.getInstruction(s).args[0];if(xH(e,i+1,s-1)&&mh(r.valueType)){let u=e.copy(),c=Qp(u);return k0(r.valueType,c)}let o=bN(e,r,n),a=[];for(let u=o-1;u>=0;u--)a[u]=xN(e,t,u,n);return a}function TN(e,t,n){let r=St(e,t.args[1],n),s=t.args[0],i=e.getInstruction(s);if(i.type===48)return xN(e,s,V(r)-1,n);if(i.type===33){let o=St(e,i.args[0],n);return TN(e,{...t,args:[o?i.args[1]:i.args[2],t.args[1]]},n)}else{let o=St(e,t.args[0],n);return gH(t.valueType,o,r)}}function St(e,t,n){let r=n[t];if(r!==void 0)return r;let s=bH(e,t,n);return typeof s=="number"&&s===Math.floor(s)&&(s=Se(s,1)),n[t]=s,s}function bH(e,t,n){let r=e.getInstruction(t);switch(r.type){case 1:return r.value;case 8:return H0(St(e,r.args[0],n),St(e,r.args[1],n));case 9:return z0(St(e,r.args[0],n),St(e,r.args[1],n));case 10:return U0(St(e,r.args[0],n),St(e,r.args[1],n));case 11:return q0(St(e,r.args[0],n),St(e,r.args[1],n));case 12:return Uf(St(e,r.args[0],n),St(e,r.args[1],n));case 13:return mH(St(e,r.args[0],n),St(e,r.args[1],n));case 14:return $0(St(e,r.args[0],n));case 15:return r.args.map(i=>St(e,i,n));case 16:return yH(r.index,St(e,r.args[0],n));case 25:return Y0(St(e,r.args[0],n),St(e,r.args[1],n));case 26:return X0(St(e,r.args[0],n),St(e,r.args[1],n));case 27:return Z0(St(e,r.args[0],n),St(e,r.args[1],n));case 28:return W0(St(e,r.args[0],n),St(e,r.args[1],n));case 29:return j0(St(e,r.args[0],n),St(e,r.args[1],n));case 31:return St(e,r.args[0],n)||St(e,r.args[1],n);case 32:return St(e,r.args[0],n)&&St(e,r.args[1],n);case 44:return J0(r.tag,St(e,r.args[0],n),e.getInstruction(r.args[1]).valueType,St(e,r.args[1],n));case 33:return St(e,r.args[0],n)?St(e,r.args[1],n):St(e,r.args[2],n);case 37:{let i=[];for(let o of r.args)i.push(St(e,o,n));return Q0(r.symbol,i)}case 38:{let i=[];for(let o of r.args)i.push(St(e,o,n));return i}case 39:case 40:case 41:return TN(e,r,n);case 48:return hH(e,t,n);case 47:{let i=r.args[0],o=t-i,u=e.getInstruction(i).args[o],c=fN(e,{endIndex:i,returnIndex:u,resultIndex:t},n);return Qp(c)}case 55:{let i=r.args[0],a=e.getInstruction(i).endIndex,c=e.getInstruction(a).args[0],l=fN(e,{endIndex:a,returnIndex:c,resultIndex:t},n);return Qp(l)}case 19:case 20:case 21:case 22:case 23:case 24:case 42:case 0:case 2:case 3:case 49:case 50:case 51:case 4:case 53:case 54:throw new Error(`Programming Error: cannot interpret opcode ${r.type}`);default:let s=r;throw new Error(`Programming Error: unexpected opcode ${s.type}`)}}function fN(e,t,n){let r=t.endIndex,s=t.returnIndex,i=t.resultIndex,o=e.getInstruction(r).args[0],a=[];a[s]=!0;let u=s;e.getInstruction(i).type===55&&(a[i]=!0,u=i);for(let d=u;d>=o;d--){if(!a[d])continue;let y=e.getInstruction(d);if(!ge(y))for(let g of y.args)g<o||g>r?St(e,g,n):a[g]=!0}let l=e.copy();l.unsafelyTruncate(o);for(let d=0;d<o;d++){let y=n[d],g=e.getInstruction(d);if(y!==void 0){let m=g.valueType;l.replaceInstructionWithConstant(d,{type:1,valueType:m,value:y})}}l.reopenAllBlocks();let p=[];for(let d=o;d<i;d++){let y=e.getInstruction(d);if(ge(y))p.push(l.copyInstruction(y));else{let g=[];for(let m of y.args)g.push(m<o?m:p[m-o]);y.type===40?p.push(l.InboundsListAccess(g)):p.push(l.copyInstructionWithArgs(y,g))}}l.Noop();let f=e.getInstruction(i);if(f.type===47)l.replaceInstructionWithBlockVarOrFunctionCall(l.getReturnIndex(),{type:47,valueType:f.valueType,args:[r<o?r:p[r-o]]});else if(f.type===55)l.replaceInstructionWithBlockVarOrFunctionCall(l.getReturnIndex(),{type:55,valueType:f.valueType,args:f.args.map(d=>d<o?d:p[d-o])});else throw new Error(`Programming error: unexpected opcode ${ts(f.type)}`);return l}function xH(e,t,n){let r=[];for(let i=0;i<=t;i++)r.push(!1);let s=[];for(let i=t+1;i<=n;i++)s.push(i);for(;s.length;){let i=s.pop();if(r[i])continue;r[i]=!0;let o=e.getInstruction(i);if(o.type===55)return!0;if(!ge(o))for(let a of o.args)r[a]||s.push(a)}return!1}function Qp(e){let t=e.getCompiledFunction();return t.executionMetadata.recursiveFunctionCache=new up,t.executionMetadata.iterativeRecursionOutputs={},t.fn()}function PN(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error("Programming Error: only the final instruction in a chunk can be constant collapsed");let t=e.getInstruction(e.getReturnIndex());if(ge(t))return e.getReturnIndex();switch(t.type){case 8:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.Constant(H0(r.value,s.value))):r.type===1&&V(r.value)===0?(e.popInstruction(),t.args[1]):s.type===1&&V(s.value)===0?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 9:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.Constant(z0(r.value,s.value))):r.type===1&&V(r.value)===0?(e.popInstruction(),e.Negative([t.args[1]])):s.type===1&&V(s.value)===0?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 10:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.Constant(U0(r.value,s.value))):r.type===1&&V(r.value)===1?(e.popInstruction(),t.args[1]):s.type===1&&V(s.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 11:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.Constant(q0(r.value,s.value))):s.type===1&&V(s.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 12:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);if(r.type===1&&s.type===1)return e.popInstruction(),e.Constant(Uf(r.value,s.value));if(r.type===1&&r.valueType===I){let i=V(r.value);if(i===Math.E)return e.popInstruction(),e.NativeFunction("exp",[t.args[1]]);if(i>0)return e.popInstruction(),e.RawExponent(t.args)}if(s.type===1&&s.valueType===I){let i=V(s.value);if(i===1)return e.popInstruction(),t.args[0];if(i===Math.floor(i))return e.popInstruction(),e.RawExponent(t.args);if(an(s.value)){let{n:o,d:a}=s.value;if(a%2===1){e.popInstruction();let u=e.RawExponent([e.NativeFunction("abs",[t.args[0]]),t.args[1]]);return o%2===0?u:e.Multiply([e.NativeFunction("sign",[t.args[0]]),u])}}}return e.getReturnIndex()}case 13:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.Constant(Uf(r.value,s.value))):s.type===1&&V(s.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 14:{let r=e.getInstruction(t.args[0]);return r.type===1?(e.popInstruction(),e.Constant($0(r.value))):e.getReturnIndex()}case 25:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.ConstantOfType(De,Y0(r.value,s.value))):e.getReturnIndex()}case 26:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.ConstantOfType(De,X0(r.value,s.value))):e.getReturnIndex()}case 27:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.ConstantOfType(De,Z0(r.value,s.value))):e.getReturnIndex()}case 28:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.ConstantOfType(De,W0(r.value,s.value))):e.getReturnIndex()}case 29:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.ConstantOfType(De,j0(r.value,s.value))):e.getReturnIndex()}case 31:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.ConstantOfType(De,mN(r.value,s.value))):r.type===1?(e.popInstruction(),r.value?t.args[0]:t.args[1]):s.type===1?(e.popInstruction(),s.value?t.args[1]:t.args[0]):e.getReturnIndex()}case 32:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.ConstantOfType(De,yN(r.value,s.value))):r.type===1?(e.popInstruction(),r.value?t.args[1]:t.args[0]):s.type===1?(e.popInstruction(),s.value?t.args[0]:t.args[1]):e.getReturnIndex()}case 33:{let r=e.getInstruction(t.args[0]);return r.type===1?(e.popInstruction(),r.value?t.args[1]:t.args[2]):e.getReturnIndex()}case 16:{let r=e.getInstruction(t.args[0]),s=t.index;return r.type===15?(e.popInstruction(),r.args[s]):r.type===1?(e.popInstruction(),e.ConstantOfType(t.valueType,r.value[s])):e.getReturnIndex()}case 38:case 15:{if(IN(e,t.args)){e.popInstruction();let r=[];for(let s of t.args)r.push(e.getInstruction(s).value);return e.ConstantOfType(t.valueType,r)}return e.getReturnIndex()}case 39:case 41:{let r=t.args[0],s=e.getInstruction(r),i=e.getInstruction(t.args[1]),o=qn(e,r);if(o===0)return e.popInstruction(),e.NanOfType(t.valueType);if(s.type===33&&i.type===1){let a=t.type===39?e.ListAccess([s.args[1],t.args[1]]):e.InboundsListAccess([s.args[1],t.args[1]]),u=t.type===39?e.ListAccess([s.args[2],t.args[1]]):e.InboundsListAccess([s.args[2],t.args[1]]);return e.Piecewise([s.args[0],a,u])}if(s.type===48){e.popInstruction();let a=s.args[0],u=r-a,c=e.getInstruction(a),l=c.args[0],p,f;if(t.type===41)p=t.args[1];else if(i.type===1&&i.valueType===I&&o!==void 0){let y=V(i.value),g=Math.floor(y);if(g<1||g>o)return e.NanOfType(t.valueType);p=y===g?t.args[1]:e.Constant(g)}else{let y=e.Constant(1),m=e.getInstruction(l).args[0],h=e.NativeFunction("floor",[t.args[1]]),x=e.GreaterEqual([h,y]),T=e.LessEqual([h,m]);p=e.Piecewise([x,e.Piecewise([T,h,m]),y]),f={one:y,lengthIndex:m,roundedIndex:h,greaterEqualIndex:x,lessEqualIndex:T}}if(c.args[u]<l)return c.args[u];let d=[p];for(let y=l+1;y<=c.args[u];y++){let g=e.getInstruction(y);if(ge(g))d.push(e.copyInstruction(g));else{let m=[];for(let h of g.args)m.push(h>=l?d[h-l]:h);g.type===40?d.push(e.InboundsListAccess(m)):d.push(e.copyInstructionWithArgs(g,m))}}if(f){let{greaterEqualIndex:y,lessEqualIndex:g,lengthIndex:m,one:h}=f,x=Ve(s.valueType),T=e.NanOfType(x),b=d[d.length-1],M=e.And([e.And([y,g]),e.GreaterEqual([m,h])]);return e.Piecewise([M,b,T])}else return d[d.length-1]}else if(i.type===1&&i.valueType===I)if(s.type===38){e.popInstruction();let a=Math.floor(V(i.value))-1;return isNaN(a)||a<0||a>=s.args.length?e.NanOfType(t.valueType):s.args[a]}else if(s.type===1){e.popInstruction();let a=Math.floor(V(i.value))-1;return isNaN(a)||a<0||a>=s.value.length?e.NanOfType(t.valueType):e.ConstantOfType(Ve(s.valueType),s.value[a])}else return e.getReturnIndex();else return e.getReturnIndex()}case 47:{let r=e.getInstruction(t.args[0]);if(!ds(r)||ph(e,e.getReturnIndex(),r.args[0]))return e.getReturnIndex();if(G0(t.valueType)){let s=e.copy(),i=Qp(s);return e.popInstruction(),B0(e,t.valueType,i)}else throw new Error(`Constant collapsing a block with return type ${oe(t.valueType)} is not implemented.`)}case 55:{let r=e.dereferenceFunctionHeader(t.args[0]);if(r===void 0||!IN(e,t.args.slice(1))||ph(e,r,t.args[0]))return e.getReturnIndex();if(G0(t.valueType)){let s=e.copy(),i=Qp(s);return e.popInstruction(),B0(e,t.valueType,i)}else throw new Error(`Constant collapsing a function call with return type ${oe(t.valueType)} is not implemented.`)}case 37:{let r=IH(e,t.args);if(r!==void 0)return e.popInstruction(),e.ConstantOfType(t.valueType,Q0(t.symbol,r));switch(t.symbol){case"complexPow":{let s=e.getInstruction(t.args[1]);if(s.type===1&&s.valueType===R){let[i,o]=s.value;if(V(i)===1&&V(o)===0)return e.popInstruction(),t.args[0]}return e.getReturnIndex()}case"count":{let s=qn(e,t.args[0]);return s!==void 0?(e.popInstruction(),e.Constant(s)):e.getReturnIndex()}case"select":{let s=qn(e,t.args[0]);if(s!==void 0&&Je(e.getInstruction(t.args[1]))){e.popInstruction();let i=hn(e,t.args[1]),o=[];for(let a=0;a<Math.min(s,i.length);a++)i[a]&&o.push(a);return dh(e,t.args[0],o)}else return e.getReturnIndex()}case"shuffle":{let s=t.args[0],i=t.args[1],o=qn(e,i);if(o!==void 0&&Je(e.getInstruction(s))){e.popInstruction();let a=FE(hn(e,s),o);return dh(e,i,a)}else return e.getReturnIndex()}case"elementsAt":{let s=t.args[0],i=t.args[1];if(Je(e.getInstruction(i))){e.popInstruction();let o=hn(e,i);return dh(e,s,o)}return e.getReturnIndex()}case"restrictionToBoolean":{let s=e.getInstruction(t.args[0]);return Je(s)?(e.popInstruction(),e.ConstantOfType(De,s.value)):s.type===37&&s.symbol==="restriction"?(e.popInstruction(),s.args[0]):e.getReturnIndex()}default:return e.getReturnIndex()}}case 44:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return Je(r)&&Je(s)?e.ConstantOfType(ft,J0(t.tag,hn(e,t.args[0]),s.valueType,hn(e,t.args[1]))):e.getReturnIndex()}case 48:{let r=e.getReturnIndex(),s=qn(e,r);if(s!==void 0&&s===0)return e.popInstruction(),e.ConstantOfType(t.valueType,[]);let i=t.args[0],o=e.getInstruction(i),a=o.args[0],u=r-i,c=o.args[u];if(!ph(e,c,a)){if(t.valueType===Zn){if(s==null)throw sf(fs(e,r));let f=[];for(let d=0;d<s;d++){let y=e.InboundsListAccess([r,e.Constant(d+1)]);f.push(y)}return e.List(f)}let p=gN(e,r);e.popInstruction(),e.ConstantOfType(t.valueType,p)}return r}case 49:{for(let s of t.args)if(!Je(e.getInstruction(s)))return e.getReturnIndex();e.popInstruction();let r={};for(let s=0;s<t.symbols.length;s++){let i=t.symbols[s],o=e.getInstruction(t.args[s]);if(o.type===48&&(o=e.getInstruction(Gr(e,t.args[s]))),o.type!==1)throw new Error("Expected instruction to be constant");let{valueType:a,value:u}=o;uh(a,u)||(r[i]={value:u,valueType:a})}return e.ConstantOfType(ut,{type:"Action",updateRules:r})}case 20:case 22:case 23:case 24:case 40:case 42:case 21:case 19:case 50:case 51:case 53:case 54:return e.getReturnIndex();default:let n=t;throw new Error(`Unexpected opcode ${n.type}`)}}function IN(e,t){for(let n of t){let r=e.getInstruction(n);if(!Je(r))return!1}return!0}function IH(e,t){let n=[];for(let r of t){let s=e.getInstruction(r);if(Je(s))n.push(s.value);else return}return n}function EN(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error("Programming Error: only the final instruction in a chunk can be converted to broadcast");let t=e.getInstruction(e.getReturnIndex());if(ge(t))return e.getReturnIndex();switch(t.type){case 8:case 9:case 10:case 11:case 12:case 13:case 25:case 26:case 27:case 28:case 29:case 31:case 32:case 15:case 14:case 33:case 16:return yl(e,t);case 42:return Gr(e,yl(e,t));case 37:{let r=Bn[t.symbol];switch(r.tag){case"default":case"trig":case"trig2":case"inverseTrig":case"color":return yl(e,t);case"never-broadcast":{let s=[],i=!1;for(let o of t.args){let a=Gr(e,o);a!==o?(i=!0,s.push(a)):s.push(o)}return i?e.copyInstructionWithArgs(t,s):e.getReturnIndex()}case"reducer":if(PH(e,t.args))if(t.args.length===1){let s=t.args[0],i=Gr(e,s);return i!==s?e.copyInstructionWithArgs(t,[i]):e.getReturnIndex()}else return yl(e,t);else return e.getReturnIndex();case"doubleReducer":{if(t.args.length!==2)throw new Error("Programming error: double reducers must have two arguments");let s=Gr(e,t.args[0]),i=Gr(e,t.args[1]);return s!==t.args[0]||i!==t.args[1]?e.copyInstructionWithArgs(t,[s,i]):e.getReturnIndex()}case"parameterizedReducer":{if(t.args.length!==2)throw new Error("Programming error: double reducers must have two arguments");let s=Gr(e,t.args[0]);return s===t.args[0]?yl(e,t,[!1,!0]):e.copyInstructionWithArgs(t,[s,t.args[1]])}default:{let s=r.tag;throw new Error(`Programming Error: unexpected tag ${s}`)}}}case 39:case 40:case 41:return yl(e,t,[!1,!0]);case 55:{let s=e.getInstruction(t.args[0]).signature.argTypes.map(a=>!j(a)),i=[t.args[0]],o=!1;for(let a=1;a<t.args.length;a++){let u=t.args[a],c=Gr(e,u);c!==u?(o=!0,i.push(c)):i.push(u)}return o?e.copyInstructionWithArgs(t,i):yl(e,t,[!1,...s])}case 21:case 22:case 19:case 20:case 50:case 51:return e.getReturnIndex();case 38:case 47:case 23:case 24:case 48:case 44:case 49:case 53:case 54:return e.getReturnIndex();default:let n=t;throw new Error(`Unexpected opcode ${n.type}`)}}function PH(e,t){for(let n of t)if(j(e.getInstruction(n).valueType))return!0;return!1}function yl(e,t,n){let r=t.args,s=!1,i=[];for(let d=0;d<r.length;d++){if(n&&!n[d])continue;let y=r[d],g=e.getInstruction(y).valueType;j(g)&&i.indexOf(y)===-1&&i.push(y),g===$e&&(s=!0)}if(i.length===0)return e.getReturnIndex();if(t.type===33&&i.indexOf(t.args[0])==-1&&i.indexOf(t.args[1])>=0&&i.indexOf(t.args[2])>=0){let d=Gr(e,t.args[1]),y=Gr(e,t.args[2]);return d!==t.args[1]||y!==t.args[2]?_n(e,t,[t.args[0],d,y]):e.getReturnIndex()}e.popInstruction();let o=Jp(e,i);if(o===void 0)throw new Error("Programming Error: expected minListLength to be defined for "+i.length+" lists");let a=o;if(Je(e.getInstruction(a))&&hn(e,a)===0&&s)return e.ConstantOfType($e,[]);let u=e.BeginBroadcast([a],{type:"implicit"}),c=[];for(let d of i)c.push(Ea(e,d,u));let l=[];for(let d=0;d<r.length;d++){let y=r[d];if(n&&!n[d])l.push(y);else{let g=i.indexOf(y);l.push(g===-1?y:c[g])}}let p=e.copyInstructionWithArgs(t,l),f=e.EndBroadcast([u,p]);return e.BroadcastResult(vn(e.getInstruction(p).valueType),[f])}function Ea(e,t,n){return e.getInstruction(t).type==48?e.DeferredListAccess([t,n]):e.InboundsListAccess([t,n])}function CN(e){let t=e.getReturnIndex(),n=Vr(e,t),r=e.getInstruction(t);if(r.type!==48)return e;let s=r.args[0],i=t-s,o=e.getInstruction(s),a=o.args[0],u=o.args[i],c=[],l=[];c.push(a);let p=qo(e,e.getReturnIndex(),"Programming error: cannot optimize regression on non-constant-length list");l.push({range:p-1,length:p});let f=!1,d=!1;for(let D=a+1;D<=u;D++){if(!n[D])continue;let S=e.getInstruction(D);if(es(S)||ds(S))return e;if(S.type===39||S.type===41||S.type===40){if(S.args[1]!==a)continue;let O=S.args[0];if(e.getInstruction(O).valueType!==ne||!Je(e.getInstruction(O)))continue;let _=hn(e,O),L=CH(_);if(!isFinite(L.range))continue;c.push(D),l.push(L)}else MN(S)?f=!0:(S.type===12||S.type===13)&&(d=!0)}if(c.length===0||!d&&!f)return e;let y=[],g=[];for(let D=0;D<e.argNames.length;D++)g.push(D),y.push(aa());let m=[],h=[];for(let D=0;D<=u;D++)m.push(K0(e,g,m,D)),h.push(K0(e,c,h,D));for(let D=0;D<=u;D++){if(!n[D])continue;let S=e.getInstruction(D);if(S.type===33){let O=m[D];for(let _=0;_<O.length;_++)if(O[_])return e}else if(S.type===12||S.type===13){let O=!1,_=!1;for(let K=0;K<c.length;K++)h[S.args[0]][K]&&(O=!0),h[S.args[1]][K]&&(_=!0);if(O||!_)continue;let L=m[S.args[0]],w=0,G;for(let K=0;K<L.length;K++)L[K]&&(G=K,w+=1);if(w!==1||G===void 0)continue;let k=g[G],Z=ns(e.copy().reopenFinalBlock(),k,{allowRestriction:!1,allowClosedBlockReferences:!1});if(ln(Z,S.args[0])!==1)continue;let F=fo(Z,S.args[0]),[Y,re]=Kn(F,S.args[0]);if(re===void 0)continue;let Ee=hn(F.newChunk,re),he=hn(F.newChunk,Y);y[G]=Gn(y[G],Hl(he,Ee))}}if(f){let D=e.copy().reopenFinalBlock();for(let S=0;S<c.length;S++){let O=ns(D,c[S],{allowRestriction:!1,allowClosedBlockReferences:!1}),_=fo(O,u);for(let L=a+1;L<=u;L++){if(!n[L])continue;let w=D.getInstruction(L);if(MN(w)){let G=w.args[0];if(ln(O,G)!==1)continue;let k=Kn(_,G)[1];if(k===void 0)continue;let Z=MH(_.newChunk,k),F,Y=0;for(let me=0;me<Z.length;me++)Z[me]&&(F=me,Y+=1);if(Y!==1||F===void 0)continue;let re=ns(_.newChunk,F,{allowRestriction:!1,allowClosedBlockReferences:!1});if(ln(re,k)!==1)continue;let Ee=fo(re,k),[he,K]=Kn(Ee,k);if(K===void 0||!Je(Ee.newChunk.getInstruction(he))||!Je(Ee.newChunk.getInstruction(K)))continue;let Oe=hn(Ee.newChunk,he),te=hn(Ee.newChunk,K),Ze=SH(l[S]),dt=DH(l[S]);if(!isFinite(Ze)||Ze<=0||!isFinite(dt)||dt<0||Ze<=dt)continue;y[F]=Gn(y[F],Gn(Hl(-dt+Oe,te),Hl(Ze-Oe,-te)))}}}}let x=!1;for(let D of y){if(Fs(D)||!hi(D))return e;(D.bounds[0]!==-1/0||D.bounds[1]!==1/0)&&(x=!0)}if(!x)return e;let T=e.copy(),b=T.Constant(1),M=T.Constant(NaN),P=t;for(let D=0;D<T.argNames.length;D++)P=EH(T,y[D],P,D,b,M);return T.fuseBroadcast(),T}function EH(e,t,n,r,s,i){if(Fs(t)||!hi(t)||t.bounds[0]===-1/0&&t.bounds[1]===1/0)return n;let o=e.And([e.LessEqual([e.Constant(t.bounds[0]),r]),e.LessEqual([r,e.Constant(t.bounds[1])])]);return e.Multiply([n,e.Piecewise([o,s,i])])}function MH(e,t){let n=[];for(let s=0;s<e.argNames.length;s++)n.push(s);let r=[];for(let s=0;s<=t;s++)r.push(K0(e,n,r,s));return r[t]}function MN(e){return e.type===37&&(e.symbol==="sin"||e.symbol==="cos")}function CH(e){let t=1/0,n=-1/0,r=e.length;for(let s of e)t=Math.min(t,s),n=Math.max(n,s);return{range:n-t,length:r}}function DH({range:e}){return 1e-5/e}function SH({range:e,length:t}){let n=e/Math.min(t-1,31);return Math.PI/n}function K0(e,t,n,r){let s=e.getInstruction(r),i=vH(t.length);for(let o=0;o<t.length;o++)if(t[o]===r)return i[o]=!0,i;if(ge(s))return i;for(let o of s.args){let a=n[o];for(let u=0;u<a.length;u++)i[u]=i[u]||a[u]}return i}function vH(e){let t=[];for(let n=0;n<e;n++)t.push(!1);return t}var RN=tM({sin:Dn("isinf(x) || isnan(x) ? NaN : dcg_isPiMultiple(abs(x)) ? 0.0 : sin(x)"),cos:Dn("isinf(x) || isnan(x) ? NaN : dcg_isOddHalfPiMultiple(abs(x)) ? 0.0 : cos(x)"),tan:ci(pe`float a=abs(x);\n    return isinf(x) || isnan(x) ? NaN\n      : dcg_isPiMultiple(a) ? 0.0\n      : dcg_isOddHalfPiMultiple(a) ? Infinity\n      : tan(x);`),cot:ci(pe`float a=abs(x);\n      return isinf(x) || isnan(x) ? NaN\n        : a < 0.03 ? 1.0/x - x/3.0\n        : dcg_isPiMultiple(a) ? Infinity\n        : dcg_isOddHalfPiMultiple(a) ? 0.0\n        : 1.0 / tan(x);`),sec:Dn("isinf(x) || isnan(x) ? NaN : dcg_isOddHalfPiMultiple(abs(x)) ? Infinity: 1.0 / cos(x)"),csc:ci(pe`float a=abs(x);\n      return isinf(x) || isnan(x) ? NaN\n        : a < 0.03 ? 1.0/x + x/6.0\n        : dcg_isPiMultiple(a) ? Infinity\n        : 1.0 / sin(x);`),arcsin:ci(pe`if (isinf(x) || isnan(x)) { return NaN; }\n    if (x == 1.0) { return dcg_PI/2.0; }\n    if (x == -1.0) { return -dcg_PI/2.0; }\n    if (x > 1.0 || x < -1.0) return NaN;\n    float y0 = asin(x);\n    return y0 + (x - sin(y0)) / cos(y0);`),arccos:ci(pe`if (isinf(x) || isnan(x)) { return NaN; }\n    if (x == 1.0) { return 0.0; }\n    if (x == -1.0) { return dcg_PI; }\n    if (x > 1.0 || x < -1.0) return NaN;\n    float y0 = acos(x);\n    return y0 + (cos(y0) - x) / sin(y0);`),arctan:qf(pe`isnan(x) || isnan(y) ? NaN\n      : isinf(x) && isinf(y) ?\n        (y > 0.0 ? 0.25 : 0.75) * sign(x) * dcg_PI\n      : x == 0.0 && y == 0.0 ? y\n      : atan(x, y)\n    `),arccot:Dn("isnan(x) ? NaN : dcg_PI/2.0 - atan(x)"),arcsec:Dn("isnan(x) ? NaN : dcg_arccos(1.0/x)"),arccsc:Dn("isnan(x) ? NaN : dcg_arcsin(1.0/x)"),sinh:Dn("isinf(x) ? x : isnan(x) ? NaN : sinh(x)"),cosh:Dn("isinf(x) ? Infinity : isnan(x) ? NaN : cosh(x)"),tanh:Dn("abs(x) > 10.0 ? sign(x) : isnan(x) ? NaN : tanh(x)"),coth:Dn("abs(x) > 10.0 ? sign(x) : isnan(x) ? NaN : x == 0.0 ? Infinity : abs(x) < 0.03 ? 1.0/x + x/3.0 : 1.0/tanh(x)"),sech:Dn("isinf(x) ? 0.0 : isnan(x) ? NaN : 1.0/cosh(x)"),csch:Dn("isinf(x) ? 0.0 : isnan(x) ? NaN : x == 0.0 ? Infinity : abs(x) < 0.03 ? 1.0/x - x/6.0 : 1.0/sinh(x)"),arcsinh:ci(pe`float a=abs(x);\n      return isnan(x) ? NaN : sign(x) * (\n        1.0 + x * x == 1.0\n          ? dcg_log1p(a)\n          : log(a + dcg_rtxsqpone(a))\n      );`),arccosh:Dn("x < 1.0 || isnan(x) ? NaN : log(x + dcg_rtxsqmone(x))"),arctanh:ci(pe`if (isnan(x) || abs(x) > 1.0) { return NaN; }\n      if (x == 1.0) { return Infinity; }\n      if (x == -1.0) { return -Infinity; }\n      float y0 = 0.5*(dcg_log1p(x) - dcg_log1p(-x));\n      float c = cosh(y0);\n      return y0 + (x - tanh(y0)) * c * c;`),arccoth:Dn("isnan(x) ? NaN : abs(x) >= 1.0 ? dcg_arctanh(1.0/x) : NaN"),arcsech:Dn("isnan(x) ? NaN : 0.0 < x && x <= 1.0 ? dcg_arccosh(1.0/x) : x == 0.0 ? Infinity : NaN"),arccsch:Dn("isinf(x) ? 0.0 : isnan(x) ? NaN : dcg_arcsinh(1.0/x)"),sinpiSeries:ci(pe`float xsq = x*x;\n    return x*(dcg_PI-xsq*(5.167708-xsq*(2.549761-xsq*0.5890122)));`),sinpi:ci(pe`if (isnan(x) || isinf(x)) { return NaN; }\n    if (x==0.0) { return x; }\n    if (x == floor(x)) { return x > 0.0 ? 0.0 : -0.0; }\n    int i = int(dcg_round(2.0*x));\n    float t = -0.5 * float(i) + x;\n    float s = bool(i & 2) ? -1.0 : 1.0;\n    float y = bool(i & 1) ? cos(dcg_PI * t) : dcg_sinpiSeries(t);\n    return s*y;`),sincpi:Dn("isnan(x) ? NaN : isinf(x) ? 0.0 : x == 0.0 ? 1.0 : dcg_sinpi(x)/(dcg_PI*x);"),sqrt:Dn("isnan(x) ? NaN : x >= 0.0 ? sqrt(x) : NaN"),rtxsqpone:Dn("dcg_hypot(x, 1.0)"),rtxsqmone:ci("float t = x*x; return isnan(x) || t < 1.0 ? NaN : t - 1.0 == t ? abs(x) : sqrt(t - 1.0);"),hypot:AN(pe`if (isnan(x) || isnan(y)) return NaN;\n      if (isinf(x) || isinf(y)) return Infinity;\n      x = abs(x);\n      y = abs(y);\n      float m = max(x,y);\n      x /= m;\n      y /= m;\n      return m == 0.0 ? 0.0 : sqrt(x*x + y*y) * m;`),min:qf(pe`isnan(x) || isnan(y) ? NaN : min(x, y)`),max:qf(pe`isnan(x) || isnan(y) ? NaN : max(x, y)`),log:Dn("isnan(x) ? NaN : x > 0.0 ? log(x)*0.4342944819 : x == 0.0 ? -Infinity : NaN"),logbase:qf(pe`isnan(x) || isnan(y) ? NaN\n      : y == 1.0 ?\n        (\n          x > 1.0 ? Infinity\n          : x == 1.0 ? NaN\n          : x < 0.0 ? NaN\n          : -Infinity\n        )\n      : y > 0.0 ?\n        (\n          x > 0.0 ? log(x)/log(y)\n          : x == 0.0 && !isinf(y) ? -Infinity\n          : NaN\n        )\n      : NaN`),ln:Dn("isnan(x) ? NaN : x > 0.0 ? log(x) : x == 0.0 ? -Infinity : NaN"),exp:Dn("isnan(x) ? NaN : exp(x)"),floor:Dn("isnan(x) ? NaN : floor(x)"),ceil:Dn("isnan(x) ? NaN : ceil(x)"),round:Dn("isinf(x) || isnan(x) ? x : floor(0.5 + x)"),abs:Dn("isnan(x) ? NaN : abs(x)"),sign:Dn("isnan(x) ? NaN : sign(x)"),mod:qf("isinf(x) || isinf(y) || isnan(x) || isnan(y) || y == 0.0 ? NaN : mod(x, y)"),stirlingPrefactor:kr("float","float x, float y",pe`if (isnan(x) || isnan(y)) { return NaN; }\n    return pow(x/exp(1.0), y);`),stirlerrSeries:ci(pe`float S0 = 0.083333336;\n    float S1 = 0.0027777778;\n    float S2 = 0.0007936508;\n    float nn = x*x;\n    return (S0-(S1-S2/nn)/nn)/x;`),factorialAsymptotic:Dn("dcg_stirlingPrefactor(x,x)*sqrt(2.0*dcg_PI*x)*exp(dcg_stirlerrSeries(x))"),factorialMinimax:ci(pe`float n1 = 2.1618295;\n    float n2 = 1.5849807;\n    float n3 = 0.4026814;\n    float d1 = 2.2390451;\n    float d2 = 1.6824219;\n    float d3 = 0.43668285;\n\n    float n = 1.0 + x*(n1 + x*(n2 + x*n3));\n    float d = 1.0 + x*(d1 + x*(d2 + x*d3));\n    float xp1 = x+1.0;\n\n    return dcg_stirlingPrefactor(xp1,x)*sqrt(xp1)*(n/d);\n    `),factorialPositive:Dn(pe`(x>33.0)?Infinity:(x>8.0)?dcg_factorialAsymptotic(x):dcg_factorialMinimax(x);`),factorial:ci(pe`if (isnan(x) || (isinf(x) && x < 0.0)) { return NaN; }\n    bool isInteger = x == floor(x);\n    if (x < 0.0) {\n      if (isInteger) return Infinity;\n      return 1.0 / (dcg_sincpi(x) * dcg_factorialPositive(-x));\n    }\n    float approx = dcg_factorialPositive(x);\n    return isInteger ? dcg_round(approx) : approx;`),distance:kr("float","vec2 a, vec2 b",pe`\n      if (any(isnan(a)) || any(isnan(b))) return NaN;\n      vec2 d = a-b;\n      return dcg_hypot(d.x, d.y);`),distanceThreeD:kr("float","vec3 a, vec3 b",pe`\n      if (any(isnan(a)) || any(isnan(b))) return NaN;\n      vec3 d = a-b;\n      return dcg_hypot(dcg_hypot(d.x, d.y), d.z);`),hsv:kr("vec3","float h, float s, float v",pe`if (isnan(h) || isnan(s) || isnan(v)) {discard;}\n      vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n      if (isinf(h)) h = 0.0;\n      vec3 p = abs(fract(h / 360.0 + K.xyz) * 6.0 - K.www);\n      return vec3(clamp(v, 0.0, 1.0) * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), clamp(s, 0.0, 1.0)));`),rgb:kr("vec3","float r, float g, float b",pe`if (isnan(r) || isnan(g) || isnan(b)) {discard;}\n    return clamp(vec3(r,g,b),0.0,255.0)/255.0;`),erf:ci(pe`if (isnan(x)) return NaN;\n      float t = abs(x);\n      float n = x*x;\n      float r = -n;\n      return sign(x) * (\n        r < -750.0\n          ? 1.0\n          : t >= 0.065\n          ? 1.0 - exp(r) * (\n            t > 50000000.0\n              ? r / t\n              : t > 50.0\n              ? (r * (n * (n + 4.5) + 2.0)) / (t * (n * (n + 5.0) + 3.75))\n              : ((0.9999999999999999+t*(2.224574423459406+t*(2.444115549920689+\n                t*(1.7057986861852539+t*(0.8257463703357973+\n                  t*(0.28647031042892007+t*(0.07124513844341643+\n                    t*(0.012296749268608364+t*(0.001347817214557592+\n                      0.00007263959403471071*t))))))))\n                )/(1.0+t*(3.352953590554884+t*(5.227518529742423+\n                  t*(5.003720878235473+t*(3.266590890998987+\n                    t*(1.5255421920765353+t*(0.5185887413188858+\n                      t*(0.12747319185915415+t*(0.02185979575963238+\n                        t*(0.0023889438122503674+0.00012875032817508128*t\n                ))))))))))\n              )\n          )\n          : t*(1.1283791670955126+r*(0.37612638903183754+\n              r*(0.11283791670955126+r*(0.026866170645131252+\n                0.005223977625442188*r))))\n      );`),restriction:kr("bool","bool x","return x;"),restrictionToBoolean:kr("bool","bool x","return x;"),complex:kr("vec2","float u, float v",pe`if (isnan(u) || isnan(v)) { return vec2(NaN, NaN); }\n    return vec2(u,v);`),real:kr("float","vec2 c","return c.x;"),imag:kr("float","vec2 c","return c.y;"),arg:kr("float","vec2 c","return dcg_arctan(c.y,c.x);"),peelableCoerceComplexToReal:kr("float","vec2 a","return a.y == 0.0 ? a.x : NaN;"),coerceComplexToReal:kr("float","vec2 a","return a.y == 0.0 ? a.x : NaN;"),coerceRealToComplex:kr("vec2","float x","return isnan(x) ? vec2(NaN, NaN) : vec2(x, 0);"),complexSqrt:$s(pe`float u = z.x; float v = z.y;\n    float r = sqrt(0.5 * (abs(u) + dcg_hypot(u, v)));\n    if (r == 0.0 || isnan(v) || isinf(v)) return dcg_complex(r, v);\n    if (u > 0.0) return dcg_complex(r, 0.5 * (v / r));\n    if (v < 0.0) r = -r;\n    return dcg_complex(0.5 * (v / r), r);`),complexDivide:kr("vec2","vec2 a, vec2 b",pe`float u1 = a.x; float v1 = a.y;\n      float u2 = b.x; float v2 = b.y;\n      if (isnan(u1) || isnan(v1) || isnan(u2) || isnan(v2)) return vec2(NaN, NaN);\n      if (isinf(u1) || isinf(v1)) return vec2(NaN, NaN);\n      if (u2 == 0.0 && v2 == 0.0) return vec2(NaN, NaN);\n      if (isinf(u2) || isinf(v2)) return vec2(0.0, 0.0);\n      if (abs(v2) <= abs(u2)) {\n        return dcg_subComplexDivide(a, b);\n      } else {\n        return dcg_conj(dcg_subComplexDivide(a.yx, b.yx));\n      }`),complexLn:$s(pe`float u = z.x; float v = z.y;\n      return dcg_complex(dcg_ln(dcg_hypot(u,v)), dcg_arctan(v,u));`),complexExp:$s(pe`float u = z.x; float v = z.y;\n      if (isnan(u)) return vec2(NaN, NaN);\n      float r = exp(u);\n      return v == 0.0 ? vec2(r, 0.0) : dcg_complexFromPolarRounded(r, v);`),complexPow:kr("vec2","vec2 z1, vec2 z2",pe`float u2 = z2.x; float v2 = z2.y;\n      float u1 = z1.x; float v1 = z1.y;\n      if (isnan(u1) || isnan(v1) || isnan(u2) || isnan(v2))\n        return vec2(NaN, NaN);\n      float r1 = dcg_hypot(u1, v1);\n      float theta1 = dcg_arctan(v1, u1);\n      float rOut = pow(r1, u2) * exp(-theta1 * v2);\n      float thetaOut = log(r1) * v2 + theta1 * u2;\n      if (!isinf(rOut)) {\n        return dcg_complexFromPolarRounded(rOut, thetaOut);\n      } else {\n        return dcg_complexFromPolarRounded(\n          exp(u2 * log(r1) - theta1 * v2),\n          thetaOut\n        );\n      }\n      `),complexSin:$s(pe`float u = z.x; float v = z.y;\n      return dcg_complex(dcg_sin(u) * dcg_cosh(v), dcg_cos(u) * dcg_sinh(v));`),complexCos:$s(pe`float u = z.x; float v = z.y;\n      return dcg_complex(dcg_cos(u) * dcg_cosh(v), -dcg_sin(u) * dcg_sinh(v));`),complexSinh:$s(pe`float u = z.x; float v = z.y;\n      return dcg_complex(dcg_sinh(u) * dcg_cos(v), dcg_cosh(u) * dcg_sin(v));`),complexCosh:$s(pe`float u = z.x; float v = z.y;\n      return dcg_complex(dcg_cosh(u) * dcg_cos(v), dcg_sinh(u) * dcg_sin(v));`),complexTanh:$s(pe`float u = z.x; float v = z.y;\n      float tanv = dcg_tan(v); float tanhu = dcg_tanh(u);\n      if (isnan(tanv) || isnan(tanhu)) return vec2(NaN, NaN);\n      if (isinf(tanv)) return vec2(1.0 / tanhu, 0.0);\n\n      float tanv2 = tanv * tanv;\n      float secv2 = 1.0 + tanv2;\n      float sinhu = dcg_sinh(u);\n      float sinhu2 = sinhu * sinhu;\n      float tanhu2 = tanhu * tanhu;\n      return dcg_complex(\n        (secv2 * tanhu) / (1.0 + tanv2 * tanhu2),\n        tanv / (1.0 + secv2 * sinhu2)\n      );`),complexTan:$s(pe`float u = z.x; float v = z.y;\n      vec2 t = dcg_complexTanh(vec2(-v, u));\n      return vec2(t.y, -t.x);`),complexSec:$s("return dcg_complexReciprocal(dcg_complexCos(z));"),complexCsc:$s("return dcg_complexReciprocal(dcg_complexSin(z));"),complexCot:$s("return dcg_complexReciprocal(dcg_complexTan(z));"),complexSech:$s("return dcg_complexReciprocal(dcg_complexCosh(z));"),complexCsch:$s("return dcg_complexReciprocal(dcg_complexSinh(z));"),complexCoth:$s("return dcg_complexReciprocal(dcg_complexTanh(z));"),complexLogbase:kr("vec2","vec2 z, vec2 base",pe`\n      float u = z.x; float v = z.y;\n      float bu = base.x; float bv = base.y;\n      if (any(isnan(z)) || any(isnan(base))) return vec2(NaN, NaN);\n      if (bv == 0.0 && bu == 0.0) return vec2(NaN, NaN);\n      if (u == 0.0 && v == 0.0) return vec2(-Infinity, 0);${""}\n      return dcg_complexDivide(dcg_complexLn(z), dcg_complexLn(base));`),complexLog:$s("return dcg_complexLogbase(z, vec2(10.0,0.0));")});function kr(e,t,n){return{type:"scalar",value:`${e} dcg_[[name_here]](${t}){ ${n} }`}}function ci(e){return kr("float","float x",e)}function Dn(e){return ci(`return ${e};`)}function AN(e){return kr("float","float x, float y",e)}function qf(e){return AN(`return ${e};`)}function $s(e){return kr("vec2","vec2 z",e)}function Ys(e,{inType:t,outType:n,deps:r}={}){let s=t!=null?t:o=>`float[${o}]`,i=n!=null?n:()=>"float";return{type:"reducer",value:o=>`${i(o)} dcg_[[name_here]](${s(o)} L) { ${e(o)} }`,deps:r!=null?r:[]}}function eM(e){return{type:"double-reducer",value:(t,n)=>{let r=Math.min(t,n),s=e(r);return`float dcg_[[name_here]](float[${t}] X, float[${n}] Y) { ${s} }`}}}var OH=tM({lcm:Ys(e=>pe`float g = abs(dcg_round(L[0]));\n      if (isnan(g) || isinf(g)) return NaN;\n      for (int i=1; i<${e}; i++) {\n        float v = abs(dcg_round(L[i]));\n        if (isnan(v) || isinf(v)) return NaN;\n        if (g != 0.0)\n          g *= dcg_round(v / dcg_gcd2(g, v));\n      }\n      return g;`),gcd:Ys(e=>pe`float g = abs(dcg_round(L[0]));\n      if (isnan(g) || isinf(g)) return NaN;\n      for (int i=1; i<${e}; i++) {\n        float x = L[i];\n        if (isnan(x) || isinf(x)) return NaN;\n        g = dcg_gcd2(g, abs(dcg_round(x)));\n      }\n      return g;`),mean:Ys(e=>pe`float tot = 0.0;\n      for (int i=0; i<${e}; i++) {\n        float x = L[i];\n        if (isnan(x) || (isinf(x) && x == -tot)) return NaN;\n        tot += x;\n      }\n      return tot / ${e}.0;`),total:Ys(e=>pe`float tot = 0.0;\n      for (int i=0; i<${e}; i++) {\n        float x = L[i];\n        if (isnan(x) || (isinf(x) && x == -tot)) return NaN;\n        tot += x;\n      }\n      return tot;`),stdev:Ys(e=>SN(e,e-1),{deps:["mean"]}),stdevp:Ys(e=>SN(e,e),{deps:["mean"]}),mad:Ys(e=>pe`float mean = dcg_mean(L);\n      if (isnan(mean) || isinf(mean)) return NaN;\n      float tot = 0.0;\n      for (int i=0; i<${e}; i++) {\n        tot += abs(L[i] - mean);\n      }\n      return tot / ${e}.0;`,{deps:["mean"]}),listMin:Ys(e=>vN(e,"min")),listMax:Ys(e=>vN(e,"max")),argmin:Ys(e=>ON(e,"<")),argmax:Ys(e=>ON(e,">=")),median:Ys(e=>e%2===1?`return L[int(dcg_sortPerm(L)[${(e-1)/2}])];`:pe`float[${e}] perm = dcg_sortPerm(L);\n          return 0.5*(L[int(perm[${e/2}])]+L[int(perm[${e/2-1}])]);`,{deps:["sortPerm"]}),varp:Ys(e=>DN(e,e),{deps:["mean"]}),var:Ys(e=>DN(e,e-1),{deps:["mean"]}),sortPerm:Ys(e=>{if(e>100)throw Oc();return pe`float[${e}] permFloat;\n        float lastMin = -Infinity;\n        int lastIndex = -1;\n        for (int i=0; i<${e}; i++) {\n          float currMin = NaN;\n          int currIndex = ${e};\n          int j;\n          for (j=0; j<${e}; j++) {\n            float e = L[j];\n            float cmpLast = dcg_compareAscendingNaNLast(e, lastMin);\n            float cmpCurr = dcg_compareAscendingNaNLast(currMin, e);\n            if (\n              (cmpLast > 0.0 || (cmpLast == 0.0 && j > lastIndex))\n              && (cmpCurr > 0.0 || (cmpCurr == 0.0 && j < currIndex))\n            ) {\n              currMin = e;\n              currIndex = j;\n            }\n          }\n          permFloat[i] = float(currIndex);\n          lastMin = currMin;\n          lastIndex = currIndex;\n        }\n        return permFloat;`},{outType:e=>`float[${e}]`}),complexSortPerm:Ys(e=>{if(e>100)throw Oc();return pe`float[${e}] permFloat;\n      vec2 lastMin = vec2(-Infinity,-Infinity);\n      int lastIndex = -1;\n      for (int i=0; i<${e}; i++) {\n        vec2 currMin = vec2(NaN,NaN);\n        int currIndex = ${e};\n        int j;\n        for (j=0; j<${e}; j++) {\n          vec2 e = L[j];\n          float cmpLast = dcg_compareComplexLexicographic(e, lastMin);\n          float cmpCurr = dcg_compareComplexLexicographic(currMin, e);\n          if (\n            (cmpLast > 0.0 || (cmpLast == 0.0 && j > lastIndex))\n            && (cmpCurr > 0.0 || (cmpCurr == 0.0 && j < currIndex))\n          ) {\n            currMin = e;\n            currIndex = j;\n          }\n        }\n        permFloat[i] = float(currIndex);\n        lastMin = currMin;\n        lastIndex = currIndex;\n      }\n      return permFloat;`},{inType:e=>`vec2[${e}]`,outType:e=>`float[${e}]`})});function DN(e,t){return t===0?"return NaN;":pe`float mean = dcg_mean(L);\n    if (isnan(mean) || isinf(mean)) return NaN;\n    float tot = 0.0;\n    for (int i=0; i<${e}; i++) {\n      float delta = L[i] - mean;\n      tot += delta * delta;\n    }\n    return tot / ${t}.0;`}function SN(e,t){return t===0?"return NaN;":pe`float mean = dcg_mean(L);\n    if (isnan(mean) || isinf(mean)) return NaN;\n    float tot = 0.0;\n    for (int i=0; i<${e}; i++) {\n      tot = dcg_hypot(tot, L[i] - mean);\n    }\n    return tot / ${nM(Math.sqrt(t))};`}function vN(e,t){return pe`float m = L[0];\n    if (isnan(m)) return NaN;\n    for (int i=1; i<${e}; i++) {\n      float x = L[i];\n      if (isnan(x)) return NaN;\n      m = ${t}(m, x);\n    }\n    return m;`}function ON(e,t){return pe`if (isnan(L[0])) return 0.0;\n    int arg = 0;\n    float best = L[0];\n    for (int i=1; i<${e}; i++) {\n      float e = L[i];\n      if (isnan(e)) return 0.0;\n      if (e ${t} best) {\n        arg = i;\n        best = e;\n      }\n    }\n    return float(arg + 1);`}var NH=tM({cov:eM(e=>NN(e,e-1)),covp:eM(e=>NN(e,e)),corr:eM(e=>pe`${_N(e)}\n      float t1 = 0.0;\n      float t2 = 0.0;\n      float tc = 0.0;\n      for (int i=0; i<${e}; i++) {\n        float d1 = X[i] - m1;\n        float d2 = Y[i] - m2;\n        t1 = dcg_hypot(t1, d1);\n        t2 = dcg_hypot(t2, d2);\n        tc += d1 * d2;\n      }\n      return tc / (t1 * t2);`)}),RH={type:"elementsAt",value:(e,t)=>`${e}[${t}] dcg_elementsAt(${e}[${t}] X, float[${t}] Y) {\n      ${e}[${t}] outList;\n      for (int i=0; i<${t}; i++) {\n        outList[i] = X[int(Y[i])];\n      }\n      return outList;\n    }`},AH={...RN,...OH,...NH,elementsAt:RH},yh=AH;function _H(e,t){switch(e.type){case"scalar":return e.value.replace("[[name_here]]",t);case"reducer":{let n=e.value;return r=>n(r).replace("[[name_here]]",t)}case"double-reducer":{let n=e.value;return(r,s)=>n(r,s).replace("[[name_here]]",t)}default:return e.value}}function tM(e){for(let[t,n]of Object.entries(e))n.type!=="omitted"&&(n.value=_H(n,t));return e}function NN(e,t){return pe`${_N(e)}\n    float tot = 0.0;\n    for (int i=0; i<${e}; i++) {\n      tot += (X[i] - m1) * (Y[i] - m2);\n    }\n    return tot / ${t}.0;`}function _N(e){return pe`float m1 = 0.0;\n    for (int i=0; i<${e}; i++) {\n      float x = X[i];\n      if (isnan(x) || isinf(x)) return NaN;\n      m1 += x;\n    }\n    m1 /= ${e}.0;\n    float m2 = 0.0;\n    for (int i=0; i<${e}; i++) {\n      float y = Y[i];\n      if (isnan(y) || isinf(y)) return NaN;\n      m2 += y;\n    }\n    m2 /= ${e}.0;`}var LH=[pe`float dcg_rawpow(float x, float y) {\n    if (isnan(x) || isnan(y)) return NaN;\n    if (y==0.0) return 1.0;\n    if (isinf(y)) {${""}\n      float a = abs(x);\n      if (a == 1.0) return NaN;\n      if (y > 0.0) {\n        return a > 1.0 ? Infinity : 0.0;\n      } else {\n        return a < 1.0 ? Infinity : 0.0;\n      }\n    }\n    if (x > 0.0) return pow(x, y);\n    else if (x == 0.0) {\n      if (y > 0.0) return 0.0;\n      else if (y == 0.0) return 1.0;\n      else return Infinity;\n    } else {\n      float m = mod(y, 2.0);\n      if (m == 1.0) return -pow(-x, y);\n      else return pow(-x, y);\n    }\n  }`,pe`float dcg_pow(float x, float y) {\n    if (isnan(x) || isnan(y)) return NaN;\n    if (y==0.0) return 1.0;\n    if (isinf(y)) {\n      float a = abs(x);\n      if (a == 1.0) return NaN;\n      if (y > 0.0) {\n        return a > 1.0 ? Infinity : 0.0;\n      } else {\n        return a < 1.0 ? Infinity : 0.0;\n      }\n    }\n    if (x > 0.0) return pow(x,y);\n    else if (x == 0.0) {\n      if (y > 0.0) return 0.0;\n      if (y == 0.0) return 1.0;\n      if (y < 0.0) return Infinity;\n    } else {\n      float m = mod(y, 2.0);\n      if (m == 0.0) return pow(-x, y);\n      else if (m == 1.0) return -pow(-x, y);\n      else {${""}\n        vec2 a0 = vec2(0.0, 1.0);\n        vec2 a1 = vec2(1.0, 0.0);\n        float approx = y;\n        for (int i=0; i<12; i+=1) {\n          float whole = floor(approx);\n          vec2 a = whole * a1 + a0;\n          if (a.y > 100.0) break;\n          a0 = a1; a1 = a;\n          if (approx == whole) break;\n          approx = 1.0 / (approx - whole);\n        }${""}\n        float r = a1.x / a1.y;\n        float m = max(max(abs(y), abs(r)), 1.0);\n        if (abs(mod(a1.y, 2.0) - 1.0) < 0.01 && abs((r - y)/y) < 0.00001) {\n          return (mod(a1.x, 2.0) == 0.0 ? 1.0 : -1.0) * pow(-x, y);\n        } else {\n          return NaN;\n        }\n      }\n    }\n  }`,pe`float dcg_add(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && isinf(y) && x != y ? NaN\n      : x + y;\n  }`,pe`float dcg_sub(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && isinf(y) && x != -y ? NaN\n      : x - y;\n  }`,pe`float dcg_mul(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && y == 0.0 ? NaN\n      : x == 0.0 && isinf(y) ? NaN\n      : x * y;\n  }`,pe`float dcg_div(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && isinf(y) ? NaN\n      : x == 0.0 && y == 0.0 ? NaN\n      : x / y;\n  }`,pe`float dcg_neg(float x) {\n    return isnan(x) ? NaN : -x;\n  }`,pe`bool dcg_equal(float x, float y) {\n    return isnan(x) || isnan(y) ? false : x == y;\n  }`,pe`bool dcg_less(float x, float y) {\n    return isnan(x) || isnan(y) ? false : x < y;\n  }`,pe`bool dcg_lessEqual(float x, float y) {\n    return isnan(x) || isnan(y) ? false : x <= y;\n  }`,pe`bool dcg_greater(float x, float y) {\n    return isnan(x) || isnan(y) ? false : x > y;\n  }`,pe`bool dcg_greaterEqual(float x, float y) {\n    return isnan(x) || isnan(y) ? false : x >= y;\n  }`,pe`float dcg_gcd2(float u, float v) {\n    for (int i=0; i<95; i++) {\n      if (v == 0.0) break;\n      u = mod(u, v);\n      if (u == 0.0) break;\n      v = mod(v, u);\n    }\n    return u+v;\n  }`,pe`float dcg_log1p(float x) {\n    return x - 0.5 * x * x == x ? x : log(1.0 + x);\n  }`,pe`bool dcg_isPiMultiple(float absx) {\n    if (absx > 1.0e5) return false;\n    return floor(0.5 + dcg_PI_INV * absx) * dcg_PI == absx;\n  }`,pe`bool dcg_isOddHalfPiMultiple(float absx) {\n    if (absx > 1.0e5) return false;\n    float n = floor(0.5 + 2.0 * dcg_PI_INV * absx);\n    return mod(n, 2.0) == 1.0 && n * dcg_PI == 2.0 * absx;\n  }`,"vec2 dcg_conj(vec2 a) { return vec2(a.x, -a.y); }",pe`vec2 dcg_subComplexDivide(vec2 a, vec2 b) {\n    float u1 = a.x; float v1 = a.y;\n    float u2 = b.x; float v2 = b.y;\n    float r = v2 / u2;\n    float t = 1.0 / (u2 + v2 * r);\n    if (r == 0.0) {\n      return dcg_complex((u1 + v2 * (v1 / u2)) * t, (v1 - v2 * (u1 / u2)) * t);\n    } else {\n      return dcg_complex((u1 + v1 * r) * t, (v1 - u1 * r) * t);\n    }\n  }`,pe`vec2 dcg_complexFromPolarRounded(float r, float theta) {\n    if (isnan(r) || isnan(theta)) return vec2(NaN, NaN);\n    if (r == 0.0) return vec2(0.0, 0.0);\n    return dcg_complex(r * dcg_cos(theta), r * dcg_sin(theta));\n  }`,pe`vec2 dcg_complexReciprocal(vec2 z) {\n    return dcg_complexDivide(vec2(1.0,0.0), z);\n  }`,pe`float dcg_compareAscendingNaNLast(float x, float y) {\n    float diff = dcg_sub(x,y);\n    return !isnan(diff) ? diff : float(isnan(x)) - float(isnan(y));\n  }`,pe`float dcg_compareComplexLexicographic(vec2 x, vec2 y) {\n    float realComparison = dcg_compareAscendingNaNLast(x.x, y.x);\n    return realComparison != 0.0 ? realComparison : dcg_compareAscendingNaNLast(x.y, y.y);\n  }`].join(`\n`),wH=`\n  float dcg_round(float x);\n  float dcg_hypot(float x, float y);\n  float dcg_rtxsqpone(float x);\n  float dcg_rtxsqmone(float x);\n  float dcg_cos(float x);\n  float dcg_sin(float x);\n  float dcg_tan(float x);\n  float dcg_tanh(float x);\n  vec2 dcg_complex(float u, float v);\n  vec2 dcg_complexDivide(vec2 a, vec2 b);\n`,FH=Object.values(RN).map(e=>e.value).join(`\n`),oK=pe`uniform float NaN;\n    uniform float Infinity;\n    #define dcg_PI 3.141592653589793\n    #define dcg_PI_INV 0.3183098861837907\n    ${wH}\\n\n    ${LH}\\n\n    ${FH}`;function pe(e,...t){let n=e[0];for(let r=0;r<t.length;r++)n+=t[r],n+=e[r+1];return VH(n)}function VH(e){let t=e.split(`\n`);if(/^\\s/.test(t[0][0]))throw new Error("Programming error: Expected un-indented first line");if(t.length<=1)return e;let n=Math.min(...t.slice(1).map(r=>r.match(/^\\s*/)[0].length));return t[0]+`\n`+t.slice(1).map(r=>r.slice(n)).join(`\n`)}function Ma(e,t){let n=new rM(e,t),r=Zg(n);return n.finish(r)}var rM=class extends wp{constructor(n,r){super(n,!0);this.maxUniforms=r;this.glsl=!0;this.shaderUniforms=[];this.definitions={}}finish(n){return{source:n,shaderFunctions:BH(this.chunk,this.definitions),shaderUniforms:this.shaderUniforms}}printValue(n,r){if(Array.isArray(n)){if(n.length>100)throw Oc();let s=j(r),i=s?Ve(r):r,o=n.map(c=>this.printValue(c,i)).join(","),a=$f(r),u=LN({type:a,arity:n.length});return this.definitions[u]=!0,(s?"buildList":a)+"("+o+")"}switch(typeof n){case"boolean":return n.toString();case"number":return this.printFloatOrUniformGLSL(n);case"string":throw Xl("random");case"object":if(gu(n))throw new Error("Action values cannot be compiled");return this.printFloatOrUniformGLSL(V(n));default:throw new Error("Unexpected value: "+n)}}printFloatOrUniformGLSL(n){if(this.shaderUniforms.length>=this.maxUniforms)return nM(n);{let s="_DCG_SC_"+this.shaderUniforms.length;return this.shaderUniforms.push(n),s}}beforeBeginLoop(n){let r=this.chunk.getInstruction(n.args[0]),s=this.chunk.getInstruction(n.args[1]),i=n.callData.type==="sum";if(r.type!==1){let u=fs(this.chunk,n.args[0]);throw i?gy(u):hy(u)}if(s.type!==1){let u=fs(this.chunk,n.args[1]);throw i?gy(u):hy(u)}if(r.valueType!==I||s.valueType!==I)throw new Error("Programming error: non-number in summation bounds");let o=V(r.value),a=V(s.value);if(!isFinite(a-o)||a-o>=1e3)throw i?VT():BT()}checkFiniteBounds(){return""}emitConstant(n){return this.printValue(n.value,n.valueType)}emitNeg(n){return`dcg_neg(${n})`}emitTernary(n,r,s,i){return j(i.valueType)?`dcg_ternary(${n},${r},${s})`:`${n}?${r}:${s}`}emitVec2(n,r){return`vec2(${n},${r})`}emitVec3(n,r,s){return`vec3(${n},${r},${s})`}emitVecAccess(n,r){return`${n}.${r===0?"x":r===1?"y":"z"}`}emitBinary(n,r,s){switch(n.type){case 8:return`dcg_add(${r},${s})`;case 9:return`dcg_sub(${r},${s})`;case 10:return`dcg_mul(${r},${s})`;case 11:return`dcg_div(${r},${s})`;case 12:return`dcg_pow(${r},${s})`;case 13:return`dcg_rawpow(${r},${s})`;case 25:return`dcg_equal(${r},${s})`;case 26:return`dcg_less(${r},${s})`;case 28:return`dcg_lessEqual(${r},${s})`;case 27:return`dcg_greater(${r},${s})`;case 29:return`dcg_greaterEqual(${r},${s})`;case 31:return`${r}||${s}`;case 32:return`${r}&&${s}`;default:throw new Error("Programming Error: invalid binary opcode.")}}emitList(n,r){let s=LN({type:$f(r.valueType),arity:r.args.length});return this.definitions[s]=!0,`buildList(${n.join(",")})`}emitListAccess(n,r,s,i){let o=qn(this.chunk,i.args[0]);if(o===void 0)throw mu(fs(this.chunk,i.args[0]));let a=`int(${r})`;return`(${a}>=1&&${a}<=${o})?${n}[${a}-1]:${s}`}emitInboundsListAccess(n,r){return`${n}[int(${r})-1]`}emitNativeFunction(n,r){if(!yh[r.symbol])throw Xl(r.symbol);return`dcg_${r.symbol}(${n.join(",")})`}emitExtendSeed(){throw Xl("random")}emitVarDeclaration(n,r){let s=r?";":"";return s+=sM(this.chunk,n)+" "+fn(n),s}emitImmediateAssignment(n,r,s){return`${sM(this.chunk,n)} ${r}=${s};`}emitFunctionCall(){throw Xl("recursion")}};function hK(...e){return Object.keys(Object.assign({},...e)).join(`\n`)}function LN(e){let{type:t,arity:n}=e,r=t+"["+n+"]",s=r+" buildList(";for(let i=0;i<n-1;i++)s+=`${t} _${i}, `;s+=`${t} _${n-1}) {\n`,s+=r+` a;\n`;for(let i=0;i<n;i++)s+=`a[${i}] = _${i};\n`;return s+=`return a;\n}\n`,s}function BH(e,t){let n=e.argNames.length,r=e.instructionsLength()-1;for(let s=n;s<=r;s++){let i=e.getInstruction(s);if(i.type===33){if(j(i.valueType)){let o=sM(e,s),a=`${o} dcg_ternary(bool x, ${o} y, ${o} z) { if (x) return y; return z; }`;t[a]=!0}}else if(i.type===37){let o=yh[i.symbol];if((o==null?void 0:o.type)==="reducer"){let a=i.args[0],u=qn(e,a);if(u===void 0)throw mu(fs(e,a));for(let c of o.deps)t[yh[c].value(u)]=!0;t[o.value(u)]=!0}else if((o==null?void 0:o.type)==="double-reducer"){let a=i.args[0],u=i.args[1],c=qn(e,a),l=qn(e,u);if(c===void 0)throw mu(fs(e,a));if(l===void 0)throw mu(fs(e,u));t[o.value(c,l)]=!0}else if((o==null?void 0:o.type)==="elementsAt"){let a=$f(Ve(i.valueType)),u=i.args[1],c=qn(e,u);if(c===void 0)throw mu(fs(e,u));t[o.value(a,c)]=!0}}}return t}function nM(e){let t=e.toString();return/^-?\\d+$/.test(t)?t+".0":t}function $f(e){switch(j(e)?Ve(e):e){case De:return"bool";case I:return"float";case N:case R:return"vec2";case Kt:case z:return"vec3";default:throw new Error("Unexpected type: "+at(e))}}function sM(e,t){let n=e.getInstruction(t);if(j(n.valueType)){let r=qn(e,t);if(r===void 0)throw mu(fs(e,t));if(r>100)throw Oc();return`${$f(n.valueType)}[${r}]`}else return $f(n.valueType)}function bK(e){let t={},n="";if(e)for(let r=0;r<e.length;r++){let s="_DCG_SC_"+r;t[s]={value:e[r]},n+="uniform float "+s+`;\n`}return{uniforms:t,declarations:n}}function wN(e){let t=[],n=[];for(let r=0;r<e.argNames.length;r++){let s=[],i=[];for(let o=0;o<e.argNames.length;o++)s.push(e.argTypes[o]===I),i.push(r===o);n.push(i),t.push(s)}for(let r=e.argNames.length;r<=e.getReturnIndex();r++)n.push(GH(e,n,r)),t.push(kH(e,n,t,r));return t[e.getReturnIndex()]}function GH(e,t,n){let r=e.getInstruction(n),s=zH(e.argNames.length);if(ge(r))return s;for(let i of r.args){let o=t[i];for(let a=0;a<o.length;a++)s[a]=s[a]||o[a]}return s}function kH(e,t,n,r){let s=e.getInstruction(r);if(ge(s))return iM(e.argNames.length);switch(s.type){case 8:case 9:case 14:case 15:case 16:case 38:{let o=iM(e.argNames.length);for(let a=0;a<s.args.length;a++){let u=n[s.args[a]];for(let c=0;c<u.length;c++)o[c]=o[c]&&u[c]}return o}case 11:{let o=[],a=n[s.args[0]],u=t[s.args[1]];for(let c=0;c<a.length;c++)o.push(a[c]&&!u[c]);return o}case 10:{let o=n[s.args[0]].slice(),a=n[s.args[1]].slice(),u=t[s.args[0]],c=t[s.args[1]],l=0,p=0;for(let f=0;f<o.length;f++){let d=o[f]&&!c[f],y=a[f]&&!u[f];o[f]=d,a[f]=y,d&&(l+=1),y&&(p+=1)}return l>=p?o:a}case 33:{let o=t[s.args[0]],a=n[s.args[1]],u=n[s.args[2]],c=[];for(let l=0;l<o.length;l++)c.push(!o[l]&&a[l]&&u[l]);return c}case 39:case 40:case 41:{let o=n[s.args[0]],a=t[s.args[1]],u=[];for(let c=0;c<a.length;c++)u.push(o[c]&&!a[c]);return u}case 48:{let o=s.args[0],a=e.getInstruction(o),u=r-o;return n[a.args[u]]}case 37:return HH(e,s,t,n,r);case 12:case 13:case 26:case 28:case 27:case 29:case 25:case 32:case 31:case 42:case 21:case 22:case 19:case 20:case 23:case 24:case 47:case 44:case 49:case 50:case 51:case 53:case 54:case 55:{let o=t[r],a=[];for(let u of o)a.push(!u);return a}default:let i=s;throw new Error(`Unexpected opcode ${i.type}`)}}function HH(e,t,n,r,s){switch(t.symbol){case"complex":{let i=iM(e.argNames.length);for(let o=0;o<t.args.length;o++){let a=r[t.args[o]];for(let u=0;u<a.length;u++)i[u]=i[u]&&a[u]}return i}default:{let i=n[s],o=[];for(let a of i)o.push(!a);return o}}}function zH(e){let t=[];for(let n=0;n<e;n++)t.push(!1);return t}function iM(e){let t=[];for(let n=0;n<e;n++)t.push(!0);return t}function Sn(e,t,n){switch(t){case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 21:case 19:case 23:case 50:return I;case 25:case 26:case 27:case 28:case 29:case 31:case 32:return De;case 33:{let s=e.getInstruction(n[1]).valueType,i=e.getInstruction(n[2]).valueType,o=Ha(s,i);return o===void 0?s:o}case 38:return jp(n.map(s=>e.getInstruction(s).valueType));case 39:case 40:case 41:{let s=e.getInstruction(n[0]).valueType;return j(s)?Ve(s):Qt}case 44:return ft;case 49:return ut;case 55:return e.getInstruction(n[0]).valueType;case 1:case 2:case 37:case 42:case 47:case 48:case 3:case 0:case 24:case 22:case 20:case 51:case 4:case 53:case 54:case 15:case 16:return Qt;default:let r=t;throw new Error(`Unexpected opcode ${r}`)}}function FN(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error("Programming Error: only the final instruction in a chunk can be lifted to numbers");let t=e.getInstruction(e.getReturnIndex());if(ge(t))return e.getReturnIndex();switch(t.type){case 8:let[n,r]=t.args;return cr(e,n)&&cr(e,r)?(e.popInstruction(),e.NativeFunction("complex",[e.Add([e.Slot(0,[n]),e.Slot(0,[r])]),e.Add([e.Slot(1,[n]),e.Slot(1,[r])])])):cr(e,n)&&rs(e,r)?(e.popInstruction(),e.NativeFunction("complex",[e.Add([e.Slot(0,[n]),r]),e.Slot(1,[n])])):rs(e,n)&&cr(e,r)?(e.popInstruction(),e.NativeFunction("complex",[e.Add([n,e.Slot(0,[r])]),e.Slot(1,[r])])):Uu(e,n)&&Uu(e,r)?(e.popInstruction(),e.TupleOfType(N,[e.Add([e.Slot(0,[n]),e.Slot(0,[r])]),e.Add([e.Slot(1,[n]),e.Slot(1,[r])])])):qu(e,n)&&qu(e,r)?(e.popInstruction(),e.TupleOfType(z,[e.Add([e.Slot(0,[n]),e.Slot(0,[r])]),e.Add([e.Slot(1,[n]),e.Slot(1,[r])]),e.Add([e.Slot(2,[n]),e.Slot(2,[r])])])):eu(e,t.args)?(e.popInstruction(),$u(e,[e.Add([Ss(e,n),Ss(e,r)]),$o(e,t.args[0])])):e.getReturnIndex();case 9:{let[i,o]=t.args;return cr(e,i)&&cr(e,o)?(e.popInstruction(),e.NativeFunction("complex",[e.Subtract([e.Slot(0,[i]),e.Slot(0,[o])]),e.Subtract([e.Slot(1,[i]),e.Slot(1,[o])])])):cr(e,i)&&rs(e,o)?(e.popInstruction(),e.NativeFunction("complex",[e.Subtract([e.Slot(0,[i]),o]),e.Slot(1,[i])])):rs(e,i)&&cr(e,o)?(e.popInstruction(),e.NativeFunction("complex",[e.Subtract([i,e.Slot(0,[o])]),e.Negative([e.Slot(1,[o])])])):Uu(e,i)&&Uu(e,o)?(e.popInstruction(),e.TupleOfType(N,[e.Subtract([e.Slot(0,[i]),e.Slot(0,[o])]),e.Subtract([e.Slot(1,[i]),e.Slot(1,[o])])])):qu(e,i)&&qu(e,o)?(e.popInstruction(),e.TupleOfType(z,[e.Subtract([e.Slot(0,[i]),e.Slot(0,[o])]),e.Subtract([e.Slot(1,[i]),e.Slot(1,[o])]),e.Subtract([e.Slot(2,[i]),e.Slot(2,[o])])])):eu(e,t.args)?(e.popInstruction(),$u(e,[e.Subtract([Ss(e,i),Ss(e,o)]),$o(e,i)])):e.getReturnIndex()}case 14:{let[i]=t.args;return cr(e,i)?(e.popInstruction(),e.NativeFunction("complex",[e.Negative([e.Slot(0,[i])]),e.Negative([e.Slot(1,[i])])])):Uu(e,i)?(e.popInstruction(),e.TupleOfType(N,[e.Negative([e.Slot(0,[i])]),e.Negative([e.Slot(1,[i])])])):qu(e,i)?(e.popInstruction(),e.TupleOfType(z,[e.Negative([e.Slot(0,[i])]),e.Negative([e.Slot(1,[i])]),e.Negative([e.Slot(2,[i])])])):eu(e,t.args)?(e.popInstruction(),$u(e,[e.Negative([Ss(e,i)]),$o(e,i)])):e.getReturnIndex()}case 10:{let[i,o]=t.args;if(cr(e,i)&&cr(e,o)){e.popInstruction();let a=e.Slot(0,[i]),u=e.Slot(1,[i]),c=e.Slot(0,[o]),l=e.Slot(1,[o]);return e.NativeFunction("complex",[e.Subtract([e.Multiply([a,c]),e.Multiply([u,l])]),e.Add([e.Multiply([a,l]),e.Multiply([c,u])])])}else{if(cr(e,i)&&rs(e,o))return e.popInstruction(),e.NativeFunction("complex",[e.Multiply([e.Slot(0,[i]),o]),e.Multiply([e.Slot(1,[i]),o])]);if(rs(e,i)&&cr(e,o))return e.popInstruction(),e.NativeFunction("complex",[e.Multiply([i,e.Slot(0,[o])]),e.Multiply([i,e.Slot(1,[o])])]);if(Yf(e,i)&&Yf(e,o))return e.popInstruction(),e.NativeFunction("restriction",[e.And([e.NativeFunction("restrictionToBoolean",[i]),e.NativeFunction("restrictionToBoolean",[o])])]);if(Yf(e,i)||Yf(e,o)){let a,u;Yf(e,i)?(a=i,u=o):(a=o,u=i);let c=e.getInstruction(u).valueType;return io(c)?(e.popInstruction(),e.Piecewise([e.NativeFunction("restrictionToBoolean",[a]),u,e.NanOfType(c)])):e.getReturnIndex()}else return Uu(e,i)&&rs(e,o)?(e.popInstruction(),e.TupleOfType(N,[e.Multiply([e.Slot(0,[i]),o]),e.Multiply([e.Slot(1,[i]),o])])):rs(e,i)&&Uu(e,o)?(e.popInstruction(),e.TupleOfType(N,[e.Multiply([i,e.Slot(0,[o])]),e.Multiply([i,e.Slot(1,[o])])])):eu(e,[i])&&rs(e,o)?(e.popInstruction(),$u(e,[e.Multiply([Ss(e,i),o]),$o(e,i)])):rs(e,i)&&eu(e,[o])?(e.popInstruction(),$u(e,[e.Multiply([i,Ss(e,o)]),$o(e,o)])):qu(e,i)&&rs(e,o)?(e.popInstruction(),e.TupleOfType(z,[e.Multiply([e.Slot(0,[i]),o]),e.Multiply([e.Slot(1,[i]),o]),e.Multiply([e.Slot(2,[i]),o])])):rs(e,i)&&qu(e,o)?(e.popInstruction(),e.TupleOfType(z,[e.Multiply([i,e.Slot(0,[o])]),e.Multiply([i,e.Slot(1,[o])]),e.Multiply([i,e.Slot(2,[o])])])):e.getReturnIndex()}}case 11:{let[i,o]=t.args;return cr(e,i)&&cr(e,o)?(e.popInstruction(),e.NativeFunction("complexDivide",[i,o])):cr(e,i)&&rs(e,o)?(e.popInstruction(),e.NativeFunction("complex",[e.Divide([e.Slot(0,[i]),o]),e.Divide([e.Slot(1,[i]),o])])):rs(e,i)&&cr(e,o)?(e.popInstruction(),e.NativeFunction("complexDivide",[e.NativeFunction("complex",[i,e.Constant(0)]),o])):Uu(e,i)&&rs(e,o)?(e.popInstruction(),e.TupleOfType(N,[e.Divide([e.Slot(0,[i]),o]),e.Divide([e.Slot(1,[i]),o])])):eu(e,[i])&&rs(e,o)?(e.popInstruction(),$u(e,[e.Divide([Ss(e,i),o]),$o(e,i)])):qu(e,i)&&rs(e,o)?(e.popInstruction(),e.TupleOfType(z,[e.Divide([e.Slot(0,[i]),o]),e.Divide([e.Slot(1,[i]),o]),e.Divide([e.Slot(2,[i]),o])])):e.getReturnIndex()}case 25:{let[i,o]=t.args;if(cr(e,i)&&cr(e,o)){e.popInstruction();let a=e.Slot(0,[i]),u=e.Slot(0,[o]),c=e.Slot(1,[i]),l=e.Slot(1,[o]);return e.And([e.Equal([a,u]),e.Equal([c,l])])}else if(rs(e,i)&&cr(e,o)){e.popInstruction();let a=i,u=e.Slot(0,[o]),c=e.Constant(0),l=e.Slot(1,[o]);return e.And([e.Equal([a,u]),e.Equal([c,l])])}else if(cr(e,i)&&rs(e,o)){e.popInstruction();let a=e.Slot(0,[i]),u=o,c=e.Slot(1,[i]),l=e.Constant(0);return e.And([e.Equal([a,u]),e.Equal([c,l])])}else return e.getReturnIndex()}case 28:case 29:{let[i,o]=t.args;if(cr(e,i)&&cr(e,o)){e.popInstruction();let a=t.type===28?e.Less(t.args):e.Greater(t.args);return e.Or([a,e.Equal(t.args)])}else return e.getReturnIndex()}case 12:case 13:case 26:case 27:case 32:case 31:case 15:case 33:case 16:case 37:case 42:case 39:case 40:case 41:case 21:case 22:case 19:case 20:case 38:case 47:case 23:case 24:case 48:case 44:case 49:case 50:case 51:case 53:case 54:case 55:return e.getReturnIndex();default:let s=t;throw new Error(`Unexpected opcode ${s.type}`)}}function Uu(e,t){return e.getInstruction(t).valueType===N}function qu(e,t){return e.getInstruction(t).valueType===z}function rs(e,t){return e.getInstruction(t).valueType===I}function cr(e,t){return e.getInstruction(t).valueType===R}function Yf(e,t){return e.getInstruction(t).valueType===Gt}function eu(e,t){return t.every(n=>gt(e,n,le))||t.every(n=>gt(e,n,ke))}function $u(e,t){return Ui(e,t,"mathVector",Xf("mathVector","mathVectorThreeD"))}function $o(e,t){return Ui(e,[t],"start",[{match:[le],build:()=>e.NativeFunction("basePointFromVector",[t])},{match:[ke],build:()=>e.NativeFunction("basePointFromVectorThreeD",[t])}])}function Ss(e,t){return Ui(e,[t],"displacement",[{match:[le],build:()=>e.NativeFunction("vectorDisplacementAsPoint",[t])},{match:[ke],build:()=>e.NativeFunction("vectorThreeDDisplacementAsPoint",[t])}])}function Xf(e,t){return[{match:[N,N],build:(n,r)=>n.NativeFunction(e,r)},{match:[z,z],build:(n,r)=>n.NativeFunction(t,r)}]}function Yu(e,t){if(t.type!==33)return!1;let n=e.getInstruction(t.args[2]);return n.type===1&&io(n.valueType)&&_S(n.valueType,n.value)||Yu(e,n)&&VN(e,t.args[1])&&VN(e,n.args[1])}function oM(e,t){let n=[];for(;t.type===33;)n.push(t.args[0]),t=e.getInstruction(t.args[2]);return n}function*gh(e,t){let n=e.getInstruction(t);n.type!==32?yield t:(yield*gh(e,n.args[0]),yield*gh(e,n.args[1]))}function BN(e,t){return e.getInstruction(t).type===25}function GN(e,t){let n=e.getInstruction(t);if(n.type!==25)return;let r=n.args[0],s=n.args[1],i=e.getInstruction(r),o=e.getInstruction(s),a=(o.type===41||o.type===40)&&Je(e.getInstruction(o.args[0]));return i.type===2&&(Je(o)||a)&&se(o.valueType,I)?{type:"constant",variable:e.argNames[r],index:s}:se(i.valueType,I)&&se(o.valueType,I)?{type:"implicit",index:e.Subtract([r,s])}:void 0}function VN(e,t){let n=e.getInstruction(t);return n.type===1&&n.valueType===I&&V(n.value)===1}var uM=class{constructor(t,n,r,s){this.openChunk=t;this.returnIndex=n;this.restrictionIndex=r;this.slices=s}getSliceVariablesOrImplicit(){return this.slices.map(t=>t.type==="constant"?t.variable:"_implicit")}getPeeledSlices(){let t=[];for(let n of this.slices)if(n.type==="constant"){let r=this.openChunk.getInstruction(n.index);if(Je(r)&&r.valueType===I)t.push({type:"constant",variable:n.variable,value:V(r.value)});else if(!(Je(r)&&r.valueType===ne))throw ca()}else if(this.openChunk.getInstruction(n.index).valueType===I){let s=this.openChunk.copy();s.setReturnIndex(n.index),s.fuseBroadcast(),t.push({type:"implicit",sliceChunk:s})}else throw ca();return t}getValueAndRestrictionChunk(){let t=this.getPeeledSlices(),n=this.openChunk.copy();n.setReturnIndex(this.returnIndex),n.fuseBroadcast();let r;return this.restrictionIndex!==void 0&&(r=this.openChunk.copy(),r.setReturnIndex(this.restrictionIndex),r.fuseBroadcast()),{valueChunk:n,restrictionChunk:r,slices:t}}getSlicesAndRestrictionChunk(){let t=this.getPeeledSlices(),n=this.openChunk.copy(),r=n.GreaterEqual([this.returnIndex,n.Constant(0)]);return this.restrictionIndex!==void 0&&(r=n.And([r,this.restrictionIndex])),n.setReturnIndex(r),n.fuseBroadcast(),{restrictionChunk:n,slices:t}}},hh=class{constructor(t,n,r){this.chunk=t;this.slices=[];this.oldIPtoNewIP=[];this.oldIPToRestriction=[];var s,i;this.produceNumbers=(s=r==null?void 0:r.produceNumbers)!=null?s:!1,this.allowSlices=(i=r==null?void 0:r.allowSlices)!=null?i:!1,this.newChunk=new Ia({argNames:t.argNames,argTypes:t.argTypes}),this.startTrue=this.produceNumbers?this.newChunk.Constant(1/0):this.newChunk.ConstantOfType(De,!0),this.peelable=$H(t),XH(t,this.peelable,n)}selectRestriction(){return!0}},cM=class extends hh{constructor(n,r,s){super(n,r,s);this.currSelectIndex=0;this.selectIndex=s.selectIndex}selectRestriction(){let n=this.selectIndex===this.currSelectIndex;return this.currSelectIndex++,this.produceNumbers?n:!n}};function tu(e,t,n){let r=new hh(e,t,n);lM(r,0,e.instructionsLength()-1);let s=r.oldIPToRestriction[e.getReturnIndex()];return new uM(r.newChunk,r.oldIPtoNewIP[e.getReturnIndex()],r.startTrue===s?void 0:s,r.slices)}function*kN(e,t,n){var s,i;let r=aM(e,n,{produceNumbers:!1,selectIndex:0});if(r===void 0||r.count<=1){yield{value:t,restriction:void 0};return}for(let o=0;o<r.count;o++){let a=(s=aM(e,n,{produceNumbers:!0,selectIndex:o}))==null?void 0:s.chunk,u=o===0?r.chunk:(i=aM(e,n,{produceNumbers:!1,selectIndex:o}))==null?void 0:i.chunk;if(!a||!u)throw new Error("Programming Error: selectIndex gave invalid chunk.");yield{value:a,restriction:u}}}function aM(e,t,n){let r=new cM(e,t,n);lM(r,0,e.instructionsLength()-1);let s=r.oldIPToRestriction[e.getReturnIndex()];if(r.currSelectIndex===0)return;let i=r.oldIPtoNewIP[e.getReturnIndex()],o=r.newChunk.getInstruction(i);if(o.type!==29)throw new Error("Programming Error: Expected GreaterEqual.");let a=r.produceNumbers?r.newChunk.Subtract([o.args[0],o.args[1]]):i;return r.selectRestriction()&&(s=bh(r,[s,a])),r.newChunk.setReturnIndex(s),{chunk:r.newChunk,count:r.currSelectIndex}}function lM(e,t,n){let{chunk:r,newChunk:s,peelable:i,oldIPtoNewIP:o,oldIPToRestriction:a}=e;for(let u=t;u<=n;u++){let c=r.getInstruction(u);if(i[u]&&(c.type===19||c.type===23))u=qH(e,u);else if(c.type===2)o[u]=u,a[u]=e.startTrue;else if(ge(c))o[u]=s.copyInstruction(c),a[u]=e.startTrue;else if(i[u]&&Yu(r,c)){o[u]=o[c.args[1]];let l=c.args.map(p=>a[p]);for(let p of ZH(e,c))e.selectRestriction()&&l.push(p);a[u]=bh(e,l)}else o[u]=s.copyInstructionWithArgs(c,c.args.map(l=>o[l])),a[u]=bh(e,c.args.map(l=>a[l]))}}function bh(e,t){let r=[...new Set(t)].filter(s=>!HN(e,s));return r.length?xh(e,r).reduce((s,i)=>e.produceNumbers?e.newChunk.NativeFunction("listMin",[s,i]):e.newChunk.And([s,i])):e.startTrue}function UH(e,t){let n=[...new Set(t)];return n.some(r=>!HN(e,r))?xh(e,n).reduce((r,s)=>e.produceNumbers?e.newChunk.NativeFunction("listMax",[r,s]):e.newChunk.Or([r,s])):e.startTrue}function xh(e,t){if(!e.produceNumbers)return t;let n=e.newChunk;return t.map(r=>{let s=n.getInstruction(r);if(s.valueType!==De)return r;switch(s.type){case 27:case 29:return n.Subtract([s.args[0],s.args[1]]);case 26:case 28:return n.Subtract([s.args[1],s.args[0]]);case 25:throw U("convertBoolsToNums on an equality.");case 32:return n.NativeFunction("listMin",xh(e,s.args));case 31:return n.NativeFunction("listMax",xh(e,s.args));case 1:return n.Constant(s.value?1/0:-1/0);default:throw U("convertBoolsToNums on a non-opcode condition.")}})}function HN({newChunk:e},t){let n=e.getInstruction(t);return n.type===1&&(n.valueType===I&&n.value===1/0||n.valueType===De&&n.value)}function qH(e,t){let{chunk:n,newChunk:r,oldIPtoNewIP:s,oldIPToRestriction:i,startTrue:o}=e,a=n.getInstruction(t),u=a.endIndex,c=n.getInstruction(u),l,p;if(a.type===23)s[t]=r.copyInstructionWithArgs(a,[s[a.args[0]]]),i[t]=o,p=t+1;else{let g=a.args.map(m=>s[m]);g.push(o),s[t]=r.copyInstructionWithArgs(a,g),i[t]=o;for(let m=2;m<a.args.length;m++){let h=t+m-1;s[h]=r.copyInstructionWithArgs(n.getInstruction(h),[s[t]]),i[h]=o}l=r.BlockVar(e.produceNumbers?I:De,[s[t]]),p=t+a.args.length-1}lM(e,p,u-1);let f=c.args.map(g=>s[g]),d=e.slices.filter(g=>p<=g.index&&g.index<u),y=l;if(a.type===19){if(l===void 0)throw new Error("Expected restrictionAccumVar to be defined");y=bh(e,[l,i[c.args[1]]]),f.push(y)}else{f.push(i[c.args[1]]);for(let g of d)f.push(g.index)}s[u]=r.copyInstructionWithArgs(c,f),i[u]=o;for(let g=1;g<c.args.length;g++)s[u+g]=r.copyInstructionWithArgs(n.getInstruction(u+g),[s[u]]);if(a.type===23){let g=r.BroadcastResult(e.produceNumbers?ne:Xn,[s[u]]);for(let m of d)m.index=r.BroadcastResult(ne,[s[u]]);for(let m=1;m<c.args.length;m++)i[u+m]=g}else{let g=r.BlockVar(e.produceNumbers?I:De,[s[u]]);l===y&&(g=o);for(let m=1;m<c.args.length;m++)i[u+m]=g}return u+c.args.length-1}function $H(e){let t=[];for(let r=0;r<e.instructionsLength();r++)t.push(!1);t[e.getReturnIndex()]=!0;let n=e.instructionsLength()-1;for(let r=n;r>=0;r--){if(!t[r])continue;let s=e.getInstruction(r);if(!ge(s))for(let i of YH(e,s))t[i]=!0}return t}function YH(e,t){switch(t.type){case 14:case 8:case 9:case 26:case 28:case 27:case 29:case 10:case 11:case 12:case 13:case 25:case 32:case 15:case 38:case 47:case 19:case 39:case 40:case 41:case 23:case 24:case 48:case 50:return t.args;case 33:return Yu(e,t)?oM(e,t).concat([t.args[1]]):[];case 37:{let r=Bn[t.symbol];return r.noPeel?[]:r.tag==="reducer"||r.tag==="doubleReducer"||r.tag==="never-broadcast"||r.tag==="parameterizedReducer"?t.args.filter(s=>e.getInstruction(s).type!==48):t.args}case 20:return t.args.slice(1);case 51:return[t.args[1]];case 31:return[];case 16:case 42:case 21:case 22:case 44:case 49:case 53:case 54:case 55:return[];default:let n=t;throw new Error(`Unexpected opcode ${n.type}`)}}function XH(e,t,n){let r=[];for(let s=0;s<e.argNames.length;s++){let i=e.argNames[s];n.indexOf(i)<0&&r.push(s)}for(let s of r){let i=Vu(e,s);for(let o=0;o<e.instructionsLength();o++)t[s]&&(t[s]=!i[o])}}function ZH(e,t){let n=oM(e.chunk,t).map(r=>e.oldIPtoNewIP[r]);if(e.allowSlices&&n.length===1){let r=GN(e.newChunk,n[0]);if(r)return e.slices.push(r),[]}if(n.some(r=>BN(e.newChunk,r)))throw ca();if(n.length===1){let r=n[0];return[...gh(e.newChunk,r)]}return[UH(e,n)]}function zN(e,t){let n=[],r=[],s=[];for(let o=0;o<e.argNames.length;o++)t.hasOwnProperty(e.argNames[o])||(n.push(e.argNames[o]),r.push(e.argTypes[o]));let i=new Ia({argNames:n,argTypes:r});for(let o=0,a=0;o<e.argNames.length;o++)t.hasOwnProperty(e.argNames[o])?s[o]=i.ConstantOfType(e.argTypes[o],t[e.argNames[o]]):(s[o]=a,a+=1);for(let o=e.argNames.length;o<e.instructionsLength();o++){let a=e.getInstruction(o);if(ge(a))s.push(po(i,a));else{let u=[];for(let c of a.args)u.push(s[c]);s.push(_n(i,a,u))}}return i}function li(e){let t=e;if(t&&typeof t.toJSON=="function"&&(t=t.toJSON()),!t||typeof t!="object")return t;if(Array.isArray(t))return t.map(li);let n={};for(let r in t)t.hasOwnProperty(r)&&(n[r]=li(t[r]));return n}var Th=class e{constructor(){this.maps={real:{},complexOne:{},complexI:{}}}clone(){let t=new e;return t.maps=li(this.maps),t}pruneIP(t){for(let n of Object.values(this.maps))delete n[t]}truncate(t){for(let n of Object.values(this.maps))for(let r in n){let s=+r;s>=t?delete n[s]:WH(n[s],t)}}getMapEntry(t,n,r){let s=this.maps[n],i=s[r];if(i)return i;let o={maxValidReference:t.instructionsLength()-1,map:[]};return s[r]=o,o}_cachedDerivativesForTests(){let t=[];for(let[n,r]of Object.entries(this.maps))for(let s in r)t.push(`${s} ${n}`);return t.sort(),t}};function WH(e,t){e.map.length=Math.min(e.map.length,t),e.maxValidReference=Math.min(e.maxValidReference,t-1)}var jH={"+":!0,"-":!0,"*":!0,"\\\\cdot":!0,"\\\\times":!0,"/":!0,"!":!0,"(":!0,")":!0,"\\\\{":!0,"\\\\}":!0,"(|":!0,"|)":!0,"[":!0,"]":!0,",":!0,"...":!0,":":!0,"=":!0,">":!0,"<":!0,">=":!0,"<=":!0,"->":!0,"~":!0,"%":!0,".":!0,for:!0,with:!0,Letter:!0,Decimal:!0,Cmd:!0,TokenNode:!0,Differential:!0,End:!0,Trig:!0,Ln:!0,Log:!0,Int:!0,Sum:!0,Prod:!0,Err:!0};function $K(e){let t=nu[e];if(!t)return!0;switch(t){case"Ln":case"Log":case"for":case"with":case"Trig":return!0;default:return!1}}var nu={"\\\\lt":"<","\\\\gt":">","\\\\le":"<=","\\\\ge":">=","\\\\leq":"<=","\\\\geq":">=","\\\\ldots":"...","\\\\sim":"~","\\\\to":"->","\\\\cdot":"\\\\cdot","\\\\times":"\\\\times","\\\\div":"/","\\\\ln":"Ln","\\\\log":"Log","\\\\int":"Int","\\\\sum":"Sum","\\\\prod":"Prod","\\\\backslash":"Err","\\\\for":"for","\\\\with":"with"},JH=["sin","cos","tan","cot","sec","csc"];for(let e of JH)nu["\\\\"+e]="Trig",nu["\\\\"+e+"h"]="Trig",nu["\\\\arc"+e]="Trig",nu["\\\\arc"+e+"h"]="Trig",nu["\\\\ar"+e+"h"]="Trig";function YK(e){return e==="\\\\log"||e==="\\\\prod"||e==="\\\\sum"||e==="\\\\int"}var pM={"+":"+","-":"-","*":"*","/":"/","!":"!","(":"(",")":")","[":"[","]":"]",",":",","...":"...",":":":","=":"=",">=":">=","<=":"<=",">":">","<":"<","~":"~",".":"."},UN={"\\\\{":"\\\\{","\\\\}":"\\\\}","\\\\%":"%"},qN={"|":"(|","\\\\{":"\\\\{","[":"[","(":"("},$N={"|":"|)","\\\\}":"\\\\}","]":"]",")":")"},YN=Object.keys(jH);function XN(e){return 48<=e&&e<=57}function QH(e){return 97<=e&&e<=122}function KH(e){return 65<=e&&e<=90}function Ih(e){return QH(e)||KH(e)}function Ph(e){return e===92}function dM(e){return e===39}function ZN(e){if(9<=e&&e<=13||8192<=e&&e<=8202)return!0;switch(e){case 32:case 160:case 5760:case 8232:case 8233:case 8239:case 8287:case 12288:case 65279:return!0;default:return!1}}var ez={mcd:"gcd",gcf:"gcd",mcm:"lcm",signum:"sign",sgn:"sign",stdDevP:"stdevp",stddevp:"stdevp",stdDev:"stdev",stddev:"stdev",variance:"var",TTest:"ttest",TScore:"tscore",IndependentTTest:"ittest",iTTest:"ittest",inverseCdf:"quantile",inversecdf:"quantile",arsinh:"arcsinh",arcosh:"arccosh",artanh:"arctanh",arcsch:"arccsch",arsech:"arcsech",arcoth:"arccoth"};function WN(e){let t=0;for(;Ph(e.charCodeAt(t));)t+=1;return t>0&&(e=e.slice(t)),ez[e]||e}function jN(e,t,n){return{type:"Comparator",span:e,symbol:t,args:n}}function JN(e,t,n){if(t.length<1)throw"Programming Error: ComparatorChain must have at least one comparator.";if(n.length!==t.length+1)throw"Programming Error: ComparatorChain must have one more arg than symbols";return{type:"ComparatorChain",span:e,args:n,symbols:t}}function QN(e,t){return{type:"Tilde",span:e,args:t}}function KN(e,t){return{type:"Pos",span:e,args:t}}function eR(e,t){return{type:"Neg",span:e,args:t}}function tR(e,t){return{type:"Add",span:e,args:t}}function nR(e,t){return{type:"Sub",span:e,args:t}}function rR(e,t){return{type:"Mul",span:e,args:t}}function sR(e,t){return{type:"DotMul",span:e,args:t}}function iR(e,t){return{type:"CrossMul",span:e,args:t}}function oR(e,t){return{type:"Div",span:e,args:t}}function aR(e,t){return{type:"Bang",span:e,args:t}}function Zf(e,t){return{type:"Call",span:e,args:t}}function fM(e,t){return{type:"ImplicitCall",span:e,args:t}}function uR(e,t){return{type:"Index",span:e,args:t}}function mM(e,t){return{type:"Paren",span:e,args:t}}function yM(e,t){return{type:"List",span:e,args:t}}function cR(e,t){return{type:"Pipes",span:e,args:t}}function gM(e,t){return{type:"Subscript",span:e,args:t}}function Eh(e,t){return{type:"Superscript",span:e,args:t}}function Wf(e,t,n){return{type:"Prime",span:e,nprimes:t,args:n}}function Mh(e,t){return{type:"Seq",span:e,args:t}}function lR(e,t){return{type:"Sqrt",span:e,args:t}}function pR(e,t){return{type:"Nthroot",span:e,args:t}}function dR(e,t){return{type:"Frac",span:e,args:t}}function fR(e,t){return{type:"Derivative",span:e,args:t}}function mR(e,t){return{type:"Integral",span:e,args:t}}function yR(e,t){return{type:"EmptyIntegral",span:e,args:t}}function gR(e,t){return{type:"Sum",span:e,args:t}}function hR(e,t){return{type:"Product",span:e,args:t}}function bR(e,t){return{type:"Piecewise",span:e,args:t}}function xR(e){return{type:"EmptyPiecewise",span:e}}function TR(e){return{type:"EmptyRangeEnd",span:e}}function IR(e,t){return{type:"Colon",span:e,args:t}}function hM(e,t){return{type:"Ellipsis",span:e,args:t}}function PR(e,t){return{type:"For",span:e,args:t}}function ER(e,t){return{type:"With",span:e,args:t}}function MR(e,t){return{type:"Dot",span:e,args:t}}function CR(e,t){return{type:"PercentOf",span:e,args:t}}function DR(e,t){return{type:"RightArrow",span:e,args:t}}function bM(e,t){return{type:"Juxt",span:e,args:t}}function SR(e,t){return{type:"Letter",span:e,val:t}}function Ch(e,t){return{type:"Decimal",span:e,val:t}}function gl(e,t){return{type:"Cmd",span:e,val:WN(t)}}function vR(e,t){return{type:"Alphanumeric",span:e,val:t}}function OR(e,t,n,r){return{type:"MixedNumber",span:e,whole:t,num:n,den:r}}function lr(e){if(e.type==="Subscript"){if(e.args[1].type!=="Alphanumeric")return!1;e=e.args[0]}switch(e.type){case"Cmd":return!0;case"Letter":return!0;default:return!1}}function NR(e){return e.type!=="Superscript"?!1:lr(e.args[0])}function RR(e,t){if(e.type!=="Letter"||e.val!=="d"||t.type!=="Juxt")return!1;let[n,r]=t.args;return n.type!=="Letter"||n.val!=="d"?!1:lr(r)}function Sr(e){return e.type==="Seq"?e.args:[e]}function AR(e,t,n,r,s,i,o,a){return{opts:e,input:t,prevSpan:n,startIndex:r,endIndex:s,token:i,mode:o,parent:a}}function Pe(e,t){return Bs(e.token.span,t.prevSpan)}function er(e,t){return Bs(e,t.prevSpan)}function TM(e){return No(e.token.span.input,e.token.span.start)}function nz(e,t){return{type:"Differential",span:e,val:t}}function vs(e,t,n){return{type:e,span:t,val:n}}function ru(e,t){let n=No(e.span.input,e.span.start);return IM(t,e,0,n,void 0,void 0)}function IM(e,t,n,r,s,i){let o=t.args;if(n>o.length&&i)return _R(i,r);n=jf(o,n);let{token:a,endIndex:u}=LR(t,n,s);if(a.type==="End"&&i){let c=i.input.args[i.startIndex];if(c.type==="LeftRight"){let l=c.right,p=$N[l.val]||"Err",f=vs(p,l.span,l.val);return AR(e,t,r,n,u,f,s,i)}}else a.type==="Int"?s=rz(s):a.type==="Differential"&&(s=sz(s));return AR(e,t,r,n,u,a,s,i)}function Xe(e){let t=e.input.args[e.startIndex],n=e.token.span;return t&&t.type==="LeftRight"?IM(e.opts,t.arg,0,n,e.mode,e):_R(e,n)}function _R(e,t){let{input:n,endIndex:r,mode:s,parent:i}=e;return IM(e.opts,n,r+1,t,s,i)}function ss(e){return e.token}function rz(e){return{type:"integral",parent:e}}function sz(e){if(!e||e.type!=="integral")throw new Error("Programming Error: expected lexer to be in integral mode.");return e.parent}function Hr(e,t){return ss(e).type===t}function vh(e){return e.startIndex>=e.input.args.length}function PM(e,t){return t.token.span.start>e.token.span.start}function xr(e,t){return{token:t,endIndex:e}}function LR(e,t,n){let r=e.args;if(t>=r.length){let i=No(e.span.input,e.span.end);return xr(t,vs("End",i,""))}let s=e.args[t];switch(s.type){case"Sqrt":case"Frac":case"SupSub":return xr(t,s);case"Letter":{if(!n||n.type!=="integral"||s.val!="d")return xr(t,s);let{endIndex:c,token:l}=LR(e,t+1,n);if(l.type==="Letter"||l.type==="Cmd"){let p=nz(Bs(s.span,l.span),l.val);return xr(c,p)}else return xr(t,s)}case"LeftRight":{let c=s.left,l=qN[c.val]||"Err",p=Bs(s.span,c.span);return xr(t,vs(l,p,c.val))}case"OperatorName":let i=[];for(let c of s.arg.args){if(c.type!=="Letter")return xr(t,vs("Err",s.span,Yn(s.arg.span)));i.push(c.val)}let o="\\\\"+i.join(""),a=nu[o]||"Cmd";return xr(t,vs(a,s.span,o));case"TokenNode":{let c="$";if(s.arg.args.length===0)return xr(t,vs("Err",s.span,Yn(s.arg.span)));for(let l of s.arg.args){if(l.type!=="Digit")return xr(t,vs("Err",s.span,Yn(s.arg.span)));c+=l.val}return xr(t,vs("TokenNode",s.span,c))}case"Cmd":{let c=nu[s.val]||"Cmd";return xr(t,vs(c,s.span,s.val))}case"EscapedSymbol":{let c=UN[s.val]||"Err";return xr(t,vs(c,s.span,s.val))}case"Symbol":return iz(e,t,s);case"Digit":return wR(e,t);default:throw`Unexpected atom ${s.type}.`}}function iz(e,t,n){switch(n.val){case".":return oz(e,t);case"-":{let s=e.args[t+1];if(s&&Dh(s,">")){let i=vs("->",Bs(n.span,s.span),"->");return xr(t+1,i)}break}case"<":{let s=e.args[t+1];if(s&&Dh(s,"=")){let i=vs("<=",Bs(n.span,s.span),"<=");return xr(t+1,i)}break}case">":{let s=e.args[t+1];if(s&&Dh(s,"=")){let i=vs(">=",Bs(n.span,s.span),">=");return xr(t+1,i)}break}}let r=pM[n.val]||"Err";return xr(t,vs(r,n.span,n.val))}function oz(e,t){let n=e.args[t];if(n.type!=="Symbol"||n.val!==".")throw new Error("Programming Error: expected \'.\'");if(t+2<e.args.length&&Sh(e.args[t+1])&&Sh(e.args[t+2])){let i=Bs(n.span,e.args[t+2].span);return xr(t+2,vs("...",i,Yn(i)))}let r=jf(e.args,t+1);if(r<e.args.length&&e.args[r].type==="Digit")return wR(e,t);let s=pM[n.val]||"Err";return xr(t,vs(s,n.span,n.val))}function wR(e,t){let n=az(e,t);if(n)return n;let r=e.args,s=e.args[t].span,i=[],o=!1,a=!1;for(;t<r.length;t++){let c=jf(r,t);if(c>=r.length)break;let l=r[c];if(l.type==="Digit")t=c,o=!0,i.push(l.val);else if(!a&&Sh(l)){if(c+1<r.length&&Sh(e.args[c+1]))break;t=c,a=!0,i.push(".")}else break}if(!o)throw new Error("Programming Error: decimals must have at least one digit.");let u=Bs(s,e.args[t-1].span);return xr(t-1,vs("Decimal",u,i.join("")))}function az(e,t){let n=e.args,r=n[t].span,s=[];for(;t<n.length;t++){let c=jf(n,t);if(c>=n.length)break;let l=n[c];if(l.type!=="Digit")break;t=c,s.push(l.val)}if(t=jf(n,t),t>=n.length)return;let i=n[t];if(i.type!=="Frac")return;let o=[],a=[];for(let c of i.num.args)if(!xM(c)){if(c.type!=="Digit")return;o.push(c.val)}for(let c of i.den.args)if(!xM(c)){if(c.type!=="Digit")return;a.push(c.val)}let u=Bs(r,i.span);return xr(t,OR(u,s.join(""),o.join(""),a.join("")))}function xM(e){switch(e.type){case"Sqrt":case"Frac":case"SupSub":case"LeftRight":case"OperatorName":case"TokenNode":case"Symbol":case"Letter":case"Digit":return!1;case"Cmd":return e.val==="\\\\space";case"EscapedSymbol":return e.val==="\\\\ "||e.val==="\\\\:"||e.val==="\\\\,"||e.val==="\\\\;";default:throw`Unexpected atom ${e.type}.`}}function jf(e,t){for(;t<e.length&&xM(e[t]);)t+=1;return t}function Sh(e){return Dh(e,".")}function Dh(e,t){return e.type==="Symbol"&&e.val===t}var Kp={},uz=["sin","cos","tan","cot","sec","csc","sinh","cosh","tanh","coth","sech","csch"];uz.forEach(e=>{Kp[e]="arc"+e,Kp["arc"+e]=e});var cz=0;function zR(e,t){return lz(e,t)}function It(e,t){let n=[];for(let r=0;r<t.length;r++)n.push(mn(e,t[r]));return n}function FR(e,t,n){let r=e.nodes,[s,i]=It(e,t);if(Rh(n)){let o=No(n.span.input,n.span.end),a=e.setInput(XR(e),o);i=e.setInput(r.SeededFunctionCall(i,[a]),n.span)}return[s,i]}function lz(e,t){return e.setInput(pz(e,t),t.span)}function UR(e){if(e.type!=="Call")return;let[t,n]=e.args,r=Sr(n);if(lr(t)&&r.every(lr))return{base:t,args:r}}function qR(e){return UR(e)!==void 0}function CM(e){return lr(e)}function pz(e,t){let n=e.nodes;switch(t.type){case"Comparator":if(t.symbol==="="){let[r,s]=t.args,i=UR(r);if(i){let{base:o,args:a}=i,u=It(e,a),c=e;if(e.includeFunctionParametersInRandomSeed)for(let p of u)c=Kf(c,{prefix:"fc",expr:p});let l=mn(c,s);return n.FunctionDefinition(mn(e,o),u,l)}else{if(r.type==="Call"&&lr(r.args[0]))return n.CallAssignment(mn(e,r),mn(e,s));if(CM(r)){let o;return s.type==="For"?o=e.setInput(Oh(e,s,{parentIsList:!1}),s.span):o=mn(e,s),n.Assignment(mn(e,r),o)}}return n.Equation(mn(e,r),mn(e,s))}else return Ca(e,t);case"Tilde":{let[r,s]=It(e,t.args);return n.Regression(r,s)}case"ComparatorChain":{if(!e.specializeDoubleInequalities||t.symbols.length!==2)return Ca(e,t);let[r,s,i]=t.args,[o,a]=t.symbols;return!lr(s)||t.symbols.includes("=")?Ca(e,t):n.DoubleInequality([mn(e,r),o,mn(e,s),a,mn(e,i)])}case"Call":{let[r,s]=t.args;if(r.type==="Cmd")switch(r.val){case"histogram":return n.Histogram(It(e,Sr(s)));case"dotplot":return n.DotPlot(It(e,Sr(s)));case"boxplot":return n.BoxPlot(It(e,Sr(s)));case"ttest":return n.TTest(It(e,Sr(s)));case"ittest":return n.IndependentTTest(It(e,Sr(s)));case"stats":return n.Stats(It(e,Sr(s)));default:return Jf(e,t)}return Jf(e,t)}case"For":return Oh(e,t,{parentIsList:!1});default:return Jf(e,t)}}function $R(e){if(e.type!=="Paren")return!1;let[t]=e.args;return t.type!=="Seq"?!1:t.args.length===2||t.args.length===3}function VR(e,t,n,r){let s=dz(e,n,r);if(s!==void 0)return e.setInput(s,Bs(t.args[0].span,r.span))}function dz(e,t,n){let r=e.nodes;if(n.type==="Letter")switch(n.val){case"x":case"y":case"z":return r.NamedCoordinateAccess(n.val,[t])}else if(n.type==="Cmd")switch(n.val){case"real":case"imag":throw nT(n.val)}}function mn(e,t){return e.setInput(Jf(e,t),t.span)}function Jf(e,t){let n=e.nodes;switch(t.type){case"Pos":return mn(e,t.args[0]);case"Neg":let r=-1,s=t.args[0];for(;;)if(s.type==="Pos"||s.type==="Paren"&&!$R(s))s=s.args[0];else if(s.type==="Neg")s=s.args[0],r*=-1;else break;switch(s.type){case"Decimal":{let o=kR(s);return n.Constant(r===-1?Us(o):o)}case"MixedNumber":{let o=HR(s);return n.MixedNumber(r===-1?Us(o):o)}default:return r===-1?n.Negative([mn(e,s)]):mn(e,s)}case"Add":return n.Add(It(e,t.args));case"Sub":return n.Subtract(It(e,t.args));case"Mul":return n.Multiply(It(e,t.args));case"DotMul":return n.DotMultiply(It(e,t.args));case"CrossMul":return n.CrossMultiply(It(e,t.args));case"Div":return n.Divide(It(e,t.args));case"Bang":{let[o]=t.args;return o.type==="Call"&&lr(o.args[0])&&!Rh(o.args[0])&&Sr(o.args[1]).length===1?n.FunctionFactorial(It(e,o.args)):n.FunctionCall("\\\\factorial",It(e,t.args))}case"PercentOf":return n.PercentOf(It(e,t.args));case"Call":return BR(e,t);case"ImplicitCall":return bz(t),BR(e,t);case"Dot":{let o=t.args[1],[a,u]=FR(e,t.args,o);if(o.type==="Letter")switch(o.val){case"x":case"y":case"z":return n.NamedCoordinateAccess(o.val,[a]);default:break}else if(o.type==="Call"){let c=o.args[0],l=VR(e,t,a,c);if(l!==void 0)return n.Multiply([l,mn(e,o.args[1])])}return n.DotAccess([a,u])}case"Prime":{let[o]=t.args;if(o.type==="Call"){let[a,u]=o.args,c=Sr(u).length;if(a.type==="Cmd"&&a.val==="logbase"){if(c!==2)throw Nc()}else if(c!==1)throw Nc();return n.Prime(t.nprimes,It(e,t.args))}else throw o.type==="ImplicitCall"?Cy():My()}case"Index":{let[o,a]=t.args;if(a.type==="Seq")return n.ListAccess([mn(e,o),e.setInput(n.List(It(e,a.args)),void 0)]);if(a.type==="Ellipsis"){let[u,c]=a.args;return n.ListAccess([mn(e,o),e.setInput(n.Range([e.setInput(n.List(It(e,Sr(u))),void 0),e.setInput(n.List(c.type==="EmptyRangeEnd"?[]:It(e,Sr(c))),void 0)]),void 0)])}return Qf(a)?n.ListAccess([mn(e,o),e.setInput(Ca(e,a),void 0)]):n.ListAccess(It(e,t.args))}case"Paren":{let[o]=t.args;if(o.type==="Seq"){if(o.args.length===0)throw Yd();return n.ParenSeq(It(e,o.args))}else return mn(e,o)}case"List":{if(t.args.length===0)return n.List([]);let o=t.args[0];if(o.type==="Ellipsis"){let[a,u]=o.args;return n.Range([e.setInput(n.List(It(e,Sr(a))),void 0),e.setInput(n.List(It(e,Sr(u))),void 0)])}else if(o.type==="For")return Oh(e,o,{parentIsList:!0});return n.List(It(e,Sr(o)))}case"Pipes":{let[o]=t.args;return n.Norm([mn(e,o)])}case"Subscript":{let[o,a]=t.args;if(a.val.length===0)throw Ey();let u;switch(o.type){case"Letter":u=o.val;break;case"Cmd":u=o.val;break;default:throw lI()}if(u==="ans")throw ks("ans");return n.Identifier(`${u}_${a.val}`)}case"Superscript":{let[o,a]=t.args;if(o.type==="Call"&&o.args[1].type!=="Seq"&&!Rh(o.args[0])&&!xz(o))return n.FunctionExponent(It(e,[o.args[0],o.args[1],a]));if(o.type==="Dot"){let u=o.args[1],[c,l]=FR(e,o.args,u),p=mn(e,a);if(u.type==="Letter")switch(u.val){case"x":case"y":case"z":return n.Exponent([e.setInput(n.NamedCoordinateAccess(u.val,[c]),o.span),p]);default:break}else if(u.type==="Call"){let f=u.args[0],d=VR(e,o,c,f);if(d!==void 0)return n.Multiply([d,e.setInput(n.Exponent([mn(e,u.args[1]),p]),Vs(t.span.input,u.args[0].span.end,a.span.end))])}return n.Exponent([e.setInput(n.DotAccess([c,l]),o.span),p])}else return n.Exponent(It(e,t.args))}case"Sqrt":return n.FunctionCall("sqrt",It(e,t.args));case"Nthroot":return n.FunctionCall("nthroot",It(e,[t.args[1],t.args[0]]));case"Frac":return n.Divide(It(e,t.args));case"Derivative":{let o=It(e,t.args);if(!lr(t.args[0]))throw U(`Expected identifier in derivative, but found ${t.args[0].type}`);return n.Derivative(o[0],[o[1]])}case"Integral":{let[o,a,u,c]=t.args,l=It(e,[o,a,u,c]);return n.Integral(l)}case"EmptyIntegral":{let[o,a,u]=It(e,t.args),c=e.setInput(n.Constant(Se(1,1)),void 0);return n.Integral([o,a,u,c])}case"Sum":{let[o,a,u]=t.args;if(a.type!=="Comparator"||!ed(a))throw aP();let c=It(e,[a.args[0],a.args[1],u]),l=mn(Kf(e,{prefix:"ro",expr:c[0]}),o);return n.Sum(c.concat(l))}case"Product":{let[o,a,u]=t.args;if(a.type!=="Comparator"||!ed(a))throw uP();let c=It(e,[a.args[0],a.args[1],u]),l=mn(Kf(e,{prefix:"ro",expr:c[0]}),o);return n.Product(c.concat(l))}case"Juxt":{if(e.writeIntegral){let[u,c]=t.args;if(c.type==="Letter"&&c.val==="t"&&u.type==="Juxt"&&([u,c]=u.args,c.type==="Letter"&&c.val==="n")){if(u.type==="Juxt"){if([u,c]=u.args,c.type==="Letter"&&c.val==="i")throw Gy()}else if(u.type==="Letter"&&u.val==="i")throw Gy()}}let[o,a]=t.args;if(o.type==="MixedNumber"&&!(lr(a)||a.type==="Piecewise"||a.type==="Call"||a.type==="Paren"))throw Ty(Nh(o));if(a.type==="MixedNumber")throw Ty(Nh(a));return n.Multiply(It(e,t.args))}case"Letter":return n.Identifier(t.val);case"Cmd":{let o=t.val;switch(o){case"ans":{if(e.currentIndex===void 0)throw Kd("ans");return n.Ans(`ans_{${e.currentIndex-1}}`)}case"approx":throw uy(o);case"dt":{if(!e.allowDt)throw Kd(o);return n.Identifier(o)}case"index":{if(!e.allowIndex)throw Kd(o);return n.Identifier(o)}default:return n.Identifier(o)}}case"With":{if(e.isSubstitutionRHS)throw $y();let[o,a]=t.args,u={...e,isSubstitutionRHS:!0};return n.Substitution(mn(u,o),yz(u,a))}case"Decimal":return n.Constant(kR(t));case"MixedNumber":return n.MixedNumber(HR(t));case"Piecewise":return hz(e,t);case"RightArrow":return gz(e,t);case"Seq":return n.BareSeq(It(e,t.args));case"EmptyPiecewise":return n.Restriction([e.setInput(n.Constant(!0),No(t.span.input,t.span.start))]);case"Comparator":throw t.symbol==="="?ks("="):cy();case"ComparatorChain":throw t.symbols.includes("=")?wx():cy();case"Tilde":throw ks("~");case"Colon":throw ks(":");case"Ellipsis":throw ks("...");case"For":return Oh(e,t,{parentIsList:!1});case"EmptyRangeEnd":throw sP();case"Err":throw Tz(t.error);default:throw`Unexpected surface node ${t.type}.`}}function EM(e){return Kp.hasOwnProperty(e)}function YR(e){return e==="ln"||e==="log"||e==="logbase"}function fz(e){return e.type==="Decimal"&&e.val==="2"}function mz(e){return e.type!=="Neg"?!1:(e=e.args[0],e.type==="Decimal"&&e.val==="1")}function BR(e,t){let n=e.nodes,[r,s]=t.args,i=mn(e,r),o=Sr(s),a=It(e,o);if(Rh(r)){let u=No(s.span.input,s.span.start),c=e.setInput(XR(e),u);return n.SeededFunctionCall(i,[c].concat(a))}if(lr(r))return n.FunctionCall(i,a);if(r.type==="Superscript"){let[u,c]=r.args;if(u.type==="Cmd"){let l=u.val;if(EM(l)||YR(l)){if(fz(c))return n.Exponent([e.setInput(n.FunctionCall(l,a),void 0),mn(e,c)]);if(mz(c)&&Kp[l]!==void 0)return n.FunctionCall(Kp[l],a);throw EM(l)?gI(l):hI(l==="logbase"?"log":l)}}}return n.Multiply([i,mn(e,s)])}function Oh(e,t,{parentIsList:n}){let r=e.nodes,[s,i]=t.args,o=e.setInput(r.Identifier(`_comprehensionIndex_${cz++}`),void 0);if(s.type==="For")throw yu("for");let a=mn(Kf(e,{prefix:"li",expr:o}),s),u=[];if(i.type==="Seq"){let p=!1,f=!1,d=!1;for(let y=0;y<i.args.length;y++){let g=i.args[y];ed(g)||e.allowIntervalComprehensions&&g.type==="ComparatorChain"?p=!0:f=!0,g.type==="Cmd"&&g.val==="cursor"&&(d=!0)}if(p&&f){let y=yu("for");throw d&&y.setCursorContext({type:"for-assignment-lhs",allowedTypes:[N]}),y}}let c=[];for(let p of Sr(i))if(e.allowIntervalComprehensions&&p.type==="ComparatorChain"){let f=MM(p),{min:d,identifier:y,max:g,open:m}=f;c.push({identifier:mn(e,y),bounds:[mn(e,d),mn(e,g)],open:m})}else if(p.type==="Comparator"&&ed(p)){let f=e.setInput(r.AssignmentExpression(It(e,p.args)),p.span);u.push(f)}else{if(p.type==="Comparator")throw Jl("a");{let f=vP();throw p.type==="Cmd"&&p.val==="cursor"&&f.setCursorContext({type:"for-assignment-lhs",allowedTypes:[N]}),f}}let l=n;return r.ListComprehension(o,a,u,l,c)}function yz(e,t){let n=e.nodes;if(t.type==="Seq"){let i=!1,o=!1,a=!1;for(let u=0;u<t.args.length;u++){let c=t.args[u];if(c.type==="With")throw yu("with");if(ed(c)||GR(c))i=!0;else if(e.allowIntervalComprehensions&&c.type==="ComparatorChain")try{MM(c),o=!0}catch(l){a=!0}else a=!0}if((i||o)&&a)throw yu("with");if(o)throw Yy()}if(e.allowIntervalComprehensions&&t.type==="ComparatorChain"){let i;try{MM(t),i=!0}catch(o){i=!1}if(i)throw Yy()}if(t.type==="With")throw $y();let r=Sr(t),s=[];for(let i of r){if(i.type!="Comparator"||!ed(i)&&!GR(i))throw of();let o=e.setInput(n.AssignmentExpression(It(e,i.args)),i.span);s.push(o)}return s}function GR(e){if(e.type!=="Comparator"||e.symbol!=="=")return!1;let t=e.args[0];if(t.type!=="Call")return!1;let[n]=t.args;return!!lr(n)}function MM(e){if(e.symbols.length!==2)throw Jl("a");let[t,n,r]=e.args,[s,i]=e.symbols;if(!lr(n))throw Jl("a");if(s!=="<"&&s!=="<="||i!=="<"&&i!=="<="||e.symbols.includes("="))throw Jl(Yn(n.span));return{min:t,identifier:n,max:r,open:[s==="<",i==="<"]}}function gz(e,t){let n=e.nodes;if(!lr(t.args[0]))throw MT();return e=Kf(e,{prefix:"ec",expr:e.setInput(n.Identifier("globalEventCount"),void 0)}),n.UpdateRule(It(e,t.args))}function hz(e,t){let n=e.nodes,[r]=t.args,s=Sr(r);if(s.length===1&&Qf(s[0])){let f=s[0];return n.Restriction([e.setInput(Ca(e,f),f.span)])}if(s.length>1&&s.every(Qf)){let f=e.setInput(Ca(e,s[0]),s[0].span);for(let d=1;d<s.length;d++){let y=e.setInput(Ca(e,s[d]),s[d].span);f=e.setInput(n.Or([f,y]),Bs(s[0].span,s[d].span))}return n.Restriction([f])}let i,o=[];e:for(i=0;i<s.length;i++){let f=s[i];switch(f.type){case"Colon":{let[d,y]=f.args;if(!Qf(d))throw TI();if(y.type==="With"&&y.args[1].type==="Seq")throw yu("with");o.push({condition:e.setInput(Ca(e,d),d.span),if_expr:mn(e,y)});break}case"Comparator":case"ComparatorChain":o.push({condition:e.setInput(Ca(e,f),f.span),if_expr:e.setInput(n.Constant(Se(1,1)),Vs("1",0,1))});break;case"For":throw yu("for");default:break e}}if(i===0)throw bI();if(i<s.length-1)throw xI();let a,u;i===s.length-1?(a=Jf(e,s[i]),u=s[i]):a=n.Constant(NaN);let c=a,l=u==null?void 0:u.span,p;for(;o.length;)p=o.pop(),c=n.Piecewise([p.condition,p.if_expr,e.setInput(c,l)]),l=void 0;return c}function Qf(e){return e.type==="Comparator"||e.type==="ComparatorChain"}function Ca(e,t){let n=e.nodes;switch(t.type){case"Comparator":return n.Comparator[t.symbol](It(e,t.args));case"ComparatorChain":return n.ComparatorChain(t.symbols,It(e,t.args));default:throw U(`Unexpected type for condition: ${t.type}`)}}function bz(e){let[t,n]=e.args;if(t.type==="Superscript"&&(t=t.args[0]),t.type==="Cmd"&&t.val==="logbase"&&n.type==="Seq"&&n.args.length===2){if(!Yo(n.args[0]))throw xy("log")}else if(!Yo(n))throw t.type==="Cmd"?xy(t.val):U(`Unexpected type for args of implicit call: ${n.type}`)}function kR(e){return Qc(e.val)}function HR(e){let t=Qc(e.whole),n=Qc(e.num),r=Qc(e.den);return qs(t,Ps(n,r))}function xz(e){if(e.type!=="Call")return!1;let t=e.args[0];for(;t.type==="Superscript"||t.type==="Subscript"||t.type==="Prime";)t=t.args[0];return t.type!=="Cmd"?!1:EM(t.val)||YR(t.val)}function ed(e){return e.type==="Comparator"&&e.symbol==="="&&lr(e.args[0])}function Tz(e){switch(e.type){case"UnexpectedParseError":case"MissingBound":case"EmptyGroup":case"UnexpectedDifferential":case"UnexpectedEnd":return U(`Unexpected error type: ${e.type}`);case"InvalidOperatorName":return cI();case"UnexpectedCloseDelimiter":case"MissingCloseDelimiter":return bP(e.open,e.close);case"UnrecognizedSymbol":return e.val==="."?ks(e.val):uy(e.val);case"EmptyInput":return Xd();case"BinaryOperatorMissingRight":case"BinaryOperatorMissingLeft":return $d(e.val==="%"?"% of":e.val);case"UnaryOperatorMissingLeft":return nI(e.val);case"UnaryOperatorMissingRight":return rI(e.val);case"UnexpectedSubscript":return EI(e.base);case"PercentMissingOf":return TP();case"SumMissingBound":return iP();case"ProductMissingBound":return oP();case"IntegralMissingBound":return pP();case"SumMissingBody":return mP();case"ProductMissingBody":return yP();case"IntegralMissingBody":return gP();case"DerivativeMissingBody":return hP();case"IntegralMissingDifferential":return dP();case"DifferentialWithSuperscript":return fP();case"FractionMissingNumerator":return sI();case"FractionMissingDenominator":return iI();case"FractionEmpty":return oI();case"EmptySuperscript":return aI();case"EmptySubscript":return Ey();case"InvalidSubscript":return uI(e.val);case"SuperscriptWithPrime":return pI();case"PrimeWithoutParen":return Cy();case"UnexpectedPrime":return My();case"EmptyRadical":return dI();case"EmptyRadicalIndex":return fI();case"EmptySquareBracket":return mI();case"EmptyPipe":return yI();case"FunctionMissingArgument":return Ao(e.val,1,0,{includeUsageExample:!0});case"AdjacentNumbers":return eI(Nh(e.args[0]),Nh(e.args[1]));case"TokenWithSubscript":return tI();case"UnexpectedFor":return ks("for");default:throw`Unexpected surface node ${e.type}.`}}function Nh(e){switch(e.type){case"Decimal":return e.val;case"MixedNumber":return`${e.whole} ${e.num}/${e.den}`;default:let t=e;throw new Error(`Unexpected node type ${t.type}`)}}function Yo(e){switch(e.type){case"Letter":case"Decimal":case"MixedNumber":case"Cmd":case"EmptyPiecewise":return!0;case"Neg":{let n=e.args[0];for(;;)if(n.type==="Pos"||n.type==="Paren"&&!$R(n))n=n.args[0];else if(n.type==="Neg")n=n.args[0];else break;return n.type==="Decimal"||n.type==="MixedNumber"}case"Pos":return Yo(e.args[0]);case"Paren":return Yo(e.args[0]);case"Juxt":case"Mul":case"DotMul":case"CrossMul":case"Div":return Yo(e.args[0])&&Yo(e.args[1]);case"Subscript":return Yo(e.args[0]);case"Superscript":case"Frac":case"Add":case"Sub":return Yo(e.args[0])&&Yo(e.args[1]);case"Piecewise":{let[n]=e.args;return Qf(n)}case"Call":{let[n,r]=e.args;return lr(n)||NR(n)?!1:Yo(n)&&Yo(r)}case"Derivative":case"Sqrt":case"Nthroot":case"Pipes":case"Bang":return!1;case"Comparator":case"ComparatorChain":case"Tilde":case"ImplicitCall":case"Index":case"List":case"Seq":case"Integral":case"EmptyIntegral":case"Sum":case"Product":case"Colon":case"Ellipsis":case"For":case"With":case"Dot":case"PercentOf":case"Prime":case"EmptyRangeEnd":case"RightArrow":return!1;default:throw`Unexpected surface node ${e.type}.`}}function Rh(e){return e.type!=="Cmd"?!1:e.val==="random"||e.val==="shuffle"}function XR(e){let t=e.nodes.ExtendSeed("",[e.setInput(e.nodes.Identifier("globalRandomSeed"),void 0),e.setInput(e.nodes.Seed(e.nextSeed()),void 0)]);if(!e.seedExtensions)return t;for(let{prefix:n,expr:r}of e.seedExtensions)t=e.nodes.ExtendSeed(n,[e.setInput(t,void 0),r]);return t}function Kf(e,t){let n=e.seedExtensions||[];return{...e,seedExtensions:n.concat(t)}}function td(e){return{type:"initial",tokenType:e}}function em(e){return{type:"l",tokenType:e}}function tm(e){return{type:"r",tokenType:e}}function nn(e){return{type:"la",tokenType:e}}function nd(e){return{type:"ra",tokenType:e}}function ZR(e,t){for(let n of YN)if(t[n]===void 0)throw new Error(`Programming Error: token ${n} must be a assigned a ${e} precedence`)}function hl(e,t,n,r){if(t[n]!==void 0)throw new Error(`Programming Error: duplicate ${e} entry for token ${n}.`);t[n]=r}function WR(e){let t={},n={},r={};for(let a=0;a<e.length;a++){let u=e[a];for(let{type:c,tokenType:l}of u)switch(c){case"initial":hl("initial",t,l,a);break;case"l":hl("left",n,l,a);break;case"r":hl("right",r,l,a);break;case"la":hl("left",n,l,a),hl("right",r,l,a);break;case"ra":hl("left",n,l,a),hl("right",r,l,a-1);break}}ZR("left",n),ZR("right",r);function s(a){return r[a]}function i(a){return n[a]}function o(a){let u=t[a];return u===void 0?s(a):u}return{rightPrec:s,leftPrec:i,initialPrec:o}}function Be(e,t){return{type:"Err",span:e,error:t}}function DM(){return{type:"UnexpectedParseError"}}function jR(){return{type:"EmptyInput"}}function JR(){return{type:"EmptyGroup"}}function SM(){return{type:"EmptySubscript"}}function QR(){return{type:"EmptySuperscript"}}function vM(){return{type:"EmptyRadical"}}function KR(){return{type:"EmptySquareBracket"}}function eA(){return{type:"EmptyPipe"}}function tA(){return{type:"EmptyRadicalIndex"}}function OM(){return{type:"UnexpectedEnd"}}function bl(e){return{type:"BinaryOperatorMissingRight",val:e}}function nA(e){return{type:"BinaryOperatorMissingLeft",val:e}}function NM(e){return{type:"UnaryOperatorMissingRight",val:e}}function RM(e){return{type:"UnaryOperatorMissingLeft",val:e}}function rA(e,t){return{type:"MissingCloseDelimiter",open:e,close:t}}function nm(e,t){return{type:"UnexpectedCloseDelimiter",open:e,close:t}}function sA(){return{type:"UnexpectedDifferential"}}function iA(e){return{type:"UnrecognizedSymbol",val:e}}function oA(e){return{type:"InvalidSubscript",val:e}}function aA(e){return{type:"UnexpectedSubscript",base:e}}function AM(e){return{type:"FunctionMissingArgument",val:e}}function uA(){return{type:"PercentMissingOf"}}function _M(){return{type:"PrimeWithoutParen"}}function cA(){return{type:"SuperscriptWithPrime"}}function Ah(){return{type:"UnexpectedPrime"}}function lA(){return{type:"SumMissingBound"}}function pA(){return{type:"ProductMissingBound"}}function LM(){return{type:"MissingBound"}}function dA(){return{type:"IntegralMissingBound"}}function fA(){return{type:"SumMissingBody"}}function mA(){return{type:"ProductMissingBody"}}function yA(){return{type:"IntegralMissingBody"}}function gA(){return{type:"DerivativeMissingBody"}}function hA(){return{type:"IntegralMissingDifferential"}}function bA(){return{type:"DifferentialWithSuperscript"}}function xA(){return{type:"FractionMissingNumerator"}}function TA(){return{type:"FractionMissingDenominator"}}function IA(){return{type:"FractionEmpty"}}function wM(e){return{type:"AdjacentNumbers",args:e}}function PA(){return{type:"UnexpectedFor"}}function EA(){return{type:"TokenWithSubscript"}}var Pz=[[td("("),nn(")"),td("\\\\{"),nn("\\\\}"),tm("["),nn("]"),td("(|"),nn("|)"),nn("Differential"),nn("End")],[nn("for")],[tm("with")],[nd("...")],[nn(",")],[nd(":")],[tm("->")],[em("with")],[nn("="),nn(">"),nn("<"),nn(">="),nn("<="),nn("~")],[em("->")],[nn("+"),nn("-")],[nn("*"),nn("\\\\cdot"),nn("\\\\times"),nn("/"),nn("Decimal"),nn("MixedNumber"),nn("Letter"),nn("Cmd"),nn("TokenNode"),nn("%"),tm("("),nn("\\\\{"),nn("(|"),nn("Frac"),nn("Sqrt"),nn("Trig"),nn("Ln"),nn("Log"),nd("Int"),nd("Sum"),nd("Prod")],[td("+"),td("-")],[nn("!")],[nn("SupSub")],[em("["),nn(".")],[em("(")],[nn("Err")]],{leftPrec:_h,rightPrec:MA,initialPrec:vA}=WR(Pz),CA={trailingComma:!1};function OA(e,t){let n=t?{...CA,...t}:CA,r=ru(e,n),s=Ez(r);return s.type==="Err"&&s.error.type==="EmptyGroup"?Be(s.span,jR()):s}function Ez(e){return Xu(e,{isToplevel:!0})}function Xu(e,{isToplevel:t}={isToplevel:!1}){if(vh(e))return Be(Pe(e,e),JR());let{state:n,tree:r}=pr(e,0,{isToplevel:t});return r.type!=="Err"&&!vh(n)?VM(n).tree:r}function H(e,t){return{state:e,tree:t}}function pr(e,t,{isToplevel:n}={isToplevel:!1}){let r=e,s;if({state:r,tree:s}=Mz(r),s.type==="Err")return H(r,s);if(!PM(e,r))throw new Error("Programming Error: parseInitial did not advance state.");for(;!vh(r);){let i;if(Hr(r,"(")&&!Sz(s)?i=MA("("):i=_h(ss(r).type),t>=i)break;let o=r,a=Cz(r,s,n)?_h("for")-1:MA(ss(r).type);if({state:r,tree:s}=Dz(r,s,a),s.type==="Err")return H(r,s);if(!PM(o,r))throw new Error("Programming Error: parseSuccessor did not advance state.")}return H(r,s)}function Ei(e){return e.type==="UnexpectedDifferential"||e.type==="UnexpectedCloseDelimiter"||e.type==="UnexpectedEnd"||e.type==="BinaryOperatorMissingLeft"}function Mz(e){let t=e,n=ss(e),r=vA(n.type),s;switch(n.type){case"+":{if(e=Xe(e),{state:e,tree:s}=pr(e,r),s.type==="Err"){if(!Ei(s.error))return H(e,s);let o=Pe(t,e),a=Be(o,NM(n.val));return H(e,a)}return H(e,KN(Pe(t,e),[s]))}case"-":if(e=Xe(e),{state:e,tree:s}=pr(e,r),s.type==="Err"){if(!Ei(s.error))return H(e,s);let o=Pe(t,e),a=Be(o,NM(n.val));return H(e,a)}else return H(e,eR(Pe(t,e),[s]));case"(":return rm(e);case"\\\\{":return e=Xe(e),Hr(e,"\\\\}")?(e=Xe(e),H(e,xR(Pe(t,e)))):({state:e,tree:s}=pr(e,r),{state:e,tree:s}=sm(t,e,s,"\\\\{","\\\\}"),s.type==="Err"?H(e,s):H(e,bR(Pe(t,e),[s])));case"[":return e=Xe(e),Hr(e,"]")?(e=Xe(e),H(e,yM(Pe(t,e),[]))):({state:e,tree:s}=pr(e,r),{state:e,tree:s}=sm(t,e,s,"[","]"),s.type==="Err"?H(e,s):H(e,yM(Pe(t,e),[s])));case"(|":{if(e=Xe(e),Hr(e,"|)")){e=Xe(e);let o=Pe(t,e);return H(e,Be(o,eA()))}return{state:e,tree:s}=pr(e,r),{state:e,tree:s}=sm(t,e,s,"(|","|)"),s.type==="Err"?H(e,s):H(e,cR(Pe(t,e),[s]))}case"Frac":{if(e.opts.disallowFrac)throw Uy();e=Xe(e);let o=Xu(ru(n.num,e.opts)),a=Xu(ru(n.den,e.opts));if(o.type==="Err"&&o.error.type==="EmptyGroup"&&a.type==="Err"&&a.error.type==="EmptyGroup"){let u=Pe(t,e),c=Be(u,IA());return H(e,c)}if(o.type==="Err"&&o.error.type==="EmptyGroup"){let u=Pe(t,e),c=Be(u,xA());return H(e,c)}if(a.type==="Err"&&a.error.type==="EmptyGroup"){let u=Pe(t,e),c=Be(u,TA());return H(e,c)}if(o.type==="Err")return H(e,o);if(a.type==="Err")return H(e,a);if(RR(o,a)&&a.type==="Juxt"){let u=a.args[1],c;if({state:e,tree:c}=pr(e,_h("*")-1),c.type==="Err"){if(Ei(c.error)){let l=Pe(t,e);return H(e,Be(l,gA()))}return H(e,c)}return H(e,fR(Pe(t,e),[u,c]))}return H(e,dR(Pe(t,e),[o,a]))}case"Sqrt":if(e=Xe(e),n.optArg){let o=Xu(ru(n.optArg,e.opts));if(o.type==="Err")return o.error.type==="EmptyGroup"?H(e,Be(o.span,tA())):H(e,o);let a=Xu(ru(n.arg,e.opts));return a.type==="Err"?a.error.type==="EmptyGroup"?H(e,Be(a.span,vM())):H(e,a):H(e,pR(Pe(t,e),[o,a]))}else{let o=Xu(ru(n.arg,e.opts));return o.type==="Err"?o.error.type==="EmptyGroup"?H(e,Be(o.span,vM())):H(e,o):H(e,lR(Pe(t,e),[o]))}case"Trig":case"Ln":{e=Xe(e);let o=gl(Pe(t,e),n.val),a=0,u=ss(e);if(u.type==="SupSub"){if(e=Xe(e),u.sub){let p=Pe(t,e),f=Be(p,aA(o.val));return H(e,f)}let l=Lh(u,e.opts);if(l){if(l.type==="Err")return H(e,l);o=Eh(Pe(t,e),[o,l])}a=u.nprimes}let c=Hr(e,"(");if(c){if({state:e,tree:s}=rm(e),s.type==="Err")return H(e,s);s=Zf(Pe(t,e),[o,s.args[0]])}else{if({state:e,tree:s}=pr(e,r-1),s.type==="Err")return Ei(s.error)?H(e,Be(Pe(t,e),AM(n.val))):H(e,s);s=fM(Pe(t,e),[o,s])}if(a>0){let l=Pe(t,e);if(!c){let p=Be(l,_M());return H(e,p)}s=Wf(l,a,[s])}return H(e,s)}case"Log":{e=Xe(e);let o=Pe(t,e),a=gl(o,n.val),u=0,c,l,p=ss(e);if(p.type==="SupSub"&&(e=Xe(e),c=NA(p,e.opts),l=Lh(p,e.opts),u=p.nprimes),c&&c.type==="Err")return H(e,c);if(l&&l.type==="Err")return H(e,l);let f=Hr(e,"(");if(f){if({state:e,tree:s}=rm(e),s.type==="Err")return H(e,s);s=s.args[0]}else if({state:e,tree:s}=pr(e,r-1),s.type==="Err")return Ei(s.error)?H(e,Be(Pe(t,e),AM(n.val))):H(e,s);let d=c?gl(o,"\\\\logbase"):a,y=c?Mh(Pe(t,e),Sr(s).concat(c)):s;if(l&&(d=Eh(Pe(t,e),[d,l])),f?s=Zf(Pe(t,e),[d,y]):s=fM(Pe(t,e),[d,y]),u>0){let g=Pe(t,e);if(!f){let m=Be(g,_M());return H(e,m)}s=Wf(g,u,[s])}return H(e,s)}case"Int":{e=Xe(e);let o=ss(e);e=Xe(e);let a=FM(o,t,e);if(a.type==="Err")return a.error.type==="MissingBound"?H(e,Be(a.span,dA())):H(e,a);let{sup:u,sub:c}=a,l;if(Hr(e,"Differential"))return{state:e,tree:l}=SA(e),l.type==="Err"?H(e,l):H(e,yR(Pe(t,e),[l,c,u]));if({state:e,tree:s}=pr(e,r),s.type==="Err")return Ei(s.error)?H(e,Be(s.span,yA())):H(e,s);let p=s;return Hr(e,"Differential")?({state:e,tree:l}=SA(e),l.type==="Err"?H(e,l):H(e,mR(Pe(t,e),[l,c,u,p]))):H(e,Be(Pe(t,e),hA()))}case"Sum":{e=Xe(e);let o=ss(e);e=Xe(e);let a=FM(o,t,e);if(a.type==="Err")return a.error.type==="MissingBound"?H(e,Be(a.span,lA())):H(e,a);let{sup:u,sub:c}=a;return{state:e,tree:s}=pr(e,r),s.type==="Err"?Ei(s.error)?H(e,Be(s.span,fA())):H(e,s):H(e,gR(Pe(t,e),[s,c,u]))}case"Prod":{e=Xe(e);let o=ss(e);e=Xe(e);let a=FM(o,t,e);if(a.type==="Err")return a.error.type==="MissingBound"?H(e,Be(a.span,pA())):H(e,a);let{sup:u,sub:c}=a;return{state:e,tree:s}=pr(e,r),s.type==="Err"?Ei(s.error)?H(e,Be(s.span,mA())):H(e,s):H(e,hR(Pe(t,e),[s,c,u]))}case"Cmd":return e=Xe(e),s=gl(Pe(t,e),n.val),H(e,s);case"TokenNode":{e=Xe(e);let o=ss(e);return o.type==="SupSub"&&o.sub?(e=Xe(e),H(e,Be(Pe(t,e),EA()))):(s=gl(Pe(t,e),n.val),H(e,s))}case"Letter":return e=Xe(e),s=SR(Pe(t,e),n.val),H(e,s);case"Decimal":{e=Xe(e);let o=Ch(Pe(t,e),n.val),a=e.token;if(a.type==="Decimal"||a.type==="MixedNumber"){let u=e;e=Xe(e);let c=Pe(t,e),l=a.type==="MixedNumber"?a:Ch(Pe(u,e),a.val);return H(e,Be(c,wM([o,l])))}if(n.val.endsWith(".")&&a.type==="Cmd"&&(a.val==="\\\\real"||a.val==="\\\\imag"))throw ly();return H(e,o)}case"MixedNumber":{if(e.opts.disallowFrac)throw Uy();e=Xe(e);let o=e.token;if(o.type==="Decimal"||o.type==="MixedNumber"){let a=e;e=Xe(e);let u=Pe(t,e),c=o.type==="MixedNumber"?o:Ch(Pe(a,e),o.val);return H(e,Be(u,wM([n,c])))}return H(e,n)}case"*":case"\\\\cdot":case"\\\\times":case"/":case",":case"=":case">":case"<":case">=":case"<=":case"->":case"~":case":":case"...":case"%":case".":{e=Xe(e);let o=Pe(t,e),a=Be(o,nA(n.val));return H(e,a)}case"for":{e=Xe(e);let o=Pe(t,e),a=Be(o,PA());return H(e,a)}case"with":{e=Xe(e);let o=Pe(t,e),a=Be(o,DM());return H(e,a)}case"!":{e=Xe(e);let o=Pe(t,e),a=Be(o,RM(n.val));return H(e,a)}case"SupSub":{e=Xe(e);let o="supsub";n.sub?o="subscript":n.sup?o="superscript":n.nprimes>0&&(o="prime");let a=Pe(t,e),u=Be(a,RM(o));return H(e,u)}case")":case"\\\\}":case"]":case"|)":case"Differential":return VM(e);case"Err":{e=Xe(e);let o=Pe(t,e),a=Be(o,iA(n.val));return H(e,a)}case"End":{let o=Pe(t,e),a=Be(o,OM());return H(e,a)}default:throw`Unexpected token type ${n.type}.`}}function Cz(e,t,n){return Hr(e,"=")&&n&&(qR(t)||CM(t))}function Dz(e,t,n){let r=ss(e),s;switch(r.type){case"+":case"-":case"*":case"\\\\cdot":case"\\\\times":case"/":case"~":case":":case".":case"->":case"for":{if(e=Xe(e),{state:e,tree:s}=pr(e,n),s.type==="Err")if(Ei(s.error)){let o=er(t.span,e),a=Be(o,bl(r.val));return H(e,a)}else return H(e,s);return H(e,DA(r.type,er(t.span,e),[t,s]))}case"with":{if(e=Xe(e),{state:e,tree:s}=pr(e,n),s.type==="Err")if(Ei(s.error)){let o=er(t.span,e),a=Be(o,bl(r.val));return H(e,a)}else return H(e,s);return H(e,DA(r.type,er(t.span,e),[t,s]))}case"%":{e=Xe(e);let o=ss(e);if(o.type!=="Cmd"||o.val!=="of"&&o.val!=="\\\\of"){let a=Be(r.span,uA());return H(e,a)}if(e=Xe(e),{state:e,tree:s}=pr(e,n),s.type==="Err")if(Ei(s.error)){let a=er(t.span,e),u=Be(a,bl(r.val));return H(e,u)}else return H(e,s);return H(e,CR(er(t.span,e),[t,s]))}case"=":case">=":case"<=":case">":case"<":{let o=[t],a=[];for(;;){let c=ss(e).type;if(c!=="="&&c!==">="&&c!=="<="&&c!==">"&&c!=="<")break;if(a.push(c),e=Xe(e),{state:e,tree:s}=pr(e,n),s.type==="Err")if(Ei(s.error)){let l=er(t.span,e),p=Be(l,bl(r.val));return H(e,p)}else return H(e,s);o.push(s)}let u=o[o.length-1];return u.type==="Comparator"?(o.pop(),Array.prototype.push.apply(o,u.args),a.push(u.symbol)):u.type==="ComparatorChain"&&(o.pop(),Array.prototype.push.apply(o,u.args),Array.prototype.push.apply(a,u.symbols)),o.length===2?H(e,jN(er(t.span,e),a[0],o)):H(e,JN(er(t.span,e),a,o))}case"!":return e=Xe(e),H(e,aR(er(t.span,e),[t]));case"[":{let o=e;if(e=Xe(e),Hr(e,"]")){e=Xe(e);let a=Pe(o,e);return H(e,Be(a,KR()))}return{state:e,tree:s}=pr(e,n),{state:e,tree:s}=sm(o,e,s,"[","]"),s.type==="Err"?H(e,s):H(e,uR(er(t.span,e),[t,s]))}case"Sqrt":case"Frac":case"Letter":case"Cmd":case"TokenNode":case"Trig":case"Ln":case"Log":case"Sum":case"Int":case"Prod":case"Decimal":case"MixedNumber":case"\\\\{":case"(|":return{state:e,tree:s}=pr(e,n),s.type==="Err"?H(e,s):H(e,bM(er(t.span,e),[t,s]));case"(":if(lr(t)){if({state:e,tree:s}=rm(e),s.type==="Err")return H(e,s);let o=er(t.span,e);return H(e,Zf(o,[t,s.args[0]]))}else if(t.type==="Prime"&&lr(t.args[0])){if({state:e,tree:s}=rm(e),s.type==="Err")return H(e,s);let o=er(t.span,e);return H(e,Wf(o,t.nprimes,[Zf(o,[t.args[0],s.args[0]])]))}else return{state:e,tree:s}=pr(e,n),s.type==="Err"?H(e,s):H(e,bM(er(t.span,e),[t,s]));case"SupSub":{e=Xe(e);let o=RA(r),a=Lh(r,e.opts);if(o&&o.type==="Err")return H(e,o);if(a&&a.type==="Err")return H(e,a);if(o&&(t=gM(er(t.span,e),[t,o])),a&&(t=Eh(er(t.span,e),[t,a])),r.nprimes>0){let u=er(t.span,e);if(!lr(t)){let c=Be(u,Ah());return H(e,c)}t=Wf(u,r.nprimes,[t])}return H(e,t)}case",":{let o=[t];for(;Hr(e,",")&&(e=Xe(e),!(Hr(e,"...")||e.opts.trailingComma&&vz(e)));){if({state:e,tree:s}=pr(e,n),s.type==="Err")if(Ei(s.error)){let a=er(t.span,e),u=Be(a,bl(r.val));return H(e,u)}else return H(e,s);o.push(s)}return H(e,Mh(er(t.span,e),o))}case"...":{if(e=Xe(e),Hr(e,",")&&(e=Xe(e)),n>=_h(ss(e).type))return H(e,hM(er(t.span,e),[t,TR(TM(e))]));if({state:e,tree:s}=pr(e,n),s.type==="Err")if(Ei(s.error)){let o=er(t.span,e),a=Be(o,bl(r.val));return H(e,a)}else return H(e,s);return H(e,hM(er(t.span,e),[t,s]))}case"]":case")":case"\\\\}":case"|)":case"Differential":return VM(e);case"Err":return pr(e,n);case"End":{let o=Pe(e,e),a=Be(o,OM());return H(e,a)}default:throw`Unexpected token type ${r.type}.`}}function Sz(e){return!!(lr(e)||e.type==="Prime"&&lr(e.args[0]))}function DA(e,t,n){switch(e){case"+":return tR(t,n);case"-":return nR(t,n);case"*":return rR(t,n);case"\\\\cdot":return sR(t,n);case"\\\\times":return iR(t,n);case"/":return oR(t,n);case"~":return QN(t,n);case":":return IR(t,n);case".":switch(n[0].type){case"Decimal":case"MixedNumber":throw ly();default:return MR(t,n)}case"->":return DR(t,n);case"for":return PR(t,n);case"with":return ER(t,n);default:throw`Unexpected token type ${e}.`}}function NA(e,t){if(!e.sub)return;let n=e.sub,r=Xu(ru(n,t));return r.type==="Err"&&r.error.type==="EmptyGroup"?Be(r.span,SM()):r}function RA(e){if(!e.sub)return;let t=e.sub;if(t.args.length===0)return Be(t.span,SM());let n=[];for(let r of t.args)if(r.type==="Digit"||r.type==="Letter")n.push(r.val);else{let s=r.span;return Be(s,oA(Yn(s)))}return vR(t.span,n.join(""))}function Lh(e,t){if(!e.sup)return;let n=Xu(ru(e.sup,t));return n.type==="Err"?n.error.type==="EmptyGroup"?Be(n.span,QR()):n:e.nprimes>0?Be(e.span,cA()):n}function FM(e,t,n){if(e.type!=="SupSub"){let i=Pe(t,n);return Be(i,LM())}if(e.nprimes>0){let i=Pe(t,n);return Be(i,Ah())}let r=NA(e,n.opts),s=Lh(e,n.opts);if(!r||r.type==="Err"&&r.error.type==="EmptySubscript"||!s||s.type==="Err"&&s.error.type==="EmptySuperscript"){let i=Pe(t,n);return Be(i,LM())}return r.type==="Err"?r:s.type==="Err"?s:{type:"Bounds",sup:s,sub:r}}function rm(e){if(e.opts.disableParentheses)throw DP();let t=e,n=ss(e),r=vA(n.type);if(Hr(e,"("))e=Xe(e);else throw new Error("Programming Error: expected \'(\' at start of parseParen.");if(Hr(e,")")){let i=Mh(TM(e),[]);e=Xe(e);let o=Pe(t,e);return H(e,mM(o,[i]))}let s;return{state:e,tree:s}=pr(e,r),{state:e,tree:s}=sm(t,e,s,"(",")"),s.type==="Err"?H(e,s):H(e,mM(Pe(t,e),[s]))}function SA(e){let t=e,n=ss(e);if(n.type!=="Differential")throw new Error("Programming Error: expected differential");e=Xe(e);let r=gl(n.span,n.val),s=ss(e);if(s.type==="SupSub"){e=Xe(e);let i=Pe(t,e),o=RA(s);if(o){if(o.type==="Err")return H(e,o);r=gM(i,[r,o])}if(s.sup)return H(e,Be(i,bA()));if(s.nprimes>0)return H(e,Be(i,Ah()))}return H(e,r)}function sm(e,t,n,r,s){if(n.type==="Err"&&n.error.type!=="UnexpectedEnd")return H(t,n);if(n.type==="Err"||!Hr(t,s)){let i=Pe(e,t),o=Be(i,rA(r,s));return H(t,o)}return t=Xe(t),H(t,n)}function VM(e){let t=e;switch(ss(e).type){case")":{e=Xe(e);let r=Pe(t,e);return H(e,Be(r,nm("(",")")))}case"]":{e=Xe(e);let r=Pe(t,e);return H(e,Be(r,nm("[","]")))}case"\\\\}":{e=Xe(e);let r=Pe(t,e);return H(e,Be(r,nm("\\\\{","\\\\}")))}case"|)":{e=Xe(e);let r=Pe(t,e);return H(e,Be(r,nm("|","|")))}case"Differential":{e=Xe(e);let r=Pe(t,e);return H(e,Be(r,sA()))}default:{e=Xe(e);let r=Pe(t,e);return H(e,Be(r,DM()))}}}function vz(e){return Hr(e,")")||Hr(e,"]")||Hr(e,"\\\\}")}function Zu(e,t){return Bs(e.token.span,t.prevSpan)}function Da(e,t,n){return{type:e,span:t,val:n}}function Oz(e,t,n,r){return{input:e,prevSpan:t,pos:n,token:r}}function AA(e){return _A(e,0,No(e,0))}function _A(e,t,n){for(;ZN(e.charCodeAt(t));)t+=1;let r=Rz(e,t);return Oz(e,n,t,r)}function mo(e){return _A(e.input,e.token.span.end,e.token.span)}function Xo(e){return e.token}function Zo(e,t){if(Xo(e).type!==t)throw`Parse Error: expected ${t}.`;return mo(e)}function BM(e,t){return Xo(e).type===t}function wh(e){return e.pos>=e.input.length}var Nz={"[":"[","]":"]","{":"{","}":"}","^":"^",_:"_"};function Rz(e,t){let n=t;if(t>=e.length)return Da("End",No(e,t),"");let r=e.charCodeAt(t);if(XN(r)){let s=Vs(e,n,t+1);return Da("Digit",s,e.charAt(n))}else if(Ih(r)){let s=Vs(e,n,t+1);return Da("Letter",s,e.charAt(n))}else if(Ph(r))if(t+=1,Ih(e.charCodeAt(t))){for(;Ih(e.charCodeAt(t));)t+=1;let s=Vs(e,n,t),i=Yn(s);return Da(i==="\\\\left"?"Left":i==="\\\\right"?"Right":"Cmd",s,i)}else{t+=1;let s=Vs(e,n,t),i=Yn(s);return Da("EscapedSymbol",s,i)}else if(dM(r)){for(t+=1;dM(e.charCodeAt(t));)t+=1;if(e.charAt(t)==="^"){t+=1;let s=Vs(e,n,t),i=Yn(s);return Da("Primes^",s,i)}else{let s=Vs(e,n,t),i=Yn(s);return Da("Primes",s,i)}}else{let s=Vs(e,n,t+1),i=e.charAt(n),o=Nz[i]||"Symbol";return Da(o,s,i)}}function GM(e,t){return{type:"Group",span:e,args:t}}function LA(e,t,n){return{type:"Sqrt",span:e,optArg:t,arg:n}}function wA(e,t,n){return{type:"Frac",span:e,num:t,den:n}}function FA(e,t,n,r){return{type:"SupSub",span:e,sup:t,sub:n,nprimes:r}}function VA(e,t,n,r){return{type:"LeftRight",span:e,left:t,right:n,arg:r}}function BA(e,t){return{type:"OperatorName",span:e,arg:t}}function GA(e,t){return{type:"TokenNode",span:e,arg:t}}function kA(e,t){return{type:"Symbol",span:e,val:t}}var kM={type:"primitive",errorName:"^"},HA={type:"primitive",errorName:"_"},_z={"\\\\frac":{type:"macro",errorName:"\\\\frac",expandsToSingleAtom:!0},"\\\\operatorname":{type:"macro",errorName:"\\\\operatorname",expandsToSingleAtom:!1},"\\\\token":{type:"macro",errorName:"\\\\token",expandsToSingleAtom:!1}};function zA(e){let t=Xo(e);if(t.type==="Cmd")return t.val==="\\\\sqrt"?BM(mo(e),"[")?{type:"macro",errorName:"\\\\sqrt[*]",expandsToSingleAtom:!1}:{type:"primitive",errorName:"\\\\sqrt"}:_z[t.val];if(t.type==="^"||t.type==="Primes^")return kM;if(t.type==="_")return HA}function UA(e){let{state:t,tree:n}=Fh(AA(e),!1);if(!wh(t))throw`Parse error: unexpected ${Yn(Xo(t).span)}.`;return n}function qi(e,t){return{state:e,tree:t}}function Fh(e,t){let n=e,r=[];e:for(;!wh(e);){let i=Xo(e);switch(i.type){case"Cmd":case"EscapedSymbol":case"Letter":case"Digit":case"Symbol":case"[":case"{":case"^":case"_":case"Primes":case"Primes^":case"Left":case"]":{if(i.type==="]"&&t)break e;let a;if({state:e,tree:a}=qA(e),a.type==="Group")for(let u of a.args)r.push(u);else r.push(a);break}case"}":case"Right":case"End":break e;default:throw`Unexpected token type ${i.type}.`}}let s=Zu(n,e);return qi(e,GM(s,r))}function qA(e){let t=Xo(e);switch(t.type){case"EscapedSymbol":case"Letter":case"Digit":case"Symbol":return e=mo(e),qi(e,t);case"[":case"]":return e=mo(e),qi(e,kA(t.span,t.val));case"{":{e=mo(e);let r;return{state:e,tree:r}=Fh(e,!1),e=Zo(e,"}"),qi(e,r)}case"^":case"_":case"Primes":case"Primes^":return kz(e);case"Left":return Gz(e);case"Cmd":return Lz(e);case"}":case"Right":throw`Parse Error: unexpected ${t.val}.`;case"End":throw"Parse Error: unexpected end.";default:throw`Unexpected token type ${t.type}.`}}function Lz(e){let t=zA(e),n=Xo(e);if(!t)return e=Zo(e,"Cmd"),qi(e,n);switch(n.val){case"\\\\operatorname":return wz(e,t);case"\\\\token":return Fz(e,t);case"\\\\sqrt":return Vz(e,t);case"\\\\frac":return Bz(e,t);default:throw new Error(`Unexpected command ${n.val}.`)}}function wz(e,t){let n=e;e=Zo(e,"Cmd");let r;({state:e,tree:r}=Wu(e,t));let s=Zu(n,e);return qi(e,BA(s,r))}function Fz(e,t){let n=e;e=Zo(e,"Cmd");let r;({state:e,tree:r}=Wu(e,t));let s=Zu(n,e);return qi(e,GA(s,r))}function Vz(e,t){let n=e;e=Zo(e,"Cmd");let r;BM(e,"[")&&({state:e,tree:r}=Hz(e));let s;({state:e,tree:s}=Wu(e,t));let i=Zu(n,e);return qi(e,LA(i,r,s))}function Bz(e,t){let n=e;e=Zo(e,"Cmd");let r;({state:e,tree:r}=Wu(e,t));let s;({state:e,tree:s}=Wu(e,t));let i=Zu(n,e);return qi(e,wA(i,r,s))}function Gz(e){let t=e;e=Zo(e,"Left");let n=Xo(e);e=mo(e);let r;({state:e,tree:r}=Fh(e,!1)),e=Zo(e,"Right");let s=Xo(e);e=mo(e);let i=Zu(t,e);return qi(e,VA(i,n,s,r))}function kz(e){let t=e,n,r,s=0;e:for(;!wh(e);){let o=Xo(e);switch(o.type){case"^":if(e=mo(e),n)throw"Parse Error: double superscript.";({state:e,tree:n}=Wu(e,kM));break;case"_":if(e=mo(e),r)throw"Parse Error: double subscript.";({state:e,tree:r}=Wu(e,HA));break;case"Primes":if(e=mo(e),s>0)throw"Parse Error: double primes.";s=o.val.length;break;case"Primes^":if(e=mo(e),s>0)throw"Parse Error: double primes.";if(n)throw"Parse Error: double superscript";s=o.val.length-1,{state:e,tree:n}=Wu(e,kM);break;default:break e}}let i=Zu(t,e);return qi(e,FA(i,n,r,s))}function Wu(e,t){let n,r=zA(e);if(r&&(t.type!=="primitive"||!(r.type==="macro"&&r.expandsToSingleAtom)))throw`Parse Error: can\'t use ${r.errorName} as argument of ${t.errorName}. Use {}.`;return{state:e,tree:n}=qA(e),n.type!=="Group"&&(n=GM(n.span,[n])),qi(e,n)}function Hz(e){e=Zo(e,"[");let t;return{state:e,tree:t}=Fh(e,!0),e=Zo(e,"]"),qi(e,t)}function zz(){throw rf()}function $A(e,t){return t&&!e._inputSpan&&e.setInputSpan(t),e}function Mi(e,t={}){var l;let n=typeof e;if(n!=="string")throw new Error(`Type Error: parse can only be called with strings, got ${JSON.stringify(e)} of type ${n}`);let r=C;if(t.disabledFeatures){r=Object.create(r);for(let p of t.disabledFeatures){if(!r[p])throw new Error(`Programming Error: ${p} cannot be disabled because it is not a parsenode.`);r[p]=zz}}let s=t.seedPrefix===void 0?"":t.seedPrefix,i=0,o=()=>{let p=`${s}::vc${i}`;return i+=1,p},a={nodes:r,currentIndex:t.index,setInput:$A,nextSeed:o,allowDt:!!t.allowDt,allowIndex:!!t.allowIndex,writeIntegral:!!t.writeIntegral,allowIntervalComprehensions:!!t.allowIntervalComprehensions,specializeDoubleInequalities:!!t.specializeDoubleInequalities,includeFunctionParametersInRandomSeed:(l=t.includeFunctionParametersInRandomSeed)!=null?l:!0},u={};t.trailingComma!==void 0&&(u.trailingComma=t.trailingComma),t.disallowFrac&&(u.disallowFrac=!0),t.disableParentheses&&(u.disableParentheses=!0);function c(p){return p.parseOptions=t,p}if(e==="")return c(Xd());try{let p=UA(e),f=OA(p,u),d=zR(a,f);return d.parseOptions=t,d}catch(p){let f;return p instanceof C.Error?f=p:typeof p=="string"?f=new C.Error(p):f=U(p),c(f)}}var qz=["Sum","Product","Integral","List","Derivative","Piecewise","Restriction","Norm","Exponent","PercentOf","FunctionDefinition","UpdateRule","Substitution","ListComprehension"],$z={isGeometryEnabled(){return!1},is3dProduct(){return!1},is3dPolicy(){return!1},polygonUnsupportedPreferTriangle(){return!1},areAllScalesLinear(){return!0},assignmentForbidden(e){return!0},graphingEnabled(){return!1},isValidSlider(e){return!1},sliderVariables(e){return[]},ansEnabled(){return!1},disabledFeatures(){return qz},dimensionVarsEnabled(){return!1},shouldIncludeFunctionParametersInRandomSeed(){return!0},isComplexEnabled(){return!1},isRecursionEnabled(){return!1}},YA={...$z,isGeometryEnabled(){return!0},is3dProduct(){return!0},is3dPolicy(){return!0},isComplexEnabled(){return!1}};var rd=class e{constructor(t,n,r,s,i){this.frame=t;this.dynamic=n;this.lexical=r;this.maxBindingIndex=s;this.compiledGlobalCache=i}static empty(t){return new e(t,{},{},-1,{maxIndex:-1,entries:{}})}resolve(t){if(this.lexical[t])return this.lexical[t];if(this.dynamic[t])return this.dynamic[t];if(this.compiledGlobalCache.entries[t])return this.compiledGlobalCache.entries[t]}getSymbol(t){let n=this.resolve(t);if(n)switch(n.type){case"lexical":case"dynamic":case"free":return n.value;case"global":return n.value;case"error":throw n.error;default:throw new Error("Unexpected symbolMap entry type: "+n.type)}}getMaxIndex(){return Math.max(this.maxBindingIndex,this.compiledGlobalCache.maxIndex)}getParseNode(t){let n=this.resolve(t);if(n)switch(n.type){case"global":case"lexical":case"dynamic":return n.node;case"error":case"free":return;default:throw new Error("Unexpected symbolMap entry type: "+n.type)}}addLexicalBinding(t,n,r){this.addScopeEntry(t,{type:"lexical",value:n,node:r})}addDynamicBinding(t,n,r){this.addScopeEntry(t,{type:"dynamic",value:n,node:r})}cacheGlobal(t,n,r){this.compiledGlobalCache.entries[t]={type:"global",value:n,node:r},this.compiledGlobalCache.maxIndex=Math.max(this.compiledGlobalCache.maxIndex,n)}setFreeVariable(t,n){this.addScopeEntry(t,{type:"free",value:n})}setErrorIfAccessed(t,n){this.addScopeEntry(t,{type:"error",error:n})}addScopeEntry(t,n){var o;let r=this.lexical,s=this.dynamic,i;switch(n.type){case"lexical":{r[t]=n,this.frame[t]===void 0&&((o=this.dynamic[t])==null?void 0:o.type)!=="dynamic"?(s[t]=n,i=!0):i=!1;break}case"dynamic":{s[t]=n,r[t]={type:"lexical",value:n.value,node:n.node},i=!0;break}case"error":{s[t]=n,i=!0;break}case"free":{s[t]=n,i=!0;break}default:throw new Error("Unexpected symbolMap entry type: "+n.type)}n.type!=="error"&&(this.maxBindingIndex=Math.max(this.maxBindingIndex,n.value)),i&&(this.compiledGlobalCache={maxIndex:-1,entries:{}})}isLocal(t){let n=this.resolve(t);return(n==null?void 0:n.type)==="lexical"||(n==null?void 0:n.type)==="dynamic"}isGlobal(t){return this.frame[t]!==void 0&&!this.isLocal(t)}isError(t){var r;let n=this.resolve(t);return n?n.type==="error":(r=this.frame[t])==null?void 0:r.isError}isDefined(t){return this.isLocal(t)||this.isGlobal(t)}getVisibleGlobalDefinition(t){let n=this.resolve(t);if(!n)return XA(this.frame[t]);switch(n.type){case"lexical":case"dynamic":case"free":return;case"global":return XA(this.frame[t]);case"error":throw n.error;default:throw new Error("Unexpected symbolMap entry type: "+n.type)}}childScope(){return new e(this.frame,Tn(this.dynamic),Tn(this.lexical),this.maxBindingIndex,this.compiledGlobalCache)}childScopeWithChildGlobalCache(){return new e(this.frame,Tn(this.dynamic),Tn(this.lexical),this.maxBindingIndex,{maxIndex:this.compiledGlobalCache.maxIndex,entries:Tn(this.compiledGlobalCache.entries)})}newLexicalScope(){return new e(this.frame,Tn(this.dynamic),{},this.maxBindingIndex,this.compiledGlobalCache)}};function XA(e){if(e!=null&&e.isError)throw e;return e}function su(e,t,n,r){return ju({chunk:e,argMap:[t],start:n,unpatchedHeaderMap:new Map,processedHeaders:new Set},r)}function Yz(e,t){let{chunk:n}=e,r=n.getInstruction(t),s=[];for(let i of r.recursionGroup){let o=e.unpatchedHeaderMap.get(i);if(o===void 0)throw new Error("Programming Error: `substitute` did not include all headers in a recursion group.");s.push(o)}for(let i of r.recursionGroup)e.unpatchedHeaderMap.delete(i);for(let i of s)n.getInstruction(i).recursionGroup=s}function ju(e,t){let{chunk:n,argMap:r,start:s}=e;if(t<s)return t;let i=r[t-s];if(i!==void 0)return i;let o=Xz(e,t);e.argMap[t-s]=o;let a=n.getInstruction(t);if(a.type===4){let u=o;e.unpatchedHeaderMap.set(t,u),e.processedHeaders.add(t);for(let c of a.recursionGroup)e.processedHeaders.has(c)||ju(e,c);return ju(e,a.endIndex),u}if(es(a))switch(a.type){case 23:case 21:case 50:break;case 19:{let c=a.args.length-2;for(let l=0;l<c;l++)ju(e,t+1+l);break}case 53:{let l=n.getInstruction(a.args[0]).signature.argTypes.length;for(let p=0;p<l;p++)ju(e,t+1+p);break}default:let u=a;throw new Error(`Programming Error. Unexpected OpCode: ${u.type}`)}else if(Gg(a)){let u=a.args.length-1;for(let c=0;c<u;c++)ju(e,t+1+c)}return o}function Xz(e,t){let{chunk:n,start:r}=e,s=n.getInstruction(t);if(ds(s)){let a=s.args[0];for(let u=a;u<=t;u++){let c=n.getInstruction(u);if(!ge(c))for(let l of c.args)l<a&&ju(e,l)}}if(s.type===4)return n.FunctionHeader(s.symbol,s.valueType,s.signature,s.parameterSymbols);if(ge(s))return po(n,s);let i=[];for(let a of s.args)i.push(ju(e,a));let o=e.argMap[t-r];if(o!==void 0)return o;if(s.type===55&&!zg(n,t)){let a=s.args[0];e.unpatchedHeaderMap.has(a)&&Yz(e,a)}return _n(n,s,i)}function Bh(e,t,n,r){let s=fl(e,t),i=e.Constant(0);if(t<n)return i;let o=e.Constant(1),a=e.Constant(NaN),u=Vu(e,n),c=nO(e,s),l=e.derivativeMaps.getMapEntry(e,r,n),{map:p,maxValidReference:f}=l;for(let h=0;h<p.length;h++){let x=p[h];x!==void 0&&x>f&&(p[h]=void 0)}let d=[],y=!1;for(let h=0;h<n;h++)d[h]=h,p[h]=i;let g=Vr(e,s);return Gh({chunk:e,derivativeVarIndex:n,forwardSeed:r,forwardMask:u,backwardMask:c,referenced:g,valueMap:d,derivativeMap:p,mustCopy:y,ZERO:i,ONE:o,NAN:a},n,s),l.maxValidReference=e.instructionsLength()-1,p[s]}function Gh(e,t,n){let{chunk:r,valueMap:s,derivativeMap:i,backwardMask:o}=e;for(let a=t;a<=n;a++){let u=i[a];if(u!==void 0)if(r.getInstruction(u).type===0)i[a]=void 0;else{s[a]=Vh(e,a);continue}if(!o[a]){s[a]=Vh(e,a);continue}let c=r.getInstruction(a);if(es(c)&&c.endIndex!==-1)switch(c.type){case 21:{a=Zz(e,a);continue}case 19:case 23:{a=Jz(e,a);continue}case 53:{a=Kz(e,a);continue}}s[a]=Vh(e,a),i[a]=eU(e,a)}return n}function Zz(e,t){let{chunk:n,forwardMask:r,valueMap:s,derivativeMap:i,ZERO:o}=e,a=n.getInstruction(t),u=a.endIndex,c=n.getInstruction(u),l=o;if(r[a.args[1]]){let p=s[a.args[1]];l=n.Add([l,n.Multiply([i[a.args[1]],su(n,p,t,c.args[1])])])}if(r[a.args[0]]){let p=s[a.args[0]];l=n.Subtract([l,n.Multiply([i[a.args[0]],su(n,p,t,c.args[1])])])}if(Wz(n,t,r)){let p=s.slice();p[t]=_n(n,a,[p[a.args[0]],p[a.args[1]]]),i[t]=o,Gh({...e,valueMap:p,mustCopy:!0},t+1,u-1);let f=_n(n,c,[p[c.args[0]],i[c.args[1]]]);i[u]=f,l=n.Add([l,_n(n,n.getInstruction(u+1),[f])])}else for(let p=t;p<=u;p++)i[p]=o;if(jz(n,t,s)){let p={...e,mustCopy:!0};for(let f=t;f<=u+1;f++)s[f]=Vh(p,f)}else for(let p=t;p<=u+1;p++)s[p]=p;return i[u+1]=l,u+c.args.length-1}function Wz(e,t,n){let r=e.getInstruction(t),s=e.getInstruction(r.endIndex);if(s.args[1]<t+1)return n[s.args[1]];for(let i=t+1;i<=s.args[1];i++){let o=e.getInstruction(i);if(!ge(o)){for(let a of o.args)if(a<t&&n[a])return!0}}return!1}function jz(e,t,n){let r=e.getInstruction(t);for(let s=t;s<=r.endIndex;s++){let i=e.getInstruction(s);if(!ge(i)){for(let o of i.args)if(n[o]!==o)return!0}}return!1}function Jz(e,t){let{chunk:n,derivativeMap:r,valueMap:s,ZERO:i}=e,o=n.getInstruction(t),a=o.endIndex,u=n.getInstruction(a),c;if(o.type===23)s[t]=_n(n,o,[s[o.args[0]]]),r[t]=i,c=t+1;else{let p=[];p.push(s[o.args[0]],s[o.args[1]]);for(let f=2;f<o.args.length;f++)p.push(s[o.args[f]],r[o.args[f]]);s[t]=_n(n,o,p),r[t]=i;for(let f=2;f<o.args.length;f++)s[t+f-1]=_n(n,n.getInstruction(t+f-1),[s[t]]),r[t+f-1]=_n(n,n.getInstruction(t+f-1),[s[t]]);c=t+o.args.length-1}Gh({...e,mustCopy:!0},c,a-1);let l=[];l.push(s[u.args[0]]);for(let p=1;p<u.args.length;p++)l.push(s[u.args[p]],r[u.args[p]]);s[a]=_n(n,u,l),r[a]=i;for(let p=1;p<u.args.length;p++)s[a+p]=_n(n,n.getInstruction(a+p),[s[a]]),r[a+p]=_n(n,n.getInstruction(a+p),[s[a]]);return a+u.args.length-1}function Vh(e,t){let{chunk:n,valueMap:r,mustCopy:s,referenced:i}=e;if(!i[t])return t;let o=n.getInstruction(t);if(ge(o))return s?po(n,o):t;{let a=[],u=!1;for(let c of o.args)a.push(r[c]),r[c]!==c&&(u=!0);return u||s?_n(n,o,a):t}}function Qz(e,t){let{chunk:n,derivativeMap:r}=e,s=n.getInstruction(t),i=[],o=s.recursionGroup;for(let a of o){let u=n.getInstruction(a),c={argTypes:[]};for(let p of u.signature.argTypes)c.argTypes.push(p,p);let l=r[a];l||(l=n.FunctionHeader(u.symbol+`_\\u2202${e.derivativeVarIndex}`,u.valueType,c,u.parameterSymbols),i.push(l)),e.derivativeMap[a]=l}for(let a of i){let u=n.getInstruction(a);u.recursionGroup=i}return e.derivativeMap[t]}function Kz(e,t){let{chunk:n,valueMap:r,derivativeMap:s}=e,o=n.getInstruction(t).args[0],a=n.getInstruction(o),u=a.endIndex,l=n.getInstruction(u).args[1],p=s[o],f=n.BeginFunction([p]);s[t]=f;let d=a.signature.argTypes,y=[];for(let T=0;T<d.length;T++){let b=d[T],M=t+T+1;y.push(M);let P=n.BlockVar(b,[f]),D=n.BlockVar(b,[f]);r[M]=P,s[M]=D}let g=t+d.length+1,m=u-1,h=ol(n,y,g,m),x=r.slice();return x[o]=o,Gh({...e,valueMap:x,mustCopy:!0,forwardMask:h},g,m),n.EndFunction([f,s[l]]),u}function eU(e,t){let{chunk:n,derivativeVarIndex:r,forwardSeed:s,forwardMask:i,valueMap:o,derivativeMap:a,ZERO:u,ONE:c,NAN:l}=e,p=n.getInstruction(t);if(t===r){let d;switch(s){case"real":d=c;break;case"complexOne":d=n.NativeFunction("complex",[c,u]);break;case"complexI":d=n.NativeFunction("complex",[u,c]);break}if(j(p.valueType)){let y=ur(n,t),g=n.BeginBroadcast([y]),m=n.EndBroadcast([g,d]);return n.BroadcastResult(p.valueType,[m])}else return d}if(es(p)||ds(p)||p.type===47||p.type===48||p.type===25||p.type===27||p.type===26||p.type===29||p.type===28||p.type===32||p.type===31||p.type===42||p.type===44||p.type===49||p.valueType===ft)return u;if(p.type===4)return Qz(e,t);if(!i[t]||ge(p))return p.valueType!==I?nU(n,[o[t],u]):p.type!==1||isFinite(V(p.value))?u:l;if(p.type===38||p.type===15){let d=[];for(let y of p.args)d.push(a[y]);return _n(n,p,d)}if(p.type===33)return _n(n,p,[o[p.args[0]],a[p.args[1]],a[p.args[2]]]);if(p.type===55){let y=[a[p.args[0]]];for(let g of p.args.slice(1)){y.push(o[g]);let m=a[g];if(m===u){let h=n.getInstruction(g).valueType;NS(h)&&(m=n.ZeroOfType(h))}y.push(m)}return n.FunctionCall(y)}let f=u;for(let d=0;d<p.args.length;d++){if(!i[p.args[d]])continue;let y=a[p.args[d]];if(y===u)continue;let g=tU(e,o[t],d,y);g!==u&&(f=f===u?g:rU(n,[g,f]))}return f}function tU(e,t,n,r){let{chunk:s,ZERO:i,ONE:o,NAN:a}=e,u=s.getInstruction(t);switch(u.type){case 8:return r;case 9:switch(n){case 0:return r;default:return s.Negative([r])}case 10:switch(n){case 0:return s.Multiply([r,u.args[1]]);default:return s.Multiply([u.args[0],r])}case 11:switch(n){case 0:return s.Divide([r,u.args[1]]);default:return s.Multiply([u.args[0],s.Divide([s.Negative([r]),s.Multiply([u.args[1],u.args[1]])])])}case 14:return s.Negative([r]);case 12:case 13:switch(n){case 0:return s.Multiply([s.Multiply([u.args[1],s.Exponent([u.args[0],s.Subtract([u.args[1],o])])]),r]);default:return s.Multiply([s.Piecewise([s.Equal([u.args[0],i]),s.Piecewise([s.GreaterEqual([u.args[1],i]),i,a]),s.Multiply([s.NativeFunction("ln",[u.args[0]]),t])]),r])}case 37:return sU(s,t,WA[u.symbol][n],r);case 39:case 40:case 41:switch(n){case 0:return _n(s,u,[r,u.args[1]]);default:return i}case 16:return _n(s,u,[r]);default:{let c=u;throw new Error(`Unimplemented derivative for opcode ${c.type}`)}}}function nU(e,t){switch(e.getInstruction(t[0]).valueType){case de:return e.NativeFunction("scaleTangentSegment",t);case fe:return e.NativeFunction("scaleTangentLine",t);case Ne:return e.NativeFunction("scaleTangentRay",t);case ce:return e.NativeFunction("scaleTangentCircle",t);case ie:return e.NativeFunction("scaleTangentArc",t);case Le:return e.NativeFunction("scaleTangentUndirectedAngleMarker",t);case ye:return e.NativeFunction("scaleTangentDirectedAngleMarker",t);case xe:return e.NativeFunction("scaleTangentPolygon",t);case Re:return e.NativeFunction("scaleTangentTransformation",t);default:return e.Multiply(t)}}function rU(e,t){switch(e.getInstruction(t[0]).valueType){case de:return e.NativeFunction("addTangentSegment",t);case wt:return e.NativeFunction("addTangentSegmentThreeD",t);case fe:return e.NativeFunction("addTangentLine",t);case Ne:return e.NativeFunction("addTangentRay",t);case le:return e.NativeFunction("addTangentVector",t);case ce:return e.NativeFunction("addTangentCircle",t);case ie:return e.NativeFunction("addTangentArc",t);case Le:return e.NativeFunction("addTangentUndirectedAngleMarker",t);case ye:return e.NativeFunction("addTangentDirectedAngleMarker",t);case xe:return e.NativeFunction("addTangentPolygon",t);case Re:return e.NativeFunction("addTangentTransformation",t);default:return e.Add(t)}}function sU(e,t,n,r){let s=rd.empty(tt),o=e.getInstruction(t).args;for(let a=0;a<o.length;a++){let u=iU[a];s.addLexicalBinding(u,o[a])}return s.addLexicalBinding("x_1",r),s.addLexicalBinding("q",t),Fe(HM(YA,e,s,im.root,void 0,void 0),n)}var iU=["x","y","z","u"],ZA={exp:["q*x_1"],complexExp:["q*x_1"],ln:["\\\\{x >= 0: x_1/x \\\\}"],complexLn:["x_1/x"],log:["\\\\{x >= 0: x_1/(x*\\\\ln(10)) \\\\}"],complexLog:["x_1/(x*\\\\ln(10))"],sqrt:["x_1/(2*q)"],complexSqrt:["x_1/(2*q)"],complexPow:["y*\\\\complexPow(x,y-1)*x_1","q*\\\\complexLn(x)*x_1"],rtxsqpone:["x*x_1/q"],rtxsqmone:["x*x_1/q"],sin:["\\\\cos(x)*x_1"],complexSin:["\\\\cos(x)*x_1"],cos:["-\\\\sin(x)*x_1"],complexCos:["-\\\\sin(x)*x_1"],tan:["(1+q^2)*x_1"],complexTan:["(s*s)*x_1 \\\\with s=\\\\sec(x)"],arcsin:["x_1/\\\\sqrt{1 - x^2}"],complexArcsin:["x_1/(\\\\complexSqrt(1+x)\\\\complexSqrt(1-x))"],arccos:["-x_1/\\\\sqrt{1 - x^2}"],complexArccos:["-x_1/(\\\\complexSqrt(1+x)\\\\complexSqrt(1-x))"],sinh:["\\\\cosh(x)*x_1"],complexSinh:["\\\\cosh(x)*x_1"],cosh:["\\\\sinh(x)*x_1"],complexCosh:["\\\\sinh(x)*x_1"],tanh:["(\\\\sech(x))^2*x_1"],complexTanh:["(s*s)*x_1 \\\\with s=\\\\sech(x)"],arcsinh:["x_1/\\\\rtxsqpone(x)"],complexArcsinh:["x_1/(\\\\complexSqrt(1+\\\\complex(0,1)x)\\\\complexSqrt(1-\\\\complex(0,1)x))"],arccosh:["\\\\{ x > 0: x_1/\\\\rtxsqmone(x) \\\\}"],complexArccosh:["x_1/(\\\\complexSqrt(x+1)\\\\complexSqrt(x-1))"],arctanh:["\\\\{ \\\\abs(x) < 1: x_1/(1 - x^2) \\\\}"],complexArctanh:["x_1/((1+x)(1-x))"],csc:["-\\\\cot(x)*q*x_1"],complexCsc:["-\\\\cot(x)*q*x_1"],sec:["\\\\tan(x)*q*x_1"],complexSec:["\\\\tan(x)*q*x_1"],cot:["-(1+q^2)*x_1"],complexCot:["-(c*c)*x_1 \\\\with c=\\\\csc(x)"],arccsc:["-x_1/(\\\\abs(x)*\\\\rtxsqmone(x))"],complexArccsc:["-x_1/((x\\\\complexSqrt(1-1/x))(x\\\\complexSqrt(1+1/x)))"],arcsec:["x_1/(\\\\abs(x)*\\\\rtxsqmone(x))"],complexArcsec:["x_1/((x\\\\complexSqrt(1-1/x))(x\\\\complexSqrt(1+1/x)))"],arccot:["-x_1/(1+x^2)"],complexArccot:["-x_1/((x+\\\\complex(0,1))(x-\\\\complex(0,1)))"],csch:["-\\\\coth(x)*q*x_1"],complexCsch:["-\\\\coth(x)*q*x_1"],sech:["-\\\\tanh(x)*q*x_1"],complexSech:["-\\\\tanh(x)*q*x_1"],coth:["-(\\\\csch(x))^2*x_1"],complexCoth:["-(c*c)*x_1 \\\\with c=\\\\csch(x)"],arccsch:["-x_1/(\\\\abs(x)*\\\\rtxsqpone(x))"],complexArccsch:["-x_1/((x\\\\complexSqrt(1+\\\\complex(0,1)/x))(x\\\\complexSqrt(1-\\\\complex(0,1)/x)))"],arcsech:["\\\\{ x >= 0: -x_1/(x*\\\\sqrt{1 - x^2}) \\\\}"],complexArcsech:["-x_1/((x\\\\complexSqrt((1-x)/(1+x)))(1+x))"],arccoth:["\\\\{ \\\\abs(x) > 1 : x_1/(1 - x^2) \\\\}"],complexArccoth:["x_1/((1+x)(1-x))"],factorial:["q*\\\\polyGamma(0, x + 1)*x_1"],floor:["\\\\{ q=x: 0/0, 0*x_1 \\\\}"],complexFloor:["\\\\{ \\\\real(d) + \\\\imag(d) = 0: 0/0, \\\\imag(d) - \\\\real(d) = 1: 0/0, 0*x_1 \\\\} \\\\with d = x - q"],ceil:["\\\\{ q=x: 0/0, 0*x_1 \\\\}"],complexCeil:["\\\\{ \\\\real(d) + \\\\imag(d) = 0: 0/0, \\\\imag(d) - \\\\real(d) = -1: 0/0, 0*x_1 \\\\} \\\\with d = x - q"],round:["\\\\{ \\\\abs(\\\\mod(x, 1) - 0.5) > 0: 0*x_1 \\\\}"],complexRound:["\\\\{ \\\\real(q) - \\\\real(x) = 0.5: 0/0, \\\\imag(q) - \\\\imag(x) = 0.5: 0/0, 0*x_1 \\\\}"],abs:["\\\\{ x=0: 0/0, \\\\sign(x)*x_1 \\\\}"],sign:["\\\\{ x=0: 0/0, 0*x_1 \\\\}"],distance:["-((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y)/q","((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y)/q"],distanceThreeD:["-((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y+(y.z-x.z)*x_1.z)/q","((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y+(y.z-x.z)*x_1.z)/q"],segmentThreeD:["\\\\segmentThreeD(x_1,(0,0,0))","\\\\segmentThreeD((0,0,0),x_1)"],vectorThreeD:["\\\\vectorThreeD(x_1,(0,0,0))","\\\\vectorThreeD((0,0,0),x_1)"],triangle:["\\\\triangle(x_1,(0,0,0),(0,0,0))","\\\\triangle((0,0,0),x_1,(0,0,0))","\\\\triangle((0,0,0),(0,0,0),x_1)"],sphere:["\\\\sphere(x_1,0)","\\\\sphere((0,0,0),x_1)"],pointDet:["\\\\pointDet(x_1,y)","\\\\pointDet(x,x_1)"],pointDot:["\\\\pointDot(x_1,y)","\\\\pointDot(x,x_1)"],pointPerp:["\\\\pointPerp(x_1)"],complexMultiplyPoints:["\\\\complexMultiplyPoints(x_1,y)","\\\\complexMultiplyPoints(x,x_1)"],segment:["\\\\segment(x_1,(0,0))","\\\\segment((0,0),x_1)"],line:["\\\\line(x_1,(0,0))","\\\\line((0,0),x_1)"],ray:["\\\\ray(x_1,(0,0))","\\\\ray((0,0),x_1)"],vector:["\\\\vector(x_1, (0,0))","\\\\vector((0,0), x_1)"],mathVector:["\\\\mathVector(x_1,(0,0))","\\\\mathVector((0,0),x_1)"],mathVectorThreeD:["\\\\mathVectorThreeD(x_1,(0,0,0))","\\\\mathVectorThreeD((0,0,0),x_1)"],rawTransform:["\\\\rawTransform(x_1,(0,0))","\\\\rawTransform((0,0),x_1)"],rawTransformConj:["\\\\rawTransformConj(x_1,(0,0))","\\\\rawTransformConj((0,0),x_1)"],transformWithoutTranslation:["\\\\transformWithoutTranslation(x_1)"],transformScaleFactor:["\\\\transformScaleFactor(x_1)"],vectorDisplacementAsPoint:["\\\\vectorDisplacementAsPoint(x_1)"],vectorThreeDDisplacementAsPoint:["\\\\vectorThreeDDisplacementAsPoint(x_1)"],basePointFromVector:["\\\\basePointFromVector(x_1)"],basePointFromVectorThreeD:["\\\\basePointFromVectorThreeD(x_1)"],circle:["\\\\circle(x_1,0)","\\\\circle((0,0),x_1)"],arc:["\\\\arc(x_1,(0,0),(0,0))","\\\\arc((0,0),x_1,(0,0))","\\\\arc((0,0),(0,0),x_1)"],arcCenter:["(\\\\pointDot(q-p1,p1_1)\\\\pointPerp(v_2)+\\\\pointDot(q-p2,p2_1)\\\\pointPerp(v_3)+\\\\pointDot(q-p3,p3_1)\\\\pointPerp(v_1))/\\\\pointDet(v_2,v_1) \\\\with v_1=p2-p1,v_2=p3-p2,v_3=p1-p3".replace(/p1_1/g,"\\\\arcFirstPoint(x_1)").replace(/p2_1/g,"\\\\arcMiddlePoint(x_1)").replace(/p3_1/g,"\\\\arcThirdPoint(x_1)").replace(/p1/g,"\\\\arcFirstPoint(x)").replace(/p2/g,"\\\\arcMiddlePoint(x)").replace(/p3/g,"\\\\arcThirdPoint(x)")],arcFirstPoint:["\\\\arcFirstPoint(x_1)"],arcMiddlePoint:["\\\\arcMiddlePoint(x_1)"],arcThirdPoint:["\\\\arcThirdPoint(x_1)"],arcOmega:["2 * (X_1*Y/(Y*Y+X*X) - Y_1*X/(Y*Y+X*X))".replace(/X_1/g,"((v1x * v2y_1 + v1x_1 * v2y) - (v2x_1 * v1y + v2x * v1y_1))").replace(/Y_1/g,"((v1x * v2x_1 + v1x_1 * v2x) + (v1y_1 * v2y + v1y * v2y_1))").replace(/X/g,"(v1x * v2y - v2x * v1y)").replace(/Y/g,"(v1x * v2x + v1y * v2y)").replace(/v1x_1/g,"(\\\\arcMiddlePoint(x_1) - \\\\arcFirstPoint(x_1)).x").replace(/v2x_1/g,"(\\\\arcThirdPoint(x_1) - \\\\arcMiddlePoint(x_1)).x").replace(/v1y_1/g,"(\\\\arcMiddlePoint(x_1) - \\\\arcFirstPoint(x_1)).y").replace(/v2y_1/g,"(\\\\arcThirdPoint(x_1) - \\\\arcMiddlePoint(x_1)).y").replace(/v1x/g,"(\\\\arcMiddlePoint(x) - \\\\arcFirstPoint(x)).x").replace(/v2x/g,"(\\\\arcThirdPoint(x) - \\\\arcMiddlePoint(x)).x").replace(/v1y/g,"(\\\\arcMiddlePoint(x) - \\\\arcFirstPoint(x)).y").replace(/v2y/g,"(\\\\arcThirdPoint(x) - \\\\arcMiddlePoint(x)).y")],center:["\\\\center(x_1)"],radius:["\\\\radius(x_1)"],undirectedAngleMarker:["\\\\undirectedAngleMarker(x_1)"],directedAngleMarker:["\\\\directedAngleMarker(x_1,0,0,0)","\\\\directedAngleMarker((0,0),x_1,0,0)","\\\\directedAngleMarker((0,0),0,x_1,0)","\\\\directedAngleMarker((0,0),0,0,x_1)"],directedCoterminalAngle:["\\\\directedAngleMarker((0,0),0,\\\\directedAngleMarkerRawDelta(x_1),0)"],undirectedCoterminalAngle:["\\\\undirectedAngleMarker(\\\\directedAngleMarker((0,0),0,\\\\undirectedAngleMarkerRawDelta(x_1),0))"],supplement:["\\\\directedAngleMarker((0,0),0,-\\\\directedAngleMarkerRawDelta(x_1),0)"],directedAngleMarkerMultiplier:["\\\\directedAngleMarkerMultiplier(x_1)"],undirectedAngleMarkerMultiplier:["\\\\undirectedAngleMarkerMultiplier(x_1)"],directedAngleMarkerRawDelta:["\\\\directedAngleMarkerRawDelta(x_1)"],undirectedAngleMarkerRawDelta:["\\\\undirectedAngleMarkerRawDelta(x_1)"],polygonInteriorUndirectedAngles:["\\\\polygonInteriorUndirectedAngles(x_1)"],polygonInteriorDirectedAngles:["\\\\polygonInteriorDirectedAngles(x_1)"],lineFromSegment:["\\\\lineFromSegment(x_1)"],lineFromRay:["\\\\lineFromRay(x_1)"],segmentGlider:["\\\\segmentGlider(x_1,y)","\\\\{0<y<1:(\\\\segmentGlider(x,1)-\\\\segmentGlider(x,0))*x_1,(0,0)\\\\}"],segmentThreeDGlider:["\\\\segmentThreeDGlider(x_1,y)","\\\\{0<y<1:(\\\\segmentThreeDGlider(x,1)-\\\\segmentThreeDGlider(x,0))*x_1,(0,0,0)\\\\}"],rayGlider:["\\\\rayGlider(x_1,y)","\\\\{0<y:(\\\\rayGlider(x,1)-\\\\rayGlider(x,0))*x_1,(0,0)\\\\}"],lineGlider:["\\\\lineGlider(x_1,y)","(\\\\lineGlider(x,1)-\\\\lineGlider(x,0))*x_1"],circleGlider:["\\\\circleGlider(x_1,y)","\\\\{0<y<1:2*\\\\pi*\\\\pointPerp(q-\\\\center(x))*x_1,(0,0)\\\\}"],arcGlider:["(0/0,0/0)","(0/0,0/0)"],polygonEdgeByParameter:["\\\\polygonEdgeByParameter(x_1,y)","\\\\{\\\\floor(y)=y:\\\\segment((0/0,0/0),(0/0,0/0)),\\\\segment((0,0),(0,0))\\\\}"],polygonGlider:["\\\\polygonGlider(x_1,y)","\\\\{y<0:(0,0),y>x.\\\\vertices.\\\\count:(0,0),\\\\floor(y)=y:(0/0,0/0),(x_1*(\\\\segmentGlider(s,1)-\\\\segmentGlider(s,0))\\\\with s=\\\\polygonEdgeByParameter(x,y))\\\\}"],chooseNonIncidentPoint:["(0/0,0/0)"],circleCircleIntersection:["(\\\\radius(x)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(x))))/\\\\pointDot(\\\\pointPerp(q-\\\\center(y)),q-\\\\center(x))*\\\\pointPerp(q-\\\\center(y))","(\\\\radius(y)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(y))))/\\\\pointDot(\\\\pointPerp(q-\\\\center(x)),q-\\\\center(y))*\\\\pointPerp(q-\\\\center(x))"],circleArcIntersection:["(0/0,0/0)"],circleLineIntersection:["(\\\\radius(x)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(x))))/\\\\pointDot((\\\\lineGlider(y,1)-\\\\lineGlider(y,0)),q-\\\\center(x))*(\\\\lineGlider(y,1)-\\\\lineGlider(y,0))","(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(y,1))+\\\\pointDet(\\\\lineGlider(y,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\pointPerp(q-\\\\center(x)),\\\\lineGlider(y,1)-\\\\lineGlider(y,0)))*(\\\\pointPerp(q-\\\\center(x)))"],arcCircleIntersection:["(0/0,0/0)"],arcArcIntersection:["(0/0,0/0)"],arcLineIntersection:["(0/0,0/0)"],lineCircleIntersection:["(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(x,1))+\\\\pointDet(\\\\lineGlider(x,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\pointPerp(q-\\\\center(y)),\\\\lineGlider(x,1)-\\\\lineGlider(x,0)))*(\\\\pointPerp(q-\\\\center(y)))","(\\\\radius(y)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(y))))/\\\\pointDot((\\\\lineGlider(x,1)-\\\\lineGlider(x,0)),q-\\\\center(y))*(\\\\lineGlider(x,1)-\\\\lineGlider(x,0))"],lineArcIntersection:["(0/0,0/0)"],lineLineIntersection:["(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(x,1))+\\\\pointDet(\\\\lineGlider(x,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\lineGlider(y,1)-\\\\lineGlider(y,0),\\\\lineGlider(x,1)-\\\\lineGlider(x,0)))*(\\\\lineGlider(y,1)-\\\\lineGlider(y,0))","(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(y,1))+\\\\pointDet(\\\\lineGlider(y,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\lineGlider(x,1)-\\\\lineGlider(x,0),\\\\lineGlider(y,1)-\\\\lineGlider(y,0)))*(\\\\lineGlider(x,1)-\\\\lineGlider(x,0))"],parallel:["\\\\parallel(x_1,(0,0))","\\\\parallel(\\\\line((0,0),(0,0)),x_1)"],perpendicular:["\\\\perpendicular(x_1,(0,0))","\\\\perpendicular(\\\\line((0,0),(0,0)),x_1)"],angleVertex:["\\\\angleVertex(x_1)"],angleStart:["\\\\angleStart(x_1)"],directedAngleVertex:["\\\\directedAngleVertex(x_1)"],directedAngleStart:["\\\\directedAngleStart(x_1)"],anglebisector:["\\\\ray(\\\\angleVertex(x_1),\\\\angleVertex(x_1) + \\\\pointPerp( \\\\rayGlider(q,1) - \\\\angleVertex(x) ) * (s_1 + d_1 / 2)) \\\\with s_1 = \\\\angleStart(x_1), d_1 = \\\\undirectedAngleMarkerRawDelta(x_1)"],directedanglebisector:["\\\\ray(\\\\directedAngleVertex(x_1),\\\\directedAngleVertex(x_1) + \\\\pointPerp( \\\\rayGlider(q,1) - \\\\directedAngleVertex(x) ) * (s_1 + d_1 / 2)) \\\\with s_1 = \\\\directedAngleStart(x_1), d_1 = \\\\directedAngleMarkerRawDelta(x_1)"],scaleTangentTransformation:["\\\\scaleTangentTransformation(x_1, y)","\\\\scaleTangentTransformation(x, x_1)"],scaleTangentPolygon:["\\\\scaleTangentPolygon(x_1, y)","\\\\scaleTangentPolygon(x, x_1)"],scaleTangentSegment:["\\\\scaleTangentSegment(x_1, y)","\\\\scaleTangentSegment(x, x_1)"],scaleTangentLine:["\\\\scaleTangentLine(x_1, y)","\\\\scaleTangentLine(x, x_1)"],scaleTangentRay:["\\\\scaleTangentRay(x_1, y)","\\\\scaleTangentRay(x, x_1)"],scaleTangentCircle:["\\\\scaleTangentCircle(x_1, y)","\\\\scaleTangentCircle(x, x_1)"],scaleTangentArc:["\\\\scaleTangentArc(x_1, y)","\\\\scaleTangentArc(x, x_1)"],scaleTangentDirectedAngleMarker:["\\\\scaleTangentDirectedAngleMarker(x_1, y)","\\\\scaleTangentDirectedAngleMarker(x, x_1)"],scaleTangentUndirectedAngleMarker:["\\\\scaleTangentUndirectedAngleMarker(x_1, y)","\\\\scaleTangentUndirectedAngleMarker(x, x_1)"],addTangentPolygon:["x_1","x_1"],addTangentSegment:["x_1","x_1"],addTangentSegmentThreeD:["x_1","x_1"],addTangentLine:["x_1","x_1"],addTangentRay:["x_1","x_1"],addTangentVector:["x_1","x_1"],addTangentCircle:["x_1","x_1"],addTangentArc:["x_1","x_1"],addTangentDirectedAngleMarker:["x_1","x_1"],addTangentUndirectedAngleMarker:["x_1","x_1"],addTangentTransformation:["x_1","x_1"],translation:["\\\\rawTransform((0,0),x_1)"],dilation:["\\\\rawTransform((0,0),(1-y)x_1)","\\\\rawTransform((x_1,0),-x*x_1)"],reflection:["\\\\rawTransformConj(a_1,p1_1-\\\\complexMultiplyPoints(a_1,(p1.x,-p1.y))-\\\\complexMultiplyPoints(qa,(p1_1.x,-p1_1.y)))\\\\with a_1=\\\\pointPerp(qa)*(\\\\pointDet(v,v_1)*2/(v.x^2+v.y^2))".replace(/p1_1/g,"\\\\glider(x_1,0)").replace(/p1/g,"\\\\glider(x,0)").replace(/v_1/g,"(\\\\glider(x_1,1)-\\\\glider(x_1,0))").replace(/v/g,"(\\\\glider(x,1)-\\\\glider(x,0))").replace(/qa/g,"\\\\transformScaleFactor(q)")],rotation:["\\\\rawTransform((0,0),\\\\complexMultiplyPoints(p,x_1))\\\\with p=(1,0)-(\\\\cos(y),\\\\sin(y))","\\\\rawTransform(p,\\\\complexMultiplyPoints(-p,x))\\\\with p=(-x_1*\\\\sin(y),x_1*\\\\cos(y))"],compose:["\\\\reflection(\\\\line((0/0,0/0),(0/0,0/0)))","\\\\reflection(\\\\line((0/0,0/0),(0/0,0/0)))"],inverse:["\\\\reflection(\\\\line((0/0,0/0),(0/0,0/0)))"],transformPoint:["\\\\transformPoint(x_1,y)","\\\\transformPoint(\\\\transformWithoutTranslation(x),x_1)"],transformSegment:["\\\\transformSegment(x_1,y)","\\\\transformSegment(\\\\transformWithoutTranslation(x),x_1)"],transformVector:["\\\\transformVector(x_1,y)","\\\\transformVector(\\\\transformWithoutTranslation(x),x_1)"],transformLine:["\\\\transformLine(x_1,y)","\\\\transformLine(\\\\transformWithoutTranslation(x),x_1)"],transformRay:["\\\\transformRay(x_1,y)","\\\\transformRay(\\\\transformWithoutTranslation(x),x_1)"],transformCircle:["\\\\circle(\\\\transformPoint(x_1,y.\\\\center), y.\\\\radius * \\\\pointDot(a_1,a) / \\\\hypot(a.x,a.y))\\\\with a=\\\\transformScaleFactor(x),a_1=\\\\transformScaleFactor(x_1)","\\\\transformCircle(\\\\transformWithoutTranslation(x),x_1)"],transformArc:["\\\\transformArc(x_1,y)","\\\\transformArc(\\\\transformWithoutTranslation(x),x_1)"],transformPolygon:["\\\\transformPolygon(x_1,y)","\\\\transformPolygon(\\\\transformWithoutTranslation(x),x_1)"],transformAngleMarker:["\\\\angle((1,0),(0,0),(1,0))","\\\\transformAngleMarker(\\\\transformWithoutTranslation(x),x_1)"],transformDirectedAngleMarker:["\\\\directedangle((1,0),(0,0),(1,0))","\\\\transformDirectedAngleMarker(\\\\transformWithoutTranslation(x),x_1)"],mean:["\\\\mean(x_1)"],total:["\\\\total(x_1)"],count:["0"],var:["2*\\\\cov(x, x_1)"],varp:["2*\\\\cov(x, x_1)*(\\\\count(x)-1)/\\\\count(x)"],stdev:["\\\\cov(x, x_1)/q"],stdevp:["\\\\covp(x, x_1)/q"],mad:["\\\\mean(\\\\sign(x-\\\\mean(x))*(x_1 - \\\\mean(x_1)))"],listMin:["x_1[\\\\argmin(x)]"],listMax:["x_1[\\\\argmax(x)]"],min:["\\\\{x>y:0,x_1\\\\}","\\\\{x<=y:0,x_1\\\\}"],max:["\\\\{x<y:0,x_1\\\\}","\\\\{x>=y:0,x_1\\\\}"],median:["0.5*(x_1[\\\\lowerQuantileIndex(x, 0.5)] + x_1[\\\\upperQuantileIndex(x, 0.5)])"],argmin:["0/0"],argmax:["0/0"],gcd:["0/0"],complexGCD:["0/0"],lcm:["0/0"],complexLCM:["0/0"],erf:["\\\\frac{2x_1}{\\\\sqrt{\\\\pi }}\\\\exp(-x^2)"],invNorm:["\\\\frac{x_1}{\\\\pdf(\\\\normaldist(0,1),q)}"],logbase:["\\\\{x > 0: \\\\frac{x_1}{x*\\\\ln(y)} \\\\}","\\\\frac{-q*x_1}{y*\\\\ln(y)}"],complexLogbase:["\\\\frac{x_1}{x*\\\\complexLn(y)}","\\\\frac{-q*x_1}{y*\\\\complexLn(y)}"],hypot:["x_1*x/q","x_1*y/q"],polyGamma:["0/0","\\\\polyGamma(1 + x, y)*x_1"],mod:["\\\\{ q=0: 0/0, x_1 \\\\}","\\\\{ \\\\mod(x/y, 1) > 0: -\\\\floor(x/y)*x_1 \\\\}"],complexMod:["\\\\{ q=0: 0/0, x_1 \\\\}","\\\\{ \\\\round(r)=r: 0/0, -\\\\floor(x/y)*x_1 \\\\} \\\\with r=\\\\round(x/y)"],cov:["\\\\cov(x_1, y)","\\\\cov(x, x_1)"],covp:["\\\\covp(x_1, y)","\\\\covp(x, x_1)"],corr:["(\\\\cov(x_1, y) - (\\\\cov(x, y)*\\\\cov(x, x_1)/\\\\var(x)))/(\\\\stdevp(x)\\\\stdevp(y))","(\\\\cov(x, x_1) - (\\\\cov(x, y)*\\\\cov(y, x_1)/\\\\var(y)))/(\\\\stdevp(x)\\\\stdevp(y))"],spearman:["0/0","0/0"],quantile:["\\\\{ \\\\floor(y*(\\\\count(x)-1)) = y*(\\\\count(x)-1) :   x_1[\\\\upperQuantileIndex(x, y)],  (\\\\ceil(y*(\\\\count(x)-1)) - y*(\\\\count(x)-1))*x_1[\\\\lowerQuantileIndex(x, y)] +   (y*(\\\\count(x)-1) - \\\\floor(y*(\\\\count(x)-1)))*x_1[\\\\upperQuantileIndex(x, y)]\\\\}","\\\\{ \\\\floor(y*(\\\\count(x)-1)) < y*(\\\\count(x)-1) :   (\\\\count(x)-1)*(x[\\\\upperQuantileIndex(x, y)] - x[\\\\lowerQuantileIndex(x, y)])*x_1\\\\}"],quartile:["0.5*(x_1[\\\\lowerQuartileIndex(x, y)] + x_1[\\\\upperQuartileIndex(x, y)])","0/0"],tscore:["\\\\frac{\\\\sqrt{\\\\count(x)}(\\\\stdev(x)*\\\\mean(x_1)-(\\\\mean(x)-y)*\\\\frac{\\\\cov(x,x_1)}{\\\\stdev(x)})}{\\\\stdev(x)^2}","-x_1*\\\\sqrt{\\\\count(x)}/\\\\stdev(x)"],quartileIndex:["0/0","0/0"],upperQuartileIndex:["0/0","0/0"],lowerQuartileIndex:["0/0","0/0"],upperQuantileIndex:["0/0","0/0"],lowerQuantileIndex:["0/0","0/0"],nCr:["q*(\\\\polyGamma(0, 1 + x) - \\\\polyGamma(0, 1 + x - y))","q*(\\\\polyGamma(0, 1 + x - y) - \\\\polyGamma(0, 1 + y))"],nPr:["q*(\\\\polyGamma(0, 1 + x) - \\\\polyGamma(0, 1 + x - y))","q*\\\\polyGamma(0, 1 + x - y)"],arctan:["x_1*y/(y^2+x^2)","-x_1*x/(y^2+x^2)"],complexArctan:["x_1/((x+\\\\complex(0,1))(x-\\\\complex(0,1)))"],poissonpdf:["0/0","x_1\\\\frac{\\\\exp(-y)(\\\\floor(x)-y)y^{(\\\\floor(x)-1)}}{(\\\\floor(x))!}"],invPoisson:["0/0","0/0"],tpdf:["x_1*q*\\\\frac{-(y+1)*x}{y+x^2}","x_1*\\\\frac{1}{2}q*(  \\\\frac{x^2-1}{y + x^2} + \\\\ln(\\\\frac{y}{y + x^2}) +   \\\\polyGamma(0, \\\\frac{1+y}{2}) - \\\\polyGamma(0, y/2))"],invT:["x_1/\\\\pdf(\\\\tdist(y),q)","0/0"],tcdf:["-x_1*\\\\pdf(\\\\tdist(z),x)","x_1*\\\\pdf(\\\\tdist(z),y)","0/0"],poissoncdf:["0/0","0/0","x_1\\\\sum _{n=\\\\max(0,\\\\floor(\\\\min(x,y)))}^{\\\\floor(\\\\max(x,y))}\\\\frac{\\\\exp(-z)(n-z)z^{(n-1)}}{n!}"],normalpdf:["-x_1*\\\\frac{x-y}{z^2} q","x_1*\\\\frac{x-y}{z^2} q","x_1*(\\\\frac{(x-y-z)*(x-y+z)}{z^3}) q"],binompdf:["0/0","0/0","\\\\{0<=z<=1: x_1*q*(\\\\frac{\\\\round(x)}{z}-\\\\frac{\\\\round(y)-\\\\round(x)}{1-z}), 0 \\\\}"],invBinom:["0/0","0/0","0/0"],uniformpdf:["0","\\\\{y<=x: \\\\frac{x_1}{(z-y)^2}, 0\\\\}","\\\\{z>=x: -\\\\frac{x_1}{(z-y)^2}, 0\\\\}"],invUniform:["\\\\{y<=x<=z: x_1*(z-y), 0\\\\}","\\\\{y<=x<=z: x_1*(1-x), 0\\\\}","\\\\{y<=x<=z: x_1*x, 0\\\\}"],normalcdf:["-x_1\\\\pdf(\\\\normaldist(z,u), x)","x_1\\\\pdf(\\\\normaldist(z,u), y)","-x_1*(\\\\pdf(\\\\normaldist(z,u), y) - \\\\pdf(\\\\normaldist(z,u), x))","x_1*(  \\\\{\\\\abs(y)=1/0:0,\\\\frac{z-y}{u}\\\\pdf(\\\\normaldist(z,u),y)\\\\} -   \\\\{\\\\abs(x)=1/0:0,\\\\frac{z-x}{u}\\\\pdf(\\\\normaldist(z,u),x)\\\\})"],binomcdf:["0/0","0/0","0/0","\\\\{0<=u<=1: x_1*\\\\sum _{n=\\\\max(0,\\\\round(\\\\min(x,y)))}^{\\\\round(\\\\max(x,y))}(  \\\\pdf(\\\\binomialdist(z,u),n)*(\\\\frac{n}{u}-\\\\frac{\\\\round(z)-n}{1-u})), 0 \\\\}"],uniformcdf:["\\\\{z>u: 0/0, -x_1\\\\pdf(\\\\uniformdist(z,u), x)\\\\}","\\\\{z>u: 0/0, x_1\\\\pdf(\\\\uniformdist(z,u), y)\\\\}","\\\\{z>u: 0/0, x_1*(\\\\frac{\\\\{z<x<u:u-x,0\\\\} + \\\\{z<y<u:y-u,0\\\\}}{(u-z)^2})\\\\}","\\\\{z>u: 0/0, x_1*(\\\\frac{\\\\{z<x<u:x-z,0\\\\} + \\\\{z<y<u:z-y,0\\\\}}{(u-z)^2})\\\\}"],normalSample:["0/0","0/0","0/0"],uniformSample:["0/0","0/0","0/0"],tSample:["0/0","0/0"],poissonSample:["0/0","0/0"],binomSample:["0/0","0/0","0/0"],rgb:["0/0","0/0","0/0"],hsv:["0/0","0/0","0/0"],polygon:["\\\\polygon(x_1)"],area:["0/0"],perimeter:["0/0"],vertices:["\\\\vertices(x_1)"],segments:["\\\\segments(x_1)"],validateRangeLength:["0","0","0","\\\\{q \\\\ge 1: x_1, 0\\\\}"],validateSampleCount:["\\\\{x<0:0,1\\\\}*x_1"],select:["\\\\select(x_1, y)","0*q"],shuffle:["0*y","\\\\shuffle(x, x_1)"],sortPerm:["0*x"],complexSortPerm:["0*x"],elementsAt:["\\\\elementsAt(x_1, y)","0*q"],uniquePerm:["0*q"],tone:["\\\\tone(x_1,0)","\\\\tone(0,x_1)"],restriction:["0"],restrictionToBoolean:["0"],complex:["\\\\complex(x_1,0)","\\\\complex(0,x_1)"],arg:["\\\\imag(x_1/x)"],complexDivide:["x_1/y","-(q/y)x_1"],coerceComplexToReal:["\\\\coerceComplexToReal(x_1)"],peelableCoerceComplexToReal:["\\\\peelableCoerceComplexToReal(x_1)"],coerceRealToComplex:["\\\\coerceRealToComplex(x_1)"]},WA={};for(let e in ZA){let t=e,n=ZA[t],r=[];for(let s=0;s<n.length;s++){let i=n[s];r.push(Mi(i,{}))}WA[t]=r}function om(e){return se(e,I)?"number":se(e,R)?"complex":void 0}function kh(e,t,n,r){let s=e.getInstruction(n).valueType;if(om(s)!==r)throw U(`Incorrect derivative strategy \'${r}\' for type ${s}.`);let i=e.getInstruction(t).valueType;if(!oU(i,r)){let o=e.areAllArgsConstant([t]);throw r==="number"?dT([oe(i)],{blockExport:o}):fT([oe(i),oe(s)],{blockExport:o})}switch(r){case"number":return Bh(e,t,n,"real");case"complex":let o=Bh(e,t,n,"complexOne"),a=Bh(e,t,n,"complexI");return e.Multiply([e.Constant(Se(1,2)),e.Subtract([o,e.Multiply([e.ImaginaryUnit(),a])])]);default:throw U(`Invalid derivative strategy \'${r}\'.`)}}function oU(e,t){switch(t){case"number":return kn(e,R)||kn(e,Ue)||se(e,N)||se(e,z);case"complex":return kn(e,R)||kn(e,Ue);default:throw U(`Invalid derivative strategy \'${t}\'.`)}}function zM(e,t,n){let r=e.getInstruction(n).valueType,s=om(r);if(!s)throw U(`chunk.derivative called on non-number ${at(r)}.`);return kh(e,t,n,s)}function jA(e){let t=[];t.push("digraph {");for(let n=0;n<e.instructionsLength();n++)e.getInstruction(n).type!==0&&t.push(`${n} [label="${n}: ${al(e,n)}"];`);for(let n=0;n<e.instructionsLength();n++){let r=e.getInstruction(n);if(tO(r))for(let s of r.args)t.push(`${n} -> ${s};`)}return t.push("}"),t.join(`\n`)}var Ia=class e{constructor(t){this.derivativeMaps=new Th;if(this.instructions=[],this.blockMask=[],this.comments=[],t.argNames.length!==t.argTypes.length)throw new Error("Programming Error: length of argNames must match length of argTypes");this.argNames=t.argNames,this.argTypes=t.argTypes;for(let n=0;n<this.argTypes.length;n++){let r=this.argTypes[n];this.LoadArg(r)}this.returnIndex=this.Constant(NaN)}computeNeedsThunking(){for(let t=this.returnIndex;t>=0;t--)if(this.instructions[t].type===55)return!0;return!1}setError(t){this.error=t}getError(){return this.error}setWarning(t){this.warning===void 0&&(this.warning=t)}restoreWarning(t){this.warning=t}getWarning(){return this.warning}getReturnIndex(){return this.returnIndex}setReturnIndex(t){if(!(0<=t&&t<this.instructions.length))throw new Error(`Programming Error: out of bounds return index ${t}`);this.returnIndex=t}addComments(t){for(let n in t){let r=this.comments[n]||"";this.comments[n]=r+t[n]}return this}instructionsLength(){return this.instructions.length}getInstruction(t){return this.instructions[t]}popInstruction(){this.unsafelyTruncate(this.instructions.length-1)}unsafelyTruncate(t){this.instructions.length=Math.min(t,this.instructions.length),this.blockMask.length=Math.min(t,this.blockMask.length),this.comments.length=Math.min(t,this.comments.length),this.derivativeMaps.truncate(t),this.setReturnIndex(this.instructions.length-1)}dereferenceFunctionHeader(t){let n=this.getInstruction(t);return n.endIndex===-1?void 0:n.endIndex}getDirectDependencies(t){if(t.type===55){let n=t.args,r=this.dereferenceFunctionHeader(n[0]);if(r!==void 0)return n.concat(r)}return t.args}getRecursionStructure(t){let n=this.getInstruction(t);if(n.endIndex===-1)throw U("Programming error: cannot get recursion structure before function is closed");if(!n.__cachedRecursionStructure){let r={};for(let s of n.recursionGroup){let i=this.getInstruction(s);r[i.symbol]=s}n.__cachedRecursionStructure=hO(this,r)}return n.__cachedRecursionStructure}getRecursiveFunctionMetadata(t){let n=this.getRecursionStructure(t),r=this.getInstruction(t);return{type:n.canIterate?"iterative":"general",recursionGroup:r.recursionGroup.map(s=>this.getInstruction(s).symbol),returnType:r.valueType,signature:r.signature,recursiveStructure:n}}pushInstructionChecked(t){if(this.instructions.length>=32768)throw _T();this.instructions.push(t),this.setReturnIndex(this.instructions.length-1)}pushLeafInstruction(t){return this.pushInstructionChecked(t),this.getReturnIndex()}pushInstruction(t){return this.checkInstructionArguments(t),this.pushInstructionChecked(t),this.setReturnIndex(EN(this)),this.setReturnIndex(FN(this)),this.setReturnIndex(oN(this)),iN(this,this.getReturnIndex()),this.returnIndex===this.instructions.length-1&&this.setReturnIndex(PN(this)),this.getReturnIndex()}checkInstructionArguments(t){for(let n of t.args)if(this.blockMask[n])throw new Error("Programming Error: cannot reference an instruction in a closed block")}markClosedBlock(t,n){for(let r=t;r<n;r++)this.blockMask[r]=!0}LoadArg(t){return this.pushLeafInstruction({type:2,valueType:t})}BlockVar(t,n){return this.pushInstruction({type:47,valueType:t,args:n})}SymbolicVar(t,n){return this.pushLeafInstruction({type:3,valueType:t,symbol:n})}BroadcastResult(t,n){let r=n[0],i=this.instructions[r].args[0],a=this.getInstruction(i).args[0],u=this.getInstruction(a);return this.pushInstruction({type:48,valueType:t,args:n,constantLength:Je(u)?hn(this,a):void 0})}Constant(t){return this.ConstantOfType(I,t)}ConstantOfType(t,n){if(typeof n=="number"&&(n=Se(n,1)),j(t)&&n.length>1e4)throw zd();return this.pushLeafInstruction({type:1,valueType:t,value:n})}TupleOfType(t,n){return this.pushInstruction({type:15,valueType:t,args:n})}Slot(t,n){let r=16,s=this.getInstruction(n[0]).valueType,i=zl[s],o=i?i[t]:Qt;if(o===void 0)throw U(`Invalid slot index: ${t} for ${at(s)}.`);return this.pushInstruction({type:r,valueType:o,args:n,index:t})}ImaginaryUnit(){return this.ConstantOfType(R,[Se(0,1),Se(1,1)])}NanOfType(t){if(t===Lt){let n=this.Constant(NaN);return this.Distribution("uniformdist",[n,n])}else return this.ConstantOfType(t,ls(t))}ZeroOfType(t){return this.ConstantOfType(t,RS(t))}Add(t){let n=8,r=Sn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Subtract(t){let n=9,r=Sn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Multiply(t){let n=10,r=Sn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Divide(t){let n=11,r=Sn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Exponent(t){let n=12,r=Sn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}RawExponent(t){let n=13,r=Sn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Negative(t){let n=14,r=Sn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Equal(t){let n=25,r=Sn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Less(t){let n=26,r=Sn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Greater(t){let n=27,r=Sn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}LessEqual(t){let n=28,r=Sn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}GreaterEqual(t){let n=29,r=Sn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Comparator(t,n){switch(t){case"=":return this.Equal(n);case">":return this.Greater(n);case"<":return this.Less(n);case"<=":return this.LessEqual(n);case">=":return this.GreaterEqual(n);default:{let r=t;throw new Error(`Unexpected comparator symbol: ${r}`)}}}Or(t){let n=31,r=Sn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}And(t){let n=32,r=Sn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Piecewise(t){let n=33,r=Sn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}List(t){let n=38,r=Sn(this,n,t);if(t.length>1e4)throw zd();return this.pushInstruction({type:n,valueType:r,args:t})}ListAccess(t){let n=39,r=Sn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}DeferredListAccess(t){let n=40,r=Sn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}InboundsListAccess(t){let n=41,r=Sn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}NativeFunction(t,n){let r=37,s=Bn[t].returnType,i=typeof s=="function"?s(n.map(o=>this.getInstruction(o).valueType)):s;return this.pushInstruction({type:r,valueType:i,args:n,symbol:t})}Distribution(t,n){let r=42,s=Lt;return this.pushInstruction({type:r,valueType:s,args:n,symbol:t})}BeginIntegral(t,n){let r=21,s=Sn(this,r,[]);return this.pushInstruction({type:r,valueType:s,args:n,endIndex:-1,callData:t})}EndIntegral(t){let n=22,r=Sn(this,n,t),s=t[0],i=this.getInstruction(s);this.instructions[s]={type:i.type,valueType:i.valueType,args:i.args,endIndex:this.instructionsLength(),callData:i.callData};let o=this.pushInstruction({type:n,valueType:r,args:t});return this.markClosedBlock(s,o),o}BeginBroadcast(t,n){let r=23,s=Sn(this,r,[]),i=this.getInstruction(t[0]);if(Je(i)&&hn(this,t[0])>1e4)throw zd();return this.pushInstruction({type:r,valueType:s,endIndex:-1,args:t,context:n})}EndBroadcast(t){let n=24,r=Sn(this,n,t),s=t[0],i=this.getInstruction(s),o={type:i.type,valueType:i.valueType,args:i.args,endIndex:this.instructionsLength(),context:i.context};this.instructions[s]=o;let a=this.pushInstruction({type:n,valueType:r,args:t});return this.markClosedBlock(s,a),a}BeginLoop(t,n){let r=19,s=Sn(this,r,n);return this.pushInstruction({type:r,valueType:s,args:n,endIndex:-1,callData:t})}EndLoop(t){let n=20,r=Sn(this,n,t),s=t[0],i=this.getInstruction(s);this.instructions[s]={type:i.type,valueType:i.valueType,args:i.args,endIndex:this.instructionsLength(),callData:i.callData};let o=this.pushInstruction({type:n,valueType:r,args:t});return this.markClosedBlock(s,o),o}BeginMap(t,n){let r=50,s=Sn(this,r,n);return this.pushInstruction({type:r,valueType:s,args:n,endIndex:-1,callData:t})}EndMap(t){let n=51,r=Sn(this,n,t),s=t[0],i=this.getInstruction(s);this.instructions[s]={type:i.type,valueType:i.valueType,args:i.args,endIndex:this.instructionsLength(),callData:i.callData};let o=this.pushInstruction({type:n,valueType:r,args:t});return this.markClosedBlock(s,o),o}FunctionHeader(t,n,r,s){let i=4;return this.pushLeafInstruction({type:i,valueType:n,endIndex:-1,symbol:t,signature:r,parameterSymbols:s,recursionGroup:[]})}BeginFunction(t){let n=53,r=this.getInstruction(t[0]);return this.pushInstruction({type:n,valueType:r.valueType,endIndex:-1,args:t})}EndFunction(t){let n=54,r=t[0],s=this.getInstruction(r);this.instructions[r]={type:s.type,valueType:s.valueType,args:s.args,endIndex:this.instructionsLength()};let i=s.args[0],o=this.getInstruction(s.args[0]);this.instructions[i]={type:o.type,valueType:o.valueType,endIndex:this.instructionsLength(),symbol:o.symbol,signature:o.signature,parameterSymbols:o.parameterSymbols,recursionGroup:o.recursionGroup};let a=this.pushInstruction({type:n,valueType:Qt,args:t});return this.markClosedBlock(r,a),a}FunctionCall(t){let n=55;return this.pushInstruction({type:n,valueType:Sn(this,n,t),args:t})}ExtendSeed(t,n){let r=44,s=ft;return this.pushInstruction({type:r,valueType:s,args:n,tag:t})}Noop(){let t=0,n=Qt;return this.pushLeafInstruction({type:t,valueType:n})}Action(t,n){return this.pushInstruction({type:49,valueType:ut,args:n,symbols:t})}replaceInstructionWithConstant(t,n){this.instructions[t]=n,this.blockMask[t]=void 0}replaceInstructionWithBlockVarOrFunctionCall(t,n){this.instructions[t]=n}reopenFinalBlock(){let t=this.getInstruction(this.getReturnIndex());if(t.type!==48)return this;let n=t.args[0],s=this.getInstruction(n).args[0];for(let i=s;i<n;i++)this.blockMask[i]=void 0;return this.unsafelyTruncate(n),this}reopenAllBlocks(){this.blockMask=[]}isInClosedBlock(t){return!!this.blockMask[t]}copy(){let t=new e({argNames:this.argNames,argTypes:this.argTypes});return t.instructions=this.instructions.slice(),t.blockMask=this.blockMask.slice(),t.comments=this.comments.slice(),t.derivativeMaps=this.derivativeMaps.clone(),t.warning=this.warning,t.setReturnIndex(this.getReturnIndex()),t}fuseBroadcast(){return this.setReturnIndex(Gr(this,this.getReturnIndex())),this}copyInstruction(t){return po(this,t)}copyInstructionWithArgs(t,n){return _n(this,t,n)}replaceInstructionWithNoop(t){this.instructions[t]={type:0,valueType:Qt}}getReturnType(){return this.instructions[this.getReturnIndex()].valueType}isConstant(){return Je(this.instructions[this.getReturnIndex()])}areAllArgsConstant(t){for(let n of t)if(!Je(this.instructions[n]))return!1;return!0}asValue(){return hn(this,this.getReturnIndex())}asCompilerValue(){let t=this.instructions[this.getReturnIndex()];switch(t.type){case 1:return t.value;default:throw new Error(`Unexpected opcode ${t.type}.`)}}getConstantListLength(){return qn(this,this.getReturnIndex())}getListLengthDependencies(){let t=this.copy(),n=ur(t,t.getReturnIndex());return fs(t,n)}elementAt(t){let n=this.copy(),r=n.getReturnIndex();return n.setReturnIndex(zf(n,r,t)),n}substituteConstantArguments(t){return zN(this,t)}interpretWithParameters(t){return hN(this,this.getReturnIndex(),t)}getCompiledFunction(t){let n;if(t){n=t.slice();for(let o of this.argNames)n.indexOf(o)===-1&&n.push(o)}else n=this.argNames;let{source:r,constants:s}=jg(this),i={};return{args:n,source:r,constants:s,executionMetadata:i,fn:wf(n,r,s,i)}}getRestrictedFunctionForGLSL(t,n){let r=tu(this,t,{allowSlices:!0}),{restrictionChunk:s,valueChunk:i}=r.getValueAndRestrictionChunk(),o;if(s!==void 0)try{o=Ma(s,n)}catch(a){s=void 0}return o===void 0&&r.getSliceVariablesOrImplicit().length==0?{concrete:new on(this),restriction:void 0,restrictionExpr:void 0}:{concrete:new on(i),restriction:o,restrictionExpr:s&&new on(s)}}polynomialOrder(t,n){return $O(this,t,n)}getPolynomialCoefficients(t){return YO(this,t)}takeDerivative(t){let n=this.argNames.indexOf(t);return n===-1?this.setReturnIndex(this.ZeroOfType(this.getReturnType())):this.setReturnIndex(zM(this,this.getReturnIndex(),n)),this}gradient(t){let n=[],r=this.getReturnIndex();for(let s of t){let i=this.argNames.indexOf(s);i===-1?n.push(this.Constant(0)):n.push(zM(this,r,i))}return this.List(n),this}deriveRegressionRestrictions(){return CN(this)}boundDomain(t){return XO(this,t,this.getReturnIndex())}findLinearSubset(t){let n=wN(this),r=[];for(let s of t){let i=this.argNames.indexOf(s);if(i===-1)throw new Error("Programming Error: findLinearSubset called with a non-dependency");r.push(n[i])}return r}isLinearIn(t){let n=this.argNames.filter(r=>t.includes(r));return n.length===0?!1:this.findLinearSubset(n).every(Boolean)}isImplicitPlane(){let t=n=>n==="x"||n==="y"||n==="z";return this.isLinearIn(["x","y","z"])&&this.argNames.every(t)}print(t,n=this.comments){let r;return t===void 0?(t=this.instructionsLength()-1,r={printUnreferencedInstructions:!0,comments:n}):r={printUnreferencedInstructions:!1,comments:n},oO(this,t,r)}printInstruction(t){return al(this,t)}toDot(){return jA(this)}getLiveArgNames(){let t=Vr(this,this.getReturnIndex()),n=[];for(let r=0;r<this.argNames.length;r++)t[r]&&n.push(this.argNames[r]);return n}getCursorContext(){return this.cursorContext}setCursorContext(t){this.cursorContext=t}coerceToNumericIfPossible(){return zi(this,this.getReturnIndex())}coerceNonComplexToNumberIfPossible(){return fl(this,this.getReturnIndex())}};function xl(e,t){return UM(e,t).freeDependencies}function UM(e,t){let n={};if(t.type==="FunctionDefinition"||t.type==="RecursiveFunctionBaseCase"){let{freeDependencies:r,updateSymbols:s}=Hh(e,t._expression,n),i=r.filter(o=>o!==t._symbol);if(t instanceof Cr||t instanceof Qr)for(let o of t._argSymbols)i.includes(o)||i.push(o);return{freeDependencies:i,updateSymbols:s}}return Hh(e,t,n)}function JA(e,t,n){let r=[],s=[],i=[];for(let o of t.scopes){let a=JA(e,o,n);for(let u of a.freeDependencies)r.indexOf(u)===-1&&t.definitions.indexOf(u)===-1&&r.push(u);for(let u of a.updateSymbols)s.indexOf(u)===-1&&s.push(u)}for(let o of t.dependencies){if(t.definitions.indexOf(o)!==-1)continue;let a=aU(e,o,n),u=t.substitutionDependencies.indexOf(o)!==-1;for(let c of a.freeDependencies)r.indexOf(c)===-1&&t.definitions.indexOf(c)===-1&&r.push(c),u&&i.indexOf(c)===-1&&t.definitions.indexOf(c)===-1&&i.push(c);for(let c of a.updateSymbols)s.indexOf(c)===-1&&s.push(c)}return{freeDependencies:r,updateSymbols:s}}function Hh(e,t,n){if(t.type==="Slider"||t.type==="Assignment")return Hh(e,t._expression,n);{let{freeDependencies:r,updateSymbols:s}=JA(e,t.getScope(),n),i=t.getUpdateSymbols();if(i.length>0){s=s.slice();for(let o of i)s.indexOf(o)===-1&&s.push(o)}return{freeDependencies:r,updateSymbols:s}}}function aU(e,t,n){if(n[t])return n[t];let r=uU(e,t,n);return n[t]=r,r}function uU(e,t,n){if(tt[t])return{freeDependencies:[],updateSymbols:[]};let r=e[t];return r?(n[t]={freeDependencies:[],updateSymbols:[]},Hh(e,r,n)):{freeDependencies:[t],updateSymbols:[]}}function QA(e,t){let n={},r=t.getDependencies().slice();for(;r.length;){let s=r.pop();if(n.hasOwnProperty(s))continue;if(e.isLocal(s)||e.isError(s))return;let i=e.getVisibleGlobalDefinition(s);n[s]=i,i&&i.getDependencies&&Array.prototype.push.apply(r,i.getDependencies())}return Object.entries(n)}function KA(e,t,n){e_(e,t,n,{})}function e_(e,t,n,r){let s={};for(let i of n.definitions){if(s[i])switch(n.kind){case"Sum":case"Product":case"Integral":throw U(new Error(`${n.kind} scope is not expected to define multiple symbols`));case"FunctionDefinition":throw II(i);case"ListComprehension":throw qy(i);case"Substitution":throw VP(i);default:let o=n.kind;throw U(new Error(`Unexpected scope kind ${o}`))}s[i]=!0}for(let i of n.definitions){let o=t[i];if(o){if(e.assignmentForbidden(i))switch(n.kind){case"Sum":case"Product":throw vy(i);case"Integral":throw By(i);case"FunctionDefinition":throw Sy(i);case"Substitution":case"ListComprehension":throw af(i);default:let a=n.kind;throw U(new Error(`Unexpected scope kind ${a}`))}if((n.kind==="ListComprehension"||n.kind==="Substitution")&&o.type==="FunctionDefinition")throw uf(i)}if(r[i])switch(n.kind){case"Sum":case"Product":throw vy(i);case"Integral":throw By(i);case"FunctionDefinition":throw Sy(i);case"ListComprehension":throw qy(i);case"Substitution":throw wP(i);default:let a=n.kind;throw U(new Error(`Unexpected scope kind ${a}`))}}r=Tn(r);for(let i of n.definitions)r[i]=!0;for(let i of n.scopes)e_(e,t,i,r)}var Sa={normaldist:{pdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("normalpdf",n.concat(r.args))},cdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("normalcdf",n.concat(r.args))},mean:function(e,t,n){return e.getInstruction(t).args[0]},median:function(e,t,n){return Sa.normaldist.mean(e,t,n)},stdev:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("abs",[r.args[1]])},var:function(e,t,n){let r=e.getInstruction(t);return e.Multiply([r.args[1],r.args[1]])},quantile:function(e,t,n){let r=e.getInstruction(t);return e.Add([e.Multiply([e.NativeFunction("invNorm",n),e.NativeFunction("abs",[r.args[1]])]),r.args[0]])},random:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("normalSample",[n[0],r.args[0],r.args[1]])}},tdist:{pdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("tpdf",n.concat(r.args))},cdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("tcdf",n.concat(r.args))},mean:function(e,t,n){return e.Constant(0)},median:function(e,t,n){return e.Constant(0)},stdev:function(e,t,n){return e.NativeFunction("sqrt",[Sa.tdist.var(e,t,n)])},var:function(e,t,n){let r=e.getInstruction(t),s=e.Constant(2),i=r.args[0];return e.Piecewise([e.GreaterEqual([i,s]),e.Divide([i,e.Subtract([i,s])]),e.Constant(NaN)])},quantile:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("invT",[n[0],r.args[0]])},random:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("tSample",[n[0],r.args[0]])}},poissondist:{pdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("poissonpdf",n.concat(r.args))},cdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("poissoncdf",n.concat(r.args))},mean:function(e,t,n){return e.getInstruction(t).args[0]},median:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("invPoisson",[e.Constant(.5),r.args[0]])},stdev:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("sqrt",[r.args[0]])},var:function(e,t,n){return Sa.poissondist.mean(e,t,n)},quantile:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("invPoisson",[n[0],r.args[0]])},random:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("poissonSample",[n[0],r.args[0]])}},binomialdist:{pdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("binompdf",n.concat(r.args))},cdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("binomcdf",n.concat(r.args))},mean:function(e,t,n){let r=e.getInstruction(t);return e.Multiply([r.args[0],r.args[1]])},median:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("invBinom",[e.Constant(.5),r.args[0],r.args[1]])},stdev:function(e,t,n){return e.NativeFunction("sqrt",[Sa.binomialdist.var(e,t,n)])},var:function(e,t,n){let r=e.getInstruction(t),[s,i]=r.args;return e.Multiply([s,e.Multiply([i,e.Subtract([e.Constant(1),i])])])},quantile:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("invBinom",[n[0],r.args[0],r.args[1]])},random:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("binomSample",[n[0],r.args[0],r.args[1]])}},uniformdist:{pdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("uniformpdf",n.concat(r.args))},cdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("uniformcdf",n.concat(r.args))},mean:function(e,t,n){let r=e.getInstruction(t);return e.Divide([e.Add([r.args[0],r.args[1]]),e.Constant(2)])},median:function(e,t,n){return Sa.uniformdist.mean(e,t,n)},stdev:function(e,t,n){return e.NativeFunction("sqrt",[Sa.uniformdist.var(e,t,n)])},var:function(e,t,n){let r=e.getInstruction(t),s=e.Subtract([r.args[1],r.args[0]]);return e.Divide([e.Multiply([s,s]),e.Constant(12)])},quantile:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("invUniform",[n[0],r.args[0],r.args[1]])},random:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction("uniformSample",[n[0],r.args[0],r.args[1]])}}};function t_(e,t,n){let r=n[0],s=e.Constant(0),i=e.Constant(1);if(qn(e,t)===0)return e.Constant(NaN);let a=ur(e,t);return e.InboundsListAccess([t,e.Add([e.NativeFunction("floor",[e.Multiply([e.NativeFunction("uniformSample",[r,s,i]),a])]),i])])}function n_(e,t,n){switch(t){case R:return e.NativeFunction("complex",n);case N:case z:return e.TupleOfType(t,n);default:throw U(`Type ${at(t)} is not a supported aggregate type for building.`)}}function am(e){if(!e)return;let{latex:t,latexSelection:n}=e;if(t===void 0||n===void 0)return;let{start:r,end:s}=n;return{input:t,start:r,end:s}}function qM(e,t,n){if(!t)return;let r=$M(t,n._expression);r==="start-to-end"?e.setCursorContext({type:n.type==="Assignment"?"assignment-rhs":"function-definition-body",allowedTypes:[Qt]}):r==="empty-list"&&e.setCursorContext({type:"expression-arguments",expressionType:"List",argIndex:0,argCount:0,isLastValidArg:!1,positionWithinArg:"start-to-end",allowedTypesForInsertedArg:[Qt]})}function r_(e,t,n){if(t){let r=$M(t,n.args[1]);r==="start-to-end"?e.setCursorContext({type:"for-assignment-rhs",allowedTypes:[de,ce,ie,fe,Ne,xe,...ii.types]}):r==="empty-list"&&e.setCursorContext({type:"for-assignment-rhs",allowedTypes:[Qt]})}}function sd(e,t,n,r,s){let i=cU(e,t,n,r,s);i&&e.setCursorContext(i)}function $M(e,t){let n=t.getInputSpan();return n?e.start===n.start&&e.end===n.end?"start-to-end":e.start===e.end&&e.start===n.end?"end":e.start===e.end&&e.start===n.start?"start":e.start===e.end&&t.type==="List"&&t.args.length===0?"empty-list":"not-aligned":"not-aligned"}function YM(e,t){if(!e)return;let n=!1;t instanceof Ms&&t.args[1]instanceof gn&&(n=!0,t=t.args[1]);let r=t.args;if(r){if(r.length===0){let s=t.getInputSpan();if(!s)return;let i=Yn(s),o=-1;return t.type==="List"?o=i.indexOf("["):(t.type==="FunctionCall"||t.type==="SeededFunctionCall")&&(o=i.indexOf("(")),o<0?void 0:e.start===s.start+o+1?{argIndex:0,positionWithinArg:"start-to-end",isDotCall:n}:void 0}for(let s=0;s<r.length;s++){let i=r[s],o=i.getInputSpan();if((o==null?void 0:o.input)!==e.input)continue;if(e.start<o.start)break;let a=$M(e,i);if(a!=="not-aligned")return{argIndex:s,positionWithinArg:a,isDotCall:n}}}}function cU(e,t,n,r,s){if(!n||!r.args)return;let i=YM(n,r);if(i===void 0)return;i.isDotCall&&(r=r.args[1]);let o=i.positionWithinArg==="end"?i.argIndex+1:i.argIndex;i.isDotCall&&(o+=1);let a;i.positionWithinArg==="empty-list"||i.positionWithinArg==="start-to-end"?a=[...s.slice(0,o),void 0,...s.slice(o+1)]:r instanceof Fr?a=o===1?[s[0],void 0,s[1]]:[s[0],s[1],void 0]:a=[...s.slice(0,o),void 0,...s.slice(o)],a=a.map(p=>{if(!(p===void 0||e.getInstruction(p).type===2))return p});let u=[];for(let p of a)u.push(p===void 0?void 0:e.getInstruction(p).valueType);let c=ch(t,r,u),l=c&&Ad(c,o);if(i.positionWithinArg==="empty-list"){let p=l==null?void 0:l.filter(j).map(Ve);return(p==null?void 0:p.length)===0?void 0:{type:"expression-arguments",expressionType:"List",argIndex:0,argCount:0,isLastValidArg:!1,positionWithinArg:"start-to-end",allowedTypesForInsertedArg:p!=null?p:[Qt]}}else{if((l==null?void 0:l.length)===0)return;let p=!1;if(c){let y=0;for(let g of c){let m=g.maxArity!==void 0?g.maxArity-1:1/0;y=Math.max(y,m)}p=i.positionWithinArg==="end"&&i.argIndex===y-1||i.positionWithinArg==="start-to-end"&&i.argIndex===y}let f=r.args.length;if(r instanceof Fr&&r.args.length===3){let y=r.args[2];y instanceof Et&&y.isNaN()&&(f=2)}let d={type:"expression-arguments",expressionType:r.type,argIndex:i.argIndex,argCount:f,isLastValidArg:p,positionWithinArg:i.positionWithinArg,allowedTypesForInsertedArg:l!=null?l:[Qt]};if(r instanceof gn&&(d.functionSymbol=r._symbol,d.isDotCall=i.isDotCall,r instanceof gn&&r._symbol==="polygon")){let y=r.args.filter(g=>!(g instanceof we&&g._symbol==="cursor"));if(y.length>0){let g=y[0].getInputSpan(),m=y[y.length-1].getInputSpan();d.polygonVertices=g&&m?{firstLatex:Yn(g),lastLatex:Yn(m)}:void 0}}return d}}function um(e,t,n){if(t===n)return!0;if(t<n)return!1;let r=[!0];for(let i=n+1;i<=t;i++)r.push(!1);let s=[t];for(;s.length;){let i=s.pop();if(r[i-n])continue;r[i-n]=!0;let o=e.getInstruction(i);if(!ge(o))for(let a of e.getDirectDependencies(o)){if(a===n)return!0;a<n||r[a-n]||s.push(a)}}return!1}function s_(e,t,n){return zh(e,r=>{var p,f;let{chunk:s}=r,i=[],o=[];for(let d=0;d<n.length;d++){let y=s.getInstruction(n[d]).valueType;j(y)?(i.push(2),o.push(s.SymbolicVar(y,t._argSymbols[d]))):(i.push(0),o.push(n[d]))}if(i.every(d=>d===0))return i;let a=Uh(r,t,o),u=Math.min(...o),c=Vr(s,a),l=[];for(let d=0;d<o.length;d++)l[o[d]]=new Set([d]);for(let d=u;d<=a;d++){if(!c[d])continue;let y=s.getInstruction(d);if(!ge(y)){if(y.type===39||y.type===40||y.type===41){let g=y.args[0],m=y.args[1],h=s.getInstruction(m);if(h.type===23){let x=h.endIndex,T=(p=l[x])!=null?p:new Set;for(let b of l[g]||[])T.add(b);l[x]=T;continue}}if(y.type===48)l[d]=l[y.args[0]];else if(y.type===37&&y.symbol==="count"&&y.args.length===1)l[d]=l[y.args[0]];else if(!(y.type===23&&((f=y.context)==null?void 0:f.type)==="implicit")){if(!(y.type===44&&y.tag==="fc"))for(let g of y.args){let m=l[g]||[];for(let h of m)i[h]=1}}}}return i})}function lU(e,t,n){let r=rd.empty(t);for(let s=0;s<e.argNames.length;s++){let i=e.argNames[s];n.includes(i)?r.addLexicalBinding(i,s):r.setFreeVariable(i,s)}return r}var id=class id{constructor(t,n,r,s,i){if(this.kind=t,this.substitutedGlobals={...n==null?void 0:n.substitutedGlobals},this.functionBodySubstitutions={...n==null?void 0:n.functionBodySubstitutions},t&&r&&i){let o=i.filter(a=>r.isGlobal(a));for(let a of o)this.substitutedGlobals[a]||(this.substitutedGlobals[a]=t);if(s&&o.length>0){let a=this.recursionGroupKey(s.fnSymbols);this.functionBodySubstitutions[a]||(this.functionBodySubstitutions[a]={operator:t,substitutedGlobals:o})}}}recursionGroupKey(t){return[...t].sort().join(",")}getFunctionBodySubstitution(t){let n=this.recursionGroupKey(t);return this.functionBodySubstitutions[n]}allowsRegressionParameterDependency(){if(!this.kind)return!0;for(let t in this.substitutedGlobals)return!1;return!0}getRegressionDependencyError(t){if(this.allowsRegressionParameterDependency())return;let[n,r]=Object.entries(this.substitutedGlobals)[0];return FP(n,t,r)}getKind(){return this.kind}getSubstitutedGlobals(){return this.substitutedGlobals}with(t,n,r){return new id("with",this,t,n,r)}for(t,n,r){return new id("for",this,t,n,r)}};id.root=new id;var im=id,WM=class{constructor(t,n){this.definitions=t;this.baseCases=n;this.type="type-inference";this.argTypes={};this.returnTypes={};this.baseCaseTypes={};this.firstValidBaseCaseIdentifiers={};this.stack=[];this.isUnconditionallyRecursive=!1;this.fnSymbols=Object.keys(t)}registerFunctionCall(t,n){this.argTypes[t]||(this.argTypes[t]=n)}};function HM(e,t,n,r,s,i){return{policy:e,chunk:t,scope:n,substitutionContext:r,recursiveFunctionContext:s,selection:i}}function Ci(e,t){return{...e,scope:t}}function zh(e,t){let{chunk:n,scope:r}=e,s=n.instructionsLength(),i=r.childScopeWithChildGlobalCache(),o=Ci(e,i),a=t(o);return n.unsafelyTruncate(s),a}function jh(e){let{policy:t,frame:n,argNames:r,argTypes:s,selection:i,locals:o}=e,a=new Ia({argNames:r,argTypes:s}),u=lU(a,n,o);return HM(t,a,u,im.root,void 0,i)}function od(e,t){let{policy:n,frame:r,argNames:s,argTypes:i}=e,o=am(t.userData),a=UM(r,t),{freeDependencies:u,updateSymbols:c}=a;if(s||(s=u),!i){i=[];for(let f=0;f<s.length;f++)i.push(I)}let l;t.type==="FunctionDefinition"||t.type==="RecursiveFunctionBaseCase"?l=t._argSymbols:l=[];let p=jh({policy:n,frame:r,argNames:s,argTypes:i,selection:o,locals:l});try{KA(n,r,t.getScope()),Fe(p,t),e.coerceToNumber==="all"||se(p.chunk.getReturnType(),Gt)?p.chunk.coerceToNumericIfPossible():e.coerceToNumber==="all-except-complex"&&p.chunk.coerceNonComplexToNumberIfPossible(),e.wrapInList&&!j(p.chunk.getReturnType())&&p.chunk.List([p.chunk.getReturnIndex()]),p.chunk.fuseBroadcast(),pU(p,t,c)}catch(f){let d=f instanceof v?f:U(f);d.setCursorContext(p.chunk.getCursorContext()),p.chunk.setError(d)}return p.chunk}function pU(e,t,n){let{chunk:r,scope:s}=e;if(t.type==="FunctionDefinition"){for(let o of n)if(t._argSymbols.indexOf(o)!==-1||t._symbol===o)throw my(o)}let i=[];for(let o of n)s.isDefined(o)||i.push(o);if(i.length){let o=JM(e,i[0]).setDependencies(r.argNames.concat(i));throw r.isConstant()&&r.getReturnType()===ut&&o.setActionValue(r.asValue()),o}}function Fe(e,t){let n;if(GO(),mU(e,t))FO(),n=e.chunk.copyInstruction(t.__IRCache.instruction);else{VO();let r=e.chunk.instructionsLength();n=yU(e,t),n=dU(e,r,n),fU(e,t,n)}return e.chunk.setReturnIndex(n),n}function dU(e,t,n){let{chunk:r,scope:s}=e;if(n<=t)return n;let i=r.getInstruction(n);return Je(i)?(r.unsafelyTruncate(Math.max(t,s.getMaxIndex()+1)),po(r,i)):n}function fU(e,t,n){let{chunk:r,scope:s}=e,i=r.getInstruction(n);if(!Je(i))return;let o=QA(s,t);o&&(BO(),t.__IRCache={keys:o,instruction:i})}function mU(e,t){let{scope:n,substitutionContext:r}=e;if(!t.__IRCache)return!1;let s=t.__IRCache.keys;for(let[i,o]of s){if(n.isLocal(i)||n.isError(i))return!1;let a=n.getVisibleGlobalDefinition(i);if(a!==o||a&&a.type==="RegressionParameter"&&!r.allowsRegressionParameterDependency())return!1}return!0}function yU(e,t){var u,c,l,p;let{policy:n,chunk:r,scope:s,substitutionContext:i,selection:o}=e,a=t.type;switch(a){case"Constant":{let d=t._constantValue,y=typeof d=="boolean"?De:I;return r.ConstantOfType(y,d)}case"RegressionParameter":return r.Constant(t._constantNode._constantValue);case"MixedNumber":return r.Constant(t._constantValue);case"ImaginaryUnit":return r.ImaginaryUnit();case"Negative":return r.Negative(qh(e,t,t.args));case"Add":return r.Add(yo(e,t,t.args));case"Subtract":return r.Subtract(yo(e,t,t.args));case"Multiply":return r.Multiply(yo(e,t,t.args));case"DotMultiply":{let[d,y]=yo(e,t,t.args);return(c=(u=a_(e,d,y))!=null?u:eu(r,[d,y])?a_(e,Ss(r,d),Ss(r,y),{forcePermitted:!0}):void 0)!=null?c:r.Multiply([d,y])}case"CrossMultiply":{let[d,y]=yo(e,t,t.args);return e.policy.is3dPolicy()?gt(r,d,ke)&&gt(r,y,ke)?$u(r,[u_(e,Ss(r,d),Ss(r,y)),$o(r,d)]):gt(r,d,z)&&gt(r,y,z)?u_(e,d,y):r.Multiply([d,y]):r.Multiply([d,y])}case"Divide":return r.Divide(yo(e,t,t.args));case"Exponent":{let d=yo(e,t,t.args);if(n.isComplexEnabled()){let y=t.args[1];if(RU(y)){let g=r.getInstruction(d[0]).valueType;if(Ec(g,I)||Ec(g,ne))return r.Exponent(d)}return r.NativeFunction("complexPow",d)}else return r.Exponent(d)}case"Comparator[\'=\']":case"Comparator[\'>\']":case"Comparator[\'<\']":case"Comparator[\'>=\']":case"Comparator[\'<=\']":return r.Comparator(t.operator,yo(e,t,t.args));case"ComparatorChain":{let d=Ju(e,t,t.args),y=r.Comparator(t.symbols[0],[d[0],d[1]]);for(let g=1;g<t.symbols.length;g++)y=r.And([y,r.Comparator(t.symbols[g],[d[g],d[g+1]])]);return y}case"Or":return r.Or(yo(e,t,t.args));case"PercentOf":return r.Divide([r.Multiply(yo(e,t,t.args)),r.Constant(100)]);case"ParenSeq":return IU(e,t);case"BareSeq":return PU(e,t);case"NamedCoordinateAccess":{let[d]=qh(e,t,t.args),y=t.symbol;switch(y){case"x":return r.Slot(0,[d]);case"y":return r.Slot(1,[d]);case"z":return r.Slot(2,[d]);default:{let g=y;throw new Error(`Programming Error: unexpected named coordinate: \'${g}\'.`)}}}case"Norm":{let d=qh(e,t,t.args)[0];return gt(r,d,R)?Yh(r,d):(p=(l=jM(e,d))!=null?l:eu(r,[d])?jM(e,Ss(r,d)):void 0)!=null?p:r.NativeFunction("abs",[d])}case"UpdateRule":{let d=t._symbol;if(s.isLocal(d))throw JM(e,d);let y=s.getVisibleGlobalDefinition(d);if(y!==void 0&&y.type!=="Assignment"&&y.type!=="Slider")throw JM(e,d);let g=Fe(e,t.args[1]);return r.Action([d],[g])}case"List":case"TableColumnValue":{if(t.getDependencies().length>0)return ms(t.args),r.List(Ju(e,t,t.args));if(t.args.length===0)return sd(r,n,o,t,[]),r.ConstantOfType($e,[]);{let d=r.instructionsLength(),y=[],g,m;ms(t.args);let h=!0;for(let T of t.args){let b=Fe(e,T),M=r.getInstruction(b);if(g===void 0){if(g=M.valueType,!wn(g))throw vc([oe(g)],{blockExport:h});m=vn(g)}else if(M.valueType!==g){if(fu(g,M.valueType)!==void 0)return r.unsafelyTruncate(d),r.List(Ju(e,t,t.args));throw Hd({blockExport:h})}if(M.type!==1)throw new Error("Programming error: expected list with no dependencies to constant collapse.");y.push(M.value),r.unsafelyTruncate(d)}let x=YM(e.selection,t);if(e.selection&&x!==void 0&&m!==void 0&&x.positionWithinArg!=="empty-list"){let T=Ve(m);r.setCursorContext({type:"expression-arguments",expressionType:"List",argIndex:x.argIndex,argCount:t.args.length,isLastValidArg:!1,positionWithinArg:x.positionWithinArg,allowedTypesForInsertedArg:[T]})}return r.ConstantOfType(m,y)}}case"ListAccess":{let d=Fe(e,t.args[0]),y=r.getInstruction(d);if(t.args[1].type==="Range"&&t.args[1].args[1].length===0){if(!j(y.valueType))throw Bd([oe(y.valueType),oe(I)],{blockExport:Je(y)});let g=ur(r,d),m=QM(e,Fe(e,t.args[1].args[0]),r.List([g]),{stepMustBePositive:!0});return r.ListAccess([d,m])}else{let g=Fe(e,t.args[1]),m=r.getInstruction(g);if(Uo(r,n,t,[d,g]),m.valueType===Xn)return r.NativeFunction("select",[d,g]);if(m.valueType===De&&j(y.valueType)){let h=r.ConstantOfType(y.valueType,[]);return r.Piecewise([g,d,h])}return r.ListAccess([d,g])}}case"Range":{let[d,y]=yo(e,t,t.args);return QM(e,d,y,{stepMustBePositive:!1})}case"ListComprehension":return MU(e,t);case"Piecewise":{let d=Fe(e,t.args[0]),y=r.getInstruction(d),g=y.type===1&&y.value===!1,m=y.type===1&&y.value===!0,h;h=r.getWarning();let x=Fe(e,t.args[1]);g&&r.restoreWarning(h),h=r.getWarning();let T=Fe(e,t.args[2]);m&&r.restoreWarning(h);let b=[d,x,T];sd(e.chunk,e.policy,e.selection,t,b),Uo(e.chunk,e.policy,t,b);let M=r.getInstruction(b[1]),P=r.getInstruction(b[2]),D=_i(M.valueType,P.valueType)||_i(P.valueType,M.valueType);if(y.type===1&&y.valueType===De&&D){let _=b[y.value?1:2],L=r.getInstruction(_),w=M.valueType!==$e?M.valueType:P.valueType;return L.valueType===$e&&w!==$e?r.ConstantOfType(w,[]):_}let S=M.valueType,O=j(S)?Ve(S):S;if(!D&&Je(P)&&P.valueType===I&&Ii(P.value)&&io(O)){if(se(M.valueType,Gt))return r.NativeFunction("restriction",[r.And([b[0],r.NativeFunction("restrictionToBoolean",[b[1]])])]);let _=r.NanOfType(O);b=[b[0],b[1],_]}return r.Piecewise(b)}case"Restriction":return r.NativeFunction("restriction",qh(e,t,t.args));case"Ans":case"Identifier":{let d=t._symbol,y=t._errorSymbol;if(t.type==="Ans"&&r.argNames.indexOf(d)!==-1)throw EP();let g=s.getSymbol(d);if(g!==void 0)return g;let m=s.getVisibleGlobalDefinition(d);if(m===void 0)throw tt[d]?tt[d].isFunction?Li(y,e.policy):_c(y):e.recursiveFunctionContext&&e.recursiveFunctionContext.fnSymbols.includes(d)?Iy(d):new Error(`Programming Error: reached undefined symbol ${d}`);if(s.isLocal(d)||m.isFunction)throw Iy(y);if(m.type==="RegressionParameter"){let x=i.getRegressionDependencyError(y);if(x)throw x}let h;if(m instanceof Qr)h=Fe(e,m);else{let x=s.newLexicalScope(),T=Ci(e,x);h=Fe(T,m)}return s.cacheGlobal(d,h,m),h}case"FunctionCall":case"SeededFunctionCall":{ms(t.args);let d=Ju(e,t,t.args);return ms(d),$h(e,t._symbol,t._errorSymbol,d,t.args)}case"Substitution":return vU(e,t);case"FunctionExponent":{let d=t.args[0]._symbol,y=s.getVisibleGlobalDefinition(d),g=s.getSymbol(d),m=g!==void 0?r.getInstruction(g):void 0;return s.isLocal(d)&&(m==null?void 0:m.type)===4||y!=null&&y.isFunction?Fe(e,new C.Exponent([new C.FunctionCall(d,[t.args[1]]),t.args[2]])):Fe(e,new C.Multiply([t.args[0],new C.Exponent([t.args[1],t.args[2]])]))}case"FunctionFactorial":{let d=t.args[0]._symbol,y=s.getVisibleGlobalDefinition(d),g=s.getSymbol(d),m=g!==void 0?r.getInstruction(g):void 0;return s.isLocal(d)&&(m==null?void 0:m.type)===4||y!=null&&y.isFunction?Fe(e,new C.FunctionCall("\\\\factorial",[new C.FunctionCall(d,[t.args[1]])])):Fe(e,new C.Multiply([t.args[0],new C.FunctionCall("\\\\factorial",[t.args[1]])]))}case"DotAccess":{let d=t.args[0],y=t.args[1],g=s.getVisibleGlobalDefinition(y._symbol);if(d.type==="Identifier"&&d._symbol==="construction")return OU(e,y);if((y.type==="Identifier"||y.type==="FunctionCall")&&(g!=null&&g.isFunction)){let m=y._symbol,h=y._errorSymbol;if(Af(g))throw Gd(h);let x=y.type==="Identifier"?[d]:[d].concat(y.args),T=Ju(e,t,x);return $h(e,m,h,T,x)}else if(y.type==="SeededFunctionCall"){let m=y._symbol,h=y._errorSymbol,x=[y.seed,d].concat(y.args.slice(1)),T=Ju(e,t,x);return $h(e,m,h,T,x)}else throw ks(".")}case"Seed":return r.ConstantOfType(ft,t._stringValue);case"ExtendSeed":return r.ExtendSeed(t.tag,yo(e,t,t.args));case"Integral":{let d=t._differential._symbol,y=s.childScope();y.setErrorIfAccessed(d,xP(d));let g=Ci(e,y),m=Fe(g,t.args[1]),h=Fe(g,t.args[2]),x=r.getInstruction(m),T=r.getInstruction(h),b=r.SymbolicVar(I,d),M=s.childScope();M.addLexicalBinding(d,b);let P=Fe(Ci(e,M),t.args[3]);if(Uo(r,n,t,[m,h,P]),!um(r,P,b))return r.Multiply([P,r.Subtract([h,m])]);let D=Jp(r,[m,h,P]);if(D!==void 0&&um(r,D,b))throw LP(d);let S=D!==void 0?r.BeginBroadcast([D]):void 0,O=m;S!==void 0&&j(x.valueType)&&(O=Ea(r,m,S));let _=h;S!==void 0&&j(T.valueType)&&(_=Ea(r,h,S));let L=r.getInstruction(P).valueType,w=j(L)?Ve(L):L,G;if($l(w)&&w!==I){let k=[],Z=w===R||w===N?2:3;for(let F=0;F<Z;F++){let Y=r.BeginIntegral({indexSymbol:d},[O,_]),re=su(r,Y,b,P),Ee=r.getInstruction(re);S!==void 0&&j(Ee.valueType)&&(re=Ea(r,re,S)),re=r.Slot(F,[re]);let he=r.EndIntegral([Y,re]);k.push(r.BlockVar(I,[he]))}G=n_(r,w,k)}else{let k=r.BeginIntegral({indexSymbol:d},[O,_]),Z=su(r,k,b,P),F=r.getInstruction(Z);S!==void 0&&j(F.valueType)&&(Z=Ea(r,Z,S));let Y=r.EndIntegral([k,Z]);G=r.BlockVar(I,[Y])}if(S!==void 0){let k=r.EndBroadcast([S,G]);return r.BroadcastResult(vn(w),[k])}else return G}case"Sum":case"Product":{let d=t._index._symbol,y=t.type==="Sum",g=s.childScope();g.setErrorIfAccessed(d,y?cP(d):lP(d));let m=Ci(e,g),h=Fe(m,t.args[1]);h=zi(m.chunk,h);let x=Fe(m,t.args[2]);if(x=zi(m.chunk,x),!gt(r,h,I)){let me=zu(r,[h]),J=r.areAllArgsConstant([h]);throw y?rT(me,{blockExport:J}):oT(me,{blockExport:J})}if(!gt(r,x,I)){let me=zu(r,[x]),J=r.areAllArgsConstant([x]);throw y?sT(me,{blockExport:J}):aT(me,{blockExport:J})}let T=r.NativeFunction("round",[h]),b=r.NativeFunction("round",[x]),M=r.getInstruction(T),P=r.getInstruction(b);if(M.type===1&&M.valueType===I&&!isFinite(V(M.value)))throw y?py():dy();if(P.type===1&&P.valueType===I&&!isFinite(V(P.value)))throw y?py():dy();let D=r.SymbolicVar(I,d),S=s.childScope();S.addLexicalBinding(d,D);let O=Fe(Ci(e,S),t.args[3]),_=r.getInstruction(O).valueType,L=j(_)?Ve(_):_,G=(t.type==="Sum"?ql:Jm).find(me=>Ec(L,me));if(G===void 0){let me=zu(r,[O]),J=r.areAllArgsConstant([O]);throw y?iT(me,{blockExport:J}):uT(me,{blockExport:J})}if(!um(r,O,D)){let me=r.Add([r.Subtract([b,T]),r.Constant(1)]);me=r.NativeFunction("listMax",[me,r.Constant(0)]);let J=y?r.Multiply([O,me]):G===R?r.NativeFunction("complexPow",[O,me]):r.RawExponent([O,me]);return r.Piecewise([r.Less([me,r.Constant(1/0)]),J,r.NanOfType(G)])}let k=Jp(r,[T,b,O]);if(k!==void 0&&um(r,k,D))throw y?AP(d):_P(d);let Z=k!==void 0?r.BeginBroadcast([k]):void 0,F=T;Z!==void 0&&j(M.valueType)&&(F=Ea(r,T,Z));let Y=b;Z!=null&&j(P.valueType)&&(Y=Ea(r,b,Z));let re=y?r.ZeroOfType(G):G===R?r.NativeFunction("complex",[r.Constant(1),r.Constant(0)]):r.Constant(1),Ee=r.BeginLoop({type:y?"sum":"product",indexSymbol:d},[F,Y,re]),he=r.BlockVar(G,[Ee]),K=su(r,Ee,D,O),Oe=r.getInstruction(K);Z!==void 0&&j(Oe.valueType)&&(K=Ea(r,K,Z));let te=y?r.Add([he,K]):r.Multiply([he,K]),Ze=r.EndLoop([Ee,te]),dt=r.BlockVar(G,[Ze]);if(Z!==void 0){let me=r.EndBroadcast([Z,dt]);return r.BroadcastResult(vn(G),[me])}else return dt}case"Derivative":{let d=t._symbol,y=Fe(e,new C.Identifier(d)),g=fl(r,y),m=r.getInstruction(g),h=om(m.valueType);if(!h)throw mT(d,zu(r,[g]),{blockExport:Je(m)});let x,T,b=!1;if((m.type===2||m.type===3)&&m.valueType===I)x=e,T=g;else{let S=s.childScope();T=r.SymbolicVar(m.valueType),S.addDynamicBinding(d,T),b=!0,x=Ci(e,S)}let M=1;for(;t.args[0].type==="Derivative"&&t.args[0]._symbol===t._symbol;)M+=1,t=t.args[0];let D=Gr(r,Fe(x,t.args[0]));for(let S=0;S<M;S++)D=kh(r,D,T,h);return T===g?D:(b&&r.derivativeMaps.pruneIP(T),su(r,g,T,D))}case"Prime":{let d=t.args[0];if(s.isLocal(d._symbol))throw Py(d._symbol);let y=s.getVisibleGlobalDefinition(d._symbol);if(!y)throw Dy(d._symbol);if(!y.isFunction)throw Py(d._symbol);let g=Fe(e,d.args[0]),m=fl(r,g),h=r.getInstruction(m),x=om(h.valueType);if(!x)throw yT(d._symbol,zu(r,[m]),{blockExport:Je(h)});let T=!1,b;(h.type===2||h.type===3)&&h.valueType===I?b=m:(b=r.SymbolicVar(h.valueType),T=!0);let M,P;if(d._symbol==="logbase"){if(d.args.length!==2)throw Nc();M=[b,Fe(e,d.args[1])],P=[d.args[0],d.args[1]]}else{if(d.args.length!==1)throw Nc();M=[b],P=[d.args[0]]}let S=Gr(r,$h(e,d._symbol,d._errorSymbol,M,P));for(let O=0;O<t.order;O++)S=kh(r,S,b,x);return b===m?S:(T&&r.derivativeMaps.pruneIP(b),su(r,m,b,S))}case"Slider":return e.chunk.Constant(t.getConcreteTree(n,s.frame).asCompilerValue());case"Assignment":return qM(r,e.selection,t),Fe(e,t._expression);case"FunctionDefinition":{let d=t;if(qM(r,e.selection,d),d.recursionInfo)return P_(e,d,d.recursionInfo);{let y=e.policy.isRecursionEnabled()&&e.policy.assignmentForbidden(d._symbol),g=s.childScope();return g.setErrorIfAccessed(d._symbol,Rc([d._symbol],{suggestAlternativeFunctionName:y})),Fe(Ci(e,g),t._expression)}}case"RecursiveFunctionBaseCase":{let d=s.childScope(),y=t;return d.setErrorIfAccessed(y._symbol,CI(y._symbol)),Fe(Ci(e,d),t._expression)}case"Construction":throw ks("construction");default:let f=a;throw new Error(`Programming error, unimplemented node type ${f}`)}}function qh(e,t,n){let r=[Fe(e,n[0])];return sd(e.chunk,e.policy,e.selection,t,r),Uo(e.chunk,e.policy,t,r),r}function yo(e,t,n){let r=[Fe(e,n[0]),Fe(e,n[1])];return sd(e.chunk,e.policy,e.selection,t,r),Uo(e.chunk,e.policy,t,r),r}function Yh(e,t){return e.NativeFunction("hypot",[e.Slot(0,[t]),e.Slot(1,[t])])}function m_(e,t){return gt(e,t,I)?t:e.Slot(0,[t])}function y_(e,t){return gt(e,t,I)?e.Constant(0):e.Slot(1,[t])}function g_(e,t){return gt(e,t,I)?t:e.NativeFunction("complex",[e.Slot(0,[t]),e.Negative([e.Slot(1,[t])])])}function Tl(e,t){return h_(e,t,"mean")}function h_(e,t,n){return Ui(e,t,n,[{match:_r(Te,0),build:()=>e.NativeFunction(n,t)},{match:_r(R,1),build:()=>e.NativeFunction("complex",[e.NativeFunction(n,t.map(r=>m_(e,r))),e.NativeFunction(n,t.map(r=>y_(e,r)))])},{match:_r(N,1),build:()=>{let r=s=>e.NativeFunction(n,t.map(i=>e.Slot(s,[i])));return e.TupleOfType(N,[r(0),r(1)])}},{match:_r(z,1),build:()=>{let r=s=>e.NativeFunction(n,t.map(i=>e.Slot(s,[i])));return e.TupleOfType(z,[r(0),r(1),r(2)])}}])}function cm(e,t){return Ui(e,t,"varp",[{match:_r(Te,0),build:()=>e.NativeFunction("varp",t)},{match:_r(R,1),build:()=>{let n=Tl(e,t);return Tl(e,t.map(r=>gU(e,e.Subtract([r,n]))))}}])}function i_(e,t){return Xh(e,t)?lm(e,t,"var"):Ui(e,t,"var",[{match:_r(Te,1),build:()=>e.NativeFunction("var",t)},{match:_r(R,1),build:()=>{let n=e.NativeFunction("count",t);return e.Divide([e.Multiply([cm(e,t),n]),e.Subtract([n,e.Constant(1)])])}}])}function o_(e,t,n){let r=e.BeginBroadcast([n]),s=e.InboundsListAccess([t,r]),i=e.EndBroadcast([r,s]);return e.BroadcastResult(vn(e.getInstruction(s).valueType),[i])}function XM(e,t){return Ui(e,t,"covp",[{match:[ro,ro],noBroadcast:!0,build:()=>e.NativeFunction("covp",t)},{match:[Ue,Ue],noBroadcast:!0,build:()=>{let n=e.NativeFunction("listMin",[ur(e,t[0]),ur(e,t[1])]),r=o_(e,t[0],n),s=o_(e,t[1],n),i=Tl(e,[r]),o=Tl(e,[s]);return Tl(e,[e.Multiply([e.Subtract([r,i]),g_(e,e.Subtract([s,o]))])])}}])}function gU(e,t){return e.Add([e.Multiply([e.Slot(0,[t]),e.Slot(0,[t])]),e.Multiply([e.Slot(1,[t]),e.Slot(1,[t])])])}function jM(e,t){let n=e.chunk;return gt(n,t,z)?n.NativeFunction("hypot",[n.Slot(0,[t]),n.NativeFunction("hypot",[n.Slot(1,[t]),n.Slot(2,[t])])]):gt(n,t,N)?n.NativeFunction("hypot",[n.Slot(0,[t]),n.Slot(1,[t])]):void 0}function a_(e,t,n,{forcePermitted:r}={forcePermitted:!1}){let s=e.chunk;return(r||e.policy.is3dProduct())&&gt(s,t,N)&&gt(s,n,N)?s.Add([s.Multiply([s.Slot(0,[t]),s.Slot(0,[n])]),s.Multiply([s.Slot(1,[t]),s.Slot(1,[n])])]):(r||e.policy.is3dProduct())&&gt(s,t,z)&&gt(s,n,z)?s.Add([s.Add([s.Multiply([s.Slot(0,[t]),s.Slot(0,[n])]),s.Multiply([s.Slot(1,[t]),s.Slot(1,[n])])]),s.Multiply([s.Slot(2,[t]),s.Slot(2,[n])])]):void 0}function u_(e,t,n){let r=e.chunk,s=r.Slot(0,[t]),i=r.Slot(1,[t]),o=r.Slot(2,[t]),a=r.Slot(0,[n]),u=r.Slot(1,[n]),c=r.Slot(2,[n]);return r.TupleOfType(z,[r.Subtract([r.Multiply([i,c]),r.Multiply([o,u])]),r.Subtract([r.Multiply([o,a]),r.Multiply([s,c])]),r.Subtract([r.Multiply([s,u]),r.Multiply([i,a])])])}function Ju(e,t,n){let r=[];for(let s of n)r.push(Fe(e,s));return sd(e.chunk,e.policy,e.selection,t,r),Uo(e.chunk,e.policy,t,r),r}function $h(e,t,n,r,s){var f;let{chunk:i,scope:o,recursiveFunctionContext:a,substitutionContext:u,policy:c}=e;if(t=_g(c,t),a&&a.type==="type-inference"&&a.definitions[t]){let d=u.getFunctionBodySubstitution(a.fnSymbols);if(d&&d.substitutedGlobals.length>0)throw BP(d.operator,d.substitutedGlobals[0],t);a.registerFunctionCall(t,r.map(m=>i.getInstruction(m).valueType));let y=a.definitions[t];if(y instanceof v)throw y;let g=M_(e,a,y,r);return i.SymbolicVar(g.returnType)}let l=o.getSymbol(t);if(l!==void 0){let d=i.getInstruction(l);if(d.type===4){if(d.signature.argTypes.length!==r.length)throw Ao(t,d.signature.argTypes.length,r.length,{includeUsageExample:!0});for(let y=0;y<r.length;y++){let g=i.getInstruction(r[y]).valueType,m=d.signature.argTypes[y];if(!se(g,m))throw Lx(y,at(m),at(g),{blockExport:Je(i.getInstruction(r[y]))})}return i.FunctionCall([l,...r])}else if(se(d.valueType,Re))return Wh(e.chunk,[l,...r],n,!0);if(r.length>=1)return f_(e,t,s,r);throw d.type===2?Dy(n):d.valueType===Lt?Vy(n):Fy(n)}let p=o.getVisibleGlobalDefinition(t);if(p===void 0||!p.isFunction){if((f=tt[t])!=null&&f.isFunction)throw t==="logbase"&&o.isGlobal("ln")&&o.isGlobal("log")?MP():Li(n,e.policy);if(p){let d=Fe(e,p);if(i.getInstruction(d).valueType===Lt)throw Vy(n);if(se(i.getInstruction(d).valueType,Re))return Wh(e.chunk,[d,...r],n,!0)}if(r.length>=1)return f_(e,t,s,r);throw p?Fy(n):new Error(`Programming Error: reached undefined symbol ${t}`)}if(Af(p)){if(r.length!==p._argSymbols.length)throw Ao(n,p._argSymbols.length,r.length,{includeUsageExample:!0});if(p.getDependencies().includes("globalRandomSeed")&&c.shouldIncludeFunctionParametersInRandomSeed()){let d=s_(e,p,r),y=r.filter((g,m)=>d[m]===2);if(y.length>0){let g=Jp(i,y);if(g===void 0)throw U("Programming error: expected list length to be defined");let m=i.BeginBroadcast([g]),h=[];for(let M=0;M<r.length;M++)d[M]===2?h.push(Ea(i,r[M],m)):h.push(r[M]);let x=Uh(e,p,h,s),T=i.EndBroadcast([m,x]),b=i.getInstruction(x).valueType;if(wn(b))return i.BroadcastResult(vn(b),[T])}}return Uh(e,p,r,s)}else{if(Fo.hasOwnProperty(t))return xU(e,t,n,r,s);if(Bn.hasOwnProperty(t))return pi(e,t,r);throw Li(n,e.policy)}}function Uh(e,t,n,r){let{scope:s}=e,i=s.newLexicalScope().childScope();for(let a=0;a<t._argSymbols.length;a++)i.addLexicalBinding(t._argSymbols[a],n[a],r&&r[a]);let o=Ci(e,i);return t.recursionInfo?P_(o,t,t.recursionInfo):Fe(o,t._expression)}function hU(e,t){let n=$o(e,t),r=e.Add([n,Ss(e,t)]);return e.NativeFunction("segment",[n,r])}function pi(e,t,n){let{chunk:r}=e,s=Bn[t],i=n.length,{minArity:o,maxArity:a}=s;if(i>a||i<o)throw U("Unexpected arity mismatch");let u=b_(r,n,s);switch(s.tag){case"default":case"reducer":case"doubleReducer":case"parameterizedReducer":case"color":case"never-broadcast":return r.NativeFunction(t,u);case"trig":{let c=Fe(e,new C.Identifier("trigAngleMultiplier")),l=r.Multiply([u[0],c]);return r.NativeFunction(t,[l])}case"trig2":{let c=Fe(e,new C.Identifier("trigAngleMultiplier")),l=r.Multiply([u[1],c]);return r.NativeFunction(t,[u[0],l])}case"inverseTrig":{let c=Fe(e,new C.Identifier("trigAngleMultiplier")),l=r.NativeFunction(t,u);return r.Divide([l,c])}default:{let c=s.tag;throw new Error(`Programming Error: unexpected tag ${c}`)}}}function b_(e,t,{minArity:n,defaultArguments:r}){if(!r||!(t.length-n<r.length))return t;let s=t.slice();for(;s.length-n<r.length;)s.push(e.copyInstruction(r[s.length-n]));return s}function bU(e,t,n){let r=[n.noBroadcast?kt(n.match):Ae(n.match)];return lh(r,t.map(s=>e.getInstruction(s).valueType),0).length>0}function Ui(e,t,n,r){let s=r.find(i=>bU(e,t,i));if(!s){if(typeof n=="string")throw Hs(n,Pa(e,t),{blockExport:e.areAllArgsConstant(t)});return n(e,t)}return s.build(e,t)}function c_(e,t){if(t.length!==2)throw U("Can only take the midpoint of two points");let n=e.Constant(Se(1,2));return e.Multiply([n,e.Add(t)])}function xU(e,t,n,r,s){var y,g;let{chunk:i,policy:o}=e,a=Fo[t],{minArity:u,maxArity:c}=a,l=r.length;if(l<u||l>c)throw kf(t)?L0(i,{symbol:t,errorSymbol:n,argsWithoutSeed:r,signatures:a.getSignatures(o),minArity:u,providedArgs:r,builtInTag:void 0,defaultArgumentCount:(g=(y=a.defaultArguments)==null?void 0:y.length)!=null?g:0,isDotCall:!1,maxArity:c}):new Error("Programming Error: unexpected arity mismatch");let p;if(t==="cdf")l===2?p=[r[0],i.Constant(-1/0),r[1]]:p=r;else if(t==="random")if(l===1||l<4&&!j(i.getInstruction(r[1]).valueType)&&i.getInstruction(r[1]).valueType!==Lt){let m=i.Distribution("uniformdist",[i.Constant(0),i.Constant(1)]);p=[r[0],m].concat(r.slice(1))}else p=r;else p=b_(i,r,a);let f=Rf(o,t);if(t==="join"){let m=[];for(let x of p)m.push(i.getInstruction(x).valueType);let h=qO(m);f=[kt({type:"variadic",initial:[h,h],rest:h})]}if(f){let m=F0(i,p,f);m.didCoerce&&(p=m.args)}function d(m,h=n){return Ui(i,p,h,m)}switch(t){case"length":if(o.isGeometryEnabled()||o.is3dPolicy()){let m=p[0];return d([{match:[wt],build:()=>{let h=i.Constant(0),x=i.Constant(1);return i.NativeFunction("distanceThreeD",[i.NativeFunction("segmentThreeDGlider",[m,h]),i.NativeFunction("segmentThreeDGlider",[m,x])])}},{match:[de],build:()=>{let h=i.Constant(0),x=i.Constant(1);return i.NativeFunction("distance",[i.NativeFunction("segmentGlider",[m,h]),i.NativeFunction("segmentGlider",[m,x])])}},{match:[ie],build:()=>{let h=i.NativeFunction("abs",[i.NativeFunction("arcOmega",[p[0]])]),{radius:x,startPoint:T}=CU(i,p[0]),b=i.NativeFunction("arcThirdPoint",[p[0]]);return i.Piecewise([i.Equal([h,i.Constant(0)]),i.NativeFunction("distance",[T,b]),i.Multiply([x,h])])}},{match:[xx],build:()=>jM(e,Ss(i,m))}])}else return i.NativeFunction("count",p);case"round":return d([{match:[Te],build:()=>i.NativeFunction("round",p)},{match:[Te,I],build:()=>{let m=i.NativeFunction("round",[p[1]]),h=i.RawExponent([i.Constant(10),m]);return i.Divide([i.NativeFunction("round",[i.Multiply([p[0],h])]),h])}},{match:[R],build:()=>i.NativeFunction("complexRound",p)},{match:[R,I],build:()=>{let m=i.NativeFunction("round",[p[1]]),h=i.RawExponent([i.Constant(10),m]);return i.Divide([i.NativeFunction("complexRound",[i.Multiply([p[0],h])]),h])}}]);case"abs":return d([{match:[Te],build:()=>i.NativeFunction(t,p)},{match:[R],build:()=>Yh(i,p[0])}]);case"real":return m_(i,p[0]);case"imag":return y_(i,p[0]);case"conj":return g_(i,p[0]);case"exp":case"sin":case"cos":case"tan":case"sinh":case"cosh":case"tanh":case"sec":case"csc":case"cot":case"sech":case"csch":case"coth":case"arccot":case"arcsinh":case"arccsch":case"floor":case"ceil":return d([{match:[Te],build:()=>pi(e,t,p)},{match:[R],build:()=>pi(e,Ip[t],p)}]);case"arctan":return d([{match:[Te],build:()=>pi(e,t,p.concat(i.Constant(1)))},{match:[I,I],build:()=>pi(e,t,p)},{match:[R],build:()=>pi(e,Ip[t],p)}]);case"mod":return d([{match:[Te,Te],build:()=>pi(e,t,p)},{match:[R,R],build:()=>pi(e,Ip[t],p)}]);case"nthroot":return i.Exponent([p[0],i.Divide([i.Constant(1),p[1]])]);case"complexNthRoot":return i.NativeFunction("complexPow",[p[0],i.Divide([i.Constant(1),p[1]])]);case"sign":return d([{match:[Te],build:()=>pi(e,t,p)},{match:[R],build:()=>{let m=p[0];return i.Piecewise([i.Equal([m,i.ZeroOfType(R)]),m,i.Divide([m,Yh(i,m)])])}}]);case"midpoint":return d([{match:[de],build:()=>{let m=i.Constant(Se(1,2));return i.NativeFunction("segmentGlider",[p[0],m])}},{match:[wt],build:()=>{let m=i.Constant(Se(1,2));return i.NativeFunction("segmentThreeDGlider",[p[0],m])}},{match:[N,N],build:c_},{match:[z,z],build:c_}]);case"circle":return d([{match:[N,de],build:()=>{let m=i.Constant(0),h=i.Constant(1);return i.NativeFunction("circle",[p[0],i.NativeFunction("distance",[i.NativeFunction("segmentGlider",[p[1],m]),i.NativeFunction("segmentGlider",[p[1],h])])])}},{match:[N,N],build:()=>i.NativeFunction("circle",[p[0],i.NativeFunction("distance",p)])},{match:[N,I],build:()=>i.NativeFunction("circle",p)}]);case"segment":return d(Xf("segment","segmentThreeD"));case"vector":return d(Xf("vector","vectorThreeD"));case"sphere":return d([{match:[z,I],build:(m,h)=>m.NativeFunction("sphere",h)},{match:[N,I],build:(m,h)=>m.NativeFunction("sphere",[m.TupleOfType(z,[m.Slot(0,[h[0]]),m.Slot(1,[h[0]]),m.Constant(0)]),h[1]])}]);case"distance":return d(Xf("distance","distanceThreeD"));case"center":return d([{match:[ce],build:()=>i.NativeFunction("center",[p[0]])},{match:[ie],build:()=>i.NativeFunction("arcCenter",[p[0]])}]);case"radius":return d([{match:[ce],build:()=>i.NativeFunction("radius",[p[0]])},{match:[ie],build:()=>i.NativeFunction("distance",[i.NativeFunction("arcFirstPoint",[p[0]]),i.NativeFunction("arcCenter",[p[0]])])}]);case"glider":return x_(e.chunk,p);case"intersection":case"strictintersection":{let m=0;t==="strictintersection"&&((gt(i,p[0],de)||gt(i,p[0],ie))&&(m+=3),(gt(i,p[1],de)||gt(i,p[1],ie))&&(m+=12),gt(i,p[0],Ne)&&(m+=1),gt(i,p[1],Ne)&&(m+=4));let h=SU(e,s,p),x=h&&Ta(h);if(!h||!x)return ZM(i,p,m);let T=Fe(e,new C.Identifier(x)),b=zo(h);return b!==void 0&&(T=i.ListAccess([T,i.Constant(b)])),i.NativeFunction("chooseNonIncidentPoint",[T,ZM(i,[p[0],p[1]],m),ZM(i,[p[1],p[0]],m<<2&12|m>>2&3)])}case"parallel":case"perpendicular":return d([{match:[Qm,N],build:()=>{let h=[Zh(i,p[0]),p[1]];return i.NativeFunction(t,h)}}]);case"anglebisector":return d([{match:[Le],build:()=>i.NativeFunction("anglebisector",p)},{match:[ye],build:()=>i.NativeFunction("directedanglebisector",p)}]);case"start":return $o(i,p[0]);case"end":return i.Add([$o(i,p[0]),Ss(i,p[0])]);case"translate":case"reflect":case"rotate":case"dilate":return DU(e,t,p);case"apply":return Wh(i,p,n,!1);case"normaldist":case"tdist":case"poissondist":case"binomialdist":case"uniformdist":return i.Distribution(t,p);case"median":case"quantile":return Xh(i,r)?lm(i,p,t):pi(e,t,r);case"stdev":return Xh(i,r)?lm(i,p,t):d([{match:_r(Te,1),build:()=>pi(e,t,r)},{match:_r(R,1),build:()=>i.NativeFunction("sqrt",[i_(i,p)])}]);case"stdevp":return d([{match:_r(Te,1),build:()=>pi(e,t,r)},{match:_r(R,1),build:()=>i.NativeFunction("sqrt",[cm(i,p)])}]);case"var":return i_(i,p);case"cov":return d([{match:[ro,ro],noBroadcast:!0,build:()=>pi(e,t,r)},{match:[Ue,Ue],noBroadcast:!0,build:()=>{let m=i.NativeFunction("listMin",[ur(i,p[0]),ur(i,p[1])]);return i.Divide([i.Multiply([XM(i,p),m]),i.Subtract([m,i.Constant(1)])])}}]);case"corr":return d([{match:[ro,ro],noBroadcast:!0,build:()=>pi(e,t,r)},{match:[Ue,Ue],noBroadcast:!0,build:()=>i.Divide([XM(i,p),i.NativeFunction("sqrt",[i.Multiply([cm(i,[p[0]]),cm(i,[p[1]])])])])}]);case"mad":return d([{match:_r(Te,1),build:()=>pi(e,t,r)},{match:_r(R,1),build:()=>{let m=Tl(i,p);return Tl(i,p.map(h=>Yh(i,i.Subtract([h,m]))))}}]);case"pdf":case"cdf":return lm(i,p,t);case"varp":return cm(i,p);case"covp":return XM(i,p);case"total":case"mean":return t==="mean"&&Xh(i,r)?lm(i,p,t):h_(i,p,t);case"lcm":case"gcd":return d([{match:_r(Te,1),build:()=>i.NativeFunction(t,p)},{match:_r(R,1),build:()=>{let m;switch(t){case"lcm":m="complexLCM";break;case"gcd":m="complexGCD";break}return i.NativeFunction(m,p)}}]);case"min":return d([{match:[I,I],build:()=>i.NativeFunction("min",p)},{match:_r(I,0),build:()=>i.NativeFunction("listMin",p)}]);case"max":return d([{match:[I,I],build:()=>i.NativeFunction("max",p)},{match:_r(I,0),build:()=>i.NativeFunction("listMax",p)}]);case"random":{let m=p[0],h=p[1],x=i.getInstruction(p[0]),T=i.getInstruction(h);if(x.valueType!==ft)throw U(`Unexpected value type for seed arg: ${x.valueType}`);if(T.valueType===Zn)throw YT();let b;if(j(T.valueType))b=t_;else{if(T.type!==42||T.valueType!==Lt)throw U(\'Expected distribution argument to "random"\');b=Sa[T.symbol][t]}if(p.length>2){let M=p[2],P=i.getInstruction(M);if(P.valueType!==I)throw U(`Expected numSamples argument to random() to be a number but got ${P.valueType}`);if(p.length===4){if(i.getInstruction(p[3]).valueType!==I)throw U(`Expected userSeed argument to random() to be a number but got ${P.valueType}`);m=i.ExtendSeed("us",[m,p[3]])}let D=i.Constant(1),S=i.NativeFunction("round",[i.NativeFunction("validateSampleCount",[M])]),O=i.BeginBroadcast([S]);m=i.ExtendSeed("lc",[m,i.Subtract([O,D])]);let _=b(i,h,[m]),L=i.EndBroadcast([O,_]);return i.BroadcastResult(vn(i.getInstruction(_).valueType),[L])}return b(i,h,[m])}case"shuffle":{let m=p[0],h=p[1],x=p[2];if(!j(i.getInstruction(h).valueType)||x!==void 0&&i.getInstruction(x).valueType!==I)throw U(`Unexpected args for "${t}"`);return x!==void 0&&(m=i.ExtendSeed("us",[m,x])),i.NativeFunction("shuffle",[m,h])}case"sort":return d([{match:[ne],noBroadcast:!0,build:()=>l_(e,p[0],p[0])},{match:[ii,ne],noBroadcast:!0,build:()=>l_(e,p[0],p[1])}]);case"join":{let m=[],h=!0;for(let w of p){let G=i.getInstruction(w);Je(G)||(h=!1);let k=G.valueType;if(k!==$e)if(j(k))m.push({isList:!0,index:w,elementType:Ve(k)});else if(wn(k))m.push({isList:!1,index:w,elementType:k});else throw Hs(n,Pa(i,r),{blockExport:i.areAllArgsConstant(p)})}if(m.length===0)return i.ConstantOfType($e,[]);for(let w of m)if(w.elementType!==m[0].elementType)throw Hs(n,Pa(i,r),{blockExport:i.areAllArgsConstant(p)});if(h){let w=[];for(let G of m){let k=i.getInstruction(Gr(i,G.index));gO(k),G.isList?w.push(...k.value):w.push(k.value)}return i.ConstantOfType(vn(m[0].elementType),w)}let x=i.Constant(0),T=i.Constant(1),b={};for(let w of m)w.isList&&b[w.index]===void 0&&(b[w.index]=ur(i,w.index));let M=i.NativeFunction("total",m.map(w=>w.isList?b[w.index]:T)),P=i.BeginBroadcast([M]),D=x,S=[],O=[];for(let w of m){let G=w.isList?i.ListAccess([w.index,i.Subtract([P,D])]):w.index;if(O.push(G),w!==m[m.length-1]){let k=w.isList?b[w.index]:T;D=i.Add([D,k]),S.push(i.LessEqual([P,D]))}}let _=O[O.length-1];for(let w=O.length-2;w>=0;w--)_=i.Piecewise([S[w],O[w],_]);let L=i.EndBroadcast([P,_]);return i.BroadcastResult(vn(m[0].elementType),[L])}case"unique":{let m=p[0],h=i.getInstruction(m);if(!j(h.valueType)||h.valueType===Zn)throw U(`Unexpected types for ${t}`);return i.NativeFunction("elementsAt",[m,i.NativeFunction("uniquePerm",[m])])}case"polygon":return d([{match:[],build:()=>{let m=i.ConstantOfType(Pt,[]);return i.NativeFunction("polygon",[m])}},{match:[I,I],noBroadcast:!0,build:()=>{throw Ud()}},{match:[I,I],build:()=>{let m=i.TupleOfType(N,p);return i.NativeFunction("polygon",[m])}},{match:{type:"variadic",initial:[],rest:N},build:()=>i.NativeFunction("polygon",p)}]);case"directedangle":return p_(e,p,n);case"angle":return i.NativeFunction("undirectedAngleMarker",[p_(e,p,n)]);case"angles":return i.NativeFunction("polygonInteriorUndirectedAngles",[p[0],Fe(e,new C.Identifier("trigAngleMultiplier"))]);case"directedangles":return i.NativeFunction("polygonInteriorDirectedAngles",[p[0],Fe(e,new C.Identifier("trigAngleMultiplier"))]);case"coterminal":{if(gt(i,p[0],ye))return i.NativeFunction("directedCoterminalAngle",p);if(gt(i,p[0],Le))return i.NativeFunction("undirectedCoterminalAngle",p);throw U(`Unexpected types for ${t}`)}case"histogram":case"dotplot":case"boxplot":case"ttest":case"ittest":case"stats":case"det":case"inv":case"transpose":case"rref":case"trace":case"points":case"lines":case"circles":case"polygons":case"rays":case"arcs":case"vectors":throw ks(n);default:{let m=t;throw new Error(`Programming Error: unexpected compiler function ${m}`)}}}function x_(e,t){return Ui(e,t,"glider",[{match:[de,I],build:()=>e.NativeFunction("segmentGlider",t)},{match:[fe,I],build:()=>e.NativeFunction("lineGlider",t)},{match:[Ne,I],build:()=>e.NativeFunction("rayGlider",t)},{match:[ce,I],build:()=>e.NativeFunction("circleGlider",t)},{match:[ie,I],build:()=>e.NativeFunction("arcGlider",t)},{match:[xe,I],build:()=>e.NativeFunction("polygonGlider",t)}])}function l_(e,t,n){let{chunk:r}=e;if(qn(r,n)===0)return n;let i=r.NativeFunction("listMin",[ur(r,t),ur(r,n)]);return n=r.ListAccess([n,QM(e,r.List([r.Constant(1)]),r.List([i]),{stepMustBePositive:!0})]),r.NativeFunction("elementsAt",[t,TU(e,[n])])}function TU(e,t){let{chunk:n}=e,r="sortPerm";return Ui(n,t,"sort",[{match:[ro],build:()=>n.NativeFunction(r,t),noBroadcast:!0},{match:[Ue],build:()=>n.NativeFunction(Ip[r],t),noBroadcast:!0}])}function lm(e,t,n){let r=t[0],s=e.getInstruction(r);if(!se(s.valueType,Lt))throw U(`Unexpected args for "${n}"`);let i=t.slice(1);for(let o of i)if(!se(e.getInstruction(o).valueType,I))throw U(`Unexpected args for "${n}"`);if(j(s.valueType)){let o=[],a=1/0;for(let c of t){let l=Gr(e,c);o.push(l);let p=e.getInstruction(l);if(j(p.valueType)){let f=qn(e,l);if(f===void 0)throw sf(fs(e,l));a=Math.min(a,f)}}let u=[];for(let c=0;c<a;c++){let l=zf(e,o[0],c),p=e.getInstruction(l);if(p.type!==42)throw U(`Unexpected opcode for distribution arg: ${p.type}`);let f=[];for(let d of o.slice(1))j(e.getInstruction(d).valueType)?f.push(zf(e,d,c)):f.push(d);u.push(Sa[p.symbol][n](e,l,f))}return e.List(u)}else{if(s.type!==42)throw U(`Unexpected opcode for distribution arg: ${s.type}`);return Sa[s.symbol][n](e,r,i)}}function Xh(e,t){return t.length!==0&&e.getInstruction(t[0]).valueType!==$e&&se(e.getInstruction(t[0]).valueType,Lt)}function IU(e,t){ms(t.args);let n=Ju(e,t,t.args);return T_(e,n)}function T_(e,t){let{chunk:n}=e,r=!1,s=!1;for(let i=0;i<t.length;i++){let a=n.getInstruction(t[i]).valueType;r=r||a===ut,s=s||a!==ut}if(r&&s)throw U("Unexpected mix of actions and non-actions");if(r)return I_(e,t);if(t.length===2)return n.TupleOfType(N,t);if(t.length==3)return n.TupleOfType(z,t);throw U(`Unexpected tuple dimensions: ${t.length}`)}function PU(e,t){let{chunk:n}=e;ms(t.args);let r=Ju(e,t,t.args);if(r.length<1)throw U("Empty bare sequence");let s=n.getInstruction(r[0]).valueType;if(s===I)throw U("Ambiguous bare sequence");return s===ut?I_(e,r):n.List(r)}function I_(e,t){let{chunk:n}=e,r=[],s=[];for(let i of t){let o=n.getInstruction(i);switch(o.type){case 49:{Array.prototype.push.apply(r,o.symbols),Array.prototype.push.apply(s,o.args);break}case 1:{let u=o.value.updateRules;for(let c of We(u)){let l=u[c];r.push(c),s.push(n.ConstantOfType(l.valueType,l.value))}break}default:{let a=fs(n,i);throw a.length>0?OT(a):U(`Unexpected opcode for action: ${o.type}`)}}}return n.Action(r,s)}function JM(e,t){let{scope:n,policy:r}=e;if(n.isLocal(t))return my(t);let s=n.getVisibleGlobalDefinition(t);return r.assignmentForbidden(t)?ST(t):s&&s.type==="FunctionDefinition"?vT(t):DT(t).allowExport()}function EU(e,t){switch(e.getInstruction(t).valueType){case de:case ce:case ie:return[e.Constant(0),e.Constant(1)];case fe:return[e.Constant(-1/0),e.Constant(1/0)];case Ne:return[e.Constant(0),e.Constant(1/0)];case xe:return[e.Constant(0),e.NativeFunction("count",[e.NativeFunction("vertices",[t])])];default:return}}function MU(e,t){let{policy:n,chunk:r,scope:s,selection:i}=e;if(!(t instanceof Ja))throw new Error("Programming error: expected a ListComprehension node but got "+t.type);let o=t._body,a=[],u=[],c=r.Constant(1),l=s.childScope();ms(t._inputLists);for(let{_symbol:x}of t._inputLists){let T=x;l.setErrorIfAccessed(T,OP(T))}for(let x of t.parameters){let T=x.identifier._symbol;l.setErrorIfAccessed(T,NP(T))}let p=Ci(e,l);for(let x=t._inputLists.length-1;x>=0;x--){let T=t._inputLists[x],b=T._symbol,M=Fe(p,T.args[1]);r_(r,i,T);let P=r.getInstruction(M);if(!j(P.valueType)){let S=EU(r,M);if(S){a.push({symbol:b,object:M,gliderBounds:S});continue}let O;if(wn(P.valueType)){let _=T.args[1].getInputSpan();_&&(O=Yn(_))}throw SP(b,oe(P.valueType),O,{blockExport:Je(P)})}let D=ur(r,M);u.push({symbol:b,assignedList:M,lengthIndex:D}),c=r.Multiply([c,D])}let f=s.childScope(),d=[],y;if(u.length>0){let x=r.Constant(1);y=r.BeginBroadcast([c],{type:"list-comprehension",callData:{inputListSymbols:u.map(b=>b.symbol)}}),f.addLexicalBinding(t._index._symbol,y);let T=x;for(let b=u.length-1;b>=0;b--){let{symbol:M,assignedList:P,lengthIndex:D}=u[b],S;if(u.length===1)S=y;else{let O=r.NativeFunction("floor",[r.Divide([r.Subtract([y,x]),T])]);S=r.Add([r.NativeFunction("mod",[O,D]),x]),b>0&&(T=r.Multiply([T,D]))}f.addDynamicBinding(M,r.ListAccess([P,S])),d.push(M)}}let g;if(t.parameters.length>0||a.length>0){let x=[],T=[];for(let b of t.parameters)x.push(b.identifier._symbol),T.push(Fe(p,b.bounds[0]),Fe(p,b.bounds[1]));for(let b of a)x.push(b.symbol),T.push(b.gliderBounds[0],b.gliderBounds[1]);g=r.BeginMap({parameterSymbols:x},T);for(let b=0;b<t.parameters.length+a.length;b++)r.BlockVar(I,[g]);for(let b=0;b<t.parameters.length;b++){let M=t.parameters[b].identifier._symbol,D=g+b+1;f.addDynamicBinding(M,D),d.push(M)}for(let b=0;b<a.length;b++){let M=a[b].symbol,P=g+t.parameters.length+b+1;f.addDynamicBinding(M,x_(r,[a[b].object,P])),d.push(M)}}let h=Fe({...Ci(e,f),substitutionContext:e.substitutionContext.for(s,e.recursiveFunctionContext,d)},o);if(g!==void 0){let x=r.EndMap([g,h]),T=r.getInstruction(h).valueType;if(ua(T))throw zP();if(!Ix(T))throw kP(T);let b=n.is3dPolicy()?2:1;if(t.parameters.length+a.length>b)throw HP(T,t.parameters.length);let M=Px(T,t.parameters.length+a.length);h=r.BlockVar(M,[x])}if(y!==void 0){let x=r.getInstruction(h);if(!wn(x.valueType))throw vc([oe(x.valueType)],{blockExport:Je(x)});let T=r.EndBroadcast([y,h]);h=r.BroadcastResult(vn(x.valueType),[T])}else t.shouldCoerceToList&&(h=r.List([h]));return h}function QM(e,t,n,r){let{stepMustBePositive:s}=r,{chunk:i}=e;t=zi(i,t),n=zi(i,n);let o=i.getInstruction(t),a=i.getInstruction(n),u=qo(i,t,"Programming error: expected range start list to have constant length."),c=qo(i,n,"Programming error: expected range start list to have constant length.");if(o.valueType!==ne||a.valueType!==ne)throw Jd();let l=i.Constant(1),p=i.Constant(0),f=i.ListAccess([t,l]),d=i.ListAccess([t,i.Constant(2)]),y=i.ListAccess([n,i.Constant(c)]),g=i.Subtract([y,f]),m=u>1?i.Subtract([d,f]):i.Piecewise([i.GreaterEqual([g,p]),l,i.Constant(-1)]),h=i.Add([l,i.NativeFunction("round",[i.Divide([g,m])])]),x=i.NativeFunction("validateRangeLength",[t,n,m,h]);s&&(x=i.Piecewise([i.GreaterEqual([m,p]),x,p]));let T=i.BeginBroadcast([x]),b=i.Add([f,i.Multiply([m,i.Subtract([T,l])])]),M=i.EndBroadcast([T,b]);return i.addComments({[f]:"start",[d]:"second",[y]:"last",[h]:"proposedLength",[m]:"step",[b]:"body"}),i.BroadcastResult(vn(i.getInstruction(b).valueType),[M])}function Zh(e,t){return gt(e,t,de)?e.NativeFunction("lineFromSegment",[t]):gt(e,t,le)?e.NativeFunction("lineFromSegment",[hU(e,t)]):gt(e,t,Ne)?e.NativeFunction("lineFromRay",[t]):t}function CU(e,t){let n=e.NativeFunction("arcCenter",[t]),r=e.NativeFunction("arcFirstPoint",[t]),s=e.NativeFunction("distance",[n,r]);return{center:n,radius:s,startPoint:r}}function p_(e,t,n){let{chunk:r}=e;if(t.length===3&&gt(r,t[0],N)&&gt(r,t[1],N)&&gt(r,t[2],N)){let s=t[0],i=t[1],o=t[2],a=r.Subtract([s,i]),u=r.Subtract([o,i]),c=r.Slot(0,[a]),l=r.Slot(1,[a]),p=r.Slot(0,[u]),f=r.Slot(1,[u]),d=r.NativeFunction("arctan",[l,c]),y=r.Subtract([r.Multiply([c,f]),r.Multiply([l,p])]),g=r.Add([r.Multiply([c,p]),r.Multiply([l,f])]),m=r.NativeFunction("arctan",[y,g]),h=r.NativeFunction("abs",[m]),x=r.Constant(Math.PI),T=r.Constant(Math.PI*2);m=r.Piecewise([r.Equal([h,x]),x,r.Piecewise([r.Less([h,x]),m,r.Multiply([r.Multiply([r.NativeFunction("sign",[m]),r.Constant(-1)]),r.Subtract([T,h])])])]);let b=r.NativeFunction("directedAngleMarker",[i,d,m,Fe(e,new C.Identifier("trigAngleMultiplier"))]),M=r.Constant(0),P=r.And([r.Equal([y,M]),r.Equal([g,M])]);return r.Piecewise([P,r.NanOfType(ye),b])}else throw U(`Unexpected types for ${n}`)}function aN(e,t){return e.Divide([e.NativeFunction("directedAngleMarkerRawDelta",[t]),e.NativeFunction("directedAngleMarkerMultiplier",[t])])}function uN(e,t){return e.NativeFunction("abs",[e.Divide([e.NativeFunction("undirectedAngleMarkerRawDelta",[t]),e.NativeFunction("undirectedAngleMarkerMultiplier",[t])])])}function DU(e,t,n){let{chunk:r,policy:s}=e,i=n.slice(1),o=Rf(s,t);if(!o)throw new Error(`Unexpected transformation type: ${t}`);let a=o.map(p=>{let f=0;for(let d=1;d<n.length;d++){let y=r.getInstruction(n[d]).valueType,g=p.argTypeAtIndex(d);g&&Mc(y,g)&&f++}return{signature:p,matchedArgsCount:f,signatureArgsCount:p.maxArity===void 0?p.initial.length+1:p.argTypes.length-1,providedArgsCount:n.length-1}}).sort((p,f)=>f.matchedArgsCount!==p.matchedArgsCount?f.matchedArgsCount-p.matchedArgsCount:p.signatureArgsCount-f.signatureArgsCount),u;switch(t){case"translate":{u=[{match:[le],build:()=>r.NativeFunction("translation",[r.NativeFunction("vectorDisplacementAsPoint",i)])},{match:[N,N],build:()=>r.NativeFunction("translation",[r.Subtract([i[1],i[0]])])}];break}case"reflect":{u=[{match:[Qm],build:()=>{let p=Zh(r,i[0]);return r.NativeFunction("reflection",[p])}}];break}case"rotate":{u=[{match:[N,I],build:()=>{let p=Fe(e,new C.Identifier("trigAngleMultiplier"));return r.NativeFunction("rotation",[i[0],r.Multiply([i[1],p])])}}];break}case"dilate":{u=[{match:[N,I],build:()=>r.NativeFunction("dilation",i)}];break}default:{let p=t;throw new Error(`Programming error: exhaustive check failed: ${p}`)}}let c=r.areAllArgsConstant(i),l=Ui(r,i,()=>{throw Jx(t,Pa(r,i),a[0].signature,{blockExport:c})},u);return Wh(r,[l,n[0]],t,!0)}function Wh(e,t,n,r){let s=[[Re,"compose"],[N,"transformPoint"],[de,"transformSegment"],[fe,"transformLine"],[Ne,"transformRay"],[le,"transformVector"],[ce,"transformCircle"],[ie,"transformArc"],[xe,"transformPolygon"],[Le,"transformAngleMarker"],[ye,"transformDirectedAngleMarker"]].map(([o,a])=>({match:[Re,o],build:(u,c)=>u.NativeFunction(a,c)}));function i(){if(r){let o=t.slice(1);throw Qx(n,zu(e,o),{blockExport:e.areAllArgsConstant(o)})}else throw Hs(n,zu(e,t),{blockExport:e.areAllArgsConstant(t)})}return Ui(e,t,i,s)}function ZM(e,t,n){let r=Zh(e,t[0]),s=Zh(e,t[1]),i=[r,s,e.ConstantOfType(I,n)];if(gt(e,r,ce)){if(gt(e,s,ce))return e.NativeFunction("circleCircleIntersection",i);if(gt(e,s,ie))return e.NativeFunction("circleArcIntersection",i);if(gt(e,s,fe))return e.NativeFunction("circleLineIntersection",i)}if(gt(e,r,ie)){if(gt(e,s,ce))return e.NativeFunction("arcCircleIntersection",i);if(gt(e,s,ie))return e.NativeFunction("arcArcIntersection",i);if(gt(e,s,fe))return e.NativeFunction("arcLineIntersection",i)}if(gt(e,r,fe)){if(gt(e,s,ce))return e.NativeFunction("lineCircleIntersection",i);if(gt(e,s,ie))return e.NativeFunction("lineArcIntersection",i);if(gt(e,s,fe))return e.NativeFunction("lineLineIntersection",i)}throw U("Invalid intersection types")}function SU(e,[t,n],[r,s]){let{chunk:i,scope:o}=e,a=i.getInstruction(r).valueType,u=i.getInstruction(s).valueType,c=f=>{var d;return(d=o.getParseNode(f))!=null?d:o.getVisibleGlobalDefinition(f)},l=ki(t)?c(t._symbol):t,p=ki(n)?c(n._symbol):n;if(!(!l||!p))return UO({getGeometryTree:f=>ah(f).tree,lookup:c,isPointOrListOfPoints:f=>{if(f.isFunction)return!1;let d=Fe(e,f);return se(i.getInstruction(d).valueType,N)},resolvesTo:(f,d)=>o.getVisibleGlobalDefinition(f)===d},l,a,p,u)}function vU(e,t){let{policy:n,scope:r}=e,s=t._body,i=r.childScope(),o=[];for(let u=0;u<t._assignments.length;u++){let c=t._assignments[u]._lhs,l;if(c instanceof we)l=c._symbol;else throw of();let p=t._assignments[u].args[1],f=r.getVisibleGlobalDefinition(l);if(f){if(f.type==="FunctionDefinition")throw uf(l);if(n.assignmentForbidden(l))throw af(l)}let d=Fe(e,p);i.addDynamicBinding(l,d,p),o.push(l)}return Fe({...Ci(e,i),substitutionContext:e.substitutionContext.with(r,e.recursiveFunctionContext,o)},s)}var d_={points:Pt,lines:jn,segments:xn,polygons:In,circles:Wn,arcs:Fn,angles:On,directedangles:Nn,rays:Vn,vectors:Jn};function OU(e,t){let{chunk:n,scope:r}=e,s=r.getVisibleGlobalDefinition("construction");if(!s)throw U("Expected \'construction\' to be defined in the frame");if(s.type!=="Construction"||!(s instanceof Q))throw U(`Expected construction node but found ${s.type}}`);if(!ki(t))throw U(`Expected identifier but found ${t.type}`);let i=t._symbol;if(!(i in d_))throw ks("construction");let o=d_[i];if(s.args.length===0)return n.ConstantOfType(o,[]);let a=Ve(o),u=[];for(let c of s.args)try{let l=Fe(e,c);n.getInstruction(l).valueType===a&&u.push(l)}catch(l){if(l instanceof C.Base)continue;throw l}return n.List(u)}function pm(e,t){let n=e.args,r=e instanceof gn?e._symbol:e instanceof Fu||e instanceof wu?e.args[0]._symbol:void 0;if(r&&t.definitions[r])return!1;if(e instanceof Fr){let a=[pm(e.args[0],t)||new Et(!0)],u=pm(e.args[1],t),c=pm(e.args[2],t);return u&&a.push(u),c&&a.push(c),a.length===1?!1:(a.length===2&&a.push(a[1]),new Fr(a))}let s=[],i=!1;for(let o of n){let a=pm(o,t);if(a===!1){i=!0;continue}s.push(a)}return i?!1:e.copyWithArgs(s)}function P_(e,t,n){let{chunk:r,scope:s}=e,i={},o=We(n.definitions);for(let y of o){let g=n.definitions[y];if(g instanceof v)throw g;i[y]=g}let a=t._argSymbols.map(y=>Fe(e,new we(y))),u=new WM(i,n.baseCases);try{M_(e,u,t,a)}catch(y){throw u.isUnconditionallyRecursive&&y instanceof v&&!y.blocksExport?o.length>1||E_(t,t._expression)?Rc(o,{suggestAlternativeFunctionName:!1}):oy(o):y}let c={},l={},p={},f=s.childScope();for(let y of o){let g=u.returnTypes[y];if(g===void 0)throw U(`Could not infer the return type for recursive function ${y}.`);let m=u.argTypes[y];if(m===void 0)throw U(`Could not infer the argument types for recursive function ${y}.`);l[y]={argTypes:m},c[y]=g,p[y]=r.FunctionHeader(y,g,l[y],i[y]._argSymbols),f.addLexicalBinding(y,p[y])}let d=[];for(let y of o)d.push(p[y]);for(let y of d)r.getInstruction(y).recursionGroup=d;for(let y of o){let g=f.childScope(),m=i[y],h=p[y],x=r.BeginFunction([h]);for(let M=0;M<m._argSymbols.length;M++){let P=m._argSymbols[M],D=r.BlockVar(l[y].argTypes[M],[x]);g.addLexicalBinding(P,D)}let T={...Ci(e,g),recursiveFunctionContext:{type:"compile-general",fnSymbols:o}},b=C_(T,m,n.baseCases,Fe(T,m._expression));if(r.getInstruction(b).valueType!==c[y])throw Hs(y,Pa(r,a),{blockExport:r.areAllArgsConstant(a)});b=Gr(r,b),r.EndFunction([x,b])}if(u.isUnconditionallyRecursive){let y=r.getRecursiveFunctionMetadata(p[t._symbol]),g=y==null?void 0:y.recursiveStructure;throw g!=null&&g.canIterate?new Error("Programming error: expected canIterate==false for unconditionally recursive function."):g!=null&&g.maxRecursiveCallOffsets&&o.every(m=>g.maxRecursiveCallOffsets[m]===0)?Rc(o,{suggestAlternativeFunctionName:!1}):Sx(o,{type:"missing-non-recursive-branch",recursionGroup:o,recursiveStructure:g})}return r.FunctionCall([p[t._symbol],...a])}function E_(e,t){return t instanceof gn&&t._symbol===e._symbol?t.args.every((n,r)=>n instanceof we&&n._symbol===e._argSymbols[r]):t.args.every(n=>E_(e,n))}function M_(e,t,n,r){let{chunk:s}=e,i=t.returnTypes[n._symbol],o=t.argTypes[n._symbol];if(i!==void 0&&o!==void 0)return{returnType:i,argTypes:o};let a=n._argSymbols.length,u=r.length;if(a!==u)throw Ao(n._symbol,a,u,{includeUsageExample:!0});let c=r.map(d=>s.getInstruction(d).valueType),l=`${n._symbol}:${c.join(",")}:${Object.keys(t.returnTypes).join(",")}`;if(t.stack.includes(l))return t.isUnconditionallyRecursive=!0,{returnType:I,argTypes:c};t.stack.push(l);let p=s.getReturnIndex(),f;return zh(e,d=>{var M;let y=pm(n._expression,t),g=n._symbol,m=(M=t.baseCases[g])!=null?M:[],h={...d,recursiveFunctionContext:t},x=h.scope,T=[];for(let P=0;P<n._argSymbols.length;P++){let D=n._argSymbols[P],S=s.SymbolicVar(c[P]);T.push(S),x.addLexicalBinding(D,S)}if(!t.baseCaseTypes.hasOwnProperty(g)){let P,D,S,O=!0;for(let _ of m){let L=_.getRef();if(!_.specifiedArg.valid||!L)continue;let w=new we(L),G=Fe(h,w);S||(S=w);let k=s.getInstruction(G),Z=k.valueType;if(Je(k)||(O=!1),P===void 0)P=_.specifiedArg.argIndex;else if(P!==_.specifiedArg.argIndex)throw wd();let F=D;if(F===void 0)D=Z;else{let Y=Ha(F,Z);if(Y===void 0)throw Ld({blockExport:O});D=Y}}t.baseCaseTypes[g]=D,t.firstValidBaseCaseIdentifiers[g]=S}let b=t.firstValidBaseCaseIdentifiers[g];if(y||b){let P=C_(h,n,t.baseCases,Fe(h,y||b)),{someArgBroadcasts:D,inferredArgTypes:S}=NU(s,T,p,P);if(c=S,f=s.getInstruction(P).valueType,D){if(!j(f))throw U(`TODO: expected a list type but found ${at(f)}`);f=Ve(f)}let O=t.returnTypes[n._symbol];if(O!==void 0&&f!==O)throw Ld({blockExport:!1});t.argTypes[n._symbol]=S,t.returnTypes[n._symbol]=f}}),zh(e,d=>{let y={...d,recursiveFunctionContext:t},g=y.scope;for(let T=0;T<n._argSymbols.length;T++){let b=n._argSymbols[T],M=s.SymbolicVar(c[T]);g.addLexicalBinding(b,M)}let m=Fe(y,n._expression);t.stack.pop();let h=s.getInstruction(m).valueType,x=f===void 0?h:Ha(f,h);if(x===void 0)throw U(`Mismatched return types: ${f&&at(f)} vs ${at(h)}`);return t.returnTypes[n._symbol]=x,{returnType:x,argTypes:c}})}function NU(e,t,n,r){let s=[],u=[];for(let p=0;p<r-n;p++)u.push(0);if(e.getInstruction(r).type===48){u.push(1);for(let p=r;p>=0;p--){let f=u[p-n];if(f===0)continue;let d=e.getInstruction(p);if(!ge(d)){if(d.type===24?s.push(p):d.type===23&&s.pop(),(d.type===48||d.type===24)&&(u[d.args[0]-n]|=f),d.type===39||d.type===41||d.type===40)for(let y of s){let m=e.getInstruction(y).args[0];if(d.args[1]===m){u[d.args[0]-n]|=f;break}}if(s.length>0){let y=s[s.length-1],m=e.getInstruction(y).args[0];for(let h of d.args)h>=m&&(u[h-n]|=f);d.type===33&&d.args[0]>=m&&(u[d.args[0]-n]|=2)}}}}let c=[],l=!1;for(let p=0;p<t.length;p++){let f=t[p],d=e.getInstruction(f).valueType;if(u[f-n]&2){if(!j(d))throw U(`Expected list type but found ${at(d)}`);l=!0,c.push(Ve(d))}else c.push(d)}return{inferredArgTypes:c,someArgBroadcasts:l}}function C_(e,t,n,r){let{chunk:s}=e,i=!0,o=n[t._symbol];for(let a of o){let u=a.specifiedArg;if(!u.valid)continue;let c=t._argSymbols[u.argIndex],l=Fe(e,new we(c)),p=s.Equal([l,s.Constant(u.argValue)]),f=Fe(e,a),d=s.getInstruction(f);Je(d)||(i=!1);let y=s.getInstruction(f).valueType,g=s.getInstruction(r).valueType;if(Ha(y,g)===void 0)throw Ld({blockExport:i});r=s.Piecewise([p,f,r])}return r}function RU(e){return e.type==="Constant"&&Number.isInteger(e.asValue())}function f_(e,t,n,r){var f;let{policy:s,chunk:i,scope:o}=e,a=new C.Identifier(t),u,c;r.length===1?(u=n[0],c=r[0]):(u=new C.ParenSeq(n),Uo(i,s,u,r),c=T_(e,r));let p=[(f=o.getSymbol(t))!=null?f:Fe(e,a),c];return Uo(i,s,new C.Multiply([a,u]),p),i.Multiply(p)}Yt.prototype.buildIRExpression=function(e,t,n){var s;let r=od({policy:e,frame:t,wrapInList:n&&n.wrapInList,coerceToNumber:n&&n.coerceToNumber},this);return e.isGeometryEnabled()&&r.argNames.some(i=>i[0]==="$")?GP():(s=r.getError())!=null?s:new on(r)};v.prototype.buildIRExpression=function(e,t,n){return this};var D_=Od;function KM(e){let t=[];for(let n=0;n<e.length;n++)t.push(oe(e[n].valueType));return t}var Di=!0;function S_(e,t){let n=t.length,r=t[0];if(n<2)throw so(this._symbol,{blockExport:Di});if(!D_(r.valueType,[ne,$e]))throw so(this._symbol,{blockExport:Di});if(n>2)throw by(this._symbol,2)}C.Histogram.prototype.typeCheck=S_;C.DotPlot.prototype.typeCheck=S_;C.BoxPlot.prototype.typeCheck=function(e,t){let n=t.length,r=t[0];if(n===0)throw so(this._symbol,{blockExport:Di});if(!D_(r.valueType,[ne,$e]))throw so(this._symbol,{blockExport:Di});if(n>1)throw so(this._symbol,{blockExport:Di})};C.TTest.prototype.typeCheck=function(e,t){let n=this._symbol;if(t.length===0)throw so(n,{blockExport:Di});if(t[0].valueType===$e)throw jl(n);if(t[0].valueType!==ne)throw so(n,{blockExport:Di});if(t.length>2)throw by(n,2);if(t[0].length<2)throw jl(n);if(t[1]&&t[1].valueType!==I)throw Hs(n,KM(t),{blockExport:Di})};C.IndependentTTest.prototype.typeCheck=function(e,t){let n=this._symbol;if(t.length!==2)throw qd(n);if(!j(t[0].valueType)||!j(t[1].valueType))throw jd(n,{blockExport:Di});if(t[0].valueType===$e||t[1].valueType===$e)throw jl("ittest");if(t[0].valueType!==ne||t[1].valueType!==ne)throw Hs(n,KM(t),{blockExport:Di});if(t[0].length<2||t[1].length<2)throw jl("ittest")},C.Stats.prototype.typeCheck=function(e,t){let n=t.length,r=t[0];if(n===0)throw so(this._symbol,{blockExport:Di});if(r.valueType===$e)throw Hs(this._symbol,KM(t),{blockExport:Di});if(r.valueType!==ne)throw so(this._symbol,{blockExport:Di});if(n>1)throw so(this._symbol,{blockExport:Di})};var iu=function(e,t,n){n=n||0;let r=Array(n+1).join("  "),s=r+"  ";return`[\n`+s+e.map(i=>i.repr(t,n+1)).join(`,\n`+s)+`\n`+r+"]"},Tr=function(e,t){return t=t||"",""+t+e};C.Expression.prototype.repr=function(e,t){return Tr(this.type,e)+"("+iu(this.args,e,t)+")"};C.IRExpression.prototype.repr=function(e,t){t=t||0;let n=Array(t+1).join("  "),r=n+"  ",s=this._chunk.print().split(`\n`);return s.pop(),Tr(this.type,e)+"(`\\n"+r+s.join(`\n`+r)+`\n`+n+"`)"};C.DoubleInequality.prototype.repr=function(e,t){t=t||0;let n=Array(t+1).join("  "),r=n+"  ";return Tr(this.type,e)+`([\n`+r+this.args[0].repr(e,t+1)+`,\n`+r+"\'"+this.args[1]+`\',\n`+r+this.args[2].repr(e,t+1)+`,\n`+r+"\'"+this.args[3]+`\',\n`+r+this.args[4].repr(e,t+1)+`\n`+n+"])"};C.ComparatorChain.prototype.repr=function(e,t){return t=t||0,Tr(this.type,e)+"(["+this.symbols.map(n=>`\'${n}\'`).join(",")+`],\n`+iu(this.args,e,t)+")"};C.Identifier.prototype.repr=function(e){return Tr(this.type,e)+"(\'"+this._symbol+"\')"};C.Constant.prototype.repr=function(e){return Tr(this.type,e)+"("+this.asValue()+")"};C.ExtendSeed.prototype.repr=function(e,t){return Tr(this.type,e)+"(\'"+this.tag+"\', "+iu(this.args,e,t)+")"};C.Seed.prototype.repr=function(e){return Tr(this.type,e)+"("+this.asValue()+")"};C.FunctionCall.prototype.repr=function(e,t){return Tr(this.type,e)+"(\'"+this._symbol+"\', "+iu(this.args,e,t)+")"};C.RecursiveFunctionBaseCase.prototype.repr=function(e,t){return this.originalNode.repr(e,t)};C.Assignment.prototype.repr=function(e,t){return Tr(this.type,e)+"("+new C.Identifier(this._symbol).repr(e,t)+", "+this._expression.repr(e,t)+")"};C.Regression.prototype.repr=C.Equation.prototype.repr=C.CallAssignment.prototype.repr=function(e,t){return Tr(this.type,e)+"("+this._lhs.repr(e,t)+", "+this._rhs.repr(e,t)+")"};C.FunctionDefinition.prototype.repr=function(e,t){return Tr(this.type,e)+"("+new C.Identifier(this._symbol).repr(e,t)+", "+iu(this._argSymbols.map(n=>new C.Identifier(n)),e,t)+", "+this._expression.repr(e,t)+")"};C.Error.prototype.repr=function(e,t){return Tr(this.type,e)+"(\'"+this._msg+"\')"};C.Derivative.prototype.repr=function(e,t){return Tr(this.type,e)+"(\'"+this._symbol+"\', "+iu(this.args,e,t)+")"};C.SolvedEquation.prototype.repr=function(e,t){return Tr(this.type,e)+"(\'"+this._symbol+"\', "+this._expression.repr(e,t)+")"};C.OptimizedRegression.prototype.repr=function(e,t){return Tr(this.type,e)+"("+JSON.stringify(this.parameters)+", "+JSON.stringify(this.residuals)+", "+JSON.stringify(this.statistics)+", "+this.model.repr(e,t+1)+", "+JSON.stringify({isModelValid:this.isModelValid,residualVariable:this.residualVariable,residualSuggestionId:this.residualSuggestionId,shouldSuggestLogMode:this.shouldSuggestLogMode,isLinear:this.isLinear,parameterWarning:this.parameterWarning})+")"};C.Table.prototype.repr=function(e,t){return Tr(this.type,e)+"("+iu(this.columns,e,t)+", "+this.localFrameID+")"};C.TableColumn.prototype.repr=function(e,t){return Tr(this.type,e)+"("+this.header.repr(e,t)+", "+this.length+", "+iu(this.values,e,t)+", "+this.localFrameID+", "+this.columnIndex+")"};C.TableColumnValue.prototype.repr=function(e,t){return"TableColumnValue("+iu(this.rawArgs,e,t)+", "+this.headerSymbol+")"};C.Image.prototype.repr=function(e,t){let n=Array(t+1).join("  "),r=n+"  ";return Tr(this.type,e)+`({\n`+r+"center: "+this.center.repr(e,t+1)+`,\n`+r+"radianAngle: "+this.radianAngle.repr(e,t+1)+`,\n`+r+"width: "+this.width.repr(e,t+1)+`,\n`+r+"height: "+this.height.repr(e,t+1)+`},\n`+r+"opacity: "+this.opacity.repr(e,t+1)+`,\n`+r+JSON.stringify(this.moveStrategy)+`\n`+n+"})"};C.Ticker.prototype.repr=function(e,t){let n=Array(t+1).join("  "),r=n+"  ";return Tr(this.type,e)+`({\n`+r+"handler: "+this.handler.repr(e,t+1)+`,\n`+r+"minStep: "+this.minStep.repr(e,t+1)+`\n`+n+"})"};C.Slider.prototype.repr=function(e,t){let n=Array(t+1).join("  "),r=n+"  ";return Tr(this.type,e)+`({\n`+r+"sliderAssignment: "+this.sliderAssignment.repr(e,t+1)+`,\n`+r+"sliderMin: "+(this.sliderMin&&this.sliderMin.repr(e,t+1))+`,\n`+r+"sliderMax: "+(this.sliderMax&&this.sliderMax.repr(e,t+1))+`,\n`+r+"sliderStep: "+(this.sliderStep&&this.sliderStep.repr(e,t+1))+`},\n`+n+")"};C.ImaginaryUnit.prototype.repr=function(e){return Tr(this.type,e)+"()"};var Jh=function(e,t){return e.map(n=>n.substitute(t))};C.Identifier.prototype.substitute=function(e){return e[this._symbol]?e[this._symbol]:this};C.FunctionCall.prototype.substitute=function(e){let t=e[this._symbol];if(t){if(t.type==="Identifier")return new C.FunctionCall(t,Jh(this.args,e));if(t.type==="Constant")return new C.Multiply([t,this.args.length===1?this.args[0].substitute(e):new C.Constant(NaN)])}return C.Expression.prototype.substitute.call(this,e)};C.Constant.prototype.substitute=function(e){return this};C.Expression.prototype.substitute=function(e){return this.copyWithArgs(Jh(this.args,e))};C.Derivative.prototype.substitute=function(e){let t=e[this._symbol];if(t){if(t.type==="Identifier")return new C.Derivative(t,Jh(this.args,e));throw new Error("Cannot substitute for a derivative variable with a non-Identifier")}return new C.Derivative(this._symbol,Jh(this.args,e))};C.Expression.prototype.simpleFunctionExpression=function(){return this};C.Assignment.prototype.simpleFunctionExpression=function(){return this._expression};C.FunctionDefinition.prototype.simpleFunctionExpression=function(){return this._expression};C.RecursiveFunctionBaseCase.prototype.simpleFunctionExpression=function(){return this._expression};C.Equation.prototype.simpleFunctionExpression=C.CallAssignment.prototype.simpleFunctionExpression=function(){return this.asComparator().simpleFunctionExpression()};var Qh={normaldist:{type:"distribution",symbol:"normaldist",params:["mean","stdev"],defaults:["0","1"],discrete:!1},tdist:{type:"distribution",symbol:"tdist",params:["dof"],defaults:[void 0],discrete:!1},binomialdist:{type:"distribution",symbol:"binomialdist",params:["trials","probsuccess"],defaults:[void 0,"0.5"],discrete:!0},poissondist:{type:"distribution",symbol:"poissondist",params:["mean"],defaults:[void 0],discrete:!0},uniformdist:{type:"distribution",symbol:"uniformdist",params:["min","max"],defaults:["0","1"],discrete:!1}},AU={Histogram:{type:"visualization",symbol:"histogram",params:["data","binwidth"],defaults:[void 0,"1"]},DotPlot:{type:"visualization",symbol:"dotplot",params:["data","binwidth"],defaults:[void 0,"1"]},BoxPlot:{type:"visualization",symbol:"boxplot",params:["data"],defaults:[void 0]}};function v_(e){let t=Mi(e,{trailingComma:!0});return ou(t)}function ou(e){let t=e,n=AU[t.type];if(!n)switch(t.type==="Assignment"&&(t=t._expression),t.type){case"FunctionCall":{n=Qh[t._symbol];break}default:return}if(!n)return;let r={},s=n.params,i=t.args;for(let o=0;o<s.length;o++){let a=i[o];r[s[o]]=a&&a.getInputString()||""}return{...n,span:t.getInputSpan(),values:r}}var LU={X_OR_Y:{points:!1,lines:!0,fill:!1},SINGLE_POINT:{points:!0,lines:!1,fill:!1},POINT_LIST:{points:!0,lines:!1,fill:!1},PARAMETRIC:{points:!1,lines:!0,fill:!1},POLAR:{points:!1,lines:!0,fill:!1},IMPLICIT:{points:!1,lines:!0,fill:!1},POLYGON:{points:!1,lines:!0,fill:!0},HISTOGRAM:{points:!1,lines:!0,fill:!0},DOTPLOT:{points:!0,lines:!1,fill:!1},BOXPLOT:{points:!1,lines:!0,fill:!1},TTEST:{points:!1,lines:!1,fill:!1},STATS:{points:!1,lines:!1,fill:!1},VECTOR2D:{points:!1,lines:!0,fill:!1},POINT3D:{points:!0,lines:!1,fill:!1},POINT3D_LIST:{points:!0,lines:!1,fill:!1},CURVE3D_xyz_t:{points:!1,lines:!0,fill:!1},SLICE:{points:!1,lines:!0,fill:!1},SLICE_r\\u03B8z_at_z:{points:!1,lines:!0,fill:!1},SLICE_zr\\u03B8_at_r:{points:!1,lines:!0,fill:!1},SLICE_zr\\u03B8_at_\\u03B8:{points:!1,lines:!0,fill:!1},SLICE_zr\\u03B8_at_xyz:{points:!1,lines:!0,fill:!1},SLICE_r\\u03B8\\u03C6_at_\\u03B8:{points:!1,lines:!0,fill:!1},SLICE_r\\u03B8\\u03C6_at_\\u03C6:{points:!1,lines:!0,fill:!1},SLICE_r\\u03B8\\u03C6_at_xyz:{points:!1,lines:!0,fill:!1},SLICE_xyz_uv:{points:!1,lines:!0,fill:!1},SEGMENT3D:{points:!1,lines:!0,fill:!1},VECTOR3D:{points:!1,lines:!0,fill:!1},SPHERE3D:{points:!1,lines:!0,fill:!1},SURFACE_xyz_uv:{points:!1,lines:!0,fill:!1},SURFACE_z_r\\u03B8:{points:!1,lines:!0,fill:!1},SURFACE_r_\\u03B8z:{points:!1,lines:!0,fill:!1},SURFACE_r_\\u03B8\\u03C6:{points:!1,lines:!0,fill:!1},SURFACE_r_\\u03B8z_AMBIGUOUS:{points:!1,lines:!0,fill:!1},SURFACE:{points:!1,lines:!0,fill:!1},TRIANGLE3D:{points:!1,lines:!0,fill:!1},SURFACE_AMBIGUOUS:{points:!1,lines:!0,fill:!1},SURFACE_CONSTANT_AMBIGUOUS:{points:!1,lines:!0,fill:!1},IMPLICIT_SURFACE:{points:!1,lines:!0,fill:!1},IMPLICIT_SURFACE_AMBIGUOUS:{points:!1,lines:!0,fill:!1}};function eC(e,t,n){var s,i,o,a,u,c;if(e===void 0)return{points:!1,lines:!1,fill:!1};let r=LU[e];switch(e){case"SINGLE_POINT":return{points:!0,lines:!1,fill:!1};case"POINT_LIST":case"POINT3D_LIST":case"DOTPLOT":return{points:(s=t.points)!=null?s:r.points,lines:(i=t.lines)!=null?i:r.lines,fill:!1};case"POINT3D":return{points:(o=t.points)!=null?o:r.points,lines:!1,fill:!1};case"PARAMETRIC":case"POLYGON":case"X_OR_Y":case"VECTOR2D":case"POLAR":case"IMPLICIT":case"HISTOGRAM":case"BOXPLOT":case"TTEST":case"STATS":case"CURVE3D_xyz_t":return{points:!1,lines:(a=t.lines)!=null?a:r.lines,fill:(u=t.fill)!=null?u:r.fill};case"TRIANGLE3D":case"SPHERE3D":case"SURFACE":case"SURFACE_r_\\u03B8z":case"SURFACE_z_r\\u03B8":case"SURFACE_r_\\u03B8\\u03C6":case"SURFACE_xyz_uv":case"IMPLICIT_SURFACE":case"SURFACE_AMBIGUOUS":case"SURFACE_CONSTANT_AMBIGUOUS":case"SURFACE_r_\\u03B8z_AMBIGUOUS":case"IMPLICIT_SURFACE_AMBIGUOUS":case"SEGMENT3D":case"VECTOR3D":case"SLICE":case"SLICE_r\\u03B8z_at_z":case"SLICE_zr\\u03B8_at_r":case"SLICE_zr\\u03B8_at_\\u03B8":case"SLICE_zr\\u03B8_at_xyz":case"SLICE_r\\u03B8\\u03C6_at_\\u03B8":case"SLICE_r\\u03B8\\u03C6_at_\\u03C6":case"SLICE_r\\u03B8\\u03C6_at_xyz":case"SLICE_xyz_uv":return{points:!1,lines:(c=t.lines)!=null?c:r.lines,fill:!1};default:n&&n(e);let l=e;return eC(e,t)||l}}function tC(e){if(e===void 0)return!1;switch(e){case"SINGLE_POINT":case"POINT_LIST":case"PARAMETRIC":case"POLYGON":case"X_OR_Y":case"VECTOR2D":case"POLAR":case"IMPLICIT":case"SURFACE":case"SURFACE_AMBIGUOUS":case"SURFACE_CONSTANT_AMBIGUOUS":case"SURFACE_r_\\u03B8z":case"SURFACE_r_\\u03B8z_AMBIGUOUS":case"SURFACE_z_r\\u03B8":case"SURFACE_r_\\u03B8\\u03C6":case"SURFACE_xyz_uv":case"IMPLICIT_SURFACE":case"IMPLICIT_SURFACE_AMBIGUOUS":case"CURVE3D_xyz_t":case"SLICE":case"SLICE_r\\u03B8z_at_z":case"SLICE_zr\\u03B8_at_r":case"SLICE_zr\\u03B8_at_\\u03B8":case"SLICE_zr\\u03B8_at_xyz":case"SLICE_r\\u03B8\\u03C6_at_\\u03B8":case"SLICE_r\\u03B8\\u03C6_at_\\u03C6":case"SLICE_r\\u03B8\\u03C6_at_xyz":case"SLICE_xyz_uv":case"SEGMENT3D":case"VECTOR3D":case"SPHERE3D":case"POINT3D":case"POINT3D_LIST":case"TRIANGLE3D":return!0;case"HISTOGRAM":case"BOXPLOT":case"DOTPLOT":case"TTEST":case"STATS":return!1;default:return e}}function O_(e){return e==="SURFACE_r_\\u03B8\\u03C6"||e==="SLICE_r\\u03B8\\u03C6_at_\\u03B8"||e==="SLICE_r\\u03B8\\u03C6_at_\\u03C6"||e==="SLICE_r\\u03B8\\u03C6_at_xyz"}function N_(e){return e==="SURFACE_z_r\\u03B8"||e==="SLICE_zr\\u03B8_at_r"||e==="SLICE_zr\\u03B8_at_\\u03B8"||e==="SLICE_zr\\u03B8_at_xyz"}function R_(e){return e==="SURFACE_r_\\u03B8z"||e==="SURFACE_r_\\u03B8z_AMBIGUOUS"||e==="SLICE_r\\u03B8z_at_z"}var B=function(){};B.version="1.2.6";B._myIndexOf=function(t){var n=this.length,r;for(r=0;r<n;++r)if(this[r]===t)return r;return-1};B.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:B._myIndexOf;B.precision=4;B.largeArray=50;B.compile=function(){var e=Array.prototype.slice.call(arguments),t=e.pop();return t="return function ("+e.join(",")+") {"+t+"}",new Function(["numeric"],t)(B)};B._dim=function(t){for(var n=[];typeof t=="object";)n.push(t.length),t=t[0];return n};B.dim=function(t){var n,r;return typeof t=="object"?(n=t[0],typeof n=="object"?(r=n[0],typeof r=="object"?B._dim(t):[t.length,n.length]):[t.length]):[]};B.mapreduce=function(t,n){return B.compile("x","accum","_s","_k",\'if(typeof accum === "undefined") accum = \'+n+`;\nif(typeof x === "number") { var xi = x; `+t+`; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    `+t+`;\n    xi = x[i-1];\n    `+t+`;\n}\nif(i === 0) {\n    xi = x[i];\n    `+t+`\n}\nreturn accum;`)};B.mapreduce2=function(t,n){return B.compile("x",`var n = x.length;\nvar i,xi;\n`+n+`\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    `+t+`\n}\nreturn accum;`)};B.rep=function(t,n,r){typeof r=="undefined"&&(r=0);var s=t[r],i=Array(s),o;if(r===t.length-1){for(o=s-2;o>=0;o-=2)i[o+1]=n,i[o]=n;return o===-1&&(i[0]=n),i}for(o=s-1;o>=0;o--)i[o]=B.rep(t,n,r+1);return i};B.dotMMsmall=function(t,n){var r,s,i,o,a,u,c,l,p,f,d,y,g,m;for(o=t.length,a=n.length,u=n[0].length,c=Array(o),r=o-1;r>=0;r--){for(l=Array(u),p=t[r],i=u-1;i>=0;i--){for(f=p[a-1]*n[a-1][i],s=a-2;s>=1;s-=2)d=s-1,f+=p[s]*n[s][i]+p[d]*n[d][i];s===0&&(f+=p[0]*n[0][i]),l[i]=f}c[r]=l}return c};B._getCol=function(t,n,r){var s=t.length,i;for(i=s-1;i>0;--i)r[i]=t[i][n],--i,r[i]=t[i][n];i===0&&(r[0]=t[0][n])};B.dotMMbig=function(t,n){var r=B._getCol,s=n.length,i=Array(s),o=t.length,a=n[0].length,u=new Array(o),c,l=B.dotVV,p,f,d,y;for(--s,--o,p=o;p!==-1;--p)u[p]=Array(a);for(--a,p=a;p!==-1;--p)for(r(n,p,i),f=o;f!==-1;--f)y=0,c=t[f],u[f][p]=l(c,i);return u};B.dotMV=function(t,n){var r=t.length,s=n.length,i,o=Array(r),a=B.dotVV;for(i=r-1;i>=0;i--)o[i]=a(t[i],n);return o};B.dotVM=function(t,n){var r,s,i,o,a,u,c,l,p,f,d,y,g,m,h,x,T,b,M;for(o=t.length,a=n[0].length,c=Array(a),i=a-1;i>=0;i--){for(f=t[o-1]*n[o-1][i],s=o-2;s>=1;s-=2)d=s-1,f+=t[s]*n[s][i]+t[d]*n[d][i];s===0&&(f+=t[0]*n[0][i]),c[i]=f}return c};B.dotVV=function(t,n){var r,s=t.length,i,o=t[s-1]*n[s-1];for(r=s-2;r>=1;r-=2)i=r-1,o+=t[r]*n[r]+t[i]*n[i];return r===0&&(o+=t[0]*n[0]),o};B.dot=function(t,n){var r=B.dim;switch(r(t).length*1e3+r(n).length){case 2002:return n.length<10?B.dotMMsmall(t,n):B.dotMMbig(t,n);case 2001:return B.dotMV(t,n);case 1002:return B.dotVM(t,n);case 1001:return B.dotVV(t,n);case 1e3:return B.mulVS(t,n);case 1:return B.mulSV(t,n);case 0:return t*n;default:throw new Error("numeric.dot only works on vectors and matrices")}};B.diag=function(t){var n,r,s,i=t.length,o=Array(i),a;for(n=i-1;n>=0;n--){for(a=Array(i),r=n+2,s=i-1;s>=r;s-=2)a[s]=0,a[s-1]=0;for(s>n&&(a[s]=0),a[n]=t[n],s=n-1;s>=1;s-=2)a[s]=0,a[s-1]=0;s===0&&(a[0]=0),o[n]=a}return o};B.getDiag=function(e){var t=Math.min(e.length,e[0].length),n,r=Array(t);for(n=t-1;n>=1;--n)r[n]=e[n][n],--n,r[n]=e[n][n];return n===0&&(r[0]=e[0][0]),r};B.identity=function(t){return B.diag(B.rep([t],1))};B.pointwise=function(t,n,r){typeof r=="undefined"&&(r="");var s=[],i,o=/\\[i\\]$/,a,u="",c=!1;for(i=0;i<t.length;i++)o.test(t[i])?(a=t[i].substring(0,t[i].length-3),u=a):a=t[i],a==="ret"&&(c=!0),s.push(a);return s[t.length]="_s",s[t.length+1]="_k",s[t.length+2]=\'if(typeof _s === "undefined") _s = numeric.dim(\'+u+`);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i`+(c?"":", ret = Array(_n)")+`;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee(`+t.join(",")+`,_s,_k+1);\n    return ret;\n}\n`+r+`\nfor(i=_n-1;i!==-1;--i) {\n    `+n+`\n}\nreturn ret;`,B.compile.apply(null,s)};B.pointwise2=function(t,n,r){typeof r=="undefined"&&(r="");var s=[],i,o=/\\[i\\]$/,a,u="",c=!1;for(i=0;i<t.length;i++)o.test(t[i])?(a=t[i].substring(0,t[i].length-3),u=a):a=t[i],a==="ret"&&(c=!0),s.push(a);return s[t.length]="var _n = "+u+`.length;\nvar i`+(c?"":", ret = Array(_n)")+`;\n`+r+`\nfor(i=_n-1;i!==-1;--i) {\n`+n+`\n}\nreturn ret;`,B.compile.apply(null,s)};B._biforeach=function e(t,n,r,s,i){if(s===r.length-1){i(t,n);return}var o,a=r[s];for(o=a-1;o>=0;o--)e(typeof t=="object"?t[o]:t,typeof n=="object"?n[o]:n,r,s+1,i)};B._biforeach2=function e(t,n,r,s,i){if(s===r.length-1)return i(t,n);var o,a=r[s],u=Array(a);for(o=a-1;o>=0;--o)u[o]=e(typeof t=="object"?t[o]:t,typeof n=="object"?n[o]:n,r,s+1,i);return u};B._foreach=function e(t,n,r,s){if(r===n.length-1){s(t);return}var i,o=n[r];for(i=o-1;i>=0;i--)e(t[i],n,r+1,s)};B._foreach2=function e(t,n,r,s){if(r===n.length-1)return s(t);var i,o=n[r],a=Array(o);for(i=o-1;i>=0;i--)a[i]=e(t[i],n,r+1,s);return a};B.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};B.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="};B.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"];B.mathfuns2=["atan2","pow","max","min"];B.ops1={neg:"-",not:"!",bnot:"~",clone:""};B.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi);","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]};(function(){var e,t;for(e=0;e<B.mathfuns2.length;++e)t=B.mathfuns2[e],B.ops2[t]=t;for(e in B.ops2)if(B.ops2.hasOwnProperty(e)){t=B.ops2[e];var n,r,s="";B.myIndexOf.call(B.mathfuns2,e)!==-1?(s="var "+t+" = Math."+t+`;\n`,n=function(i,o,a){return i+" = "+t+"("+o+","+a+")"},r=function(i,o){return i+" = "+t+"("+i+","+o+")"}):(n=function(i,o,a){return i+" = "+o+" "+t+" "+a},B.opseq.hasOwnProperty(e+"eq")?r=function(i,o){return i+" "+t+"= "+o}:r=function(i,o){return i+" = "+i+" "+t+" "+o}),B[e+"VV"]=B.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),s),B[e+"SV"]=B.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),s),B[e+"VS"]=B.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),s),B[e]=B.compile(`var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric.`+e+"VV, VS = numeric."+e+"VS, SV = numeric."+e+`SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else `+r("x","y")+`\n}\nreturn x;\n`),B[t]=B[e],B[e+"eqV"]=B.pointwise2(["ret[i]","x[i]"],r("ret[i]","x[i]"),s),B[e+"eqS"]=B.pointwise2(["ret[i]","x"],r("ret[i]","x"),s),B[e+"eq"]=B.compile(`var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric.`+e+"eqV, S = numeric."+e+`eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n`)}for(e=0;e<B.mathfuns2.length;++e)t=B.mathfuns2[e],delete B.ops2[t];for(e=0;e<B.mathfuns.length;++e)t=B.mathfuns[e],B.ops1[t]=t;for(e in B.ops1)B.ops1.hasOwnProperty(e)&&(s="",t=B.ops1[e],B.myIndexOf.call(B.mathfuns,e)!==-1&&Math.hasOwnProperty(t)&&(s="var "+t+" = Math."+t+`;\n`),B[e+"eqV"]=B.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",s),B[e+"eq"]=B.compile("x",\'if(typeof x !== "object") return \'+t+`x\nvar i;\nvar V = numeric.`+e+`eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n`),B[e+"V"]=B.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",s),B[e]=B.compile("x",\'if(typeof x !== "object") return \'+t+`(x)\nvar i;\nvar V = numeric.`+e+`V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n`));for(e=0;e<B.mathfuns.length;++e)t=B.mathfuns[e],delete B.ops1[t];for(e in B.mapreducers)B.mapreducers.hasOwnProperty(e)&&(t=B.mapreducers[e],B[e+"V"]=B.mapreduce2(t[0],t[1]),B[e]=B.compile("x","s","k",t[1]+`if(typeof x !== "object") {    xi = x;\n`+t[0]+`\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.`+e+`V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n`+t[0]+`\n}\nreturn accum;\n`))})();B.inv=function(g){var n=B.dim(g),r=Math.abs,s=n[0],i=n[1],o=B.clone(g),a,u,c=B.identity(s),l,p,f,d,y,g;for(d=0;d<i;++d){var m=-1,h=-1;for(f=d;f!==s;++f)y=r(o[f][d]),y>h&&(m=f,h=y);for(u=o[m],o[m]=o[d],o[d]=u,p=c[m],c[m]=c[d],c[d]=p,g=u[d],y=d;y!==i;++y)u[y]/=g;for(y=i-1;y!==-1;--y)p[y]/=g;for(f=s-1;f!==-1;--f)if(f!==d){for(a=o[f],l=c[f],g=a[d],y=d+1;y!==i;++y)a[y]-=u[y]*g;for(y=i-1;y>0;--y)l[y]-=p[y]*g,--y,l[y]-=p[y]*g;y===0&&(l[0]-=p[0]*g)}}return c};B.det=function(t){var n=B.dim(t);if(n.length!==2||n[0]!==n[1])throw new Error("numeric: det() only works on square matrices");var r=n[0],s=1,i,o,a,u=B.clone(t),c,l,p,f,d,y,g;for(o=0;o<r-1;o++){for(a=o,i=o+1;i<r;i++)Math.abs(u[i][o])>Math.abs(u[a][o])&&(a=i);for(a!==o&&(f=u[a],u[a]=u[o],u[o]=f,s*=-1),c=u[o],i=o+1;i<r;i++){for(l=u[i],p=l[o]/c[o],a=o+1;a<r-1;a+=2)d=a+1,l[a]-=c[a]*p,l[d]-=c[d]*p;a!==r&&(l[a]-=c[a]*p)}if(c[o]===0)return 0;s*=c[o]}return s*u[o][o]};B.transpose=function(t){var n,r,s=t.length,i=t[0].length,o=Array(i),a,u,c;for(r=0;r<i;r++)o[r]=Array(s);for(n=s-1;n>=1;n-=2){for(u=t[n],a=t[n-1],r=i-1;r>=1;--r)c=o[r],c[n]=u[r],c[n-1]=a[r],--r,c=o[r],c[n]=u[r],c[n-1]=a[r];r===0&&(c=o[0],c[n]=u[0],c[n-1]=a[0])}if(n===0){for(a=t[0],r=i-1;r>=1;--r)o[r][0]=a[r],--r,o[r][0]=a[r];r===0&&(o[0][0]=a[0])}return o};B.negtranspose=function(t){var n,r,s=t.length,i=t[0].length,o=Array(i),a,u,c;for(r=0;r<i;r++)o[r]=Array(s);for(n=s-1;n>=1;n-=2){for(u=t[n],a=t[n-1],r=i-1;r>=1;--r)c=o[r],c[n]=-u[r],c[n-1]=-a[r],--r,c=o[r],c[n]=-u[r],c[n-1]=-a[r];r===0&&(c=o[0],c[n]=-u[0],c[n-1]=-a[0])}if(n===0){for(a=t[0],r=i-1;r>=1;--r)o[r][0]=-a[r],--r,o[r][0]=-a[r];r===0&&(o[0][0]=-a[0])}return o};B.norm2=function(t){return Math.sqrt(B.norm2Squared(t))};B.linspace=function(t,n,r){if(typeof r=="undefined"&&(r=Math.max(Math.round(n-t)+1,1)),r<2)return r===1?[t]:[];var s,i=Array(r);for(r--,s=r;s>=0;s--)i[s]=(s*n+(r-s)*t)/r;return i};B.getBlock=function(t,n,r){var s=B.dim(t);function i(o,a){var u,c=n[a],l=r[a]-c,p=Array(l);if(a===s.length-1){for(u=l;u>=0;u--)p[u]=o[u+c];return p}for(u=l;u>=0;u--)p[u]=i(o[u+c],a+1);return p}return i(t,0)};B.setBlock=function(t,n,r,s){var i=B.dim(t);function o(a,u,c){var l,p=n[c],f=r[c]-p;if(c===i.length-1)for(l=f;l>=0;l--)a[l+p]=u[l];for(l=f;l>=0;l--)o(a[l+p],u[l],c+1)}return o(t,s,0),t};B.getRange=function(t,n,r){var s=n.length,i=r.length,o,a,u=Array(s),c,l;for(o=s-1;o!==-1;--o)for(u[o]=Array(i),c=u[o],l=t[n[o]],a=i-1;a!==-1;--a)c[a]=l[r[a]];return u};B.blockMatrix=function(t){var n=B.dim(t);if(n.length<4)return B.blockMatrix([t]);var r=n[0],s=n[1],i,o,a,u,c;for(i=0,o=0,a=0;a<r;++a)i+=t[a][0].length;for(u=0;u<s;++u)o+=t[0][u][0].length;var l=Array(i);for(a=0;a<i;++a)l[a]=Array(o);var p=0,f,d,y,g,m;for(a=0;a<r;++a){for(f=o,u=s-1;u!==-1;--u)for(c=t[a][u],f-=c[0].length,y=c.length-1;y!==-1;--y)for(m=c[y],d=l[p+y],g=m.length-1;g!==-1;--g)d[f+g]=m[g];p+=t[a][0].length}return l};B.tensor=function(t,n){if(typeof t=="number"||typeof n=="number")return B.mul(t,n);var r=B.dim(t),s=B.dim(n);if(r.length!==1||s.length!==1)throw new Error("numeric: tensor product is only defined for vectors");var i=r[0],o=s[0],a=Array(i),u,c,l,p;for(c=i-1;c>=0;c--){for(u=Array(o),p=t[c],l=o-1;l>=3;--l)u[l]=p*n[l],--l,u[l]=p*n[l],--l,u[l]=p*n[l],--l,u[l]=p*n[l];for(;l>=0;)u[l]=p*n[l],--l;a[c]=u}return a};B.epsilon=2220446049250313e-31;B.LU=function(e,t){t=t||!1;var n=Math.abs,r,s,i,o,a,u,c,l,p,f=e.length,d=f-1,y=new Array(f);for(t||(e=B.clone(e)),i=0;i<f;++i){for(c=i,u=e[i],p=n(u[i]),s=i+1;s<f;++s)o=n(e[s][i]),p<o&&(p=o,c=s);for(y[i]=c,c!=i&&(e[i]=e[c],e[c]=u,u=e[i]),a=u[i],r=i+1;r<f;++r)e[r][i]/=a;for(r=i+1;r<f;++r){for(l=e[r],s=i+1;s<d;++s)l[s]-=l[i]*u[s],++s,l[s]-=l[i]*u[s];s===d&&(l[s]-=l[i]*u[s])}}return{LU:e,P:y}};B.LUsolve=function(t,n){var r,s,i=t.LU,o=i.length,a=B.clone(n),u=t.P,c,l,p,f;for(r=o-1;r!==-1;--r)a[r]=n[r];for(r=0;r<o;++r)for(c=u[r],u[r]!==r&&(f=a[r],a[r]=a[c],a[c]=f),l=i[r],s=0;s<r;++s)a[r]-=a[s]*l[s];for(r=o-1;r>=0;--r){for(l=i[r],s=r+1;s<o;++s)a[r]-=a[s]*l[s];a[r]/=l[r]}return a};B.solve=function(t,n,r){return B.LUsolve(B.LU(t,r),n)};var Un=B;var wU=Math.pow(2,-52);function eb(e){for(let t of e)for(let n of t)if(!an(n))return!1;return!0}function FU(e){let t=[];for(let n of e)t.push(n.slice());return t}function __(e){let{numRows:t,numCols:n}=Kh(e),r=[];for(let s=0;s<n;s++)r.push([]);for(let s=0;s<t;s++)for(let i=0;i<n;i++)r[i].push(e[s][i]);return r}function Kh(e){let t=e.length,n=t>0?e[0].length:0;return{numRows:t,numCols:n}}function VU(){throw new Error("Matrix dimension mismatch")}function nC(e,t){let n=Kh(e),r=Kh(t);n.numCols!==r.numRows&&VU();let s=[];for(let i=0;i<n.numRows;i++){let o=[];for(let a=0;a<r.numCols;a++){let u=Se(0,1);for(let c=0;c<e[i].length;c++)u=qs(u,wr(e[i][c],t[c][a]));o.push(u)}s.push(o)}return s}function L_(e){let t=FU(e);return GU(t),t}function BU(e){let t=0;for(let n of e)for(let r of n){let s=Math.abs(V(r));if(!isFinite(s))return NaN;s>t&&(t=s)}return t}function A_(e){for(let t=0;t<e.length;t++)for(let n=0;n<e[t].length;n++)e[t][n]=NaN}function GU(e){let{numRows:t,numCols:n}=Kh(e),r=BU(e);if(!isFinite(r))return A_(e),{determinant:NaN,rank:0};let s=Math.max(t,n)*r*wU,i=Se(1,1),o=0,a=0;for(;o<t&&a<n;){let u=o,c=Math.abs(V(e[o][a]));for(let p=o+1;p<t;p++){let f=Math.abs(V(e[p][a]));(!isFinite(f)||f>c)&&(c=f,u=p)}if(!isFinite(c))return A_(e),{determinant:NaN,rank:0};if(c===0){i=Se(0,1),a+=1;continue}if(!an(e[u][a])&&c<s){for(let p=o;p<t;p++)e[o][p]=0;i=0,a+=1;continue}if(u!==o){i=Us(i);let p=e[o];e[o]=e[u],e[u]=p}for(let p=0;p<t;p++){if(p===o)continue;let f=Ps(e[p][a],e[o][a]);e[p][a]=Se(0,1);for(let d=a+1;d<n;d++)e[p][d]=ai(e[p][d],wr(f,e[o][d]))}let l=e[o][a];i=wr(i,l),e[o][a]=Se(1,1);for(let p=a+1;p<n;p++)e[o][p]=Ps(e[o][p],l);o+=1,a+=1}return{rank:o,determinant:o===t&&o===n?i:Se(0,1)}}function HU(e,t){let n=e.length,r=t.length,s=0,i=0;for(let a=r-n;a<r;a++)s+=e[a+n-r]*t[a],i+=e[a+n-r]*e[a+n-r];let o=s/i;for(let a=r-n;a<r;a++)t[a]=2*o*e[a+n-r]-t[a]}function zU(e,t,n){let r=e.length,s=t.length,i=0,o=0;for(let u=s-r;u<s;u++)i+=e[u+r-s]*t[u][n],o+=e[u+r-s]*e[u+r-s];let a=i/o;for(let u=s-r;u<s;u++)t[u][n]=2*a*e[u+r-s]-t[u][n]}function UU(e,t,n,r){let s=Array(e.length-t);if(s.length===1)return s[0]=1,s;if(r===0){s[0]=1;for(let o=1;o<s.length;o++)s[o]=0;return s}let i=e[t][n]<0?-1:1;s[0]=e[t][n]+i*Math.sqrt(r);for(let o=t+1;o<e.length;o++)s[o-t]=e[o][n];return s}function qU(e,t,n){let r=0;for(;t<e.length;t++)r+=e[t][n]*e[t][n];return r}function tb(e,t){if(!t||!t.mutateInput){let i=e;e=Array(e.length);for(let o=0;o<i.length;o++)e[o]=i[o].slice()}let n=Math.min(e.length,e[0].length),r=Array(n),s=[];for(let i=0;i<n;i++){let o=-1/0,a=i;for(let c=i;c<e[i].length;c++){let l=qU(e,i,c);l>o&&(o=l,a=c)}if(r[i]=a,a!==i)for(let c=0;c<e.length;c++){let l=e[c][a];e[c][a]=e[c][i],e[c][i]=l}let u=UU(e,i,i,o);for(let c=i;c<e[i].length;c++)zU(u,e,c);s.push(u)}return{reflectors:s,r:e,p:r}}function w_(e,t,n){let{reflectors:r,r:s,p:i}=e,o=t.slice();for(let c=0;c<r.length;c++)HU(r[c],o);for(let c=r.length;c<s[0].length;c++)o[c]=0;o.length=s[0].length;let a=Math.pow(2,-52),u=n.regularize?a*Math.abs(s[0][0])*Math.max(s.length,s[0].length):0;for(let c=r.length-1;c>=0;c--){let l=s[c];if(Math.abs(l[c])<=u)o[c]=0;else{for(let p=c+1;p<r.length;p++)o[c]-=o[p]*l[p];o[c]/=l[c]}}for(let c=i.length-1;c>=0;c--)if(i[c]!==c){let l=o[c];o[c]=o[i[c]],o[i[c]]=l}return o}function $U(e,t,n){let r=Array(e.r[0].length);for(let i=0;i<r.length;i++)r[i]=Array(t[0].length);let s=Array(t.length);for(let i=0;i<t[0].length;i++){for(let a=0;a<t.length;a++)s[a]=t[a][i];let o=w_(e,s,n);for(let a=0;a<o.length;a++)r[a][i]=o[a]}return r}function Il(e,t,n){return Array.isArray(t[0])?$U(e,t,n):w_(e,t,n)}function YU(e){let t=e.r,n=Math.min(t.length,t[0].length),r=t[0][0],s=t[n-1][n-1];return r===0?1/0:Math.abs(r/s)}function F_(e){let t=Math.pow(2,-52);return Math.max(e.r.length,e.r[0].length)*t*YU(e)<1}function rb(e,t){let n=[];for(let r=0;r<t;r++)n.push(e);return n}function dm(e,t){let n=Qu(e,t),r=0;for(let s of n){let i=s;r+=i*i}return r/n.length}function Qu(e,t){return e.apply(void 0,t)}function nb(e,t){let n=[];for(let r of e){let s=r.apply(void 0,t);n.push(s)}return n}function V_(e,t){let n=[];for(let r=0;r<e.length;r++)t[r]&&n.push(e[r]);return n}function rC(e,t,n){let r=[];for(let s=0,i=0;s<e.length;s++){let o=0;n[s]&&(o=t[i],i+=1),r.push(e[s]+o)}return r}function oC(e,t){let n=t.solution.map(u=>Math.abs(u)<1e-6?0:u),r=t.solution.map(()=>0),s=dm(e,n),i=Qu(e,n),o=Qu(e,r),a=0;for(let u=0;u<i.length;u++){let c=o[u]*1e-15;a+=Math.abs(i[u]*c)+c*c}return a/=i.length,isFinite(a)||(a=0),isFinite(t.MSE)&&!isFinite(s)?t:s<=t.MSE+a?{solution:n,MSE:s}:t}function aC(e,t){if(!eb(t)||!eb([e]))return;let n=__(t),r=nC([e],n)[0],s=nC(t,n);for(let c=0;c<r.length;c++)s[c].push(Us(r[c]));let i=L_(s);if(!eb(i))return;let o=[],a=r.length,u=0;for(let c of i)for(;u<a;)if(V(c[u])===1){o.push(c[c.length-1]),u++;break}else o.push(Se(0,1)),u++;for(;u<a;)o.push(Se(0,1)),u++;return o}function uC(e,t){let n=rb(0,t.length),r=nb(t,n),s=tb(Un.transpose(r),{mutateInput:!0});for(let u=0;u<2;u++){let c=Qu(e,n),l=Un.neg(Il(s,c,{regularize:!1}));n=Un.add(n,l)}let i=dm(e,n);if(F_(s))return{solution:n,MSE:i};let o=rb(0,t.length);for(let u=0;u<2;u++){let c=Qu(e,o),l=Un.neg(Il(s,c,{regularize:!0}));o=Un.add(o,l)}let a=dm(e,o);return .999*a<=i?{solution:o,MSE:a}:{solution:n,MSE:i}}function sC(e,t,n,r){let s=r.maxIterations,i=r.linearSubset||rb(!1,n.length),o=Un.not(i),a=V_(t,i),u=V_(t,o),c=2,l=.1,p=n,f=0,d=.001,y;if(a.length>0){let h=Un.transpose(nb(a,p)),x=tb(h);y={Jv:h,F:x};let T=Qu(e,p),b=Un.neg(Il(x,T,{regularize:!0}));p=rC(p,b,i)}let g=!1,m=dm(e,p);for(;f<s&&!g&&isFinite(m);){let h=Qu(e,p),x=nb(u,p),T=Un.transpose(x),b,M;if(y){let{F:S,Jv:O}=y;b=Un.dot(x,Un.sub(h,Un.dot(O,Il(S,h,{regularize:!0})))),M=Un.dot(x,Un.sub(T,Un.dot(O,Il(S,T,{regularize:!0}))))}else b=Un.dot(x,h),M=Un.dot(x,T);let P=p,D=!1;for(;f<s&&!g&&!D;){f+=1;let S=Un.add(M,Un.diag(rb(d,u.length))),O=Un.neg(Un.solve(S,b,!0));P=rC(p,O,o),g=Un.all(Un.eq(P,p));let _;if(y){let w=Un.transpose(nb(a,P)),G=tb(w);_={Jv:w,F:G};let k=Qu(e,P),Z=Un.neg(Il(G,k,{regularize:!0}));P=rC(P,Z,i)}let L=dm(e,P);D=L<m,D?(p=P,m=L,y=_,d*=l):(d=Math.max(d,1e-64),d*=c)}}return{solution:p,MSE:m}}var iC=[18.9,.105,.0113,.089,4.414,.373,.06,.149,1.84,9.26,5,.7,.2,1.13,2.61,1,.007,30,120,1500,4e-4,7.23,-1,-.0081,-.03,-28.6,-1.71,-.4,-6.94,-.777,-500];function XU(e){let t=e*503%iC.length;return iC[t]}function ZU(e){let t=[];for(let n=0;n<iC.length;n++){let r=[];for(let s=0;s<e;s++)n===0&&e!==1?r[s]=0:n===1&&e!==1?r[s]=1:r[s]=XU(n*e+s);t.push(r)}return t}function B_(e,t,n,r,s){let i=[];for(let a of n)i.push({soln:sC(e,t,a,s),initialGuess:a});i.sort((a,u)=>isNaN(a.soln.MSE)?1:isNaN(u.soln.MSE)?-1:a.soln.MSE-u.soln.MSE);let o=[];for(let a=0;a<r;a++)o.push(i[a].initialGuess);return o}function WU(e,t,n,r){if(!t||Fs(t))return e;let s=t.bounds;return s[0]===-1/0&&s[1]===1/0?e:s[0]===-1/0?s[1]-Math.exp(-e):s[1]===1/0?s[0]+Math.exp(e):n/(r-1)*s[1]+(r-1-n)/(r-1)*s[0]}var G_=[3,5,7,11,13,17,19];function jU(e,t){let n=[];for(let r=0;r<e.length;r++){let s=e[r],i=[];for(let o=0;o<s.length;o++){let a=G_[o%G_.length]*r%e.length;i.push(WU(s[o],t[o],a,e.length))}n.push(i)}return n}function k_(e,t,n){n||(n={});let{linearSubset:r,bounds:s,preferredInitialGuess:i}=n,o=ZU(t.length);s&&(o=jU(o,s));let a=B_(e,t,o,5,{maxIterations:3,linearSubset:r}),u=B_(e,t,a,1,{maxIterations:60,linearSubset:r}),c=sC(e,t,u[0],{maxIterations:250,linearSubset:r});if(!i)return c;let l=sC(e,t,i,{maxIterations:100,linearSubset:r});return isFinite(l.MSE)&&(l.MSE<c.MSE||si(l.MSE,c.MSE,8))?l:c}function cC(e){return{chunk:e,isLazy:!0}}function H_(e){return e.slice()}function ib(e){if(!e.isLazy)return e;let t=e.chunk.copy();return t.reopenFinalBlock(),{chunk:t,forwardParameterMap:H_,reverseParameterMap:H_,isLazy:!1,valueMap:nq(e.chunk.instructionsLength()),replacementMask:ad(e.chunk.argNames.length)}}function z_(e){let{chunk:t,forwardParameterMap:n,reverseParameterMap:r,isLazy:s,valueMap:i,replacementMask:o,didShiftScale:a}=e;return{chunk:t.copy(),forwardParameterMap:n,reverseParameterMap:r,isLazy:s,valueMap:i.slice(),replacementMask:o.slice(),didShiftScale:a}}function JU(e){let t=1/0,n=-1/0,r=e.length;for(let s of e)t=Math.min(t,s),n=Math.max(n,s);return{min:t,max:n,length:r}}function $_(e){let t=e.getInstruction(e.getReturnIndex());if(t.type!==48)return;let n=t.args[0],r=e.getReturnIndex()-n,s=e.getInstruction(n);if(s.args.length!==2)return;let i=s.args[0],o=s.args[r],a=[],u=[];a.push(i),u.push({min:1,max:qo(e,e.getReturnIndex(),"Programming error: cannot optimize regression on non-constant-length list"),length:qo(e,e.getReturnIndex(),"Programming error: cannot optimize regression on non-constant-length list")});let c=!1,l=!1;for(let m=i+1;m<=o;m++){let h=e.getInstruction(m);if(h.type===39||h.type===41||h.type===40){if(h.args[1]!==i)continue;let x=h.args[0];if(e.getInstruction(x).valueType!==ne||!Je(e.getInstruction(x)))continue;let T=hn(e,x),b=JU(T);if(!isFinite(b.min)||!isFinite(b.max))continue;a.push(m),u.push(b)}else if(h.type===37)h.symbol==="exp"?l=!0:q_(h)&&(c=!0);else if(h.type===12||h.type===13)l=!0;else if(es(h)||ds(h))return}if(a.length===0||!l&&!c)return;let p=[];for(let m=0;m<=o;m++){let h=a.indexOf(m);if(h!==-1){let x=ad(a.length);x[h]=!0,p.push(x)}else p.push(sb(e,p,a.length,m))}let f=[];for(let m=0;m<=e.getReturnIndex();m++)if(e.getInstruction(m).type===2){let x=ad(e.argNames.length);x[m]=!0,f.push(x)}else f.push(sb(e,f,e.argNames.length,m));let d={listAccessDependencyTable:p,listAccesses:a,listStatisticsTable:u},y;for(let m=i+1;m<=e.getReturnIndex();m++){let h=e.getInstruction(m);switch(h.type){case 37:{if(h.symbol==="exp"){let Z=h.args[0],F=lC(d,Z);if(F===void 0){au(e,f,y,m);break}let{listStatistics:Y,listAccessIndex:re}=F,Ee=fm(cC(e),m,Z,re,Y);Ee?y=[Ee]:au(e,f,y,m)}break}case 12:case 13:{let[Z,F]=h.args,Y=lC(d,F);if(Y===void 0||U_(d,Z)){au(e,f,y,m);break}let{listStatistics:re,listAccessIndex:Ee}=Y,he=KU(cC(e),m,Ee,re);he?y=[he]:au(e,f,y,m);break}case 10:if(y&&y.length>1){au(e,f,y,m);break}let x=y&&y.length>0?y[0]:cC(e),[T,b]=h.args,M=x.isLazy?T:x.valueMap[T],P=x.isLazy?b:x.valueMap[b],D=x.chunk.getInstruction(M),S=x.chunk.getInstruction(P),O,_,L;if(D.type===37)O=T,L=D,_=b;else if(S.type===37)O=b,L=S,_=T;else{au(e,f,y,m);break}let w=lC(d,O);if(w===void 0||U_(d,_)){au(e,f,y,m);break}let{listAccessIndex:G,listStatistics:k}=w;if(L.symbol==="exp"){let Z=eq(x,m,_,O,G,k);if(Z){y=Z;break}}else if(q_(L)){let Z=QU(x,m,_,O,G);if(Z){y=[Z];break}}au(e,f,y,m);break;default:{au(e,f,y,m);break}}}if(y===void 0||y.length===0)return;let g=[];for(let m of y)g.push({chunk:m.chunk,forwardParameterMap:m.forwardParameterMap,reverseParameterMap:m.reverseParameterMap});return g}function au(e,t,n,r){if(n===void 0)return;let s=e.getInstruction(r);if(ge(s))for(let i of n)i.valueMap[r]=r;else for(let i of n){let{chunk:o,valueMap:a}=i,u=[],c=0;for(let l of s.args){if(a[l]!==l){if(c+=1,c>1){n.length=0;return}}else{let p=t[l];for(let f=0;f<p.length;f++)if(p[f]&&i.replacementMask[f]){n.length=0;return}}u.push(a[l])}a[r]=c>0?_n(o,s,u):r}}function lC(e,t){let{listAccessDependencyTable:n,listAccesses:r,listStatisticsTable:s}=e,i,o=n[t];for(let a=0;a<o.length;a++)if(o[a]){if(i)return;i={listAccessIndex:r[a],listStatistics:s[a]}}return i}function U_(e,t){let{listAccessDependencyTable:n}=e,r=n[t];for(let s of r)if(s)return!0;return!1}function pC(e,t){let n=[];for(let i=0;i<=t;i++)if(e.getInstruction(i).type===2){let a=ad(e.argNames.length);a[i]=!0,n.push(a)}else n.push(sb(e,n,e.argNames.length,i));let r,s=n[t];for(let i=0;i<s.length;i++)if(s[i]){if(r!==void 0)return;r=i}return r}function QU(e,t,n,r,s){let i=e.chunk,o=pC(i,n);if(o===void 0)return;let a=dC(e,n,o);if(a===void 0)return;let u=i.getInstruction(r),c=u.args[0];if(a=Y_(a,c,s),a===void 0)return;let{chunk:l,valueMap:p}=a,f=l.getInstruction(p[c]);if(f.type!==8)return;let d=f.args[1],y=l.getInstruction(f.args[0]);if(y.type!==10)return;let[g,m]=y.args,h=o,x=d,T=g,b=m,M=l.Multiply([T,b]),P=l.NativeFunction("cos",[M]),D=l.NativeFunction("sin",[M]),S=u.symbol==="sin"?l.Add([l.Multiply([h,D]),l.Multiply([x,P])]):l.Subtract([l.Multiply([h,P]),l.Multiply([x,D])]);p[t]=S;function O(w){let G=a.forwardParameterMap(w),k=G[o],Z=G[d],F=k*Math.cos(Z),Y=k*Math.sin(Z);return G[o]=F,G[d]=Y,G}function _(w){let G=w.slice(),k=w[o],Z=w[d],F=Ts(k,Z),Y=Math.atan2(Z,k);return G[o]=F,G[d]=Y,a.reverseParameterMap(G)}let L=a.replacementMask.slice();return L[o]=!0,L[g]=!0,L[d]=!0,{chunk:l,forwardParameterMap:O,reverseParameterMap:_,valueMap:p,replacementMask:L,isLazy:!1}}function KU(e,t,n,r){let s=e.chunk,i=s.getInstruction(t),[o,a]=i.args,u=s.getInstruction(o);if(u.type===1&&u.valueType===I&&V(u.value)>0){let x=ib(e),{chunk:T,valueMap:b}=x,M=T.Multiply([T.NativeFunction("ln",[b[o]]),b[a]]);return b[a]=M,b[t]=T.NativeFunction("exp",[M]),fm(x,t,a,n,r)||x}let c=pC(s,o);if(c===void 0)return;let l=dC(e,o,c);if(l===void 0)return;let{chunk:p,valueMap:f}=l,d=p.Multiply([f[o],f[a]]);f[a]=d,f[t]=p.NativeFunction("exp",[d]);function y(x){let T=l.forwardParameterMap(x),b=T[c],M=Math.log(b);return T[c]=M,T}function g(x){let T=x.slice(),b=T[c],M=Math.exp(b);return T[c]=M,l.reverseParameterMap(T)}let m=l.replacementMask.slice();m[c]=!0;let h={chunk:p,forwardParameterMap:y,reverseParameterMap:g,isLazy:!1,valueMap:f,replacementMask:m};return fm(h,t,a,n,r)||h}function eq(e,t,n,r,s,i){if(!e.isLazy&&e.didShiftScale)return;let o=e.isLazy?e:z_(e),a=e.chunk,u=pC(a,n);if(u===void 0)return;let c=dC(e,n,u);if(c===void 0)return;let{chunk:l,valueMap:p}=c,f=l.getInstruction(p[r]).args[0],d=l.Add([f,p[n]]);p[n]=d,p[t]=l.NativeFunction("exp",[d]);function y(P){let D=c.forwardParameterMap(P),S=D[u],O=Math.log(S);return D[u]=O,D}function g(P){let D=P.slice(),S=D[u],O=Math.exp(S);return D[u]=O,c.reverseParameterMap(D)}function m(P){let D=c.forwardParameterMap(P),S=D[u],O=Math.log(-S);return D[u]=O,D}function h(P){let D=P.slice(),S=D[u],O=-Math.exp(S);return D[u]=O,c.reverseParameterMap(D)}let x=c.replacementMask.slice();x[u]=!0;let T=ib(o);T.valueMap[t]=T.chunk.Multiply([T.valueMap[n],T.valueMap[r]]);let b={chunk:l,forwardParameterMap:y,reverseParameterMap:g,isLazy:!1,valueMap:p,replacementMask:x},M=z_(b);return M.forwardParameterMap=m,M.reverseParameterMap=h,b=fm(b,t,n,s,i)||b,M=fm(M,t,n,s,i)||M,M.valueMap[t]=M.chunk.Negative([M.valueMap[t]]),[T,b,M]}function fm(e,t,n,r,s){let i=tq(e,n,r,s);if(i!==void 0)return i.valueMap[t]=i.chunk.NativeFunction("exp",[i.valueMap[n]]),i}function tq(e,t,n,r){let s=Y_(e,t,n);if(s===void 0)return;let{chunk:i,valueMap:o}=s,a=i.getInstruction(o[t]);if(a.type!==8)return;let u=a.args[1],c=i.getInstruction(a.args[0]);if(c.type!==10)return;let[l,p]=c.args,{min:f,max:d}=r,y=d-f,g=.5*(d+f),m=i.Divide([i.Subtract([p,i.Constant(g)]),i.Constant(y)]),h=i.Add([i.Multiply([l,m]),u]);o[t]=h;function x(b){let M=s.forwardParameterMap(b),P=M[l],D=M[u],S=P*y,O=D+g*P;return M[l]=S,M[u]=O,M}function T(b){let M=b.slice(),P=b[l],D=b[u],S=P/y,O=D-S*g;return M[l]=S,M[u]=O,s.reverseParameterMap(M)}return{chunk:i,forwardParameterMap:x,reverseParameterMap:T,isLazy:!1,valueMap:o,replacementMask:s.replacementMask,didShiftScale:!0}}function dC(e,t,n){let r=e.chunk,s=ns(r,n,{allowRestriction:!1,allowClosedBlockReferences:!1});if(ln(s,t)!==1)return;let i=fo(s,t),[o,a]=Kn(i,t);if(a===void 0)return;let u=i.newChunk.getInstruction(o);if(u.type!==1||u.valueType!==I)return;let c=i.newChunk.getInstruction(a);if(c.type!==1||c.valueType!==I)return;let l=ib(e),{chunk:p,valueMap:f}=l,d=V(u.value),y=V(c.value);f[t]=n;function g(x){let T=l.forwardParameterMap(x),b=T[n],M=d+y*b;return T[n]=M,T}function m(x){let T=x.slice(),M=(T[n]-d)/y;return T[n]=M,l.reverseParameterMap(T)}let h=l.replacementMask.slice();return h[n]=!0,{chunk:p,forwardParameterMap:g,reverseParameterMap:m,isLazy:!1,valueMap:f,replacementMask:h}}function Y_(e,t,n){let r=e.chunk,s=e.isLazy?t:e.valueMap[t],i=ns(r,n,{allowRestriction:!1,allowClosedBlockReferences:!0});if(ln(i,s)!==1)return;e.isLazy&&(i=ns(r.copy().reopenFinalBlock(),n,{allowRestriction:!1,allowClosedBlockReferences:!1}));let o=fo(i,s),[a,u]=Kn(o,s);if(u===void 0)return;let c=o.newChunk,l=Math.max(u,a),p=[];for(let K=0;K<=l;K++)if(c.getInstruction(K).type===2){let te=ad(c.argNames.length);te[K]=!0,p.push(te)}else p.push(sb(c,p,c.argNames.length,K));let f,d;for(let K=0;K<r.argNames.length;K++)if(p[u][K])if(f===void 0)f=K;else return;else if(p[a][K])if(d===void 0)d=K;else return;if(f===void 0||d===void 0)return;let y=ns(c,f,{allowRestriction:!1,allowClosedBlockReferences:!1});if(ln(y,u)!==1)return;let g=ns(c,d,{allowRestriction:!1,allowClosedBlockReferences:!1});if(ln(g,a)!==1)return;let m=fo(y,u),h=fo(g,a),[x,T]=Kn(m,u),b=m.newChunk.getInstruction(x);if(b.type!==1||b.valueType!==I)return;let M=m.newChunk.getInstruction(T);if(M.type!==1||M.valueType!==I)return;let P=ib(e),{chunk:D,valueMap:S}=P,O=D.Add([D.Multiply([f,n]),d]);S[t]=O;let _=c.copy();_.List([u,a]);let L=_.getCompiledFunction().fn;function w(K){let Oe=P.forwardParameterMap(K),[te,Ze]=L.apply(null,Oe);return Oe[f]=te,Oe[d]=Ze,Oe}let G=V(b.value),k=V(M.value),[Z,F]=Kn(h,a),Y=h.newChunk.copy();Y.List([Z,F]);let re=Y.getCompiledFunction().fn;function Ee(K){let Oe=K.slice(),te=K[f],Ze=K[d],dt=(te-G)/k,me=K.slice();me[f]=dt,me.splice(d,1);let[J,W]=re.apply(null,me),Ge=(Ze-J)/W;return Oe[f]=dt,Oe[d]=Ge,P.reverseParameterMap(Oe)}let he=P.replacementMask.slice();return he[f]=!0,he[d]=!0,{chunk:D,forwardParameterMap:w,reverseParameterMap:Ee,isLazy:!1,valueMap:S,replacementMask:he}}function sb(e,t,n,r){let s=e.getInstruction(r),i=ad(n);if(ge(s))return i;for(let o of s.args){let a=t[o];for(let u=0;u<a.length;u++)i[u]=i[u]||a[u]}return i}function ad(e){let t=[];for(let n=0;n<e;n++)t.push(!1);return t}function nq(e){let t=[];for(let n=0;n<e;n++)t.push(n);return t}function q_(e){return e.type===37&&(e.symbol==="sin"||e.symbol==="cos")}function iL(e,t){try{return iq(e,t)}catch(n){return n instanceof C.Error?n:U(n)}}var ud={coerceToNumber:"all-except-complex"},fC={...ud,wrapInList:!0};function X_(e){return e===I||e===ne||e===R||e===Ue}function rq(e){return!!e.tableRegressionData}function sq(e,t){return e===$e||t===$e?!1:X_(e)&&X_(t)}function iq(e,t){let{policy:n,frame:r,exportFrame:s,lastExportFrame:i,tableStatements:o}=e,a=t._lhs.buildIRExpression(n,r,ud),u=t._rhs.buildIRExpression(n,r,ud);if(a.isError)throw a;if(u.isError)throw u;if(!sq(a.valueType,u.valueType))throw PT([oe(a.valueType),oe(u.valueType)]);let c=t._difference.buildIRExpression(n,r,fC);if(c.isError)throw c;let l=c.valueType;for(let S of c.getDependencies())if(!n.validRegressionParameter(S))throw tP(S);let f=!rq(t)?W_(c.getDependencies(),t.userData.regressionParameters,i):W_(c.getDependencies(),{},{}),{parameters:d,residuals:y,isLinear:g,parameterWarning:m,displayPrecision:h}=sL(f,c,a),x={policy:n,frame:r},T=Z_(x,t,d),b=is.NONE;l===ne&&(b=dq(t,a,T));let M;if(t.userData.isLogModeRegression&&(b===is.LOGLIN||b===is.LOGLOG)){let S=t._logDifference.buildIRExpression(n,r,fC);if(S.isError)throw S;let O=t._logLhs.buildIRExpression(n,r,fC);if(O.isError)throw O;({parameters:d,isLinear:g,parameterWarning:m,displayPrecision:h}=sL(f,S,a)),T=Z_(x,t,d),y=tL(x,t._difference,d);let _=tL(x,t._logDifference,d);M=K_(t,O,T,_,t.userData.isLogModeRegression,b,l)}else M=K_(t,a,T,y,t.userData.isLogModeRegression,b,l);let P=oq(t,s),D=pq(t,P,o,y);return t.userData.residualVariable=qr(P),new C.OptimizedRegression(d,lt(l,y),M,T.substituted,{isModelValid:!!T.uniqueRHSNumberList,residualVariable:P,residualSuggestionId:D,shouldSuggestLogMode:b!==is.NONE,isLinear:g,displayPrecision:h,parameterWarning:m})}function oq(e,t){if(e.userData&&e.userData.residualVariable){let i=no(e.userData.residualVariable);if(!t[i])return i}let n=e.getDependencies().filter(i=>i[0]!=="_"&&!i.startsWith("regressionparameter_")&&!i.startsWith("idref_")),r;for(let i of n){let o=i.match(/_(.*)/);if(o&&(r="e_"+o[1],!t[r]))return r}let s=1;for(;;){if(r="e_"+s,!t[r])return r;s++}}function Z_({policy:e,frame:t},n,r){let s=n._rhs.getDependencies(),i,o;for(let p of s){if(r.hasOwnProperty(p))continue;let f=t[p];if(!f||f.isFunction||(f.type==="Assignment"&&(f=f._expression),!f.buildIRExpression))continue;let d=f.buildIRExpression(e,t,ud);if(!d.isError&&kn(d.valueType,ne)){if(i!==void 0){i=void 0,o=void 0;break}d.getDependencies().length===0&&(i=p,o=d)}}let a=Tn(t);i!==void 0&&(a[i]=void 0);let u=n._rhs.buildIRExpression(e,a,ud),c=Tn(a);for(let p of We(r))c[p]=r[p];let l=n._rhs.buildIRExpression(e,c,ud);return{node:u,substituted:l,uniqueRHSNumberList:o}}function W_(e,t,n){let r=[];if(t||(t={}),n||(n={}),!e.every(s=>s in n||s in t))return e.map(s=>1);for(let s of e){let i=qr(s),o=n[s];o&&isFinite(o.asValue())?r.push(+o.asValue()):t.hasOwnProperty(i)&&isFinite(+t[i])?r.push(+t[i]):r.push(1)}return r}function yC(e,t){switch(t){case ne:return e;case Ue:return function(...r){let s=e.apply(void 0,r);return aq(s)};default:throw U("Regression with invalid value type.")}}function j_(e,t){switch(t){case ne:return e;case Ue:return uq(e);default:throw U("Regression with invalid value type.")}}function aq(e){let t=[];for(let[n,r]of e)t.push(n,r);return t}function uq(e){let t=[];for(let[n,r]of e)t.push(n,r);return t}function J_(e,t){let n=t.getDependencies(),r=t.getCompiledFunction(n).fn,s=t.valueType,i=yC(r,s);if(n.length){let o=t.findLinearSubset(n),a=o.every(c=>c),u=[];for(let c of n){let l=t.takeDerivative(c).getCompiledFunction(n).fn;u.push(yC(l,s))}if(a){let c=n.map(()=>Se(0,1)),l=t.interpretWithParameters(c),p=j_(l,s),f=[];for(let m of n){let h=t.takeDerivative(m).interpretWithParameters(c);f.push(j_(h,s))}let d=aC(p,f);if(d){let m=t.interpretWithParameters(d);return{solution:d,residuals:m,MSE:ob(m,s),isLinear:a}}let{solution:y,MSE:g}=oC(i,uC(i,u));return{solution:y,residuals:r.apply(void 0,y),MSE:nL(g,s),isLinear:a}}else{let c=[];for(let d of n)c.push(t.boundDomain(d));let l={linearSubset:o,bounds:c,preferredInitialGuess:e},{solution:p,MSE:f}=oC(i,k_(i,u,l));return{solution:p,residuals:r.apply(void 0,p),MSE:nL(f,s),isLinear:a}}}else return{solution:[],residuals:t.interpretWithParameters([]),MSE:oL(r,[],s),isLinear:!0}}function Q_(e,t){let n={},r=t.getDependencies();for(let s=0;s<r.length;s++){let i=new C.RegressionParameter(e[s]);n[r[s]]=i}return n}function K_(e,t,n,r,s,i,o){let a=ob(r,o);if(!isFinite(a))throw nP();if(t.getDependencies().length>0)return{RMSE:Math.sqrt(a)};let u=fq(t.asValue(),t.valueType);if(t.getDependencies().length||!isFinite(u)||u<=0||!e.isLhsSimple)return{RMSE:Math.sqrt(a)};{let c=1-a/u,l=cq(t,n,s,i,a);return l!==void 0?{r:l,rsquared:l*l}:{Rsquared:c}}}function eL(e){if(!e.isTypedConstant)return NaN;let t={valueType:e.valueType,value:e.asCompilerValue()},{value:n,valueType:r}=t;switch(r){case I:return n;case R:return V(n[1])===0?n[0]:NaN;default:return NaN}}function cq(e,t,n,r,s){if(!t.uniqueRHSNumberList)return;let i=[],o=[],a=n&&(r===is.LINLOG||r===is.LOGLOG);C.List.eachArgs([t.uniqueRHSNumberList,e],l=>{let p=eL(l[0]),f=eL(l[1]);i.push(a?Math.log(V(p)):p),o.push(f)});let u=Og(i.map(V),o.map(V));if(!isFinite(u))return;let c=lq(i,o);if(si(c.MSE,s,8))return u}function lq(e,t){let n=t,r=[e.map(a=>Us(a)),e.map(()=>Se(-1,1))],s=aC(n,r);if(s){let[a,u]=s,c=[];for(let l=0;l<t.length;l++)c.push(ai(t[l],qs(wr(a,e[l]),u)));return{solution:s,MSE:ob(c,ne)}}function i(a,u){let c=[];for(let l=0;l<e.length;l++)c.push(V(t[l])-(a*V(e[l])+u));return c}return uC(i,[function(){return e.map(a=>-V(a))},function(){return e.map(()=>-1)}])}function pq(e,t,n,r){var a,u;let s=e._rhs.getDependencies(),i;(a=e.tableRegressionData)!=null&&a.tableId&&(i=(u=e.tableRegressionData)==null?void 0:u.tableId);for(let c in n){let l=n[c];if(l.columns.length===0)continue;let p=l.columns[0];i===void 0&&ga(p)&&ki(p.header)&&s.includes(p.header._symbol)&&(i=c);for(let f=1;f<l.columns.length;f++)if(l.columns[f].getDependencies().includes(t))return}if(!r.some(c=>Array.isArray(c)&&V(c[1])!==0))return i}function mC(e,t){let n=e.length,r=e[0],s=t[0],i=e[n-1],o=t[n-1];if(!isFinite(r)||!isFinite(i)||!isFinite(s)||!isFinite(o)||o-s===0)return!1;let a=i-r;if(a===0)return!1;for(let u=1;u<n-1;u++){let c=e[u],l=t[u],p=(o*(c-r)+s*(i-c))/a;if(!si(l,p,5))return!1}return!0}var is={NONE:0,LOGLIN:1,LOGLOG:2,LINLOG:3};function dq(e,t,n){if(!e.isLhsSimple||!n.uniqueRHSNumberList||se(t.valueType,R))return is.NONE;let r=n.substituted;if(r.isError||r.valueType!==I)return is.NONE;let s=r.getDependencies();if(s.length!==1||isFinite(n.node.polynomialOrder(s[0])))return is.NONE;let i=r.getCompiledFunction(s).fn,o=n.uniqueRHSNumberList;if(r.valueType!==I)return is.NONE;let a=o.mapElements(f=>+f.asValue());if(a.length<3)return is.NONE;a.sort((f,d)=>f-d);let u=a.map(i),c=u.map(Math.log),l=a.map(Math.log),p=!0;return C.List.wrap(t).eachElement(f=>{isFinite(Math.log(+f.asValue()))||(p=!1)}),mC(a,c)&&p?is.LOGLIN:mC(l,c)&&p?is.LOGLOG:mC(l,u)?is.LINLOG:is.NONE}function tL({policy:e,frame:t},n,r){let s=Tn(t);for(let a of We(r))s[a]=r[a];let i=od({policy:e,frame:s,wrapInList:!0},n),o=i.getError();if(o)throw o;return i.asCompilerValue()}function ob(e,t){switch(t){case ne:{let n=0;for(let r of e){let s=V(r);n+=s*s}return n/e.length}case Ue:{let n=0;for(let[r,s]of e){let i=V(r);n+=i*i;let o=V(s);n+=o*o}return n/e.length}default:throw U("Regression with invalid value type.")}}function fq(e,t){switch(t){case I:case R:return 0;case ne:return Sf(e);case Ue:{let n=e,r=0,s=0;for(let[u,c]of n)r+=u,s+=c;let i=r/n.length,o=s/n.length,a=0;for(let[u,c]of n){let l=V(u)-i;a+=l*l;let p=V(c)-o;a+=p*p}return a/n.length}default:throw U("Regression with invalid value type.")}}function oL(e,t,n){let r=e.apply(void 0,t);return ob(r,n)}function nL(e,t){switch(t){case ne:return e;case Ue:return e*Math.SQRT2;default:throw U("Regression with invalid value type.")}}function rL(e,t,n,r){let s=5;if(!r)return s;let i=t.apply(void 0,e);for(let o=4;o<15;o++){let a=e.map(l=>parseFloat(l.toPrecision(o))),u=t.apply(void 0,a),c=0;for(let l=0;l<i.length;l++){let p=Math.abs(i[l]-u[l]);p>c&&(c=p)}if(c<n){s=o;break}}return s}function mq(e){let t=0;if(j(e==null?void 0:e.valueType)){let n=e.asValue(),r=Sg(n),s=Dg(n);t=(s<0&&0<r?r-s:Math.max(Math.abs(s),Math.abs(r)))/500}return t}function sL(e,t,n){let r,s,i=t._chunk;i&&(s=$_(i));let o=j(n==null?void 0:n.valueType),a=mq(n);if(!s||s.length===0){t=t.deriveRegressionRestrictions(),r=J_(e,t);let b=t.getCompiledFunction(t.getDependencies()).fn,M=rL(r.solution.map(P=>V(P)),b,a,o);return{parameters:Q_(r.solution,t),displayPrecision:M,residuals:r.residuals,isLinear:r.isLinear,parameterWarning:!1}}let u=t.getDependencies(),c=t.valueType,l=t.getCompiledFunction(u).fn,p=yC(l,c),f=1/0,d={},y,g=!1,m=1/0,h=5;for(let b of s){let M=new on(b.chunk);if(M=M.deriveRegressionRestrictions(),r=J_(b.forwardParameterMap(e),M),r.MSE<f){let P=b.reverseParameterMap(r.solution.map(S=>V(S))),D=oL(l,P,c);if(d&&(!isFinite(D)||D>=f)){isFinite(D)||(g=!0,r.MSE<m&&(m=r.MSE));continue}f=r.MSE,d=Q_(P,t),y=p.apply(void 0,P),h=rL(P,p,a,o)}}let x=Object.keys(d).length,T=o?n.asValue().length:1;return{parameters:d,displayPrecision:h,residuals:y,isLinear:!1,parameterWarning:g&&m<f&&T>x}}var Si={pointsOfInterest:!0,plotSingleVariableImplicitEquations:!0,plotImplicits:!0,plotInequalities:!0,sliders:!0};function aL(e,t){let{mappedArgIndex:n,mappedReturnIndex:r,solutionIndex:s}=t,i=[],o=Vu(e,n),a=gq(e,o,r),u=s,c=e.NanOfType(e.getReturnType());for(let l=0;l<=r;l++){let p=e.getInstruction(l);if(l===n){i.push(s);continue}if(!o[l]&&!e.isInClosedBlock(l)){i.push(l);continue}if(ge(p))i.push(e.copyInstruction(p));else{let f=yq(i,p.args);i.push(e.copyInstructionWithArgs(p,f)),p.type===33&&a[l]&&(u=e.Piecewise([f[0],u,c]))}}return u}function yq(e,t){let n=[];for(let r of t)n.push(e[r]);return n}function gq(e,t,n){let r=[];for(let s=0;s<n;s++)r.push(!1);r[n]=t[n];for(let s=n;s>=0;s--){if(!r[s]||!t[s])continue;let i=e.getInstruction(s);if(i.type===33)r[i.args[1]]=!0;else if(!ge(i))for(let o of i.args)r[o]=!0}return r}function uL(e,t){try{return hq(e,t)}catch(n){return n instanceof C.Base?n:U(n)}}function gC(e,t){try{let n=new on(t),r=xl({},n),s=[];for(let o=0;o<r.length;o++)s.push(I);let i=jh({policy:e,frame:{},argNames:r,argTypes:s,selection:void 0,locals:[]});return i.chunk=t,t.fuseBroadcast(),cL({policy:e,ctx:i,isInequality:!1,allowSolvingIn3D:!0},t)}catch(n){return n instanceof C.Base?n:U(n)}}function ab(e,t){let n=e.getInstruction(t);if(n.type!==1)return!1;switch(n.valueType){case R:return Number.isNaN(n.value[0]);case I:return Number.isNaN(n.value);default:throw U("Unexpected type in isConstantNaN: "+at(n.valueType))}}function hq({policy:e,frame:t},n){let r=!1,s=[];if(n instanceof ku){let x=n._lhs,T=x._symbol;if(!t[T]&&!e.assignmentForbidden(T)&&(r=!0,s=x._dependencies,x.args.length>1)){let M=n._dependencies.filter(D=>!s.includes(D)),P=rn([T]).setDependencies(M);throw P.silent=!0,P}}let i=n.asComparator(),o=xl(t,i),a=[];for(let x=0;x<o.length;x++)a.push(I);let u=jh({policy:e,frame:t,argNames:o,argTypes:a,selection:void 0,locals:[]}),{chunk:c}=u,l=i.getOperator(),p=l!=="=",f=Fe(u,i.args[0]),d=zi(c,f,{peelableCoerce:!0});if(d!==f&&!ab(c,f)&&ab(c,d))throw Ny(l);let y=Fe(u,i.args[1]),g=zi(c,y,{peelableCoerce:!0});if(g!==y&&!ab(c,y)&&ab(c,g))throw Ny(l);try{Uo(c,e,i,[d,g])}catch(x){throw x instanceof v&&r&&(x.silent=!0),x}switch(l){case"<":c.Less([d,g]);break;case">":c.Greater([d,g]);break;case"<=":c.LessEqual([d,g]);break;case">=":c.GreaterEqual([d,g]);break;case"=":c.Equal([d,g]);break}if(c.fuseBroadcast(),c.isConstant())return new on(c);let h=c.getInstruction(d).type!==2||xl(t,i.args[1]).indexOf(c.argNames[d])!==-1;if(!Si.plotImplicits&&h)throw ZI();return Jr[l].direction===-1?c.Subtract([g,d]):c.Subtract([d,g]),c.fuseBroadcast(),cL({policy:e,ctx:u,isInequality:p,allowSolvingIn3D:!1,maybeBaseCase:r,callParameters:s},c)}function cL({policy:e,ctx:t,isInequality:n,allowSolvingIn3D:r,maybeBaseCase:s,callParameters:i},o){let a=o.getLiveArgNames();if(a.length===0)throw U(`Unexpected: non-constant node with dependencies: ${a}`);if(a.length===1&&!n&&!Si.plotSingleVariableImplicitEquations)return XI();let u=g=>g==="x"||g==="y"||g==="z";if(e.is3dPolicy()?!a.every(u):a.length>2){let g=e.sliderVariables(a);if(s){let m=i?a.filter(x=>!i.includes(x)):a,h=rn(g).setDependencies(m);return h.silent=!0,h}else return rn(g).setDependencies(a)}if(n&&!e.validInequalityVariables(a))return $I().setDependencies(a);let{localFrames:c,effectiveOrder:l,variableOfInterest:p}=bq(t,n);if(e.complicatedPolarImplicit(p,l))return WI().setDependencies(a);if(!e.validImplicitVariables(a)){let g=Ac();return s&&(g.silent=!0),g}if(e.is3dPolicy()&&r&&l!==1)return ca();if(l>2||e.is3dPolicy()&&!r)return new on(o);let f=[],d=[],y=1;for(let g=0;g<c.length;g++){let m=c[g],h=xq(m,n);y=h.length;for(let T of h){let b=m.chunk.copy();if(b.setReturnIndex(T),m.isRestrictedPolynomial){let{mappedArgIndex:M,mappedReturnIndex:P}=m;b.setReturnIndex(aL(b,{mappedArgIndex:M,mappedReturnIndex:P,solutionIndex:b.getReturnIndex()}))}b.fuseBroadcast(),f.push(new on(b))}let x=!1;for(let T of m.coefficients){let b=m.chunk.getInstruction(T);b.type===1&&b.value!==0&&(x=!0)}if(o.argNames.length!==2||x)d.push(void 0);else{let T=m.chunk.copy(),b=m.coefficients.slice();T.List(b);let M=j(o.getReturnType())?o.elementAt(g):o.copy(),D=M.argNames.indexOf(p)===0?1:0,S=M.getReturnIndex();M.Add([D,M.Multiply([M.Constant(0),S])]),d.push({coefficients:T,restriction:M})}}return new C.SolvedEquation(p,new C.List(f),d,y)}function bq(e,t){let n=e.chunk,r=e.policy,s=n.argNames,i=j(n.getReturnType()),o=[];e:for(let a=0;a<s.length;a++){let u=s[a],c=s.length>1&&!r.validSolvedVariable(u);o[a]={localFrames:[],effectiveOrder:0,variableOfInterest:u};let l=!t;if(c){o[a].effectiveOrder=1/0;continue}let p=i?n.getConstantListLength():1;if(p==null)throw new Error("Programming error: cannot solve a variable-length list expression");for(let f=0;f<p;f++){let d=i?n.elementAt(f):n;if(d.polynomialOrder(u,{allowRestriction:l,allowClosedBlockReferences:!1})>2){o[a].effectiveOrder=1/0;continue e}let g=d.getPolynomialCoefficients(u);o[a].localFrames.push(g),o[a].effectiveOrder=Math.max(o[a].effectiveOrder,g.coefficients.length-1)}}if(s.length===1)return o[0];if(s.length===2&&!s.includes("z"))return s[0]==="y"&&(o=[o[1],o[0]]),o[0].effectiveOrder===0?o[1]:o[1].effectiveOrder===0?o[0]:o[o[0].effectiveOrder<o[1].effectiveOrder?0:1];{let a=o.filter(c=>c.effectiveOrder===1);if(a.length>0)return a[0];let u=o.filter(c=>c.effectiveOrder===2);return u.length>0?u[0]:o[0]}}function xq(e,t){return t?Iq(e):Tq(e)}function Tq({chunk:e,coefficients:t}){let[n,r,s]=t,i=e.Constant(Se(0,1)),o=e.Constant(NaN);if(s===void 0){r===void 0&&(r=i);let a=e.Negative([e.Divide([n,r])]),u=e.Equal([r,i]);return[e.Piecewise([u,o,a])]}else{let a=e.Constant(Se(2,1)),u=e.Multiply([a,s]),c=e.Negative([e.Divide([r,u])]),l=e.Divide([n,s]),p=e.Subtract([e.Multiply([c,c]),l]),f=e.Equal([s,i]),d=e.Equal([p,i]),y=e.getInstruction(p);if(y.type===1&&V(y.value)===0)return[e.Piecewise([f,o,c])];{let g=e.NativeFunction("sqrt",[p]),m=e.Greater([r,i]),h=e.Less([r,i]),x=e.Greater([c,i]),T=e.Piecewise([x,e.Add([c,g]),e.Subtract([c,g])]),b=e.Piecewise([d,T,e.Divide([l,T])]),M=e.Negative([e.Divide([n,r])]);return[e.Piecewise([f,e.Piecewise([h,M,o]),T]),e.Piecewise([f,e.Piecewise([m,M,o]),b])]}}}function Iq({chunk:e,coefficients:t}){let[n,r,s]=t,i=e.Constant(Se(0,1));s===void 0&&(s=i),r===void 0&&(r=i),n===void 0&&(n=i);let o=e.Constant(Se(2,1)),a=e.Constant(NaN),u=e.Constant(Se(1e305,1)),c=e.Negative([u]),l=e.Multiply([o,s]),p=e.Negative([e.Divide([r,l])]),f=e.Divide([n,s]),d=e.Subtract([e.Multiply([p,p]),f]),y=e.NativeFunction("sqrt",[d]),g=e.Negative([e.Divide([n,r])]),m=e.Equal([s,i]),h=e.Equal([d,i]),x=e.Greater([s,i]),T=e.Equal([r,i]),b=e.Greater([r,i]),M=e.Less([r,i]),P=e.Greater([p,i]),D=e.Greater([n,i]),S=e.Less([d,i]),O=e.Piecewise([P,e.Add([p,y]),e.Subtract([p,y])]),_=e.Piecewise([h,O,e.Divide([f,O])]),L=e.Piecewise([P,_,O]),w=e.Piecewise([P,O,_]);return[e.Piecewise([m,e.Piecewise([M,g,a]),e.Piecewise([x,L,a])]),e.Piecewise([m,e.Piecewise([T,e.Piecewise([D,c,a]),a]),e.Piecewise([x,e.Piecewise([S,c,a]),L])]),e.Piecewise([m,e.Piecewise([T,e.Piecewise([D,u,a]),a]),e.Piecewise([x,e.Piecewise([S,u,a]),w])]),e.Piecewise([m,e.Piecewise([b,g,a]),e.Piecewise([x,w,a])])]}function va(e){return e>=100}function lL(e,t){switch(e){case 106:return 200;case 107:return 201;case 108:return 202;case 103:return 214;case 130:return 215;case 112:return 209;case 113:return 210;case 110:switch(t){case"z":return 206;case"theta":return 205;case"x":case"y":case"r":case"_implicit":return 211;default:return 10}case 109:switch(t){case"r":return 203;case"theta":return 204;case"x":case"y":case"z":case"_implicit":return 213;default:return 10}case 111:switch(t){case"theta":return 207;case"phi":return 208;case"x":case"y":case"z":case"rho":case"_implicit":return 212;default:return 10}default:return 10}}function hC(e){switch(e){case 123:case 122:case 121:case 120:case 124:case 126:case 127:return!0;default:return!1}}function uu(e){return e===26||e===4}function Hre(e){return uu(e)||e===3||e===25}function pL(e){let t=[];for(let r=0;r<e.instructionsLength();r++)t.push(!1);let n=[];t[e.getReturnIndex()]=!0;for(let r=e.instructionsLength()-1;r>=0;r--){if(!t[r])continue;let s=e.getInstruction(r);if(s.type===2&&n.push(e.argNames[r]),ge(s))continue;let i=Yu(e,s)?[s.args[1]]:s.args;for(let o of i)t[o]=!0}return n}var Pq=e=>{let t=[],n=[],r=e.length;for(let s=0;s<r;s++)t.push(e[s][0]),n.push(e[s][1]);return{defined:{x:t,y:n}}},go=Pq;var{sin:Eq,cos:Mq}=Math,st=class e{constructor(t=0,n=0,r=0){this.x=t;this.y=n;this.z=r}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}set(t,n,r){return this.x=t,this.y=n,this.z=r,this}clone(){return new e(this.x,this.y,this.z)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}isZero(){return this.x===0&&this.y===0&&this.z===0}isFinite(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)}subVectors(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this.z=t.z-n.z,this}addVectors(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this.z=t.z+n.z,this}multiply(t){return this.x*=t,this.y*=t,this.z*=t,this}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){return this.multiply(1/this.magnitude()),this}cross(t){return this.crossVectors(this,t)}crossVectors(t,n){let r=t.x,s=t.y,i=t.z,o=n.x,a=n.y,u=n.z;return this.x=s*u-i*a,this.y=i*o-r*u,this.z=r*a-s*o,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}rotateAroundAxis(t,n){let r=Cq(t,n);return new e(r[0]*this.x+r[1]*this.y+r[2]*this.z,r[3]*this.x+r[4]*this.y+r[5]*this.z,r[6]*this.x+r[7]*this.y+r[8]*this.z)}};function Cq(e,t){let n=e.x,r=e.y,s=e.z,i=Eq(t),o=Mq(t),a=1-o;return[a*n*n+o,a*n*r+i*s,a*n*s-i*r,a*r*n-i*s,a*r*r+o,a*r*s+i*n,a*s*n+i*r,a*s*r-i*n,a*s*s+o]}function cd(e,t,n,r,s,i,o){let[a,u,c]=[new st,new st,new st],[l,p,f]=[new st,new st,new st],[d,y]=[new st,new st];for(let g=0;g<e.length/3;g++){let m=e[3*g],h=e[3*g+1],x=e[3*g+2];a.set(t[3*m],t[3*m+1],t[3*m+2]),u.set(t[3*h],t[3*h+1],t[3*h+2]),c.set(t[3*x],t[3*x+1],t[3*x+2]),l.set(n[3*m],n[3*m+1],n[3*m+2]),p.set(n[3*h],n[3*h+1],n[3*h+2]),f.set(n[3*x],n[3*x+1],n[3*x+2]),d.subVectors(c,a),y.subVectors(a,u);let T=d.cross(y).normalize();if(!(l.dot(T)>o&&p.dot(T)>o&&f.dot(T)>o)||l.dot(p)<0||l.dot(f)<0||p.dot(f)<0){let M=t.length/3;e[3*g]=M,e[3*g+1]=M+1,e[3*g+2]=M+2,t.push(a.x,a.y,a.z),t.push(u.x,u.y,u.z),t.push(c.x,c.y,c.z),n.push(T.x,T.y,T.z),n.push(T.x,T.y,T.z),n.push(T.x,T.y,T.z),r.push(r[2*m],r[2*m+1]),r.push(r[2*h],r[2*h+1]),r.push(r[2*x],r[2*x+1]);let P=s;if(s>0){for(let D=0;D<P;D++)i.push(i[P*m+D]);for(let D=0;D<P;D++)i.push(i[P*h+D]);for(let D=0;D<P;D++)i.push(i[P*x+D])}}}}function cb(e){let{triangles:t,normalDirHints:n}=e.triangulate(),{extraAttrCount:r}=e,s=e.getVertexCount(),i=new Array(s),o=new Array(s*3),a=[],u=!1,c=new Array(s*3),l=new Array(s*2),p=new Array(s*r),f=[],d=0;function y(m){let h=e.getVertex(m);if(!h)return null;let x=n[m],T=x?e.hintedNormal(m,x):e.getNormal(m);T?(c[3*d]=T[0],c[3*d+1]=T[1],c[3*d+2]=T[2]):(a[d]=!0,u=!0,c[3*d]=0,c[3*d+1]=0,c[3*d+2]=0),o[3*d]=h[0],o[3*d+1]=h[1],o[3*d+2]=h[2];let b=e.getUV(m);if(l[2*d]=b[0],l[2*d+1]=b[1],r>0)for(let M=0;M<r;M++)p[r*d+M]=e.getExtraAttr(m,M);return d++}function g(m){let h=i[m];return h===void 0?i[m]=y(m):h}for(let m=0;m<t.length;m+=3){let h=t[m],x=t[m+1],T=t[m+2],b=g(h),M=g(x),P=g(T);if(b===null||M===null||P===null)continue;f.push(b,M,P);let D=a[b],S=a[M],O=a[P];if(D||S||O){let _=o,L=c,w=new st(_[3*b],_[3*b+1],_[3*b+2]),G=new st(_[3*M],_[3*M+1],_[3*M+2]),k=new st(_[3*P],_[3*P+1],_[3*P+2]),Z=new st().subVectors(k,w),F=new st().subVectors(w,G),Y=Z.cross(F);if(!Y.isFinite())continue;D&&(L[3*b+0]+=Y.x,L[3*b+1]+=Y.y,L[3*b+2]+=Y.z),S&&(L[3*M+0]+=Y.x,L[3*M+1]+=Y.y,L[3*M+2]+=Y.z),O&&(L[3*P+0]+=Y.x,L[3*P+1]+=Y.y,L[3*P+2]+=Y.z)}}if(o.length=d*3,c.length=d*3,l.length=d*2,u)for(let m=0;m<d;m++){if(!a[m])continue;let h=c[3*m],x=c[3*m+1],T=c[3*m+2],b=Math.sqrt(h*h+x*x+T*T);c[3*m]=h/b,c[3*m+1]=x/b,c[3*m+2]=T/b}return cd(f,o,c,l,r,p,0),{positions:o,normals:c,faces:f,uvs:l,resolved:!0,extraAttrs:p}}var TC=class{constructor({resolution:t,uRange:n,vRange:r,du:s,dv:i,extraAttrCount:o}){this.normalDirHints=[];this.isVertexAtCreaseCache=[];this.triangles=[];this.edgeVertices=new Map;this.edgeNormalVertices=new Map;this.finiteVertices=new Map;this.resolution=t,this.uRange=n,this.vRange=r,this.du=s,this.dv=i,this.extraAttrCount=o,this.duSquared=s*s,this.dvSquared=i*i}addVertex(t){return this.normalDirHints.push(void 0),this.isVertexAtCreaseCache.push(void 0),this._addVertex(t)}jumpAlongEdge(t,n){let r=0;if(t>n){let u=t;t=n,n=u,r=1}let s=n*n+t,i=this.edgeVertices.get(s);if(i===null)return;if(i!==void 0)return[i[r],i[1-r]];let o=this.findJumpBetweenTwoSamples(t,n);if(o===void 0){this.edgeVertices.set(s,null);return}let a=[this.addVertex(o[0]),this.addVertex(o[1])];return this.edgeVertices.set(s,a),[a[r],a[1-r]]}edgeNormalFeature(t,n){let r=0;if(t>n){let u=t;t=n,n=u,r=1}let s=n*n+t,i=this.edgeNormalVertices.get(s);if(i!==void 0)return this.flipEdgeNormalFeature(i,r);let o=this.findCreaseBetweenTwoSamples(t,n),a=o===null?null:o.type==="high-curvature"?{type:"high-curvature",pos:this.addVertex(o.pos)}:{type:"crease",left:this.addVertex(o.left),right:this.addVertex(o.right)};return this.edgeNormalVertices.set(s,a),this.flipEdgeNormalFeature(a,r)}flipEdgeNormalFeature(t,n){return(t==null?void 0:t.type)==="crease"?{type:"crease",left:n===0?t.left:t.right,right:n===0?t.right:t.left}:t}findCreaseBetweenTwoSamples(t,n){let i=this.getUV(t),o=this.getUV(n),a=this.getNormal(t),u=this.getNormal(n),c=x=>{var b;let T=ar(i,o,x);return(b=this.fn(T).normal)!=null?b:[NaN,NaN,NaN]};if(!a||!u)return null;let l=o[0]-i[0],p=o[1]-i[1],f=this.du,d=this.dv,y=(Math.abs(f*l)+Math.abs(d*p))/(l*l+p*p),g=Wy(0,a,1,u,c,.01,2*y,.9);if(g===void 0)return null;if(typeof g=="number")return g<y||g>1-y?null:{type:"high-curvature",pos:this.fn(ar(i,o,g))};let m=g[0],h=g[1];return m<y||h>1-y?null:(m-=y,h+=y,m<=1e-8&&(m=1e-8),h>=1-1e-8&&(h=1-1e-8),{type:"crease",left:this.fn(ar(i,o,m)),right:this.fn(ar(i,o,h))})}isVertexAtCrease(t){let n=this.isVertexAtCreaseCache[t];if(n!==void 0)return n;let r=this._isVertexAtCrease(t);return this.isVertexAtCreaseCache[t]=r,r}finiteAlongEdge(t,n){if(t>n){let a=t;t=n,n=a}let r=n*n+t,s=this.finiteVertices.get(r);if(s!==void 0)return s;let i=this.findFiniteBetweenTwoSamples(t,n);if(i===void 0)return;let o=this.addVertex(i);return this.finiteVertices.set(r,o),o}pushTriangle(t,n,r){this.isDegenerate(t,n,r)||this.triangles.push(t,n,r)}getTriangles(){return this.triangles}},Dq=1e-4,Sq=.99,pd=.9999;function bC(e,t){return!e||!t?!0:e[0]*t[0]+e[1]*t[1]+e[2]*t[2]<Sq}var IC=class extends TC{hintVec(t,n){let r=this.getUV(t),s=this.getUV(n);return zD(HD(s,r),Dq)}hintNormal1(t,n,r){let s=this.hintVec(t,n),i=this.hintVec(t,r);this.normalDirHints[t]=[s,i]}hintNormals2(t,n){let r=this.hintVec(t,n),s=xC(r);this.normalDirHints[t]=[ub(r),s],this.normalDirHints[n]=[s,ub(s)]}hintNormals2Finite(t,n){let r=this.hintVec(t,n),s=ub(r);this.normalDirHints[t]=this.normalDirHints[n]=[s,xC(s)]}hintNormalFirstBad(t,n){let r=this.hintVec(t,n);this.normalDirHints[t]=[ub(r),xC(r)]}hintNormalSecondBad(t,n){let r=this.hintVec(n,t);this.normalDirHints[n]=[Oq(r),vq(r)]}},PC=class extends IC{oneJump(t,n,r,s){let i=s[0],o=s[1];this.pushTriangle(i,r,t),this.pushTriangle(o,n,r),this.hintNormalFirstBad(i,r),this.hintNormalSecondBad(r,o)}oneJumpOneExtra(t,n,r,s,i){let o=s[0],a=s[1];this.pushTriangle(o,r,t),this.pushTriangle(o,i,r),this.pushTriangle(a,n,i),this.hintNormalFirstBad(o,r),this.hintNormalSecondBad(r,a)}oneJumpOneExtra2(t,n,r,s,i){let o=s[0],a=s[1];this.pushTriangle(a,n,r),this.pushTriangle(a,r,i),this.pushTriangle(o,i,t),this.hintNormalFirstBad(o,r),this.hintNormalSecondBad(r,a)}oneJumpTwoExtra(t,n,r,s,i,o){let a=s[0],u=s[1];this.pushTriangle(a,o,t),this.pushTriangle(a,i,o),this.pushTriangle(i,r,o),this.pushTriangle(u,n,i)}twoJumps(t,n,r,s,i){let o=s[0],a=s[1],u=i[0],c=i[1];this.pushTriangle(o,r,t),this.pushTriangle(o,c,r),this.pushTriangle(a,n,u),this.hintNormals2(o,c),this.hintNormals2(u,a)}twoJumpsOneExtraPoint(t,n,r,s,i,o){let a=s[0],u=s[1],c=i[0],l=i[1];this.pushTriangle(a,o,t),this.pushTriangle(a,l,o),this.pushTriangle(l,r,o),this.pushTriangle(u,n,c),this.hintNormals2(a,l),this.hintNormals2(c,u)}oneExtraPoint(t,n,r,s){this.pushTriangle(s,r,t),this.pushTriangle(s,n,r)}oneExtraPointOneVertexCrease(t,n,r,s){let i=this.copyVertex(r);this.pushTriangle(s,i,t),this.pushTriangle(s,n,i),this.hintNormal1(i,t,n)}twoExtraPoints(t,n,r,s,i){this.pushTriangle(s,r,t),this.pushTriangle(s,i,r),this.pushTriangle(s,n,i)}threeExtraPoints(t,n,r,s,i,o){this.pushTriangle(s,o,t),this.pushTriangle(s,i,o),this.pushTriangle(s,n,i),this.pushTriangle(i,r,o)}oneEdgeJumpOneVertexCrease(t,n,r,s){let i=s[0],o=s[1],a=this.copyVertex(r),u=this.copyVertex(r);this.pushTriangle(i,a,t),this.pushTriangle(o,n,u),this.hintNormals2(u,o),this.hintNormals2(i,a)}threeVertexCrease(t,n,r){let s=this.copyVertex(t),i=this.copyVertex(n),o=this.copyVertex(r);this.pushTriangle(s,i,o),this.hintNormals2(s,i),this.hintNormalFirstBad(o,s)}twoVertexCrease(t,n,r){let s=this.copyVertex(t),i=this.copyVertex(n);this.pushTriangle(s,i,r),this.hintNormals2(s,i)}oneVertexCrease(t,n,r){let s=this.copyVertex(t);this.pushTriangle(s,n,r),this.hintNormal1(s,n,r)}pushTrianglesBasedOnJumps(t,n,r){let s=this.jumpAlongEdge(t,n),i=this.jumpAlongEdge(n,r),o=this.jumpAlongEdge(r,t);if(s&&i&&o){let m=this.getUV(t),h=this.getUV(n),x=this.getUV(r),T=this.addVertex(this.fn(ar(m,ar(h,x,.5),1e-4))),b=this.addVertex(this.fn(ar(h,ar(x,m,.5),1e-4))),M=this.addVertex(this.fn(ar(x,ar(m,h,.5),1e-4))),P=this.jumpAlongEdge(T,b),D=this.jumpAlongEdge(b,M),S=this.jumpAlongEdge(M,T);if(P&&D&&S)return;t=T,n=b,r=M,s=P,i=D,o=S}let a=this.getNormal(t),u=this.getNormal(n),c=this.getNormal(r),l=this.isVertexAtCrease(t),p=this.isVertexAtCrease(n),f=this.isVertexAtCrease(r),d,y,g;if(!l&&!p&&!s&&bC(a,u)){let m=this.edgeNormalFeature(t,n);m!==null&&(m.type==="high-curvature"?d=m.pos:s=[m.left,m.right])}if(!p&&!f&&!i&&bC(u,c)){let m=this.edgeNormalFeature(n,r);m!==null&&(m.type==="high-curvature"?y=m.pos:i=[m.left,m.right])}if(!f&&!l&&!o&&bC(c,a)){let m=this.edgeNormalFeature(r,t);m!==null&&(m.type==="high-curvature"?g=m.pos:o=[m.left,m.right])}s&&i?g?this.twoJumpsOneExtraPoint(t,n,r,s,i,g):this.twoJumps(t,n,r,s,i):i&&o?d?this.twoJumpsOneExtraPoint(n,r,t,i,o,d):this.twoJumps(n,r,t,i,o):o&&s?y?this.twoJumpsOneExtraPoint(r,t,n,o,s,y):this.twoJumps(r,t,n,o,s):s?f?this.oneEdgeJumpOneVertexCrease(t,n,r,s):y&&g?this.oneJumpTwoExtra(t,n,r,s,y,g):y?this.oneJumpOneExtra(t,n,r,s,y):g?this.oneJumpOneExtra2(t,n,r,s,g):this.oneJump(t,n,r,s):i?l?this.oneEdgeJumpOneVertexCrease(n,r,t,i):g&&d?this.oneJumpTwoExtra(n,r,t,i,g,d):g?this.oneJumpOneExtra(n,r,t,i,g):d?this.oneJumpOneExtra2(n,r,t,i,d):this.oneJump(n,r,t,i):o?p?this.oneEdgeJumpOneVertexCrease(r,t,n,o):d&&y?this.oneJumpTwoExtra(r,t,n,o,d,y):d?this.oneJumpOneExtra(r,t,n,o,d):y?this.oneJumpOneExtra2(r,t,n,o,y):this.oneJump(r,t,n,o):l&&p&&f?this.threeVertexCrease(t,n,r):l&&p?this.twoVertexCrease(t,n,r):p&&f?this.twoVertexCrease(n,r,t):f&&l?this.twoVertexCrease(r,t,n):l?y?this.oneExtraPointOneVertexCrease(n,r,t,y):this.oneVertexCrease(t,n,r):p?g?this.oneExtraPointOneVertexCrease(r,t,n,g):this.oneVertexCrease(n,r,t):f?d?this.oneExtraPointOneVertexCrease(t,n,r,d):this.oneVertexCrease(r,t,n):d&&y&&g?this.threeExtraPoints(t,n,r,d,y,g):d&&y?this.twoExtraPoints(t,n,r,d,y):y&&g?this.twoExtraPoints(n,r,t,y,g):g&&d?this.twoExtraPoints(r,t,n,g,d):d?this.oneExtraPoint(t,n,r,d):y?this.oneExtraPoint(n,r,t,y):g?this.oneExtraPoint(r,t,n,g):this.pushTriangle(t,n,r)}oneNonFinite(t,n,r){let s=this.finiteAlongEdge(n,r),i=this.finiteAlongEdge(t,r);i!==void 0&&s!==void 0&&(this.pushTrianglesBasedOnJumps(s,t,n),this.pushTrianglesBasedOnJumps(s,i,t),this.hintNormals2Finite(s,i))}twoNonFinite(t,n,r){let s=this.finiteAlongEdge(t,n),i=this.finiteAlongEdge(t,r);s!==void 0&&i!==void 0&&(this.pushTrianglesBasedOnJumps(t,s,i),this.hintNormals2Finite(s,i))}pushTriangles(t,n,r){let s=this.allowVertex(t),i=this.allowVertex(n),o=this.allowVertex(r);s&&i&&o?this.pushTrianglesBasedOnJumps(t,n,r):s&&i?this.oneNonFinite(t,n,r):i&&o?this.oneNonFinite(n,r,t):o&&s?this.oneNonFinite(r,t,n):s?this.twoNonFinite(t,n,r):i?this.twoNonFinite(n,r,t):o&&this.twoNonFinite(r,t,n)}},ld=class extends PC{triangulate(){let t=this.resolution,{uRange:n,vRange:r,fn:s}=this,i=[n.min,r.min],o=[n.max,r.max],a=t-1,u=new Array(t*t);u[0]=this.addVertex(s(i));for(let c=1;c<=a;c++)u[c]=this.addVertex(s(Xy(i,o,[c/a,0]))),u[t*c]=this.addVertex(s(Xy(i,o,[0,c/a])));for(let c=1;c<=a;c++)for(let l=1;l<=a;l++){let p=u[(l-1)*t+(c-1)],f=u[l*t+(c-1)],d=u[(l-1)*t+c],y=this.addVertex(s(Xy(i,o,[c/a,l/a])));u[l*t+c]=y,(c+l)%2===0?(this.pushTriangles(p,y,f),this.pushTriangles(p,d,y)):(this.pushTriangles(p,d,f),this.pushTriangles(d,y,f))}return{triangles:this.getTriangles(),normalDirHints:this.normalDirHints}}};function vq(e){let t=e[0]*Math.SQRT1_2,n=e[1]*Math.SQRT1_2;return[t+n,n-t]}function ub(e){let t=e[0]*Math.SQRT1_2,n=e[1]*Math.SQRT1_2;return[t-n,t+n]}function Oq(e){return[e[1],-e[0]]}function xC(e){return[-e[1],e[0]]}var qe=class{constructor(t,n){this.min=t;this.max=n}get width(){return this.max-this.min}};var EC=class extends ld{constructor(n,r,s,i,o,a=[0,1,2]){let u=r.width/1e8,c=s.width/1e8;super({resolution:o,uRange:r,vRange:s,du:u,dv:c,extraAttrCount:0});this.vertices=[];this.fn=n=>{let r=this._fn(n),s=this.tangentInForcedDf(n,[this.du,0],r),i=this.tangentInForcedDf(n,[0,this.dv],r),o=Kl([this.du,0,s],[0,this.dv,i]);return{uv:n,f:r,normal:[o[this.perm0],o[this.perm1],o[this.perm2]],dfEast:s,dfNorth:i}};this._fn=l=>n(l[0],l[1]),this.paddedOutputDomain=new qe(i.min-5*i.width,i.max+5*i.width),this.jumpTolerance=i.width/1e3,this.perm0=a[0],this.perm1=a[1],this.perm2=a[2]}getVertexCount(){return this.vertices.length}getUV(n){return this.vertices[n].uv}getNormal(n){return this.vertices[n].normal}_addVertex(n){return this.vertices.push(n)-1}copyVertex(n){return this.addVertex(this.vertices[n])}getF(n){return this.vertices[n].f}getDfNorth(n){return this.vertices[n].dfNorth}getDfEast(n){return this.vertices[n].dfEast}tangentInForcedDf(n,r,s){let i=cf(n,r);return this._fn(i)-s}tangentInForced(n,r,s){let i=cf(n,r);return[r[0],r[1],this._fn(i)-s]}getExtraAttr(){throw new Error("Unexpected getExtraAttr call in explicit-surface.ts")}_isVertexAtCrease(n){let r=this.getUV(n),s=this.getDfEast(n),i=this.getDfNorth(n),o=this.getF(n),a=this.tangentInForcedDf(r,[-this.du,0],o);if((-this.duSquared+a*s)/Math.sqrt((this.duSquared+a*a)*(this.duSquared+s*s))>-pd)return!0;let l=this.tangentInForcedDf(r,[0,-this.dv],o);return(-this.dvSquared+i*l)/Math.sqrt((this.dvSquared+i*i)*(this.dvSquared+l*l))>-pd}hintedNormal(n,r){let s=this.getUV(n),i=this.getF(n),o=Kl(this.tangentInForced(s,r[0],i),this.tangentInForced(s,r[1],i));return ep(...o)?[o[this.perm0],o[this.perm1],o[this.perm2]]:this.getNormal(n)}getVertex(n){if(!this.allowVertex(n))return;let r=this.getF(n),s=this.getUV(n);return[this.perm0===2?r:s[this.perm0],this.perm1===2?r:s[this.perm1],this.perm2===2?r:s[this.perm2]]}findJumpBetweenTwoSamples(n,r){let s=this.getUV(n),i=this.getF(n),o=0,a=this.getUV(r),u=this.getF(r),c=1,l=f=>this._fn(ar(s,a,f));if(!isFinite(i)||!isFinite(u))return;let p=eS(o,i,c,u,l,this.jumpTolerance);if(p)return[this.fn(ar(s,a,wi(p[0],0,1e-5))),this.fn(ar(s,a,wi(p[1],1,1e-5)))]}findFiniteBetweenTwoSamples(n,r){let s=this.getUV(n),i=this.getF(n),o=this.getUV(r),a=this.getF(r),u=p=>{let f=this._fn(p);return f<this.paddedOutputDomain.min||f>this.paddedOutputDomain.max?NaN:f},c=p=>u(ar(s,o,p)),l=xs(0,this.paddedOutputDomain.min<i&&i<this.paddedOutputDomain.max?i:NaN,1,this.paddedOutputDomain.min<a&&a<this.paddedOutputDomain.max?a:NaN,c);if(l!==void 0)return this.fn(ar(s,o,l))}allowVertex(n){let r=this.getF(n);return this.paddedOutputDomain.min<r&&r<this.paddedOutputDomain.max}isDegenerate(n,r,s){let i=this.getUV(n),o=this.getUV(r),a=this.getUV(s),u=this.uRange.width*1e-6,c=this.vRange.width*1e-6;return Math.abs(i[0]-o[0])<u&&Math.abs(i[1]-o[1])<c||Math.abs(o[0]-a[0])<u&&Math.abs(o[1]-a[1])<c||Math.abs(a[0]-i[0])<u&&Math.abs(a[1]-i[1])<c}};function lb(e,t,n,r,s,i=[0,1,2]){let o=new EC(e,t,n,r,s,i);return cb(o)}var $i=class{constructor(t){this.xtolerance=t.xtolerance||t.tolerance||0,this.ytolerance=t.ytolerance||t.tolerance||0,this.ztolerance=t.ztolerance||t.tolerance||0,this.map=t.map,this.segments=[],this.segment=[],this.pivotPoint=void 0,this.pendingPoint=void 0}colinear(t,n,r){let s=this.map(t),i=this.map(n),o=this.map(r),a=to(o[0],o[1],o[2]||0,s[0],s[1],s[2]||0,i[0],i[1],i[2]||0);if(a<1)return!1;let u=[s[0]+a*(i[0]-s[0]),s[1]+a*(i[1]-s[1]),s.length===3?s[2]+a*(i[2]-s[2]):0];return Math.abs(o[0]-u[0])<=this.xtolerance&&Math.abs(o[1]-u[1])<=this.ytolerance&&(s.length===2||Math.abs(o[2]-u[2])<=this.ztolerance)}addPoint(t){if(this.dimensions=t.length,this.xtolerance<0&&this.ytolerance<0&&(this.dimensions===2||this.ztolerance<0)){this.segment.push.apply(this.segment,t);return}if(!this.segment.length){this.segment.push.apply(this.segment,t);return}let n=this.dimensions===2?[this.segment[this.segment.length-2],this.segment[this.segment.length-1]]:[this.segment[this.segment.length-3],this.segment[this.segment.length-2],this.segment[this.segment.length-1]];if(!(t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2])){if(!this.pivotPoint||!this.pendingPoint){this.pivotPoint=t,this.pendingPoint=t;return}(!this.colinear(n,this.pivotPoint,t)||Oi(n[0]-t[0],n[1]-t[1],(n[2]||0)-(t[2]||0))<Oi(n[0]-this.pendingPoint[0],n[1]-this.pendingPoint[1],(n[2]||0)-(this.pendingPoint[2]||0)))&&(this.flushPending(),this.pivotPoint=t),this.pendingPoint=t}}flushPending(){this.pendingPoint&&(this.segment.push.apply(this.segment,this.pendingPoint),this.pivotPoint=void 0,this.pendingPoint=void 0)}breakSegment(){this.flushPending(),this.segment.length>(this.dimensions||2)&&this.segments.push(this.segment),this.segment=[]}getSegments(){return this.breakSegment(),this.segments}finish(){return{segments:this.getSegments(),resolved:!0}}};var fL=5,Nq=Math.pow(2,14),{abs:ho}=Math;function hm(e,t){let n=Rq(e,t);return{segments:n.contours.strokeSegments,fillSegments:n.contours.fillSegments,resolved:n.quadTree.resolved}}function Rq(e,t){let n=Math.pow(2,-fL),r=dL(t,n),s=dL(t,2*n),i=Aq(e,r,s),o=Gq(i.root,e,r),a=qq(o,e,r);return{paddedDomain:r,rootDomain:s,quadTree:i,triangles:o,contours:a}}function fd(e,t,n){return{x:e,y:t,z:n}}function Ku(e,t,n){return{x:e,y:t,isZero:n}}function pb(e,t,n){return{vertices:[e,t,n],visited:!1,next:void 0}}function dL(e,t){let{mathToPixels:n}=e,r=n.interpolateX(e.xmin,e.xmax,-t),s=n.interpolateX(e.xmax,e.xmin,-t),i=n.interpolateY(e.ymin,e.ymax,-t),o=n.interpolateY(e.ymax,e.ymin,-t);return{...e,xmin:r,ymin:i,xmax:s,ymax:o}}function mm(e,t){return{depth:e,vertices:t,children:void 0,center:void 0}}function MC(e,t,n){e.center=mL(e.vertices[0],e.vertices[1],e.vertices[2],e.vertices[3],t,n)}function Aq(e,t,n){let r=_q(e,n),s=[],i=[];i.push(r);let o=1,a=!0;e:for(;i.length;){let u=s;s=i,i=u;let c;for(;c=s.pop();)if(wq(c,e,t)){if(Lq(c,e,t),!c.children){a=!1;break e}if(i.push(c.children[0]),i.push(c.children[1]),i.push(c.children[2]),i.push(c.children[3]),o+=3,o>=Nq){a=!1;break e}}else MC(c,e,t)}for(let u=0;u<s.length;u++)MC(s[u],e,t);for(let u=0;u<i.length;u++)MC(i[u],e,t);return{root:r,resolved:a}}function _q(e,t){let n=t.xmin,r=t.xmax,s=t.ymin,i=t.ymax;return mm(0,[dd(n,i,e),dd(r,i,e),dd(r,s,e),dd(n,s,e)])}function Lq(e,t,n){let r=e.depth+1,s=e.vertices[0],i=e.vertices[1],o=e.vertices[2],a=e.vertices[3],u=Os(s,i,t,n),c=Os(i,o,t,n),l=Os(o,a,t,n),p=Os(a,s,t,n),f=Os(s,o,t,n);e.children=[mm(r,[s,u,f,p]),mm(r,[u,i,c,f]),mm(r,[f,c,o,l]),mm(r,[p,f,l,a])]}function wq(e,t,n){if(e.depth<fL)return!0;if(Vq(e,n)||Fq(e,n))return!1;let r=e.vertices[0],s=e.vertices[1],i=e.vertices[2],o=e.vertices[3];if(isNaN(r.z)&&isNaN(s.z)&&isNaN(i.z)&&isNaN(o.z))return!1;if(isNaN(r.z)||isNaN(s.z)||isNaN(i.z)||isNaN(o.z))return!0;let a=mL(r,s,i,o,t,n),u=Na(r,s,t,n),c=Na(s,i,t,n),l=Na(i,o,t,n),p=Na(o,r,t,n);return tc(r,u,t,n)||tc(s,u,t,n)||tc(s,c,t,n)||tc(i,c,t,n)||tc(i,l,t,n)||tc(o,l,t,n)||tc(o,p,t,n)||tc(r,p,t,n)||ec(r,u,a,t,n)||ec(u,s,a,t,n)||ec(s,c,a,t,n)||ec(c,i,a,t,n)||ec(i,l,a,t,n)||ec(l,o,a,t,n)||ec(o,p,a,t,n)||ec(p,r,a,t,n)}function ec(e,t,n,r,s){if(e.z>0==t.z>0&&t.z>0==n.z>0)return!1;let i=0;isFinite(e.z)&&(i=Math.max(i,Math.abs(e.z))),isFinite(t.z)&&(i=Math.max(i,Math.abs(t.z))),isFinite(n.z)&&(i=Math.max(i,Math.abs(n.z)));let o=32*Number.EPSILON*i,a,u,c,l;if(e.z>0==t.z>0){if(a=Os(e,t,r,s),a.z>0!=e.z>0)return!0;u=Oa(e,n,r,s,o),c=Oa(t,n,r,s,o),l=Oa(a,n,r,s,o)}else if(t.z>0==n.z>0){if(a=Os(t,n,r,s),a.z>0!=t.z>0)return!0;u=Oa(t,e,r,s,o),c=Oa(n,e,r,s,o),l=Oa(a,e,r,s,o)}else{if(a=Os(n,e,r,s),a.z>0!=n.z>0)return!0;u=Oa(n,t,r,s,o),c=Oa(e,t,r,s,o),l=Oa(a,t,r,s,o)}let{mathToPixels:p,map3d:f}=s;if(f){let d=f(l.x,l.y),y=f(u.x,u.y),g=f(c.x,c.y);return J1(d[0],d[1],d[2],y[0],y[1],y[2],g[0],g[1],g[2])>s.tolerance}else{let[d,y]=p.mapCoordinatePair([l.x,l.y]),[g,m]=p.mapCoordinatePair([u.x,u.y]),[h,x]=p.mapCoordinatePair([c.x,c.y]);return j1(d,y,g,m,h,x)>s.tolerance}}function tc(e,t,n,r){if(isNaN(e.z)&&isNaN(t.z))return!1;if(isNaN(e.z)||isNaN(t.z))return e.z>0||t.z>0;let i=4*Os(e,t,n,r).z-t.z-3*e.z,o=1e-4,a=(n((1-o)*e.x+o*t.x,(1-o)*e.y+o*t.y)-e.z)/o,u=Math.max(Math.abs(e.z),Math.abs(t.z));return Math.abs(i-a)>.125*u}function Fq(e,t){let{mathToPixels:n,map3d:r,tolerance:s}=t;if(r)return!1;{let[i,o]=n.mapCoordinatePair([e.vertices[1].x,e.vertices[1].y]),[a,u]=n.mapCoordinatePair([e.vertices[0].x,e.vertices[0].y]),[c,l]=n.mapCoordinatePair([e.vertices[3].x,e.vertices[3].y]);if(ho(i-a)<10*s||ho(u-l)<10*s)return!0}return!1}function Vq(e,t){return e.vertices[0].x<t.xmin||e.vertices[0].y>t.ymax||e.vertices[2].x>t.xmax||e.vertices[2].y<t.ymin}function md(e,t){return e.x<t.xmin||e.x>t.xmax||e.y<t.ymin||e.y>t.ymax}function dd(e,t,n){return fd(e,t,n(e,t))}function Os(e,t,n,r){let{mathToPixels:s}=r;return dd(s.interpolateX(e.x,t.x,.5),s.interpolateY(e.y,t.y,.5),n)}function Na(e,t,n,r){if(md(e,r)||md(t,r))return Os(e,t,n,r);if(isNaN(e.z)||isNaN(t.z))return Bq(e,t,n,r);if(e.z>0!=t.z>0)return Os(e,t,n,r);let s=.01,i=n((1-s)*e.x+s*t.x,(1-s)*e.y+s*t.y)-e.z,o=t.z-n(s*e.x+(1-s)*t.x,s*e.y+(1-s)*t.y);return isNaN(i)||isNaN(o)||i>0==o>0?Os(e,t,n,r):yL(fd(e.x,e.y,i),fd(t.x,t.y,o),n,r)}function mL(e,t,n,r,s,i){let o=Na(e,n,s,i);return e.z>0==n.z>0&&o.z>0!=e.z>0||(o=Na(t,r,s,i),t.z>0==r.z>0&&o.z>0!=t.z>0)?o:Os(e,n,s,i)}function yL(e,t,n,r){if(isNaN(e.z))return t;if(isNaN(t.z))return e;if(!isFinite(e.z)&&!isFinite(t.z))return Os(e,t,n,r);if(isFinite(e.z))if(isFinite(t.z)){let s=1-e.z/t.z,i=1-t.z/e.z;return dd(e.x/s+t.x/i,e.y/s+t.y/i,n)}else return e;else return t}function Oa(e,t,n,r,s){let{mathToPixels:i,map3d:o}=r,a=e.x,u=t.x,c=e.y,l=t.y,p=e.z,f=t.z;if(md(e,r)||md(t,r)){let d=Os(e,t,n,r);return Ku(d.x,d.y,!1)}if(o){let[d,y,g]=o(a,c),[m,h,x]=o(u,l);for(;ho(d-m)>r.tolerance||ho(y-h)>r.tolerance||ho(g-x)>r.tolerance;){let T=.5*(a+u),b=.5*(c+l),M=n(T,b);if(M>0==p>0?(a=T,c=b,p=M):(u=T,l=b,f=M),(T===a||T===u)&&(b===c||b===l))break;[d,y,g]=o(a,c),[m,h,x]=o(u,l)}}else{let[d,y]=i.mapCoordinatePair([a,c]),[g,m]=i.mapCoordinatePair([u,l]);for(;ho(d-g)>r.tolerance||ho(y-m)>r.tolerance;){let h=.5*(a+u),x=.5*(c+l),T=n(h,x);T>0==p>0?(a=h,c=x,p=T):(u=h,l=x,f=T),[d,y]=i.mapCoordinatePair([a,c]),[g,m]=i.mapCoordinatePair([u,l])}}if(isNaN(p))return Ku(u,l,!1);if(isNaN(f))return Ku(a,c,!1);{let d=Math.abs(p),y=Math.abs(f);if(d<s&&y>100*s)return 1/d>=y?Ku(a,c,!0):Ku(u,l,!1);if(y<s&&d>100*s)return 1/y>=d?Ku(u,l,!0):Ku(a,c,!1);let g=yL(fd(a,c,p),fd(u,l,f),n,r),m=p===0||f===0||g.z===0||g.z>=p==f>=g.z&&Math.abs(g.z)<1e250;return Ku(g.x,g.y,m)}}function Bq(e,t,n,r){let{mathToPixels:s,map3d:i}=r;if(isNaN(e.z)===isNaN(t.z))return Os(e,t,n,r);if(isNaN(e.z)){let p=e;e=t,t=p}let o=e.x,a=t.x,u=e.y,c=t.y,l=e.z;if(i){let[p,f,d]=i(o,u),[y,g,m]=i(a,c);for(;ho(p-y)>r.tolerance||ho(f-g)>r.tolerance||ho(d-m)>r.tolerance||isNaN(p)||isNaN(y);){let h=.5*(o+a),x=.5*(u+c),T=n(h,x);if(isNaN(T)===isNaN(l)?(o=h,u=x,l=T):(a=h,c=x),(h===o||h===a)&&(x===u||x===c))break;[p,f,d]=i(o,u),[y,g,m]=i(a,c)}}else{let[p,f]=s.mapCoordinatePair([o,u]),[d,y]=s.mapCoordinatePair([a,c]);for(;ho(p-d)>r.tolerance||ho(f-y)>r.tolerance;){let g=.5*(o+a),m=.5*(u+c),h=n(g,m);isNaN(h)===isNaN(l)?(o=g,u=m,l=h):(a=g,c=m),[p,f]=s.mapCoordinatePair([o,u]),[d,y]=s.mapCoordinatePair([a,c])}}return fd(o,u,l)}function Gq(e,t,n){let r={triangles:[],edgeCache:{},domain:n,fn:t};return ym(e,r),r.triangles}function ym(e,t){e.children&&(ym(e.children[0],t),ym(e.children[1],t),ym(e.children[2],t),ym(e.children[3],t),nc(e.children[0],e.children[1],t),nc(e.children[3],e.children[2],t),rc(e.children[1],e.children[2],t),rc(e.children[0],e.children[3],t))}function nc(e,t,n){e.children&&t.children?(nc(e.children[1],t.children[0],n),nc(e.children[2],t.children[3],n)):e.children?(nc(e.children[1],t,n),nc(e.children[2],t,n)):t.children?(nc(e,t.children[0],n),nc(e,t.children[3],n)):kq(e,t,n)}function rc(e,t,n){e.children&&t.children?(rc(e.children[2],t.children[1],n),rc(e.children[3],t.children[0],n)):e.children?(rc(e.children[2],t,n),rc(e.children[3],t,n)):t.children?(rc(e,t.children[1],n),rc(e,t.children[0],n)):Hq(e,t,n)}function kq(e,t,n){if(!e.center||!t.center)return;let r,s;e.depth>=t.depth?(r=Na(e.vertices[1],e.vertices[2],n.fn,n.domain),s=mb(e.vertices[1],t.center,e.vertices[2],e.center,r)):(r=Na(t.vertices[0],t.vertices[3],n.fn,n.domain),s=mb(t.vertices[0],t.center,t.vertices[3],e.center,r)),gL(s,n.edgeCache,n.domain);for(let i=0;i<4;i++)n.triangles.push(s[i])}function Hq(e,t,n){if(!e.center||!t.center)return;let r,s;e.depth>=t.depth?(r=Na(e.vertices[3],e.vertices[2],n.fn,n.domain),s=mb(e.vertices[2],t.center,e.vertices[3],e.center,r)):(r=Na(t.vertices[1],t.vertices[0],n.fn,n.domain),s=mb(t.vertices[1],t.center,t.vertices[0],e.center,r)),gL(s,n.edgeCache,n.domain);for(let i=0;i<4;i++)n.triangles.push(s[i])}function mb(e,t,n,r,s){return[pb(e,s,t),pb(t,s,n),pb(n,s,r),pb(r,s,e)]}function gm(e,t,n){return e.z>0&&!md(e,n)&&(!(t.z>0)||md(t,n))}function db(e,t){return""+e.x+","+e.y+","+t.x+","+t.y}function gL(e,t,n){fb(e[0],e[1],e[2],db(e[1].vertices[2],e[1].vertices[0]),t,n),fb(e[1],e[2],e[3],db(e[2].vertices[0],e[2].vertices[2]),t,n),fb(e[2],e[3],e[0],db(e[3].vertices[2],e[3].vertices[0]),t,n),fb(e[3],e[0],e[1],db(e[0].vertices[0],e[0].vertices[2]),t,n)}function fb(e,t,n,r,s,i){let o=t.vertices[0],a=t.vertices[1],u=t.vertices[2];gm(a,u,i)&&(t.next=n),gm(o,a,i)&&(t.next=e),gm(u,o,i)&&Uq(t,r,s),gm(o,u,i)&&zq(t,r,s)}function zq(e,t,n){n[t]?n[t].next=e:n[t]=e}function Uq(e,t,n){n[t]?e.next=n[t]:n[t]=e}function qq(e,t,n){let{tolerance:r,mathToPixels:s,map3d:i}=n,o;if(i){let a={tolerance:r,map:u=>i(u[0],u[1])};o={fillAccumulator:new $i(a),strokeAccumulator:new $i(a),fn:t,domain:n}}else{let a={tolerance:r,map:u=>s.mapCoordinatePair(u)};o={fillAccumulator:new $i(a),strokeAccumulator:new $i(a),fn:t,domain:n}}for(let a=0;a<e.length;a++){let u=e[a];u.next&&!u.visited&&$q(u,o)}return{strokeSegments:o.strokeAccumulator.finish().segments,fillSegments:o.fillAccumulator.finish().segments}}function $q(e,t){for(;;){let n=e.vertices[0],r=e.vertices[1],s=e.vertices[2],i=0;isFinite(n.z)&&(i=Math.max(i,Math.abs(n.z))),isFinite(r.z)&&(i=Math.max(i,Math.abs(r.z))),isFinite(s.z)&&(i=Math.max(i,Math.abs(s.z)));let o=32*Number.EPSILON*i;if(CC(n,r,t,o),CC(r,s,t,o),CC(s,n,t,o),e.visited||!e.next)break;e.visited=!0,e=e.next}t.strokeAccumulator.breakSegment(),t.fillAccumulator.breakSegment()}function CC(e,t,n,r){if(gm(e,t,n.domain)){let s=Oa(e,t,n.fn,n.domain,r);n.fillAccumulator.addPoint([s.x,s.y]),s.isZero?n.strokeAccumulator.addPoint([s.x,s.y]):n.strokeAccumulator.breakSegment()}}function DC(e,t){return{type:"linear",s:e,t}}function hL(e,t){return{type:"logarithmic",s:e,t}}function bL(e,t){return{type:"exponential",s:e,t}}function SC(){return DC(1,0)}function Yq([e,t],[n,r]){let s=(r-n)/(t-e),i=(n+r)/2-s*(t+e)/2;return DC(s,i)}function Xq([e,t],[n,r]){let s=(r-n)/(Math.log(t)-Math.log(e)),i=(Math.log(t)*n-Math.log(e)*r)/(Math.log(t)-Math.log(e));return hL(s,i)}function Zq([e,t],[n,r]){let s=(Math.log(r)-Math.log(n))/(t-e),i=(t*Math.log(n)-e*Math.log(r))/(t-e);return bL(s,i)}function vC(e,t,n){switch(e){case"linear":return Yq(t,n);case"logarithmic":return Xq(t,n);case"exponential":return Zq(t,n);default:{let r=e;throw new Error("Unexpected scale type: "+r)}}}function OC({type:e,s:t,t:n},r){switch(e){case"linear":return t*r+n;case"logarithmic":return t*Math.log(r)+n;case"exponential":return Math.exp(t*r+n);default:let s=e;throw new Error("Unexpected scale type: "+s)}}function NC(e,t,n,r){switch(e){case"linear":return Wq(t,n,r);case"logarithmic":return Math.pow(t,1-r)*Math.pow(n,r);case"exponential":return r===0?t:r===1?n:Math.log((1-r)*Math.exp(t)+r*Math.exp(n));default:let s=e;throw new Error("Unexpected scale type: "+s)}}function Wq(e,t,n){return(1-n)*e+n*t}function RC({type:e,s:t,t:n}){switch(e){case"linear":return DC(1/t,-n/t);case"logarithmic":return bL(1/t,-n/t);case"exponential":return hL(1/t,-n/t);default:let r=e;throw new Error("Unexpected scale type: "+r)}}function AC(e){switch(e){case"linear":return"linear";case"logarithmic":return"exponential";case"exponential":return"logarithmic";default:let t=e;throw new Error("Unexpected scale type: "+t)}}function yb({width:e,height:t}){return{left:0,right:e,top:0,bottom:t}}function gb({xmin:e,xmax:t,ymin:n,ymax:r}){return{left:e,right:t,bottom:n,top:r}}var sc=class e{constructor(t,n){this.xScale=t,this.yScale=n}static fromRects(t,n,{xAxisScale:r,yAxisScale:s}){return new e(vC(r,[t.left,t.right],[n.left,n.right]),vC(s,[t.bottom,t.top],[n.bottom,n.top]))}static fromRectsInverse(t,n,{xAxisScale:r,yAxisScale:s}){return e.fromRects(n,t,{xAxisScale:AC(r),yAxisScale:AC(s)})}inverse(){return new e(RC(this.xScale),RC(this.yScale))}mapX(t){return OC(this.xScale,t)}mapY(t){return OC(this.yScale,t)}mapPoint({x:t,y:n}){return{x:this.mapX(t),y:this.mapY(n)}}mapCoordinatePair([t,n]){return[this.mapX(t),this.mapY(n)]}mapRect({top:t,bottom:n,left:r,right:s}){return{left:this.mapX(r),right:this.mapX(s),bottom:this.mapY(n),top:this.mapY(t)}}interpolateX(t,n,r){return NC(this.xScale.type,t,n,r)}interpolateY(t,n,r){return NC(this.yScale.type,t,n,r)}dangerouslyGetXScaleFactor(){if(this.xScale.type!=="linear")throw new Error(`Cannot get scale factor a \'${this.xScale.type}\' scale`);return this.xScale.s}dangerouslyGetYScaleFactor(){if(this.yScale.type!=="linear")throw new Error(`Cannot get scale factor a \'${this.yScale.type}\' scale`);return this.yScale.s}};function hb(e,t,n,r){let s=[],i=[],o=[],a=[],{xmin:u,xmax:c,ymin:l,ymax:p,zmin:f,zmax:d}=n,y,g,m;switch(r){case"z":y={xmin:u,xmax:c,ymin:l,ymax:p},g=(b,M)=>[b[M],b[M+1],f,b[M],b[M+1],d],m=(b,M)=>e(b,M,0);break;case"y":y={xmin:u,xmax:c,ymin:f,ymax:d},g=(b,M)=>[b[M],l,b[M+1],b[M],p,b[M+1]],m=(b,M)=>e(b,0,M);break;case"x":y={xmin:f,xmax:d,ymin:l,ymax:p},g=(b,M)=>[u,b[M+1],b[M],c,b[M+1],b[M]],m=(b,M)=>e(0,M,b);break}let h=yb({width:500,height:500}),x={...y,mathToPixels:sc.fromRects(gb(y),h,{xAxisScale:"linear",yAxisScale:"linear"}),tolerance:bo},T=hm(m,x);for(let b of T.segments)for(let M=0;M<b.length/2;M++){let[P,D,S,O,_,L]=g(b,2*M);if(s.push(P,D,S,O,_,L),o.push(P,D,O,_),t){let w=t(P,D,S),G=t(O,_,L);i.push(w[0],w[1],w[2]),i.push(G[0],G[1],G[2])}else i.push(0,0,0),i.push(0,0,0);if(M>0){let w=s.length/3-4;a.push(w,w+1,w+2),a.push(w+2,w+1,w+3)}}return cd(a,s,i,o,0,[],.7),{positions:s,normals:i,faces:a,uvs:o,resolved:T.resolved,extraAttrs:[]}}var bb=[[1,2,4,21,20,18],[0,1,3,20,19,18],[2,6,7,25,21,18],[5,6,8,25,22,18],[5,9,11,23,22,18],[0,9,10,23,19,18],[10,12,14,24,23,19],[3,12,13,24,20,19],[4,13,15,24,21,20],[15,7,16,25,24,21],[11,17,14,24,23,22],[17,8,16,25,24,22]],zr=[0,1,0,2,0,3,1,2,2,3,0,4,0,7,3,7,4,7,0,5,1,5,4,5,1,6,2,6,5,6,3,6,6,7,4,6,0,8,1,8,2,8,3,8,4,8,5,8,6,8,7,8],TL=[[0,2,3,8],[0,1,2,8],[0,3,7,8],[0,4,7,8],[0,4,5,8],[0,1,5,8],[1,5,6,8],[1,2,6,8],[2,3,6,8],[3,6,7,8],[4,5,6,8],[4,6,7,8]],IL=[[0,0,0],[0,1,0],[1,1,0],[1,0,0],[0,0,1],[0,1,1],[1,1,1],[1,0,1],[.5,.5,.5]],_C=[[1,2,4],[4,20,21],[2,18,21],[1,18,20],[0,1,3],[3,19,20],[0,18,19],[2,6,7],[7,21,25],[6,18,25],[5,6,8],[8,22,25],[5,18,22],[5,9,11],[11,22,23],[9,18,23],[0,9,10],[10,19,23],[10,12,14],[14,23,24],[12,19,24],[3,12,13],[13,20,24],[4,13,15],[15,21,24],[15,7,16],[16,24,25],[11,17,14],[17,22,24],[17,8,16]],LC=[];for(let e=0;e<30;e++){let t=_C[e],n=new Set;for(let r of t)n.add(zr[r*2]),n.add(zr[r*2+1]);LC[e]=[...n]}var PL=[[0,3,2,1],[4,6,3,5],[7,2,9,8],[10,12,9,11],[13,12,15,14],[16,6,15,17],[18,17,20,19],[21,5,20,22],[23,1,22,24],[25,24,8,26],[27,14,28,19],[29,28,11,26]],Jq=1<<31,Qq=1<<30,xL=1<<24,Pl=1<<24,Yi=1<<24,xo=65536,To=256,Io=1;function EL(e,t,n){return n*xo+t*To+e*Io}var Kq={0:0*xL,1:To,2:Io+To,3:Io,4:xo,5:To+xo,6:Io+To+xo,7:Io+xo,8:8*xL};function ML(e,t){return Jq+e+Kq[t]}var e8={3:2*Yi+To,4:0*Yi+Io,7:5*Yi+Io,8:2*Yi+xo,10:5*Yi+To,11:0*Yi+xo,12:6*Yi+To,13:5*Yi+Io+To,14:2*Yi+To+xo,15:9*Yi+Io,16:0*Yi+Io+xo,17:1*Yi+xo};function bm(e,t){var n;return Qq+e+((n=e8[t])!=null?n:Yi*t)}var t8={18:10*Pl+To,21:7*Pl+To,23:16*Pl+Io,25:13*Pl+Io,27:4*Pl+xo,29:0*Pl+xo};function wC(e,t){var n;return e+((n=t8[t])!=null?n:Pl*t)}var yd=class{constructor(t,n,r,s,i){this.PAConstructor=t;this.x=n;this.y=r;this.z=s;this.gridsize=i;this.i=0;this.j=0;this.k=0;this.cubeVertex=new Array(9);this.cubeVertexValue=new this.PAConstructor(9);if(i>250)throw new Error("Programming Error: resolution should be clamped well below 250.");this.size=new st(this.x.width/i,this.y.width/i,this.z.width/i)}loopOverUnitCubes(t){let n=this.gridsize,r=n+1,s=new xb(this.x.min,this.y.min,this.z.min,this.size.x,this.size.y,this.size.z,n+1,n+1,n+1),i=new xb(this.x.min+this.size.x/2,this.y.min+this.size.y/2,this.z.min+this.size.z/2,this.size.x,this.size.y,this.size.z,n,n,n),o=s.setupArray(this.PAConstructor),a=s.setupArray(this.PAConstructor),u=i.setupArray(this.PAConstructor);this.evaluateArray(a,s,0);for(let c=0;c<n;c++){this.k=c,[o,a]=[a,o],this.evaluateArray(a,s,c+1),this.evaluateArray(u,i,c);for(let l=0;l<n;l++){this.j=l;for(let p=0;p<n;p++){this.i=p;let f=l*r+p;this.cubeVertexValue.setFrom(0,o,f),this.cubeVertexValue.setFrom(1,o,f+r),this.cubeVertexValue.setFrom(2,o,f+r+1),this.cubeVertexValue.setFrom(3,o,f+1),this.cubeVertexValue.setFrom(4,a,f),this.cubeVertexValue.setFrom(5,a,f+r),this.cubeVertexValue.setFrom(6,a,f+r+1),this.cubeVertexValue.setFrom(7,a,f+1),this.cubeVertexValue.setFrom(8,u,l*n+p),t()}}}}evaluateArray(t,n,r){let s=n.z0+r*n.dz;for(let i=0;i<n.numX;i++)for(let o=0;o<n.numY;o++){let a=n.x0+i*n.dx,u=n.y0+o*n.dy;this.setAt(t,o*n.numX+i,a,u,s)}}setVertexPositions(){for(let t=0;t<9;t++){let n=IL[t];this.cubeVertex[t]=[this.x.min+(this.i+n[0])*this.size.x,this.y.min+(this.j+n[1])*this.size.y,this.z.min+(this.k+n[2])*this.size.z]}}},xb=class{constructor(t,n,r,s,i,o,a,u,c){this.x0=t;this.y0=n;this.z0=r;this.dx=s;this.dy=i;this.dz=o;this.numX=a;this.numY=u;this.numZ=c}setupArray(t){return new t(this.numX*this.numY)}};var Tb=class{constructor(t){this.length=t;this.n=1;this.buffer=new Float64Array(t)}set(t,n){this.buffer[t]=n}get(t){return this.buffer[t]}setFrom(t,n,r){if(n.n!==this.n)throw new Error("Programming Error: Mismatched dimensions");this.set(t,n.get(r))}},Ib=class{constructor(t){this.length=t;this.n=2;this.buffer=new Float64Array(t*2)}set(t,n,r){this.buffer[t*2]=n,this.buffer[t*2+1]=r}getX(t){return this.buffer[t*2]}getY(t){return this.buffer[t*2+1]}setFrom(t,n,r){if(n.n!==this.n)throw new Error("Programming Error: Mismatched dimensions");this.set(t,n.getX(r),n.getY(r))}};function xm(e,t,n,r,s,i=100){if(isFinite(r)||([r,s]=[s,r],[t,n]=[n,t]),isFinite(s))return FC(e,t,n,r,s,i);for(;;){let o=Fi(t,n,.5),a=e(...o);if(a===0)return o;if(!isFinite(a))n=o,s=a;else if(r<0==a<0)t=o,r=a;else return n=o,s=a,FC(e,t,n,r,s,i);if(i*=.5,i<1)return}}function CL(e,t,n,r,s,i=100){if(isFinite(r)||([r,s]=[s,r],[t,n]=[n,t]),!isFinite(s))for(;;){let o=Fi(t,n,.5),a=e(...o);if(a===0)return{posNeg:o};if(!isFinite(a))n=o,s=a;else if(r<0==a<0)t=o,r=a;else if(r>0){n=o,s=a;break}else return{posNeg:VC(e,o,t,a,r,i),posNaN:n8(e,o,n,i)};if(i*=.5,i<1){let u=Fi(t,n,.5);return r>0?{posNaN:u}:{}}}return{posNeg:FC(e,t,n,r,s,i)}}function FC(e,t,n,r,s,i){return r>0?VC(e,t,n,r,s,i):VC(e,n,t,s,r,i)}function VC(e,t,n,r,s,i){let o=r-s;for(;;){let a=Fi(t,n,.5),u=e(...a);if(u<0)n=a,s=u;else if(u>0)t=a,r=u;else return u===0?a:void 0;if(i*=.5,i<1){if(r-s<.1*o)return Fi(t,n,.5);if(i<1e-6)return}}}function n8(e,t,n,r){for(;;){let s=Fi(t,n,.5),i=e(...s);if(!isFinite(i))n=s;else if(i>=0)t=s;else return;if(r*=.5,r<1)return Fi(t,n,.5)}}var Im=50;function El(e){return e!==void 0&&e!==0}function r8(e){return El(e.posNeg)||El(e.posNaN)}var Tm={};function BC(e=Tm,t=Tm,n=Tm){return{edge0:e,edge1:t,edge2:n}}function DL(e,t,n,r,{isInequality:s}){return new GC(e,t,new qe(n.xmin,n.xmax),new qe(n.ymin,n.ymax),new qe(n.zmin,n.zmax),r,{isInequality:s}).fullLoopOverUnitCubes()}var GC=class extends yd{constructor(n,r,s,i,o,a,{isInequality:u}){super(Tb,s,i,o,a);this.f=n;this.gradient=r;this.cubeEdge=new Array(26);this.face=BC();this.cubeHasCrossing=!1;this.allNormalsFromGradient=!0;this.normalFromGradient=[];this.edgesMaybeCross=0;this.positions=[];this.uvs=[];this.normals=[];this.triangles=[];this.isInequality=u,this.sheet=Array((a+1)*(a+1)),this.strip=Array(a+1);for(let c=0;c<(a+1)*(a+1);c++)this.sheet[c]=BC();for(let c=0;c<a+1;c++)this.strip[c]=BC()}setAt(n,r,s,i,o){let a=this.f(s,i,o);n.set(r,a)}fullLoopOverUnitCubes(){this.positions=[],this.normals=[],this.triangles=[],this.loopOverUnitCubes(this.onEachCube.bind(this));let{uvs:n,positions:r,normals:s}=this;if(!this.allNormalsFromGradient)for(let i=0;i<s.length/3;i++){if(this.normalFromGradient[i])continue;let o=s[3*i],a=s[3*i+1],u=s[3*i+2],c=Math.sqrt(o*o+a*a+u*u);s[3*i]=o/c,s[3*i+1]=a/c,s[3*i+2]=u/c}return cd(this.triangles,this.positions,s,n,0,[],.7),{positions:r,normals:s,faces:this.triangles,uvs:n,resolved:!0,extraAttrs:[]}}onEachCube(){this.edgesMaybeCross=0,this.cubeHasCrossing=!1;for(let n=0;n<26;n++){let r=this.cubeVertexValue.get(zr[n*2]),s=this.cubeVertexValue.get(zr[n*2+1]);(r===0||s===0)&&(this.cubeHasCrossing=!0),!(r>0&&s>0||r<0&&s<0)&&(isFinite(r)||isFinite(s))&&(this.edgesMaybeCross|=1<<n)}this.edgesMaybeCross&&(this.setVertexPositions(),this.setEdges()),this.saveEdges(),this.cubeHasCrossing&&this.generateTriangles()}setEdges(){let{i:n,j:r,k:s,gridsize:i}=this,o=this.sheet[(n+0)*(i+1)+r+0],a=this.sheet[(n+1)*(i+1)+r+0],u=this.sheet[(n+0)*(i+1)+r+1],c=0;s>0&&(this.cubeEdge[0]=o.edge0,this.cubeEdge[1]=o.edge1,this.cubeEdge[2]=o.edge2,this.cubeEdge[3]=u.edge2,this.cubeEdge[4]=a.edge0,c|=31),r>0&&(this.cubeEdge[5]=this.strip[n].edge0,this.cubeEdge[6]=this.strip[n].edge1,this.cubeEdge[7]=this.strip[n+1].edge0,this.cubeEdge[8]=this.strip[n].edge2,c|=480,s==0&&(this.cubeEdge[2]=o.edge2,c|=4)),n>0&&(this.cubeEdge[9]=this.face.edge0,this.cubeEdge[10]=this.face.edge1,this.cubeEdge[11]=this.face.edge2,c|=3584,s==0&&(this.cubeEdge[0]=o.edge0,c|=1),r==0&&(this.cubeEdge[5]=this.strip[n].edge0,c|=32));for(let l=0;l<26;l++){if(~this.edgesMaybeCross>>l&1){this.cubeEdge[l]=Tm;continue}if(c>>l&1){!this.cubeHasCrossing&&(this.cubeEdge[l].posNeg||this.cubeEdge[l].posNaN)&&(this.cubeHasCrossing=!0);continue}let p=this.findSurfaceCrossingEDI(zr[l*2],zr[l*2+1]);this.cubeEdge[l]=p,r8(p)&&(this.cubeHasCrossing=!0)}}saveEdges(){let{i:n,j:r,k:s,gridsize:i}=this;s<i-1&&(this.sheet[(n+0)*(i+1)+r+0].edge0=this.cubeEdge[11],this.sheet[(n+0)*(i+1)+r+0].edge1=this.cubeEdge[17],this.sheet[(n+0)*(i+1)+r+0].edge2=this.cubeEdge[8]),r<i-1&&(this.strip[n].edge0=this.cubeEdge[10],this.strip[n].edge1=this.cubeEdge[12],this.strip[n].edge2=this.cubeEdge[14]),n<i-1&&(this.face.edge0=this.cubeEdge[15],this.face.edge1=this.cubeEdge[13],this.face.edge2=this.cubeEdge[16]),s==0&&(this.sheet[(n+0)*(i+1)+r+1].edge2=this.cubeEdge[3],this.sheet[(n+1)*(i+1)+r+0].edge0=this.cubeEdge[4]),r==0&&(this.strip[n+1].edge0=this.cubeEdge[7]),r==i-1&&(this.sheet[n*(i+1)+i].edge2=this.cubeEdge[14]),n==i-1&&(this.sheet[(i+0)*(i+1)+r].edge0=this.cubeEdge[16],this.strip[i].edge0=this.cubeEdge[13])}findSurfaceCrossingEDI(n,r){let s=this.cubeVertexValue.get(n),i=this.cubeVertexValue.get(r);if(s===0||i===0)return Tm;let o=this.cubeVertex[n],a=this.cubeVertex[r];if(this.isInequality){let{posNeg:u,posNaN:c}=CL(this.f,o,a,s,i);return{posNeg:u!==void 0?this.pushPositionWithGradient(...u):void 0,posNaN:c!==void 0?this.pushPositionNoGradient(...c):void 0}}else{let u=xm(this.f,o,a,s,i);return{posNeg:u!==void 0?this.pushPositionWithGradient(...u):void 0}}}pushPositionWithGradient(n,r,s){if(!(isFinite(n)&&isFinite(r)&&isFinite(s)))return 0;let[i,o,a]=this.computeGradient(n,r,s),u=Math.sqrt(i*i+o*o+a*a);return i/=-u,o/=-u,a/=-u,ep(i,o,a)?(this.normalFromGradient.push(!0),this._pushPositionAndNormal(n,r,s,i,o,a)):this.pushPositionNoGradient(n,r,s)}pushPositionNoGradient(n,r,s){return isFinite(n)&&isFinite(r)&&isFinite(s)?(this.allNormalsFromGradient=!1,this.normalFromGradient.push(!1),this._pushPositionAndNormal(n,r,s,0,0,0)):0}_pushPositionAndNormal(n,r,s,i,o,a){return this.positions.push(n,r,s),this.uvs.push((n-this.x.min)/this.x.width,(r-this.y.min)/this.y.width),this.normals.push(i,o,a),this.positions.length/3}computeGradient(n,r,s){let i=NaN,o=NaN,a=NaN;if(this.gradient&&([i,o,a]=this.gradient(n,r,s),isFinite(i)&&isFinite(o)&&isFinite(a)))return[i,o,a];let u=.001*Math.min(this.size.x,this.size.y,this.size.z),c=this.f(n,r,s);if(isFinite(i)||(i=(this.f(n+u,r,s)-c)/u),isFinite(i)||(i=(c-this.f(n-u,r,s))/u),isFinite(o)||(o=(this.f(n,r+u,s)-c)/u),isFinite(o)||(o=(c-this.f(n,r-u,s))/u),isFinite(a)||(a=(this.f(n,r,s+u)-c)/u),isFinite(a)||(a=(c-this.f(n,r,s-u))/u),isFinite(i)&&isFinite(o)&&isFinite(a))return[i,o,a];let l=NaN,p=NaN,f=NaN,d=NaN,y=NaN,g=NaN,m=u/2;return(!isFinite(i)||!isFinite(o))&&(l=(this.f(n+m,r+m,s)-c)/u,isFinite(l)||(l=(c-this.f(n-m,r-m,s))/u),p=(this.f(n+m,r-m,s)-c)/u,isFinite(p)||(p=(c-this.f(n-m,r+m,s))/u),isFinite(l)&&isFinite(p)&&(isFinite(i)||(i=l+p),isFinite(o)||(o=l-p))),(!isFinite(o)||!isFinite(a))&&(f=(this.f(n,r+m,s+m)-c)/u,isFinite(f)||(f=(c-this.f(n,r-m,s-m))/u),d=(this.f(n,r+m,s-m)-c)/u,isFinite(d)||(d=(c-this.f(n,r-m,s+m))/u),isFinite(f)&&isFinite(d)&&(isFinite(o)||(o=f+d),isFinite(a)||(a=f-d))),(!isFinite(a)||!isFinite(i))&&(y=(this.f(n+m,r,s+m)-c)/u,isFinite(y)||(y=(c-this.f(n-m,r,s-m))/u),g=(this.f(n-m,r,s+m)-c)/u,isFinite(g)||(g=(c-this.f(n+m,r,s-m))/u),isFinite(y)&&isFinite(g)&&(isFinite(i)||(i=y-g),isFinite(a)||(a=y+g))),[i,o,a]}generateTriangles(){for(let n=0;n<12;n++){let r=bb[n],s=[],i=0,o=TL[n],a=0,u=o[0],c=Math.abs(this.cubeVertexValue.get(u));c>a&&isFinite(c)&&(a=c);let l=o[1],p=Math.abs(this.cubeVertexValue.get(l));p>a&&isFinite(p)&&(a=p);let f=o[2],d=Math.abs(this.cubeVertexValue.get(f));d>a&&isFinite(d)&&(a=d);let y=o[3],g=Math.abs(this.cubeVertexValue.get(y));g>a&&isFinite(g)&&(a=g);let m=a*Number.EPSILON*32;if(c<=m){i|=35;let x=this.pushPositionWithGradient(...this.cubeVertex[u]);x!==void 0&&s.push(x)}if(p<=m){i|=21;let x=this.pushPositionWithGradient(...this.cubeVertex[l]);x!==void 0&&s.push(x)}if(d<=m){i|=14;let x=this.pushPositionWithGradient(...this.cubeVertex[f]);x!==void 0&&s.push(x)}if(g<=m){i|=56;let x=this.pushPositionWithGradient(...this.cubeVertex[y]);x!==void 0&&s.push(x)}if(s.length===4)continue;let h;for(let x=0;x<4;x++){let T=o[x];if(this.cubeVertexValue.get(T)>m){h=this.cubeVertex[T];break}}if(h===void 0&&this.isInequality)for(let x=0;x<6;x++){if(i>>x&1)continue;let{posNeg:T,posNaN:b}=this.cubeEdge[r[x]];if(El(T)&&El(b)){h=Fi(this.positions.slice((T-1)*3,T*3),this.positions.slice((b-1)*3,b*3),.5);break}}if(h===void 0)for(let x=0;x<4;x++){let T=o[x];if(!isFinite(this.cubeVertexValue.get(T))){h=this.cubeVertex[T];break}}if(h===void 0&&i&&s.length>0){let x;for(let T=0;T<4;T++){let b=o[T];if(this.cubeVertexValue.get(b)<-m){x=this.cubeVertex[b];break}}if(x){let T=s[0],b=this.positions.slice((T-1)*3,T*3);h=Fi(x,b,2)}}if(h!==void 0){if(this.isInequality){let x=[],T=[],b=!1;for(let M=0;M<6;M++){if(i>>M&1)continue;let{posNeg:P,posNaN:D}=this.cubeEdge[r[M]],S=El(P),O=El(D);S&&x.push(P),O&&T.push(D),S&&O&&(b=!0)}if(b){x.push(...s),this.pushTriangleFromCorners(T,h),this.pushTriangleFromCorners(x,h);continue}}for(let x=0;x<6;x++){if(i>>x&1)continue;let{posNeg:T,posNaN:b}=this.cubeEdge[r[x]],M=T||b;El(M)&&s.push(M)}this.pushTriangleFromCorners(s,h)}}}pushTriangleFromCorners(n,r){if(n.length>=3){let s=n[0]-1,i=n[1]-1,o=n[2]-1;this.pushTriangle(s,i,o,r)}if(n.length==4){let s=n[0]-1,i=n[2]-1,o=n[3]-1;this.pushTriangle(s,i,o,r)}}pushTriangle(n,r,s,i){this.allNormalsFromGradient||this.fixBadNormals(n,r,s,i),this.checkWindingOrder(n,r,s)&&([r,s]=[s,r]),this.triangles.push(n,r,s)}fixBadNormals(n,r,s,i){let o=!this.normalFromGradient[n],a=!this.normalFromGradient[r],u=!this.normalFromGradient[s];if(!(o||a||u))return;let c=this.positions,l=this.normals,p=new st(c[3*n],c[3*n+1],c[3*n+2]),f=new st(c[3*r],c[3*r+1],c[3*r+2]),d=new st(c[3*s],c[3*s+1],c[3*s+2]),y=new st().subVectors(d,p),g=new st().subVectors(p,f),m=y.cross(g),h=new st().subVectors(p,new st(...i));m.dot(h)<0&&m.multiply(-1),m.isFinite()&&(o&&(l[3*n+0]+=m.x,l[3*n+1]+=m.y,l[3*n+2]+=m.z),a&&(l[3*r+0]+=m.x,l[3*r+1]+=m.y,l[3*r+2]+=m.z),u&&(l[3*s+0]+=m.x,l[3*s+1]+=m.y,l[3*s+2]+=m.z))}checkWindingOrder(n,r,s){let i=this.positions,o=this.normals,a=i[3*s]-i[3*n],u=i[3*s+1]-i[3*n+1],c=i[3*s+2]-i[3*n+2],l=i[3*n]-i[3*r],p=i[3*n+1]-i[3*r+1],f=i[3*n+2]-i[3*r+2],d=u*f-c*p,y=c*l-a*f,g=a*p-u*l,m=o[3*n],h=o[3*n+1],x=o[3*n+2];return d*m+y*h+g*x<0}};var{floor:s8}=Math;function kC(e){let t=[];for(let n of e)t.push(...n),t.push(NaN,NaN,NaN);return t}function Ml(e,t,n,r){(n===void 0||isNaN(n))&&(n=zC(t.min,t.max)),n=hr(s8(n),2,2e3);let{xmin:s,xmax:i,ymin:o,ymax:a,zmin:u,zmax:c}=r.viewport;u!=null||(u=Dr.zmin),c!=null||(c=Dr.zmax);let l=Pb(e,{min:t.min,max:t.max,nInitialSamples:n,xtolerance:(i-s)/1e3,ytolerance:(a-o)/1e3,ztolerance:(c-u)/1e3,map:p=>p});return kC(l.segments)}function HC(e,t,n,r){let s=r.degreeMode?Math.PI/180:1;return Ml(i=>{let o=e(i),a=o[0],u=o[1],c=o[2];return[a*Mn(u*s),a*dn(u*s),c]},t,n,r)}function SL(e,t,n,r){let s=r.degreeMode?Math.PI/180:1;return Ml(i=>{let o=e(i),a=o[0],u=o[1],c=o[2];return[a*dn(c*s)*Mn(u*s),a*dn(c*s)*dn(u*s),a*Mn(c*s)]},t,n,r)}function AL(e,t,n,r){let s=i8(e,t,n,r);return kC(s)}function i8(e,t,n,r){return new YC(e,t,new qe(n.xmin,n.xmax),new qe(n.ymin,n.ymax),new qe(n.zmin,n.zmax),r).run()}var o8={},YC=class extends yd{constructor(n,r,s,i,o,a){super(Ib,s,i,o,a);this.f=n;this.g=r;this.vertexFGZs={};this.vertexZeroF={};this.vertexZeroG={};this.threshF=0;this.threshG=0;this.cubeID=0;this.edgesMaybeCrossF=0;this.edgesMaybeCrossG=0;this.tetEdgeCrossings=new Array(26);this.edgeFGZs=new Array(26);this.edgeCrossings=new Map;this.allFGZs=new Map}setAt(n,r,s,i,o){let a=this.f(s,i,o),u=this.g(s,i,o);n.set(r,a,u)}run(){return this.loopOverUnitCubes(this.onEachCube.bind(this)),this.traceCurves()}onEachCube(){this.cubeID=EL(this.i,this.j,this.k),this.pruneEdges(),this.edgesMaybeCrossF&&this.edgesMaybeCrossG&&(this.setVertexPositions(),this.setVertexZeros(),this.setEdgeCrossings(),this.insertCurveSegmentsFromCube())}pruneEdges(){this.edgesMaybeCrossF=0,this.edgesMaybeCrossG=0;for(let n=0;n<26;n++){let r=zr[n*2],s=zr[n*2+1],i=this.cubeVertexValue.getX(r),o=this.cubeVertexValue.getY(r),a=this.cubeVertexValue.getX(s),u=this.cubeVertexValue.getY(s);!(i>0&&a>0||i<0&&a<0)&&(isFinite(i)||isFinite(a))&&(this.edgesMaybeCrossF|=1<<n),!(o>0&&u>0||o<0&&u<0)&&(isFinite(o)||isFinite(u))&&(this.edgesMaybeCrossG|=1<<n)}}setVertexZeros(){let n=0,r=0;for(let o=0;o<9;o++){let a=this.cubeVertexValue.getX(o),u=this.cubeVertexValue.getY(o),c=Math.abs(a),l=Math.abs(u);c>n&&isFinite(c)&&(n=c),l>r&&isFinite(c)&&(r=l)}let s=this.threshF=n*Number.EPSILON*32,i=this.threshG=r*Number.EPSILON*32;for(let o=0;o<9;o++){let a=this.cubeVertexValue.getX(o),u=this.cubeVertexValue.getY(o),c=Math.abs(a),l=Math.abs(u);if(this.vertexZeroF[o]=c<=s,this.vertexZeroG[o]=l<=i,c<=s&&l<=i){let p=this.cubeVertex[o],f=this.createFGZ(ML(this.cubeID,o),p);this.vertexFGZs[o]=f}else this.vertexFGZs[o]=void 0}}getEdgeCrossings(n){let r=this.edgesMaybeCrossF>>n&1,s=this.edgesMaybeCrossG>>n&1;if(!r&&!s)return o8;let i=bm(this.cubeID,n),o=this.edgeCrossings.get(i);if(o!==void 0)return o;let a=this.getEdgeCrossingsUncached(n,r,s);return this.edgeCrossings.set(i,a),a}getEdgeCrossingsUncached(n,r,s){let i=zr[n*2],o=zr[n*2+1],a=this.cubeVertexValue.getX(i),u=this.cubeVertexValue.getY(i),c=this.cubeVertexValue.getX(o),l=this.cubeVertexValue.getY(o),p=this.cubeVertex[i],f=this.cubeVertex[o],d=!r||a===0||c===0?void 0:xm(this.f,p,f,a,c),y=!s||u===0||l===0?void 0:xm(this.g,p,f,u,l),g=this.threshF;!d&&y&&Math.abs(a)<=g&&Math.abs(c)<=g&&Math.abs(this.f(y[0],y[1],y[2]))<=g&&(d=y);let m=this.threshG;return!y&&d&&Math.abs(u)<=m&&Math.abs(l)<=m&&Math.abs(this.g(d[0],d[1],d[2]))<=m&&(y=d),{f:d,g:y}}getTriangleCrossing(n){let r=wC(this.cubeID,n),s=this.allFGZs.get(r);if(s!==void 0)return s;let i=this.getTriangleCrossingUncached(n);return this.allFGZs.set(r,i),i}createFGZ(n,r){let s=this.allFGZs.get(n);if(s)return s;let i={id:n,pos:r,connections:[],visited:!1};return this.allFGZs.set(n,i),i}getTriangleCrossingUncached(n){let r=[],s=[],i=LC[n];for(let a=0;a<3;a++){let u=i[a];if(this.vertexFGZs[u])return null;this.vertexZeroF[u]&&r.push(this.cubeVertex[u]),this.vertexZeroG[u]&&s.push(this.cubeVertex[u])}let o=_C[n];for(let a=0;a<3;a++){let u=o[a],c=this.tetEdgeCrossings[u];if(this.edgeFGZs[u]||!c)continue;let l=c.f,p=c.g,f=zr[2*u],d=zr[2*u+1];l&&!this.vertexZeroF[f]&&!this.vertexZeroF[d]&&r.push(l),p&&!this.vertexZeroG[f]&&!this.vertexZeroG[d]&&s.push(p)}if(r.length===2&&s.length===2){let a=a8(r[0],r[1],s[0],s[1]);return a?{id:wC(this.cubeID,n),pos:a,connections:[],visited:!1}:null}else return null}setEdgeCrossings(){for(let n=0;n<26;n++){let r=this.getEdgeCrossings(n),s=r.f,i=r.g,o=zr[n*2],a=zr[n*2+1];if(this.vertexFGZs[o]||this.vertexFGZs[a])this.tetEdgeCrossings[n]=void 0,this.edgeFGZs[n]=void 0;else if(s&&this.vertexZeroG[o]&&this.vertexZeroG[a]){let u=this.createFGZ(bm(this.cubeID,n),s);this.edgeFGZs[n]=u,this.tetEdgeCrossings[n]=void 0}else if(i&&this.vertexZeroF[o]&&this.vertexZeroF[a]){let u=this.createFGZ(bm(this.cubeID,n),i);this.edgeFGZs[n]=u,this.tetEdgeCrossings[n]=void 0}else if(s&&i&&qa(s,i)<1e-8){let u=this.createFGZ(bm(this.cubeID,n),s);this.edgeFGZs[n]=u,this.tetEdgeCrossings[n]=void 0}else this.edgeFGZs[n]=void 0,this.tetEdgeCrossings[n]=r}}insertCurveSegmentsFromCube(){for(let n=0;n<12;n++)this.insertCurveSegmentsFromTetrahedron(n)}insertCurveSegmentsFromTetrahedron(n){let r=[],s=PL[n];for(let l=0;l<4;l++){let p=this.getTriangleCrossing(s[l]);p&&r.push(p)}let i=[],o=bb[n];for(let l=0;l<6;l++){let p=this.edgeFGZs[o[l]];p&&i.push(p)}let a=[],u=[zr[o[0]*2],zr[o[0]*2+1],zr[o[3]*2],zr[o[3]*2+1]];for(let l of u){let p=this.vertexFGZs[l];p&&a.push(p)}let c=[...a,...i,...r];switch(c.length){case 0:case 1:break;case 2:this.connectCrossings(c[0],c[1]);break;case 3:r.length===2&&this.connectCrossings(r[0],r[1]);break;case 4:r.length===4&&(this.connectCrossings(r[0],r[1]),this.connectCrossings(r[2],r[3]));break;default:throw new Error("Programming error: 5 is impossible.")}}connectCrossings(n,r){n.connections.some(s=>s.id===r.id)||r.connections.some(s=>s.id===n.id)||n.connections.length>=2||r.connections.length>=2||(n.connections.push(r),r.connections.push(n))}traceCurves(){let n={xtolerance:this.size.x*.1,ytolerance:this.size.y*.1,ztolerance:this.size.z*.1,map:s=>s},r=new $i(n);for(let s of this.allFGZs.values())s&&!s.visited&&s.connections.length===1&&this.traceCurve(r,s);for(let s of this.allFGZs.values())s&&!s.visited&&this.traceCurve(r,s);return r.finish().segments}traceCurve(n,r){let s=r;for(;;){n.addPoint(r.pos),r.visited=!0;let i;for(let o of r.connections)o.visited||(i=o);if(!i)break;r=i}s.connections.length===2&&n.addPoint(s.pos),n.breakSegment()}},[Eb,vL,UC]=[new st,new st,new st],OL=new st,[qC,$C,NL]=[new st,new st,new st],[Mb,RL,Cb]=[new st,new st,new st];function a8(e,t,n,r){Eb.set(e[0],e[1],e[2]),vL.set(t[0],t[1],t[2]),UC.set(n[0],n[1],n[2]),OL.set(r[0],r[1],r[2]),qC.subVectors(vL,Eb),$C.subVectors(OL,UC),NL.subVectors(UC,Eb),Mb.crossVectors(qC,$C),RL.crossVectors(NL,$C);let s=Mb.dot(RL)/Mb.dot(Mb);return 0<=s&&s<=1?(Cb.addVectors(Eb,qC.multiply(s)),[Cb.x,Cb.y,Cb.z]):null}var _L=80;var XC=class extends ld{constructor(n,r,s,i,o,a){let u=s.width/1e8,c=i.width/1e8;super({resolution:o,uRange:s,vRange:i,du:u,dv:c,extraAttrCount:a});this.vertices=[];this.fn=n=>{let r=this._fn(n),s=this.tangentInForced(n,[this.du,0],r),i=this.tangentInForced(n,[0,this.dv],r),o=Kl(s,i);return{uv:n,f:r,normal:o,dfEast:s,dfNorth:i}};this._fn=l=>n(l[0],l[1]),this.xmin=r.xmin*6-r.xmax*5,this.xmax=r.xmax*6-r.xmin*5,this.ymin=r.ymin*6-r.ymax*5,this.ymax=r.ymax*6-r.ymin*5,this.zmin=r.zmin*6-r.zmax*5,this.zmax=r.zmax*6-r.zmin*5,this.distThresh=((r.xmax-r.xmin)*1e-6)**2}getVertexCount(){return this.vertices.length}getUV(n){return this.vertices[n].uv}getNormal(n){return this.vertices[n].normal}_addVertex(n){return this.vertices.push(n)-1}copyVertex(n){return this.addVertex(this.vertices[n])}getF(n){return this.vertices[n].f}getDfNorth(n){return this.vertices[n].dfNorth}getDfEast(n){return this.vertices[n].dfEast}insidePaddedDomain(n){return this.zmin<=n[2]&&n[2]<=this.zmax&&this.ymin<=n[1]&&n[1]<=this.ymax&&this.xmin<=n[0]&&n[0]<=this.xmax}tangentInForced(n,r,s){let i=cf(n,r);return YP(this._fn(i),s)}_isVertexAtCrease(n){let r=this.getUV(n),s=this.getDfEast(n),i=this.getDfNorth(n),o=this.getF(n),a=this.tangentInForced(r,[-this.du,0],o);if(XP(a,s)/Math.sqrt(Ql(a)*Ql(s))>-pd)return!0;let c=this.tangentInForced(r,[0,-this.dv],o);return XP(i,c)/Math.sqrt(Ql(i)*Ql(c))>-pd}hintedNormal(n,r){let s=this.getUV(n),i=this.getF(n),o=Kl(this.tangentInForced(s,r[0],i),this.tangentInForced(s,r[1],i));return ep(...o)?o:this.getNormal(n)}getVertex(n){if(this.allowVertex(n))return this.getF(n)}getExtraAttr(n,r){return this.vertices[n].f[3+r]}findJumpBetweenTwoSamples(n,r){let s=this.getUV(n),i=this.getF(n),o=0,a=this.getUV(r),u=this.getF(r),c=1,l=d=>this._fn(ar(s,a,d));if(!isFinite(i[0])||!isFinite(i[1])||!isFinite(i[2])||!isFinite(u[0])||!isFinite(u[1])||!isFinite(u[2]))return;let f=Wy(o,i,c,u,l,(this.xmax-this.xmin)*1e-6,0,0);if(f)return[this.fn(ar(s,a,wi(f[0],0,1e-5))),this.fn(ar(s,a,wi(f[1],1,1e-5)))]}clip(n){return this.insidePaddedDomain(n)?n:[NaN,NaN,NaN]}findFiniteBetweenTwoSamples(n,r){let s=this.getUV(n),i=this.getF(n),o=this.getUV(r),a=this.getF(r),u=l=>this.clip(this._fn(ar(s,o,l))),c=Zy(0,this.clip(i),1,this.clip(a),u);if(c!==void 0)return this.fn(ar(s,o,c))}allowVertex(n){return this.insidePaddedDomain(this.getF(n))}isDegenerate(n,r,s){let i=this.getF(n),o=this.getF(r);if(qa(i,o)<this.distThresh)return!0;let a=this.getF(s);return qa(o,a)<this.distThresh||qa(i,a)<this.distThresh}};function Pm(e,t,n,r,s,i){let o=new XC(e,t,n,r,s,i);return cb(o)}function Em(e,t){let n={};for(let r in t)t.hasOwnProperty(r)&&(ws(e[r],t[r])||(n[r]=t[r]));return n}function Db(e,t){let n,r={};for(let s in t)t.hasOwnProperty(s)&&(ws(e[s],t[s])||(r[s]=t[s],n=r));return n}function Jse(e,t){t||(t={});let n={};for(let r in e)e.hasOwnProperty(r)&&!t.hasOwnProperty(r)&&(n[r]=li(e[r]));for(let r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}var u8=(r=>(r.NONE="NONE",r.POSITIVE="POSITIVE",r.BOTH="BOTH",r))(u8||{});function eie(e){switch(e){case"LOOP_FORWARD":return"dcg-icon-arrow-one-way";case"LOOP_FORWARD_REVERSE":return"dcg-icon-arrow-two-way";case"PLAY_ONCE":return"dcg-icon-arrow-once";case"PLAY_INDEFINITELY":return"dcg-icon-arrow-infinite"}}function sie({from:e,to:t,props:n}){for(let r in n)n[r]&&e.hasOwnProperty(r)&&(t[r]=li(e[r]))}function iie(e,t){for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}function wL(e,t){let n={};for(let r in t)t.hasOwnProperty(r)&&(n[r]=e[r]);return n}function oie(e){let t={};for(let n in e)e.hasOwnProperty(n)&&(t[n]=!0);return t}var FL={collapsed:!1,hidden:!1,secret:!1,inFrontOfEverything:!1,readonly:!1,title:""};function uie(e){return{...FL,...e}}function cie(e){return Em(FL,e)}var VL="**dcg_geo_folder**";var ZC={show:!1,min:"",max:""},WC={breadth:"",axisOffset:"",alignedAxis:"x",showBoxplotOutliers:!0,binAlignment:"center",dotplotXMode:"exact",histogramMode:""},jC={enabled:!1,latex:""};var kL=4e3,Sb={polarDomain:{min:"",max:""},parametricDomain:{min:"",max:""},parametricDomain3Du:{min:"",max:""},parametricDomain3Dv:{min:"",max:""},parametricDomain3Dr:{min:"",max:""},parametricDomain3Dphi:{min:"",max:""},cdf:ZC,colorLatex:"",description:"",fillOpacity:"",surfaceOpacity:"",lineOpacity:"",pointOpacity:"",pointSize:"",movablePointSize:"",lineWidth:"",resolution:"",labelAngle:"",vizProps:WC,clickableInfo:jC},HL={folderId:"",latex:"",color:"",showLabel:!1,showAngleLabel:!0,label:"",hidden:!1,secret:!1,readonly:!1,disableGraphInteractions:!1,dragMode:"AUTO",labelSize:"",labelOrientation:"default",suppressTextOutline:!1,interactiveLabel:!1,editableLabelMode:"NONE",residualVariable:"",isLogModeRegression:!1,pointStyle:"POINT",lineStyle:"SOLID",arrowMode:"DEFAULT",regressionParameters:{},displayEvaluationAsFraction:!1,slider:{},strictIntersection:!1,extendTo3D:!1,...Sb,points:void 0,lines:void 0,fill:void 0},zL={hardMin:!1,hardMax:!1,animationPeriod:kL,loopMode:"LOOP_FORWARD_REVERSE",playDirection:1,isPlaying:!1,min:"-10",max:"10",step:""},UL={hardMin:!1,hardMax:!1,animationPeriod:kL,loopMode:"LOOP_FORWARD_REVERSE",playDirection:1,isPlaying:!1,min:`${Dr.xmin}`,max:`${Dr.xmax}`,step:""};function Pie(e,t){return{...HL,isLogModeRegression:t.defaultLogModeRegressions,...e,slider:{...t.is3d?UL:zL,...e.slider},cdf:{...ZC,...e.cdf},vizProps:{...WC,...e.vizProps},clickableInfo:{...jC,...e.clickableInfo}}}function Eie(e,t){let n=Em(HL,{...e,slider:Em(t.is3d?UL:zL,e.slider)}),r=Db(ZC,e.cdf);r===void 0?delete n.cdf:n.cdf=r;let s=Db(WC,e.vizProps);s===void 0?delete n.vizProps:n.vizProps=s;let i=Db(jC,e.clickableInfo);return i===void 0?delete n.clickableInfo:n.clickableInfo=i,n}function c8(e){return wL(e,Sb)}function Mie(e,t){for(let n in Sb)if(Sb.hasOwnProperty(n)&&e[n]!==t[n])return!1;return!0}function Cie(e){return{type:"statement",id:e.id,latex:e.latex,label:e.label,color:e.color,fill:e.fill,points:e.points,lines:e.lines,extendTo3D:e.extendTo3D,pointStyle:e.pointStyle,lineStyle:e.lineStyle,arrowMode:e.arrowMode,dragMode:e.dragMode,labelSize:e.labelSize,labelOrientation:e.labelOrientation,suppressTextOutline:e.suppressTextOutline,interactiveLabel:e.interactiveLabel,editableLabelMode:e.editableLabelMode,residualVariable:e.residualVariable,regressionParameters:e.regressionParameters,isLogModeRegression:e.isLogModeRegression,showLabel:e.showLabel,showAngleLabel:e.showAngleLabel,shouldGraph:!e.hidden,slider:{min:e.slider.hardMin?e.slider.min:"",max:e.slider.hardMax?e.slider.max:"",softMin:e.slider.hardMin?"":e.slider.min,softMax:e.slider.hardMax?"":e.slider.max,step:e.slider.step,isPlayingOnce:e.slider.isPlaying&&e.slider.loopMode==="PLAY_ONCE"},strictIntersection:e.strictIntersection,isInConstructionsFolder:e.folderId===VL,...c8(e)}}var y8={};ia(y8,{LinearToSRGB:()=>f8,SRGBToLinear:()=>vb,colorString:()=>qL,colors:()=>Cl,colors3d:()=>m8,convertColorStringToLinearRGB:()=>QC,getDisplayColor:()=>Ra,invertColor:()=>p8,isValidHexColor:()=>Ob,mutateOpacity:()=>d8,normalizeColor:()=>JC,parseHex:()=>$L,shadeColor:()=>l8});function JC(e){return Ob(e)?(e.match(/^#([A-Fa-f0-9]{3})$/g)&&(e="#"+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),e.toLowerCase()):e}function Ob(e){return typeof e=="string"&&(e.match(/^#([A-Fa-f0-9]{3})$/g)||e.match(/^#([A-Fa-f0-9]{6})$/g))}function l8(e,t){if(e=JC(e),!Ob(e))return e;t>1&&(t=1),t<-1&&(t=-1);let n=parseInt(e.slice(1),16),r=t<0?0:255,s=t<0?t*-1:t,i=n>>16,o=n>>8&255,a=n&255;return qL(Math.round((r-i)*s)+i,Math.round((r-o)*s)+o,Math.round((r-a)*s)+a)}function qL(e,t,n){return"#"+(16777216+Math.round(e)*65536+Math.round(t)*256+Math.round(n)).toString(16).slice(1)}function p8(e){if(e=JC(e),!Ob(e))return e;let t="0123456789abcdef";return"#"+e.slice(1).split("").map(n=>t[15-t.indexOf(n)]).join("")}function $L(e){e=e.replace(/#/,"");let t,n,r;return e.length===3?(t=parseInt(e.slice(0,1)+e.slice(0,1),16),n=parseInt(e.slice(1,2)+e.slice(1,2),16),r=parseInt(e.slice(2,3)+e.slice(2,3),16)):e.length===6?(t=parseInt(e.slice(0,2),16),n=parseInt(e.slice(2,4),16),r=parseInt(e.slice(4,6),16)):(t=0,n=0,r=0),{r:t,g:n,b:r}}function d8(e,t){let n=/(rgba\\([\\d]+\\,\\ ?[\\d]+\\,\\ ?[\\d]+\\,\\ ?)[\\d.]+(\\))/;return e.match(n)?e.replace(n,`$1${t}$2`):e}function Ra(e,t){if(t&&t.colorLatexValue){let n=t.colorLatexValue;return Array.isArray(n)?n[0]:n}return e.color}function vb(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function f8(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}function QC(e){let t=$L(e);return[vb(t.r/255),vb(t.g/255),vb(t.b/255)]}var Cl={RED:"#c74440",BLUE:"#2d70b3",GREEN:"#388c46",PURPLE:"#6042a6",ORANGE:"#fa7e19",BLACK:"#000000",GRAY:"#aaaaaa",FOCUS_OUTLINE:"#6a93d2"},m8={RED:Cl.RED,BLUE:Cl.BLUE,GREEN:Cl.GREEN,ORANGE:Cl.ORANGE,PURPLE:Cl.PURPLE,GRAY:Cl.GRAY};var g8=(e,t)=>{let n=e.segments[0],r=t.segments[0],s=[[...n,...r]];return{...e,segments:s}};function h8(e){let{viewState:t,graphInfo:n,compiled:r,derivative:s,bounds:i}=e,o=li(n),a=Gn(n.domainBound,bi(i));if(!Fs(a))return o.domainBound=a,o.lineStyle="SOLID",cu({graphInfo:o,viewState:t,compiled:r,derivative:s})}function ic(e){let{viewState:t,graphInfo:n,compiled:r,bounds:s,included:i,showPoint:o}=e,a=li(n),u=Gn(n.domainBound,bi(s));if(!Fs(u))return a.domainBound=u,a.pointStyle=i?"POINT":"OPEN",Nb({graphInfo:a,viewState:t,compiled:r,showPoint:o,maxOverride:void 0})}function YL(e){let{viewState:t,graphInfo:n,compiled:r,bounds:s,maxOverride:i,showPoint:o}=e,[a,u]=s,c=[],l;a=Math.ceil(a),u=Math.floor(u);let p=i!==void 0?i:1/0;if(a===-1/0&&u>=p)l=ic({bounds:[a,p],included:!0,viewState:t,graphInfo:n,compiled:r,showPoint:o}),c.push(l);else if(a===-1/0&&u<1/0)l=ic({bounds:[a,u],included:!0,viewState:t,graphInfo:n,compiled:r,showPoint:o}),c.push(l),c.push(ic({bounds:[u+1,p],included:!1,viewState:t,graphInfo:n,compiled:r,showPoint:o}));else if(a>-1/0&&u>=p)l=ic({bounds:[a,p],included:!0,viewState:t,graphInfo:n,compiled:r,showPoint:o}),c.push(ic({bounds:[-1/0,a-1],included:!1,viewState:t,graphInfo:n,compiled:r,showPoint:o})),c.push(l);else{l=ic({bounds:[a,u],included:!0,viewState:t,graphInfo:n,compiled:r,showPoint:o});let f=ic({bounds:[-1/0,a-1],included:!1,viewState:t,graphInfo:n,compiled:r,showPoint:o}),d=ic({bounds:[u+1,p],included:!1,viewState:t,graphInfo:n,compiled:r,showPoint:o});c.push(l);let y;f&&d&&(y=g8(f,d),c.push(y))}return{cdfTopBranch:l,topBranches:c}}var XL=e=>{let{viewState:t,graphInfo:n,compiled:r,derivative:s,bounds:i}=e,[o,a]=i,u=h8({bounds:[o,a],viewState:t,graphInfo:n,compiled:r,derivative:s}),c=[cu({viewState:t,graphInfo:n,compiled:r,derivative:s})];return{cdfTopBranch:u,topBranches:c}};var Mm=class{constructor(t){this.parentType=t;this.count=0;this.intersections=[]}addPoint(t){this.intersections.push(t),this.count+=1}addPoints(t){this.intersections.push(...t),this.count+=t.length}addIntersection(t,n){n.valueType===N?this.addPoint(n.value):this.addPoints(n.value)}getPoints(){return this.intersections}},gd=class{constructor(t){this.parentType=t;this.count=0;this.intersectionsByIndex=new Map;if(t===xn)this.scalarType=de;else if(t===Vn)this.scalarType=Ne;else if(t===Fn)this.scalarType=ie;else throw new Error(`Expected ListOfSegment or ListOfArc but got ${at(t)}`)}getListItemIntersections(t){let n=this.intersectionsByIndex.get(t);return n||(n=new Mm(this.scalarType),this.intersectionsByIndex.set(t,n)),n}addIntersection(t,n){let r=zo(t);if(r!==void 0){let s=r-1,i=this.getListItemIntersections(s);n.valueType===Pt?i.addPoints(n.value):i.addPoint(n.value),this.count+=1}else{za(n.valueType,[Pt]);for(let s=0;s<n.value.length;s++)this.getListItemIntersections(s).addPoint(n.value[s]);this.count+=n.value.length}}},KC=class{constructor(){this.parentType=xe;this.count=0;this.intersectionsByEdgeIndex=new Map}getEdgeIntersections(t){let n=this.intersectionsByEdgeIndex.get(t);return n||(n=new Mm(de),this.intersectionsByEdgeIndex.set(t,n)),n}addPoint(t,n){this.getEdgeIntersections(t).addPoint(n),this.count+=1}addIntersection(t,n){if(t.type!=="polygon-edge")throw new Error(`Expected a polygon edge parent ref type but got ${t.type}`);let r=t.edgeIndex-1,s=this.getEdgeIntersections(r);n.valueType===Pt?(s.addPoints(n.value),this.count+=n.value.length):(s.addPoint(n.value),this.count+=1)}},e1=class{constructor(){this.parentType=In;this.count=0;this.intersectionsByEdgeIndex=new Map}getEdgeIntersections(t){let n=this.intersectionsByEdgeIndex.get(t);return n||(n=new gd(xn),this.intersectionsByEdgeIndex.set(t,n)),n}addIntersection(t,n){if(t.type!=="polygon-edge")throw new Error(`Expected a polygon edge parent ref type but got ${t.type}`);let r=t.edgeIndex-1,s=this.getEdgeIntersections(r),i=zo(t);if(i!==void 0){let o=i-1;n.valueType===Pt?s.getListItemIntersections(o).addPoints(n.value):s.getListItemIntersections(o).addPoint(n.value),this.count+=1}else{za(n.valueType,[Pt]);for(let o=0;o<n.value.length;o++)s.getListItemIntersections(o).addPoint(n.value[o]);this.count+=n.value.length}}},hd=class{constructor(){this.data={}}getChildIntersections(t){return this.data[t]}addChildIntersection(t,n){za(n==null?void 0:n.valueType,[N,Pt]);let r;if(t.valueType==In)r=this.data[t.id]||new e1;else if(t.valueType===xn||t.valueType===Vn||t.valueType===Fn)r=this.data[t.id]||new gd(t.valueType);else if(t.valueType===xe)r=this.data[t.id]||new KC;else if(t.valueType===de||t.valueType===Ne||t.valueType===ie)r=this.data[t.id]||new Mm(t.valueType);else return;this.data[t.id]=r,r.addIntersection(t.ref,n)}static compareIntersectionCounts({prevChildIntersections:t,nextChildIntersections:n}){var i,o;let r={},s=new Set([...Object.keys(t.data),...Object.keys(n.data)]);for(let a of s){let u=((i=t.data[a])==null?void 0:i.count)||0,c=((o=n.data[a])==null?void 0:o.count)||0;r[a]={prev:u,next:c}}return r}};function Aie(e){return 2*b8(e*.5)}function b8(e){return e<=8?3*e:e>=16?2*e:e+16}function JL(e=void 0){let{xmin:t,xmax:n,ymin:r,ymax:s,zmin:i,zmax:o}=e!=null?e:new Ab,a=[t,r,o,t,s,o,n,s,o,n,r,o,t,r,i,t,s,i,n,s,i,n,r,i,t,r,i,t,r,o,t,s,o,t,s,i,n,r,i,n,r,o,n,s,o,n,s,i,n,r,i,n,r,o,t,r,o,t,r,i,n,s,i,n,s,o,t,s,o,t,s,i],u=[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0],c=[0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,0,1,1,0,1,0,1,1,1,1,1,0,1,0,0,0,0,0,1,1,1,1,0,1,0,1],l=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];return{positions:new Float32Array(a),normals:new Float32Array(u),faces:new Uint16Array(l),uvs:new Float32Array(c)}}var{abs:oc,min:t1,max:n1}=Math;function r1(e,t){let{xmin:n,xmax:r,ymin:s,ymax:i,zmin:o,zmax:a}=t,u=[[n,s,a],[n,i,a],[r,i,a],[r,s,a],[n,s,o],[n,i,o],[r,i,o],[r,s,o]],c=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]],l=[];for(let[S,O]of c){let _=u[S],L=u[O],w=e(..._),G=e(...L),k=w/(w-G);0<=k&&k<=1&&l.push(Fi(_,L,k))}if(l.length<3)return;let p=t1(...l.map(S=>S[0])),f=n1(...l.map(S=>S[0])),d=t1(...l.map(S=>S[1])),y=n1(...l.map(S=>S[1])),g=t1(...l.map(S=>S[2])),m=n1(...l.map(S=>S[2])),h=e(n,s,o),x=(e(r,s,o)-h)/(r-n),T=(e(n,i,o)-h)/(i-s),b=(e(n,s,a)-h)/(a-o),M,P,D;return oc(b)>=oc(x)&&oc(b)>=oc(T)?(M=(S,O)=>[S,O,o-(h+x*(S-n)+T*(O-s))/b],P=new qe(p,f),D=new qe(d,y)):oc(T)>=oc(b)&&oc(T)>=oc(x)?(M=(S,O)=>[S,s-(h+x*(S-n)+b*(O-o))/T,O],P=new qe(p,f),D=new qe(g,m)):(M=(S,O)=>[n-(h+T*(S-s)+b*(O-o))/x,S,O],P=new qe(d,y),D=new qe(g,m)),{explicitPlane:M,u:P,v:D}}function _b(e,t){let n=[],r=[],s=[],i=[],o=r1(e,t);if(o){let{explicitPlane:a,u,v:c}=o;n.push(...a(u.min,c.min),...a(u.max,c.min),...a(u.min,c.max),...a(u.max,c.max));let l=new st(n[0],n[1],n[2]),p=new st(n[3],n[4],n[5]),f=new st(n[6],n[7],n[8]),d=new st().subVectors(f,l),y=new st().subVectors(l,p),g=d.cross(y).normalize();r.push(g.x,g.y,g.z,g.x,g.y,g.z,g.x,g.y,g.z,g.x,g.y,g.z),s.push(0,0,0,1,1,0,1,1),i.push(0,1,2,3,2,1)}return{positions:n,normals:r,faces:i,uvs:s,resolved:!0,extraAttrs:[]}}function s1(e,t){let n;switch(t){case"solvedEquation":n=2;break;case"baseComparator":n=4;break;default:n=1;break}return Math.floor(e/n)}var T8=!1,ac=200,Fb=C.List;function Ir(){return{}}function Dl(e,t,n){let r=1/0;for(let i of t){let o=e[i];Array.isArray(o)&&o.length<r&&(r=o.length)}let s=1;return n==="solvedEquation"?s=2:n==="baseComparator"&&(s=4),s*r}function Aa(e,t,n){return Array.isArray(e)?e[s1(t,n)]:e}function I8(e,t){let n=t.viewport.xmax-t.viewport.xmin,r=t.viewport.ymax-t.viewport.ymin,s=Oi(n,r),i=Oi(30,30),o=Math.round(2-Math.log(s/i)/Math.LN10);if(o<=0)return Math.round(e)+"";{let a=Math.pow(10,o);return Math.round(e*a)/a+""}}function P8(e,t){let n=t.viewport.xmax-t.viewport.xmin,r=t.viewport.ymax-t.viewport.ymin,s=n*r,i=30*30,o=Math.round(2-Math.log(s/i)/Math.LN10);if(o<=0)return Math.round(e)+"";{let a=Math.pow(10,o);return Math.round(e*a)/a+""}}function E8(e,t){return t.degreeMode?Math.round(e/(Math.PI/180)*10)/10+"\\xB0":Math.round(e*100)/100+""}function uc(e,t,n){let r=s1(t,n),s=e.userData.lineStyle,i=Aa(e.metaData.computedLineWidth,t,n),o=Aa(e.metaData.computedLineOpacity,t,n),a=Aa(e.metaData.computedFillOpacity,t,n),u=Aa(e.metaData.computedSurfaceOpacity,t,n),c=e.metaData.colorLatexValue?Aa(e.metaData.colorLatexValue,t,n):e.userData.color,l=Aa(e.metaData.computedResolution,t,n);return{listIndex:r,style:s,lineWidth:i,lineOpacity:o,fillOpacity:a,surfaceOpacity:u,color:c,resolution:l}}C.Base.prototype._graph=M8;function M8(e,t,n,r,s,i){var d,y,g;if(t instanceof C.SolvedEquation){let m=this._graph(e,t._expression,n,r,s,t.branchMultiplier===2?"solvedEquation":void 0),h=uw(this,t,n,e);return h&&(m||(m=[]),Array.prototype.push.apply(m,h)),m}function o(m){let h=m.editableLabelMode;return h==="TEXT"||h==="MATH"}function a(m,h){return"colorLatex"in m&&A8(m.colorLatex)?m.colorLatex:h}let u=t.getExpressionType(r.graphMode,t.valueType),c=eC(u,{points:this.userData.points,lines:this.userData.lines,fill:this.userData.fill}),l={lineOpacity:"computedLineOpacity",lineWidth:"computedLineWidth",color:"colorLatexValue",fillOpacity:"fillOpacity",surfaceOpacity:"surfaceOpacity",resolution:"resolution"},p=(m,h)=>{let x=Dl(this.metaData,Object.keys(m).map(b=>l[b]),i),T=[];return Fb.wrap(t).eachElement((b,M)=>{if(M>=x)return;let P=this.getGraphInfo(e,b);P.graphMode=r.graphMode;let D=uc(this,M,i);P.listIndex=D.listIndex,P.style=D.style,"lineWidth"in m&&(P.lineWidth=D.lineWidth),"lineOpacity"in m&&(P.lineOpacity=D.lineOpacity),"fillOpacity"in m&&(P.fillOpacity=D.fillOpacity),"surfaceOpacity"in m&&(P.surfaceOpacity=D.surfaceOpacity),"color"in m&&(P.color=a(this.userData,D.color)),"resolution"in m&&(P.resolution=D.resolution),T.push(...h(b,P))}),T},f=r.graphMode;switch(f){case 26:case 4:{let{points:x,droppedIndices:T}=Cm([t.asValue()]),b=this.userData.shouldGraph&&c.points,M=this.userData.showLabel&&!b;if(b)return[{segments:[x],graphMode:f,droppedIndices:T,color:Ra(this.userData,this.metaData),style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointOpacity:this.metaData.computedPointOpacity,pointSize:this.metaData.computedMovablePointSize,suppressTextOutline:this.userData.suppressTextOutline,editableLabel:o(this.userData),labels:this.computedLabels||[],poi:go(x),movablePointInfo:[]}];if(M){let P;switch(f){case 4:P=3;break;case 26:P=25;break;default:let D=f;throw new Error(`Unexpected graphMode: ${D}`)}return[{segments:[x],graphMode:P,color:Ra(this.userData,this.metaData),style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,nakedLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointOpacity:this.metaData.computedPointOpacity,suppressTextOutline:this.userData.suppressTextOutline,editableLabel:o(this.userData),labels:this.computedLabels||[],poi:go(x),showPoint:!1}]}else return[]}case 25:case 3:{let x=[],T=this.userData.shouldGraph&&c.points,b=this.userData.shouldGraph&&c.lines,M=["colorLatexValue"];T&&M.push("computedPointOpacity","computedPointSize"),(this.userData.showLabel||T)&&M.push("computedLabelSize","computedLabelAngle");let P=Dl(this.metaData,M,i),D=Fb.wrap(t).asValue();ms(D),D.length>P&&(D.length=P);let S=this.userData.showLabel&&!T&&!b,O=Cm(D);if(this.userData.showLabel||T){let _={segments:[O.points],graphMode:f,droppedIndices:O.droppedIndices,color:this.metaData.colorLatexValue||this.userData.color,style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,showPoint:T,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointSize:this.metaData.computedPointSize,pointOpacity:this.metaData.computedPointOpacity,suppressTextOutline:this.userData.suppressTextOutline,interactiveLabel:!!this.userData.interactiveLabel,editableLabel:o(this.userData),nakedLabel:S,labels:this.computedLabels||[],poi:go(D)};e.is3dPolicy()?x.push(...O8(_)):x.push(_)}if(b){let _=this.metaData.computedLineWidth,L={segments:rw(D),graphMode:5,color:Ra(this.userData,this.metaData),style:this.userData.lineStyle,lineWidth:_,lineOpacity:this.metaData.computedLineOpacity,poi:Ir()};x.push(KL(e,L,n,_))}return x}case 114:{let x=[],T=this.userData.shouldGraph&&c.points,b=this.userData.shouldGraph&&c.lines,M=["colorLatexValue"];T&&M.push("computedPointOpacity","computedPointSize");let P=Fb.wrap(t).asValue();ms(P);let D=Dl(this.metaData,M,i),S=Math.min(P.length,D);if(T)for(let O=0;O<S;O++){let{color:_}=uc(this,O,i),L=Aa(this.metaData.computedPointSize,O,i);x.push({graphMode:114,position:P[O],radius:.02*L,guid:Ns(),color:_})}if(b){let O=Aa(this.metaData.computedLineWidth,0,i),{color:_}=uc(this,0,i);x.push({graphMode:100,points:Dm(P,n.viewport,O),thickness:O,guid:Ns(),color:_})}return x}case 117:{let x=this.metaData.colorLatexValue?!Array.isArray(this.metaData.colorLatexValue):!0,T=this.metaData.computedSurfaceOpacity,b=[],M=[],P=[],D=[],S=[],[O,_,L]=[new st,new st,new st],[w,G,k]=[new st,new st,new st],Z=(Y,re,Ee,he,K,Oe,te,Ze,dt)=>{if(w.set(Y,re,Ee),G.set(he,K,Oe),k.set(te,Ze,dt),!w.isFinite()||!G.isFinite()||!k.isFinite())return;let me=b.length/3;b.push(w.x,w.y,w.z,G.x,G.y,G.z,k.x,k.y,k.z),O.subVectors(w,k),_.subVectors(G,w),L.crossVectors(O,_),M.push(L.x,L.y,L.z,L.x,L.y,L.z,L.x,L.y,L.z),P.push(me,me+1,me+2),D.push(0,0,0,1,1,0)},F=()=>{let Y={guid:Ns(),resolved:!0,positions:new Float32Array(b),normals:new Float32Array(M),faces:new Uint32Array(P),uvs:new Float32Array(D),extraAttrs:new Float32Array([])};return S.length&&(Y.colors=new Float32Array(S)),Y};if(t.valueType===yr&&!Array.isArray(T)){let Y=this.metaData.computedSurfaceOpacity,re="";if(x){let Ee=(d=this.metaData.colorLatexValue)!=null?d:this.userData.color;re=a(this.userData,Ee)}return p({color:!0},(Ee,he)=>{if(Ee.valueType===Rn){let[[K,Oe,te],[Ze,dt,me],[J,W,Ge]]=Ee.asValue();if(Z(K,Oe,te,Ze,dt,me,J,W,Ge),!x){let[be,ue,_e]=QC(he.color);S.push(be,ue,_e,be,ue,_e,be,ue,_e)}}return[]}),[{meshData:F(),color:re,surfaceOpacity:Y!=null?Y:1,graphMode:117}]}return p({color:!0,surfaceOpacity:!0},(Y,re)=>{var W;let[[Ee,he,K],[Oe,te,Ze],[dt,me,J]]=Y.asValue();return b=[],M=[],P=[],D=[],Z(Ee,he,K,Oe,te,Ze,dt,me,J),[{meshData:F(),color:a(this.userData,re.color),surfaceOpacity:(W=re.surfaceOpacity)!=null?W:1,graphMode:117}]})}case 119:{let x=this.metaData.colorLatexValue?!Array.isArray(this.metaData.colorLatexValue):!0;if(t.valueType===mr&&x&&!Array.isArray(this.metaData.computedLineWidth)){let T=(y=this.metaData.colorLatexValue)!=null?y:this.userData.color,b=this.metaData.computedLineWidth,M=[];return p({color:!0},P=>{if(P.valueType===wt){let[[D,S,O],[_,L,w]]=P.asValue();M.push(D,S,O,_,L,w,NaN,NaN,NaN)}return[]}),[{graphMode:119,guid:Ns(),points:M,color:T,thickness:b!=null?b:1}]}return p({color:!0,lineWidth:!0},(T,b)=>{let{lineWidth:M,color:P}=b,D=T.asValue(),[[S,O,_],[L,w,G]]=D;return sw(S,O,_,L,w,G)?[]:[{graphMode:119,guid:Ns(),points:[S,O,_,L,w,G],color:P,thickness:M}]})}case 129:let m=this.metaData.colorLatexValue?!Array.isArray(this.metaData.colorLatexValue):!0;if(t.valueType===gr&&m&&!Array.isArray(this.metaData.computedLineWidth)){let x=(g=this.metaData.colorLatexValue)!=null?g:this.userData.color,T=this.metaData.computedLineWidth,b=[];return p({color:!0},M=>{if(M.valueType===ke){let[[P,D,S],[O,_,L]]=M.asValue();b.push(O,_,L,P+O,D+_,S+L)}return[]}),[{graphMode:129,guid:Ns(),points:b,color:x,thickness:T!=null?T:1}]}return p({color:!0,lineWidth:!0},(x,T)=>{let{lineWidth:b,color:M}=T,P=x.asValue(),[[D,S,O],[_,L,w]]=P;return sw(D,S,O,_,L,w)?[]:[{graphMode:129,guid:Ns(),points:[_,L,w,D+_,S+L,O+w],color:M,thickness:b}]});case 118:return p({color:!0,resolution:!0,surfaceOpacity:!0},(x,T)=>{let{color:b,surfaceOpacity:M}=T,P=x.asValue(),[[D,S,O],_]=P,L=Math.abs(_);return isNaN(D)||isNaN(S)||isNaN(O)||isNaN(_)?[]:[{graphMode:118,position:[D,S,O],radius:[L,L,L],guid:Ns(),color:b,surfaceOpacity:M!=null?M:1}]});case 5:case 100:{let x=this.userData,T=this.metaData,b=[],M=p({color:!0,lineOpacity:!0,lineWidth:!0,resolution:!0},(D,S)=>{var _;let O=D.getDependencies();if(O.length===0&&!ua(D.valueType)){let{points:L,droppedIndices:w}=Cm([D.asValue()]);return[{segments:[L],graphMode:3,droppedIndices:w,color:Ra(x,T),style:x.lineStyle,showPoint:!1,poi:go(L)}]}else{let L=D.getCompiledFunction(O);S.domain=(_=L.domain)!=null?_:{type:"1d",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax};let w=cu({viewState:n,graphInfo:S,compiled:L});return[KL(e,w,n,S.lineWidth)]}}),P=[];for(let D of M)D&&P.push(D);if(c.fill)if(P.forEach((D,S)=>{let{color:O,fillOpacity:_,listIndex:L}=uc(this,S,i);b.push({segments:D.segments,color:O,fillOpacity:_,listIndex:L,graphMode:7,poi:Ir()})}),c.lines)P=P.concat(b);else return b;return P}case 20:return p({lineOpacity:!0,lineWidth:!0,color:!0},(x,T)=>{let[[b,M],P]=x.asValue();return isNaN(b)||isNaN(M)||isNaN(P)?[]:[{segments:[[b,M,P]],resolved:!0,graphMode:T.graphMode,color:T.color,style:T.lineStyle,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:T.operator,poi:Ir()}]});case 21:return p({color:!0,lineWidth:!0,lineOpacity:!0},(x,T)=>{let b=Rg(x.asValue());if(!b)return[];let M=[];return b.type==="arc"?M.push({graphMode:f,segments:[[b.center[0],b.center[1],b.radius,b.startAngle,b.endAngle]],color:T.color,style:T.lineStyle,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:r.operator,poi:Ir()}):b.type==="rays"?M.push({graphMode:19,segments:[[b.start1[0],b.start1[1],b.end1[0],b.end1[1]]],color:T.color,style:T.lineStyle,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:r.operator,poi:Ir()},{graphMode:19,segments:[[b.start2[0],b.start2[1],b.end2[0],b.end2[1]]],color:T.color,style:T.lineStyle,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:r.operator,poi:Ir()}):M.push({graphMode:17,segments:[[b.start[0],b.start[1],b.end[0],b.end[1]]],color:T.color,style:T.lineStyle,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:r.operator,poi:Ir()}),[...M,...o1(M,s)]});case 17:case 18:case 19:return p({color:!0,lineWidth:!0,lineOpacity:!0},(x,T)=>{let[[b,M],[P,D]]=x.asValue();if(isNaN(b)||isNaN(M)||isNaN(P)||isNaN(D))return[];let S=[],O={segments:[[b,M,P,D]],resolved:!0,graphMode:T.graphMode,color:T.color,style:T.lineStyle,arrowMode:T.arrowMode,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:r.operator,poi:Ir()};if(S.push(ew(e,O,n)),S.push(...o1([O],s)),this.userData.showLabel&&r.graphMode===17){let _=T.listIndex,L=this.computedLabels&&this.computedLabels[_||0];S.push({graphMode:22,objectType:17,segments:[[b,M,P,D]],color:T.color,listIndex:_,showLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,labels:L?[L]:[I8(Oi(P-b,D-M),n)]})}return S});case 24:return p({lineOpacity:!0,lineWidth:!0,color:!0},(x,T)=>{let[b,M]=x.asValue(),[[P,D],[S,O]]=[M,[M[0]+b[0],M[1]+b[1]]];if(isNaN(S)||isNaN(O)||isNaN(P)||isNaN(D))return[];let _={segments:[[P,D,S,O]],resolved:!0,graphMode:T.graphMode,color:T.color,style:T.lineStyle,arrowMode:T.arrowMode,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:r.operator,poi:Ir()};return[ew(e,_,n)]});case 23:return p({lineOpacity:!0,lineWidth:!0,color:!0},(x,T)=>{let{value:b,valueType:M}=x.asTypedValue(),[[P,D],S,O]=b;if(isNaN(P)||isNaN(D)||isNaN(S)||isNaN(O))return[];let _=T.listIndex,L=M===ye,w=L?O:Math.abs(O),G=[];if(G.push({graphMode:23,segments:[[P,D,S,O,L?1:0]],color:T.color,style:T.lineStyle,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:_,operator:r.operator,poi:Ir()}),this.userData.showAngleLabel){let k=this.computedLabels&&this.computedLabels[_||0];G.push({graphMode:22,objectType:23,segments:[[P,D,S,O]],color:T.color,listIndex:_,showLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,labels:k?[k]:[E8(w,n)]})}return G});case 1:case 2:case 8:case 112:case 126:case 113:case 127:case 6:case 130:case 103:case 106:case 107:case 108:case 109:case 110:case 111:case 120:case 121:case 122:case 123:case 124:{let x=t.valueType===I;return p({lineOpacity:!0,lineWidth:!0,resolution:!0,fillOpacity:!0,surfaceOpacity:!0,color:!0},(T,b)=>{var F,Y,re,Ee,he,K,Oe,te,Ze,dt,me;(r.graphMode===6||r.graphMode===110||r.graphMode===124)&&(b.domain={type:"1d",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax,isExplicit:this.metaData.isExplicitDomain});let M=(F=vi[r.graphMode])!=null?F:[],P=T.getCompiledFunction(M);(r.graphMode==130||r.graphMode==103||r.graphMode==111||r.graphMode==109)&&(b.domain=(Y=P.domain)!=null?Y:{type:"2d",uMin:this.metaData.evaluatedDomain3DMin1,uMax:this.metaData.evaluatedDomain3DMax1,vMin:this.metaData.evaluatedDomain3DMin2,vMax:this.metaData.evaluatedDomain3DMax2});let D=[],S;try{S=T.getCompiledDerivative()}catch(J){}let O=S8(this,T,P,n,b,S,x);if(O)return O;let _=hC(b.graphMode),L=(re=this.userData.extendTo3D)!=null?re:!1,w=_&&!L,G=!e.is3dPolicy()||w,k=(Ee=this.userData.lines)!=null?Ee:G,Z=(he=this.userData.lines)!=null?he:!w;if(b.graphMode===127&&!L&&((K=this.userData.lines)==null||K)){let J=(Oe=vi[b.graphMode])!=null?Oe:[],W=T._chunk.copy();W.GreaterEqual([W.getReturnIndex(),W.Constant(0)]);let Ge=T.getCompiledFunction(J),be=0,ue=n.viewport,At=_b((_t,bc,xc)=>xc-be,ue);return[{meshData:Wi(At),color:b.color,surfaceOpacity:(te=b.surfaceOpacity)!=null?te:1,uvArgs:(Ze=vi[b.graphMode])!=null?Ze:[],extraMeshArgs:(dt=Ol[b.graphMode])!=null?dt:[],graphMode:106,compiled:Ge,restrictionShader:Ma(W,ac)}]}if(_&&(this.userData.lines===!0?(k=w,Z=!w):this.userData.lines===!1&&(k=!1,Z=!1)),Z&&va(b.graphMode)){let J=zb(b.graphMode);if(b.graphMode===113||b.graphMode===127){let{positions:W,normals:Ge,faces:be,uvs:ue}=JL(),_e={guid:Ns(),isDomainCube:!0,resolved:!0,positions:W,normals:Ge,faces:be,uvs:ue,extraAttrs:new Float32Array([])},At=T.toImplicitBool();D.push({meshData:_e,graphMode:113,color:b.color,surfaceOpacity:1,uvArgs:[],extraMeshArgs:[],compiled:P,restrictionShader:Ma(At._chunk,ac)});let ze=kN(At._chunk,T._chunk,J);for(let Ce of ze){let _t=QL(b,{concrete:new on(Ce.value),restriction:Ce.restriction&&Ma(Ce.restriction,ac)},n);D.push(_t)}}else{let W=T.getRestrictedFunctionForGLSL(J,ac),Ge=QL(b,W,n);D.push(Ge)}}if(k&&C8(this,b),!va(b.graphMode)){let J=cu({viewState:n,graphInfo:b,compiled:P,derivative:S}),W=cw(ou(this),T);if(W&&(J.boundingBox=W),e.is3dPolicy()&&k&&l1(J.graphMode)){let Ge=(me=b.lineWidth)!=null?me:1;D.push(kb(J,n,Ge))}else if(J.fillSegments){let{fillSegments:Ge,...be}=J;k||(be.lineWidth=0),D.push(be)}else k||(J.lineWidth=0),(k||!va(r.graphMode))&&D.push(J);b.graphMode===8&&b.operator!=="="&&D.push({graphMode:7,segments:J.fillSegments,poi:Ir(),listIndex:b.listIndex,color:b.color,fillOpacity:b.fillOpacity})}return D})}case 200:case 201:case 202:case 206:case 205:case 211:case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:case 209:return p({color:!0,lineWidth:!0,lineOpacity:!0,resolution:!0},(x,T)=>{var re;let b=(re=vi[f])!=null?re:[],M=x.getCompiledFunction(b).domain;switch(f){case 206:case 211:T.domain={type:"1d",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax,isExplicit:this.metaData.isExplicitDomain};break;case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:T.domain=M!=null?M:{type:"2d",uMin:this.metaData.evaluatedDomain3DMin1,uMax:this.metaData.evaluatedDomain3DMax1,vMin:this.metaData.evaluatedDomain3DMin2,vMax:this.metaData.evaluatedDomain3DMax2};break}let P={allowSlices:!0},D=tu(x._chunk,b,P),{valueChunk:S,slices:O}=D.getValueAndRestrictionChunk(),_=S.getInstruction(S.getReturnIndex()).valueType,L=ua(_)?Jg(S):S.getCompiledFunction(b),w=O[0],G=w.type==="implicit",k=G?NaN:w.value,Z=G?"_implicit":w.variable,F,Y=Ee=>cu({viewState:n,graphInfo:{...T,slice_coordinate:Z,slice_value:k,slice_function:Ee},compiled:L});if(G){let Ee=["x","y","z"],he=["x","y","z","r","theta"],K=["x","y","z","rho","theta","phi"],Oe=["x","y","z","u","v"],te=w.sliceChunk;switch(f){case 200:case 201:case 202:F=te.getCompiledFunction(Ee);break;case 211:case 213:F=te.getCompiledFunction(he);break;case 212:F=te.getCompiledFunction(K);break;case 215:case 214:F=te.getCompiledFunction(Oe);break;case 209:{let Ze=(J,W)=>{let Ge=W.getCompiledFunction(Ee),be=J._symbol,ue=J._expression.args,_e=[];for(let At of ue){if(!(At instanceof on))throw U("Programming Error: bad type");if(be==="x")L=At._chunk.getCompiledFunction(["y","z"]),T.graphMode=201;else if(be==="y")L=At._chunk.getCompiledFunction(["x","z"]),T.graphMode=202;else if(be==="z")L=At._chunk.getCompiledFunction(["x","y"]),T.graphMode=200;else throw U("Programming Error: bad lhs");_e.push(Y(Ge))}return _e},dt=(J,W)=>{let Ge=n.viewport,be=W.getCompiledFunction(Ee),ue=J.getCompiledFunction(Ee).fn,_e=r1(ue,Ge);if(_e){let{explicitPlane:At,u:ze,v:Ce}=_e;return T.graphMode=214,L={args:["u","v"],source:"",constants:[],fn:At,executionMetadata:{}},T.domain={type:"2d",uMin:ze.min,uMax:ze.max,vMin:Ce.min,vMax:Ce.max},[Y(be)]}else return[]};if(te.isImplicitPlane())return dt(te,S);if(S.isImplicitPlane())return dt(S,te);let me=gC(e,S);return me instanceof C.SolvedEquation&&!me.isError?Ze(me,te):(me=gC(e,te),me instanceof C.SolvedEquation&&!me.isError?Ze(me,S):[Y(te.getCompiledFunction(Ee))])}}}return[Y(F)]});case 210:return p({color:!0,surfaceOpacity:!0,resolution:!0},(x,T)=>{var Y,re,Ee,he,K,Oe,te,Ze;let b=(Y=vi[f])!=null?Y:[],M={allowSlices:!0},P=tu(x._chunk,b,M),{restrictionChunk:D,slices:S}=P.getSlicesAndRestrictionChunk(),O=D.getCompiledFunction(b);if(S[0].type==="implicit"){let dt=S[0].sliceChunk,me;try{me=dt.copy().gradient(["x","y","z"]).getCompiledFunction(["x","y","z"]).fn}catch(be){}let J=(re=T.resolution)!=null?re:NaN;return isNaN(J)&&(J=Im),J=hr(J,0,100),[{meshData:d1(dt.getCompiledFunction(b),void 0,me,n.viewport,J,{isInequality:!1}),color:T.color,surfaceOpacity:(Ee=T.surfaceOpacity)!=null?Ee:1,uvArgs:(he=vi[T.graphMode])!=null?he:[],extraMeshArgs:(K=Ol[T.graphMode])!=null?K:[],graphMode:f,compiled:O,restrictionShader:Ma(D,ac)}]}let _=S[0].value,L=S[0].variable,w=n.viewport,G;switch(L){case"x":G=(dt,me,J)=>dt-_;break;case"y":G=(dt,me,J)=>me-_;break;case"z":G=(dt,me,J)=>J-_;break;default:return[]}let k=_b(G,w);return[{meshData:Wi(k),color:T.color,surfaceOpacity:(Oe=T.surfaceOpacity)!=null?Oe:1,uvArgs:(te=vi[T.graphMode])!=null?te:[],extraMeshArgs:(Ze=Ol[T.graphMode])!=null?Ze:[],graphMode:f,compiled:O,restrictionShader:Ma(D,ac)}]});case 16:{let x=[],T=this.userData.lines===void 0?!0:this.userData.lines,b=this.userData.fill===void 0?!0:this.userData.fill;if(!b&&!T)return x;let M=Dl(this.metaData,["computedLineOpacity","computedLineWidth","colorLatexValue","fillOpacity"],i),P=t.asValue();j(t.valueType)||(P=[P]);for(let D=0;D<P.length;D++){if(D>M-1)continue;let S=P[D];if(!S.length)continue;let O=this.getGraphInfo(e,t),{listIndex:_,lineWidth:L,lineOpacity:w,fillOpacity:G,color:k}=uc(this,D,i);!this.userData.shouldOmitLastPolygonSegment&&S.length>2&&(S=[...S,S[0]]),ms(S);let Z=rw(S);if(Z.length){if(b&&S.length>2&&x.push({segments:Z,graphMode:7,poi:Ir(),color:k,fillOpacity:G,style:O.style,listIndex:_}),T&&(x.push({segments:Z,graphMode:5,poi:Ir(),color:k,style:this.userData.lineStyle,lineWidth:L,lineOpacity:w,listIndex:_}),s))for(let F=0;F<S.length-1;F++){za(s.parentType,[xe,In]);let Y=s.getEdgeIntersections(F);if(!Y)continue;let[re,Ee]=S[F],[he,K]=S[F+1];x.push(...o1([{segments:[[re,Ee,he,K]],resolved:!0,graphMode:17,color:k,style:this.userData.lineStyle,arrowMode:O.arrowMode,lineWidth:L,lineOpacity:w,listIndex:_,poi:Ir()}],Y))}if(T8&&this.userData.showLabel){let F=this.computedLabels&&this.computedLabels[_||0];x.push({graphMode:22,objectType:16,segments:Z,color:k,listIndex:_,showLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,labels:F?[F]:[P8(qE(S),n)]})}}}return x}case 7:case 11:case 10:case 15:case 22:case 128:return!1;default:let h=f;throw new Error(`Unexpected graphMode: ${h}`)}}function QL(e,t,n){var c,l,p;let r=(c=vi[e.graphMode])!=null?c:[],s=t.concrete.getCompiledFunction(r),i,o,a=!1;if(e.graphMode===112||e.graphMode===126||e.graphMode===113){e.operator!=="="&&(a=!0);try{i=t.concrete.gradient(["x","y","z"])._chunk,o=i.getCompiledFunction(["x","y","z"]).fn}catch(f){}}if(e.graphMode===112&&o&&i){let f=D8(s.fn,o,i,n.viewport);if(f)return{graphMode:118,position:f.center,radius:f.radii,guid:Ns(),color:e.color,restrictionShader:t.restriction,surfaceOpacity:(l=e.surfaceOpacity)!=null?l:1}}let u=e.graphMode;if((u===112||u===113||u===127||u===106||u===107||u===108)&&t.concrete._chunk.isLinearIn(["x","y","z"])||u===106&&t.concrete._chunk.isConstant()){let f=n.viewport,d;switch(u){case 106:d=(m,h,x)=>x-s.fn(m,h);break;case 107:d=(m,h,x)=>m-s.fn(h,x);break;case 108:d=(m,h,x)=>h-s.fn(m,x);break;case 112:case 113:case 127:d=s.fn;break}let y=Wi(_b(d,f)),g=u===113||u===127;return u===127&&(u=113),{meshData:y,color:e.color,surfaceOpacity:g?1:(p=e.surfaceOpacity)!=null?p:1,uvArgs:[],extraMeshArgs:[],graphMode:u,compiled:s,restrictionShader:t.restriction}}return cu({viewState:n,graphInfo:e,compiled:s,restrictionShader3d:t.restriction,isImplicit3dInequality:a,gradient:o,dependencies:t.concrete._dependencies})}function C8(e,t){var r,s,i;if(hC(t.graphMode))switch(t.graphMode){case 121:case 123:{t.graphMode=2,t.willConvertTo3D=!0,(r=t.lineWidth)!=null||(t.lineWidth=1);break}case 120:case 122:{t.graphMode=1,t.willConvertTo3D=!0,(s=t.lineWidth)!=null||(t.lineWidth=1);break}case 124:let{min:o,max:a}=((i=t.domain)==null?void 0:i.type)==="1d"?t.domain:{min:0,max:2*Math.PI};t.graphMode=6,t.domain={type:"1d",min:o,max:a,isExplicit:e.metaData.isExplicitDomain};break;case 126:t.graphMode=8;break}}function D8(e,t,n,r){if(r.zmin===void 0||r.zmax===void 0)return;let s=n.argNames.indexOf("x"),i=n.argNames.indexOf("y"),o=n.argNames.indexOf("z");if(s===-1||i===-1||o===-1)return;let a=n.getInstruction(n.getReturnIndex());if(a.type!==38||a.args.length!==3)return;let[u,c,l]=a.args,p=ns(n,s,{allowRestriction:!1,allowClosedBlockReferences:!1}),f=ns(n,i,{allowRestriction:!1,allowClosedBlockReferences:!1}),d=ns(n,o,{allowRestriction:!1,allowClosedBlockReferences:!1});if(ln(p,u)!==1||ln(f,c)!==1||ln(d,l)!==1||ln(f,u)!==0||ln(d,u)!==0||ln(p,c)!==0||ln(d,c)!==0||ln(p,l)!==0||ln(f,l)!==0)return;let{xmin:y,ymin:g,zmin:m,xmax:h,ymax:x,zmax:T}=r,b=t(y,g,m),M=t(h,x,T),P=.5*(M[0]-b[0])/(h-y),D=.5*(M[1]-b[1])/(x-g),S=.5*(M[2]-b[2])/(T-m),O=(y*M[0]-h*b[0])/(M[0]-b[0]),_=(g*M[1]-x*b[1])/(M[1]-b[1]),L=(m*M[2]-T*b[2])/(M[2]-b[2]),w=-e(O,_,L),G=Math.sqrt(w/P),k=Math.sqrt(w/D),Z=Math.sqrt(w/S);if(!(!isFinite(O)||!isFinite(_)||!isFinite(L)||!isFinite(G)||!isFinite(k)||!isFinite(Z)||G===0||k===0||Z===0))return{center:[O,_,L],radii:[G,k,Z]}}function S8(e,t,n,r,s,i,o){let a=e.metaData.evaluatedCDFMin,u=e.metaData.evaluatedCDFMax,c=ou(e),l=cw(c,t),p=c&&c.discrete;if(a!==void 0&&u!==void 0&&!isNaN(a)&&!isNaN(u)&&o){let f=[];if(p){let d={viewState:r,graphInfo:s,compiled:n,bounds:[a,u],maxOverride:tw(c,t),showPoint:e.userData.shouldGraph},y=YL(d),g=y.cdfTopBranch,m=y.topBranches;if(m.forEach(h=>{!h||!l||(h.boundingBox=l)}),m.every(h=>h!==void 0)&&(f=m,g&&g.segments[0].length)){let h=[];g.segments[0].forEach(x=>{!isNaN(x[0])&&!isNaN(x[1])&&h.push([x[0],0,x[0],x[1]])}),f.push({graphMode:5,segments:h,boundingBox:l,poi:Ir(),color:s.color})}}else{let y=XL({viewState:r,graphInfo:s,compiled:n,derivative:i,bounds:[a,u]}),g=y.cdfTopBranch,m=y.topBranches;if(m.forEach(h=>{!h||!l||(h.boundingBox=l)}),f=m,g&&g.segments.length){let h,x;for(let T=0;T<g.segments.length;T++){let b=g.segments[T];if(b.length>=4){h=b[0];break}}for(let T=g.segments.length-1;T>=0;T--){let b=g.segments[T];if(b.length>=4){x=b[b.length-2];break}}if(h!==void 0&&x!==void 0&&isFinite(h)&&isFinite(x)){let T=Hb(g.segments,[[h,0,x,0]],g.graphMode);f.push({graphMode:7,segments:T,poi:Ir(),color:s.color})}}}return f}else if(p){let f=Nb({viewState:r,graphInfo:s,compiled:n,showPoint:e.userData.shouldGraph,maxOverride:tw(c,t)});return l&&(f.boundingBox=l),[f]}else return}function iw(e){return v8(e)||l1(e)||ow(e)}function v8(e){return e===3}function i1(e,t){let n=t!=null?t:{};if(!Array.isArray(e))return()=>e;let r=Object.keys(n).length===0?e:e.filter((s,i)=>!n[i]);return s=>r[s]}function O8(e){var i,o;let t=e.droppedIndices,n=i1((i=e.pointSize)!=null?i:1,t),r=i1(e.color,t),s=i1((o=e.pointOpacity)!=null?o:1,t);return e.segments[0].map(([a,u],c)=>({graphMode:114,position:[a,u,0],radius:.02*n(c),guid:Ns(),color:r(c),fillOpacity:s(c)}))}function KL(e,t,n,r){return e.is3dPolicy()&&l1(t.graphMode)?kb(t,n,r!=null?r:1):t}function l1(e){switch(e){case 1:case 2:case 6:case 8:case 5:return!0;default:return!1}}function kb(e,t,n,r=0){var o;let s=aw(e,t,r),i=Dm(s,t.viewport,n);return{graphMode:128,guid:Ns(),points:i,resolved:e.resolved,color:e.color,compiled:e.compiled,thickness:(o=e.lineWidth)!=null?o:1}}function ew(e,t,n){return e.is3dPolicy()&&ow(t.graphMode)?N8(t,n):t}function ow(e){switch(e){case 17:case 24:return!0;default:return!1}}function N8(e,t){var r;let n=aw(e,t);return{graphMode:e.graphMode===17?119:e.graphMode===24?129:128,guid:Ns(),points:R8(n),color:e.color,thickness:(r=e.lineWidth)!=null?r:1}}function R8(e){let t=[];for(let[n,r,s]of e)t.push(n,r,s);return t}function aw(e,t,n=0){function r(i,o){if(e.graphMode===1)return[o,i];if(e.graphMode===6){let a=t.degreeMode?i*Math.PI/180:i;return[o*Math.cos(a),o*Math.sin(a)]}else return[i,o]}let s=[];for(let i=0;i<e.segments.length;i++){let o=e.segments[i];for(let a=0;a<o.length/2;a++){let[u,c]=r(o[2*a],o[2*a+1]);s.push([u,c,n])}i<e.segments.length-1&&s.push([NaN,NaN,0])}return s}function Dm(e,t,n){if(t.zmin===void 0||t.zmax===void 0)return[];let{xmin:r,xmax:s,ymin:i,ymax:o,zmin:a,zmax:u}=t,c=s-r,l=o-i,p=u-a,f=n/200,d=[],y=1e-4;for(let h=0;h<e.length;h++){let x=e[h];if(isFinite(x[0])&&isFinite(x[1])&&isFinite(x[2])){let T=d[d.length-1];T!==void 0&&Math.abs(x[0]-T[0])<y*c&&Math.abs(x[1]-T[1])<y*l&&Math.abs(x[2]-T[2])<y*p||d.push(x)}else d.push(void 0)}let g=[],m=d.length;for(let h=0;h<m;h++){let x=d[h];if(!x){g.push(NaN,NaN,NaN);continue}let[T,b,M]=x,P=d[h-1],D=d[h+1];if(P&&D){let[S,O,_]=P,[L,w,G]=D,k=(T-S)/c,Z=(L-T)/c,F=(b-O)/l,Y=(w-b)/l,re=(M-_)/p,Ee=(G-M)/p,he=Ts(k,F,re),K=Ts(Z,Y,Ee);if((Z*k+Y*F+Ee*re)/(he*K)<.7&&he>f&&K>f){let te=.5*(f/he),Ze=.5*(f/K),dt=Po(S,T,1-te),me=Po(O,b,1-te),J=Po(_,M,1-te),W=Po(T,L,Ze),Ge=Po(b,w,Ze),be=Po(M,G,Ze);g.push(dt,me,J),g.push(Po(dt,T,.5),Po(me,b,.5),Po(J,M,.5)),g.push(T,b,M),g.push(Po(T,W,.5),Po(b,Ge,.5),Po(M,be,.5)),g.push(W,Ge,be)}else g.push(T,b,M)}else g.push(T,b,M)}return g}function Po(e,t,n){return(1-n)*e+n*t}function A8(e){return e.startsWith("shader:")}function wb(e,t,n){return{resolved:!0,graphMode:t,segments:n,operator:e.operator,poi:Ir(),color:e.color,style:"DASHED",lineWidth:1,lineOpacity:.5,isIntersectionExtension:!0}}function o1(e,t){if(!t)return[];let n=[];for(let r of e){let s=t;if("listIndex"in r&&r.listIndex!==void 0&&t instanceof gd&&(s=t.getListItemIntersections(r.listIndex)),r.graphMode===17||r.graphMode===19){za(s.parentType,[de,Ne]);let i=s.getPoints();if(!i)continue;let o=0,a,u=1,c,[l,p,f,d]=r.segments[0];for(let y=0;y<i.length;y++){let[g,m]=i[y],h=to(g,m,0,l,p,0,f,d,0);h<o&&(o=h,a=y),r.graphMode===17&&h>u&&(u=h,c=y)}a!==void 0&&n.push(wb(r,17,[[l,p,i[a][0],i[a][1]]])),c!==void 0&&n.push(wb(r,17,[[f,d,i[c][0],i[c][1]]]))}else if(r.graphMode===21){za(s.parentType,[ie]);let i=s.getPoints();if(!i)continue;let[o,a,u,c,l]=r.segments[0],p=l-c+(l<c?1:-1)*2*Math.PI,f=[];for(let d of i){let[y,g]=d,m=Math.atan2(g-a,y-o),h=W1(m,c,p);0<h&&h<1&&f.push(h)}if(f.length){f.push(0,1),f.sort();let d=0,y=0;for(let h=0;h<f.length-1;h++){let x=f[h+1]-f[h];(d===void 0||x>d)&&(d=x,y=h)}let g=f[y],m=f[y+1];g>0&&n.push(wb(r,21,[[o,a,u,c,c+g*p]])),m<1&&n.push(wb(r,21,[[o,a,u,l,l-(1-m)*p]]))}}}return n}function _8(){throw new Error("Programming error: this function is not expected to be called")}function uw(e,t,n,r){let s=[];for(let i=0;i<t.otherVariableSolutionData.length;i++){let o=t.otherVariableSolutionData[i];if(!o)continue;let{coefficients:a,restriction:u}=o,c=a.argNames[0];if(c!=="x"&&c!=="y")continue;let l=a.getCompiledFunction().fn,p,f;c==="y"?(p=1,f=2):(p=2,f=1);let d=void 0,{listIndex:y,style:g,lineWidth:m,lineOpacity:h,color:x}=uc(e,i,d),T=Td(n,{graphMode:p,domainBound:dr(),lineWidth:m,operator:"="},_8);if(!T)continue;let b=dw(l,T);for(let M of b){let P=new on(u.substituteConstantArguments({[c]:M})),D=e.getGraphInfo(r,P);D={...D,graphMode:f,lineWidth:m};let O=e._graph(r,P,n,D,void 0,t.branchMultiplier===2?"solvedEquation":void 0);if(Bo(O))for(let _ of O)s.push({..._,listIndex:y,style:g,lineWidth:m,lineOpacity:h,color:x})}}return s.length>0?s:!1}C.Base.prototype.tryGraph=function(e,t,n,r){var s,i,o;try{let a=this.graph(e,t,n,r);if(Array.isArray(a))for(let u of a){if(!("compiled"in u))continue;let c=(s=u.compiled)==null?void 0:s.executionMetadata;c&&(c.recursionTerminationStatus&&(u.recursionTerminationStatus=c.recursionTerminationStatus),((i=c.badCoercionCount)!=null?i:0)>=1&&((o=c.goodCoercionCount)!=null?o:0)<=2&&(u.nanBlame="ComplexCoercion"))}return a}catch(a){let u=a instanceof C.Error?a.getError():U(a).getError();return[pw(u)]}};C.Base.prototype.graph=function(e,t,n,r){let s=this.getGraphInfo(e,t);return this._graph(e,t,n,s,r)};C.BaseComparator.prototype.graph=function(e,t,n){let r=this.getGraphInfo(e,t),s=r.graphMode,i="baseComparator",o=this.userData.lines===void 0?!0:this.userData.lines;if(s===8||s===112||s===113||s===127||s===210)return this._graph(e,t,n,r);if(s===10||!(t instanceof C.SolvedEquation))return!1;let a=this.getOperator(),u=[],c=[],l=!0;t._expression.eachElement(m=>{u.push(m.getCompiledFunction());try{c.push(m.getCompiledDerivative())}catch(h){l=!1}}),l||(c=void 0);let p=[],f=[-1,0,0,1],d=Dl(this.metaData,["computedLineWidth","computedLineOpacity","computedFillOpacity","colorLatexValue"],i),y=Math.min(u.length,d);for(let m=0;m<y;m++){let h=this.getGraphInfo(e,t._expression.args[m]);h.graphMode=s;let{listIndex:x,style:T,color:b,lineWidth:M,lineOpacity:P,fillOpacity:D}=uc(this,m,i);h.listIndex=x,h.style=T,h.color=b,r.graphMode===6&&(h.domain={type:"1d",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax,isExplicit:this.metaData.isExplicitDomain});let S=cu({viewState:n,graphInfo:h,compiled:u[m],derivative:c?c[m]:void 0});S.lineWidth=M,S.lineOpacity=P,S.fillOpacity=D,S.operator=nl(Jr[a].inclusive,f[m%4]),o||(S.lineWidth=0),p.push(S)}for(let m=0;m<y;m+=4){let h=Hb(p[m+1].segments,p[m+2].segments,s);p.push({graphMode:7,listIndex:p[m].listIndex,segments:h,poi:Ir(),fillOpacity:p[m].fillOpacity,color:p[m].color})}let g=uw(this,t,n,e);if(g){for(let m of g)m.operator=nl(Jr[a].inclusive,0);Array.prototype.push.apply(p,g)}return p};C.DoubleInequality.prototype.graph=function(e,t,n){let r=this.getGraphInfo(e,t);if(r.graphMode===10)return!1;let s=[],i=nl(Jr[this._operators[0]].inclusive,0),o=nl(Jr[this._operators[1]].inclusive,0),a=this.userData,u=this.metaData,c=a.lines===void 0?!0:a.lines,l=["colorLatexValue","computedFillOpacity"];c&&l.push("computedLineWidth","computedLineOpacity");let p=Dl(u,l),f=t._expressions;return ms(f),Fb.eachArgs(f,(d,y)=>{let g=y;if(g>=p)return;d[0].userData=d[1].userData=a,d[0].metaData=d[1].metaData=u;let m=void 0,{color:h,lineWidth:x,lineOpacity:T,fillOpacity:b}=uc(this,g,m),M=this._graph(e,d[0],n,r)[0];M.listIndex=g,M.operator=i,M.color=h,M.lineWidth=x,M.lineOpacity=T,s.push(M);let P=this._graph(e,d[1],n,r)[0];P.listIndex=g,P.operator=o,P.color=h,P.lineWidth=x,P.lineOpacity=T,s.push(P);let D=M.segments,S=P.segments;ms(D),ms(S);let O=Hb(D,S,M.graphMode);c||(M.lineWidth=0,P.lineWidth=0),s.push({graphMode:7,listIndex:M.listIndex,segments:O,lineOpacity:T,fillOpacity:b,poi:Ir(),color:h})}),s};C.Regression.prototype.graph=function(e,t,n){var i;let r=this.getGraphInfo(e,t),s=this._graph(e,t.model,n,r);if(Array.isArray(s))for(let o of s)(i=this.tableRegressionData)!=null&&i.tableId&&(o.tableId=this.tableRegressionData.tableId);return s};function p1(e,t){let n=1/0,r=-1/0,s=1/0,i=-1/0;for(let o of t)for(let a=0;a<o.length;a+=2){let u=o[a],c=o[a+1];u<n&&(n=u),u>r&&(r=u),c<s&&(s=c),c>i&&(i=c)}if(isFinite(n)&&isFinite(s))return{type:e,xmin:n,ymin:s,xmax:r,ymax:i}}function cw(e,t){if(!e||!(t instanceof on))return;let n=t._chunk,r=n.getInstruction(n.getReturnIndex());if(r.type!==37)return;let s=e.discrete?"discreteDistribution":"continuousDistribution";if(e.symbol==="binomialdist"&&r.symbol==="binompdf"){let i=hn(n,r.args[1]),o=hn(n,r.args[2]),a=Cg(o*i,i,o);return{type:s,xmin:0,xmax:i,ymin:0,ymax:a}}if(e.symbol==="poissondist"&&r.symbol==="poissonpdf"){let i=hn(n,r.args[1]),o=Math.max(lp(Math.floor(i),i),lp(Math.ceil(i),i));return{type:s,xmin:0,xmax:2.5*i,ymin:0,ymax:o}}if(e.symbol==="normaldist"&&r.symbol==="normalpdf"){let i=hn(n,r.args[1]),o=hn(n,r.args[2]),a=_E(i,i,o);return{type:s,xmin:i-2*Math.abs(o),xmax:i+2*Math.abs(o),ymin:0,ymax:a}}if(e.symbol==="uniformdist"&&r.symbol==="uniformpdf"){let i=hn(n,r.args[1]),o=hn(n,r.args[2]),a=(i+o)/2,u=o-i,c=VE(a,i,o);return{type:s,xmin:i-u/3,xmax:o+u/3,ymin:0,ymax:c}}if(e.symbol==="tdist"&&r.symbol==="tpdf"){let i=hn(n,r.args[1]),o=Mg(0,i);return{type:s,xmin:-3,xmax:3,ymin:0,ymax:o}}}function tw(e,t){if(e===void 0||e.symbol!=="binomialdist"||!(t instanceof on))return;let n=t._chunk,r=n.getInstruction(n.getReturnIndex());if(r.type===37&&r.symbol==="binompdf")return hn(n,r.args[1])}function lw(e,t,n){let r={};n-=.5*t;for(let s=e.length-1;s>=0;s--){let i=e[s],o=Math.floor((i-n)/t);r[o]?r[o].data.push(i):r[o]={id:o,data:[i],min:o*t+n,max:o*t+n+t,center:o*t+n+t/2}}return r}C.Histogram.prototype.graph=function(e,t,n){let r=this.getGraphInfo(e,t),s=t.args[0].asValue(),i=t.args[1].asValue(),o=this.userData.vizProps&&this.userData.vizProps.binAlignment==="left"?i/2:0;ms(s);let a=lw(s,i,o),u=1;this.userData.vizProps&&this.userData.vizProps.histogramMode==="density"?u=1/(s.length*i):this.userData.vizProps&&this.userData.vizProps.histogramMode==="relative"&&(u=1/s.length);let c=[],l=[];for(let f in a){let d=a[f],y=d.data.length;l.push([d.min,0*u,d.min,y*u,d.max,y*u,d.max,0*u]);let g=0;a[d.id+1]&&(g=a[d.id+1].data.length);let m=[d.min,0*u,d.min,y*u,d.max,y*u];g<y&&m.push(d.max,g*u),c.push(m)}let p=p1("histogram",l);return p&&i&&(p.binWidth=i),[{segments:l,graphMode:7,boundingBox:p,poi:Ir(),color:r.color,fillOpacity:.4},{segments:c,graphMode:2,poi:{zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}},color:r.color}]};C.DotPlot.prototype.graph=function(e,t,n){let r=this.getGraphInfo(e,t),s=t.args[1].asValue(),i=this.userData.vizProps&&this.userData.vizProps.binAlignment==="left"?s/2:0,o=t.args[0].asValue();ms(o);let a=lw(o,s,i),u=!1,c,l=[];for(let m in a){let h=a[m];for(let x=h.data.length-1;x>=0;x--)h.center!==h.data[x]&&(u=!0)}if(this.userData.vizProps&&this.userData.vizProps.dotplotXMode==="exact")for(let m in a){c=a[m].data,c.reverse();for(let x=0;x<c.length;x++)l.push([c[x],x+1])}else for(let m in a){let h=a[m];c=h.data;for(let x=0;x<c.length;x++)l.push([h.center,x+1])}let p=p1("dotplot",l);p&&s&&(p.ymin=0,p.xmin-=.5*s,p.xmax+=.5*s,p.binWidth=s);let{computedPointOpacity:f,computedPointSize:d}=this.metaData,y=Aa(f,0),g=this.userData.pointSize?Aa(d,0):14;return[{segments:[l],graphMode:3,boundingBox:p,poi:go(l),color:r.color,style:this.userData.pointStyle,pointSize:g,pointOpacity:y,showPoint:!0,needsDotplotXMode:u}]};C.BoxPlot.prototype.graph=function(e,t,n){let r=this.getGraphInfo(e,t),s=this.metaData.evaluatedAxisOffset,i=this.metaData.evaluatedBreadth,o=t.args[0].asValue();if(ms(o),isNaN(i)||isNaN(s))return!1;let a=Math.min.apply(null,o),u=Math.max.apply(null,o),c=Xc(o,1),l=Xc(o,2),p=Xc(o,3),f=s,d=f-i/2,y=f+i/2,g=i/10,m=[];if(this.userData.vizProps.showBoxplotOutliers){let T=p-c,b=c-1.5*T,M=p+1.5*T;a=1/0,u=-1/0,o.forEach(P=>{b<=P&&P<a&&(a=P),u<P&&P<=M&&(u=P),(P<b||P>M)&&m.push([P,f])})}let h=[[c,d,p,d,p,y,c,y,c,d],[l,d,l,y],[c,f,a,f],[p,f,u,f],[a,f-g,a,f+g],[u,f-g,u,f+g]];if(this.userData.vizProps&&this.userData.vizProps.alignedAxis==="y"){for(let T of h)for(let b=0;b<T.length;b+=2){let M=T[b];T[b]=T[b+1],T[b+1]=M}for(let T of m){let b=T[0];T[0]=T[1],T[1]=b}}let x=[{segments:h,graphMode:5,boundingBox:p1("boxplot",h.concat(m)),poi:Ir(),color:r.color}];return m.length&&x.push({segments:[m],graphMode:3,color:r.color,style:"OPEN",showPoint:!0,poi:go(m)}),x};function L8(e){return Array.prototype.concat.apply([],e)}C.Table.prototype.isValueDraggable=function(e,t,n){if(!e.columns[t].isIndependent)return!1;let s=this.calcColumns[t].values,i=s&&s[n],o=i&&i.asValue();return!!(typeof o=="number"&&isFinite(o)&&i.getDependencies().length===0)};function nw(e){let t=[];for(let n of e)typeof n=="number"?t.push(n):t.push(s0(n));return t}C.Table.prototype.graph=function(e,t,n){let r={},s=t.columns[0];if(s.isError)return r;let i=nw(s.asValueMixed());for(let o=1;o<this.columns.length;o++){let a=t.columns[o];if(a.isError)continue;let u=nw(a.asValueMixed()),c=this.columns[o].header.userData,l=this.columns[o].header.metaData;if(c.hidden)continue;let p=Dl(l,["colorLatexValue","computedPointSize","computedPointOpacity"]),f=c.dragMode,d=f==="X"||f==="XY",y=f==="Y"||f==="XY",g=!!c.points,m=!!c.lines,h=[],x=[],T=[],b=[],M=[],P=[],D=1/0,S=-1/0,O=1/0,_=-1/0,L={};for(let k=0;k<i.length;k++){let Z=i[k],F=u[k];if(!isFinite(Z)||!isFinite(F)){L[k]=!0,m&&(P.length>1&&M.push(P),P=[]);continue}if(g){if(k>=p)continue;let Y=d&&this.isValueDraggable(t,0,k),re=y&&this.isValueDraggable(t,o,k);Y||re?(T.push([Z,F]),b.push({index:k,dragX:Y,dragY:re})):x.push([Z,F])}m&&P.push([Z,F]),Z<D&&(D=Z),Z>S&&(S=Z),F<O&&(O=F),F>_&&(_=F)}let w=this.columns[o],G={type:"table",symbol:"header"in w?w.header._symbol:void 0,xmin:D,xmax:S,ymin:O,ymax:_};T.length&&h.push({graphMode:4,segments:[T],color:l.colorLatexValue||c.color,tableId:c.tableId,poi:go(T),movablePointInfo:b,boundingBox:G,pointOpacity:l.computedPointOpacity,pointSize:l.computedMovablePointSize}),x.length&&h.push({segments:[x],droppedIndices:L,graphMode:3,showPoint:!0,poi:go(x),color:l.colorLatexValue||c.color,pointSize:l.computedPointSize,pointOpacity:l.computedPointOpacity,style:c.pointStyle,tableId:c.tableId,boundingBox:G}),(M.length||P.length)&&(M.push(P),h.push({segments:M.map(L8),graphMode:5,poi:Ir(),color:Ra(c,l),style:c.lineStyle,lineWidth:Array.isArray(l.computedLineWidth)?l.computedLineWidth[0]:l.computedLineWidth,lineOpacity:Array.isArray(l.computedLineOpacity)?l.computedLineOpacity[0]:l.computedLineOpacity,tableId:c.tableId,boundingBox:G})),h.length&&(r[c.id]=h)}return r};function w8(e,t,n){return e?t===0&&n===0?e[2].type!=="none"||e[3].type!=="none":t!==0&&n!==0?e[0].type!=="none"&&e[1].type!=="none":t!==0?e[0].type!=="none":n!==0?e[1].type!=="none":!1:!1}C.Image.prototype.graph=function(e,t,n){let r=[];if(t.center.valueType!==N||t.center.getDependencies().length!==0||!t.radianAngle.isConstant||!t.width.isConstant||!t.height.isConstant||!t.opacity.isConstant)return r;let s=[],i=[],o=t.width.asValue()/2,a=t.height.asValue()/2,u=t.radianAngle.asValue();for(let c=-1;c<=1;c++)for(let l=-1;l<=1;l++){let[p,f]=t.center.asValue(),d=[p+c*o*Math.cos(u)+l*a*Math.sin(u),f-c*o*Math.sin(u)+l*a*Math.cos(u)];w8(t.moveStrategy,c,l)&&(s.push(d),i.push([c,l]))}return r.push({segments:[s],scaleFactors:[i],graphMode:4,color:Ra(this.userData,this.metaData),style:this.userData.style,poi:go(s),movablePointInfo:[],pointOpacity:1}),r};function rw(e){let t=[],n=[];for(let[r,s]of e)!isNaN(r)&&!isNaN(s)?t.push(r,s):(t.length>=4&&n.push(t),t=[]);return t.length>=4&&n.push(t),n}function sw(...e){return e.some(t=>isNaN(t))}function f1(e){return Math.abs(e)<5e-8}var Sm=class extends $i{constructor(t,n,r){let{tolerance:s,mathToPixels:i}=t;super({tolerance:s,map:o=>i.mapCoordinatePair(o)}),this.fn=n,this.mappedFn=o=>i.mapY(n(o)),this.derivative=r,this.poiData={zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}},this.zeroBuffer=[],this.extremumBuffer=[]}getPOI(){return Si.pointsOfInterest?(this.poiData.intercept=this.findIntercept(this.fn),this.poiData):{zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}}}addPoint(t){this.segment.length===0&&f1(t[1])&&(this.poiData.zeros.x.push(t[0]),this.poiData.zeros.y.push(t[1])),this.updateZeroBuffer(t),this.updateExtremumBuffer(t),super.addPoint(t)}updateZeroBuffer(t){let[n,r]=this.map?this.map(t):t;if(!isFinite(n)||!isFinite(r)){this.zeroBuffer.length=0;return}switch(this.zeroBuffer.length){case 0:{if(f1(t[1]))return;this.zeroBuffer.push(t);return}case 1:if(t[1]===0){this.zeroBuffer.push(t);return}else if(t[1]>0!=this.zeroBuffer[0][1]>0){let s=QP(this.zeroBuffer[0][0],this.zeroBuffer[0][1],t[0],t[1],this.fn);s&&(this.poiData.zeros.x.push(s[0]),this.poiData.zeros.y.push(s[1])),this.zeroBuffer.length=0,this.zeroBuffer.push(t);return}else{this.zeroBuffer.length=0,this.zeroBuffer.push(t);return}case 2:{if(t[1]===0)return;if(t[1]>0!=this.zeroBuffer[0][1]>0){let s=pf(this.zeroBuffer[0][0],this.zeroBuffer[0][1],this.zeroBuffer[1][0],this.zeroBuffer[1][1],t[0],t[1],this.fn);s&&(this.poiData.zeros.x.push(s[0]),this.poiData.zeros.y.push(s[1])),this.zeroBuffer.length=0,this.zeroBuffer.push(t);return}else{this.zeroBuffer.length=0,this.zeroBuffer.push(t);return}}}}updateExtremumBuffer(t){let[n,r]=this.map?this.map(t):t;if(!isFinite(n)||!isFinite(r)){this.extremumBuffer.length=0;return}switch(this.extremumBuffer.length){case 0:{this.extremumBuffer.push(t);return}case 1:{t[1]===this.extremumBuffer[0][1]&&(this.extremumBuffer.length=0),this.extremumBuffer.push(t);return}case 2:if(t[1]===this.extremumBuffer[1][1]){this.extremumBuffer.push(t);return}else if(t[1]>this.extremumBuffer[1][1]!=this.extremumBuffer[1][1]>this.extremumBuffer[0][1]){let s=this.bisectExtremumUsingDerivative(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],t[0],t[1]);s&&(this.poiData.extrema.x.push(s[0]),this.poiData.extrema.y.push(s[1]),!tp(this.extremumBuffer[0][0],this.mappedFn(this.extremumBuffer[0][0]),s[0],this.mappedFn(s[0]),t[0],this.mappedFn(t[0]),this.mappedFn,this.ytolerance)&&s[0]>this.segment[this.segment.length-2]&&(this.pendingPoint=s)),this.extremumBuffer.shift(),this.extremumBuffer.push(t);return}else{this.extremumBuffer.shift(),this.extremumBuffer.push(t);return}case 3:{if(t[1]===this.extremumBuffer[1][1])return;if(t[1]>this.extremumBuffer[1][1]!=this.extremumBuffer[1][1]>this.extremumBuffer[0][1]){let s,i=.5*(this.extremumBuffer[1][0]+this.extremumBuffer[2][0]),o=this.fn(i);o===this.extremumBuffer[1][1]?s=pf(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],t[0],t[1],this.fn):s=this.bisectExtremumUsingDerivative(this.extremumBuffer[1][0],this.extremumBuffer[1][1],i,o,this.extremumBuffer[2][0],this.extremumBuffer[2][1]),s&&(this.poiData.extrema.x.push(s[0]),this.poiData.extrema.y.push(s[1])),this.extremumBuffer.shift(),this.extremumBuffer.shift(),this.extremumBuffer.push(t);return}else{this.extremumBuffer.shift(),this.extremumBuffer.shift(),this.extremumBuffer.push(t);return}}}}bisectExtremumUsingDerivative(t,n,r,s,i,o){let a;if(this.derivative){let u=this.derivative(t),c=this.derivative(i);if(!isNaN(u)&&!isNaN(c)&&(s>n&&u>0&&c<0||s<n&&u<0&&c>0)){let l=QP(t,u,i,c,this.derivative);l&&(a=[l[0],this.fn(l[0])])}}return a||(a=KD(t,n,r,s,i,o,this.fn)),a}breakSegment(){this.zeroBuffer.length=0,this.extremumBuffer.length=0,this.flushPending(),this.segment.length>2&&(this.segments.push(this.segment),f1(this.segment[this.segment.length-1])&&(this.poiData.zeros.x.push(this.segment[this.segment.length-2]),this.poiData.zeros.y.push(this.segment[this.segment.length-1]))),this.segment=[]}findIntercept(t){if(!t)return{x:[],y:[]};let n=t(0);return isFinite(n)?{x:[0],y:[t(0)]}:{x:[],y:[]}}finish(){return{segments:this.getSegments(),resolved:!0,poi:this.getPOI()}}};var{floor:fw}=Math,mw=1e4,Ub=5,yw=(e,t,n)=>({x:e,y:t,z:n}),gw=(e,t,n)=>({x:n,y:e,z:t}),hw=(e,t,n)=>({x:e,y:n,z:t}),Ab=class{constructor(){this.xmin=Dr.xmin;this.xmax=Dr.xmax;this.ymin=Dr.ymin;this.ymax=Dr.ymax;this.zmin=Dr.zmin;this.zmax=Dr.zmax}},F8=0;function Ns(){return"result_"+F8++}var bw;(n=>(n.None=void 0,n.ComplexCoercion="ComplexCoercion"))(bw||(bw={}));function V8(){return{zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}}}function pw(e){return{graphMode:15,error:e,segments:[]}}function y1(e,t){let n=e[0]+t.min*e[1],r=e[0]+t.max*e[1],s={zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}};if(!isFinite(n)||!isFinite(r))return{segments:[],poi:s,resolved:!0};let i=[[t.min,n,t.max,r]],o=-e[0]/e[1];return!isNaN(o)&&o>=t.min&&o<=t.max&&(s.zeros.x.push(o),s.zeros.y.push(0)),0>=t.min&&0<=t.max&&(s.intercept.x.push(0),s.intercept.y.push(e[0])),{segments:i,poi:s,resolved:!0}}function B8(e,t){let n=y1(e[0],t),r=y1(e[1],t);return n.segments.length&&r.segments.length&&n.segments[0].length===4&&r.segments[0].length===4?{segments:[[n.segments[0][1],r.segments[0][1],n.segments[0][3],r.segments[0][3]]],resolved:!0}:{segments:[],resolved:!0}}function G8(e,t){let n=e(t);return{segments:[[...n,...n]],resolved:!0}}function xw(e,t,n){let{mappedFn:r,jumpTolerance:s,screen:i}=n,[o,a]=e,[u,c]=t,l=Va(o,u),p=r(l),f=i.height;if(!(a<0&&c<0&&(a>=p||c>=p))&&!(a>f&&c>f&&(a<=p||c<=p)))return tp(o,a,l,p,u,c,r,s)}var m1=(e,t,n)=>{let{fn:r,mappedFn:s,jumpTolerance:i,accumulator:o}=n;if(!isFinite(i)||i<=0)return;let a=xw(e,t,n);if(!a)return;let u=(t[0]-e[0])/10,c=[-u,u],l;for(let p=0;p<c.length;p++){let f=e[0]+c[p],d=s(f);isFinite(d)||([f,d]=e,f=e[0],d=e[1]);let y=t[0]+c[p],g=s(y);if(isFinite(g)?l=y:[y,g]=t,xw([f,d],[y,g],n)){let[m,h]=a;o.addPoint([m,r(m)]),o.breakSegment(),o.addPoint([h,r(h)]);return}}return l},g1=class{constructor(t,n,r){let s=i=>n.mathToPixels.mapY(t(i));this.derivative=r,this.accumulator=new Sm(n,t,r),this.fn=t,this.mathToPixels=n.mathToPixels,this.mappedFn=s,this.jumpTolerance=n.tolerance||0,this.screen=n.screen}};function Tw(e,t,n,r){let s=n,i=e(s),o=t.mapY(i);return r>0&&!isFinite(o)&&(s=n+r,i=e(s),o=t.mapY(i)),r>0&&!isFinite(o)&&(s=n-r,i=e(s),o=t.mapY(i)),[s,i,o]}function h1(e,t,n){let r=new g1(e,t,n),{mathToPixels:s,mappedFn:i}=r,o=t.nInitialSamples,[a,u,c]=Tw(e,s,t.min,0);isFinite(c)&&r.accumulator.addPoint([a,u]);for(let l=1;l<o;l++){let p=s.interpolateX(t.min,t.max,l/(o-1)),f=l===o-1?0:Math.abs(a-p)/10,[d,y,g]=Tw(e,s,p,f);if(isFinite(g)&&isFinite(c)){let m=m1([a,c],[d,g],r);m!==void 0&&(d=m,y=e(d),g=s.mapY(y)),r.accumulator.addPoint([d,y])}else if(isFinite(g)&&!isFinite(c)){let m=xs(a,c,d,g,i);if(m!==void 0){m!==d&&r.accumulator.addPoint([m,e(m)]);let h=m1([m,i(m)],[d,g],r);h!==void 0&&(d=h,y=e(d),g=s.mapY(y)),r.accumulator.addPoint([d,y])}}else if(!isFinite(g)&&isFinite(c)){let m=xs(a,c,d,g,i);if(m!==void 0){let h=m1([a,c],[m,i(m)],r);h!==void 0&&(m=h),m!==a&&r.accumulator.addPoint([m,e(m)]),r.accumulator.breakSegment()}}a=d,u=y,c=g}return r.accumulator.finish()}function k8(e){let{fn:t,min:n,max:r}=e,s=Math.floor(n),i=Math.ceil(r),o=!0;i-s+1>mw&&(i=s+(mw-1),o=!1);let a=[];for(let u=s;u<=i;u++){let c=t(u);!isFinite(u)||!isFinite(c)||a.push([u,c])}return{segments:a,resolved:o}}function H8(e,t,n,r){let s=t.min,i=t.max-t.min,o=t.rtoleranceMath,a=Math.floor(i/(Math.PI/n)),u,c,l;function p(f,d){let y=d%2===0?1:-1;if(!r&&y===-1)return!1;let g=d*(Math.PI/n),m=[s,s+1,s+2,s+3],h=!1;for(let x=0,T=m.length;x<T;x++){let b=f(m[x]),M=f(m[x]+g);if(isFinite(b)&&isFinite(M)&&(h=!0),isFinite(b)!==isFinite(M)||Math.abs(b-y*M)>o)return!1}return!!h}for(u=1;u<=a;u++)if(p(e,u)){for(l=u,c=2;c*u<=a;c++)p(e,c*u)||(l=void 0);if(l)break}return l?l*(Math.PI/n):null}function Ew(e){return[e[1]*Math.cos(e[0]),e[1]*Math.sin(e[0])]}function Pb(e,t){if(t.max<t.min)return{segments:[],resolved:!0};if(t.parameterTransform){let p=t.parameterTransform,f=e;e=d=>f(p(d))}let{xtolerance:n,ytolerance:r,ztolerance:s,map:i}=t,o=new $i({xtolerance:n,ytolerance:r,ztolerance:s,map:i}),a=10,u=t.min,c=e(u);isFinite(c[0])&&isFinite(c[1])&&o.addPoint(c);let l=t.nInitialSamples;for(let p=1;p<l;p++){let f=p/(l-1),d=(1-f)*t.min+f*t.max,y=e(d);vm(e,u,c,d,y,a,o,t.screen),u=d,c=y}return o.finish()}function z8(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function vm(e,t,n,r,s,i,o,a){if(r===t)return;let{xtolerance:u,ytolerance:c,ztolerance:l,map:p}=o,f=Va(t,r),d=e(f),y=p(n),g=p(s),m=p(d),h=isFinite(y[0])&&isFinite(y[1])&&(y.length===2||isFinite(y[2])),x=isFinite(g[0])&&isFinite(g[1])&&(g.length===2||isFinite(g[2])),T=isFinite(m[0])&&isFinite(m[1])&&(m.length===2||isFinite(m[2]));if(i===0||f===t||f===r){o.breakSegment(),x&&o.addPoint(s);return}if(!(!h&&!x)){if(h!==x){let b=t,M=r,P=n,D=s;for(;t!==f&&f!==r;)T==h?(t=f,n=d,y=m,h=T):(r=f,s=d,g=m,x=T),f=t+(r-t)/2,d=e(f),m=p(d),T=isFinite(m[0])&&isFinite(m[1])&&(m.length===2||isFinite(m[2]));h?(vm(e,b,P,t,n,i-1,o,a),o.breakSegment()):(o.breakSegment(),o.addPoint(s),vm(e,r,s,M,D,i-1,o,a));return}if(h&&T&&x){let b=z8(y,g),M=to(m[0],m[1],m[2]||0,y[0],y[1],y[2]||0,g[0],g[1],g[2]||0),P=M>.2&&M<.8&&Math.abs(m[0]-(y[0]+M*(g[0]-y[0])))<=u&&Math.abs(m[1]-(y[1]+M*(g[1]-y[1])))<=c&&(y.length===2||Math.abs(m[2]-(y[2]+M*(g[2]-y[2])))<=l);if(b||P||a&&U8(y,m,g,a)){o.addPoint(s);return}}vm(e,t,n,f,d,i-1,o,a),vm(e,f,d,r,s,i-1,o,a)}}function U8(e,t,n,{width:r,height:s}){return e[0]<0&&n[0]<0&&(e[0]>=t[0]||n[0]>=t[0])||e[0]>r&&n[0]>r&&(e[0]<=t[0]||n[0]<=t[0])||e[1]<0&&n[1]<0&&(e[1]>=t[1]||n[1]>=t[1])||e[1]>s&&n[1]>s&&(e[1]<=t[1]||n[1]<=t[1])}function q8(){return Wi({positions:[],normals:[],faces:[],uvs:[],resolved:!0,extraAttrs:[]})}function d1(e,t,n,r,s,{isInequality:i}){let o=e.fn,a;return t&&!t.includes("z")?a=hb(o,n,r,"z"):t&&!t.includes("x")?a=hb(o,n,r,"x"):t&&!t.includes("y")?a=hb(o,n,r,"y"):a=DL(o,n,r,s,{isInequality:i}),Wi(a)}function Iw(e,t,n,r,s){let i=Pm(e,t,n,r,s,0);return Wi(i)}function $8(e,t,n){let r=e.fn,s=lb((i,o)=>r(i,o),new qe(t.xmin,t.xmax),new qe(t.ymin,t.ymax),new qe(t.zmin,t.zmax),n);return Wi(s)}function Y8(e,t,n){let r=e.fn,s=lb((i,o)=>r(i,o),new qe(t.ymin,t.ymax),new qe(t.zmin,t.zmax),new qe(t.xmin,t.xmax),n,[2,0,1]);return Wi(s)}function X8(e,t,n){let r=e.fn,s=lb((i,o)=>r(o,i),new qe(t.zmin,t.zmax),new qe(t.xmin,t.xmax),new qe(t.ymin,t.ymax),n,[1,2,0]);return Wi(s)}function Z8(e,t,n,r,s,i){let o=i?Math.PI/180:1,a=e.fn,u=Pm((c,l)=>[c*Mn(l*o),c*dn(l*o),a(c,l)],t,n,r,s,0);return Wi(u)}function W8(e,t,n,r,s,i){let o=i?Math.PI/180:1,a=e.fn,u=Pm((c,l)=>{let p=a(c,l);return[p*Mn(c*o),p*dn(c*o),l,p]},t,n,r,s,1);return Wi(u)}function j8(e,t,n,r,s,i){let o=i?Math.PI/180:1,a=e.fn,u=Pm((c,l)=>{let p=a(c,l);return[p*dn(l*o)*Mn(c*o),p*dn(l*o)*dn(c*o),p*Mn(l*o),p]},t,n,r,s,1);return Wi(u)}function Wi(e){let{positions:t,normals:n,faces:r,uvs:s,extraAttrs:i,resolved:o}=e;return{guid:Ns(),positions:new Float32Array(t),normals:new Float32Array(n),faces:new Uint32Array(r),uvs:new Float32Array(s),resolved:o,extraAttrs:new Float32Array(i)}}function Pw(e){for(let t of e)if(t!==0)return!1;return!0}function dw(e,t){let{min:n,max:r,mathToPixels:s,nInitialSamples:i}=t,o=s.interpolateX(n,r,0),a=e(o),u=Pw(a),c=!1,l=[];for(let p=1;p<i;p++){let f=s.interpolateX(n,r,p/(i-1)),d=e(f),y=Pw(d);if(u){o=f,a=d,y||(u=!1);continue}if(y){c?(u=!0,c=!1):c=!0;continue}let g=QD(o,a,f,d,e);g!==void 0&&l.push(g),o=f,a=d}return l}function Mw(e){if(!e)return!1;let t=e.viewport.xmin,n=e.viewport.xmax,r=e.viewport.ymin,s=e.viewport.ymax;return!(!isFinite(t)||!isFinite(n)||n<=t||!isFinite(r)||!isFinite(s)||s<=r||!isFinite(e.screen.width)||e.screen.width<=0||!isFinite(e.screen.height)||e.screen.height<=0)}function zC(e,t){let n=t-e;return 1+Math.ceil(n/(n/1e3))}var bo=.001,fc=new sc(SC(),SC());function Td(e,t,n){var L,w,G,k,Z,F,Y,re,Ee;let{viewport:r,screen:s,xAxisScale:i,yAxisScale:o,degreeMode:a}=e,u=a?Math.PI/180:1,c=e.viewport.xmin,l=e.viewport.xmax,p=e.viewport.ymin,f=e.viewport.ymax,d=(L=e.viewport.zmin)!=null?L:Dr.zmin,y=(w=e.viewport.zmax)!=null?w:Dr.zmax,g=((G=t.domain)==null?void 0:G.type)==="2d",{uMin:m,uMax:h,vMin:x,vMax:T}=((k=t.domain)==null?void 0:k.type)==="2d"?t.domain:{uMin:0,uMax:1,vMin:0,vMax:1},b=t.lineWidth;if(t.willConvertTo3D||b>3){let he=t.willConvertTo3D?200:e.screen.width,K=b*(l-c)/he,Oe=t.willConvertTo3D?200:e.screen.height,te=b*(f-p)/Oe;c-=K,l+=K,p-=te,f+=te}let P=1/4,D=t.domainBound,S,O=sc.fromRects(gb(r),yb(s),{xAxisScale:i,yAxisScale:o}),_={xmin:c,xmax:l,ymin:p,ymax:f,zmin:d,zmax:y};switch(t.graphMode){case 1:switch(S=Gn(bi([p,f]),D),S.type){case"empty":return!1;case"interval":p=S.bounds[0],f=S.bounds[1]}let he=Math.max(Ub,1+Math.ceil(Math.abs(O.mapY(f)-O.mapY(p))/P)),K=new sc(O.yScale,O.xScale);return{min:p,max:f,tolerance:P,nInitialSamples:he,mathToPixels:K,screen:{width:s.height,height:s.width}};case 2:{switch(S=Gn(bi([c,l]),D),S.type){case"empty":return!1;case"interval":c=S.bounds[0],l=S.bounds[1]}let Oe=Math.max(Ub,1+Math.ceil(Math.abs(O.mapX(l)-O.mapX(c))/P));return{min:c,max:l,tolerance:P,nInitialSamples:Oe,mathToPixels:O,screen:s}}case 6:{let Oe=e.degreeMode?Math.PI/180:1;if(((Z=t.domain)==null?void 0:Z.type)!=="1d")throw new Error("Expected polar graph to have domain");let{min:te,max:Ze}=t.domain;switch(S=Gn(bi([te,Ze]),D),S.type){case"empty":return!1;case"interval":te=S.bounds[0],Ze=S.bounds[1]}let dt=Math.max(Ub,1+Math.min(Math.ceil(Oe*Math.abs(Ze-te)/(2*Math.PI)*1e3),12e3)),me=Math.abs(O.mapX(l)-O.mapX(c)),J=Math.abs(O.mapY(f)-O.mapY(p)),W=Math.hypot(me,J),be=Math.hypot(l-c,f-p)/W,ue={min:te,max:Ze,screen:s,nInitialSamples:dt,xtolerance:P,ytolerance:P,rtoleranceMath:be,map:([_e,At])=>O.mapCoordinatePair(Ew([_e,At]))};if(!t.domain.isExplicit){let _e=H8(n,ue,Oe,t.operator==="=");_e&&(ue.max=ue.min+_e,ue.nInitialSamples=Math.max(Ub,1+Math.min(Math.ceil(Oe*Math.abs(ue.max-ue.min)/(2*Math.PI)*1e3),12e3)))}return ue}case 5:case 100:{let Oe={min:0,max:1},{min:te,max:Ze}=((F=t.domain)==null?void 0:F.type)==="1d"?t.domain:Oe;switch(S=Gn(bi([te,Ze]),D),S.type){case"empty":return!1;case"interval":te=S.bounds[0],Ze=S.bounds[1]}let dt;return(!isFinite(te)||!isFinite(Ze))&&(dt=Cw,te=qb(te),Ze=qb(Ze)),{min:te,max:Ze,screen:s,nInitialSamples:zC(te,Ze),xtolerance:P,ytolerance:P,ztolerance:P,parameterTransform:dt,map:([me,J])=>O.mapCoordinatePair([me,J])}}case 8:return{xmin:c,xmax:l,ymin:p,ymax:f,mathToPixels:O,tolerance:P};case 106:return{..._,u:new qe(c,l),v:new qe(p,f)};case 120:case 122:case 107:return{..._,u:new qe(p,f),v:new qe(d,y)};case 121:case 123:case 108:return{..._,u:new qe(c,l),v:new qe(d,y)};case 109:return{..._,u:new qe(m,g?h:Dr.xmax),v:new qe(x,g?T:2*Math.PI)};case 124:case 110:{let{min:Oe,max:te}=((Y=t.domain)==null?void 0:Y.type)==="1d"?t.domain:{min:0,max:2*Math.PI};return{..._,u:new qe(Oe,te),v:new qe(d,y)}}case 211:{let{min:Oe,max:te}=((re=t.domain)==null?void 0:re.type)==="1d"?t.domain:{min:0,max:2*Math.PI/u};return{...{xmin:Oe,xmax:te,ymin:d,ymax:y},u:new qe(Oe,te),v:new qe(d,y),mathToPixels:fc,tolerance:bo}}case 212:{let Oe=g?h:2*Math.PI/u,te=g?T:Math.PI/u;return{...{xmin:m,xmax:Oe,ymin:x,ymax:te},u:new qe(m,Oe),v:new qe(x,te),mathToPixels:fc,tolerance:bo}}case 215:case 214:return{...{xmin:m,xmax:h,ymin:x,ymax:T},u:new qe(m,h),v:new qe(x,x),mathToPixels:fc,tolerance:bo};case 213:{let Oe=g?h:Dr.xmax,te=g?T:2*Math.PI/u;return{...{xmin:m,xmax:Oe,ymin:x,ymax:te},u:new qe(m,Oe),v:new qe(x,te),mathToPixels:fc,tolerance:bo}}case 111:return{..._,u:new qe(m,g?h:2*Math.PI/u),v:new qe(x,g?T:Math.PI/u)};case 117:case 118:case 119:case 129:case 130:case 103:case 112:case 126:case 113:case 127:case 210:case 114:return{..._,u:new qe(m,h),v:new qe(x,T)};case 200:case 201:case 202:case 206:case 205:case 203:case 204:case 207:case 208:{if(t.graphMode===200&&(t.slice_coordinate==="z"||t.slice_coordinate==="_implicit"))return{xmin:c,xmax:l,ymin:p,ymax:f,mathToPixels:O,tolerance:bo};if(t.graphMode===201&&(t.slice_coordinate==="x"||t.slice_coordinate==="_implicit"))return{...{xmin:p,xmax:f,ymin:d,ymax:y},mathToPixels:fc,tolerance:bo};if(t.graphMode===202&&(t.slice_coordinate==="y"||t.slice_coordinate==="_implicit"))return{...{xmin:c,xmax:l,ymin:d,ymax:y},mathToPixels:fc,tolerance:bo};let{min:Oe,max:te}=((Ee=t.domain)==null?void 0:Ee.type)==="1d"?t.domain:{min:0,max:2*Math.PI};return{x:new qe(c,l),y:new qe(p,f),z:new qe(d,y),t:new qe(Oe,te),u:new qe(m,h),v:new qe(x,T)}}case 209:return t.slice_coordinate==="z"?{xmin:c,xmax:l,ymin:p,ymax:f,mathToPixels:O,tolerance:bo}:t.slice_coordinate==="x"?{...{xmin:p,xmax:f,ymin:d,ymax:y},mathToPixels:fc,tolerance:bo}:t.slice_coordinate==="y"?{...{xmin:c,xmax:l,ymin:d,ymax:y},mathToPixels:fc,tolerance:bo}:t.slice_coordinate==="_implicit"?{..._,u:new qe(c,l),v:new qe(p,f)}:!1;default:return!1}}function Cw(e){return Math.sinh(10*e)/(1-e*e)}function qb(e){if(e===1/0)return 1;if(e===-1/0)return-1;let t=Math.asinh(e);return 2*t/(10+Math.sqrt(100+4*t*t))}function Nb(e){let{viewState:t,graphInfo:n,compiled:r,maxOverride:s,showPoint:i}=e,o=r.fn,a=Td(t,n,o),u;if(!a)u={segments:[],resolved:!0};else{let{min:p,max:f}=a;u=k8({fn:o,min:Math.max(p,0),max:s!==void 0?Math.min(s,f):f})}let{points:c,droppedIndices:l}=Cm(u.segments);return{segments:[c],droppedIndices:l,graphMode:3,color:n.color,style:n.pointStyle,poi:go(u.segments),resolved:u.resolved,showPoint:i}}function J8(e){switch(e){case 120:case 122:return 107;case 121:case 123:return 108;case 124:return 110;case 126:return 112;case 127:return 113;default:return e}}function cu(e){var g,m,h,x,T,b,M,P,D;let{viewState:t,graphInfo:n,compiled:r,derivative:s}=e,i=r.fn,{degreeMode:o}=t,a=o?Math.PI/180:1,u=Td(t,n,i),c,l,p,f=J8(n.graphMode),d=t.xAxisScale==="linear"&&t.yAxisScale==="linear";if(!u)c={segments:[],resolved:!0};else{switch(f){case 1:case 2:let S=s?s.fn:void 0;c=n.isLinear&&d&&Bo(n.linearCoefficients)?y1(n.linearCoefficients,u):h1(i,u,S);break;case 6:c=Pb(k=>[k,i(k)],u);break;case 8:c=hm(i,u);break;case 5:u.max===u.min?c=G8(i,u.min):c=n.isLinear&&d&&Bo(n.linearCoefficients)?B8(n.linearCoefficients,u):Pb(i,u);break;case 100:let O=r.fn,{min:_,max:L}=((g=n.domain)==null?void 0:g.type)==="1d"?n.domain:{min:0,max:1};if(!isFinite(_)||!isFinite(L)){_=qb(_),L=qb(L);let k=O;O=Z=>k(Cw(Z))}let w=new qe(_,L),G=Ml(O,w,n.resolution,t);return{graphMode:100,guid:Ns(),points:G,color:n.color,thickness:n.lineWidth};case 112:case 113:case 130:case 103:case 106:case 107:case 108:case 109:case 110:case 111:{let k=u,{u:Z,v:F}=k,Y=f===112||f===113,re=n.graphMode===122||n.graphMode===123,Ee=Y?Im:re?2:_L,{resolution:he}=n,K=he===void 0||isNaN(he)?Ee:hr(fw(he),2,100),Oe=bi([Z.min,Z.max]).type!=="empty"&&bi([F.min,F.max]).type!=="empty",te;switch(Oe&&f){case 103:{let me=r.fn;te=Iw(me,k,Z,F,K);break}case 130:{te=Iw((J,W)=>{let[Ge,be]=r.fn(J,W);return[Ge,be,0]},k,Z,F,K);break}case 106:te=$8(r,k,K);break;case 107:te=Y8(r,k,K);break;case 108:te=X8(r,k,K);break;case 109:te=Z8(r,k,Z,F,K,o);break;case 110:te=W8(r,k,Z,F,K,o);break;case 111:te=j8(r,k,Z,F,K,o);break;case 112:case 113:te=d1(r,e.dependencies,e.gradient,u,K,{isInequality:(m=e.isImplicit3dInequality)!=null?m:!1});break;case!1:te=q8();break}let Ze=n.graphMode===113||n.graphMode===127;return{meshData:te,resolved:te.resolved,color:n.color,surfaceOpacity:Ze?1:(h=n.surfaceOpacity)!=null?h:1,uvArgs:(x=vi[n.graphMode])!=null?x:[],extraMeshArgs:(T=Ol[n.graphMode])!=null?T:[],graphMode:f,compiled:r,restrictionShader:e.restrictionShader3d}}case 200:case 201:case 202:case 211:case 206:case 205:case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:case 209:{let k=(J,W,Ge)=>{let be=(Fm,Vm)=>{let Al=Ge(Fm,Vm);return isNaN(Al[0])||isNaN(Al[1])||isNaN(Al[2])?NaN:J(Fm,Vm)},ue=t.viewport,{xmin:_e,xmax:At,ymin:ze,ymax:Ce,zmin:_t,zmax:bc}=ue,xc=(_e+At)/2,nx=(ze+Ce)/2,rx=(_t+bc)/2,OF=At-_e,NF=Ce-ze,RF=bc-_t,$1=hm(be,{...W,map3d:(Fm,Vm)=>{let[Al,Y1,X1]=Ge(Fm,Vm);return isNaN(Al)||isNaN(Y1)||isNaN(X1)?[NaN,NaN,NaN]:[(Al-xc)/OF,(Y1-nx)/NF,(X1-rx)/RF]}});return{segments:$1.segments,resolved:$1.resolved,graphMode:8,color:n.color,lineWidth:n.lineWidth,lineOpacity:n.lineOpacity,listIndex:n.listIndex,operator:n.operator,compiled:r,poi:{}}},Z=r.fn,F=(b=n.slice_value)!=null?b:0,Y=(M=n.slice_coordinate)!=null?M:"",re=u,Ee,he,K,Oe=!0,te=(J,W)=>{let be=k(J,u,(ze,Ce)=>{let{x:_t,y:bc,z:xc}=W(ze,Ce,J(ze,Ce));return[_t,bc,xc]}),ue=n.lineWidth,_e=kb(be,t,ue,F),At=_e.points;for(let ze=0;ze<At.length/3;ze++){let Ce=At[3*ze],_t=At[3*ze+1],bc=At[3*ze+2],{x:xc,y:nx,z:rx}=W(Ce,_t,bc);At[3*ze]=xc,At[3*ze+1]=nx,At[3*ze+2]=rx}return _e},Ze=(J,W)=>{let Ge=[];for(let _e=0;_e<J.segments.length;_e++){let At=J.segments[_e];for(let ze=0;ze<At.length/2;ze++){let Ce=At[2*ze],_t=At[2*ze+1];Ge.push(W(Ce,_t))}_e<J.segments.length-1&&Ge.push([NaN,NaN,0])}let be=n.lineWidth,ue=t.viewport;return Dm(Ge,ue,be)},dt=u,me=(J,W)=>{var be;let Ge=k(J,dt,W);return Oe=(be=Ge.resolved)!=null?be:!0,Ze(Ge,W)};switch(f){case 200:{if(Y==="z")return te((W,Ge)=>Z(W,Ge)-F,yw);if(Y==="_implicit"){let W=n.slice_function.fn;K=me((ue,_e)=>W(ue,_e,Z(ue,_e)),(ue,_e)=>[ue,_e,Z(ue,_e)]);break}let J=Y==="x";Ee=J?re.y:re.x,he=J?W=>[F,W,Z(F,W)]:W=>[W,F,Z(W,F)],K=Ml(he,Ee,n.resolution,t);break}case 201:{if(Y==="x")return te((W,Ge)=>Z(W,Ge)-F,gw);if(Y==="_implicit"){let W=n.slice_function.fn;K=me((ue,_e)=>W(Z(ue,_e),ue,_e),(ue,_e)=>[Z(ue,_e),ue,_e]);break}let J=Y==="y";Ee=J?re.z:re.y,he=J?W=>[Z(F,W),F,W]:W=>[Z(W,F),W,F],K=Ml(he,Ee,n.resolution,t);break}case 202:{if(Y==="y")return te((W,Ge)=>Z(W,Ge)-F,hw);if(Y==="_implicit"){let W=n.slice_function.fn;K=me((ue,_e)=>W(ue,Z(ue,_e),_e),(ue,_e)=>[ue,Z(ue,_e),_e]);break}let J=Y==="x";Ee=J?re.z:re.x,he=J?W=>[F,Z(F,W),W]:W=>[W,Z(W,F),F],K=Ml(he,Ee,n.resolution,t);break}case 209:{let J=r.fn;if(Y==="x")return te((W,Ge)=>J(F,W,Ge),gw);if(Y==="y")return te((W,Ge)=>J(W,F,Ge),hw);if(Y==="z")return te((W,Ge)=>J(W,Ge,F),yw);if(Y==="_implicit"){let{resolution:W}=n,Ge=W===void 0||isNaN(W)?Im:hr(fw(W),2,100);K=AL(r.fn,n.slice_function.fn,u,Ge);let be=t.viewport,ue=[];for(let _e=0;_e<K.length/3;_e++)ue.push([K[3*_e],K[3*_e+1],K[3*_e+2]]);K=Dm(ue,be,n.lineWidth);break}else throw new Error("Programming Error: unexpected slice coordinate")}case 206:case 205:{let J=Y==="z";Ee=J?re.t:re.z,he=J?W=>[Z(W,F),W,F]:W=>[Z(F,W),F,W],K=HC(he,Ee,n.resolution,t);break}case 211:{let J=r.fn,W;switch(Y){case"x":W=(ze,Ce)=>J(ze,Ce)*Mn(ze*a)-F;break;case"y":W=(ze,Ce)=>J(ze,Ce)*dn(ze*a)-F;break;case"r":W=(ze,Ce)=>J(ze,Ce)-F;break;case"_implicit":let At=n.slice_function.fn;W=(ze,Ce)=>At(J(ze,Ce)*Mn(ze*a),J(ze,Ce)*dn(ze*a),Ce,J(ze,Ce),ze);break;default:throw new Error("Programming Error: bad slice")}let Ge=Y==="x",be=Y==="y",ue=(At,ze)=>[Ge?F:J(At,ze)*Mn(At*a),be?F:J(At,ze)*dn(At*a),ze],_e=k(W,dt,ue);K=Ze(_e,ue),Oe=(P=_e.resolved)!=null?P:!0;break}case 213:{let J=Y==="x",W=Y==="y",Ge=Y==="z",be=r.fn,ue;switch(Y){case"x":ue=(Ce,_t)=>Ce*Mn(_t*a)-F;break;case"y":ue=(Ce,_t)=>Ce*dn(_t*a)-F;break;case"z":ue=(Ce,_t)=>be(Ce,_t)-F;break;case"_implicit":let ze=n.slice_function.fn;ue=(Ce,_t)=>ze(Ce*Mn(_t*a),Ce*dn(_t*a),be(Ce,_t),Ce,_t);break;default:throw new Error("Programming Error: bad slice")}let _e=(ze,Ce)=>[J?F:ze*Mn(Ce*a),W?F:ze*dn(Ce*a),Ge?F:be(ze,Ce)],At=k(ue,dt,_e);K=Ze(At,_e);break}case 212:{let J=Y==="x",W=Y==="y",Ge=Y==="z",be=r.fn,ue;switch(Y){case"x":ue=(Ce,_t)=>be(Ce,_t)*dn(_t*a)*Mn(Ce*a)-F;break;case"y":ue=(Ce,_t)=>be(Ce,_t)*dn(_t*a)*dn(Ce*a)-F;break;case"z":ue=(Ce,_t)=>be(Ce,_t)*Mn(_t*a)-F;break;case"rho":ue=(Ce,_t)=>be(Ce,_t)-F;break;case"_implicit":let ze=n.slice_function.fn;ue=(Ce,_t)=>ze(be(Ce,_t)*dn(_t*a)*dn(Ce*a),be(Ce,_t)*dn(_t*a)*Mn(Ce*a),be(Ce,_t)*Mn(_t*a),be(Ce,_t),Ce,_t);break;default:throw new Error("Programming Error: bad slice")}let _e=(ze,Ce)=>[J?F:be(ze,Ce)*dn(Ce*a)*Mn(ze*a),W?F:be(ze,Ce)*dn(Ce*a)*dn(ze*a),Ge?F:be(ze,Ce)*Mn(Ce*a)],At=k(ue,dt,_e);K=Ze(At,_e),Oe=(D=At.resolved)!=null?D:!0;break}case 215:case 214:{let J=f===214?r.fn:(Ge,be)=>{let[ue,_e]=r.fn(Ge,be);return[ue,_e,0]},W;switch(Y){case"x":W=(be,ue)=>J(be,ue)[0]-F;break;case"y":W=(be,ue)=>J(be,ue)[1]-F;break;case"z":W=(be,ue)=>J(be,ue)[2]-F;break;case"u":W=(be,ue)=>be-F;break;case"v":W=(be,ue)=>ue-F;break;case"_implicit":let Ge=n.slice_function.fn;W=(be,ue)=>{let[_e,At,ze]=J(be,ue);return Ge(_e,At,ze,be,ue)};break;default:throw new Error("Programming Error: bad slice")}K=me(W,J);break}case 203:case 204:{let J=Y==="r";Ee=J?re.v:re.u,he=J?W=>[F,W,Z(F,W)]:W=>[W,F,Z(W,F)],K=HC(he,Ee,n.resolution,t);break}case 207:case 208:{let J=Y==="theta";Ee=J?re.v:re.u,he=J?W=>[Z(F,W),F,W]:W=>[Z(W,F),W,F],K=SL(he,Ee,n.resolution,t);break}}return{graphMode:100,guid:Ns(),points:K,resolved:Oe,color:n.color,thickness:n.lineWidth}}default:throw new Error("Programming Error: unexpected graphmode "+f)}p=c.poi}if((!p||p.zeros.x.length+p.extrema.x.length+p.intercept.x.length>250)&&(p=V8()),f===1)for(let S in p){if(!p.hasOwnProperty(S))continue;let O=S;l=p[O].y,p[O].y=p[O].x,p[O].x=l}let y={segments:c.segments,resolved:c.resolved,graphMode:f,color:n.color,style:n.lineStyle,lineWidth:n.lineWidth,lineOpacity:n.lineOpacity,listIndex:n.listIndex,operator:n.operator,poi:p,compiled:r};if(f===6){let S=u;y.sampledDomain={min:S.min,max:S.max}}return c.fillSegments&&(y.fillSegments=c.fillSegments),y}function Q8(e,t,n){let r,s,i,o,a=[],u=null;switch(n){case 6:u=Ew;break;case 1:u=function(c){return[c[1],c[0]]};break}for(r=0;r<e.length;r++)for(o=e[r],s=0;s<o.length;s+=2)i=[o[s],o[s+1]],u&&(i=u(i)),a.push(i[0],i[1]);for(r=t.length-1;r>=0;r--)for(o=t[r],s=o.length-2;s>=0;s-=2)i=[o[s],o[s+1]],u&&(i=u(i)),a.push(i[0],i[1]);return a}function Hb(e,t,n){let r=l=>l[l.length-2],s=[],i=0,o=0,a=[],u=[],c=-1/0;for(;;){for(;o<e.length&&!(e[o].length>=2);)o+=1;for(;i<t.length&&!(t[i].length>=2);)i+=1;(o>=e.length||e[o][0]>c)&&(i>=t.length||t[i][0]>c)&&(a.length>0&&u.length>0&&s.push(Q8(a,u,n)),a=[],u=[],c=Math.max(c,o<e.length?r(e[o]):1/0),c=Math.max(c,i<t.length?r(t[i]):1/0));let l=!1;if(o<e.length&&e[o][0]<=c&&(c=Math.max(c,r(e[o])),a.push(e[o]),o+=1,l=!0),i<t.length&&t[i][0]<=c&&(c=Math.max(c,r(t[i])),u.push(t[i]),i+=1,l=!0),!l)break}return s}function Cm(e){let t=[],n={};for(let r=0;r<e.length;r++){let s=e[r],[i,o]=s;!isNaN(i)&&!isNaN(o)?t.push(s):n[r]=!0}return{points:t,droppedIndices:n}}var vi={[8]:["x","y"],[106]:["x","y"],[120]:["y","z"],[122]:["y","z"],[107]:["y","z"],[121]:["x","z"],[123]:["x","z"],[108]:["x","z"],[109]:["r","theta"],[124]:["theta","z"],[110]:["theta","z"],[111]:["theta","phi"],[130]:["u","v"],[103]:["u","v"],[126]:["x","y"],[112]:["x","y","z"],[113]:["x","y","z"],[127]:["x","y"],[201]:["y","z"],[202]:["x","z"],[200]:["x","y"],[206]:["theta","z"],[205]:["theta","z"],[211]:["theta","z"],[203]:["r","theta"],[204]:["r","theta"],[213]:["r","theta"],[207]:["theta","phi"],[208]:["theta","phi"],[212]:["theta","phi"],[214]:["u","v"],[215]:["u","v"],[209]:["x","y","z"],[210]:["x","y","z"]},Ol={[110]:["r"],[111]:["rho"]};function Voe(e){return e.graphMode===3||e.graphMode===25||uu(e.graphMode)}function Boe(e){return uu(e.graphMode)}var Id=class{constructor({enableGeometry:t,enable3d:n,scales:r,includeFunctionParametersInRandomSeed:s,isComplexEnabled:i,customRegressions:o,isRecursionEnabled:a}){this._isGeometry=!1;this._is3dProduct=!1;this._isGeometry=t,this._is3dProduct=n,this._scales=r,this._includeFunctionParametersInRandomSeed=s,this._isComplexEnabled=!!i,this._customRegressions=o,this._isRecursionEnabled=!!a}isGeometryEnabled(){return this._isGeometry}is3dProduct(){return this._is3dProduct}is3dPolicy(){return!1}isComplexEnabled(){return this._isComplexEnabled}isRecursionEnabled(){return this._isRecursionEnabled}polygonUnsupportedPreferTriangle(){return!1}areAllScalesLinear(){return this._scales?this._scales.xAxisScale==="linear"&&this._scales.yAxisScale==="linear":!0}assignmentForbidden(t){return t==="x"||t==="y"||t==="theta"||t==="index"||t==="dt"||t.slice(0,3)==="tmp"||tt.hasOwnProperty(t)||this.isComplexEnabled()&&t===br}isValidSlider(t){return t==="x"||t==="y"?!0:!(t.slice(0,3)==="ans"||t.slice(0,6)==="idref_"||this.assignmentForbidden(t))}sliderVariables(t){return t.indexOf("theta")!==-1&&(t=t.filter(n=>n!=="r")),t.filter(n=>!(this.assignmentForbidden(n)||n.slice(0,3)==="ans"||n.slice(0,6)==="idref_"||n[0]==="_"||this.isGeometryEnabled()&&n[0]==="$"))}tooManySliderVariables(t,n,r){return r?t.length>=1:t.length>=2&&n.length>=1}graphingEnabled(){return!0}ansEnabled(){return!1}dimensionVarsEnabled(){return!0}validRegressionParameter(t){return t!=="x"&&t!=="y"}validLHS(t){return t!=="theta"&&t.slice(0,6)!=="idref_"}unplottablePolarFunction(t,n){return t!=="theta"?!1:n.indexOf("r")!==-1}validDoubleInequalitySymbol(t){return t==="x"||t==="y"}validDoubleInequalityVariables(t){return t.length>2?!1:t.every(this.validDoubleInequalitySymbol)}validExpressionVariables(t){return t.length===1&&t[0]==="x"}validSolvedVariable(t){return t==="x"||t==="y"||t==="r"}validImplicitVariables(t){switch(t.length){case 0:return!0;case 1:return t[0]==="x"||t[0]==="y"||t[0]==="r";case 2:return t[0]==="x"&&t[1]==="y"||t[0]==="y"&&t[1]==="x"||t[0]==="r"&&t[1]==="theta"||t[0]==="theta"&&t[1]==="r";default:return!1}}graphableListVariables(t,n){return t==="x"||t==="y"||t==="r"||n==="x"||n==="y"}validParametricVariable(t){return t==="t"}validParametricVariables(t){return t.length===1&&this.validParametricVariable(t[0])}validInequalityVariables(t){switch(t.length){case 1:return t[0]==="x"||t[0]==="y"||t[0]==="r";case 2:return this.validImplicitVariables(t);default:return!1}}validFirstColumnVariable(t){return t!=="y"&&t!=="r"&&t!=="theta"&&!t.match(/y_(\\d+)/)}validActionVariable(t){return t==="dt"||t==="index"}complicatedPolarImplicit(t,n){return t==="theta"||t==="r"&&n!==1}graphMode(t,n,r){if(n.length===0)return t==="x"?1:t==="r"?6:t==="y"?2:10;let s=n[0];return s==="y"?1:t==="x"?1:t==="r"&&s==="theta"?6:this.isComplexEnabled()&&t!=="y"&&s!=="x"?10:2}functionDefinitionGraphMode(t,n){return this.graphMode(t,n)}tableableAsConstant(t){return!(t==="x"||t==="r"||t==="theta")}implicitIndependent(t){return"x"}implicitDependency(t){return t.length!==1?"y":t[0]==="y"?"x":t[0]==="theta"?"r":"y"}disabledFeatures(){return[]}shouldIncludeFunctionParametersInRandomSeed(){return this._includeFunctionParametersInRandomSeed}isCustomRegressionSupported(){return this._customRegressions}},$b=class{constructor({beta3d:t,includeFunctionParametersInRandomSeed:n,isComplexEnabled:r,customRegressions:s,isRecursionEnabled:i}){this._isBeta3d=!1;this._isBeta3d=t,this.policy2d=new Id({enableGeometry:!1,enable3d:!0,scales:{xAxisScale:"linear",yAxisScale:"linear"},includeFunctionParametersInRandomSeed:n,isComplexEnabled:r,customRegressions:s,isRecursionEnabled:i})}isGeometryEnabled(){return!1}is3dProduct(){return!0}is3dPolicy(){return!0}isBeta3d(){return this._isBeta3d}isComplexEnabled(){return this.policy2d.isComplexEnabled()}isRecursionEnabled(){return this.policy2d.isRecursionEnabled()}polygonUnsupportedPreferTriangle(){return!0}areAllScalesLinear(){return!0}graphingEnabled(){return!0}ansEnabled(){return!1}dimensionVarsEnabled(){return!1}validInequalityVariables(t){return this.validImplicitVariables(t)}validFirstColumnVariable(t){return this.policy2d.validFirstColumnVariable(t)}validActionVariable(t){return this.policy2d.validActionVariable(t)}tableableAsConstant(t){return this.policy2d.tableableAsConstant(t)}implicitIndependent(t){return this.policy2d.implicitIndependent(t)}validRegressionParameter(t){return this.policy2d.validRegressionParameter(t)}assignmentForbidden(t){return t==="x"||t==="y"||t==="z"||t==="r"||t==="rho"||t==="theta"||t==="phi"||this.policy2d.assignmentForbidden(t)}sliderVariables(t){return t.filter(n=>!(this.assignmentForbidden(n)||n.slice(0,3)==="ans"||n.slice(0,6)==="idref_"||n[0]==="_"))}tooManySliderVariables(t,n,r){return r?this.isBeta3d()?n.length>=1:t.length>=1:n.length>=1}isValidSlider(t){return!(t.slice(0,3)==="ans"||t.slice(0,6)==="idref_"||this.assignmentForbidden(t))}validLHS(t){return t!=="phi"&&this.policy2d.validLHS(t)}unplottablePolarFunction(t,n){return!1}complicatedPolarImplicit(t,n){return!1}validDoubleInequalitySymbol(t){return Om(t)}validDoubleInequalityVariables(t){return t.every(Om)}validExpressionVariables(t){return t.length===2&&t.every(n=>n=="x"||n=="y")}validSolvedVariable(t){return Om(t)||t==="r"||t==="rho"}validImplicitVariables(t){return t.every(Om)}graphableListVariables(t,n){return t==="x"||t==="y"||t==="z"||t==="r"||t==="rho"||n==="x"||n==="y"}validParametricVariable(t){return t==="t"||t==="u"||t==="v"}validParametricVariables(t){return t.length===1&&this.validParametricVariable(t[0])||t.length===2&&t.every(b1)}functionDefinitionGraphMode(t,n){if(n.length===1)switch(n[0]){case"x":return 121;case"y":return 120;default:return 10}else if(n.length===2&&n.every(r=>r=="x"||r=="y"))return 106;return 10}graphMode(t,n,r){if(r!=null||(r=n),n.length===0)switch(t){case"z":return r.some(s=>s==="r"||s==="theta")?109:106;case"y":return r.includes("z")?108:123;case"x":return r.includes("z")?107:122;case"r":return r.indexOf("r")>-1?10:Dw(r);case"rho":return 111;default:return 10}switch(t){case"z":return n.every(s=>s=="x"||s=="y")?106:n.every(s=>s=="r"||s=="theta")?109:10;case"y":return n.every(s=>s=="x")?r.some(s=>s==="z")?108:121:n.every(s=>s=="x"||s=="z")?108:10;case"x":return n.every(s=>s=="y")?r.some(s=>s==="z")?107:120:n.every(s=>s=="y"||s=="z")?107:10;case"r":return n.every(s=>s=="theta")?Dw(r):n.every(s=>s=="theta"||s=="z")?110:10;case"rho":return n.every(s=>s=="theta"||s=="phi")?111:10;default:return 10}}implicitDependency(t){if(t.length!==2)return"z";let n=t[0]<t[1]?t[0]+t[1]:t[1]+t[0];return n==="xy"?"z":n==="xz"?"y":n==="yz"?"x":"z"}disabledFeatures(){return[]}shouldIncludeFunctionParametersInRandomSeed(){return this.policy2d.shouldIncludeFunctionParametersInRandomSeed()}isCustomRegressionSupported(){return this.policy2d.isCustomRegressionSupported()}},Om=e=>e==="x"||e==="y"||e==="z",b1=e=>e==="u"||e==="v";function Dw(e){return e.some(n=>Om(n)||n==="r")?110:124}C.Base.prototype.getGraphMode=function(e,t){return 10};C.Base.prototype.graphmodeDependencies=Do;function Do(e,t){let n=t.getDependencies();if(e.is3dProduct()&&t instanceof on){let r=new Set(pL(t._chunk));return n.filter(s=>r.has(s))}else return n}function K8(e,t){let n;return e&&e.hasOwnProperty("dragMode")?e.dragMode==="AUTO"?n=t.defaultDragMode:n=e.dragMode:n=t.defaultDragMode,wD(n,t.moveStrategy)}function Sw(e,t){let n=e.is3dPolicy();if(t.isMovablePoint&&!n&&K8(this.userData,t)!=="NONE")return t.valueType===R?26:4;let r=Do(e,t);switch(t.valueType){case fr:case z:if(n){if(r.length===0)return 114;if(e.validParametricVariables(r))return r.length==1?100:La(103,t)}return 10;case R:case Ue:case N:case Pt:{let s=se(t.valueType,R);return r.length===0?s?25:3:n&&e.validParametricVariables(r)?r.length===1?5:r.every(b1)?La(130,t):10:e.validParametricVariables(r)?5:10}case I:case ne:return!e.is3dPolicy()&&r.length===1?2:n&&r.length===2&&r.indexOf("x")>-1&&r.indexOf("y")>-1?La(106,t):10}if(r.length>0)return 10;switch(t.valueType){case or:case Wr:return 5;case sr:case $r:return 5;case ir:case Yr:return n?100:10;case Mr:case jr:return n?La(130,t):10;case Pr:case Xr:return n?La(130,t):10;case Er:case Zr:return n?La(103,t):10;case wt:case mr:return n?119:10;case ke:case gr:return n?129:10;case Rn:case yr:return n?117:10;case Hn:case Ar:return n?118:10;case xe:case In:return 16;case ce:case Wn:return 20;case ie:case Fn:return 21;case de:case xn:return 17;case fe:case jn:return 18;case Ne:case Vn:return 19;case le:case Jn:return this instanceof we&&this.getDependencies().length===1?10:24;case Le:case On:case ye:case Nn:return 23;default:return 10}}C.Expression.prototype.getGraphMode=Sw;function vw(e,t){let n=t._expression.getDependencies();if(n.length>1)return 10;if(t._expression.isList&&t._expression.length===0)return 10;let r=t._symbol,s=t.getDependencies();return e.graphMode(r,n,s)}C.Equation.prototype.getGraphMode=C.CallAssignment.prototype.getGraphMode=C.BaseComparator.prototype.getGraphMode=C.ComparatorChain.prototype.getGraphMode=function(e,t){if(t.isError)return 10;let n=Do(e,t),r=t.getDependencies();if(e.is3dPolicy()){let s=10;return n.length>0&&(r.includes("z")?s=this.isInequality()?113:112:s=this.isInequality()?127:126),La(s,t)}return t.isConstant?10:t instanceof C.SolvedEquation?vw(e,t):n.length===1||n.length===2?8:10};function x1(e){var t;return e===106||e===200||e===107||e===201||e===108||e===202?["x","y","z","_implicit"]:e===110||e===211?["x","y","z","r","theta","_implicit"]:e===111||e===212?["x","y","z","rho","theta","phi","_implicit"]:e===109||e===213?["x","y","z","r","theta","_implicit"]:e===103||e===214||e===130||e===215?["x","y","z","u","v","_implicit"]:e===113||e===210||e===112||e===209?["x","y","z","_implicit"]:(t=vi[e])!=null?t:[]}function La(e,t){let n=x1(e),r=t._chunk;try{let i=tu(r,n,{allowSlices:!0}).getSliceVariablesOrImplicit();if(i.length!==1)return e;let o=i[0];return n.indexOf(o)<0?10:lL(e,o)}catch(s){return 10}}C.DoubleInequality.prototype.getGraphMode=function(e,t){let n=t.getDependencies();return e.graphMode(t._symbol,[],n)};C.Assignment.prototype.getGraphMode=function(e,t){if(t instanceof C.SolvedEquation)return vw(e,t);if(this.isEquation(e,t))return this.asEquation().getGraphMode(e,t);let n=Do(e,t),r=this._symbol,s=t.getDependencies();switch(t.valueType){case I:case ne:case $e:switch(n.length){case 0:{let o=e.graphMode(r,[],s);return e.is3dPolicy()?La(o,t):o}case 1:if(t.valueType===ne&&!e.graphableListVariables(r,n[0]))return 10;if(this.isSlider)return 10;let i=e.graphMode(r,n,s);return e.is3dPolicy()?La(i,t):i;default:return e.is3dPolicy()?La(e.graphMode(r,n,s),t):10}case z:if(e.assignmentForbidden(r)||n.length>0&&!e.validParametricVariables(n))return 10;switch(n.length){case 0:return 114;case 1:return 100;case 2:return 103;default:return 10}default:return Sw.call(this,e,t)}};C.FunctionDefinition.prototype.getGraphMode=function(e,t){let n=e.is3dPolicy();if(this._argSymbols.length!==1&&!n)return 10;if(this.recursionInfo){let i=t instanceof on?t.getRecursiveFunctionMetadata():void 0;if((i==null?void 0:i.type)==="missing-non-recursive-branch")return 10;if((i==null?void 0:i.recursiveStructure.domainInfo[this._symbol][0])===1)return 10}let r=e.functionDefinitionGraphMode(this._symbol,this._argSymbols),s=Do(e,t);switch(t.valueType){case I:case ne:if(n)return r;switch(s.length){case 0:return r;case 1:return s[0]!==this._argSymbols[0]?10:r;default:return 10}break;default:return 10}};C.Regression.prototype.getGraphMode=function(e,t){return this.isLhsSimple?t.isModelValid?t.model.getDependencies().length!==1?10:2:10:10};function T1(e,t){return t.isError?10:11}C.Histogram.prototype.getGraphMode=T1;C.DotPlot.prototype.getGraphMode=T1;C.BoxPlot.prototype.getGraphMode=T1;C.Image.prototype.getGraphMode=function(e,t){return this.userData.showPoints?this.center.isError||this.radianAngle.isError||this.width.isError||this.height.isError||this.opacity.isError?10:3:10};function Ow(e){let t=0,n=0,r=[],s=Vr(e,e.getReturnIndex());for(let i=0;i<e.instructionsLength();i++){if(!s[i])continue;let o=e.getInstruction(i);o.type===25?r[i]=1:o.type===31||o.type===32?r[i]=r[o.args[0]]+r[o.args[1]]:r[i]=0,Yu(e,o)&&(t+=1,n+=r[o.args[0]])}return{numRestrictions:t,numEqualityRestrictions:n}}function Pd(e,t,n){try{return e$(e,t,n)}catch(r){return r instanceof v?r:U(r)}}function e$(e,t,n){var l,p;if(!e.is3dProduct()||n.isError)return n;if(!(n instanceof on))return U("Expected peel error to be checked on an IRExpression");function r(f,d){let y=d.filter(g=>f.indexOf(g)<0);if(y.length)return kI(y[0]).allowExport().setDependencies(y)}function s(){let f=zb(o),d=t$(e,n);return r(f,d)}function i(){let f=Nw(o),d=n$(e,n,o);return r(f,d)}let o=t.getGraphMode(e,n),a=n._chunk,{numRestrictions:u,numEqualityRestrictions:c}=Ow(a);if(c!==0)if(c===1){if(u!==c&&!t.isInequality())return wT();let y=tu(a,[],{allowSlices:!0}).getSliceVariablesOrImplicit();if(y.length!==1)return ca();let g=x1(o),m=y[0];if(g.indexOf(m)<0)return m==="_implicit"?ca().allowExport():zI(m).allowExport().setDependencies([m])}else return LT();return(p=(l=s())!=null?l:i())!=null?p:n}function t$(e,t){let n=Do(e,t);return t.getDependencies().filter(s=>n.indexOf(s)<0)}function n$(e,t,n){let r=Do(e,t),s=new Set;if(t instanceof on){let o=t.getRestrictedFunctionForGLSL(zb(n),ac).concrete;for(let a of o.getDependencies())r.indexOf(a)>-1||s.add(a)}return[...s]}function zb(e){var n;if(!va(e))return[];let t=r$(e)?["x","y","z"]:[];return e===211&&t.push("r"),e===212&&t.push("rho"),t.push(...(n=Ol[e])!=null?n:[]),t.push(...Nw(e).filter(r=>t.indexOf(r)<0)),t}function r$(e){return s$(e)||e==200||e==201||e==202||e==211||e==212||e==213||e==214||e==215}function s$(e){if(!va(e))return!1;switch(e){case 106:case 107:case 108:case 110:case 111:case 109:case 122:case 123:case 112:case 113:case 127:case 130:case 103:case 210:return!0;case 124:case 120:case 121:case 126:case 114:case 117:case 118:case 119:case 129:case 128:case 100:case 200:case 201:case 202:case 206:case 205:case 211:case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:case 209:return!1;default:return!1}}function Nw(e){var t;return va(e)?(t=vi[e])!=null?t:[]:[]}function wa(e){if(typeof e=="string")return e;if(e===void 0)return"";if(isNaN(e))return"\\\\frac{0}{0}";if(e===1/0)return"\\\\infty";if(e===-1/0)return"-\\\\infty";let t=e+"";return t=t.replace(/^1e\\+?([-\\d]+)/,"10^{$1}"),t=t.replace(/([-\\d\\.]+)e\\+?([-\\d]+)/,"$1\\\\cdot 10^{$2}"),t}function i$(e){let t=e+"";if(/\\d+\\.?\\d*e[\\+\\-]*\\d+/i.test(t)){let n="0",r=String(t).toLowerCase().split("e"),s=parseFloat(r[0]),i=parseInt(r[1],10),o=Math.abs(i),a=Math.abs(s).toString().split(".");if(i<0)t="0."+new Array(o).join(n)+a.join("");else{let u=a[1];u&&(o=o-u.length),t=a.join("")+new Array(o+1).join(n)}s<0&&(t="-"+t)}return t}function pae(e,t=2){let n=i$(e),r=n.indexOf(".");if(r===-1)return n;let s,i;for(i=r+1;i<n.length;i++)if(s){if(n[i]!==s)break}else if(n[i]==="0"||n[i]==="9")s=n[i];else break;return n.substr(0,Math.max(r+5,i+t))}function Ln(e,t){if(j(e)){let n=[];for(let r=0;r<t.length;r++)n.push(Ln(Ve(e),t[r]));return`\\\\left[${n.join(",")}\\\\right]`}switch(e){case I:return wa(t);case R:return Ic(t);case N:{let[i,o]=t;return`\\\\left(${wa(i)},${wa(o)}\\\\right)`}case z:{let[i,o,a]=t;return`\\\\left(${wa(i)},${wa(o)},${wa(a)}\\\\right)`}case Kt:return"\\\\operatorname{rgb}\\\\left("+[Ln(I,t[0]),Ln(I,t[1]),Ln(I,t[2])].join(",")+"\\\\right)";case xe:{let i=[];for(let o of t)i.push(Ln(N,o));return"\\\\operatorname{polygon}\\\\left("+i.join(",")+"\\\\right)"}case de:return"\\\\operatorname{segment}\\\\left("+[Ln(N,t[0]),Ln(N,t[1])].join(",")+"\\\\right)";case fe:return"\\\\operatorname{line}\\\\left("+[Ln(N,t[0]),Ln(N,t[1])].join(",")+"\\\\right)";case Ne:return"\\\\operatorname{ray}\\\\left("+[Ln(N,t[0]),Ln(N,t[1])].join(",")+"\\\\right)";case le:let n=t[0],r=t[1],s=[r[0]+n[0],r[1]+n[1]];return`\\\\operatorname{vector}\\\\left(${Ln(N,r)},${Ln(N,s)}\\\\right)`;case ce:return"\\\\operatorname{circle}\\\\left("+[Ln(N,t[0]),Ln(I,t[1])].join(",")+"\\\\right)";case ie:return"\\\\operatorname{arc}\\\\left("+[Ln(N,t[0]),Ln(N,t[1]),Ln(N,t[2])].join(",")+"\\\\right)";case Le:return"\\\\operatorname{angle}\\\\left("+[Ln(N,t[0]),Ln(I,t[1]),Ln(I,t[2])].join(",")+"\\\\right)";case ye:return"\\\\operatorname{directedangle}\\\\left("+[Ln(N,t[0]),Ln(I,t[1]),Ln(I,t[2])].join(",")+"\\\\right)";case Pn:return`\\\\operatorname{tone}\\\\left(${Ln(I,t[0])},${Ln(I,t[1])}\\\\right)`;default:throw new Error("Cannot serialize a value of type "+oe(e)+".")}}function I1(e){let t={};for(let n of We(e.updateRules))t[n]=P1(e,n);return t}function P1(e,t){let{valueType:n,value:r}=e.updateRules[t];return`${qr(t)}=${Ln(n,r)}`}function Aw(e){return e instanceof C.Constant||e instanceof C.ParenSeq&&e.args.length===1&&e.args[0]instanceof C.Constant}function Rw(e){return!!(e instanceof C.Identifier&&e._symbol===br||(e instanceof C.Multiply||e instanceof C.CrossMultiply||e instanceof C.DotMultiply)&&e.args.length===2&&e.args.some(t=>t instanceof C.Identifier&&t._symbol===br)&&e.args.some(t=>Aw(t))||e instanceof C.Negative&&e.args[0]instanceof C.Identifier&&e.args[0]._symbol===br||e instanceof C.FunctionCall&&e._symbol===br&&e.args.length===1&&e.args[0]instanceof C.Constant)}function Rm(e){return!!(Rw(e)||(e instanceof C.Add||e instanceof C.Subtract)&&e.args.some(t=>Rw(t))&&e.args.some(t=>Aw(t))||e instanceof C.Assignment&&Rm(e._expression))}function E1(e){let t;for(let n=0;n<e.length;n++)if(e[n].dependsOn(br)){if(t!==void 0)return;t=n}return t}function Nm(e,t){var n;if(t.dependsOn(br))switch(t.type){case"Identifier":return C.Constant(1);case"Negative":{let r=Nm(e,t.args[0]);return r===void 0?void 0:t.copyWithArgs([r])}case"Multiply":case"DotMultiply":case"CrossMultiply":switch(E1(t.args)){case 0:{let s=Nm(e,t.args[0]);return s===void 0?void 0:t.copyWithArgs([s,t.args[1]])}case 1:{let s=Nm(e,t.args[1]);return s===void 0?void 0:t.copyWithArgs([t.args[0],s])}default:return}case"Divide":{if(E1(t.args)!==0)return;let s=Nm(e,t.args[0]);return s===void 0?void 0:t.copyWithArgs([s,t.args[1]])}case"FunctionCall":return t._symbol===br&&t.args.length===1&&!t.args[0].dependsOn(br)?t.args[0]:t.args.length===1&&t.args[0].type==="Identifier"&&t.args[0]._symbol===br&&t._symbol!==void 0&&!((n=e[t._symbol])!=null&&n.isFunction)?C.Identifier(t._symbol):void 0;default:return}}function Yb(e,t){if(t.dependsOn(br))switch(t.type){case"Add":case"Subtract":switch(E1(t.args)){case 0:{let r=Yb(e,t.args[0]);return r===void 0?void 0:[t.copyWithArgs([r[0],t.args[1]]),r[1]]}case 1:{let r=Yb(e,t.args[1]);return r===void 0?void 0:[t.copyWithArgs([t.args[0],r[0]]),t.type==="Subtract"?C.Negative([r[1]]):r[1]]}default:return}default:{let n=Nm(e,t);return n===void 0?void 0:[C.Constant(0),n]}}}function o$(e){return e.isError?e.getError():e.valueType===R?e.asValue():+e.asValue()}function a$(e,t,n,r){let s=[],i=!1;for(let o=0;o<n.columns.length;o++){let a=r.columns[o],u=n.columns[o],c=a.isError?[]:a.rawArgs.map(o$),l=Kr(a)?a.isCyclicDependencyError&&ga(u)&&u.isFreeVariable(t):ha(a)&&a.isIndependent,p=o>=1&&!r.columns[0].isError&&!a.isError&&!u.header.userData.hidden;p&&(i=!0);let f={computed:!l,values:c,plotted:p};a.isError&&(f.error=a.getError()),s.push(f)}return s[0].plotted=i,{column_data:s}}function u$(e,t,n){let r={variables:[],errorMap:{},dimensions:{}};if(e.areAllScalesLinear()||(r.errorMap.scale=!0),n.center.isError&&(r.errorMap.center=!0),n.radianAngle.isError&&(r.errorMap.angle=!0),n.width.isError&&(r.errorMap.width=!0),n.height.isError&&(r.errorMap.height=!0),n.opacity.isError&&(r.errorMap.opacity=!0),Object.keys(r.errorMap).length>0)return r.variables=t.getSliderVariables(e,n),r;r.dimensions.x=[],r.dimensions.y=[],r.dimensions.radianAngle=[],r.dimensions.width=[],r.dimensions.height=[],r.dimensions.opacity=[];let s=[n.center,n.radianAngle,n.width,n.height,n.opacity];return s.some(o=>o&&o.valueType&&j(o.valueType))&&(r.is_concrete_list=!0),C.List.eachArgs(s,o=>{let a=o[0].asValue(),u=+o[1].asValue(),c=Math.atan2(Math.sin(u),Math.cos(u));r.dimensions.x.push(+a[0]),r.dimensions.y.push(+a[1]),r.dimensions.radianAngle.push(c),r.dimensions.width.push(+o[2].asValue()),r.dimensions.height.push(+o[3].asValue()),r.dimensions.opacity.push(Math.max(0,Math.min(1,+o[4].asValue())))}),(e.graphingEnabled()?t.getGraphMode(e,n):10)!==10&&(r.is_graphable=!0),n.moveStrategy&&(r.move_strategy=n.moveStrategy),t.center&&(t.center.type==="Identifier"?(r.center_reference_id=t.center.referencedStatementId,r.center_reference_symbol=t.center._symbol):t.center.type==="ParenSeq"&&n.center.valueType===N&&(r.center_is_point_literal=!0)),r}function c$(e,t,n){let r=n.handler,s=n.minStep,i={},o={};for(let p of r.getDependencies())e.validActionVariable(p)||(i[p]=!0);for(let p of s.getDependencies())o[p]=!0;let a;if(Kr(s))a={status:"error",error:s.getError()};else{let p=s.asValue();typeof p=="number"&&!isNaN(p)&&p>=0?a={status:"valid",value:p}:a={status:"error",error:DI().getError()}}let u=Object.keys(i);u.length>0&&(r=rn(u).setDependencies(r.getDependencies()));let c;r.isError&&!C1(e,r)?c={status:"error",error:r.getError()}:r.isEmptyAction?c={status:"empty"}:c={status:"maybe-valid"};let l={handler:c,minStep:a,variables:[]};return mc(l,e,{...i,...o}),l}function l$(){return{operator:"=",variables:[]}}function Lw(e,t,n,r){if(Hi(n))return a$(e,t,n,r);if(_f(n))return u$(e,n,r);let s=l$();if(n instanceof C.Ticker)return e.graphingEnabled()?c$(e,n,r):(s.error=U("Ticker without graphing").getError(),s);if(e.is3dProduct()){let c=e,l=n.getGraphMode(c,r);if((l===100||l===5)&&r.getDependencies().length===1){let p=r.getDependencies()[0];(p==="u"||p==="v"||p==="t")&&(s.internal_domain_dependency=p)}}let i=am(n.userData);if(i){let c=r.getCursorContext();if(c)s.cursor_context={...c,selection:i};else if(Kr(r)){let l=d$(e,t,n);l&&(s.cursor_context={...l,selection:i})}}if((n instanceof C.FunctionDefinition||n instanceof C.Assignment||n instanceof C.RecursiveFunctionBaseCase)&&(n._symbol.startsWith("_")||(s.defined_name=n._symbol)),n instanceof Cr&&r instanceof on?s.recursion=r.getRecursiveFunctionMetadata():n instanceof Cr&&r instanceof v&&r.recursionMetadata&&(s.recursion=r.recursionMetadata),n instanceof Qr&&(s.recursion_base_case={symbol:n._symbol,argValue:n.specifiedArg.valid?n.specifiedArg.argValue:void 0}),r.warning!==void 0&&(s.warning=r.warning),r.isError&&!((n instanceof C.FunctionDefinition||n instanceof C.RecursiveFunctionBaseCase)&&!r.blocksExport)&&!r.silent){s.error=r.getError(),s.variables=n.getSliderVariables(e,r),s.is_single_identifier=n instanceof C.Identifier,r.actionValue&&(s.action_value=I1(r.actionValue));let c=_w(e,t,n,r);return c&&(s.geometry=c),s}if(r.valueType===Kt&&r.getDependencies().length===0){let c=r.asValue();s.rgb_value=kc(c[0],c[1],c[2]).formatHex()}r.valueType===ut&&r.getDependencies().length===0&&(s.action_value=I1(r.asValue())),r.moveStrategy&&(s.move_strategy=r.moveStrategy,s.default_drag_mode=r.defaultDragMode),n.isInequality()&&(s.is_inequality=!0),s.operator=n.getOperator(),r instanceof C.SolvedEquation?r._expression.asValue()!==!0&&r._expression.asValue()!==!1&&(s.assignment=r._symbol):n instanceof C.Assignment&&(n._symbol.startsWith("_")||(s.assignment=n._symbol)),n instanceof C.FunctionDefinition&&(s.function_definition=n._symbol);let o=e.graphingEnabled()?n.getGraphMode(e,r):10;if(e.graphingEnabled()&&e.is3dPolicy()&&(!va(o)&&!iw(o)&&(o=10),r instanceof C.OptimizedRegression&&(o=10)),o!==10&&(s.is_graphable=!0,s.expression_type=n.getExpressionType(o,r.valueType),e.is3dPolicy()&&(s.expression_type==="SINGLE_POINT"?s.expression_type="POINT3D":s.expression_type==="POINT_LIST"&&(s.expression_type="POINT3D_LIST")),r.valueType&&ua(r.valueType)&&(s.map_type=r.valueType),r.isShadeBetween()&&(s.is_shade_between=!0),s.expression_type!=="POINT3D"&&s.expression_type!=="POINT3D_LIST")){let c=n.tableInfo(e,r);c&&(s.is_tableable=!0,s.table_info=c)}if(r.valueType!==void 0&&j(r.valueType)&&(s.is_concrete_list=!0,r.valueType===rr&&r.getDependencies().length===0)){let c=r.asValue();c&&(s.rgb_value=c.map(l=>kc(l[0],l[1],l[2]).formatHex()))}if(s.variables=s.is_graphable?[]:n.getSliderVariables(e,r),s.is_single_identifier=n instanceof C.Identifier,r.isTypedConstant){let c=r.asTypedValue();s.typed_constant_value=c,p$(c==null?void 0:c.valueType)&&(s.geometry=_w(e,t,n,r))}if(r.getEvaluationInfo()&&s.operator==="="&&!n.isConstant&&!n.isFunction&&!(n instanceof C.RecursiveFunctionBaseCase)&&r.valueType!==De&&r.valueType!==Xn&&!(n instanceof C.Equation)&&!(n instanceof C.ComparatorChain)&&!(e.isComplexEnabled()&&Rm(n))&&(s.is_evaluable=!0),r instanceof C.OptimizedRegression){let c=r,l={};for(let p of We(c.parameters))c.parameters.hasOwnProperty(p)&&(l[qr(p)]=+c.parameters[p].asValue());s.is_regression=!0,s.regression={parameters:l,displayPrecision:c.displayPrecision,residualVariable:qr(c.residualVariable),residualSuggestionId:c.residualSuggestionId,shouldSuggestLogMode:c.shouldSuggestLogMode,isLinear:c.isLinear,statistics:c.statistics,parameterWarning:c.parameterWarning}}let u=ou(n);return u&&u.discrete&&(s.is_discrete_distribution=!0),s}function p$(e){switch(e){case N:case Pt:case fe:case jn:case de:case xn:case Ne:case Vn:case le:case Jn:case ce:case Wn:case ie:case Fn:case xe:case In:case Le:case On:case ye:case Nn:case Re:case Rr:return!0;default:return!1}}function _w(e,t,n,r){let s={};r.valueType!==void 0&&(s.valueType=r.valueType),s.valueType&&se(s.valueType,N)&&e.graphingEnabled()&&uu(n.getGraphMode(e,r))&&(s.isMovablePoint=!0);let{identifier:i,listAccess:o,tree:a}=ah(n);if(i&&(s.identifier=i),o&&(s.listAccess=o),a&&(s.call=a,r.valueType&&se(r.valueType,Re)&&n instanceof Cr)){let c=n._expression;s.transformation_preview_info={type:a.symbol,args:c.args.slice(1).map(l=>l.tryGetConcreteTree(e,t).asTypedValue())}}let u=r.moveStrategy&&r.moveStrategy[0];if(u&&"initialValue"in u&&u.initialValue!==void 0&&(s.gliderParameter=u.initialValue),Object.keys(s).length>0){let c=n.getLegalExports(e);return{parentDependencies:n.getDependencies().filter(p=>!tt[p]&&!c.includes(p)),...s}}}function d$(e,t,n){let r=am(n.userData);if(!r)return;let{input:s,start:i,end:o}=r;if(s.trim()==="")return{type:"empty",allowedTypes:[Qt]};let a="\\\\cursor",u=s.slice(0,i)+a+" "+s.slice(o),c={start:i,end:i+a.length},l=Mi(u,{...n.parseOptions});return l.userData={...n.userData,latex:u,latexSelection:c},l.isError?l.getCursorContext():od({policy:e,frame:t},l).getCursorContext()}function mc(e,t,n){let r=e.variables;if(r&&r.length){let s={};for(let i of r)s[i]=!0;for(let i of We(n))s[i]=!0;n=s}e.variables=t.sliderVariables(We(n))}function C1(e,t){if(t.blocksExport)return!1;let n=t.getDependencies();if(n.length===0)return!1;for(let r of n)if(!e.validActionVariable(r))return!1;return!0}var q=class{constructor(t,n,r,s){this.policy=t,this.rawTree=r,this.concreteTree=s,this.evaluationState=Lw(t,n,r,s)}graph(t,n){return this.rawTree.tryGraph(this.policy,this.concreteTree,t,n)}getGraphMode(){return this.policy.graphingEnabled()?this.rawTree.getGraphMode(this.policy,this.concreteTree):10}getGraphInfo(){return this.rawTree.getGraphInfo(this.policy,this.concreteTree)}shouldIntersect(){if(!this.evaluationState.is_graphable||!this.rawTree.userData.shouldGraph||!Si.pointsOfInterest)return!1;let t=this.getGraphMode();return t===1||t===2}};var ww=new C.Constant(Se(0,1));C.Assignment.prototype.getMoveStrategy=function(e,t,n,r){return this._expression.getMoveStrategy(e,t,n,r)};function f$(e){return{type:"updateSliderNonlinear",id:e.id,initialValue:e.initialValue,min:e.min,max:e.max,compiled:e.compiled,isComplex:e.isComplex}}function m$(e){return{type:"updateGliderParameter",span:e.span,movesOn:e.movesOn}}function y$(e){return{type:"updateSliderForGlider",id:e.sliderId,movesOn:e.movesOn,min:e.min,max:e.max}}function Fw(e,t,n,r,s,i){let o=t.getDependencies();for(let a of o)if(s[a])return;for(let a=o.length-1;a>=0;a--){let u=o[a];if(i[u])continue;let c=r[u];if(c===void 0)continue;let l=n[u];if(l.order!==1)continue;let f=l.tree.getPolynomialCoefficients(u),d=f[1]||ww,y=f[0]||ww;if(!y.isConstant||!d.isConstant||!isFinite(y.asValue())||!isFinite(d.asValue())||d.asValue()===0)continue;let g=[-y.asValue()/d.asValue(),1/d.asValue()];return{symbol:u,id:c,coefficients:g}}}function g$(e,t){for(let n in t)if(t[n].evaluationState.assignment===e)return n}function h$(e){let t={};for(let n=0;n<e.length;n++)t[e[n]]=!0;return t}function D1(e,t){let n=h$(e),r={};for(let s in t){let i=t[s].evaluationState.assignment;t[s].evaluationState.is_slidable&&n[i]&&(r[i]=s)}return r}function Vw(e,t,n,r){let s=[];for(let i=0;i<n.length;i++){let o=n[i],a={};s.push(a);for(let u=0;u<r.length;u++){let c=r[u],l=Tn(t);l[c]=void 0;let p=o.tryGetConcreteTree(e,l);if(p.isError){a[c]={tree:p,order:1/0};continue}else a[c]={tree:p,order:p.polynomialOrder(c)}}}return s}function Bw(e,t,n){for(let r=0;r<e.length;r++){let s=e[r];t[s].order!==0&&(n[s]=!0)}}C.ParenSeq.prototype.getMoveStrategy=function(e,t,n,r){return Gw(this,e,t,n,r)};function Gw(e,t,n,r,s){var h;let i=r.valueType===R;if(r.valueType!==N&&!i||r.getDependencies().length!==0)return;if(i&&Rm(e)){let x=e.getInputSpan();return x?[{type:"updateCoordinate",inputSpan:x},{type:"updateCoordinate",inputSpan:x}]:void 0}let o=e.getDependencies(),a=D1(o,s),u=We(a),c;i?c=Yb(n,e):c=e.args;let l=[{type:"none"},{type:"none"}];if(c){let x=Vw(t,n,c,u),T={},b={};for(let M=0;M<2;M++){let P=c[M],D=e.args[M];if(D.isConstant&&!i){let O=D.getInputSpan();l[M]=O?{type:"updateCoordinate",inputSpan:O}:{type:"none"};continue}let S=Fw(t,P,x[M],a,T,b);S&&(l[M]={type:"updateSlider",id:S.id,coefficients:S.coefficients},T[S.symbol]=!0,Bw(u,x[M],b)),l[M]||(l[M]={type:"none"})}i&&(l[0].type==="updateSlider"&&l[1].type==="none"?c[1].tryGetConcreteTree(t,n).valueType!==I&&(l[0]={type:"none"}):l[0].type==="none"&&l[1].type==="updateSlider"&&c[0].tryGetConcreteTree(t,n).valueType!==I&&(l[1]={type:"none"}))}let[p,f]=l,d;if(p.type==="none"&&f.type==="none"&&u.length===1&&(d=u[0]),!d)return p.type!=="none"||f.type!=="none"?l:void 0;let y=a[d],g;try{let x=Tn(n);x[d]=void 0,g=e.getConcreteTree(t,x).getCompiledFunction()}catch(x){return}f0(g);let m=s[y].evaluationState;return[f$({id:y,initialValue:(h=m.typed_constant_value)==null?void 0:h.value,min:m.slider_min_number,max:m.slider_max_number,compiled:g,isComplex:i}),{type:"none"}]}function b$(e,t,n,r,s){if(!r.isTypedConstant||r.valueType!==N)return;let i,o,a;switch(e.args[1].type){case"Constant":{if(typeof e.args[1].asValue()!="number"||(i=e.args[0].getConcreteTree(t,n),!i.isTypedConstant))return;a=i.asTypedValue();let c=e.args[1].getInputSpan();return[c?m$({span:c,movesOn:a}):{type:"none"},{type:"none"}]}case"Identifier":{let u=e.args[1]._symbol,l=D1([u],s)[u];if(l===void 0)return;let p=s[l].evaluationState,f=Tn(n);return f[u]=void 0,i=e.args[0].getConcreteTree(t,f),i.isTypedConstant?(a=i.asTypedValue(),o={min:p.slider_min_number,max:p.slider_max_number},[y$({min:o.min,max:o.max,movesOn:a,sliderId:l}),{type:"none"}]):void 0}default:return}}function kw(e,t,n,r,s){if(r.valueType===R)return Gw(e,t,n,r,s)}C.Expression.prototype.getMoveStrategy=function(e,t,n,r){return kw(this,e,t,n,r)};C.FunctionCall.prototype.getMoveStrategy=function(e,t,n,r){return this._symbol=="glider"?b$(this,e,t,n,r):kw(this,e,t,n,r)};C.Image.prototype.getMoveStrategy=function(e,t,n,r){if(n.center.valueType!==N||n.center.getDependencies().length!==0||!n.width.isConstant||!n.height.isConstant||!n.radianAngle.isConstant||!n.opacity.isConstant)return;let s=this.getDependencies(),i=D1(s,r),o=We(i),a=[this.width,this.height];this.center.type==="ParenSeq"?a.push(this.center.args[0],this.center.args[1]):this.center.type==="Identifier"&&(this.center.referencedStatementId=g$(this.center._symbol,r));let u={},c={},l=Vw(e,t,a,o),p=[],f=[2,3,0,1];for(let d=0;d<f.length;d++){let y=f[d],g=a[y];if(!g){p[y]={type:"none"};continue}if(g.isConstant){let h=g.getInputSpan();p[y]=h?{type:"updateCoordinate",inputSpan:h}:{type:"none"};continue}let m=Fw(e,g,l[y],i,u,c);m&&(p[y]={type:"updateSlider",id:m.id,coefficients:m.coefficients},u[m.symbol]=!0,Bw(o,l[y],c)),p[y]||(p[y]={type:"none"})}if(!(p[0].type==="none"&&p[1].type==="none"&&p[2].type==="none"&&p[3].type==="none"))return p};var S1=e=>e==null?void 0:e.some(t=>"isComplex"in t&&t.isComplex);C.Base.prototype.analyze=function(e,t){return hs(this)?bs(e,t,this):new q(e,t,this,this.tryGetConcreteTree(e,t))};function Xb(e,t,n,r){if(r.isError)return new q(e,t,n,r);if(!e.areAllScalesLinear()&&!Ul(r.valueType)){let u=Yl(oe(r.valueType));return u.setCursorContext(r.getCursorContext()),new q(e,t,n,u)}let s=Do(e,r),i=r.getDependencies(),o,a=se(r.valueType,R)&&s.some(u=>e.validParametricVariable(u));switch(r instanceof C.IRExpression&&i.length>0&&!a&&(r=r.coerceToNumericIfPossible()),r.valueType){case Lt:case Zn:case $e:{o=r;break}case Kt:case rr:case de:case xn:case ce:case Wn:case ie:case Fn:case fe:case jn:case Ne:case Vn:case le:case Jn:case Le:case On:case ye:case Nn:case Re:case Rr:case ut:case xe:case In:case wt:case mr:case ke:case gr:case Rn:case yr:case Hn:case Ar:case Pn:case cs:s.length?o=rn(n.getSliderVariables(e,r)).setDependencies(s):o=r;break;case N:case z:case Pt:case fr:case R:case Ue:if(s.length)if(e.validParametricVariables(s))o=r;else{let u=n.getSliderVariables(e,r);o=rn(u).setDependencies(u)}else o=r;break;case sr:case or:case Pr:case Mr:case ir:case Er:case $r:case Wr:case Xr:case jr:case Yr:case Zr:{s.length===0?o=r:o=rn(n.getSliderVariables(e,r)).setDependencies(s);break}case I:case ne:s.length===0?o=r:s.length<=(e.is3dPolicy()?2:1)?e.is3dPolicy()&&i.length>s.length&&!e.validImplicitVariables(i)?o=rn(n.getSliderVariables(e,r)).setDependencies(i):e.validExpressionVariables(s)?o=r:o=wy(e.implicitDependency(s)).setDependencies(s):e.validImplicitVariables(s)?o=wy().setDependencies(s):o=rn(n.getSliderVariables(e,r)).setDependencies(i);break;default:o=U(`Programming error: unexpected value type ${r.valueType}`)}return Kr(o)&&o.setCursorContext(r.getCursorContext()),o=Pd(e,n,o),new q(e,t,n,o)}function Uw(e){return new C.FunctionCall("pdf",[e,new C.Identifier("x")])}C.Identifier.prototype.analyze=function(e,t,n){if(this._symbol===br){let i=v1(this,e,t,this.tryGetConcreteTree(e,t),n);if(i)return new q(e,t,this,i)}let r=this.tryGetConcreteTree(e,t,{coerceToNumber:"all-except-complex"}),s=Xb(e,t,this,r);return hs(this)&&!N1(s)?bs(e,t,this):s};C.FunctionCall.prototype.analyze=function(e,t,n){let r;Qh[this._symbol]&&xl(t,this).length===0&&!e.is3dPolicy()?r=Uw(this).tryGetConcreteTree(e,t):r=this.tryGetConcreteTree(e,t);let s=Xb(e,t,this,r);if(hs(this)&&!N1(s))return bs(e,t,this);let i=this.getMoveStrategy(e,t,r,n);if(i){let o=this.getDefaultDragMode(i),a=r.asCompilerValue(),u=[new C.Constant(a[0]),new C.Constant(a[1])];return r=Zb(r,S1(i)?new C.MovableComplexNumber(u,i,o):new C.MovablePoint(u,i,o)),new q(e,t,this,r)}return s};function v1(e,t,n,r,s,i){if(r.valueType!==R)return;let o=e.getMoveStrategy(t,n,r,s);if(!o)return;let a=(i!=null?i:e).getDefaultDragMode(o),u=r.asCompilerValue();return r=Zb(r,new C.MovableComplexNumber([new C.Constant(u[0]),new C.Constant(u[1])],o,a)),r.metaData=e.metaData,r}C.Expression.prototype.analyze=function(e,t,n){let r=Xb(e,t,this,this.tryGetConcreteTree(e,t));if(hs(this)&&!N1(r))return bs(e,t,this);let s=v1(this,e,t,r.concreteTree,n);return s?new q(e,t,this,s):r};C.FunctionDefinition.prototype.analyze=function(e,t){var a;if(hs(this))return bs(e,t,this);if(tt[this._symbol])return this.asEquation().analyze(e,t);let n=this._symbol.split("_")[0];if((a=tt[n])!=null&&a.isFunction)return new q(e,t,this,Zl(this._symbol,n));let r=this.tryGetConcreteTree(e,t);if(r instanceof C.Error&&!r.blocksExport&&this._argSymbols.length===1){let u=Tn(t);u[this._argSymbols[0]]=new we("identityTransformation");let c=this._expression.tryGetConcreteTree(e,u);if(c instanceof on&&se(c.valueType,Re))return new q(e,t,this,c)}if(e.is3dPolicy()&&e.assignmentForbidden(this._symbol))return new q(e,t,this,zy(this._symbol));if(r.isError)return new q(e,t,this,r);let s=this._argSymbols,i=r.getDependencies();r instanceof C.IRExpression&&i.length>0&&(r=r.coerceToNumericIfPossible());let o=i.filter(u=>s.indexOf(u)===-1);if(e.unplottablePolarFunction(this._symbol,i))return new q(e,t,this,qI());if(o.some(u=>e.assignmentForbidden(u)))return new q(e,t,this,Zd(o,this._symbol,s).setDependencies(i));if(o.length){let u=this.getSliderVariables(e,r);return new q(e,t,this,rn(u).setDependencies(u))}return!e.areAllScalesLinear()&&!Ul(r.valueType)?new q(e,t,this,Yl(oe(r.valueType))):(r=Pd(e,this,r),new q(e,t,this,r))};C.Assignment.prototype.analyze=function(e,t,n){if(hs(this))return bs(e,t,this);let r=this._symbol;if(!e.validLHS(r))return new q(e,t,this,UI(r));if(tt.hasOwnProperty(r)||e.isComplexEnabled()&&r===br)return this.asEquation().analyze(e,t);let s;if(this._expression instanceof C.FunctionCall&&Qh[this._expression._symbol]&&xl(t,this).length===0&&!e.is3dPolicy())s=Uw(this._expression).tryGetConcreteTree(e,t);else{let d=Tn(t);d[r]=e.validSolvedVariable(r)?void 0:Ac(),s=this.tryGetConcreteTree(e,d)}if(s.isError)return new q(e,t,this,s);if(!e.areAllScalesLinear()&&!Ul(s.valueType))return new q(e,t,this,Yl(oe(s.valueType)));if(this.isEquation(e,s))return this.asEquation().analyze(e,t);let i=s.valueType===Kt||s.valueType===rr;if(e.assignmentForbidden(r)&&i){let d=HI(r).allowExport().setDependencies([r]);return new q(e,t,this,d)}let o=s.getDependencies(),a=Do(e,s);s instanceof C.IRExpression&&!(this.getGraphMode(e,s)===5&&!e.assignmentForbidden(r))&&(o.length>0||e.graphMode(r,a,o)!==10)&&(s=s.coerceToNumericIfPossible());let u=a.includes("x")||a.includes("y"),c=a.includes("r")||a.includes("theta");if(r==="r"&&o.includes("phi")){let d=a.includes("z")?Oy():BI();return new q(e,t,this,d)}if(r==="rho"&&a.includes("z")){let d=o.includes("phi")?Oy():GI();return new q(e,t,this,d)}let l=this.getSliderVariables(e,s,o);if(e.tooManySliderVariables(o,l,i)||u&&c){let d=rn(l).allowExport().setDependencies(l);return new q(e,t,this,d)}let p=v1(this._expression,e,t,s,n,this);if(p)return new q(e,t,this,p);let f=this.getMoveStrategy(e,t,s,n);if(f){let d=this.getDefaultDragMode(f);return s=Zb(s,S1(f)?new C.MovableComplexNumber([s.slot(0),s.slot(1)],f,d):new C.MovablePoint([s.slot(0),s.slot(1)],f,d)),new q(e,t,this,s)}return s=Pd(e,this,s),new q(e,t,this,s)};C.RecursiveFunctionBaseCase.prototype.analyze=function(e,t){if(hs(this))return bs(e,t,this);if(!this.specifiedArg.valid)return new q(e,t,this,this.specifiedArg.error);let n=this.tryGetConcreteTree(e,t);if(n.isError)return new q(e,t,this,n);let r=this._argSymbols,s=n.getDependencies();if(e.is3dPolicy()&&e.assignmentForbidden(this._symbol))return new q(e,t,this,zy(this._symbol));let i=s.filter(o=>r.indexOf(o)===-1);if(i.includes(this.specifiedArg.argSymbol))return new q(e,t,this,Ox(this.specifiedArg.argSymbol));for(let o of i)if(e.assignmentForbidden(o))return new q(e,t,this,vx(o));if(i.length){let o=this.getSliderVariables(e,n);return new q(e,t,this,rn(o).setDependencies(o))}return!e.areAllScalesLinear()&&!Ul(n.valueType)?new q(e,t,this,Yl(oe(n.valueType))):new q(e,t,this,n)};function Hw(e,t,n){let r=new we(n).tryGetConcreteTree(e,t);if(Kr(r))return r;if(r.isTypedConstant){let s=r.asTypedValue();if(s!==void 0)return s}return IT()}function x$(e){return e[1]!==0&&!isNaN(e[1])}function zw(e){return e.valueType===Ue&&e.value.some(x$)}function T$(e,t,n){let[r,s]=n.variables,i=Hw(e,t,r),o=Hw(e,t,s);if(!("value"in i))return i;if(!("value"in o))return o;if(zw(i)||zw(o))return TT(oe(R))}C.Regression.prototype.analyzeRegression=function(e,t,n,r,s){if(!e.isCustomRegressionSupported()&&!this.tableRegressionData)return new q(e,t,this,CP());if(hs(this))return bs(e,t,this);let i={policy:e,frame:t,exportFrame:n,lastExportFrame:r,tableStatements:s};if(this.tableRegressionData){let a=T$(e,t,this.tableRegressionData);if(a)return new q(e,t,this,a)}let o=iL(i,this);if(o instanceof Wa&&o.model instanceof C.IRExpression&&(o.model=o.model.coerceToNumericIfPossible()),this.tableRegressionData&&o instanceof Wa){let a=We(o.parameters).filter(u=>!/^regressionparameter_/.test(u));if(a.length)return new q(e,t,this,rn(a))}return new q(e,t,this,o)};function O1(e,t){let n=this.tryGetConcreteTree(e,t),r=n.getDependencies();return r.length?new q(e,t,this,rn(this.getSliderVariables(e,n)).setDependencies(r)):new q(e,t,this,this.tryGetConcreteTree(e,t))}C.Histogram.prototype.analyze=function(e,t){return hs(this)?bs(e,t,this):e.areAllScalesLinear()?O1.call(this,e,t):new q(e,t,this,NT())};C.DotPlot.prototype.analyze=function(e,t){return hs(this)?bs(e,t,this):e.areAllScalesLinear()?O1.call(this,e,t):new q(e,t,this,RT())};C.BoxPlot.prototype.analyze=function(e,t){return hs(this)?bs(e,t,this):e.areAllScalesLinear()?O1.call(this,e,t):new q(e,t,this,AT())};function qw(e){return function(t,n){if(hs(this))return bs(t,n,this);let r=this.tryGetConcreteTree(t,n),s=r.getDependencies();if(s.length)return new q(t,n,this,rn(this.getSliderVariables(t,r)).setDependencies(s));let i=new q(t,n,this,this.tryGetConcreteTree(t,n));if(!r.isError){i.evaluationState.expression_type="TTEST";let o=r.args.map(a=>a.asValue());i.evaluationState.ttest_results=e.apply(null,o)}return i}}C.TTest.prototype.analyze=qw(GE);C.IndependentTTest.prototype.analyze=qw(kE);C.Stats.prototype.analyze=function(e,t){if(hs(this))return bs(e,t,this);let n=this.tryGetConcreteTree(e,t),r=n.getDependencies();if(r.length)return new q(e,t,this,rn(this.getSliderVariables(e,n)).setDependencies(r));let s=new q(e,t,this,this.tryGetConcreteTree(e,t));if(!n.isError){s.evaluationState.expression_type="STATS";let i=n.args.map(o=>o.asValue());s.evaluationState.stats_results=HE.apply(null,i)}return s};C.Equation.prototype.analyze=C.CallAssignment.prototype.analyze=C.BaseComparator.prototype.analyze=I$;function I$(e,t){if(hs(this))return bs(e,t,this);if(this.getOperator()!=="="&&!Si.plotInequalities)return new q(e,t,this,Ry());let r=uL({policy:e,frame:t},this);if(r.isError)return new q(e,t,this,r);let s=Do(e,r);if(r instanceof C.SolvedEquation&&s.length){let i=s.concat(r._symbol);if(!e.validImplicitVariables(i))return new q(e,t,this,Ac().setDependencies(i))}return this.getGraphMode(e,r)===8&&!e.validImplicitVariables(s)?new q(e,t,this,Ac().setDependencies(s)):(r=Pd(e,this,r),new q(e,t,this,r))}C.DoubleInequality.prototype.analyze=function(e,t){if(hs(this))return bs(e,t,this);if(!Si.plotInequalities)return new q(e,t,this,Ry());let n=this.tryGetConcreteTree(e,t);if(n.isError)return new q(e,t,this,n);let r=n.getDependencies();return Jr[this._operators[0]].direction!==Jr[this._operators[1]].direction?new q(e,t,this,_y()):e.validDoubleInequalitySymbol(n._symbol)?e.validDoubleInequalityVariables(r)?r.length>2?new q(e,t,this,rn(this.getSliderVariables(e,n)).setDependencies(r)):n._expressions[0].getDependencies().indexOf(n._symbol)!==-1||n._expressions[1].getDependencies().indexOf(n._symbol)!==-1?new q(e,t,this,Ly().setDependencies(r)):new q(e,t,this,n):new q(e,t,this,Ay().setDependencies(r)):new q(e,t,this,Ay().setDependencies(r))};C.ComparatorChain.prototype.analyze=function(e,t){if(hs(this))return bs(e,t,this);let n=this.tryGetConcreteTree(e,t);if(n.isError)return new q(e,t,this,n);let r=n.getDependencies();if(r.length)if(e.is3dPolicy()){if(!e.validImplicitVariables(r))return new q(e,t,this,(this.symbols.includes("=")?YI():jI()).setDependencies(r));if(!(this.symbols.every(i=>i==="<"||i==="<=")||this.symbols.every(i=>i===">"||i===">=")||this.symbols.every(i=>i==="=")))return new q(e,t,this,_y().setDependencies(r));if(this.symbols.includes("=")&&!r.includes("z"))return new q(e,t,this,JI().setDependencies(r));let s=this._difference.tryGetConcreteTree(e,t);return s=Pd(e,this,s),new q(e,t,this,s)}else return this.symbols.includes("=")?new q(e,t,this,QI()):this.symbols.length>2?new q(e,t,this,$x()):e.validDoubleInequalityVariables(r)?new q(e,t,this,Ly()):new q(e,t,this,rn(this.getSliderVariables(e,n)).setDependencies(r));return new q(e,t,this,n)};C.ParenSeq.prototype.analyze=function(e,t,n){if(hs(this))return bs(e,t,this);let r=this.tryGetConcreteTree(e,t);if(r.isError)return new q(e,t,this,r);let s=this.getMoveStrategy(e,t,r,n);if(s){let i=this.getDefaultDragMode(s),o=r.asCompilerValue(),a=[new C.Constant(o[0]),new C.Constant(o[1])];return r=Zb(r,new C.MovablePoint(a,s,i)),new q(e,t,this,r)}return Xb(e,t,this,r)};C.Table.prototype.analyze=function(e,t){let n=this.getConcreteTree(e,t),r=new q(e,t,this,n);return r.evaluationState.is_graphable=!0,r};C.Image.prototype.analyze=function(e,t,n){let r=this.tryGetConcreteTree(e,t);if(r.radianAngle.isError||r.center.isError||r.width.isError||r.height.isError||r.opacity.isError)return new q(e,t,this,r);let s=r.center.getDependencies(),i=r.radianAngle.getDependencies(),o=r.width.getDependencies(),a=r.height.getDependencies(),u=r.opacity.getDependencies();return s.length||i.length||o.length||a.length||u.length?new q(e,t,this,new C.Image({center:s.length?rn(i).setDependencies(s):r.center,radianAngle:i.length?rn(i).setDependencies(i):r.radianAngle,width:o.length?rn(o).setDependencies(o):r.width,height:a.length?rn(a).setDependencies(a):r.height,opacity:u.length?rn(u).setDependencies(u):r.opacity})):(r.moveStrategy=this.getMoveStrategy(e,t,r,n),new q(e,t,this,r))};C.Slider.prototype.analyze=function(e,t){if(hs(this))return bs(e,t,this);let n=this.tryGetConcreteTree(e,t),r=n.sliderInfo,s;if(r.missingVars.length){let o=ux(r.missingVars);s=new q(e,t,this,rn(e.sliderVariables(o)).setDependencies(o).allowExport())}else s=new q(e,t,this,n);let i=s.evaluationState;if(Si.sliders){i.assignment=r.exportedSymbol,i.slider_min_number=r.values.min,i.slider_max_number=r.values.max,i.slider_step_number=r.values.step,i.slider_min_valid=r.valids.min,i.slider_max_valid=r.valids.max,i.slider_step_valid=r.valids.step;let o=i.slider_min_valid&&i.slider_max_valid&&i.slider_step_valid;i.is_slider=!0,i.raw_slider_latex=this.getInputString(),i.is_slidable=o,i.is_animatable=i.is_slidable&&!i.is_graphable,r.errMsg&&(i.error=r.errMsg.getError())}return delete i.is_evaluable,s};function hs(e){return e.userData&&"latex"in e.userData&&oa(e.userData.latex).slice(-1)==="="}function bs(e,t,n){return new q(e,t,n,$d("="))}function N1(e){return e.concreteTree.isConstant&&e.concreteTree.valueType===I||e.concreteTree.isTypedConstant&&e.concreteTree.valueType===R}function Zb(e,t){return t.warning=e.warning,t}C.Base.prototype.analyzeFourFunction=function(e,t){let n=this.tryGetConcreteTree(e,t);return n.isError?new q(e,t,this,n):new q(e,t,this,U(`Unexpected node type ${this.type}`))};C.Expression.prototype.analyzeFourFunction=function(e,t){let n=this.tryGetConcreteTree(e,t);if(n.isError)return new q(e,t,this,n);let r=n.getDependencies();if(r.length>0){let s=r[0],i,o=tt[s];return o?i=o.isFunction?Li(s,e):_c(s):i=ef(s),new q(e,t,this,i)}return new q(e,t,this,n)};C.Assignment.prototype.analyzeFourFunction=function(e,t){return new q(e,t,this,tf())};C.FunctionDefinition.prototype.analyzeFourFunction=function(e,t){return new q(e,t,this,nf())};function $w(e,t){return new q(e,t,this,Ua())}C.Equation.prototype.analyzeFourFunction=$w;C.CallAssignment.prototype.analyzeFourFunction=$w;function R1(e,t){return new q(e,t,this,Lc())}C.DoubleInequality.prototype.analyzeFourFunction=R1;C.ComparatorChain.prototype.analyzeFourFunction=R1;C.BaseComparator.prototype.analyzeFourFunction=R1;C.Regression.prototype.analyzeFourFunction=function(e,t){return new q(e,t,this,wc())};C.ParenSeq.prototype.analyzeFourFunction=function(e,t){return new q(e,t,this,Fc())};C.Base.prototype.analyzeScientific=function(e,t){let n=this.tryGetConcreteTree(e,t);return n.isError?new q(e,t,this,n):new q(e,t,this,U(`Unexpected node type ${this.type}`))};C.Expression.prototype.analyzeScientific=function(e,t){let n=this.tryGetConcreteTree(e,t);if(n.isError)return new q(e,t,this,n);let r=n.getDependencies();return r.length>0?new q(e,t,this,rn(r)):new q(e,t,this,n)};C.Assignment.prototype.analyzeScientific=function(e,t){let n=this._symbol;if(tt[n])return new q(e,t,this,Zl(n));let r=Tn(t);r[n]=Ua();let s=this.tryGetConcreteTree(e,r);if(s.isError)return new q(e,t,this,s);let i=s.getDependencies();return this.isEquation(e,s)?new q(e,t,this,Ua()):i.length>0?new q(e,t,this,rn(i)):new q(e,t,this,s)};C.FunctionDefinition.prototype.analyzeScientific=function(e,t){if(tt[this._symbol])return new q(e,t,this,Zl(this._symbol));let n=this.tryGetConcreteTree(e,t);if(n.isError)return new q(e,t,this,n);let r=this._argSymbols,s=n.getDependencies();if(s.indexOf(this._symbol)!==-1)return new q(e,t,this,Rc([this._symbol],{suggestAlternativeFunctionName:!1}));let i=s.filter(o=>r.indexOf(o)===-1);return i.length?new q(e,t,this,Zd(i,this._symbol,r)):new q(e,t,this,n)};function Yw(e,t){return new q(e,t,this,Ua())}C.Equation.prototype.analyzeScientific=Yw;C.CallAssignment.prototype.analyzeScientific=Yw;function A1(e,t){return new q(e,t,this,Lc())}C.DoubleInequality.prototype.analyzeScientific=A1;C.ComparatorChain.prototype.analyzeScientific=A1;C.BaseComparator.prototype.analyzeScientific=A1;C.Regression.prototype.analyzeScientific=function(e,t){return new q(e,t,this,wc())};C.ParenSeq.prototype.analyzeScientific=function(e,t){return new q(e,t,this,Fc())};C.Base.prototype.analyzeSingleExpressionScientific=function(e,t){let n=this.tryGetConcreteTree(e,t);return n.isError?new q(e,t,this,n):new q(e,t,this,U(`Unexpected node type ${this.type}`))};C.Expression.prototype.analyzeSingleExpressionScientific=function(e,t){let n=this.tryGetConcreteTree(e,t);if(n.isError)return new q(e,t,this,n);let r=n.getDependencies();if(r.length>0){let s=r[0],i,o=tt[s];return o?i=o.isFunction?Li(s,e):_c(s):i=ef(s),new q(e,t,this,i)}return new q(e,t,this,n)};C.Assignment.prototype.analyzeSingleExpressionScientific=function(e,t){return new q(e,t,this,tf())};C.FunctionDefinition.prototype.analyzeSingleExpressionScientific=function(e,t){return new q(e,t,this,nf())};function Xw(e,t){return new q(e,t,this,Ua())}C.Equation.prototype.analyzeSingleExpressionScientific=Xw;C.CallAssignment.prototype.analyzeSingleExpressionScientific=Xw;function _1(e,t){return new q(e,t,this,Lc())}C.DoubleInequality.prototype.analyzeSingleExpressionScientific=_1;C.ComparatorChain.prototype.analyzeSingleExpressionScientific=_1;C.BaseComparator.prototype.analyzeSingleExpressionScientific=_1;C.Regression.prototype.analyzeSingleExpressionScientific=function(e,t){return new q(e,t,this,wc())};C.ParenSeq.prototype.analyzeSingleExpressionScientific=function(e,t){return new q(e,t,this,Fc())};C.Base.prototype.getGraphInfo=function(e,t){let n=t.getDependencies(),r,s;switch(n.length){case 0:r=Zw(t),s=t.boundDomain("x");break;case 1:s=t.boundDomain(n[0]),hi(s)&&!Fs(s)&&(r=Zw(t));break;default:s=dr();break}return{graphMode:this.getGraphMode(e,t),color:Ra(this.userData,this.metaData),pointStyle:this.userData.pointStyle,lineStyle:this.userData.lineStyle,arrowMode:this.userData.arrowMode,operator:this.getOperator(),isLinear:!!r,linearCoefficients:r,domainBound:s}};function Zw(e){switch(e.valueType){case I:return L1(e);case N:{let t=L1(e.slot(0)),n=L1(e.slot(1));return!t||!n?void 0:[t,n]}default:return}}function L1(e){let t=e.getDependencies();switch(t.length){case 0:return[+e.asValue(),0];case 1:if(e.polynomialOrder(t[0])>1)return;let n=e.getPolynomialCoefficients(t[0]);return[n[0]?+n[0].asValue():0,n[1]?+n[1].asValue():0];default:return}}C.Assignment.prototype.getDefaultDragMode=function(e){return e[0].type!=="none"&&e[1].type!=="none"?"XY":e[0].type!=="none"?"X":e[1].type!=="none"?"Y":"NONE"};C.Expression.prototype.getDefaultDragMode=function(e){return e[0].type==="updateSlider"&&e[1].type==="updateSlider"?"XY":e[0].type==="updateSlider"?"X":e[1].type==="updateSlider"?"Y":e[0].type==="updateSliderNonlinear"&&e[0].isComplex?"X":"NONE"};C.FunctionCall.prototype.getDefaultDragMode=function(e){return C.Assignment.prototype.getDefaultDragMode.call(this,e)};var P$=C.List;C.Base.prototype.tableInfo=function(e,t){return!1};C.Identifier.prototype.tableInfo=function(e,t){return e.validFirstColumnVariable(this._symbol)?{independent_variable:this._symbol,dependent_column:this.getInputString(),by_reference:!1}:!1};C.Expression.prototype.tableInfo=function(e,t){let n=t.getDependencies();if(ou(this))return!1;switch(t.valueType){case N:case Pt:return n.length!==0||t.isMovablePoint&&(t.moveStrategy[0].type==="updateSlider"||t.moveStrategy[1].type==="updateSlider")?!1:{independent_variable:"x",dependent_column:"y",by_reference:!1,values:P$.wrap(t).asValue()};case I:if(n.length!==1)return!1;let s=n[0];return e.validFirstColumnVariable(s)?{independent_variable:s,dependent_column:this.getInputString(),by_reference:!1}:!1;default:return!1}};C.Assignment.prototype.tableInfo=function(e,t){if(t instanceof C.SolvedEquation||!this.getInputString().length||ou(this)||vd(t.valueType))return!1;let n=t.getDependencies();if(n.length>1)return!1;let r;if(n.length===0){if(!e.tableableAsConstant(this._symbol))return!1;r=e.implicitIndependent(this._symbol)}else r=n[0];if(!e.validFirstColumnVariable(r))return!1;let s=e.assignmentForbidden(this._symbol)?oa(this.getInputString().replace(/[^=]*=/,"")):oa(this.getInputString().split("=")[0]);return{independent_variable:r,dependent_column:s,by_reference:!e.assignmentForbidden(this._symbol)}};C.FunctionDefinition.prototype.tableInfo=function(e,t){if(this._argSymbols.length!==1||!this.getInputString().length||t.getDependencies().length>1)return!1;let r=this._argSymbols[0];if(!e.validFirstColumnVariable(r))return!1;let s=e.assignmentForbidden(this._symbol),i=s?oa(this.getInputString().replace(/[^=]*=/,"")):oa(this.getInputString().split("=")[0]);return{independent_variable:r,dependent_column:i,by_reference:!s}};C.BaseComparator.prototype.tableInfo=function(e,t){return!1};C.ComparatorChain.prototype.tableInfo=function(e,t){return!1};C.DoubleInequality.prototype.tableInfo=function(e,t){return!1};C.Equation.prototype.tableInfo=function(e,t){return!1};C.Base.prototype.tableError=function(){return this.isInequality()?E("shared-calculator-error-table-inequality-supplement"):!(this instanceof C.Expression)&&!(this instanceof C.IRExpression)?E("shared-calculator-error-table-generic-supplement"):!1};C.List.prototype.tableError=function(){return E("shared-calculator-error-table-list-supplement")};C.Equation.prototype.tableError=C.Assignment.prototype.tableError=function(){return E("shared-calculator-error-table-equation-supplement")};C.ComparatorChain.prototype.tableError=function(){return this.symbols.includes("=")?E("shared-calculator-error-table-equation-supplement"):E("shared-calculator-error-table-inequality-supplement")};C.FunctionDefinition.prototype.tableError=function(){return E("shared-calculator-error-table-function-definition-supplement")};C.Regression.prototype.tableError=function(){return E("shared-calculator-error-table-regression-supplement")};C.List.prototype.elementAt=function(e){return e=Math.floor(e),e>=0&&e<this.args.length?this.args[e]:new C.Constant(NaN)};C.List.prototype.eachElement=function(t){for(let n=0;n<this.length;n++)t(this.elementAt(n),n)};C.List.prototype.mapElements=function(t){let n=[];for(let r=0;r<this.length;r++)n.push(t(this.elementAt(r),r));return n};C.IRExpression.prototype.elementAt=function(e){let t=this._chunk.elementAt(e);return new on(t)};function E$(){return qr(this._symbol)+" "}C.Identifier.prototype.printLatex=E$;C.Constant.prototype.printLatex=function(){return wa(this.asValue())};C.Ticker.prototype.printLatex=function(){return"\\\\ticker\\\\left("+this.args.map(Ls).join(", ")+"\\\\right)"};C.Negative.prototype.printLatex=function(){return"-\\\\left("+this.args[0].printLatex()+"\\\\right)"};C.Add.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)+\\\\left("+this.args[1].printLatex()+"\\\\right)"};C.PercentOf.prototype.printLatex=function(){return this.args[0].printLatex()+" \\\\% \\\\operatorname{of} "+this.args[1].printLatex()};C.Subtract.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)-\\\\left("+this.args[1].printLatex()+"\\\\right)"};C.Multiply.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)*\\\\left("+this.args[1].printLatex()+"\\\\right)"};C.DotMultiply.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)\\\\cdot\\\\left("+this.args[1].printLatex()+"\\\\right)"};C.CrossMultiply.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)\\\\times\\\\left("+this.args[1].printLatex()+"\\\\right)"};C.Divide.prototype.printLatex=function(){return"\\\\frac{"+this.args[0].printLatex()+"}{"+this.args[1].printLatex()+"}"};C.Exponent.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)^{"+this.args[1].printLatex()+"}"};C.Assignment.prototype.printLatex=function(){return qr(this._symbol)+"="+this._expression.printLatex()};C.Equation.prototype.printLatex=C.CallAssignment.prototype.printLatex=function(){return this._lhs.printLatex()+"="+this._rhs.printLatex()};function Wb(e){switch(e){case">":return">";case"<":return"<";case">=":return"\\\\ge ";case"<=":return"\\\\le ";case"=":return"="}return""}C.BaseComparator.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)"+Wb(this.operator)+"\\\\left("+this.args[1].printLatex()+"\\\\right)"};C.ComparatorChain.prototype.printLatex=function(){let e="";for(let t=0;t<this.symbols.length;t++)e+=`\\\\left(${this.args[t].printLatex()}\\\\right)${Wb(this.symbols[t])}`;return e+=`\\\\left(${this.args[this.args.length-1].printLatex()}\\\\right)`,e};C.DoubleInequality.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)"+Wb(this.args[1])+this.args[2].printLatex()+Wb(this.args[3])+"\\\\left("+this.args[4].printLatex()+"\\\\right)"};C.Or.prototype.printLatex=function(){return this.args[0].printLatex()+","+this.args[1].printLatex()};function Ls(e){return e.printLatex()}function M$(){switch(this._symbol){case"sqrt":return"\\\\sqrt{"+this.args[0].printLatex()+"}";case"nthroot":return"\\\\sqrt["+this.args[1].printLatex()+"]{"+this.args[0].printLatex()+"}";case"logbase":return"\\\\log_{"+this.args[1].printLatex()+"}\\\\left("+this.args[0].printLatex()+"\\\\right)";default:return qr(this._symbol)+"\\\\left("+this.args.map(Ls).join(", ")+"\\\\right)"}}C.FunctionCall.prototype.printLatex=M$;C.RecursiveFunctionBaseCase.prototype.printLatex=function(){return this.originalNode.printLatex()};C.SeededFunctionCall.prototype.printLatex=function(){return qr(this._symbol)+"\\\\left("+this.args.slice(1).map(Ls).join(", ")+"\\\\right)"};C.DotAccess.prototype.printLatex=function(){return"("+this.args[0].printLatex()+").("+this.args[1].printLatex()+")"};C.Prime.prototype.printLatex=function(){switch(this.args[0]._symbol){case"logbase":return"\\\\log_{"+this.args[0].args[1].printLatex()+"}"+Array(this.order+1).join("\'")+"\\\\left("+this.args[0].args[0].printLatex()+"\\\\right)";default:return qr(this.args[0]._symbol)+Array(this.order+1).join("\'")+"\\\\left("+this.args[0].args.map(Ls).join(", ")+"\\\\right)"}};C.List.prototype.printLatex=function(){return"\\\\left["+this.args.map(Ls).join(", ")+"\\\\right]"};C.Range.prototype.printLatex=function(){return"\\\\left["+this.args[0].args.map(Ls).join(", ")+" ... "+this.args[1].args.map(Ls).join(", ")+"\\\\right]"};C.UpdateRule.prototype.printLatex=function(){return this.args[0].printLatex()+"\\\\to("+this.args[1].printLatex()+")"};C.ListAccess.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)\\\\left["+this.args[1].printLatex()+"\\\\right]"};C.ParenSeq.prototype.printLatex=function(){return"\\\\left("+this.args.map(Ls).join(", ")+"\\\\right)"};C.BareSeq.prototype.printLatex=function(){return this.args.map(Ls).join(", ")};C.NamedCoordinateAccess.prototype.printLatex=function(){return"\\\\left(\\\\left("+this.args[0].printLatex()+"\\\\right)."+this.symbol+"\\\\right)"};C.Norm.prototype.printLatex=function(){return"\\\\left|"+this.args[0].printLatex()+"\\\\right|"};C.Sum.prototype.printLatex=function(){return"\\\\sum_{"+this.args[0].printLatex()+"="+this.args[1].printLatex()+"}^{"+this.args[2].printLatex()+"}\\\\left("+this.args[3].printLatex()+"\\\\right)"};C.Product.prototype.printLatex=function(){return"\\\\prod_{"+this.args[0].printLatex()+"="+this.args[1].printLatex()+"}^{"+this.args[2].printLatex()+"}\\\\left("+this.args[3].printLatex()+"\\\\right)"};C.Integral.prototype.printLatex=function(){return"\\\\int_{"+this.args[1].printLatex()+"}^{"+this.args[2].printLatex()+"}\\\\left("+this.args[3].printLatex()+"\\\\right)d"+this.args[0].printLatex()};C.FunctionExponent.prototype.printLatex=function(){return this.args[0].printLatex()+"\\\\left("+this.args[1].printLatex()+"\\\\right)^{"+this.args[2].printLatex()+"}"};C.FunctionFactorial.prototype.printLatex=function(){return this.args[0].printLatex()+"\\\\left("+this.args[1].printLatex()+"\\\\right)!"};function w1(e){return e.isConstant&&e.asValue()===!0}function C$(e){return e.isConstant&&e.isNaN()}C.Piecewise.prototype.printLatex=function(){let e=this;if(w1(e.args[0]))return e.args[1].printLatex();let t=["\\\\left\\\\{"];for(;;){if(w1(e.args[0])){t.push(e.args[1].printLatex());break}if(t.push(e.args[0].printLatex(),": "),C$(e.args[2])){t.push(e.args[1].printLatex());break}if(t.push(e.args[1].printLatex(),", "),!(e.args[2]instanceof C.Piecewise)){t.push(e.args[2].printLatex());break}e=e.args[2]}return t.push("\\\\right\\\\}"),t.join("")};C.Restriction.prototype.printLatex=function(){return w1(this.args[0])?"\\\\left\\\\{\\\\right\\\\}":"\\\\left\\\\{"+this.args[0].printLatex()+"\\\\right\\\\}"};C.FunctionDefinition.prototype.printLatex=function(){return qr(this._symbol)+"\\\\left("+this._argSymbols.map(qr).join(", ")+"\\\\right) = "+this._expression.printLatex()};C.Derivative.prototype.printLatex=function(){return"\\\\frac{d}{d"+qr(this._symbol)+"}\\\\left("+this.args[0].printLatex()+"\\\\right)"};C.Regression.prototype.printLatex=function(){return"\\\\left("+this._lhs.printLatex()+"\\\\right)\\\\sim\\\\left("+this._rhs.printLatex()+"\\\\right)"};C.Histogram.prototype.printLatex=function(){return"\\\\histogram\\\\left("+this.args.map(Ls).join(", ")+"\\\\right)"};C.DotPlot.prototype.printLatex=function(){return"\\\\dotplot\\\\left("+this.args.map(Ls).join(", ")+"\\\\right)"};C.BoxPlot.prototype.printLatex=function(){return"\\\\boxplot\\\\left("+this.args.map(Ls).join(", ")+"\\\\right)"};C.TTest.prototype.printLatex=function(){return"\\\\TTest\\\\left("+this.args.map(Ls).join(", ")+"\\\\right)"};C.IndependentTTest.prototype.printLatex=function(){return"\\\\IndependentTTest\\\\left("+this.args.map(Ls).join(", ")+"\\\\right)"};C.Stats.prototype.printLatex=function(){return"\\\\Stats\\\\left("+this.args.map(Ls).join(", ")+"\\\\right)"};C.AssignmentExpression.prototype.printLatex=function(){return qr(this._symbol)+"="+this.args[1].printLatex()};C.ListComprehension.prototype.printLatex=function(){return"\\\\left["+this._body.printLatex()+"\\\\operatorname{for}"+this._inputLists.map(Ls).join(", ")+"\\\\right]"};C.Substitution.prototype.printLatex=function(){return"\\\\left(\\\\left("+this._body.printLatex()+"\\\\right)\\\\operatorname{with}"+this._assignments.map(Ls).join(", ")+"\\\\right)"};C.Construction.prototype.printLatex=function(){return"\\\\construction "};C.ImaginaryUnit.prototype.printLatex=function(){return br};C.MovableComplexNumber.prototype.printLatex=function(){return Ic(this.asValue())};C.Base.prototype.getExpressionType=function(e,t){switch(e){case 114:return t&&j(t)?"POINT3D_LIST":"POINT3D";case 100:case 128:return"CURVE3D_xyz_t";case 119:return"SEGMENT3D";case 129:return"VECTOR3D";case 130:case 103:return"SURFACE_xyz_uv";case 110:return"SURFACE_r_\\u03B8z";case 124:return"SURFACE_r_\\u03B8z_AMBIGUOUS";case 109:return"SURFACE_z_r\\u03B8";case 111:return"SURFACE_r_\\u03B8\\u03C6";case 107:case 108:case 106:return"SURFACE";case 118:return"SPHERE3D";case 117:return"TRIANGLE3D";case 120:case 121:return"SURFACE_AMBIGUOUS";case 122:case 123:return"SURFACE_CONSTANT_AMBIGUOUS";case 112:case 113:case 210:return"IMPLICIT_SURFACE";case 126:case 127:return"IMPLICIT_SURFACE_AMBIGUOUS";case 3:case 4:case 25:case 26:return t&&j(t)?"POINT_LIST":"SINGLE_POINT";case 1:case 2:return"X_OR_Y";case 5:return"PARAMETRIC";case 6:return"POLAR";case 8:return"IMPLICIT";case 24:case 17:return"VECTOR2D";case 200:case 201:case 202:case 205:case 209:return"SLICE";case 211:case 206:return"SLICE_r\\u03B8z_at_z";case 203:return"SLICE_zr\\u03B8_at_r";case 204:return"SLICE_zr\\u03B8_at_\\u03B8";case 213:return"SLICE_zr\\u03B8_at_xyz";case 207:return"SLICE_r\\u03B8\\u03C6_at_\\u03B8";case 208:return"SLICE_r\\u03B8\\u03C6_at_\\u03C6";case 212:return"SLICE_r\\u03B8\\u03C6_at_xyz";case 214:case 215:return"SLICE_xyz_uv";default:return t!==void 0&&se(t,xe)?"POLYGON":"X_OR_Y"}};C.Histogram.prototype.getExpressionType=function(e,t){return"HISTOGRAM"};C.DotPlot.prototype.getExpressionType=function(e,t){return"DOTPLOT"};C.BoxPlot.prototype.getExpressionType=function(e,t){return"BOXPLOT"};var jb=class extends Q{};var Jb=class extends Q{constructor(t){super(t),this._symbol="sphere"}};function D$(e){return function(n){return new e(n)}}var S$=[Ep,Mp,Ru,Cp,Dp,Sp,Ms,jb,_u,vp,Lu,wu,Fu,Op,Np,Rp,lo,Go,Fp,Vp,Bp,Gp,ao,kp,Fr,zp,$p,Hp,Up,Jb,qp,Es,Xp,Zp];for(let e of S$)e.prototype.copyWithArgs=D$(e);uo.prototype.copyWithArgs=function(e){return new ps[this.operator](e)};Au.prototype.copyWithArgs=function(e){return new Au(this.symbols,e)};Et.prototype.copyWithArgs=function(e){return new Et(this._constantValue)};rl.prototype.copyWithArgs=function(e){return new rl(this.constructedObjectIds)};sl.prototype.copyWithArgs=function(e){return new sl(this._symbol,e)};il.prototype.copyWithArgs=function(e){return new il(this.tag,e)};gn.prototype.copyWithArgs=function(e){return new gn(new we(this._symbol),e)};we.prototype.copyWithArgs=function(e){return new we(this._symbol)};ko.prototype.copyWithArgs=function(e){return new ko};Ja.prototype.copyWithArgs=function(e){return new Ja(e[0],e[1],e.slice(2),this.shouldCoerceToList,this.parameters)};Ho.prototype.copyWithArgs=function(e){return new Ho(this.symbol,e)};ul.prototype.copyWithArgs=function(e){return new ul(this.order,e)};cl.prototype.copyWithArgs=function(e){return new cl(this.value)};xa.prototype.copyWithArgs=function(e){return new xa(e[0],e.slice(1))};ll.prototype.copyWithArgs=function(e){return new ll(this._stringValue)};pl.prototype.copyWithArgs=function(e){return new pl(e,this.moveStrategy,this.defaultDragMode)};function Ww(e,t,n){try{return N$(e,t,n)}catch(r){if(!(r instanceof v))throw r;let s=[];for(let i of We(n))s.push({id:i,stmtAnalysis:new q(e,t,n[i],r)});return s}}function N$(e,t,n){let r={};for(let c of We(n))r[n[c]._symbol]=n[c];let s=new V1(r),i={},o={definitions:i,baseCases:s.getBaseCases()};for(let c of We(n)){let l=n[c];R$(s,l,o)}for(let c of s.getBaseCaseExports()){let l=c.analyze(e,t,{});for(let p of c.getLegalExports(e))delete t[p];l.rawTree.exportTo(e,l.concreteTree,t)}let a=Tn(t);for(let c of We(i))a[c]=i[c];let u=[];for(let c of We(n)){let l=n[c],p=l._symbol,f=i[p];f.userData=l.userData,f.metaData=l.metaData,f instanceof v?u.push({id:c,stmtAnalysis:new q(e,t,l,f)}):u.push({id:c,stmtAnalysis:f.analyze(e,a,{})})}return u}var V1=class{constructor(t){this.baseCases={};this.baseCaseExports=[];this.analyzedFunctions={};this.recursiveFunctionGroup=t;for(let n in t)this.baseCases[n]=[];for(let n in this.recursiveFunctionGroup)this.analyzeRecursiveFunctionDefinition(this.recursiveFunctionGroup[n])}analyzeRecursiveFunctionDefinition(t){let n;for(let r of t.getExternalBaseCases())this.addBaseCase(r);if(t._expression instanceof Fr){n=t._expression;do{let r=n.args[0],s=n.args[1];if(this.recursiveParameterIndex!==void 0&&r instanceof ps["="]){let i=t._argSymbols[this.recursiveParameterIndex],o=r.args.findIndex(p=>p instanceof we&&p._symbol===i);if(o===-1)break;let a=r.args[1-o];if(!(a instanceof Et))break;let u=a.asValue(),c=t._argSymbols.filter((p,f)=>f!==this.recursiveParameterIndex).map(p=>new we(p)),l=new Qr(t._symbol,c,{valid:!0,argIndex:this.recursiveParameterIndex,argValue:u,functionDefArgSymbols:t._argSymbols,argSymbol:t._argSymbols[this.recursiveParameterIndex]},s,s);this.baseCaseExports.push(l),this.addBaseCase(l)}else break;n=n.args[2]}while(n instanceof Fr)}else if(t._expression instanceof xa){let r=[];for(let s of t._expression._assignments){let i=Qr.fromCallAssignment(this.recursiveFunctionGroup,s);if((i==null?void 0:i.specifiedArg.valid)===!1)throw i.specifiedArg.error;i&&t._symbol===i._symbol?(this.baseCaseExports.push(i),this.addBaseCase(i)):r.push(s)}r.length>0?n=new xa(t._expression._body,r):n=t._expression._body}else n=t._expression;this.analyzedFunctions[t._symbol]={recursiveExpression:n}}addBaseCase(t){this.baseCases[t._symbol].push(t)}getBaseCases(){return this.baseCases}getBaseCaseExports(){return this.baseCaseExports}getFunctionAnalysis(t){return this.analyzedFunctions[t]}};function R$(e,t,n){let r=e.getFunctionAnalysis(t._symbol);if(!r){n.definitions[t._symbol]=t;return}let s=new Cr(new we(t._symbol),t._argSymbols.map(i=>new we(i)),r.recursiveExpression,n);s.setExternalBaseCases(t.getExternalBaseCases()),n.definitions[t._symbol]=s}function Jw(e,t){let n={};for(let r of We(t)){let s=t[r],i=s.metaData;if(Am(n,r,s.getDependencies()),Am(n,r,s.getLegalExports(e)),ui(s)&&s.userData&&s.userData.residualVariable&&Am(n,r,[no(s.userData.residualVariable)]),jw(n,r,i),Hi(s)&&s.columns)for(let o=0;o<s.columns.length;o++){let a=s.columns[o];if(ha(a))throw U("Unexpected concrete column.");!Kr(a)&&a.header&&a.header.metaData&&jw(n,r,a.header.metaData)}}return n}function Am(e,t,n){for(let r of n)e[r]||(e[r]=[]),e[r].push(t)}function jw(e,t,n){if(n.extraDepNodes)for(let r of n.extraDepNodes)r&&Am(e,t,r.getDependencies());n.clickHandler&&Am(e,t,n.clickHandler.getDependencies())}function Ed(e,t,n,r,s){let i={},o={},a=[],u=[];for(let c of We(r))r[c]&&(o[c]=!0,a.push(c));for(let c of We(s))s[c]&&(i[c]=!0,u.push(c));for(;a.length||u.length;){for(;a.length;){let c=a.pop(),l=t[c];if(l)for(let p of l.getLegalExports(e))i[p]||(i[p]=!0,u.push(p))}for(;u.length;){let c=u.pop(),l=n[c];if(l)for(let p of l)o[p]||(o[p]=!0,a.push(p))}}return{ids:o,symbols:i}}function Qw(e){return e.globalRandomSeed||[]}var A$=100;function Qb(e){let t=[];for(let n=0;n<e;n++)t[n]={x:[],y:[],intersects:[]};return t}function _$(e,t,n,r){return n===1&&r===1||n===2&&r===2?function(s){return t(s)-e(s)}:n===1&&r===2||n===2&&r===1?function(s){return s-t(e(s))}:!1}function Kw(e,t){t instanceof C.SolvedEquation?t=t._expression:t instanceof C.OptimizedRegression&&(t=t.model);let n=[],r=[];return t instanceof C.DoubleInequality?C.List.eachArgs(t._expressions,s=>{n.push(s[0].getCompiledFunction()),r.push(s[0].isConstant&&s[1].isNaN()),n.push(s[1].getCompiledFunction()),r.push(s[1].isConstant&&s[1].isNaN())}):C.List.wrap(t).eachElement(s=>{n.push(s.getCompiledFunction()),r.push(s.isConstant&&s.isNaN())}),{functions:n,skipIntersecting:r}}function L$(e,t){let n=[];for(let r in e){if(!e.hasOwnProperty(r)||String(r)===String(t)||!e[r].shouldIntersect())continue;let s=e[r],i=Kw(s.policy,s.concreteTree);n.push({id:r,graphMode:s.getGraphMode(),functions:i.functions,skipIntersecting:i.skipIntersecting})}return n}function w$(e,t){e.intersects=Array(e.x.length);for(let n=0;n<e.x.length;n++)e.intersects[n]=t}function F$(e,t){if(t===1){let n=e.y;e.y=e.x,e.x=n}}function V$(e,t){Array.prototype.push.apply(e.x,t.x),Array.prototype.push.apply(e.y,t.y),e.intersects&&t.intersects&&Array.prototype.push.apply(e.intersects,t.intersects)}function B$(e,t,n){let r=h1(e,t),s=r.poi.zeros,i=r.poi.extrema,o=[],a=0,u=0;for(a=0;a<s.x.length;a++){for(;u<i.x.length&&i.x[u]<s.x[a];u++)si(i.y[u],0)&&o.push(i.x[u]);o.push(s.x[a])}for(;u<i.x.length;u++)si(i.y[u],0)&&o.push(i.x[u]);return{x:o,y:o.map(n)}}function eF(e,t,n){let r=e[n],s=r.getGraphInfo(),i=r.getGraphMode(),o,a,u;try{o=Kw(r.policy,r.concreteTree),a=Qb(o.functions.length),u=L$(e,n)}catch(l){return Qb(0)}if(!u)return a;let c=0;for(let l=0;l<u.length;l++){let p=u[l];for(let f=0;f<o.functions.length;f++){if(o.skipIntersecting[f])continue;let d=o.functions[f].fn,y=Td(t,s,d);for(let g=0;g<p.functions.length;g++){if(u[l].skipIntersecting[g])continue;let m=p.functions[g].fn,h=_$(d,m,i,p.graphMode);if(!h)continue;let x;try{x=B$(h,y,d)}catch(T){return Qb(0)}if(c+=x.x.length,c>A$)return Qb(o.functions.length);w$(x,p.id),F$(x,i),V$(a[f],x)}}}return a}var Rl=class{constructor(t){this.localFrames=new Map;this.global=Tn(t)}hasLocalFrame(t){return this.localFrames.has(t)}getLocalFrame(t){let n=this.localFrames.get(t);if(n)return n;{let r=Tn(this.global);return this.localFrames.set(t,r),r}}deleteLocalFrame(t){this.localFrames.delete(t)}};var Kb={};ia(Kb,{getFrame:()=>G$});function G$(e){let t={};return e.additionalFunctions&&e.additionalFunctions.indexOf("sqrt")!==-1&&(t.sqrt=tt.sqrt),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var _m={};ia(_m,{getFrame:()=>q$});var tF={segment:!0,line:!0,ray:!0,circle:!0,arc:!0,vector:!0,glider:!0,parallel:!0,perpendicular:!0,center:!0,radius:!0,area:!0,perimeter:!0,start:!0,end:!0,angles:!0,angle:!0,directedangles:!0,directedangle:!0,coterminal:!0,supplement:!0,vertices:!0,segments:!0,intersection:!0,strictintersection:!0,translate:!0,dilate:!0,rotate:!0,reflect:!0,construction:!0,points:!0,lines:!0,circles:!0,arcs:!0,polygons:!0,rays:!0,anglebisector:!0};var nF={segment:!0,triangle:!0,vector:!0,start:!0,end:!0,sphere:!0};var rF=["csc","sec","cot","arccsc","arcsec","arccot","csch","sech","coth","arccsch","arcsech","arccoth","mad","cov","covp","distance","midpoint"],sF=["histogram","dotplot","boxplot"],k$=[...sF,"polygon"],iF=["erf","ttest","tscore","ittest","normaldist","tdist","poissondist","binomialdist","pdf","cdf","random",...sF],H$=["distance","midpoint"],z$=["det","inv","transpose","rref","trace"],oF=Object.keys(tF).filter(e=>e!=="construction"),aF=Object.keys(_d),U$=["complexMultiplyPoints","rawTransform","rawTransformConj","transformWithoutTranslation","transformScaleFactor","scaleTangentTransformation","addTangentVector","addTangentTransformation","complex","complexDivide","coerceComplexToReal","coerceRealToComplex"];function ex(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(!t.hasOwnProperty(r))throw new Error("Programming Error: key \'"+r+`\' does not exist in table. Must be one of:\n`+Object.keys(t).join(`\n`))}}ex(rF,tt);ex(iF,tt);ex(oF,tt);ex(aF,tt);function q$(e){let t={},n;for(n of We(tt)){if(U$.includes(n)||e.restrictedFunctions===!0&&rF.indexOf(n)!==-1&&!(e.forceEnableGeometryFunctions===!0&&H$.indexOf(n)!==-1)||e.distributions===!1&&iF.indexOf(n)!==-1)continue;let r=oF.indexOf(n)!==-1,s=n in nF;if(r&&s){if(!(e.isGeometryCalculator||e.is3DCalculator))continue}else if(r){if(!e.isGeometryCalculator)continue}else if(s){if(!e.is3DCalculator)continue}else if(k$.indexOf(n)!==-1&&e.is3DCalculator)continue;aF.indexOf(n)!==-1&&!e.isComplexEnabled||z$.indexOf(n)===-1&&(t[n]=tt[n])}return e.trigAngleMultiplier&&(t.trigAngleMultiplier=e.trigAngleMultiplier),e.globalRandomSeed&&(t.globalRandomSeed=e.globalRandomSeed),e.initialEvaluation&&(t.initialEvaluation=e.initialEvaluation),e.globalEventCount&&(t.globalEventCount=e.globalEventCount),e.width&&(t.width=e.width),e.height&&(t.height=e.height),e.isComplexEnabled&&(t[br]=new ko),t}var B1={};ia(B1,{getFrame:()=>X$});var uF=["pi","e","trigAngleMultiplier"],cF=["sqrt","nthroot","abs","ln","sin","cos","tan","log","arcsin","arccos","arctan","mean","round","stdev","stdevp","nCr","nPr","exp","factorial"],$$=["complexMultiplyPoints","complex","complexDivide","coerceComplexToReal","coerceRealToComplex","complexSqrt"],Y$=Object.keys(_d);function lF(e,t){for(let n of e)if(!t.hasOwnProperty(n))throw new Error("Programming Error: key \'"+n+`\' does not exist in table. Must be one of:\n`+Object.keys(t).join(`\n`))}lF(uF,tt);lF(cF,tt);function X$(e){let t={};return uF.forEach(n=>{t[n]=tt[n]}),cF.forEach(n=>{e.replaceRoundWithReciprocal&&n==="round"||(t[n]=tt[n])}),e.trigAngleMultiplier&&(t.trigAngleMultiplier=e.trigAngleMultiplier),e.isComplexEnabled&&(Y$.forEach(n=>t[n]=tt[n]),$$.forEach(n=>t[n]=tt[n]),t[br]=new ko),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var G1={};ia(G1,{getFrame:()=>Z$});var pF=["pi","e","trigAngleMultiplier"],dF=["sqrt","nthroot","abs","ln","sin","cos","tan","log","arcsin","arccos","arctan","exp","factorial"];function fF(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(!t.hasOwnProperty(r))throw new Error("Programming Error: key \'"+r+`\' does not exist in table. Must be one of:\n`+Object.keys(t).join(`\n`))}}fF(pF,tt);fF(dF,tt);function Z$(e){let t={};return pF.forEach(n=>{t[n]=tt[n]}),dF.forEach(n=>{t[n]=tt[n]}),e.trigAngleMultiplier&&(t.trigAngleMultiplier=e.trigAngleMultiplier),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}function mF(){let e={},t={},n={},r=[],s={};for(let i in this.statements){let o=this.statements[i];if(o instanceof co){let a=o.localFrameID;if(!a)throw new Error(`Programming error: missing localFrameID on table column ${i}`);s[a]||(s[a]=[]),s[a].push(o)}}for(let i in this.statements){if(!this.statements.hasOwnProperty(i))continue;let o=this.statements[i];if(!(o.type==="Construction"&&!this.policy.isGeometryEnabled())&&o.type!=="Ticker")switch(o.type){case"Error":break;case"Regression":{n[i]=[],r.push(i);break}case"TableColumn":continue;default:{let a=o.getLegalExports(this.policy);if(o.type==="Table"){let u=s[i]||[];for(let c of u)for(let l of c.getLegalExports(this.policy))!l.startsWith("idref_")&&!a.includes(l)&&a.push(l)}if(a){for(let c of a)o.localFrameID!==void 0?t[c]=i:e[c]=i;let u=[];for(let c of o.getDependencies())u.push(c);n[i]=cx(u,o.getOptionalDependencies(),a)}break}}}for(let i of r){let o=this.statements[i],a=no(o.userData.residualVariable);a&&(t[a]=i);let u=o.getDependencies().slice(),c={},l;for(;l=u.pop();){if(c[l])continue;c[l]=!0;let p=e[l]||t[l];if(p){u.push(...n[p]),n[i].push(l);continue}t[l]=i}}return{exportMap:e,weakExportMap:t,dependencyMap:n}}function yF(e){if(e.length<2)return"text";let t=e.split("`").length-1;return t<2?"text":t===2&&e[0]==="`"&&e[e.length-1]==="`"?"latex":"mixed"}function gF(e){if(e.length===0)return[""];let t=[],n=e.split(/(`)/),r=!1,s="";for(let i=0;i<n.length;i++){let o=n[i];o.length&&(o==="`"?(s+="`",r=!r,r||(t.push(s),s="")):(s+=o,r||(t.push(s),s="")))}return s.length&&t.push(s),t}function k1(e){return gF(e).map(W$)}function W$(e){let n="\\\\$({"+["[a-zA-Z][0-9]*","[a-zA-Z]_[a-zA-Z0-9]+","[a-zA-Z]_\\\\{[a-zA-Z0-9]+\\\\}","\\\\\\\\[a-zA-Z]+","\\\\\\\\[a-zA-Z]+_{[a-zA-Z0-9]+}","\\\\\\\\[a-zA-Z]+_[a-zA-Z0-9]+"].join("})|\\\\$({")+"})",r=new RegExp(n,"g"),s=[],i=0,o=0,a;for(;a=r.exec(e);){o=a.index,o>i&&s.push(e.substr(i,o-i));let u=a[0],c=u.replace(/[{}\\$]/g,"").replace(/^([a-zA-Z])([0-9]+)$/,"$1_$2");s.push({symbol:c,str:u}),i=a.index+u.length}return i<e.length&&s.push(e.substr(i)),{raw:e,parts:s}}var hF={bigCutoff:1e7,digits:8};function bF(e,t){let n=t?kl(e,hF):Gl(e,hF);return t?`{${n}}`:n}function xF(e,t){let n={...yx,digits:8,scientificNotationDigits:3},r=t?Ic(e,n):gx(e,n);return t?`{${r}}`:r}function H1(e,t,n,r){return e.map(s=>j$(s,t,n,r)).join("")}function j$(e,t,n,r){var o,a;let s=[],i=yF(e.raw)==="latex";for(let u of e.parts)if(typeof u=="string")s.push(u);else{let c=new C.Identifier(u.symbol).tryGetConcreteTree(t,n,{coerceToNumber:"all-except-complex"});if(c.valueType===I&&c.getDependencies().length===0){let l=c.asValue();if(typeof l=="number"){s.push(bF(l,i));continue}}else if(c.valueType===ne&&r<c.length&&c.getDependencies().length===0){let l=(o=c.elementAt)==null?void 0:o.call(c,r).asValue();if(typeof l=="number"){s.push(bF(l,i));continue}}else if(c.valueType===R&&c.getDependencies().length===0){let l=c.asTypedValue();if((l==null?void 0:l.valueType)===R){s.push(xF(l.value,i));continue}}else if(c.valueType===Ue&&r<c.length&&c.getDependencies().length===0){let l=(a=c.elementAt)==null?void 0:a.call(c,r).asTypedValue();if((l==null?void 0:l.valueType)===R){s.push(xF(l.value,i));continue}}i?s.push("{?}"):s.push("?")}return s.join("")}var Lm=class{constructor(t){this.singleExpression=t.singleExpression,this.complexEnabled=!!t.isComplexEnabled}isGeometryEnabled(){return!1}is3dProduct(){return!1}is3dPolicy(){return!1}isComplexEnabled(){return this.complexEnabled}isRecursionEnabled(){return!1}polygonUnsupportedPreferTriangle(){return!1}areAllScalesLinear(){return!0}assignmentForbidden(t){return this.singleExpression?t.slice(0,3)!=="ans":t.slice(0,3)==="tmp"}isValidSlider(t){return!1}sliderVariables(){return[]}graphingEnabled(){return!1}ansEnabled(){return!this.singleExpression}dimensionVarsEnabled(){return!1}disabledFeatures(){return this.singleExpression?["Sum","Product","Integral","Derivative","Piecewise","Substitution","PercentOf"]:["Sum","Product","Integral","Derivative","Piecewise","Substitution"]}shouldIncludeFunctionParametersInRandomSeed(){return!0}};function Q$(e){let t=kl(e,{bigCutoff:1e9,smallCutoff:1e-6,digits:12});return t.indexOf("\\\\times")===-1?t:t[0]==="-"?"-\\\\left("+t.substring(1)+"\\\\right)":"\\\\left("+t+"\\\\right)"}function K$(e){switch(e){case"exponential":case"power":case"logarithmic":return!0;case"cubic":case"linear":case"logistic":case"sinusoidal":case"quadratic":case"quartic":return!1}}function e5(e,t){let n=t.parameterValues||{},[r,s]=t.variables,i=a=>{if(n==="canonical")return a;let u=n5(a),c=n&&n[u];return c!==void 0?Q$(c):u},o;switch(e){case"linear":{let[a,u]=[i("m"),i("b")];o=`${[`${a}${r}`,`${u}`].join("+")}`;break}case"quadratic":{let[a,u,c]=[i("a"),i("b"),i("c")];o=`${[`${a}${r}^2`,`${u}${r}`,`${c}`].join("+")}`;break}case"cubic":{let[a,u,c,l]=[i("a"),i("b"),i("c"),i("d")];o=`${[`${a}${r}^3`,`${u}${r}^2`,`${c}${r}`,`${l}`].join("+")}`;break}case"quartic":{let[a,u,c,l,p]=[i("a"),i("b"),i("c"),i("d"),i("f")];o=`${[`${a}${r}^4`,`${u}${r}^3`,`${c}${r}^2`,`${l}${r}`,`${p}`].join("+")}`;break}case"exponential":{let[a,u]=[i("a"),i("b")];o=`${a}\\\\cdot ${u}^{${r}}`;break}case"logarithmic":{let[a,u]=[i("a"),i("b")];o=`${a}+${u}\\\\cdot \\\\ln\\\\left(${r}\\\\right)`;break}case"logistic":{let[a,u,c]=[i("a"),i("b"),i("c")];o=`\\\\frac{${a}}{1+e^{-\\\\left(${u}${r}+${c}\\\\right)}}`;break}case"power":{let[a,u]=[i("a"),i("b")];o=`${a}\\\\cdot ${r}^{${u}}`;break}case"sinusoidal":{let[a,u,c,l]=[i("a"),i("b"),i("c"),i("d")];o=`${a}\\\\cdot \\\\sin\\\\left(${u}${r}+${c}\\\\right)+${l}`;break}default:throw new Error(`Unknown regression type: ${e}`)}return`${s}${t.operator}${t5(o)}`}function t5(e){return e.replace(/\\+-/g,"-").replace(/--/g,"")}function n5(e){return`\\\\regressionparameter_{${e}}`}var TF=/\\\\regressionparameter_{([^}]+)}/g;function jle(e){var n;return((n=e.match(TF))!=null?n:[]).map(r=>r.replace(TF,(s,i)=>i))}function IF(e,t,n,r){let s=e.regression;if(!s)return;K$(s.type)||(s.isLogMode=!1);let i=e.columns,{columnIds:o}=s,a=r.get(o.x),u=r.get(o.y);if(!(a&&u))return U("Missing columns for table regression");let c=[{id:a.userData.id,isIdentifier:ki(a.header),latex:i[a.columnIndex].latex},{id:u.userData.id,isIdentifier:ki(u.header),latex:i[u.columnIndex].latex}],l=[c[0].isIdentifier?c[0].latex:`\\\\idref_{${c[0].id}}`,c[1].isIdentifier?c[1].latex:`\\\\idref_{${c[1].id}}`],p=e5(s.type,{operator:"~",variables:l}),f=Mi(p,n);if(Kr(f))return f;if(!ui(f))return U(`Expected table regression to parse as Regression, but got ${f.type}`);let d=f;return d.tableRegressionData={tableId:t,columnInfo:c!=null?c:[],variables:l},d.metaData={extraDepNodes:[]},d.userData={id:s.id,color:s.color,lineStyle:s.lineStyle,isLogModeRegression:s.isLogMode,shouldGraph:!s.hidden,residualVariable:s.residualVariable},d}var yc=typeof performance!="undefined"?()=>performance.now():()=>Date.now(),{Constant:So,Seed:EF,FunctionCall:a5,Image:u5,Slider:c5,Construction:l5}=C;function p5({evaluationMode:e,is3dProduct:t,isBeta3d:n,isComplexEnabled:r,scales:s,includeFunctionParametersInRandomSeed:i,customRegressions:o,isRecursionEnabled:a}){switch(e){case"fourFunction":return new Cc({singleExpression:!1});case"singleExpressionFourFunction":return new Cc({singleExpression:!0});case"scientific":return new Lm({singleExpression:!1,isComplexEnabled:r});case"singleExpressionScientific":return new Lm({singleExpression:!0,isComplexEnabled:r});case"graphing":return new Id({enableGeometry:!1,enable3d:t,scales:s,isComplexEnabled:r,includeFunctionParametersInRandomSeed:i,customRegressions:o,isRecursionEnabled:a});case"geometry":return new Id({enableGeometry:!0,enable3d:!1,scales:s,includeFunctionParametersInRandomSeed:i,isComplexEnabled:r,customRegressions:o,isRecursionEnabled:a});case"graphing_3d":return new $b({beta3d:n,includeFunctionParametersInRandomSeed:i,isComplexEnabled:r,customRegressions:o,isRecursionEnabled:a})}}var d5={fourFunction:Kb,singleExpressionFourFunction:Kb,scientific:B1,singleExpressionScientific:G1,graphing:_m,graphing_3d:_m,geometry:_m},sa="**geo_construction_statement_id**";function ri(e,t){let n=Mi(e,t);return n.isError||n instanceof C.Expression?n:Fd()}function f5(e){let t=e.rawTree.userData,n=e.rawTree.metaData;return!!(t.cdf&&t.cdf.show&&n.distributionSpec)}function m5(e){let t=e.evaluationState.expression_type,n=e.rawTree.userData;return!n.clickableInfo||!n.clickableInfo.enabled?!1:_f(e.rawTree)?!0:uu(e.getGraphMode())?!1:tC(t)}function yn(e,t){let n="id"+e;for(let[r,s]of t||[])n+="::"+r+s;return n}var y5=new So(Se(0,1)),g5=new So(Se(1,1)),h5=new So(NaN);function yi(e,t){return e?e==="0"?y5:e==="1"?g5:ri(e,t):h5}function gc(e,t){if(e)return ri(e,t)}function b5(e){return e.slice(0,3)!=="ans"}function x5(e){return e.slice(0,6)!=="idref_"}function MF(e,t,n){let{multiplyDefined:r,cycles:s,recursiveFunctionSymbols:i}=e;for(let o of s){let a=[...new Set(o.map(({symbol:u})=>u))].filter(b5).filter(x5).sort();for(let{symbol:u,localFrameID:c}of o){if(n&&i.has(u))continue;let l=MI(a);if(c!==void 0){let p=t.getLocalFrame(c);p[u]=l,e.definitionLevel[u]===1&&(t.global[u]=l)}else t.global[u]=l}}for(let o of We(r))r.hasOwnProperty(o)&&(t.global[o]=Wl(o));for(let[o,a]of e.localDependencyOrder){let u=t.getLocalFrame(o);for(let c of We(a.multiplyDefined))u[c]=Wl(c)}}function hc(e,t){return t.localFrameID!==void 0?e.getLocalFrame(t.localFrameID):e.global}function T5(e,t,n){let r=e.evaluationState,s=e.rawTree,i=s.metaData.cdfMin,o=s.metaData.cdfMax,a={},u=s.type==="Assignment"?s._expression:s,c=u&&u.metaData&&u.metaData.distributionSpec,l=Fa(t,n,i,a,-1/0),p=Fa(t,n,o,a,1/0),f=!0,d=!0;if(isNaN(l)&&(f=!1,l=NaN),isNaN(p)&&(d=!1,p=NaN),f?d?l>p&&(f=!1,d=!1,r.error=VI().getError()):r.error=FI().getError():r.error=wI().getError(),f&&d){let m=new a5("cdf",[u,new So(l),new So(p)]);r.cdf_evaluation=+m.tryGetConcreteTree(t,n).asValue()}let y=-1/0,g=1/0;if(c&&(c.discrete&&(y=0),c.symbol==="binomialdist"&&u.args&&u.args[0])){let m=+u.args[0].asValue();isFinite(m)&&(g=m)}s.metaData.evaluatedCDFMin=l,s.metaData.evaluatedCDFMax=p,r.cdf_min_valid=f,r.cdf_max_valid=d,r.cdf_min_default=y,r.cdf_max_default=g,r.is_single_identifier=!1,mc(r,t,a)}var q1={coerceToNumber:"all"};function I5(e,t,n,r,s){let i={},o=!0,a=NaN,u,c=!1;if(n){let l=n.tryGetConcreteTree(e,t,q1);u=l.getDependencies().length===0?l.asValue():NaN,c=Array.isArray(u),a=c?u:+u;for(let p of l.getDependencies())i[p]=!0}if(c){for(let l of a)if(!isFinite(+l)){o=!1,a=NaN;break}}else isFinite(+a)?s!==void 0&&a>s&&(a=s):(o=!1,a=NaN);return n||(o=!0,r!==void 0&&(a=r)),{value:a,valid:o,missingVarsMap:i}}var wm={lineWidth:{parseNode:"lineWidth",valueOutputProp:"computedLineWidth",formulaOutputProp:"",validOutputProp:"line_width_valid",default:(e,t,n,r)=>n.is3dPolicy()?1:2.5,transform:void 0,shouldEvaluate:void 0,seed:"lw"},resolution:{parseNode:"resolution",valueOutputProp:"computedResolution",formulaOutputProp:"",validOutputProp:"resolution_valid",default:()=>{},transform:void 0,shouldEvaluate:void 0,seed:"re"},lineOpacity:{parseNode:"lineOpacity",valueOutputProp:"computedLineOpacity",formulaOutputProp:"",validOutputProp:"line_opacity_valid",default:()=>1,transform:void 0,shouldEvaluate:void 0,seed:"lo"},pointOpacity:{parseNode:"pointOpacity",valueOutputProp:"computedPointOpacity",formulaOutputProp:"",validOutputProp:"point_opacity_valid",default:()=>1,transform:void 0,shouldEvaluate:void 0,seed:"po"},pointSize:{parseNode:"pointSize",valueOutputProp:"computedPointSize",formulaOutputProp:"",validOutputProp:"point_size_valid",default:(e,t,n)=>n.is3dProduct()?3:8,shouldEvaluate:void 0,transform:void 0,seed:"ps"},movablePointSize:{parseNode:"movablePointSize",valueOutputProp:"computedMovablePointSize",formulaOutputProp:"",validOutputProp:"movable_point_size_valid",default:()=>8,shouldEvaluate:void 0,transform:void 0,seed:"ps"},fillOpacity:{parseNode:"fillOpacity",valueOutputProp:"computedFillOpacity",formulaOutputProp:"",validOutputProp:"fill_opacity_valid",default:()=>.4,transform:void 0,shouldEvaluate:e=>{if(!e)return!1;let{expression_type:t,is_inequality:n}=e.evaluationState;return!!(t==="POLYGON"||t==="PARAMETRIC"||n)},seed:"fo"},surfaceOpacity:{parseNode:"surfaceOpacity",valueOutputProp:"computedSurfaceOpacity",formulaOutputProp:"",validOutputProp:"surface_opacity_valid",default:()=>1,transform:void 0,shouldEvaluate:e=>{if(!e)return!1;let{expression_type:t}=e.evaluationState;return t==="CURVE3D_xyz_t"||t==="SURFACE"||t==="SPHERE3D"||t==="SURFACE_AMBIGUOUS"||t==="SURFACE_CONSTANT_AMBIGUOUS"||t==="IMPLICIT_SURFACE"||t==="IMPLICIT_SURFACE_AMBIGUOUS"||t==="SURFACE_xyz_uv"||t==="SURFACE_z_r\\u03B8"||t==="SURFACE_r_\\u03B8z"||t==="SURFACE_r_\\u03B8\\u03C6"||t==="SURFACE_r_\\u03B8z_AMBIGUOUS"||t==="TRIANGLE3D"},seed:"fo"},labelSize:{parseNode:"labelSize",valueOutputProp:"computedLabelSize",formulaOutputProp:"",validOutputProp:"label_size_valid",transform:void 0,default:()=>1,shouldEvaluate:void 0,seed:"ls"},labelAngle:{parseNode:"labelAngle",valueOutputProp:"computedLabelAngle",formulaOutputProp:"label_angle_value",validOutputProp:"label_angle_valid",default:()=>0,transform:e=>`-\\\\trigAngleMultiplier*(${e})`,shouldEvaluate:void 0,seed:"la"}};function CF(e,t,n,r,s,i,o){let a=wm[i],u;e&&(u=e.tryGetConcreteTree(r,s));let c=a.default&&a.default(e,u,r,o),l=["lineWidth","pointSize","movablePointSize"].indexOf(i)>=0,p=I5(r,s,n[a.parseNode],c,l?1e4:void 0);n[a.valueOutputProp]=p.value,a.formulaOutputProp&&(t[a.formulaOutputProp]=p.value),t[a.validOutputProp]=p.valid,mc(t,r,p.missingVarsMap)}function P5(e,t,n,r){let s,i,o;if(Hi(e.rawTree)&&e.evaluationState.column_data&&e.rawTree.columns)for(let a=0;a<e.evaluationState.column_data.length;a++){s=e.evaluationState.column_data[a];let u=e.rawTree.columns[a];if(!Kr(u)){if(ha(u))throw U("Unexpected concrete column.");i=u.header.metaData,o=i[r],CF(o,s,i,t,n,r,e.concreteTree.valueType)}}else s=e.evaluationState,i=e.rawTree.metaData,o=i[r],CF(o,s,i,t,n,r,e.concreteTree.valueType)}function DF(e){return kc(e[0],e[1],e[2]).formatHex()}function SF(e,t,n,r,s){let i;if(e){let o=e.tryGetConcreteTree(r,s),a=o.getDependencies().length>0?void 0:o.asValue(),{valueType:u}=o;if(i=!!(a&&(u===Kt||u===rr)),i){let c=o&&o.valueType===Kt?DF(a):a.map(DF);t.colorLatexValue=c,n.color_latex_value=c}else delete t.colorLatexValue,delete n.color_latex_value}else i=!0;n.color_latex_valid=i}function E5(e,t,n){let r,s,i;if(Hi(e.rawTree)&&e.evaluationState.column_data&&e.rawTree.columns)for(let o=0;o<e.evaluationState.column_data.length;o++){r=e.evaluationState.column_data[o];let a=e.rawTree.columns[o];if(!Kr(a)){if(ha(a))throw U("Unexpected concrete column.");s=a.header.metaData,i=s.colorLatex,SF(i,s,r,t,n)}}else r=e.evaluationState,s=e.rawTree.metaData,i=s.colorLatex,SF(i,s,r,t,n)}function M5(e){if(e.concreteTree.valueType===Kt&&e.concreteTree.getDependencies().length>0){let t=e.concreteTree._chunk;try{e.evaluationState.shader=Ma(t,0)}catch(n){e.evaluationState.error=n instanceof C.Error?n.getError():U(n).getError()}}}function C5(e,t,n){let r=e.evaluationState,s=e.rawTree,i={},o=s.metaData.clickHandler;if(!o)return;let a=o.tryGetConcreteTree(t,n);!a.isError&&a.valueType!==ut&&(a=kd(oe(a.valueType)));for(let c of a.getDependencies())t.validActionVariable(c)||(i[c]=!0);let u=Object.keys(i);u.length>0&&(a=rn(u).setDependencies(a.getDependencies())),a.isError&&!C1(t,a)?r.click_handler={status:"error",error:a.getError()}:a.isEmptyAction?r.click_handler={status:"empty"}:r.click_handler={status:"maybe-valid"},mc(r,t,i)}function D5(e,t,n){let r,s=e.evaluationState,i=e.rawTree,o,a;s.internal_domain_dependency?(r=s.internal_domain_dependency,r==="u"?(o=i.metaData.parametricDomain3DuMin,a=i.metaData.parametricDomain3DuMax):r==="v"?(o=i.metaData.parametricDomain3DvMin,a=i.metaData.parametricDomain3DvMax):(o=i.metaData.parametricDomainMin,a=i.metaData.parametricDomainMax)):s.expression_type==="POLAR"||R_(s.expression_type)?(o=i.metaData.polarDomainMin,a=i.metaData.polarDomainMax,r="theta"):(o=i.metaData.parametricDomainMin,a=i.metaData.parametricDomainMax,r="t");let u={},c=!!(o||a),l=Fa(t,n,o,u,0),p=NaN;a?p=Fa(t,n,a,u,NaN):s.expression_type==="PARAMETRIC"||s.expression_type==="CURVE3D_xyz_t"?p=1:s.expression_type==="POLAR"?p=Math.PI*12/+n.trigAngleMultiplier.asValue():(s.expression_type==="SURFACE_r_\\u03B8z"||s.expression_type==="SURFACE_r_\\u03B8z_AMBIGUOUS"||s.expression_type==="SLICE_r\\u03B8z_at_z")&&(p=Math.PI*2/+n.trigAngleMultiplier.asValue());let f=U1(l,p,s);({min:l,max:p}=f),i.metaData.evaluatedDomainMin=l,i.metaData.evaluatedDomainMax=p,(s.expression_type==="POLAR"||s.expression_type==="SURFACE_r_\\u03B8z"||s.expression_type==="SURFACE_r_\\u03B8z_AMBIGUOUS"||s.expression_type==="SLICE_r\\u03B8z_at_z")&&(i.metaData.isExplicitDomain=c),s.domains=[{variable:r,minNumber:l,maxNumber:p,minValid:f.minValid,maxValid:f.maxValid}],s.expression_type==="PARAMETRIC"&&delete u.t,s.expression_type==="CURVE3D_xyz_t"&&(delete u.t,delete u.u,delete u.v),mc(s,t,u)}function S5(e,t,n){let r=e.evaluationState,s=r.expression_type,i=e.rawTree,o,a,u,c,l={},p=0,f=1,d=0,y=1,g,m;O_(s)?(g="theta",m="phi",o=i.metaData.polarDomainMin,a=i.metaData.polarDomainMax,u=i.metaData.parametricDomain3DphiMin,c=i.metaData.parametricDomain3DphiMax,f=2*Math.PI/+n.trigAngleMultiplier.asValue(),y=Math.PI/+n.trigAngleMultiplier.asValue()):N_(s)?(g="r",m="theta",o=i.metaData.parametricDomain3DrMin,a=i.metaData.parametricDomain3DrMax,u=i.metaData.polarDomainMin,c=i.metaData.polarDomainMax,f=Dr.xmax,y=2*Math.PI/+n.trigAngleMultiplier.asValue()):(g="u",m="v",o=i.metaData.parametricDomain3DuMin,a=i.metaData.parametricDomain3DuMax,u=i.metaData.parametricDomain3DvMin,c=i.metaData.parametricDomain3DvMax),p=Fa(t,n,o,l,p),f=Fa(t,n,a,l,f),d=Fa(t,n,u,l,d),y=Fa(t,n,c,l,y);let h=U1(p,f,r);({min:p,max:f}=h);let x=U1(d,y,r);({min:d,max:y}=x),i.metaData.evaluatedDomain3DMin1=p,i.metaData.evaluatedDomain3DMax1=f,i.metaData.evaluatedDomain3DMin2=d,i.metaData.evaluatedDomain3DMax2=y,r.domains=[{variable:g,minNumber:p,minValid:h.minValid,maxNumber:f,maxValid:h.maxValid},{variable:m,minNumber:d,minValid:x.minValid,maxNumber:y,maxValid:x.maxValid}],(r.expression_type==="SURFACE_xyz_uv"||r.expression_type==="SLICE_xyz_uv")&&(delete l.u,delete l.v),mc(r,t,l)}function Fa(e,t,n,r,s){if(n){let i=n.tryGetConcreteTree(e,t,q1);for(let o of i.getDependencies())r[o]=!0;return i.isConstant?+i.asValue():NaN}else return s}function U1(e,t,n){let r=!0,s=!0;return isFinite(e)||(r=!1,e=NaN),isFinite(t)||(s=!1,t=NaN),r?s?e>t&&(r=!1,s=!1,n.error=LI().getError()):n.error=_I().getError():n.error=AI().getError(),{min:e,max:t,minValid:r,maxValid:s}}function v5(e,t,n){let r=e.evaluationState,s=e.rawTree,i=s.metaData.vizAxisOffset,o=s.metaData.vizBreadth,a={},u=Fa(t,n,i,a,1),c=Fa(t,n,o,a,1),l=!0,p=!0;isFinite(u)||(l=!1,u=NaN),isFinite(c)||(p=!1,c=NaN),l?p||(r.error=kT().getError()):r.error=GT().getError(),s.metaData.evaluatedAxisOffset=u,s.metaData.evaluatedBreadth=c,r.viz_values={axisOffset:u,breadth:c},r.viz_valids={axisOffset:l,breadth:p},mc(r,t,a)}function z1(e,t,n){if(e.isError||e.getDependencies().length||e.valueType!==ut)return;let r=e.asValue();if(r)for(let s of We(r.updateRules)){t[s]=P1(r,s);let{value:i,valueType:o}=r.updateRules[s];n[s]=new C.Assignment(s,lt(o,i))}}function O5(e,t){if(e.type!=="statement"||t.type!=="statement"||ws(e.latexSelection,t.latexSelection))return!1;let n=li(e),r=li(t);return delete n.latexSelection,delete r.latexSelection,ws(n,r)}function N5(e,t){if(!(e instanceof Cr))return!1;let n=t[e._symbol];return n?!!n.recursionInfo:!1}var tx=class{constructor(t){this.sendMessageForProgressUpdate=t;this.statements={};this.analysis={};this.currentStatus={};this.currentLabel={};this.unpublishedIds={};this.selectionOnlyChangeIds={};this.intersectId=void 0;this.dirtyExportedSymbolRoots={};this.dirtyStatementRoots={};this.markedRegressionDirty=!1;this.childIntersections=new hd;this.use_degrees=!1;this.initialEvaluation=!1;this.globalEventCount=0;this.evaluationMode="graphing";this.product="graphing";this.beta3d=!1;this.restrictedFunctions=!1;this.forceEnableGeometryFunctions=!1;this.functionDefinition=!0;this.replaceRoundWithReciprocal=!1;this.distributions=!0;this.actions=!0;this.substitutions=!0;this.intervalComprehensions=!0;this.recursion=!0;this.lastClockTickTime=void 0;this.dimensions={width:0,height:0};this.includeFunctionParametersInRandomSeed=!0;this.complex=!1;this.customRegressions=!0;this.getCLSymbolMap=mF;this.invalidate()}invalidate(){delete this.statements[sa];for(let t in this.statements)this.statements.hasOwnProperty(t)&&this.markAsDirtyRoot(t);this.currentStatus={},this.analysis={},this.setPolicy(),this.parent_frame=d5[this.evaluationMode].getFrame({restrictedFunctions:this.restrictedFunctions,forceEnableGeometryFunctions:this.forceEnableGeometryFunctions,isGeometryCalculator:this.evaluationMode==="geometry",is3DCalculator:this.product==="graphing-3d",isComplexEnabled:this.complex,replaceRoundWithReciprocal:this.replaceRoundWithReciprocal,distributions:this.distributions,additionalFunctions:this.additionalFunctions,disableParentheses:this.disableParentheses,trigAngleMultiplier:new So(this.use_degrees?Math.PI/180:Se(1,1)),initialEvaluation:new So(this.initialEvaluation?1:0),globalEventCount:new So(0),globalRandomSeed:new EF(this.globalRandomSeedString||""),width:this.policy.dimensionVarsEnabled()?new So(Se(this.dimensions.width,1)):Hy("width"),height:this.policy.dimensionVarsEnabled()?new So(Se(this.dimensions.height,1)):Hy("height")}),this.mainFrameContext=new Rl(this.parent_frame),this.lastFrame=Tn(this.parent_frame),this.regressionFrameContext=new Rl(this.parent_frame),this.lastClockTickTime=void 0}setPolicy(){let t=this.viewState?{xAxisScale:this.viewState.xAxisScale,yAxisScale:this.viewState.yAxisScale}:void 0;this.policy=p5({evaluationMode:this.evaluationMode,is3dProduct:this.product==="graphing-3d",isBeta3d:this.beta3d,isComplexEnabled:this.complex,scales:t,includeFunctionParametersInRandomSeed:this.includeFunctionParametersInRandomSeed,customRegressions:this.customRegressions,isRecursionEnabled:this.recursion})}getAllActionUpdateSymbols(){var n;let t=new Set;for(let r in this.statements){let s=this.statements[r];s.getUpdateSymbols().forEach(o=>t.add(o)),s instanceof C.Ticker&&s.handler.getUpdateSymbols().forEach(o=>t.add(o));let i=this.analysis[r];(_f(s)||i&&!uu(i.getGraphMode())&&tC(i.evaluationState.expression_type))&&((n=s.metaData.clickHandler)==null||n.getUpdateSymbols().forEach(o=>t.add(o)))}return[...new Set(t)]}processChangeSet(t){let n=yc(),r={cacheWrites:0,cacheReads:0,cacheHits:0,cacheMisses:0};wO(r);let s={intersections:{},graphs:{}};t.isCompleteState&&(this.invalidate(),this.statements={},this.currentLabel={});let i=!!t.isCompleteState&&!t.isUndoRedoState;i!==this.initialEvaluation&&(this.initialEvaluation=i,this.parent_frame.initialEvaluation=new So(i?1:0)),t.hasOwnProperty("logInternalErrors")&&Dx(t.logInternalErrors),t.viewState&&this.setViewState(t.viewState),t.hasOwnProperty("degreeMode")&&this.setDegreeMode(t.degreeMode),t.hasOwnProperty("globalRandomSeed")&&this.setGlobalRandomSeed(t.globalRandomSeed),t.hasOwnProperty("includeFunctionParametersInRandomSeed")&&this.setIncludeFunctionParametersInRandomSeed(t.includeFunctionParametersInRandomSeed),t.hasOwnProperty("evaluationMode")&&this.setEvaluationMode(t.evaluationMode),t.hasOwnProperty("additionalFunctions")&&this.setAdditionalFunctions(t.additionalFunctions),t.hasOwnProperty("disableParentheses")&&this.setDisableParentheses(t.disableParentheses),t.hasOwnProperty("restrictedFunctions")&&this.setRestrictedFunctions(t.restrictedFunctions),t.hasOwnProperty("forceEnableGeometryFunctions")&&this.setForceEnableGeometryFunctions(t.forceEnableGeometryFunctions),t.hasOwnProperty("distributions")&&this.setDistributions(t.distributions),t.hasOwnProperty("functionDefinition")&&this.setFunctionDefinition(t.functionDefinition),t.hasOwnProperty("replaceRoundWithReciprocal")&&this.setReplaceRoundWithReciprocal(t.replaceRoundWithReciprocal),t.hasOwnProperty("pointsOfInterest")&&this.setWorkerConfigProperty("pointsOfInterest",t.pointsOfInterest),t.hasOwnProperty("plotSingleVariableImplicitEquations")&&this.setWorkerConfigProperty("plotSingleVariableImplicitEquations",t.plotSingleVariableImplicitEquations),t.hasOwnProperty("plotImplicits")&&this.setWorkerConfigProperty("plotImplicits",t.plotImplicits),t.hasOwnProperty("plotInequalities")&&this.setWorkerConfigProperty("plotInequalities",t.plotInequalities),t.hasOwnProperty("sliders")&&this.setWorkerConfigProperty("sliders",t.sliders),t.hasOwnProperty("actions")&&this.setActions(!!t.actions),t.hasOwnProperty("substitutions")&&this.setSubstitutions(!!t.substitutions),t.hasOwnProperty("intervalComprehensions")&&this.setIntervalComprehensions(!!t.intervalComprehensions),t.hasOwnProperty("recursion")&&this.setRecursion(!!t.recursion);let o=t.recursionDepthLimit;if(o!==void 0&&o>0&&o<=10**6&&RE(o),t.hasOwnProperty("beta3d")&&this.setBeta3d(!!t.beta3d),t.hasOwnProperty("product")&&this.setProduct(t.product),t.hasOwnProperty("selectedIds")){let f=t.selectedIds||{};if(this.intersectId===void 0||!f[this.intersectId]){let[d]=Object.keys(f);this.intersectId=d}}if(t.hasOwnProperty("dimensions")&&this.setDimensions(t.dimensions),t.hasOwnProperty("complex")&&(this.setComplex(!!t.complex),!t.isCompleteState))throw U("Complex mode changed without a complete change set.");t.hasOwnProperty("customRegressions")&&this.setCustomRegressions(!!t.customRegressions);let a=yc();this.processStatements(t,s);let u=yc();r.processStatements=u-a,a=u;let c=this.updateAnalysis();u=yc(),r.updateAnalysis=u-a,a=u;let l=this._publishAllStatuses();u=yc(),r.publishAllStatuses=u-a,a=u,this._computeAllLabels(),u=yc(),r.computeAllLabels=u-a,a=u,this._computeAriaDescriptions(),u=yc(),r.computeAriaDescriptions=u-a,a=u,this._graphAllChanged(s),u=yc(),r.graphAllChanges=u-a,r.updateIntersections=0;let p=this.processEvents(t.events);return this.unpublishedIds={},this.selectionOnlyChangeIds={},r.timeInWorker=u-n,{syncId:t.syncId,isCompleteState:t.isCompleteState,intersectionChanges:s.intersections,statusChanges:l,graphChanges:s.graphs,timingData:r,eventUpdates:p,dependencyOrder:{definitionLevel:c.definitionLevel,multiplyDefined:c.multiplyDefined}}}processStatements(t,n){if(t.removes)for(let r in t.removes){if(!t.isCompleteState&&this.statements.hasOwnProperty(r)){let s=this.statements[r];if(Hi(s))for(let i of s.getColumnIdsForGraphing())this._notifyGraphRemoved(i,n)}this.removeStatement(r,n)}if(t.statements)for(let r in t.statements){let s=t.statements[r];s===null||this.addStatement(s,n)}}setViewState(t){if(ws(t,this.viewState))return;let n=!!(this.viewState&&t.xAxisScale===this.viewState.xAxisScale&&t.yAxisScale===this.viewState.yAxisScale);if(this.viewState=t,n)for(let r in this.statements)this.statements.hasOwnProperty(r)&&this.markUnpublished(r);else this.invalidate()}getViewState(){return this.viewState}setDegreeMode(t){this.use_degrees=t,this.invalidate()}setDimensions(t){t!==void 0&&(this.dimensions=t,this.invalidate())}setGlobalRandomSeed(t){this.globalRandomSeedString=t,this.parent_frame.globalRandomSeed=new EF(t),this.dirtyExportedSymbolRoots.globalRandomSeed=!0}setIncludeFunctionParametersInRandomSeed(t){this.includeFunctionParametersInRandomSeed=t,this.setPolicy()}setEvaluationMode(t){this.evaluationMode=t,this.invalidate()}setProduct(t){this.product=t,this.invalidate()}setBeta3d(t){this.beta3d=t,this.invalidate()}setAdditionalFunctions(t){this.additionalFunctions=t,this.invalidate()}setDisableParentheses(t){this.disableParentheses=t,this.invalidate()}setRestrictedFunctions(t){this.restrictedFunctions=t,this.invalidate()}setForceEnableGeometryFunctions(t){this.forceEnableGeometryFunctions=t,this.invalidate()}setDistributions(t){this.distributions=t,this.invalidate()}setFunctionDefinition(t){this.functionDefinition=t,this.invalidate()}setReplaceRoundWithReciprocal(t){this.replaceRoundWithReciprocal=t,this.invalidate()}setActions(t){t!==this.actions&&(this.actions=t,this.invalidate())}setSubstitutions(t){t!==this.substitutions&&(this.substitutions=t,this.invalidate())}setIntervalComprehensions(t){t!==this.intervalComprehensions&&(this.intervalComprehensions=t,this.invalidate())}setRecursion(t){t!==this.recursion&&(this.recursion=t,this.invalidate())}setComplex(t){t!==this.complex&&(this.complex=t,this.invalidate())}setCustomRegressions(t){t!==this.customRegressions&&(this.customRegressions=t,this.invalidate())}setWorkerConfigProperty(t,n){n!==Si[t]&&(Si[t]=n,this.invalidate())}_publishAllStatuses(){let t={},n=this.currentStatus;this.currentStatus={};for(let r in{...this.unpublishedIds,...this.selectionOnlyChangeIds}){if(!this.analysis.hasOwnProperty(r))continue;let s=this.analysis[r].evaluationState;ws(s,n[r])||(t[r]=s),this.currentStatus[r]=s}return t}_computeAllLabels(){for(let t in this.currentLabel){let n=this.statements[t];if(!n)continue;let r=hc(this.mainFrameContext,n),s=n.tryGetConcreteTree(this.policy,r),i=1;(s.valueType===Pt||s.valueType===Ue||s.valueType===xn||s.valueType===In||s.valueType===On||s.valueType===Nn)&&(i=s.length);let o=[],a=this.currentLabel[t];if(Bo(a))for(let u=0;u<i;u++)o.push(H1(a,this.policy,r,u));ws(o,n.computedLabels)||(n.computedLabels=o,this.markUnpublished(t))}}_computeAriaDescriptions(){for(let t in this.analysis){let n=this.analysis[t],r=n.evaluationState,i=n.rawTree.userData,o;if(i.description?o=i.description:i.label&&(o=i.label),o){r.computed_description=[];let a=1;n.concreteTree.isList?a=n.concreteTree.length:r.dimensions&&r.dimensions.x&&Array.isArray(r.dimensions.x)&&(a=r.dimensions.x.length);for(let u=0;u<a;u++)r.computed_description.push(H1(k1(o),this.policy,hc(this.mainFrameContext,this.statements[t]),u))}}}_graphAllChanged(t){var i;let n=this.getViewState();if(!n||!Mw(n))return;let r=!1,s=!1;for(let o in this.unpublishedIds){if(!this.analysis.hasOwnProperty(o))continue;let a=this.analysis[o],u=a.evaluationState.expression_type,c=u==="SINGLE_POINT"||u==="POINT_LIST";if(Hi(a.rawTree)){let l=a.graph(n,void 0),p=a.rawTree.getColumnIdsForGraphing();for(let f of p)l[f]?this._notifyGraphComputed(f,l[f],t):this._notifyGraphRemoved(f,t);if((i=a.rawTree.regression)!=null&&i.userData){let f=a.rawTree.regression.userData.id,d=this.analysis[f];if(d!=null&&d.evaluationState.is_graphable&&a.rawTree.regression.userData.shouldGraph){let y=d.graph(n,void 0);this._notifyGraphComputed(f,y,t)}else this._notifyGraphRemoved(f,t)}}else a.evaluationState.is_graphable&&(a.rawTree.userData.shouldGraph||a.rawTree.userData.showLabel&&c)?(this.postProgressUpdate("GRAPHING",[o]),s=!0,this._notifyGraphComputed(o,a.graph(n,this.childIntersections.getChildIntersections(o)),t),o===this.intersectId&&(r=!0,this._updateIntersections(o,t)),this.postProgressUpdate("UNPUBLISHED",[o])):ga(a.rawTree)||this._notifyGraphRemoved(o,t)}s&&!r&&(this.lastComputedIntersectId=void 0),this.intersectId!==void 0&&!r&&(s||this.intersectId!==this.lastComputedIntersectId)&&this._updateIntersections(this.intersectId,t)}_notifyGraphRemoved(t,n){n.graphs[t]=void 0}_notifyGraphComputed(t,n,r){sO(n),r.graphs[t]=n}_updateIntersections(t,n){if(this.lastComputedIntersectId=t,!this.viewState)return;if(!this.analysis[t]||!this.analysis[t].shouldIntersect()){n.intersections[t]=[];return}this.postProgressUpdate("GRAPHING",[t]);let r=eF(this.analysis,this.viewState,t);n.intersections[t]=r,this.postProgressUpdate("UNPUBLISHED",[t])}getDisabledFeatures(){let t=this.policy.disabledFeatures();this.functionDefinition===!1&&(t=t.concat("FunctionDefinition")),this.actions===!1&&(t=t.concat("UpdateRule")),this.substitutions===!1&&(t=t.concat(["Substitution","ListComprehension"]));let n=this.additionalFunctions||[];return t=t.filter(r=>!(r==="Exponent"&&n.indexOf("exponent")!==-1||r==="PercentOf"&&n.indexOf("percent")!==-1)),t}areFractionsDisallowed(){let{evaluationMode:t}=this;return t!=="fourFunction"&&t!=="singleExpressionFourFunction"?!1:!this.additionalFunctions||this.additionalFunctions.indexOf("fraction")===-1}addStatement(t,n){if(!t)return;let r=t.id,s=this.statements[r],i=s==null?void 0:s.userData,o=!!i&&O5(i,t)&&!N5(s,this.mainFrameContext.global),a={index:this.policy.ansEnabled()?t.index:void 0,disabledFeatures:this.getDisabledFeatures(),disallowFrac:this.areFractionsDisallowed(),disableParentheses:!!this.disableParentheses,allowIntervalComprehensions:!!this.intervalComprehensions,seedPrefix:yn(r),writeIntegral:this.evaluationMode==="geometry",specializeDoubleInequalities:!this.policy.is3dProduct(),includeFunctionParametersInRandomSeed:this.includeFunctionParametersInRandomSeed},u={extraDepNodes:[]};switch(t.type){case"table":let p;if(s&&Hi(s)){p=new Set([...s.getColumnIdsForGraphing(),...s.getColumnStatementIds()]);let _=s.getRegressionId();_!==void 0&&p.add(_)}t.shouldGraph=!0;let f=t.columns,d=[],y=new Map,g=_=>!_.replace(/\\\\space|\\\\ /g,"").match(/\\S/);for(let _=0;_<f.length;_++){let L=f[_],w=Mi(L.latex,{...a,seedPrefix:yn(r,[["tr",0],["tc",_]])}),G=[],k=-1;for(let re=0;re<f[_].values.length;re++)g(L.values[re])?G.push(new So(NaN)):(G.push(Mi(L.values[re],{...a,seedPrefix:yn(r,[["tr",re+1],["tc",_]])})),k=re);G=G.slice(0,k+1);let Z=new co(w,G,t.id,_),F=`dcgcolumnstmt${L.id}`;Z.userData={id:F},y.set(L.id,Z),this.updateSingleStatement(F,Z,{selectionOnlyChange:o});let Y=new co(w,G,t.id,_);if(Y.userData=L,Y.header){if(Y.header.userData=L,Y.header.metaData={extraDepNodes:[]},L.colorLatex){let re=ri(L.colorLatex,{...a,seedPrefix:yn(r,[["tr",0],["tc",_],["cl",_]])});Y.header.metaData.colorLatex=re,Y.header.metaData.extraDepNodes.push(re)}if(L.pointSize){let re=ri(L.pointSize,{...a,seedPrefix:yn(r,[["tr",0],["tc",_],["ps",_]])});Y.header.metaData.pointSize=re,Y.header.metaData.extraDepNodes.push(re)}if(L.pointOpacity){let re=ri(L.pointOpacity,{...a,seedPrefix:yn(r,[["tr",0],["tc",_],["po",_]])});Y.header.metaData.pointOpacity=re,Y.header.metaData.extraDepNodes.push(re)}if(L.lineWidth){let re=ri(L.lineWidth,{...a,seedPrefix:yn(r,[["tr",0],["tc",_],["lw",_]])});Y.header.metaData.lineWidth=re,Y.header.metaData.extraDepNodes.push(re)}if(L.lineOpacity){let re=ri(L.lineOpacity,{...a,seedPrefix:yn(r,[["tr",0],["tc",_],["lo",_]])});Y.header.metaData.lineOpacity=re,Y.header.metaData.extraDepNodes.push(re)}}d.push(Y)}let m;t.regression&&(m=IF(t,r,a,y),m!==void 0&&this.updateSingleStatement(t.regression.id,m,{selectionOnlyChange:o}));let h=new Yp(d,[...y.values()],m,r);if(this.updateSingleStatement(r,h,{selectionOnlyChange:o}),p){let _=new Set([...h.getColumnIdsForGraphing(),...h.getColumnStatementIds()]),L=h.getRegressionId();L&&_.add(L);for(let w of p)_.has(w)||this.removeSingleStatement(w,n)}break;case"image":let x="-\\\\trigAngleMultiplier*("+t.angle+")",T=ri(t.center,{...a,seedPrefix:yn(r,[["ic",r]])}),b=ri(x,{...a,seedPrefix:yn(r,[["ia",r]])}),M=ri(t.width,{...a,seedPrefix:yn(r,[["iw",r]])}),P=ri(t.height,{...a,seedPrefix:yn(r,[["ih",r]])}),D=ri(t.opacity,{...a,seedPrefix:yn(r,[["io",r]])});this.updateSingleStatement(r,new u5({center:T,radianAngle:b,width:M,height:P,opacity:D},void 0),{selectionOnlyChange:o});break;case"ticker":{this.updateSingleStatement(r,new C.Ticker({handler:ri(t.handlerLatex,{...a,allowDt:!0}),minStep:ri(t.minStepLatex||"0",a)}),{selectionOnlyChange:o});break}case"geometry-toolbar-predicate":{this.updateSingleStatement(r,ri(`\\\\{${t.latex}:1,0\\\\}`,{...a}),{selectionOnlyChange:o});break}default:t=t;let S,O=oa(t.latex);O.slice(-1)==="="?S=O.substring(0,O.length-1):S=t.latex,this.updateSingleStatement(r,Mi(S,a),{selectionOnlyChange:o});for(let _ in wm){let L=_;if(t[L]){let w=wm[L],G=t[L];w.transform&&(G=w.transform(G));let k=yi(G,{...a,seedPrefix:yn(r,[[w.seed,r]])});u[L]=k,u.extraDepNodes.push(k)}}if(t.colorLatex){let _=gc(t.colorLatex,{...a,seedPrefix:yn(r,[["ac",r]])});u.colorLatex=_,u.extraDepNodes.push(_)}if(t.polarDomain&&t.polarDomain.min&&(u.polarDomainMin=yi(t.polarDomain.min,{...a,seedPrefix:yn(r,[["lm",r]])}),u.extraDepNodes.push(u.polarDomainMin)),t.polarDomain&&t.polarDomain.max&&(u.polarDomainMax=yi(t.polarDomain.max,{...a,seedPrefix:yn(r,[["lM",r]])}),u.extraDepNodes.push(u.polarDomainMax)),t.parametricDomain&&t.parametricDomain.min&&(u.parametricDomainMin=yi(t.parametricDomain.min,{...a,seedPrefix:yn(r,[["lm",r]])}),u.extraDepNodes.push(u.parametricDomainMin)),t.parametricDomain&&t.parametricDomain.max&&(u.parametricDomainMax=yi(t.parametricDomain.max,{...a,seedPrefix:yn(r,[["lM",r]])}),u.extraDepNodes.push(u.parametricDomainMax)),t.parametricDomain3Du&&t.parametricDomain3Du.min&&(u.parametricDomain3DuMin=yi(t.parametricDomain3Du.min,{...a,seedPrefix:yn(r,[["lm",r]])}),u.extraDepNodes.push(u.parametricDomain3DuMin)),t.parametricDomain3Du&&t.parametricDomain3Du.max&&(u.parametricDomain3DuMax=yi(t.parametricDomain3Du.max,{...a,seedPrefix:yn(r,[["lM",r]])}),u.extraDepNodes.push(u.parametricDomain3DuMax)),t.parametricDomain3Dv&&t.parametricDomain3Dv.min&&(u.parametricDomain3DvMin=yi(t.parametricDomain3Dv.min,{...a,seedPrefix:yn(r,[["lm",r]])}),u.extraDepNodes.push(u.parametricDomain3DvMin)),t.parametricDomain3Dv&&t.parametricDomain3Dv.max&&(u.parametricDomain3DvMax=yi(t.parametricDomain3Dv.max,{...a,seedPrefix:yn(r,[["lM",r]])}),u.extraDepNodes.push(u.parametricDomain3DvMax)),t.parametricDomain3Dr&&t.parametricDomain3Dr.min&&(u.parametricDomain3DrMin=yi(t.parametricDomain3Dr.min,{...a,seedPrefix:yn(r,[["lm",r]])}),u.extraDepNodes.push(u.parametricDomain3DrMin)),t.parametricDomain3Dr&&t.parametricDomain3Dr.max&&(u.parametricDomain3DrMax=yi(t.parametricDomain3Dr.max,{...a,seedPrefix:yn(r,[["lM",r]])}),u.extraDepNodes.push(u.parametricDomain3DrMax)),t.parametricDomain3Dphi&&t.parametricDomain3Dphi.min&&(u.parametricDomain3DphiMin=yi(t.parametricDomain3Dphi.min,{...a,seedPrefix:yn(r,[["lm",r]])}),u.extraDepNodes.push(u.parametricDomain3DphiMin)),t.parametricDomain3Dphi&&t.parametricDomain3Dphi.max&&(u.parametricDomain3DphiMax=yi(t.parametricDomain3Dphi.max,{...a,seedPrefix:yn(r,[["lM",r]])}),u.extraDepNodes.push(u.parametricDomain3DphiMax)),t.vizProps&&(t.vizProps.axisOffset&&(u.vizAxisOffset=yi(t.vizProps.axisOffset,{...a,seedPrefix:yn(r,[["vo",r]])}),u.extraDepNodes.push(u.vizAxisOffset)),t.vizProps.breadth&&(u.vizBreadth=yi(t.vizProps.breadth,{...a,seedPrefix:yn(r,[["vb",r]])}),u.extraDepNodes.push(u.vizBreadth))),t.cdf&&t.cdf.show){let _=v_(t.latex);_&&_.type==="distribution"&&(u.distributionSpec=_,u.cdfMin=gc(t.cdf.min,{...a,seedPrefix:yn(r,[["lm",r]])}),u.extraDepNodes.push(u.cdfMin),u.cdfMax=gc(t.cdf.max,{...a,seedPrefix:yn(r,[["lM",r]])}),u.extraDepNodes.push(u.cdfMax))}if(this.statements[r].shouldPromoteToSlider(this.policy)){let _=t.slider,L=!!(_&&_.isPlayingOnce),w=gc(_&&_.softMin,a),G=gc(_&&_.softMax,a),k=gc(_&&_.min,{...a,seedPrefix:yn(r,[["lm",r]])}),Z=gc(_&&_.max,{...a,seedPrefix:yn(r,[["lM",r]])}),F=gc(_&&_.step,{...a,seedPrefix:yn(r,[["ls",r]])});this.updateSingleStatement(r,new c5(this.statements[r],{sliderMin:k,sliderMax:Z,sliderStep:F,sliderIsPlayingOnce:L,sliderSoftMin:w,sliderSoftMax:G}),{selectionOnlyChange:o})}}let c=t.clickableInfo;c&&c.enabled&&c.latex&&(u.clickHandler=ri(c.latex,{...a,allowIndex:!0})),this.statements[r].userData=t,this.statements[r].metaData=u;let l=t.label;if(l){let p=this.currentLabel[r];(!p||p.raw!==l)&&(this.currentLabel[r]=k1(l))}else delete this.currentLabel[r]}updateSingleStatement(t,n,{selectionOnlyChange:r}){r?this.selectionOnlyChangeIds[t]=!0:(this.markExportsDirty(t),this.markAsDirtyRoot(t)),this.statements[t]=n}removeStatement(t,n){let r=this.statements[t];if(r&&Hi(r)){for(let i of r.getColumnStatementIds())this.removeSingleStatement(i,n);let s=r.getRegressionId();s&&this.removeSingleStatement(s,n)}this.removeSingleStatement(t,n)}removeSingleStatement(t,n){this.statements[t]&&(this.markExportsDirty(t),this._notifyGraphRemoved(t,n),delete this.currentLabel[t],delete this.statements[t],delete this.analysis[t],delete this.currentStatus[t])}markExportsDirty(t){if(this.statements[t]){ui(this.statements[t])&&(this.markedRegressionDirty=!0);for(let n of this.statements[t].getLegalExports(this.policy))this.dirtyExportedSymbolRoots[n]=!0}}markAsDirtyRoot(t){this.dirtyStatementRoots[t]=!0}markUnpublished(t){var r;let n=this.statements[t];n&&ga(n)||n&&ui(n)&&((r=n.tableRegressionData)==null?void 0:r.tableId)!==void 0||(this.unpublishedIds[t]=!0,delete this.selectionOnlyChangeIds[t])}getFrame(){return this.updateAnalysis(),this.mainFrameContext.global}getAnalysis(){return this.updateAnalysis(),this.analysis}getEvaluationState(t){if(this.updateAnalysis(),!!this.analysis[t])return this.analysis[t].evaluationState}_updateRegressions(t){var l;let n=this.lastFrame,r=this.regressionFrameContext;if(!this.policy.graphingEnabled())return;let s=[];for(let p of t.keys())ui(this.statements[p])&&s.push(p);let i=this;s.sort((p,f)=>{var g,m;let d=(g=i.statements[p].userData)==null?void 0:g.residualVariable,y=(m=i.statements[f].userData)==null?void 0:m.residualVariable;return d&&!y?-1:y&&!d?1:0});let o=Lf(this.policy,this.statements,s);$P(r.global,o),MF(o,r,this.recursion);let a=o.resolved;this.postProgressUpdate("RESOLVED",a);let u={};for(let p in this.statements){let f=this.statements[p];f&&Hi(f)&&(u[p]=f)}let c=new Set;for(let p of a){if(p===sa){this.postProgressUpdate("UNPUBLISHED",[p]);continue}if(c.has(p))continue;this.postProgressUpdate("ANALYZING",[p]);let f=this.statements[p];if(ui(f)){let d=((l=f.tableRegressionData)==null?void 0:l.tableId)===void 0?hc(r,f):hc(r,u[f.tableRegressionData.tableId]),y=f.analyzeRegression(this.policy,d,this.mainFrameContext.global,n,u);this.analysis[p]=y;let g=this.exportTo({id:p,stmtAnalysis:y},this.mainFrameContext);y.evaluationState.exported_variables=g,t.delete(p),this.postProgressUpdate("UNPUBLISHED",[p])}else{let d=hc(r,f),y=this.analyzeSingleStatementGraphing(p,this.analysis,d,o,"regression"),g=[];for(let m of y)this.exportTo(m,r),g.push(m.id),m.id!==p&&c.add(m.id);this.postProgressUpdate("UNPUBLISHED",g)}}}_updateAnalysisAndFrame(t,n,r){var u;let s=this.analysis;$P(this.mainFrameContext.global,t),MF(t,this.mainFrameContext,this.recursion);let o=t.resolved.filter(c=>r.has(c)).concat(Object.keys(this.selectionOnlyChangeIds));this.postProgressUpdate("RESOLVED",o);let a=new Set;for(let c of o){if(c===sa){this.postProgressUpdate("UNPUBLISHED",[c]);continue}if(n.has(c)){this.postProgressUpdate("UNPUBLISHED",[c]);continue}if(a.has(c))continue;this.postProgressUpdate("ANALYZING",[c]);let l=this.analyzeSingleStatement(c,s,t),p=[];for(let f of l){s[f.id]=f.stmtAnalysis;let d=this.exportTo(f,this.mainFrameContext);if(Hi(f.stmtAnalysis.rawTree)){let y=f.stmtAnalysis.rawTree.getColumnStatementIds();for(let g of y){let m=this.analysis[g],h=(u=m==null?void 0:m.evaluationState.exported_variables)!=null?u:[];d.push(...h)}}f.stmtAnalysis.evaluationState.exported_variables=d,p.push(f.id),f.id!==c&&a.add(f.id)}this.postProgressUpdate("UNPUBLISHED",p)}return{analyzedStatements:o}}exportTo(t,n){let r=t.stmtAnalysis.rawTree.exportTo(this.policy,t.stmtAnalysis.concreteTree,n.global),s=this.statements[t.id];if(s instanceof co){let i=hc(n,s);s.exportToLocal(this.policy,t.stmtAnalysis.concreteTree,i)}return r}buildSymbolToExpressionDirtyMap(){return Jw(this.policy,this.statements)}buildChildIntersectionMap(){let t=this.childIntersections,n=new hd;for(let s in this.analysis){let i=this.analysis[s],{geometry:o}=i.evaluationState;if(o!=null&&o.call&&o.call.symbol==="intersection"&&this.statements[s].userData.shouldGraph&&!i.concreteTree.isError){let a=!!this.unpublishedIds[s],u=i.concreteTree.asTypedValue();for(let c of o.call.parents){if(c.type==="arbitrary-expression")continue;let l=Ta(c);if(!l)continue;let p=this.mainFrameContext.global[l],f=p&&p.userData.id;if(f==null)continue;let y=this.analysis[f].concreteTree.asTypedValue();y&&u&&n.addChildIntersection({id:f,valueType:y.valueType,ref:c},u),a&&this.markUnpublished(f)}}}let r=hd.compareIntersectionCounts({nextChildIntersections:n,prevChildIntersections:t});for(let s in r){let{prev:i,next:o}=r[s];o<i&&this.markUnpublished(s)}return n}findAllRegressionExports(){let t=new Map,n={};for(let r of We(this.statements)){let s=this.statements[r];if(!ui(s))continue;let i=this.analysis[r];if(!i||!ui(i.rawTree))continue;let o=i.concreteTree,a=i.rawTree.getExportsFromConcrete(this.policy,o);t.set(r,a);for(let u of a)n[u]=!0}return{regressionExportMap:t,regressionExportRoots:n}}updateConstruction(){if(!this.policy.isGeometryEnabled){this.parent_frame.construction=rf();return}let t=[];for(let o in this.statements)this.statements[o].userData.isInConstructionsFolder&&t.push(o);let n=this.statements[sa],r=new l5(t);r.metaData={extraDepNodes:[]},r.userData={};let s={};for(let o of(n==null?void 0:n.getDependencies())||[])s[o]=!0;let i={};for(let o of r.getDependencies())i[o]=!0;(!n||!ws(s,i))&&(this.statements[sa]=r,this.parent_frame.construction=r,this.markAsDirtyRoot(sa),this.markExportsDirty(sa))}analyzeExternalRecursiveBaseCases(){if(!this.recursion)return;let t=[],n={};for(let a of Object.keys(this.statements)){let u=this.statements[a];u instanceof Cr&&!this.policy.assignmentForbidden(u._symbol)&&(t.push(a),n[u._symbol]=u)}let{recursiveFunctionGroups:r}=Lf(this.policy,this.statements,t),s=new Set;for(let a of t){let u=this.statements[a];u instanceof Cr&&r[a]&&s.add(u._symbol)}let i={},o=[];for(let a of Object.keys(this.statements)){let u=this.statements[a];if(u instanceof ku&&s.has(u._lhs._symbol)){let c=Qr.fromCallAssignment(n,u);if(!c)continue;this.updateSingleStatement(a,c,{selectionOnlyChange:!1});let l=c._symbol;i[l]||(i[l]=[]),i[l].push(c),c.getDependencies().length&&o.push(a)}else if(u instanceof Qr){let c=u._symbol;s.has(u._symbol)?(i[c]||(i[c]=[]),i[c].push(u),u.getDependencies().length&&o.push(a)):this.updateSingleStatement(a,u.originalNode,{selectionOnlyChange:!1})}}for(let a of We(n)){let u=n[a],c=u.getExternalBaseCases(),l=i[a]||[];R5(l,c)||(u.setExternalBaseCases(l),this.markExportsDirty(u.userData.id),this.markAsDirtyRoot(u.userData.id))}if(o.length){let{recursiveFunctionBaseCasesWithCycles:a}=Lf(this.policy,this.statements,o);for(let u of a){let c=this.statements[u];if(c instanceof Qr){let l=n[c._symbol];l.setExternalBaseCases(l.getExternalBaseCases().filter(p=>p!==c)),this.statements[u]=c.originalNode}}}}updateAnalysis(){var m,h,x,T;this.updateConstruction(),this.analyzeExternalRecursiveBaseCases();let t=this.buildSymbolToExpressionDirtyMap(),n=Ed(this.policy,this.statements,t,this.dirtyStatementRoots,this.dirtyExportedSymbolRoots),r=this.markedRegressionDirty;for(let b in n.ids)this.statements[b]&&ui(this.statements[b])&&(r=!0);let s=new Set;if(r){for(let b in this.statements)this.statements[b]&&s.add(b);this.mainFrameContext=new Rl(this.parent_frame),this.regressionFrameContext=new Rl(this.parent_frame)}else{let b=n.ids;for(let P in b)this.statements[P]&&s.add(P);let M=n.symbols;for(let P of We(M))M[P]&&(delete this.mainFrameContext.global[P],delete this.regressionFrameContext.global[P])}let i=!1;for(let b of s.keys())this.markUnpublished(b),this.mainFrameContext.hasLocalFrame(b)&&(i=!0,this.mainFrameContext.deleteLocalFrame(b));if(i)for(let b in this.statements){let M=this.statements[b];M.localFrameID&&s.has(M.localFrameID)&&s.add(b)}this.markedRegressionDirty=!1,this.dirtyExportedSymbolRoots={},this.dirtyStatementRoots={};let o=this.analysis;(this.evaluationMode==="graphing"||this.evaluationMode==="geometry"||this.evaluationMode==="graphing_3d")&&this._updateRegressions(s);let{regressionExportMap:a,regressionExportRoots:u}=this.findAllRegressionExports(),c=Lf(this.policy,this.statements,We(this.statements),a),{analyzedStatements:l}=this._updateAnalysisAndFrame(c,new Set(a.keys()),s),p=Ed(this.policy,this.statements,t,{},u),f={};for(let b of c.recursiveFunctionSymbols)f[b]=!0;let d=Ed(this.policy,this.statements,t,{},f);this.markRegressionAndRecursionDependents({regressionDependentStatements:p.ids,recursionDependentStatements:d.ids});for(let b in this.analysis){let M=this.analysis[b];if(ui(M.rawTree)&&((m=M.rawTree.tableRegressionData)!=null&&m.tableId)){let P=M.evaluationState,D=this.analysis[M.rawTree.tableRegressionData.tableId];if(!D)throw new Error(`Programming error: table ${M.rawTree.tableRegressionData.tableId} not found for table regression ${b}`);let S=D.evaluationState;if(P.regression){let _=M.rawTree.tableRegressionData.columnInfo.filter(G=>G.isIdentifier).map(G=>no(G.latex)).filter(G=>this.policy.assignmentForbidden(G)),L=(h=M.rawTree.tableRegressionData.columnInfo.find(G=>!G.isIdentifier))==null?void 0:h.latex,w;_.length>0?w=qP(_).getError():L&&(w=UP(L).getError()),S.table_regression={status:"success",result:P.regression,export_info:w?{status:"unexportable",reason:w}:{status:"exportable"}}}else S.table_regression={status:"error",error:(x=P.error)!=null?x:U(\'Expected regression state to define either "regression" or "error"\').getError()}}}if(this.policy.graphingEnabled()){for(let b of l)this.evaluateMetadataForStatement(b,hc(this.mainFrameContext,this.statements[b]),this.policy);this.childIntersections=this.buildChildIntersectionMap()}Qw(t).forEach(b=>{o[b].evaluationState.depends_on_random_seed=!0});let y=Ed(this.policy,this.statements,t,{[sa]:!0},{construction:!0});for(let b in y.ids){if(b===sa)continue;let M=o[b].evaluationState;M.geometry&&(M.geometry.unconstructable=!0)}let g;for(let b in this.statements)if((T=this.statements[b].userData)!=null&&T.latexSelection){g=b;break}if(g){let b=Ed(this.policy,this.statements,t,{[g]:!0},{[`idref_${g}`]:!0});for(let M in b.ids){if(M===sa)continue;let P=o[M].evaluationState;P.geometry&&(P.geometry.depends_on_selected=!0)}}this.lastFrame=Tn(this.parent_frame);for(let b of We(this.mainFrameContext.global))this.lastFrame[b]=this.mainFrameContext.global[b];return c}analyzeSingleStatement(t,n,r){switch(this.evaluationMode){case"fourFunction":case"singleExpressionFourFunction":return[{id:t,stmtAnalysis:this.statements[t].analyzeFourFunction(this.policy,this.mainFrameContext.global,n)}];case"scientific":return[{id:t,stmtAnalysis:this.statements[t].analyzeScientific(this.policy,this.mainFrameContext.global,n)}];case"singleExpressionScientific":return[{id:t,stmtAnalysis:this.statements[t].analyzeSingleExpressionScientific(this.policy,this.mainFrameContext.global,n)}];case"graphing":case"graphing_3d":case"geometry":return this.analyzeSingleStatementGraphing(t,n,hc(this.mainFrameContext,this.statements[t]),r,"main")}}analyzeSingleStatementGraphing(t,n,r,s,i){if(!this.policy.graphingEnabled())throw U("Expected graphing policy");if(i==="main"&&r.r){let a=Tn(r);a.r=void 0;let u=this.statements[t].analyze(this.policy,a,n);if(u.getGraphMode()===6)return[{id:t,stmtAnalysis:u}]}let o=s.recursiveFunctionGroups[t];if(o&&this.recursion){if(i==="regression")for(let u of o){let c=this.statements[u],l=xT(),p={policy:this.policy,rawTree:c,concreteTree:l};return[{id:u,stmtAnalysis:p}]}let a={};for(let u of o)a[u]=this.statements[u];return Ww(this.policy,r,a)}if(i==="regression"){let a=this.statements[t],u=a.tryGetConcreteTree(this.policy,r),c={policy:this.policy,rawTree:a,concreteTree:u};return[{id:t,stmtAnalysis:c}]}else{let a=this.statements[t].analyze(this.policy,r,n);return[{id:t,stmtAnalysis:a}]}}evaluateMetadataForStatement(t,n,r){if(t===sa)return;let s=this.analysis[t],i=s.evaluationState.expression_type;for(let o in wm){let a=o,u=wm[a];this.evaluationMode!=="graphing_3d"&&a==="resolution"||(!u.shouldEvaluate||u.shouldEvaluate(s))&&P5(s,r,n,a)}E5(s,r,n),this.product==="graphing-3d"&&M5(s),this.actions&&m5(s)&&C5(s,r,n),i==="PARAMETRIC"||i==="CURVE3D_xyz_t"||i==="POLAR"||i==="SURFACE_r_\\u03B8z"||i==="SURFACE_r_\\u03B8z_AMBIGUOUS"||i==="SLICE_r\\u03B8z_at_z"?D5(s,r,n):i==="SURFACE_xyz_uv"||i==="SLICE_xyz_uv"||i==="SURFACE_r_\\u03B8\\u03C6"||i==="SURFACE_z_r\\u03B8"||i==="SLICE_zr\\u03B8_at_r"||i==="SLICE_zr\\u03B8_at_\\u03B8"||i==="SLICE_zr\\u03B8_at_xyz"||i==="SLICE_r\\u03B8\\u03C6_at_\\u03B8"||i==="SLICE_r\\u03B8\\u03C6_at_\\u03C6"||i==="SLICE_r\\u03B8\\u03C6_at_xyz"?S5(s,r,n):i==="BOXPLOT"?v5(s,r,n):f5(s)&&T5(s,r,n)}markRegressionAndRecursionDependents(t){for(let n in this.analysis){let r=this.analysis[n];if(ga(r.rawTree)){let s=this.analysis[r.rawTree.tableID];if(!s)continue;let i=s.evaluationState.column_data[r.rawTree.columnIndex];if(!i)continue;i.depends_on_regression=!!t.regressionDependentStatements[n],i.depends_on_recursive_function=!!t.recursionDependentStatements[n]}else r.evaluationState.depends_on_regression=!!t.regressionDependentStatements[n],r.evaluationState.depends_on_recursive_function=!!t.recursionDependentStatements[n]}}processEvents(t){if(!t||!this.actions)return;let n=Tn(this.mainFrameContext.global),r={},s=!1,i=!1,o;for(let a of t)switch(this.globalEventCount+=1,n.globalEventCount=new C.Constant(this.globalEventCount),a.type){case"step":{let c=this.statements[a.expressionId];if(!c)continue;let l=c.tryGetConcreteTree(this.policy,n);i=!0,z1(l,r,n);break}case"click":{let c=this.statements[a.expressionId];if(!c||!c.metaData.clickHandler)continue;n.index=new C.Constant(a.indexVar+1);let l=c.metaData.clickHandler.tryGetConcreteTree(this.policy,n);i=!0,s=!0,z1(l,r,n);break}case"clock-tick":{(o===void 0||a.isFirstTick&&!o.isFirstTick)&&(o=a);break}default:return a}if(o){let a=this.statements[o.id];if(a&&a instanceof C.Ticker){let u=a.minStep.tryGetConcreteTree(this.policy,n,q1).asValue();if(typeof u=="number"&&u>=0&&isFinite(u)){let l=this.lastClockTickTime;if(this.lastClockTickTime=Date.now(),!o.isFirstTick&&l!==void 0){n.dt=new C.Constant(this.lastClockTickTime-l);let p=a.handler.tryGetConcreteTree(this.policy,n);z1(p,r,n)}}}}return{objectClicked:s,userAction:i,updates:r}}postProgressUpdate(t,n){var r;(r=this.sendMessageForProgressUpdate)==null||r.call(this,"evaluatorProgressUpdate",{update:t,ids:n})}};function R5(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}var vF=class{constructor(t){this.context=new tx(t),this.sendMessage=t}processChangeSet(t){let n=this.context.processChangeSet(t);this.sendMessage("processChangeSet",n)}};Object.defineProperty(__dcg_chunk_exports__, \'a\', { get: () => _5 });\nObject.defineProperty(__dcg_chunk_exports__, \'b\', { get: () => L5 });\nObject.defineProperty(__dcg_chunk_exports__, \'c\', { get: () => w5 });\nObject.defineProperty(__dcg_chunk_exports__, \'d\', { get: () => ia });\nObject.defineProperty(__dcg_chunk_exports__, \'e\', { get: () => F5 });\nObject.defineProperty(__dcg_chunk_exports__, \'f\', { get: () => V5 });\nObject.defineProperty(__dcg_chunk_exports__, \'g\', { get: () => Fl });\nObject.defineProperty(__dcg_chunk_exports__, \'h\', { get: () => qm });\nObject.defineProperty(__dcg_chunk_exports__, \'i\', { get: () => XF });\nObject.defineProperty(__dcg_chunk_exports__, \'j\', { get: () => pY });\nObject.defineProperty(__dcg_chunk_exports__, \'k\', { get: () => dY });\nObject.defineProperty(__dcg_chunk_exports__, \'l\', { get: () => Ll });\nObject.defineProperty(__dcg_chunk_exports__, \'m\', { get: () => pD });\nObject.defineProperty(__dcg_chunk_exports__, \'n\', { get: () => ZF });\nObject.defineProperty(__dcg_chunk_exports__, \'o\', { get: () => mY });\nObject.defineProperty(__dcg_chunk_exports__, \'p\', { get: () => yY });\nObject.defineProperty(__dcg_chunk_exports__, \'q\', { get: () => gY });\nObject.defineProperty(__dcg_chunk_exports__, \'r\', { get: () => xY });\nObject.defineProperty(__dcg_chunk_exports__, \'s\', { get: () => TY });\nObject.defineProperty(__dcg_chunk_exports__, \'t\', { get: () => PY });\nObject.defineProperty(__dcg_chunk_exports__, \'u\', { get: () => EY });\nObject.defineProperty(__dcg_chunk_exports__, \'v\', { get: () => ux });\nObject.defineProperty(__dcg_chunk_exports__, \'w\', { get: () => JF });\nObject.defineProperty(__dcg_chunk_exports__, \'x\', { get: () => eV });\nObject.defineProperty(__dcg_chunk_exports__, \'y\', { get: () => SY });\nObject.defineProperty(__dcg_chunk_exports__, \'z\', { get: () => NY });\nObject.defineProperty(__dcg_chunk_exports__, \'A\', { get: () => RY });\nObject.defineProperty(__dcg_chunk_exports__, \'B\', { get: () => gi });\nObject.defineProperty(__dcg_chunk_exports__, \'C\', { get: () => Md });\nObject.defineProperty(__dcg_chunk_exports__, \'D\', { get: () => cV });\nObject.defineProperty(__dcg_chunk_exports__, \'E\', { get: () => ws });\nObject.defineProperty(__dcg_chunk_exports__, \'F\', { get: () => wY });\nObject.defineProperty(__dcg_chunk_exports__, \'G\', { get: () => Vl });\nObject.defineProperty(__dcg_chunk_exports__, \'H\', { get: () => Bl });\nObject.defineProperty(__dcg_chunk_exports__, \'I\', { get: () => fV });\nObject.defineProperty(__dcg_chunk_exports__, \'J\', { get: () => UY });\nObject.defineProperty(__dcg_chunk_exports__, \'K\', { get: () => $Y });\nObject.defineProperty(__dcg_chunk_exports__, \'L\', { get: () => va });\nObject.defineProperty(__dcg_chunk_exports__, \'M\', { get: () => uu });\nObject.defineProperty(__dcg_chunk_exports__, \'N\', { get: () => Hre });\nObject.defineProperty(__dcg_chunk_exports__, \'O\', { get: () => kD });\nObject.defineProperty(__dcg_chunk_exports__, \'P\', { get: () => W1 });\nObject.defineProperty(__dcg_chunk_exports__, \'Q\', { get: () => Bm });\nObject.defineProperty(__dcg_chunk_exports__, \'R\', { get: () => tY });\nObject.defineProperty(__dcg_chunk_exports__, \'S\', { get: () => Oi });\nObject.defineProperty(__dcg_chunk_exports__, \'T\', { get: () => Va });\nObject.defineProperty(__dcg_chunk_exports__, \'U\', { get: () => to });\nObject.defineProperty(__dcg_chunk_exports__, \'V\', { get: () => kF });\nObject.defineProperty(__dcg_chunk_exports__, \'W\', { get: () => rY });\nObject.defineProperty(__dcg_chunk_exports__, \'X\', { get: () => sY });\nObject.defineProperty(__dcg_chunk_exports__, \'Y\', { get: () => si });\nObject.defineProperty(__dcg_chunk_exports__, \'Z\', { get: () => iY });\nObject.defineProperty(__dcg_chunk_exports__, \'_\', { get: () => xi });\nObject.defineProperty(__dcg_chunk_exports__, \'$\', { get: () => $D });\nObject.defineProperty(__dcg_chunk_exports__, \'aa\', { get: () => EX });\nObject.defineProperty(__dcg_chunk_exports__, \'ba\', { get: () => vX });\nObject.defineProperty(__dcg_chunk_exports__, \'ca\', { get: () => hf });\nObject.defineProperty(__dcg_chunk_exports__, \'da\', { get: () => tg });\nObject.defineProperty(__dcg_chunk_exports__, \'ea\', { get: () => fx });\nObject.defineProperty(__dcg_chunk_exports__, \'fa\', { get: () => PV });\nObject.defineProperty(__dcg_chunk_exports__, \'ga\', { get: () => CD });\nObject.defineProperty(__dcg_chunk_exports__, \'ha\', { get: () => yx });\nObject.defineProperty(__dcg_chunk_exports__, \'ia\', { get: () => SD });\nObject.defineProperty(__dcg_chunk_exports__, \'ja\', { get: () => Zm });\nObject.defineProperty(__dcg_chunk_exports__, \'ka\', { get: () => vD });\nObject.defineProperty(__dcg_chunk_exports__, \'la\', { get: () => kl });\nObject.defineProperty(__dcg_chunk_exports__, \'ma\', { get: () => qr });\nObject.defineProperty(__dcg_chunk_exports__, \'na\', { get: () => no });\nObject.defineProperty(__dcg_chunk_exports__, \'oa\', { get: () => oa });\nObject.defineProperty(__dcg_chunk_exports__, \'pa\', { get: () => Ic });\nObject.defineProperty(__dcg_chunk_exports__, \'qa\', { get: () => Oo });\nObject.defineProperty(__dcg_chunk_exports__, \'ra\', { get: () => Cd });\nObject.defineProperty(__dcg_chunk_exports__, \'sa\', { get: () => WY });\nObject.defineProperty(__dcg_chunk_exports__, \'ta\', { get: () => Vs });\nObject.defineProperty(__dcg_chunk_exports__, \'ua\', { get: () => kn });\nObject.defineProperty(__dcg_chunk_exports__, \'va\', { get: () => Qt });\nObject.defineProperty(__dcg_chunk_exports__, \'wa\', { get: () => I });\nObject.defineProperty(__dcg_chunk_exports__, \'xa\', { get: () => De });\nObject.defineProperty(__dcg_chunk_exports__, \'ya\', { get: () => N });\nObject.defineProperty(__dcg_chunk_exports__, \'za\', { get: () => ut });\nObject.defineProperty(__dcg_chunk_exports__, \'Aa\', { get: () => pn });\nObject.defineProperty(__dcg_chunk_exports__, \'Ba\', { get: () => ne });\nObject.defineProperty(__dcg_chunk_exports__, \'Ca\', { get: () => Xn });\nObject.defineProperty(__dcg_chunk_exports__, \'Da\', { get: () => Pt });\nObject.defineProperty(__dcg_chunk_exports__, \'Ea\', { get: () => $e });\nObject.defineProperty(__dcg_chunk_exports__, \'Fa\', { get: () => Ro });\nObject.defineProperty(__dcg_chunk_exports__, \'Ga\', { get: () => ft });\nObject.defineProperty(__dcg_chunk_exports__, \'Ha\', { get: () => Kt });\nObject.defineProperty(__dcg_chunk_exports__, \'Ia\', { get: () => rr });\nObject.defineProperty(__dcg_chunk_exports__, \'Ja\', { get: () => xe });\nObject.defineProperty(__dcg_chunk_exports__, \'Ka\', { get: () => In });\nObject.defineProperty(__dcg_chunk_exports__, \'La\', { get: () => de });\nObject.defineProperty(__dcg_chunk_exports__, \'Ma\', { get: () => xn });\nObject.defineProperty(__dcg_chunk_exports__, \'Na\', { get: () => ce });\nObject.defineProperty(__dcg_chunk_exports__, \'Oa\', { get: () => Wn });\nObject.defineProperty(__dcg_chunk_exports__, \'Pa\', { get: () => ie });\nObject.defineProperty(__dcg_chunk_exports__, \'Qa\', { get: () => Fn });\nObject.defineProperty(__dcg_chunk_exports__, \'Ra\', { get: () => fe });\nObject.defineProperty(__dcg_chunk_exports__, \'Sa\', { get: () => jn });\nObject.defineProperty(__dcg_chunk_exports__, \'Ta\', { get: () => Ne });\nObject.defineProperty(__dcg_chunk_exports__, \'Ua\', { get: () => Vn });\nObject.defineProperty(__dcg_chunk_exports__, \'Va\', { get: () => Le });\nObject.defineProperty(__dcg_chunk_exports__, \'Wa\', { get: () => On });\nObject.defineProperty(__dcg_chunk_exports__, \'Xa\', { get: () => ye });\nObject.defineProperty(__dcg_chunk_exports__, \'Ya\', { get: () => Nn });\nObject.defineProperty(__dcg_chunk_exports__, \'Za\', { get: () => Re });\nObject.defineProperty(__dcg_chunk_exports__, \'_a\', { get: () => Rr });\nObject.defineProperty(__dcg_chunk_exports__, \'$a\', { get: () => le });\nObject.defineProperty(__dcg_chunk_exports__, \'ab\', { get: () => Jn });\nObject.defineProperty(__dcg_chunk_exports__, \'bb\', { get: () => Gt });\nObject.defineProperty(__dcg_chunk_exports__, \'cb\', { get: () => Gs });\nObject.defineProperty(__dcg_chunk_exports__, \'db\', { get: () => R });\nObject.defineProperty(__dcg_chunk_exports__, \'eb\', { get: () => Ue });\nObject.defineProperty(__dcg_chunk_exports__, \'fb\', { get: () => Pn });\nObject.defineProperty(__dcg_chunk_exports__, \'gb\', { get: () => cs });\nObject.defineProperty(__dcg_chunk_exports__, \'hb\', { get: () => z });\nObject.defineProperty(__dcg_chunk_exports__, \'ib\', { get: () => fr });\nObject.defineProperty(__dcg_chunk_exports__, \'jb\', { get: () => wt });\nObject.defineProperty(__dcg_chunk_exports__, \'kb\', { get: () => mr });\nObject.defineProperty(__dcg_chunk_exports__, \'lb\', { get: () => Rn });\nObject.defineProperty(__dcg_chunk_exports__, \'mb\', { get: () => yr });\nObject.defineProperty(__dcg_chunk_exports__, \'nb\', { get: () => Hn });\nObject.defineProperty(__dcg_chunk_exports__, \'ob\', { get: () => Ar });\nObject.defineProperty(__dcg_chunk_exports__, \'pb\', { get: () => ke });\nObject.defineProperty(__dcg_chunk_exports__, \'qb\', { get: () => gr });\nObject.defineProperty(__dcg_chunk_exports__, \'rb\', { get: () => RD });\nObject.defineProperty(__dcg_chunk_exports__, \'sb\', { get: () => Qn });\nObject.defineProperty(__dcg_chunk_exports__, \'tb\', { get: () => RV });\nObject.defineProperty(__dcg_chunk_exports__, \'ub\', { get: () => at });\nObject.defineProperty(__dcg_chunk_exports__, \'vb\', { get: () => oe });\nObject.defineProperty(__dcg_chunk_exports__, \'wb\', { get: () => j });\nObject.defineProperty(__dcg_chunk_exports__, \'xb\', { get: () => Ve });\nObject.defineProperty(__dcg_chunk_exports__, \'yb\', { get: () => vd });\nObject.defineProperty(__dcg_chunk_exports__, \'zb\', { get: () => Qm });\nObject.defineProperty(__dcg_chunk_exports__, \'Ab\', { get: () => se });\nObject.defineProperty(__dcg_chunk_exports__, \'Bb\', { get: () => ua });\nObject.defineProperty(__dcg_chunk_exports__, \'Cb\', { get: () => kt });\nObject.defineProperty(__dcg_chunk_exports__, \'Db\', { get: () => Ae });\nObject.defineProperty(__dcg_chunk_exports__, \'Eb\', { get: () => ny });\nObject.defineProperty(__dcg_chunk_exports__, \'Fb\', { get: () => Ie });\nObject.defineProperty(__dcg_chunk_exports__, \'Gb\', { get: () => wD });\nObject.defineProperty(__dcg_chunk_exports__, \'Hb\', { get: () => FD });\nObject.defineProperty(__dcg_chunk_exports__, \'Ib\', { get: () => Cc });\nObject.defineProperty(__dcg_chunk_exports__, \'Jb\', { get: () => IT });\nObject.defineProperty(__dcg_chunk_exports__, \'Kb\', { get: () => HV });\nObject.defineProperty(__dcg_chunk_exports__, \'Lb\', { get: () => zV });\nObject.defineProperty(__dcg_chunk_exports__, \'Mb\', { get: () => We });\nObject.defineProperty(__dcg_chunk_exports__, \'Nb\', { get: () => Tn });\nObject.defineProperty(__dcg_chunk_exports__, \'Ob\', { get: () => bX });\nObject.defineProperty(__dcg_chunk_exports__, \'Pb\', { get: () => ls });\nObject.defineProperty(__dcg_chunk_exports__, \'Qb\', { get: () => Ts });\nObject.defineProperty(__dcg_chunk_exports__, \'Rb\', { get: () => wB });\nObject.defineProperty(__dcg_chunk_exports__, \'Sb\', { get: () => hr });\nObject.defineProperty(__dcg_chunk_exports__, \'Tb\', { get: () => xE });\nObject.defineProperty(__dcg_chunk_exports__, \'Ub\', { get: () => pp });\nObject.defineProperty(__dcg_chunk_exports__, \'Vb\', { get: () => yp });\nObject.defineProperty(__dcg_chunk_exports__, \'Wb\', { get: () => gp });\nObject.defineProperty(__dcg_chunk_exports__, \'Xb\', { get: () => ZE });\nObject.defineProperty(__dcg_chunk_exports__, \'Yb\', { get: () => WE });\nObject.defineProperty(__dcg_chunk_exports__, \'Zb\', { get: () => EE });\nObject.defineProperty(__dcg_chunk_exports__, \'_b\', { get: () => Z2 });\nObject.defineProperty(__dcg_chunk_exports__, \'$b\', { get: () => Dv });\nObject.defineProperty(__dcg_chunk_exports__, \'ac\', { get: () => j2 });\nObject.defineProperty(__dcg_chunk_exports__, \'bc\', { get: () => Rg });\nObject.defineProperty(__dcg_chunk_exports__, \'cc\', { get: () => Mf });\nObject.defineProperty(__dcg_chunk_exports__, \'dc\', { get: () => jE });\nObject.defineProperty(__dcg_chunk_exports__, \'ec\', { get: () => JE });\nObject.defineProperty(__dcg_chunk_exports__, \'fc\', { get: () => Sv });\nObject.defineProperty(__dcg_chunk_exports__, \'gc\', { get: () => K2 });\nObject.defineProperty(__dcg_chunk_exports__, \'hc\', { get: () => vv });\nObject.defineProperty(__dcg_chunk_exports__, \'ic\', { get: () => eG });\nObject.defineProperty(__dcg_chunk_exports__, \'jc\', { get: () => Ov });\nObject.defineProperty(__dcg_chunk_exports__, \'kc\', { get: () => tG });\nObject.defineProperty(__dcg_chunk_exports__, \'lc\', { get: () => yG });\nObject.defineProperty(__dcg_chunk_exports__, \'mc\', { get: () => bG });\nObject.defineProperty(__dcg_chunk_exports__, \'nc\', { get: () => xG });\nObject.defineProperty(__dcg_chunk_exports__, \'oc\', { get: () => oo });\nObject.defineProperty(__dcg_chunk_exports__, \'pc\', { get: () => Et });\nObject.defineProperty(__dcg_chunk_exports__, \'qc\', { get: () => tt });\nObject.defineProperty(__dcg_chunk_exports__, \'rc\', { get: () => Jr });\nObject.defineProperty(__dcg_chunk_exports__, \'sc\', { get: () => Nu });\nObject.defineProperty(__dcg_chunk_exports__, \'tc\', { get: () => Bo });\nObject.defineProperty(__dcg_chunk_exports__, \'uc\', { get: () => $Z });\nObject.defineProperty(__dcg_chunk_exports__, \'vc\', { get: () => Mk });\nObject.defineProperty(__dcg_chunk_exports__, \'wc\', { get: () => C });\nObject.defineProperty(__dcg_chunk_exports__, \'xc\', { get: () => Dr });\nObject.defineProperty(__dcg_chunk_exports__, \'yc\', { get: () => $j });\nObject.defineProperty(__dcg_chunk_exports__, \'zc\', { get: () => sh });\nObject.defineProperty(__dcg_chunk_exports__, \'Ac\', { get: () => _O });\nObject.defineProperty(__dcg_chunk_exports__, \'Bc\', { get: () => zo });\nObject.defineProperty(__dcg_chunk_exports__, \'Cc\', { get: () => Ta });\nObject.defineProperty(__dcg_chunk_exports__, \'Dc\', { get: () => kf });\nObject.defineProperty(__dcg_chunk_exports__, \'Ec\', { get: () => UO });\nObject.defineProperty(__dcg_chunk_exports__, \'Fc\', { get: () => oK });\nObject.defineProperty(__dcg_chunk_exports__, \'Gc\', { get: () => pe });\nObject.defineProperty(__dcg_chunk_exports__, \'Hc\', { get: () => hK });\nObject.defineProperty(__dcg_chunk_exports__, \'Ic\', { get: () => bK });\nObject.defineProperty(__dcg_chunk_exports__, \'Jc\', { get: () => li });\nObject.defineProperty(__dcg_chunk_exports__, \'Kc\', { get: () => $K });\nObject.defineProperty(__dcg_chunk_exports__, \'Lc\', { get: () => nu });\nObject.defineProperty(__dcg_chunk_exports__, \'Mc\', { get: () => YK });\nObject.defineProperty(__dcg_chunk_exports__, \'Nc\', { get: () => lr });\nObject.defineProperty(__dcg_chunk_exports__, \'Oc\', { get: () => qR });\nObject.defineProperty(__dcg_chunk_exports__, \'Pc\', { get: () => Be });\nObject.defineProperty(__dcg_chunk_exports__, \'Qc\', { get: () => DM });\nObject.defineProperty(__dcg_chunk_exports__, \'Rc\', { get: () => OA });\nObject.defineProperty(__dcg_chunk_exports__, \'Sc\', { get: () => AA });\nObject.defineProperty(__dcg_chunk_exports__, \'Tc\', { get: () => mo });\nObject.defineProperty(__dcg_chunk_exports__, \'Uc\', { get: () => wh });\nObject.defineProperty(__dcg_chunk_exports__, \'Vc\', { get: () => UA });\nObject.defineProperty(__dcg_chunk_exports__, \'Wc\', { get: () => Mi });\nObject.defineProperty(__dcg_chunk_exports__, \'Xc\', { get: () => $z });\nObject.defineProperty(__dcg_chunk_exports__, \'Yc\', { get: () => v_ });\nObject.defineProperty(__dcg_chunk_exports__, \'Zc\', { get: () => eC });\nObject.defineProperty(__dcg_chunk_exports__, \'_c\', { get: () => tC });\nObject.defineProperty(__dcg_chunk_exports__, \'$c\', { get: () => O_ });\nObject.defineProperty(__dcg_chunk_exports__, \'ad\', { get: () => N_ });\nObject.defineProperty(__dcg_chunk_exports__, \'bd\', { get: () => R_ });\nObject.defineProperty(__dcg_chunk_exports__, \'cd\', { get: () => st });\nObject.defineProperty(__dcg_chunk_exports__, \'dd\', { get: () => Cq });\nObject.defineProperty(__dcg_chunk_exports__, \'ed\', { get: () => vC });\nObject.defineProperty(__dcg_chunk_exports__, \'fd\', { get: () => OC });\nObject.defineProperty(__dcg_chunk_exports__, \'gd\', { get: () => NC });\nObject.defineProperty(__dcg_chunk_exports__, \'hd\', { get: () => yb });\nObject.defineProperty(__dcg_chunk_exports__, \'id\', { get: () => gb });\nObject.defineProperty(__dcg_chunk_exports__, \'jd\', { get: () => sc });\nObject.defineProperty(__dcg_chunk_exports__, \'kd\', { get: () => Im });\nObject.defineProperty(__dcg_chunk_exports__, \'ld\', { get: () => _L });\nObject.defineProperty(__dcg_chunk_exports__, \'md\', { get: () => Em });\nObject.defineProperty(__dcg_chunk_exports__, \'nd\', { get: () => Db });\nObject.defineProperty(__dcg_chunk_exports__, \'od\', { get: () => Jse });\nObject.defineProperty(__dcg_chunk_exports__, \'pd\', { get: () => u8 });\nObject.defineProperty(__dcg_chunk_exports__, \'qd\', { get: () => eie });\nObject.defineProperty(__dcg_chunk_exports__, \'rd\', { get: () => sie });\nObject.defineProperty(__dcg_chunk_exports__, \'sd\', { get: () => iie });\nObject.defineProperty(__dcg_chunk_exports__, \'td\', { get: () => wL });\nObject.defineProperty(__dcg_chunk_exports__, \'ud\', { get: () => oie });\nObject.defineProperty(__dcg_chunk_exports__, \'vd\', { get: () => uie });\nObject.defineProperty(__dcg_chunk_exports__, \'wd\', { get: () => cie });\nObject.defineProperty(__dcg_chunk_exports__, \'xd\', { get: () => VL });\nObject.defineProperty(__dcg_chunk_exports__, \'yd\', { get: () => kL });\nObject.defineProperty(__dcg_chunk_exports__, \'zd\', { get: () => Sb });\nObject.defineProperty(__dcg_chunk_exports__, \'Ad\', { get: () => HL });\nObject.defineProperty(__dcg_chunk_exports__, \'Bd\', { get: () => zL });\nObject.defineProperty(__dcg_chunk_exports__, \'Cd\', { get: () => UL });\nObject.defineProperty(__dcg_chunk_exports__, \'Dd\', { get: () => Pie });\nObject.defineProperty(__dcg_chunk_exports__, \'Ed\', { get: () => Eie });\nObject.defineProperty(__dcg_chunk_exports__, \'Fd\', { get: () => c8 });\nObject.defineProperty(__dcg_chunk_exports__, \'Gd\', { get: () => Mie });\nObject.defineProperty(__dcg_chunk_exports__, \'Hd\', { get: () => Cie });\nObject.defineProperty(__dcg_chunk_exports__, \'Id\', { get: () => JC });\nObject.defineProperty(__dcg_chunk_exports__, \'Jd\', { get: () => Ob });\nObject.defineProperty(__dcg_chunk_exports__, \'Kd\', { get: () => l8 });\nObject.defineProperty(__dcg_chunk_exports__, \'Ld\', { get: () => qL });\nObject.defineProperty(__dcg_chunk_exports__, \'Md\', { get: () => p8 });\nObject.defineProperty(__dcg_chunk_exports__, \'Nd\', { get: () => $L });\nObject.defineProperty(__dcg_chunk_exports__, \'Od\', { get: () => vb });\nObject.defineProperty(__dcg_chunk_exports__, \'Pd\', { get: () => f8 });\nObject.defineProperty(__dcg_chunk_exports__, \'Qd\', { get: () => QC });\nObject.defineProperty(__dcg_chunk_exports__, \'Rd\', { get: () => Cl });\nObject.defineProperty(__dcg_chunk_exports__, \'Sd\', { get: () => m8 });\nObject.defineProperty(__dcg_chunk_exports__, \'Td\', { get: () => y8 });\nObject.defineProperty(__dcg_chunk_exports__, \'Ud\', { get: () => Aie });\nObject.defineProperty(__dcg_chunk_exports__, \'Vd\', { get: () => b8 });\nObject.defineProperty(__dcg_chunk_exports__, \'Wd\', { get: () => JL });\nObject.defineProperty(__dcg_chunk_exports__, \'Xd\', { get: () => A8 });\nObject.defineProperty(__dcg_chunk_exports__, \'Yd\', { get: () => Ab });\nObject.defineProperty(__dcg_chunk_exports__, \'Zd\', { get: () => bw });\nObject.defineProperty(__dcg_chunk_exports__, \'_d\', { get: () => Voe });\nObject.defineProperty(__dcg_chunk_exports__, \'$d\', { get: () => Boe });\nObject.defineProperty(__dcg_chunk_exports__, \'ae\', { get: () => Id });\nObject.defineProperty(__dcg_chunk_exports__, \'be\', { get: () => wa });\nObject.defineProperty(__dcg_chunk_exports__, \'ce\', { get: () => i$ });\nObject.defineProperty(__dcg_chunk_exports__, \'de\', { get: () => pae });\nObject.defineProperty(__dcg_chunk_exports__, \'ee\', { get: () => l$ });\nObject.defineProperty(__dcg_chunk_exports__, \'fe\', { get: () => F1 });\nObject.defineProperty(__dcg_chunk_exports__, \'ge\', { get: () => tF });\nObject.defineProperty(__dcg_chunk_exports__, \'he\', { get: () => nF });\nObject.defineProperty(__dcg_chunk_exports__, \'ie\', { get: () => yF });\nObject.defineProperty(__dcg_chunk_exports__, \'je\', { get: () => gF });\nObject.defineProperty(__dcg_chunk_exports__, \'ke\', { get: () => Lm });\nObject.defineProperty(__dcg_chunk_exports__, \'le\', { get: () => K$ });\nObject.defineProperty(__dcg_chunk_exports__, \'me\', { get: () => e5 });\nObject.defineProperty(__dcg_chunk_exports__, \'ne\', { get: () => TF });\nObject.defineProperty(__dcg_chunk_exports__, \'oe\', { get: () => jle });\nObject.defineProperty(__dcg_chunk_exports__, \'pe\', { get: () => tx });\nObject.defineProperty(__dcg_chunk_exports__, \'qe\', { get: () => G5 });\nObject.defineProperty(__dcg_chunk_exports__, \'re\', { get: () => vF });\n\n    return __dcg_chunk_exports__;\n  })();',__dcg_shared_module_exports__=eval(__dcg_shared_module_source__),__dcg_worker_source_exports__=function(){const e=`
      // store the code for the worker module as a function that takes the shared module exports as an argument
      const __dcg_worker_module__ = (__dcg_shared_module_exports__) => {
var n={};__dcg_shared_module_exports__['qe'].log=function(e){self.postMessage({log:JSON.stringify(e)})};var o=self;o.window=o;o.onmessage=function(e){let s=e.data&&e.data.connectionId;if(s)if(e.data.originalMessage.type==="destroy")delete n[s];else{let a=n[s];a||(a=new __dcg_shared_module_exports__['re']((r,g)=>{o.postMessage({connectionId:s,originalMessage:{type:r,payload:g}})}),n[s]=a),a.processChangeSet(e.data.originalMessage)}};o.loadMessageQueue&&(o.loadMessageQueue.forEach(e=>{o.onmessage(e)}),delete o.loadMessageQueue);

      };
      // execute the shared module store its exports
      const __dcg_worker_shared_module_exports__ = ${__dcg_shared_module_source__};
      // call the worker module, passing in the shared module exports
      __dcg_worker_module__(__dcg_worker_shared_module_exports__);`;let t;return typeof Blob!="undefined"&&URL&&typeof URL.createObjectURL=="function"?t=()=>{const r=URL.createObjectURL(new Blob([e],{type:"application/javascript"})),n=new Worker(r);return n.revokeObjectURL=()=>{URL.revokeObjectURL(r)},n}:t=()=>{new Function(e)()},{createWorker:t,default:{createWorker:t}}}();var iB=__dcg_shared_module_exports__.b(()=>{}),nB=__dcg_shared_module_exports__.b(()=>{}),aB=__dcg_shared_module_exports__.b(()=>{}),sB=__dcg_shared_module_exports__.b(()=>{}),lB=__dcg_shared_module_exports__.b(()=>{}),cB=__dcg_shared_module_exports__.b(()=>{}),dB=__dcg_shared_module_exports__.b(()=>{}),pB=__dcg_shared_module_exports__.b(()=>{}),uB=__dcg_shared_module_exports__.b(()=>{}),hB=__dcg_shared_module_exports__.b(()=>{}),gB=__dcg_shared_module_exports__.b(()=>{}),mB=__dcg_shared_module_exports__.b(()=>{}),fB=__dcg_shared_module_exports__.b(()=>{}),bB=__dcg_shared_module_exports__.b(()=>{nB(),aB(),sB(),lB(),cB(),dB(),pB(),uB(),hB(),gB(),mB(),fB()}),wQ,yB=__dcg_shared_module_exports__.b(()=>{wQ=["education","commercial","generic","prospect"],[...wQ]}),xB=__dcg_shared_module_exports__.b(()=>{});function $M(e){let t={};for(let r in e)t[r]=e[r].getAuthoringConfig();return t}function qx(e,t,r={}){let n=r[e]||e==="validation";return`"${e}"${n?"?":""}:${t}`}var Hx,Su,pt,Vi,lS,cS,dS,jM,hg,wB=__dcg_shared_module_exports__.b(()=>{Hx=class{},Su=class extends Hx{constructor(){super(...arguments),this._conditionalAttributes=new Map,this.arrayBoundsChecks=[],this.latexs=[],this.labels=[]}parser(e){return this.validation=e,this}conditionalAttributes(e,t){return this._conditionalAttributes.set(e,t),this}ensureWithinArrayBounds(e){return this.arrayBoundsChecks.push(e),this}ensureWithinRange(e,t){return this.numberRange={min:e,max:t},this}latex(e){return this.latexs.push(e),this}label(e){return this.labels.push(e),this}validateReferences({validator:e,path:t,value:r,concreteCtx:n}){if(this.arrayBoundsChecks.length)if(!(typeof r=="number"&&r>=1&&Number.isInteger(r)))e.reportError(t,"array index must be an integer of at least 1. Got: "+r);else for(let i of this.arrayBoundsChecks){let o=[];for(let a of n.nodes)a.type==="array"&&a.node===i&&o.push(a.rawValue.length);if(o.length!==1)e.reportError(t,"expected exactly 1 array reference. got: "+o.length);else{let a=o[0];r>a&&e.reportError(t,"expected to be at most "+a+", got: "+r)}}}addGraphMutations({validator:e,path:t,value:r,graphMutations:n}){for(let i of this.latexs)typeof r=="string"||typeof r=="number"?n.push({type:"value",identifier:i,value:r+""}):typeof r=="boolean"?n.push({type:"value",identifier:i,value:r?"1":"0"}):e.reportError(t,"unexpected latexValue mutation value type:  "+typeof r);for(let i of this.labels)typeof r=="string"?n.push({type:"label",identifier:i,value:r+""}):e.reportError(t,"unexpected label mutation value type:  "+typeof r)}parseString({path:e,subData:t,validator:r}){let n=t;if(!this.validation)return r.reportError(e,'has no validation. Use "string" for no validation'),n;if(r.shouldSkipParsingDataVariable(r))return n;if(typeof this.validation=="object")return n in this.validation?this.validation[n]:(r.reportError(e,"unknown type: "+n),n);switch(this.validation){case"string":return n;case"number":if(!/^-?[0-9]*[.]?[0-9]*$/.test(n)||!/[0-9]/g.test(n))return r.reportError(e,"expected to be a number but it was not: "+n),NaN;let i=parseFloat(n);return this.numberRange&&(i<this.numberRange.min||i>this.numberRange.max)?(r.reportError(e,"expected to be between "+this.numberRange.min+" and "+this.numberRange.max+" but was: "+n),NaN):i;default:this.validation;break}return n}},pt=class extends Hx{constructor(e){super(),this.config=e,this.computedConditionalAttributes=[];for(let r in this.config.attributes){let n=this.config.attributes[r];if(n instanceof Su){let i=n._conditionalAttributes;if(i.size>0){let o=[];for(let[a,s]of i.entries())o.push({value:a,attributes:s});this.computedConditionalAttributes.push({attribute_key:r,conditions:o})}}}let t=[];for(let r of this.computedConditionalAttributes){let n=[];for(let i of r.conditions){for(let o in i.attributes){let a=i.attributes[o];if(a instanceof Su&&a._conditionalAttributes.size)throw new Error("cannot have nested conditional attributes. Must route through object")}n.push({value:i.value,attributes:$M(i.attributes)})}t.push({attribute_key:r.attribute_key,conditions:n})}this.authoringConfig={type:"object",name:e.name,attributes:$M(e.attributes),conditional_attributes:t}}getAuthoringConfig(){return this.authoringConfig}getTypescriptType(){let e=[],t=[];for(let r in this.config.attributes)t.push(qx(r,this.config.attributes[r].getTypescriptType()));e.push(`{
`+t.join(`,
`)+`
}`);for(let r of this.computedConditionalAttributes){let n=[],i=this.config.attributes[r.attribute_key];if(!i)throw new Error("did not find attribute_key in attributes");if(!(i instanceof Su))throw new Error("attribute_key must be a primitive attribute");let o=i.getEnumerableValues();if(!o)throw new Error("attribute_key must have a finite, enumerable set of values");let a=new Set(o);for(let s of r.conditions){if(t=[],t.push(qx(r.attribute_key,JSON.stringify(s.value))),a.has(s.value))a.delete(s.value);else throw new Error("conditional_attribute specified value multiple time: "+s.value);for(let l in s.attributes)t.push(qx(l,s.attributes[l].getTypescriptType()));n.push(`{
`+t.join(`,
`)+`
}`)}if(a.size)for(let s of a)n.push(`{
${qx(r.attribute_key,JSON.stringify(s))}}`);e.push("("+n.join(" | ")+")")}return e.length>1?"("+e.join(" & ")+")":e[0]}toConcrete({validator:e,path:t,rawValue:r,concreteCtx:n}){if(!r||typeof r!="object"){e.reportError(t,"should be an object");return}let i={};for(let s in this.config.attributes)i[s]=this.config.attributes[s].toConcrete({path:t+"."+s,validator:e,rawValue:r[s],concreteCtx:n});for(let{attribute_key:s,conditions:l}of this.computedConditionalAttributes)for(let{attributes:c,value:d}of l)if(r[s]===d)for(let u in c)i[u]=c[u].toConcrete({path:t+"."+u,validator:e,rawValue:r[u],concreteCtx:n});let o={};for(let s in i){let l=i[s];l?o[s]=l.parsedValue:o[s]=void 0}let a={type:"object",path:t,rawValue:i,parsedValue:o,node:this};return n.nodes.push(a),a}},Vi=class extends Hx{constructor(e){super(),this.config=e;let t;("minimum"in e||"maximum"in e)&&(t={maximum:e.maximum,minimum:e.minimum}),this.authoringConfig={type:"array",required:!0,name:e.name,count:t,items:e.items.getAuthoringConfig()}}getAuthoringConfig(){return this.authoringConfig}getTypescriptType(){return`(${this.config.items.getTypescriptType()})[]`}toConcrete({validator:e,path:t,rawValue:r,concreteCtx:n}){if(!Array.isArray(r)){e.reportError(t,"should be an array");return}let i=r.map((s,l)=>this.config.items.toConcrete({path:t+"["+l+"]",validator:e,rawValue:s,concreteCtx:n})),o=i.map(s=>{if(s)return s.parsedValue}),a={type:"array",path:t,rawValue:i,parsedValue:o,node:this};return n.nodes.push(a),a}},lS=class extends Su{constructor(e){super(),this.authoringConfig={type:"string",element:"editor",required:!0,name:e.name,default:e.default}}getAuthoringConfig(){return this.authoringConfig}getEnumerableValues(){if(typeof this.validation=="object")return Object.keys(this.validation)}getTypescriptType(){let e=this.getEnumerableValues();return e?e.map(t=>JSON.stringify(t)).join(" | "):"string"}toConcrete({validator:e,path:t,rawValue:r,concreteCtx:n}){if(typeof r!="string"){e.reportError(t,"should be a string");return}let i=this.parseString({path:t,subData:r,validator:e}),o={type:"string",path:t,rawValue:r,parsedValue:i,node:this};return n.nodes.push(o),o}},cS=class extends Su{constructor(e){super(),this.authoringConfig={type:"string",element:"select",required:!0,name:e.name,default:e.default,options:e.options}}getAuthoringConfig(){return this.authoringConfig}getEnumerableValues(){return this.authoringConfig.options.map(e=>e.value)}getTypescriptType(){return this.getEnumerableValues().map(e=>`"${e}"`).join(" | ")}toConcrete({validator:e,path:t,rawValue:r,concreteCtx:n}){if(typeof r!="string"){e.reportError(t,"should be a string");return}if(!this.authoringConfig.options.find(a=>a.value===r)){e.reportError(t,"value must be one of the select options: "+r);return}let i=this.parseString({path:t,subData:r,validator:e}),o={type:"select",path:t,rawValue:r,parsedValue:i,node:this};return n.nodes.push(o),o}},dS=class extends Su{constructor(e){super(),this.authoringConfig={type:"boolean",required:!0,name:e.name,default:e.default}}getAuthoringConfig(){return this.authoringConfig}getEnumerableValues(){return[!0,!1]}getTypescriptType(){return"boolean"}toConcrete({validator:e,path:t,rawValue:r,concreteCtx:n}){if(typeof r!="boolean"){e.reportError(t,"should be a boolean");return}let i={type:"boolean",path:t,rawValue:r,parsedValue:r,node:this};return n.nodes.push(i),i}},jM=class{constructor(e){this.shouldExpectDataVariables=e,this.errors=[]}hasErrors(){return!!this.errors.length}getErrors(){return this.errors}reportError(e,t){this.errors.push(e+" - "+t)}shouldSkipParsingDataVariable(e){return this.shouldExpectDataVariables?!!(typeof e=="string"&&e.includes("{{var:")):!1}},hg=class{constructor(e){this.optionalSections={},this.config={};for(let t in e){let r=e[t],n=t;n.endsWith("?")&&(n=n.slice(0,t.length-1),this.optionalSections[n]=!0),this.config[n]=r}this.authoringConfig=$M(this.config)}getAuthoringConfig(){return this.authoringConfig}inflateWithData(e,t){let r=new jM(e),n={nodes:[]};for(let o in this.config)this.config[o].toConcrete({path:o,rawValue:t[o],validator:r,concreteCtx:n});if(r.hasErrors())return{type:"errors",errors:r.getErrors()};let i=[];for(let o of n.nodes)switch(o.type){case"array":case"object":break;case"boolean":case"select":case"string":o.node.validateReferences({path:o.path,validator:r,value:o.parsedValue,concreteCtx:n}),o.node.addGraphMutations({path:o.path,value:o.parsedValue,validator:r,graphMutations:i});break}return r.hasErrors()?{type:"errors",errors:r.getErrors()}:{type:"results",graphMutations:i}}getTypescriptType(){let e=[];for(let t in this.config)e.push(qx(t,this.config[t].getTypescriptType(),this.optionalSections));return`{
`+e.join(`,
`)+`
}`}}});function dp(e,t){return new lS({name:e,default:t})}function Ft(e,t){return dp(e,t).parser("number")}function er(e,t){return dp(e,t).parser("string")}function vB(e,t){return dp(e,t).parser("number").ensureWithinRange(-1,1)}function YM(e,t){return dp(e,t).parser({left:1,mid:2,right:3})}function Kx(e,t){return dp(e,t).parser({lowest:1,lower:2,low:3,mid:4,high:5,higher:6,highest:7})}function vQ(e,t){return dp(e,t).parser({small:1,medium:2,large:3})}function Mt(e,t){return new dS({name:e,default:t})}function lf(e,t,r){return new cS({name:e,default:t,options:r}).parser("string")}function la(e,t){return lf(e,t||"blue",[{label:"Blue",value:"blue"},{label:"Green",value:"green"},{label:"Orange",value:"orange"},{label:"Purple",value:"purple"},{label:"Black",value:"black"},{label:"Red",value:"red"},{label:"Gray",value:"gray"}]).parser({blue:"1",green:"2",orange:"3",purple:"4",black:"5",red:"6",gray:"7"})}function CQ(e){return lf(e,"solid",[{label:"Solid",value:"solid"},{label:"Dashed",value:"dashed"},{label:"Dotted",value:"dotted"}]).parser({solid:"1",dashed:"2",dotted:"3"})}function CB(e){return dp(e,"attainable").parser({attainable:1,unattainable:2,efficient:3})}function Al(e){return dp(e,"none").parser({none:0,negative:-1,positive:1})}function TB(e){return dp(e,"standard").parser({horizontal:"1",gradual:"2",standard:"3",steep:"4",vertical:"5"})}function gg(e,t){return lf(e,t||"none",[{label:"None",value:"none"},{label:"X",value:"x"},{label:"Y",value:"y"},{label:"Both",value:"both"}]).parser({none:"0",x:"1",y:"2",both:"3"})}var pS,uS,hS,SQ,SB,EB,EQ,TQ,DQ,kQ,_Q,IQ,AQ,gS,DB=__dcg_shared_module_exports__.b(()=>{wB(),pS=new pt({name:"Horizontal Axis",attributes:{min:Ft("X Min","0").latex("x_{min}"),max:Ft("X Max","50").latex("x_{max}"),res:Ft("X Res","5").latex("x_{res}"),major_grid:Ft("X Major Grid","5").latex("x_{majorGrid}"),label:er("X Axis Label","Good 1").label("x_{label}"),tickmark_interval:Ft("X Tickmarks","5").latex("x_{tick}"),label_interval:Ft("X Labels","5").latex("x_{labelInt}")}}),uS=new pt({name:"Vertical Axis",attributes:{min:Ft("Y Min","0").latex("y_{min}"),max:Ft("Y Max","50").latex("y_{max}"),res:Ft("Y Res","5").latex("y_{res}"),major_grid:Ft("Y Major Grid","5").latex("y_{majorGrid}"),label:er("Y Axis Label","Good 2").label("y_{label}"),tickmark_interval:Ft("Y Tickmarks","5").latex("y_{tick}"),label_interval:Ft("Y Labels","5").latex("y_{labelInt}")}}),hS=new pt({name:"Graph Properties",attributes:{title:er("Graph Title","Graph Title").label("p_{Title}")}}),SQ=new pt({name:"Endpoint Mover",attributes:{appearance:lf("Appearance","1",[{label:"Concave Downward",value:"1"},{label:"Linear",value:"2"},{label:"Concave Upward",value:"3"}]).parser({1:"1",concaveUp:"1",2:"2",linear:"2",3:"3",concaveDown:"3"}),color:la("Color"),style:CQ("Style"),given:Mt("Given",!0).conditionalAttributes(!0,{x_shift:Al("xShift"),y_shift:Al("yShift"),label:er("Label","")}).conditionalAttributes(!1,{group_label:er("Label",""),validation:new pt({attributes:{x_shift:Al("xShift"),y_shift:Al("yShift")}})}),group_points:new Vi({name:"Endpoint Mover Points",maximum:3,items:new pt({attributes:{color:la("Color"),label:er("label",""),given:Mt("Given",!0).conditionalAttributes(!0,{type:CB("Type")}).conditionalAttributes(!1,{validation:new pt({attributes:{type:CB("Type")}})}),show_coords:Mt("Show Coords",!1)}})})}}),SB=new Vi({name:"Increasing Lines",items:new pt({attributes:{color:la("Color","orange"),scale:Ft("Scale","1"),type:TB("Type"),label:er("Label",""),ghost_label:er("Ghost Label",""),post_shift_label:er("Post Shift Label",""),given:Mt("Given",!0).conditionalAttributes(!1,{validation:new pt({attributes:{shift:Al("Shift")}}),shifter_point:new pt({attributes:{show:Mt("Shifter Point",!1).conditionalAttributes(!0,{drop_lines:gg("Drop Lines","none"),label:er("Label",""),ghost_label:er("Ghost Label",""),post_shift_label:er("Post Shift Label",""),validation:new pt({attributes:{shift:Al("Shift")}})})}})}).conditionalAttributes(!0,{shift:Al("Shift"),shifter_point:new pt({attributes:{show:Mt("Shifter Point",!1).conditionalAttributes(!0,{drop_lines:gg("Drop Lines","none"),label:er("Label",""),ghost_label:er("Ghost Label",""),post_shift_label:er("Post Shift Label",""),shift:Al("Shift")})}})})}})}),EB=new Vi({name:"Decreasing Lines",items:new pt({attributes:{color:la("Color"),scale:Ft("Scale","1"),type:TB("Type"),label:er("Label",""),ghost_label:er("Ghost Label",""),post_shift_label:er("Post Shift Label",""),given:Mt("Given",!0).conditionalAttributes(!1,{validation:new pt({attributes:{shift:Al("Shift")}}),shifter_point:new pt({attributes:{show:Mt("Shifter Point",!1).conditionalAttributes(!0,{drop_lines:gg("Drop Lines","none"),label:er("Label",""),ghost_label:er("Ghost Label",""),post_shift_label:er("Post Shift Label",""),validation:new pt({attributes:{shift:Al("Shift")}})})}})}).conditionalAttributes(!0,{shift:Al("Shift"),shifter_point:new pt({attributes:{show:Mt("Shifter Point",!1).conditionalAttributes(!0,{drop_lines:gg("Drop Lines","none"),label:er("Label",""),ghost_label:er("Ghost Label",""),post_shift_label:er("Post Shift Label",""),shift:Al("Shift")})}})})}})}),EQ=new pt({name:"Shifter",attributes:{increasing_lines:SB,decreasing_lines:EB,shifter_intersections:new Vi({name:"Intersections",items:new pt({attributes:{increasing_line:Ft("Increasing Line","1").ensureWithinArrayBounds(SB),decreasing_line:Ft("Decreasing Line","1").ensureWithinArrayBounds(EB),drop_lines:gg("Drop Lines","both"),show_coords:Mt("Show Coords",!1),show_point:Mt("Show Point",!0)}})})}}),TQ=new pt({name:"Cost Curves",attributes:{role:lf("Role","taker",[{label:"Price Taker",value:"taker"},{label:"Price Setter Upward MC",value:"setter-upward"},{label:"Price Setter Constant MC",value:"setter-constant"}]).conditionalAttributes("taker",{mc:new pt({attributes:{horizontal:YM("MC Horizontal Alignment","mid"),vertical:Kx("MC Vertical Alignment","mid"),show:Mt("Show MC",!0).conditionalAttributes(!0,{label:er("MC Label","MC"),color:la("MC Color","orange")})}}),avc:new pt({attributes:{vertical:Kx("AVC Vertical Alignment","mid"),show:Mt("Show AVC",!0).conditionalAttributes(!0,{label:er("AVC Label","AVC"),color:la("AVC Color","purple")})}}),atc:new pt({attributes:{show:Mt("Show ATC",!0).conditionalAttributes(!0,{label:er("ATC Label","ATC"),color:la("ATC Color","green")})}})}).conditionalAttributes("setter-upward",{mc:new pt({attributes:{horizontal:YM("MC Horizontal Alignment","mid"),vertical:Kx("MC Vertical Alignment","mid"),show:Mt("Show MC",!0).conditionalAttributes(!0,{label:er("MC Label","MC"),color:la("MC Color","orange")})}}),avc:new pt({attributes:{show:Mt("Show AVC",!0).conditionalAttributes(!0,{label:er("AVC Label","AVC"),color:la("AVC Color","purple")})}}),atc:new pt({attributes:{horizontal:YM("ATC Horizontal Alignment","mid"),vertical:Kx("ATC Vertical Alignment","mid"),show:Mt("Show ATC",!0).conditionalAttributes(!0,{label:er("ATC Label","ATC"),color:la("ATC Color","green")})}})}).conditionalAttributes("setter-constant",{mc:new pt({attributes:{vertical:Kx("MC Vertical Alignment","mid"),show:Mt("Show MC",!0).conditionalAttributes(!0,{label:er("MC Label","MC"),color:la("MC Color","orange")})}}),atc:new pt({attributes:{show:Mt("Show ATC",!0).conditionalAttributes(!0,{label:er("ATC Label","ATC"),color:la("ATC Color","green")})}}),fc_scale:vQ("FC Scale","medium")})}}),DQ=new pt({attributes:{color:la("Color"),connected:Mt("Connected",!1),given:Mt("Given",!0).conditionalAttributes(!0,{when_given:new pt({attributes:{group_points:new Vi({name:"Group Points",minimum:1,items:new pt({name:"Group Points",attributes:{x_coord:Ft("X",""),y_coord:Ft("Y",""),label:er("label",""),drop_lines:gg("Drop Lines"),show_point:Mt("Show Point",!0).conditionalAttributes(!0,{show_coords:Mt("Show Coords",!1)})}})})}})}).conditionalAttributes(!1,{when_required:new pt({attributes:{group_label:er("Group Label",""),group_points:new Vi({name:"Group Points",minimum:1,items:new pt({name:"Group Points",attributes:{drop_lines:gg("Drop Lines"),show_coords:Mt("Show Coords",!1),validation:new pt({attributes:{x_coord:Ft("X",""),y_coord:Ft("Y","")}})}})})}})})}}),kQ=new pt({attributes:{color:la("Color"),given:Mt("Given",!0).conditionalAttributes(!0,{when_given:new pt({attributes:{group_lines:new Vi({name:"Group Lines",minimum:1,items:new pt({attributes:{show_x_int:Mt("Show X Intercept",!1),show_y_int:Mt("Show Y Intercept",!1),show_slope:Mt("Show Slope",!1),use_slope:Mt("Use Slope",!0).conditionalAttributes(!0,{when_slope:new pt({attributes:{x_coord_1:Ft("X1",""),y_coord_1:Ft("Y1",""),label_1:er("Label",""),slope:Ft("Slope","")}})}).conditionalAttributes(!1,{when_not_slope:new pt({attributes:{x_coord_1:Ft("X1",""),y_coord_1:Ft("Y1",""),label_1:er("Label",""),x_coord_2:Ft("X2",""),y_coord_2:Ft("Y2",""),label_2:er("Label","")}})}),show_points:Mt("Show Points",!0).conditionalAttributes(!0,{show_coords:Mt("Show Coords",!1)})}})})}})}).conditionalAttributes(!1,{when_required:new pt({attributes:{group_label:er("Group Label",""),group_lines:new Vi({name:"Group Lines",minimum:1,items:new pt({attributes:{show_coords:Mt("Show Coords",!1),show_x_int:Mt("Show X Intercept",!1),show_y_int:Mt("Show Y Intercept",!1),show_slope:Mt("Show Slope",!1),use_slope:Mt("Use Slope",!0).conditionalAttributes(!0,{when_slope:new pt({attributes:{validation:new pt({attributes:{x_coord_1:Ft("X1",""),y_coord_1:Ft("Y1",""),slope:Ft("slope","")}})}})}).conditionalAttributes(!1,{when_not_slope:new pt({attributes:{validation:new pt({attributes:{x_coord_1:Ft("X1",""),y_coord_1:Ft("Y1",""),x_coord_2:Ft("X2",""),y_coord_2:Ft("Y2","")}})}})})}})})}})})}}),_Q=new pt({attributes:{color:la("Color"),given:Mt("Given",!0).conditionalAttributes(!0,{when_given:new pt({attributes:{group_curves:new Vi({name:"Group Curves",minimum:1,items:new pt({attributes:{curve_points:new Vi({name:"Curve Points",minimum:3,maximum:6,items:new pt({attributes:{x_coord:Ft("X",""),y_coord:Ft("Y",""),label:er("Label","")}})}),show_points:Mt("Show Points",!0).conditionalAttributes(!0,{show_coords:Mt("Show Coords",!1)})}})})}})}).conditionalAttributes(!1,{when_required:new pt({attributes:{group_label:er("Group Label",""),group_curves:new Vi({minimum:1,name:"Group Curves",items:new pt({attributes:{show_coords:Mt("Show Coords",!1),curve_points:new Vi({name:"Curve Points",minimum:3,maximum:6,items:new pt({attributes:{validation:new pt({attributes:{x_coord:Ft("X",""),y_coord:Ft("Y","")}})}})})}})})}})})}}),IQ=new pt({attributes:{color:la("Color"),given:Mt("Given",!0).conditionalAttributes(!0,{when_given:new pt({attributes:{group_mono_arcs:new Vi({name:"Group Monotonic Arcs",minimum:1,items:new pt({attributes:{concavity:vB("Concavity",""),x_coord_1:Ft("X1",""),y_coord_1:Ft("Y1",""),label_1:er("Label 1",""),x_coord_2:Ft("X2",""),y_coord_2:Ft("Y2",""),label_2:er("Label 2",""),show_points:Mt("Show Points",!0).conditionalAttributes(!0,{show_coords:Mt("Show Coords",!1)})}})})}})}).conditionalAttributes(!1,{when_required:new pt({attributes:{group_label:er("Group Label",""),group_mono_arcs:new Vi({minimum:1,name:"Group Monotonic Arcs",items:new pt({attributes:{show_coords:Mt("Show Coords",!1),concavity:vB("Concavity",""),validation:new pt({attributes:{x_coord_1:Ft("X",""),y_coord_1:Ft("Y",""),x_coord_2:Ft("X",""),y_coord_2:Ft("Y","")}})}})})}})})}}),AQ=new pt({attributes:{color:la("Color"),given:Mt("Given",!0).conditionalAttributes(!0,{when_given:new pt({attributes:{group_polygons:new Vi({name:"Group Polygons",minimum:1,items:new pt({attributes:{show_area:Mt("Show Area",!1),show_perimeter:Mt("Show Perimeter",!1),fill_pattern:Mt("Fill Pattern",!0),polygon_points:new Vi({name:"Polygon Points",minimum:3,maximum:10,items:new pt({attributes:{x_coord:Ft("X",""),y_coord:Ft("Y",""),label:er("Label","")}})}),show_points:Mt("Show Points",!0).conditionalAttributes(!0,{show_coords:Mt("Show Coords",!1)})}})})}})}).conditionalAttributes(!1,{when_required:new pt({attributes:{group_label:er("Group Label",""),group_polygons:new Vi({minimum:1,name:"Group Polygons",items:new pt({attributes:{show_coords:Mt("Show Coords",!1),show_area:Mt("Show Area",!1),show_perimeter:Mt("Show Perimeter",!1),fill_pattern:Mt("Fill Pattern",!0),polygon_points:new Vi({name:"Polygon Points",minimum:3,maximum:10,items:new pt({attributes:{validation:new pt({attributes:{x_coord:Ft("X",""),y_coord:Ft("Y","")}})}})})}})})}})})}}),gS=new Vi({name:"Common Components",items:new pt({name:"Common Component",attributes:{object_type:lf("Component Type","common_point",[{label:"Point",value:"common_point"},{label:"Line",value:"common_line"},{label:"Curve",value:"common_curve"},{label:"Monotonic Arc",value:"common_mono_arc"},{label:"Polygon",value:"common_polygon"}]).conditionalAttributes("common_point",{when_point:DQ}).conditionalAttributes("common_line",{when_line:kQ}).conditionalAttributes("common_curve",{when_curve:_Q}).conditionalAttributes("common_mono_arc",{when_mono_arc:IQ}).conditionalAttributes("common_polygon",{when_polygon:AQ})}})}),new hg({dcg_x_axis:pS,dcg_y_axis:uS,dcg_graph_properties:hS,dcg_common_components:gS}),new hg({dcg_x_axis:pS,dcg_y_axis:uS,dcg_graph_properties:hS,dcg_common_components:gS,dcg_endpoint_mover:SQ}),new hg({dcg_x_axis:pS,dcg_y_axis:uS,dcg_graph_properties:hS,dcg_common_components:gS,dcg_shifter:EQ}),new hg({dcg_x_axis:pS,dcg_y_axis:uS,dcg_graph_properties:hS,dcg_common_components:gS,dcg_cost_curves:TQ})}),kB=__dcg_shared_module_exports__.b(()=>{DB()}),_B=__dcg_shared_module_exports__.b(()=>{}),IB=__dcg_shared_module_exports__.b(()=>{});function NQ(e){var t;let[r,n]=(t=RQ.exec(e))!=null?t:[];return n}function XM(e){let t=NQ(e);return t?FQ.test(t):!0}function mS(e,t){var r;let n="";if(typeof window!="undefined"&&(n=(r=new URLSearchParams(window.location.search).get("lang"))!=null?r:""),e===""||n===""||VQ.test(e)||OQ.test(e)||!XM(e))return e;let i=encodeURIComponent(n);if(e.length){let o=e.split("#"),a=/\?/.test(e)?`${o[0]}&lang=${i}`:`${o[0]}?lang=${i}`;return o[1]!==void 0?`${a}#${o[1]}`:a}else return`?lang=${i}`}var VQ,OQ,RQ,FQ,AB=__dcg_shared_module_exports__.b(()=>{VQ=/lang=[A-Za-z]+/,OQ=/(cl|learn|help).desmos.com/,RQ=/^(?:https?:)?(?:\/\/)?([^\s:\/\?]+)/i,FQ=/(^desmos\.com$)|(\.desmos.com$)/}),MB=__dcg_shared_module_exports__.b(()=>{}),GB,LB=__dcg_shared_module_exports__.b(()=>{GB=()=>{}}),PB,cf,VB=__dcg_shared_module_exports__.b(()=>{PB="v1_10",cf=`dcg-calculator-api-container-${PB}`}),mg=__dcg_shared_module_exports__.b(()=>{bB(),yB(),xB(),kB(),_B(),IB(),AB(),MB(),LB(),VB()});function So(e,t){}function Wx(e,t,r){}var Ss=__dcg_shared_module_exports__.b(()=>{});function fS(e){let t=()=>e;return t.isDCGViewConst=!0,t}function Hn(e){return typeof e=="function"&&!!e.isDCGViewConst}var pc=__dcg_shared_module_exports__.b(()=>{});function OB(e){let t=e();if(typeof t=="string")return t;if(typeof t!="object")throw new Error(`Unsupported type returned from class getter: ${typeof t}`);return Object.keys(t).filter(r=>t.hasOwnProperty(r)&&t[r]).join(" ")}function BQ(e,t,r){let n=e.className.replace(RB,"").split(FB),i=t.replace(RB,"").split(FB),o={};for(let s of i)o[s]=!0;let a=n.filter(s=>!o.hasOwnProperty(s));return r?`${r} ${a.join(" ")}`.trim():a.join(" ")}function NB(e){let t=OB(e),r=Hn(e)?void 0:{onUpdate:n=>{let i=OB(e);t!==i&&(n.className=n.className===t?i:BQ(n,t,i),t=i)}};return{value:t,bindings:r}}var RB,FB,BB=__dcg_shared_module_exports__.b(()=>{pc(),RB=/^\s+|\s+$/g,FB=/\s+/});function UB(e){return t=>{if(typeof t!="function")throw new Error(`The ${e} attribute expects a function for the value`);if(Hn(t))throw new Error(`The ${e} attribute does not expect a const for the value`);return{bindings:{[e]:t}}}}var zB=__dcg_shared_module_exports__.b(()=>{pc()});function bS(e,t,r){return r===void 0?e.removeAttribute(t):e.setAttribute(t,`${r}`)}var JM=__dcg_shared_module_exports__.b(()=>{});function qB(e){let t=e(),r=typeof t;if(r==="string")return t;if(!r||r!=="object")throw new Error(`Unsupported type returned from style getter: ${r}`);return Object.entries(t).filter(([n,i])=>t.hasOwnProperty(n)&&i!==null&&i!==void 0).map(([n,i])=>`${n}:${i}`).join(";")}function HB(e){let t=qB(e),r=Hn(e)?void 0:{onUpdate:n=>{let i=qB(e);t!==i&&(bS(n,"style",i),t=i)}};return{value:t,bindings:r}}var KB=__dcg_shared_module_exports__.b(()=>{JM(),pc()});function pf(e,t){QM[e]=t}function WB(e){return QM.hasOwnProperty(e)}function $B(e,t){let r=QM[e];return r(t)}var QM,yS=__dcg_shared_module_exports__.b(()=>{QM={}});function jB(e,t){if(t!=null){if(typeof e!="string")throw new Error("Must pass a string for an EventHandler name");if(typeof t!="function")throw new Error("Must pass a function for an EventHandler callback");return{bindings:{onMount(r){r&&(r[e.toLowerCase()]=(n,...i)=>{n&&t.apply(r,[n,...i])})}}}}}var YB=__dcg_shared_module_exports__.b(()=>{});function XB(e,t){let r=t(),n;return Hn(t)||(n={onUpdate(i){if(!i)return;let o=t();o!==r&&(r=o,bS(i,e,o))}}),{value:r,bindings:n}}var JB=__dcg_shared_module_exports__.b(()=>{JM(),pc()});function QB(e){return e.startsWith("on")&&e[2]===e[2].toUpperCase()}var ZB=__dcg_shared_module_exports__.b(()=>{});function e5(e,t){if(typeof t!="function")throw new Error(`The "${e}" attr must be a function. It is: ${JSON.stringify(t)}`);return WB(e)?$B(e,t):QB(e)?jB(e,t):XB(e,t)}var t5=__dcg_shared_module_exports__.b(()=>{YB(),JB(),yS(),ZB()});function r5(e,t,r){let n=e._bindings[t];e._bindings[t]=n?[...n,r]:[r]}function uc(e,t){var r;((r=e._bindings[t])!=null?r:[]).forEach(n=>n())}var ZM=__dcg_shared_module_exports__.b(()=>{});function o5(e){$x.push(e)}function i5(e){let t=$x.filter(r=>r!==e);$x.length=0,$x.push(...t)}function fg(e,t){if(Eu(t)){let n=`[${t._viewName}]`,i=t.traceViewHierarchy(),o=i.ancestors.length>0?`
View Hierarchy:
${i.formatted}`:"";e=`${e} ${n}${o}`}let r=new Error(e);console.warn(r),$x.forEach(n=>n(r))}var $x,xS=__dcg_shared_module_exports__.b(()=>{id(),$x=[]}),qa,bg,wS,vS,uf=__dcg_shared_module_exports__.b(()=>{pc(),xS(),qa=class{assertNotMounted(){if(this._domNode)throw new Error("Cannot remount a DCGElement")}},bg=Symbol("DCGPlaceholderElement"),wS=class extends qa{renderTo(e){this.assertNotMounted(),this._domNode=document.createTextNode(""),e.appendChild(this._domNode)}},vS=class extends qa{constructor(e,t,r){super(),this.tagName=e,this.attributes=t,this.children=r,Array.isArray(this.children)&&this.children.forEach(n=>{n instanceof qa&&(n._parentElement=this)})}appendTextNode(e){this._domNode.appendChild(document.createTextNode(e))}renderTo(e,t){this.assertNotMounted(),this._domNode=document.createElement(this.tagName),t.bindAttributesTo(this._domNode,this.attributes),e.appendChild(this._domNode),this.children.forEach(r=>{if(r instanceof qa){r.renderTo(this._domNode,t);return}if(Hn(r)){this.appendTextNode(r());return}if(typeof r=="function"){t.bindText(this._domNode,r);return}fg("Text should be a const or a getter: "+JSON.stringify(r),t),this.appendTextNode(r)})}}});function n5(e,t){e!=null&&(Array.isArray(e)?e.forEach(r=>n5(r,t)):t.push(e))}function nd(e,t,...r){let n=[];r.forEach(s=>n5(s,n));let i=t!=null?t:{},o;n.length===0?o=void 0:n.length===1?o=n[0]:o=n;let a=ie(R({},i),{children:o});return e===bg?new wS:typeof e=="string"?new vS(e,i,n):new e(a)._construct()}var hf=__dcg_shared_module_exports__.b(()=>{uf()}),Eu,qi,id=__dcg_shared_module_exports__.b(()=>{t5(),ZM(),pc(),hf(),uf(),xS(),Eu=e=>!!e&&e instanceof qi,qi=class extends qa{constructor(e){var t,r;super(),this.__generatedHTMLBefore=!1,this._childViews=[],this._bindings={},this._isMounted=!1,this._willBeUnmounted=!1,this.const=fS,this.createElement=nd,this._viewName=(r=(t=this.constructor)==null?void 0:t.name)!=null?r:"Anonymous DCGView",Object.entries(e!=null?e:{}).filter(([n])=>n!=="children").forEach(([n,i])=>{if(typeof i!="function"&&i!==void 0)throw new Error(`The "${n}" prop must be a function. It is: ${JSON.stringify(i)}`)}),this.props=e!=null?e:{}}init(){}template(){throw new Error("template() must be implemented")}_construct(){var e;if((e=this.init)==null||e.call(this),this._element=this.template(),!(this._element instanceof qa))throw new Error("template() must return a DCGElement");return this._element._parentElement=this,this}bindFn(e){return e.bind(this)}bindIfMounted(e){return this.bindFn((...t)=>{if(this._isMounted)return e.apply(this,t)})}traceViewHierarchy(){let e=[],t=this._parentElement;for(;t;)e.unshift(t),t=t._parentElement;let r=i=>Eu(i)&&!(i._viewName==="Switch"&&Eu(i._parentElement)&&i._parentElement._viewName==="If")&&!["IfDefinedWrapper","SwitchWrapper","SwitchUnionWrapper"].includes(i._viewName),n=[...e,this].filter(r).map((i,o)=>"  ".repeat(o)+"<"+i._viewName+">").join(`
`);return{ancestors:e,formatted:n}}renderTo(e,t){if(t&&t._childViews.push(this),this.__generatedHTMLBefore)throw new Error("Cannot remount a DCGView");this.__generatedHTMLBefore=!0,this._element.renderTo(e,this)}findFirstRootDOMNode(){let e=this._element;return Eu(e)?e.findFirstRootDOMNode():e._domNode}findLastRootDOMNode(){let e=this._element;return Eu(e)?e.findLastRootDOMNode():e._domNode}findAllRootDOMNodes(){let e=this.findFirstRootDOMNode(),t=this.findLastRootDOMNode(),r=[],n=e;for(;n&&(r.push(n),n!==t);)n=n.nextSibling;return r}update(){var e,t,r;if(!this._isMounted)return fg("Trying to update view that is not mounted. Ignoring update.",this);this.shouldUpdate&&!this.shouldUpdate()||((e=this.willUpdate)==null||e.call(this),uc(this,"willUpdate"),uc(this,"onUpdate"),(t=this.onUpdate)==null||t.call(this),this.updateChildren(),uc(this,"didUpdate"),(r=this.didUpdate)==null||r.call(this))}updateChildren(){this._childViews.forEach(e=>e.update())}bindText(e,t){var r;let n=(r=t())!=null?r:"",i=document.createTextNode(n);e.appendChild(i),r5(this,"onUpdate",()=>{var o;let a=(o=t())!=null?o:"";n!==a&&(i.nodeValue=a,n=a)})}addAttributeBindingsTo(e,t){Object.entries(t).forEach(([r,n])=>{if(!n)return;if(["onMount","didMount","willUnmount","willUpdate","onUpdate","didUpdate"].includes(r)&&(n=n.bind(null,e)),["willMount","onMount","didMount","willUnmount","onUnmount","didUnmount"].includes(r)){let o=!1,a=n;n=(...s)=>{if(o){fg(`${r} is a one-time binding but was called multiple times`,this);return}o=!0,a(...s)}}let i=this._bindings[r];this._bindings[r]=i?[...i,n]:[n]})}bindAttributesTo(e,t){e instanceof Text||!t||Object.keys(t).filter(r=>r!=="children").forEach(r=>{let n=e5(r,t[r]);n&&("value"in n&&n.value!==void 0&&e.setAttribute(r,n.value),n.bindings&&this.addAttributeBindingsTo(e,n.bindings))})}}}),CS,a5=__dcg_shared_module_exports__.b(()=>{__dcg_shared_module_exports__.e(ne()),id(),CS=class extends qi{constructor(){super(...arguments),this._viewName="Checkbox"}computeChecked(){return!!this.props.checked()}template(){if(!this.props.checked)throw new Error('<Checkbox> expects a "checked={}" prop');if(!this.props.onChange)throw new Error('<Checkbox> expects an "onChange={}" prop');let e=ie(R({},this.props),{type:this.const("checkbox"),checked:this.const(this.computeChecked()?"checked":void 0),onChange:t=>{this.props.onChange(t.target.checked),this._isMounted&&this.update()},onMount:t=>{this.rootDOM=t,this.props.onMount&&this.props.onMount(t)}});return this.createElement("input",e)}didUpdate(){let e=this.computeChecked();this.rootDOM.checked!==e&&(this.rootDOM.checked=e)}}}),s5,l5=__dcg_shared_module_exports__.b(()=>{s5=e=>{let t=e.length,r=new Array(t),n=new Array(t+1),i=0,o;for(let l=0;l<t;l++){if(e[n[i]]<e[l])o=i+1;else{let c=1,d=i-1;for(;c<=d;){let u=Math.ceil((c+d)/2);e[n[u]]<e[l]?c=u+1:d=u-1}o=c}r[l]=n[o-1],n[o]=l,o>i&&(i=o)}let a=new Array(i),s=n[i];for(let l=i-1;l>=0;l--)a[l]=e[s],s=r[s];return a}});function c5(e,t){let r={};for(let l=0;l<t.length;l++)r[t[l]]=l;let n=e.filter(l=>r[l]===void 0),i=e.map(l=>r[l]).filter(l=>l!==void 0),o=s5(i),a={};for(let l=0;l<o.length;l++){let c=o[l];a[t[c]]=!0}let s=[];for(let l=t.length-1;l>=0;l--){let c=t[l];a[c]||s.push({key:c,beforeKey:t[l+1]})}return{removes:n,inserts:s}}var d5=__dcg_shared_module_exports__.b(()=>{l5()});function p5(e,t,r){if(!t||t.nodeType!==1)throw new Error("Must pass an HTMLElement for the node");if(t._mountedDCGView)throw new Error("This node is already mounted by a view");let n=new e(r)._construct(),i=document.createDocumentFragment();return n.renderTo(i),t.innerHTML="",gf(n),t._mountedDCGView=n,t.appendChild(i),mf(n),ff(n),n}function u5(e){let t=e._mountedDCGView;if(!t)throw new Error("This node is not mounted by a DCGView");bf(t),e.innerHTML="",delete e._mountedDCGView,yf(t),xf(t)}function gf(e){e.willMount&&e.willMount(),uc(e,"willMount"),e._childViews.forEach(gf)}function mf(e){e._isMounted=!0,e.onMount&&e.onMount(),uc(e,"onMount"),e._childViews.forEach(mf)}function ff(e){e.didMount&&e.didMount(),uc(e,"didMount"),e._childViews.forEach(ff)}function bf(e){e.willUnmount&&e.willUnmount(),uc(e,"willUnmount"),e._childViews.forEach(bf)}function yf(e){e._isMounted=!1,e._childViews.forEach(yf),uc(e,"onUnmount"),e.onUnmount&&e.onUnmount()}function xf(e){e._childViews.forEach(xf),uc(e,"didUnmount"),e.didUnmount&&e.didUnmount()}function SS(e,t){let r=document.createDocumentFragment();return e.renderTo(r,t),r.childNodes}var ES=__dcg_shared_module_exports__.b(()=>{ZM()}),eG,wf,tG=__dcg_shared_module_exports__.b(()=>{__dcg_shared_module_exports__.e(ne()),d5(),pc(),uf(),ES(),id(),eG=class extends qi{constructor(){super(...arguments),this._viewName="ForWrapper"}template(){return this.props.children}},wf=class extends qi{constructor(){super(...arguments),this._viewName="For"}getKeys(){this._keyToItem={};let e=this.props.each();if(!Array.isArray(e))throw new Error("<For each={}> must return an array");let t=this.props.key?e.map(this.props.key):[...e];if(!this._chosenKeyType&&t.length){let r=typeof t[0];if(r!=="string"&&r!=="number")throw new Error(`The key: ${JSON.stringify(t[0])} is not a string or number`);this._chosenKeyType=r}return t.forEach((r,n)=>{if(typeof r!==this._chosenKeyType)throw new Error(`Keys must be the same type. ${JSON.stringify(r)} is not a ${this._chosenKeyType}`);let i=r;if(i in this._keyToItem)throw new Error(`The key: ${JSON.stringify(r)} is not unique`);this._keyToItem[i]=e[n]}),t}createViewForKey(e){let t=this._keyToItem[e],r=this._viewFunction.call(this,t,e),n=r;return Eu(n)||(n=this.createElement(eG,{},r)),this._keyToView[e]=n,n}template(){if(typeof this.props.each!="function")throw new Error("<For each={}> must be a function");if(!("children"in this.props))throw new Error("<For> expects a child.");if(Array.isArray(this.props.children))throw new Error(`<For> expects a single child. You passed ${this.props.children.length}.`);if(this._viewFunction=this.props.children,this._viewFunction&&this._viewFunction instanceof qa)throw new Error("<For> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof this._viewFunction!="function"){let e=JSON.stringify(this._viewFunction);throw new Error(`<For> expects a function that constructs a DCGElement. You passed ${e}`)}if(Hn(this._viewFunction))throw new Error("<For> expects a function that constructs a DCGElement. You passed a constant");return this._keyToView={},this._keys=this.getKeys(),this._startPlaceholder=this.createElement(bg,null),this._keys.map(e=>{let t=this.createViewForKey(e);return t._parentElement=this,t}),this._endPlaceholder=this.createElement(bg,null),this._startPlaceholder}detachAllRemovedViews(){let e=this._childViews,t=0;for(let r=0;r<e.length;r++){let n=e[r];n._willBeUnmounted?t++:e[r-t]=n}e.splice(e.length-t,t)}findFirstRootDOMNode(){return this._startPlaceholder._domNode}findLastRootDOMNode(){return this._endPlaceholder._domNode}updateChildren(){let e=this._keys,t=this.getKeys();this._keys=t;let r=c5(e,t),n=[];for(let o=r.removes.length-1;o>=0;o--){let a=r.removes[o],s=this._keyToView[a];bf(s),delete this._keyToView[a],s._willBeUnmounted=!0,s.findAllRootDOMNodes().forEach(l=>l.remove()),n.push(s)}n.length>0&&(this.detachAllRemovedViews(),n.forEach(yf),n.forEach(xf));let i=[];for(let o=r.inserts.length-1;o>=0;o--){let a=r.inserts[o].key;if(a in this._keyToView)continue;let s=this.createViewForKey(a);SS(s,this),i.push(s)}i.forEach(gf),r.inserts.forEach(o=>{let a=this._keyToView[o.key].findAllRootDOMNodes(),s;o.beforeKey?s=this._keyToView[o.beforeKey].findFirstRootDOMNode():s=this.findLastRootDOMNode(),a.forEach(l=>{s.before(l)})}),i.forEach(mf),i.forEach(ff);for(let o=0;o<this._childViews.length-i.length;o++)this._childViews[o].update()}renderTo(e,t){super.renderTo(e,t);for(let r of this._keys)this._keyToView[r].renderTo(e,this);this._endPlaceholder.renderTo(e,this)}}});function h5(e,t){let r={each:e,key:t.key},n=nd(wf,r,t.item);return n._viewName="Each",n}var g5=__dcg_shared_module_exports__.b(()=>{__dcg_shared_module_exports__.e(ne()),hf(),tG()}),rG,ad,jx=__dcg_shared_module_exports__.b(()=>{__dcg_shared_module_exports__.e(ne()),pc(),uf(),ES(),id(),rG=class extends qi{constructor(){super(...arguments),this._viewName="SwitchWrapper"}template(){return this.props.children}},ad=class extends qi{constructor(){super(...arguments),this._viewName="Switch"}updateKey(){this._key=this.props.key()}createView(){let e=this._viewFunction(this._key);e=e!=null?e:this.createElement(bg,null);let t=this.createElement(rG,{},e);return t._parentElement=this,t}template(){if(typeof this.props.key!="function")throw new Error("<Switch key={}> must be a function");if(!("children"in this.props))throw new Error("<Switch> expects a child.");if(Array.isArray(this.props.children))throw new Error(`<Switch> expects a single child. You passed ${this.props.children.length}.`);if(this._viewFunction=this.props.children,this._viewFunction&&this._viewFunction instanceof qa)throw new Error("<Switch> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof this._viewFunction!="function"){let e=JSON.stringify(this._viewFunction);throw new Error("<Switch> expects a function that constructs a DCGElement. You passed "+e)}if(Hn(this._viewFunction))throw new Error("<Switch> expects a function that constructs a DCGElement. You passed a constant");return this.updateKey(),this.createView()}updateChildren(){let e=this._key;this.updateKey();let t=this._key;if(e===t){this._element.update();return}let r=this.findAllRootDOMNodes(),n=document.createTextNode("");r[0].before(n),bf(this._element),this._childViews=[],r.forEach(o=>o.remove()),yf(this._element),xf(this._element),this._element=this.createView();let i=SS(this._element,this);gf(this._element),i.forEach(o=>{n.before(o)}),n.remove(),mf(this._element),ff(this._element)}}}),TS,m5=__dcg_shared_module_exports__.b(()=>{__dcg_shared_module_exports__.e(ne()),pc(),uf(),jx(),id(),TS=class extends qi{constructor(){super(...arguments),this._viewName="If"}template(){let{predicate:e}=this.props;if(typeof e!="function")throw new Error("<If predicate={}> must be a function");if(!("children"in this.props))throw new Error("<If> expects a child.");if(Array.isArray(this.props.children))throw new Error(`<If> expects a single child. You passed ${this.props.children.length}.`);let t=this.props.children;if(t&&t instanceof qa)throw new Error("<If> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof t!="function"){let i=JSON.stringify(t);throw new Error(`<If> expects a function that constructs a DCGElement. You passed ${i}`)}if(Hn(t))throw new Error("<If> expects a function that constructs a DCGElement. You passed a constant");let r=()=>!!e(),n=i=>i?t():void 0;return this.createElement(ad,{key:r},n)}}});function f5(e,t){let r=nd(ad,{key:()=>e()!=null},n=>n?t(e):void 0);return r._viewName="IfDefined",r}var b5=__dcg_shared_module_exports__.b(()=>{__dcg_shared_module_exports__.e(ne()),hf(),jx()});function DS(e,t){return typeof e=="string"?y5.bind(this,e,t):y5(void 0,e,t)}var y5,oG=__dcg_shared_module_exports__.b(()=>{__dcg_shared_module_exports__.e(ne()),hf(),jx(),y5=(e,t,r)=>{let n=nd(ad,{key(){let i=t();return e?i&&i[e]:i}},i=>{let o=r[i];return o?o(t):void 0});return n._viewName="SwitchUnion",n}});function x5(e,t){let r=DS(()=>e()?"true":"false",t);return r._viewName="IfElse",r}var w5=__dcg_shared_module_exports__.b(()=>{__dcg_shared_module_exports__.e(ne()),oG()}),kS,v5=__dcg_shared_module_exports__.b(()=>{__dcg_shared_module_exports__.e(ne()),id(),kS=class extends qi{constructor(){super(...arguments),this._viewName="Input"}computeValue(){let e=this.props.value();return e==null?"":`${e}`}template(){let{value:e,onInput:t,onEnterPressed:r,disabled:n,readOnly:i}=this.props;if(!e)throw new Error('<Input> expects a "value={}" prop');if(!t)throw new Error('<Input> expects an "onInput={}" prop');let o=ie(R({},this.props),{value:this.const(this.computeValue()),onInput:(a=>{t(a.target.value),this._isMounted&&this.update()}).bind(this)});return r&&(o.onKeypress=a=>{a.which===13&&r()}),n&&(o.disabled=()=>n()?!0:void 0),i&&(o.readOnly=()=>i()?!0:void 0),o.hasOwnProperty("tabIndex")||(o.tabIndex=()=>n&&n()?"-1":"0"),o.onMount=a=>{this.rootDOM=a,this.props.onMount&&this.props.onMount(a)},this.createElement("input",o)}didUpdate(){let e=this.computeValue();this.rootDOM.value!==e&&(this.rootDOM.value=e)}}}),_S,C5=__dcg_shared_module_exports__.b(()=>{__dcg_shared_module_exports__.e(ne()),id(),_S=class extends qi{constructor(){super(...arguments),this._viewName="Textarea"}computeValue(){let e=this.props.value();return e==null?"":`${e}`}template(){let{value:e,onInput:t,disabled:r,readOnly:n}=this.props;if(!e)throw new Error('<Textarea> expects a "value={}" prop');if(!t)throw new Error('<Textarea> expects an "onInput={}" prop');let i=ie(R({},this.props),{onInput:(o=>{this.props.onInput(o.target.value),this._isMounted&&this.update()}).bind(this)});return r&&(i.disabled=()=>r()?!0:void 0),n&&(i.readOnly=()=>n()?!0:void 0),i.onMount=o=>{this.rootDOM=o,this.props.onMount&&this.props.onMount(o)},delete i.value,this.createElement("textarea",i,this.const(this.computeValue()))}didUpdate(){let e=this.computeValue();this.rootDOM.value!==e&&(this.rootDOM.value=e)}}}),IS={};__dcg_shared_module_exports__.d(IS,{Checkbox:()=>CS,Each:()=>h5,For:()=>wf,If:()=>TS,IfDefined:()=>f5,IfElse:()=>x5,Input:()=>kS,Switch:()=>ad,SwitchUnion:()=>DS,Textarea:()=>_S});var S5=__dcg_shared_module_exports__.b(()=>{a5(),g5(),tG(),m5(),b5(),w5(),v5(),jx(),oG(),C5()}),iG={};__dcg_shared_module_exports__.d(iG,{Class:()=>UQ,Components:()=>IS,View:()=>qi,_warn:()=>fg,addCustomAttribute:()=>pf,addWarningHandler:()=>o5,const:()=>fS,createElement:()=>nd,isConst:()=>Hn,mountToNode:()=>p5,removeWarningHandler:()=>i5,unmountFromNode:()=>u5});var UQ,nG=__dcg_shared_module_exports__.b(()=>{BB(),zB(),KB(),yS(),id(),S5(),pc(),hf(),yS(),ES(),id(),xS(),UQ=qi,pf("style",HB),pf("class",NB),["willMount","onMount","didMount","willUnmount","onUnmount","didUnmount","willUpdate","onUpdate","didUpdate"].forEach(e=>pf(e,UB(e)))}),sd,E5=__dcg_shared_module_exports__.b(()=>{nG(),nG(),sd=iG});function VS(e){return e==null?e+"":typeof e=="object"||typeof e=="function"?PS[O5.call(e)]||"object":typeof e}function aG(e){var t=!!e&&"length"in e&&e.length,r=VS(e);return gp(e)||Tf(e)?!1:r==="array"||t===0||typeof t=="number"&&t>0&&t-1 in e}function vf(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}function XQ(e,t){return t.toUpperCase()}function pp(e){return e.replace(jQ,"ms-").replace(YQ,XQ)}function Jx(){this.expando=le.expando+Jx.uid++}function ZQ(e){return e==="true"?!0:e==="false"?!1:e==="null"?null:e===+e+""?+e:JQ.test(e)?JSON.parse(e):e}function T5(e,t,r){var n;if(r===void 0&&e.nodeType===1)if(n="data-"+t.replace(QQ,"-$&").toLowerCase(),r=e.getAttribute(n),typeof r=="string"){try{r=ZQ(r)}catch(i){}up.set(e,t,r)}else r=void 0;return r}function tZ(e,t,r,n){var i,o,a=20,s=function(){return le.css(e,t,"")},l=s(),c=r&&r[3]||(le.cssNumber[t]?"":"px"),d=e.nodeType&&(le.cssNumber[t]||c!=="px"&&+l)&&OS.exec(le.css(e,t));if(d&&d[3]!==c){for(l=l/2,c=c||d[3],d=+l||1;a--;)le.style(e,t,d+c),(1-o)*(1-(o=s()/l||.5))<=0&&(a=0),d=d/o;d=d*2,le.style(e,t,d+c),r=r||[]}return r&&(d=+d||+l||0,i=r[1]?d+(r[1]+1)*r[2]:+r[2]),i}function Sf(){return!0}function Ef(){return!1}function rZ(e,t){return e===oZ()==(t==="focus")}function oZ(){try{return En.activeElement}catch(e){}}function cG(e,t,r,n,i,o){var a,s;if(typeof t=="object"){typeof r!="string"&&(n=n||r,r=void 0);for(s in t)cG(e,s,r,n,t[s],o);return e}if(n==null&&i==null?(i=r,n=r=void 0):i==null&&(typeof r=="string"?(i=n,n=void 0):(i=n,n=r,r=void 0)),i===!1)i=Ef;else if(!i)return e;return o===1&&(a=i,i=function(l){return le().off(l),a.apply(this,arguments)},i.guid=a.guid||(a.guid=le.guid++)),e.each(function(){le.event.add(this,t,i,n,r)})}function LS(e,t,r){if(!r){Qo.get(e,t)===void 0&&le.event.add(e,t,Sf);return}Qo.set(e,t,!1),le.event.add(e,t,{namespace:!1,handler:function(n){var i,o,a=Qo.get(this,t);if(n.isTrigger&1&&this[t]){if(a.length)(le.event.special[t]||{}).delegateType&&n.stopPropagation();else if(a=AS.call(arguments),Qo.set(this,t,a),i=r(this,t),this[t](),o=Qo.get(this,t),a!==o||i?Qo.set(this,t,!1):o={},a!==o)return n.stopImmediatePropagation(),n.preventDefault(),o&&o.value}else a.length&&(Qo.set(this,t,{value:le.event.trigger(le.extend(a[0],le.Event.prototype),a.slice(1),this)}),n.stopImmediatePropagation())}})}function Yx(e,t,r){var n,i,o,a,s=e.style;return r=r||RS(e),r&&(a=r.getPropertyValue(t)||r[t],a===""&&!U5(e)&&(a=le.style(e,t)),!Tn.pixelBoxStyles()&&uG.test(a)&&iZ.test(t)&&(n=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=r.width,s.width=n,s.minWidth=i,s.maxWidth=o)),a!==void 0?a+"":a}function q5(e,t){return{get:function(){if(e()){delete this.get;return}return(this.get=t).apply(this,arguments)}}}function nZ(e){for(var t=e[0].toUpperCase()+e.slice(1),r=k5.length;r--;)if(e=k5[r]+t,e in H5)return e}function I5(e){var t=le.cssProps[e]||_5[e];return t||(e in H5?e:_5[e]=nZ(e)||e)}function K5(e,t,r){var n=OS.exec(t);return n?Math.max(0,n[2]-(r||0))+(n[3]||"px"):t}function dG(e,t,r,n,i,o){var a=t==="width"?1:0,s=0,l=0;if(r===(n?"border":"content"))return 0;for(;a<4;a+=2)r==="margin"&&(l+=le.css(e,r+Tu[a],!0,i)),n?(r==="content"&&(l-=le.css(e,"padding"+Tu[a],!0,i)),r!=="margin"&&(l-=le.css(e,"border"+Tu[a]+"Width",!0,i))):(l+=le.css(e,"padding"+Tu[a],!0,i),r!=="padding"?l+=le.css(e,"border"+Tu[a]+"Width",!0,i):s+=le.css(e,"border"+Tu[a]+"Width",!0,i));return!n&&o>=0&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-l-s-.5))||0),l}function G5(e,t,r){var n=RS(e),i=!Tn.boxSizingReliable()||r,o=i&&le.css(e,"boxSizing",!1,n)==="border-box",a=o,s=Yx(e,t,n),l="offset"+t[0].toUpperCase()+t.slice(1);if(uG.test(s)){if(!r)return s;s="auto"}return(!Tn.boxSizingReliable()&&o||!Tn.reliableTrDimensions()&&vf(e,"tr")||s==="auto"||!parseFloat(s)&&le.css(e,"display",!1,n)==="inline")&&e.getClientRects().length&&(o=le.css(e,"boxSizing",!1,n)==="border-box",a=l in e,a&&(s=e[l])),s=parseFloat(s)||0,s+dG(e,t,r||(o?"border":"content"),a,n,s)+"px"}function pG(e,t,r,n){var i;if(Array.isArray(t))le.each(t,function(o,a){r||lZ.test(e)?n(e,a):pG(e+"["+(typeof a=="object"&&a!=null?o:"")+"]",a,r,n)});else if(!r&&VS(t)==="object")for(i in t)pG(e+"["+i+"]",t[i],r,n);else n(e,t)}var hp,zQ,AS,qQ,V5,HQ,PS,O5,MS,R5,KQ,Tn,gp,Tf,En,F5,le,WQ,$Q,lG,Xx,jQ,YQ,GS,Qo,up,JQ,QQ,B5,OS,Tu,Cf,U5,eZ,sG,D5,uG,RS,z5,iZ,k5,H5,_5,aZ,A5,sZ,M5,L5,P5,lZ,cZ,dZ,pZ,ee,qt=__dcg_shared_module_exports__.b(()=>{hp=[],zQ=Object.getPrototypeOf,AS=hp.slice,qQ=hp.flat?function(e){return hp.flat.call(e)}:function(e){return hp.concat.apply([],e)},V5=hp.push,HQ=hp.indexOf,PS={},O5=PS.toString,MS=PS.hasOwnProperty,R5=MS.toString,KQ=R5.call(Object),Tn={},gp=function(e){return typeof e=="function"&&typeof e.nodeType!="number"&&typeof e.item!="function"},Tf=function(e){return e!=null&&e===e.window},En=window.document,F5="3.6.0",le=function(e,t){return new le.fn.init(e,t)},le.fn=le.prototype={jquery:F5,constructor:le,length:0,toArray:function(){return AS.call(this)},get:function(e){return e==null?AS.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=le.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return le.each(this,e)},map:function(e){return this.pushStack(le.map(this,function(t,r){return e.call(t,r,t)}))},slice:function(){return this.pushStack(AS.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(le.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(le.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,r=+e+(e<0?t:0);return this.pushStack(r>=0&&r<t?[this[r]]:[])},end:function(){return this.prevObject||this.constructor()},push:V5,sort:hp.sort,splice:hp.splice},le.extend=le.fn.extend=function(){var e,t,r,n,i,o,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for(typeof a=="boolean"&&(c=a,a=arguments[s]||{},s++),typeof a!="object"&&!gp(a)&&(a={}),s===l&&(a=this,s--);s<l;s++)if((e=arguments[s])!=null)for(t in e)n=e[t],!(t==="__proto__"||a===n)&&(c&&n&&(le.isPlainObject(n)||(i=Array.isArray(n)))?(r=a[t],i&&!Array.isArray(r)?o=[]:!i&&!le.isPlainObject(r)?o={}:o=r,i=!1,a[t]=le.extend(c,o,n)):n!==void 0&&(a[t]=n));return a},le.extend({expando:"jQuery"+(F5+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,r;return!e||O5.call(e)!=="[object Object]"?!1:(t=zQ(e),t?(r=MS.call(t,"constructor")&&t.constructor,typeof r=="function"&&R5.call(r)===KQ):!0)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},each:function(e,t){var r,n=0;if(aG(e))for(r=e.length;n<r&&t.call(e[n],n,e[n])!==!1;n++);else for(n in e)if(t.call(e[n],n,e[n])===!1)break;return e},makeArray:function(e,t){var r=t||[];return e!=null&&(aG(Object(e))?le.merge(r,typeof e=="string"?[e]:e):V5.call(r,e)),r},inArray:function(e,t,r){return t==null?-1:HQ.call(t,e,r)},merge:function(e,t){for(var r=+t.length,n=0,i=e.length;n<r;n++)e[i++]=t[n];return e.length=i,e},grep:function(e,t,r){for(var n,i=[],o=0,a=e.length,s=!r;o<a;o++)n=!t(e[o],o),n!==s&&i.push(e[o]);return i},map:function(e,t,r){var n,i,o=0,a=[];if(aG(e))for(n=e.length;o<n;o++)i=t(e[o],o,r),i!=null&&a.push(i);else for(o in e)i=t(e[o],o,r),i!=null&&a.push(i);return qQ(a)},guid:1,support:Tn}),typeof Symbol=="function"&&(le.fn[Symbol.iterator]=hp[Symbol.iterator]),le.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){PS["[object "+t+"]"]=t.toLowerCase()}),WQ=function(e){var t,r,n,i,o,a,s=e.document,l=[],c=l.push,d=l.push,u=l.slice,p=/HTML$/i,g=/^[^{]+\{\s*\[native \w/,f=function(){n()};try{d.apply(l=u.call(s.childNodes),s.childNodes),l[s.childNodes.length].nodeType}catch(_){d={apply:l.length?function(w,v){c.apply(w,u.call(v))}:function(w,v){for(var T=w.length,M=0;w[T++]=v[M++];);w.length=T-1}}}function y(){}function E(_){var w=i.createElement("fieldset");try{return!!_(w)}catch(v){return!1}finally{w.parentNode&&w.parentNode.removeChild(w),w=null}}return t=y.support={},r=y.isXML=function(_){var w=_&&_.namespaceURI,v=_&&(_.ownerDocument||_).documentElement;return!p.test(w||v&&v.nodeName||"HTML")},n=y.setDocument=function(_){var w,v,T=_?_.ownerDocument||_:s;return T==i||T.nodeType!==9||!T.documentElement||(i=T,o=i.documentElement,r(i),s!=i&&(v=i.defaultView)&&v.top!==v&&(v.addEventListener?v.addEventListener("unload",f,!1):v.attachEvent&&v.attachEvent("onunload",f)),t.attributes=E(function(M){return M.className="i",!M.getAttribute("className")}),t.getElementsByTagName=E(function(M){return M.appendChild(i.createComment("")),!M.getElementsByTagName("*").length}),w=g.test(o.compareDocumentPosition),a=w||g.test(o.contains)?function(M,C){var P=M.nodeType===9?M.documentElement:M,F=C&&C.parentNode;return M===F||!!(F&&F.nodeType===1&&(P.contains?P.contains(F):M.compareDocumentPosition&&M.compareDocumentPosition(F)&16))}:function(M,C){if(C){for(;C=C.parentNode;)if(C===M)return!0}return!1}),i},y.contains=function(_,w){return(_.ownerDocument||_)!=i&&n(_),a(_,w)},n(),t.sortDetached=E(function(_){return _.compareDocumentPosition(i.createElement("fieldset"))&1}),y}(window),le.contains=WQ.contains,$Q=le.fn.init=function(e,t,r){if(!e)return this;if(typeof e=="string")throw new Error("$(string) implementation has been removed");if(e.nodeType)return this[0]=e,this.length=1,this;if(gp(e))throw new Error("$(function) implementation has been removed");return le.makeArray(e,this)},$Q.prototype=le.fn,le(En),lG=/[^\x20\t\r\n\f]+/g,Xx=function(e,t,r,n,i,o,a){var s=0,l=e.length,c=r==null;if(VS(r)==="object"){i=!0;for(s in r)Xx(e,t,s,r[s],!0,o,a)}else if(n!==void 0&&(i=!0,gp(n)||(a=!0),c&&(a?(t.call(e,n),t=null):(c=t,t=function(d,u,p){return c.call(le(d),p)})),t))for(;s<l;s++)t(e[s],r,a?n:n.call(e[s],s,t(e[s],r)));return i?e:c?t.call(e):l?t(e[0],r):o},jQ=/^-ms-/,YQ=/-([a-z])/g,GS=function(e){return e.nodeType===1||e.nodeType===9||!+e.nodeType},Jx.uid=1,Jx.prototype={cache:function(e){var t=e[this.expando];return t||(t={},GS(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,r){var n,i=this.cache(e);if(typeof t=="string")i[pp(t)]=r;else for(n in t)i[pp(n)]=t[n];return i},get:function(e,t){return t===void 0?this.cache(e):e[this.expando]&&e[this.expando][pp(t)]},access:function(e,t,r){return t===void 0||t&&typeof t=="string"&&r===void 0?this.get(e,t):(this.set(e,t,r),r!==void 0?r:t)},remove:function(e,t){var r,n=e[this.expando];if(n!==void 0){if(t!==void 0)for(Array.isArray(t)?t=t.map(pp):(t=pp(t),t=t in n?[t]:t.match(lG)||[]),r=t.length;r--;)delete n[t[r]];(t===void 0||le.isEmptyObject(n))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return t!==void 0&&!le.isEmptyObject(t)}},Qo=new Jx,up=new Jx,JQ=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,QQ=/[A-Z]/g,le.extend({hasData:function(e){return up.hasData(e)||Qo.hasData(e)},data:function(e,t,r){return up.access(e,t,r)},removeData:function(e,t){up.remove(e,t)},_data:function(e,t,r){return Qo.access(e,t,r)},_removeData:function(e,t){Qo.remove(e,t)}}),le.fn.extend({data:function(e,t){var r,n,i,o=this[0],a=o&&o.attributes;if(e===void 0){if(this.length&&(i=up.get(o),o.nodeType===1&&!Qo.get(o,"hasDataAttrs"))){for(r=a.length;r--;)a[r]&&(n=a[r].name,n.indexOf("data-")===0&&(n=pp(n.slice(5)),T5(o,n,i[n])));Qo.set(o,"hasDataAttrs",!0)}return i}return typeof e=="object"?this.each(function(){up.set(this,e)}):Xx(this,function(s){var l;if(o&&s===void 0)return l=up.get(o,e),l!==void 0||(l=T5(o,e),l!==void 0)?l:void 0;this.each(function(){up.set(this,e,s)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){up.remove(this,e)})}}),B5=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,OS=new RegExp("^(?:([+-])=|)("+B5+")([a-z%]*)$","i"),Tu=["Top","Right","Bottom","Left"],Cf=En.documentElement,U5=function(e){return le.contains(e.ownerDocument,e)},eZ={composed:!0},Cf.getRootNode&&(U5=function(e){return le.contains(e.ownerDocument,e)||e.getRootNode(eZ)===e.ownerDocument}),sG=/^(?:checkbox|radio)$/i,function(){var e=En.createDocumentFragment(),t=e.appendChild(En.createElement("div")),r=En.createElement("input");r.setAttribute("type","radio"),r.setAttribute("checked","checked"),r.setAttribute("name","t"),t.appendChild(r),Tn.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",Tn.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,t.innerHTML="<option></option>",Tn.option=!!t.lastChild}(),D5=/^([^.]*)(?:\.(.+)|)/,le.event={global:{},add:function(e,t,r,n,i){var o,a,s,l,c,d,u,p,g,f,y,E=Qo.get(e);if(GS(e)){if(r.handler&&(o=r,r=o.handler,i=o.selector),i)throw new Error("Support for event delegation has been removed");for(r.guid||(r.guid=le.guid++),(l=E.events)||(l=E.events=Object.create(null)),(a=E.handle)||(a=E.handle=function(_){return typeof le!="undefined"&&le.event.triggered!==_.type?le.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(lG)||[""],c=t.length;c--;)if(s=D5.exec(t[c])||[],g=y=s[1],f=(s[2]||"").split(".").sort(),!!g){if(u=le.event.special[g]||{},g=(i?u.delegateType:u.bindType)||g,u=le.event.special[g]||{},d=le.extend({type:g,origType:y,data:n,handler:r,guid:r.guid,selector:i,namespace:f.join(".")},o),(p=l[g])||(p=l[g]=[],p.delegateCount=0,(!u.setup||u.setup.call(e,n,f,a)===!1)&&e.addEventListener&&e.addEventListener(g,a)),u.add&&(u.add.call(e,d),d.handler.guid||(d.handler.guid=r.guid)),i)throw new Error("Support for event delegation has been removed");p.push(d),le.event.global[g]=!0}}},remove:function(e,t,r,n,i){var o,a,s,l,c,d,u,p,g,f,y,E=Qo.hasData(e)&&Qo.get(e);if(!(!E||!(l=E.events))){for(t=(t||"").match(lG)||[""],c=t.length;c--;){if(s=D5.exec(t[c])||[],g=y=s[1],f=(s[2]||"").split(".").sort(),!g){for(g in l)le.event.remove(e,g+t[c],r,n,!0);continue}for(u=le.event.special[g]||{},g=(n?u.delegateType:u.bindType)||g,p=l[g]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;o--;)d=p[o],(i||y===d.origType)&&(!r||r.guid===d.guid)&&(!s||s.test(d.namespace))&&(!n||n===d.selector||n==="**"&&d.selector)&&(p.splice(o,1),d.selector&&p.delegateCount--,u.remove&&u.remove.call(e,d));a&&!p.length&&((!u.teardown||u.teardown.call(e,f,E.handle)===!1)&&le.removeEvent(e,g,E.handle),delete l[g])}le.isEmptyObject(l)&&Qo.remove(e,"handle events")}},dispatch:function(e){var t,r,n,i,o,a,s=new Array(arguments.length),l=le.event.fix(e),c=(Qo.get(this,"events")||Object.create(null))[l.type]||[],d=le.event.special[l.type]||{};for(s[0]=l,t=1;t<arguments.length;t++)s[t]=arguments[t];if(l.delegateTarget=this,!(d.preDispatch&&d.preDispatch.call(this,l)===!1)){for(a=le.event.handlers.call(this,l,c),t=0;(i=a[t++])&&!l.isPropagationStopped();)for(l.currentTarget=i.elem,r=0;(o=i.handlers[r++])&&!l.isImmediatePropagationStopped();)(!l.rnamespace||o.namespace===!1||l.rnamespace.test(o.namespace))&&(l.handleObj=o,l.data=o.data,n=((le.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s),n!==void 0&&(l.result=n)===!1&&(l.preventDefault(),l.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,l),l.result}},handlers:function(e,t){var r=[],n=t.delegateCount,i=e.target;if(n)throw new Error("Support for event delegtaion has been removed");return i=this,n<t.length&&r.push({elem:i,handlers:t.slice(n)}),r},addProp:function(e,t){Object.defineProperty(le.Event.prototype,e,{enumerable:!0,configurable:!0,get:gp(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(r){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:r})}})},fix:function(e){return e[le.expando]?e:new le.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return sG.test(t.type)&&t.click&&vf(t,"input")&&LS(t,"click",Sf),!1},trigger:function(e){var t=this||e;return sG.test(t.type)&&t.click&&vf(t,"input")&&LS(t,"click"),!0},_default:function(e){var t=e.target;return sG.test(t.type)&&t.click&&vf(t,"input")&&Qo.get(t,"click")||vf(t,"a")}},beforeunload:{postDispatch:function(e){e.result!==void 0&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},le.removeEvent=function(e,t,r){e.removeEventListener&&e.removeEventListener(t,r)},le.Event=function(e,t){if(!(this instanceof le.Event))return new le.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.defaultPrevented===void 0&&e.returnValue===!1?Sf:Ef,this.target=e.target&&e.target.nodeType===3?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&le.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[le.expando]=!0},le.Event.prototype={constructor:le.Event,isDefaultPrevented:Ef,isPropagationStopped:Ef,isImmediatePropagationStopped:Ef,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Sf,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Sf,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Sf,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},le.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},le.event.addProp),le.each({focus:"focusin",blur:"focusout"},function(e,t){le.event.special[e]={setup:function(){return LS(this,e,rZ),!1},trigger:function(){return LS(this,e),!0},_default:function(){return!0},delegateType:t}}),le.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){le.event.special[e]={delegateType:t,bindType:t,handle:function(r){var n,i=this,o=r.relatedTarget,a=r.handleObj;return(!o||o!==i&&!le.contains(i,o))&&(r.type=a.origType,n=a.handler.apply(this,arguments),r.type=t),n}}}),le.fn.extend({on:function(e,t,r,n){return cG(this,e,t,r,n)},one:function(e,t,r,n){return cG(this,e,t,r,n,1)},off:function(e,t,r){var n,i;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,le(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if(typeof e=="object"){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||typeof t=="function")&&(r=t,t=void 0),r===!1&&(r=Ef),this.each(function(){le.event.remove(this,e,r,t)})}}),uG=new RegExp("^("+B5+")(?!px)[a-z%]+$","i"),RS=function(e){var t=e.ownerDocument.defaultView;return(!t||!t.opener)&&(t=window),t.getComputedStyle(e)},z5=function(e,t,r){var n,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];n=r.call(e);for(i in t)e.style[i]=o[i];return n},iZ=new RegExp(Tu.join("|"),"i"),function(){function e(){if(c){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Cf.appendChild(l).appendChild(c);var d=window.getComputedStyle(c);r=d.top!=="1%",s=t(d.marginLeft)===12,c.style.right="60%",o=t(d.right)===36,n=t(d.width)===36,c.style.position="absolute",i=t(c.offsetWidth/3)===12,Cf.removeChild(l),c=null}}function t(d){return Math.round(parseFloat(d))}var r,n,i,o,a,s,l=En.createElement("div"),c=En.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",Tn.clearCloneStyle=c.style.backgroundClip==="content-box",le.extend(Tn,{boxSizingReliable:function(){return e(),n},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),r},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var d,u,p,g;return a==null&&(d=En.createElement("table"),u=En.createElement("tr"),p=En.createElement("div"),d.style.cssText="position:absolute;left:-11111px;border-collapse:separate",u.style.cssText="border:1px solid",u.style.height="1px",p.style.height="9px",p.style.display="block",Cf.appendChild(d).appendChild(u).appendChild(p),g=window.getComputedStyle(u),a=parseInt(g.height,10)+parseInt(g.borderTopWidth,10)+parseInt(g.borderBottomWidth,10)===u.offsetHeight,Cf.removeChild(d)),a}}))}(),k5=["Webkit","Moz","ms"],H5=En.createElement("div").style,_5={},aZ=/^(none|table(?!-c[ea]).+)/,A5=/^--/,sZ={position:"absolute",visibility:"hidden",display:"block"},M5={letterSpacing:"0",fontWeight:"400"},le.extend({cssHooks:{opacity:{get:function(e,t){if(t){var r=Yx(e,"opacity");return r===""?"1":r}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,r,n){if(!(!e||e.nodeType===3||e.nodeType===8||!e.style)){var i,o,a,s=pp(t),l=A5.test(t),c=e.style;if(l||(t=I5(s)),a=le.cssHooks[t]||le.cssHooks[s],r!==void 0){if(o=typeof r,o==="string"&&(i=OS.exec(r))&&i[1]&&(r=tZ(e,t,i),o="number"),r==null||r!==r)return;o==="number"&&!l&&(r+=i&&i[3]||(le.cssNumber[s]?"":"px")),!Tn.clearCloneStyle&&r===""&&t.indexOf("background")===0&&(c[t]="inherit"),(!a||!("set"in a)||(r=a.set(e,r,n))!==void 0)&&(l?c.setProperty(t,r):c[t]=r)}else return a&&"get"in a&&(i=a.get(e,!1,n))!==void 0?i:c[t]}},css:function(e,t,r,n){var i,o,a,s=pp(t),l=A5.test(t);return l||(t=I5(s)),a=le.cssHooks[t]||le.cssHooks[s],a&&"get"in a&&(i=a.get(e,!0,r)),i===void 0&&(i=Yx(e,t,n)),i==="normal"&&t in M5&&(i=M5[t]),r===""||r?(o=parseFloat(i),r===!0||isFinite(o)?o||0:i):i}}),le.each(["height","width"],function(e,t){le.cssHooks[t]={get:function(r,n,i){if(n)return aZ.test(le.css(r,"display"))&&(!r.getClientRects().length||!r.getBoundingClientRect().width)?z5(r,sZ,function(){return G5(r,t,i)}):G5(r,t,i)},set:function(r,n,i){var o,a=RS(r),s=!Tn.scrollboxSize()&&a.position==="absolute",l=s||i,c=l&&le.css(r,"boxSizing",!1,a)==="border-box",d=i?dG(r,t,i,c,a):0;return c&&s&&(d-=Math.ceil(r["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(a[t])-dG(r,t,"border",!1,a)-.5)),d&&(o=OS.exec(n))&&(o[3]||"px")!=="px"&&(r.style[t]=n,n=le.css(r,t)),K5(r,n,d)}}}),le.cssHooks.marginLeft=q5(Tn.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Yx(e,"marginLeft"))||e.getBoundingClientRect().left-z5(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),le.each({margin:"",padding:"",border:"Width"},function(e,t){le.cssHooks[e+t]={expand:function(r){for(var n=0,i={},o=typeof r=="string"?r.split(" "):[r];n<4;n++)i[e+Tu[n]+t]=o[n]||o[n-2]||o[0];return i}},e!=="margin"&&(le.cssHooks[e+t].set=K5)}),le.fn.extend({css:function(e,t){return Xx(this,function(r,n,i){var o,a,s={},l=0;if(Array.isArray(n)){for(o=RS(r),a=n.length;l<a;l++)s[n[l]]=le.css(r,n[l],!1,o);return s}return i!==void 0?le.style(r,n,i):le.css(r,n)},e,t,arguments.length>1)}}),function(){var e=En.createElement("input"),t=En.createElement("select"),r=t.appendChild(En.createElement("option"));e.type="checkbox",Tn.checkOn=e.value!=="",Tn.optSelected=r.selected,e=En.createElement("input"),e.value="t",e.type="radio",Tn.radioValue=e.value==="t"}(),Tn.focusin="onfocusin"in window,L5=/^(?:focusinfocus|focusoutblur)$/,P5=function(e){e.stopPropagation()},le.extend(le.event,{trigger:function(e,t,r,n){var i,o,a,s,l,c,d,u,p=[r||En],g=MS.call(e,"type")?e.type:e,f=MS.call(e,"namespace")?e.namespace.split("."):[];if(o=u=a=r=r||En,!(r.nodeType===3||r.nodeType===8)&&!L5.test(g+le.event.triggered)&&(g.indexOf(".")>-1&&(f=g.split("."),g=f.shift(),f.sort()),l=g.indexOf(":")<0&&"on"+g,e=e[le.expando]?e:new le.Event(g,typeof e=="object"&&e),e.isTrigger=n?2:3,e.namespace=f.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=r),t=t==null?[e]:le.makeArray(t,[e]),d=le.event.special[g]||{},!(!n&&d.trigger&&d.trigger.apply(r,t)===!1))){if(!n&&!d.noBubble&&!Tf(r)){for(s=d.delegateType||g,L5.test(s+g)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(r.ownerDocument||En)&&p.push(a.defaultView||a.parentWindow||window)}for(i=0;(o=p[i++])&&!e.isPropagationStopped();)u=o,e.type=i>1?s:d.bindType||g,c=(Qo.get(o,"events")||Object.create(null))[e.type]&&Qo.get(o,"handle"),c&&c.apply(o,t),c=l&&o[l],c&&c.apply&&GS(o)&&(e.result=c.apply(o,t),e.result===!1&&e.preventDefault());return e.type=g,!n&&!e.isDefaultPrevented()&&(!d._default||d._default.apply(p.pop(),t)===!1)&&GS(r)&&l&&gp(r[g])&&!Tf(r)&&(a=r[l],a&&(r[l]=null),le.event.triggered=g,e.isPropagationStopped()&&u.addEventListener(g,P5),r[g](),e.isPropagationStopped()&&u.removeEventListener(g,P5),le.event.triggered=void 0,a&&(r[l]=a)),e.result}},simulate:function(e,t,r){var n=le.extend(new le.Event,r,{type:e,isSimulated:!0});le.event.trigger(n,null,t)}}),le.fn.extend({trigger:function(e,t){return this.each(function(){le.event.trigger(e,t,this)})},triggerHandler:function(e,t){var r=this[0];if(r)return le.event.trigger(e,t,r,!0)}}),Tn.focusin||le.each({focus:"focusin",blur:"focusout"},function(e,t){var r=function(n){le.event.simulate(t,n.target,le.event.fix(n))};le.event.special[t]={setup:function(){var n=this.ownerDocument||this.document||this,i=Qo.access(n,t);i||n.addEventListener(e,r,!0),Qo.access(n,t,(i||0)+1)},teardown:function(){var n=this.ownerDocument||this.document||this,i=Qo.access(n,t)-1;i?Qo.access(n,t,i):(n.removeEventListener(e,r,!0),Qo.remove(n,t))}}}),lZ=/\[\]$/,le.param=function(e,t){var r,n=[],i=function(o,a){var s=gp(a)?a():a;n[n.length]=encodeURIComponent(o)+"="+encodeURIComponent(s==null?"":s)};if(e==null)return"";if(Array.isArray(e)||e.jquery&&!le.isPlainObject(e))le.each(e,function(){i(this.name,this.value)});else for(r in e)pG(r,e[r],t,i);return n.join("&")},le.offset={setOffset:function(e,t,r){var n,i,o,a,s,l,c,d=le.css(e,"position"),u=le(e),p={};d==="static"&&(e.style.position="relative"),s=u.offset(),o=le.css(e,"top"),l=le.css(e,"left"),c=(d==="absolute"||d==="fixed")&&(o+l).indexOf("auto")>-1,c?(n=u.position(),a=n.top,i=n.left):(a=parseFloat(o)||0,i=parseFloat(l)||0),gp(t)&&(t=t.call(e,r,le.extend({},s))),t.top!=null&&(p.top=t.top-s.top+a),t.left!=null&&(p.left=t.left-s.left+i),"using"in t?t.using.call(e,p):u.css(p)}},le.fn.extend({offset:function(e){if(arguments.length)return e===void 0?this:this.each(function(i){le.offset.setOffset(this,e,i)});var t,r,n=this[0];if(n)return n.getClientRects().length?(t=n.getBoundingClientRect(),r=n.ownerDocument.defaultView,{top:t.top+r.pageYOffset,left:t.left+r.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var e,t,r,n=this[0],i={top:0,left:0};if(le.css(n,"position")==="fixed")t=n.getBoundingClientRect();else{for(t=this.offset(),r=n.ownerDocument,e=n.offsetParent||r.documentElement;e&&(e===r.body||e===r.documentElement)&&le.css(e,"position")==="static";)e=e.parentNode;e&&e!==n&&e.nodeType===1&&(i=le(e).offset(),i.top+=le.css(e,"borderTopWidth",!0),i.left+=le.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-le.css(n,"marginTop",!0),left:t.left-i.left-le.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&le.css(e,"position")==="static";)e=e.offsetParent;return e||Cf})}}),le.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var r=t==="pageYOffset";le.fn[e]=function(n){return Xx(this,function(i,o,a){var s;if(Tf(i)?s=i:i.nodeType===9&&(s=i.defaultView),a===void 0)return s?s[t]:i[o];s?s.scrollTo(r?s.pageXOffset:a,r?a:s.pageYOffset):i[o]=a},e,n,arguments.length)}}),le.each(["top","left"],function(e,t){le.cssHooks[t]=q5(Tn.pixelPosition,function(r,n){if(n)return n=Yx(r,t),uG.test(n)?le(r).position()[t]+"px":n})}),le.each({Height:"height",Width:"width"},function(e,t){le.each({padding:"inner"+e,content:t,"":"outer"+e},function(r,n){le.fn[n]=function(i,o){var a=arguments.length&&(r||typeof i!="boolean"),s=r||(i===!0||o===!0?"margin":"border");return Xx(this,function(l,c,d){var u;return Tf(l)?n.indexOf("outer")===0?l["inner"+e]:l.document.documentElement["client"+e]:l.nodeType===9?(u=l.documentElement,Math.max(l.body["scroll"+e],u["scroll"+e],l.body["offset"+e],u["offset"+e],u["client"+e])):d===void 0?le.css(l,c,s):le.style(l,c,d,s)},t,a?i:void 0,a)}})}),le.fn.extend({bind:function(e,t,r){return this.on(e,null,t,r)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,r,n){return this.on(t,e,r,n)},undelegate:function(e,t,r){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",r)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),le.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){le.fn[t]=function(r,n){return arguments.length>0?this.on(t,null,r,n):this.trigger(t)}}),cZ=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,le.isArray=Array.isArray,le.parseJSON=JSON.parse,le.nodeName=vf,le.isFunction=gp,le.isWindow=Tf,le.camelCase=pp,le.type=VS,le.now=Date.now,le.isNumeric=function(e){var t=le.type(e);return(t==="number"||t==="string")&&!isNaN(e-parseFloat(e))},le.trim=function(e){return e==null?"":(e+"").replace(cZ,"")},dZ=window.jQuery,pZ=window.$,le.noConflict=function(e){return window.$===le&&(window.$=pZ),e&&window.jQuery===le&&(window.jQuery=dZ),le},typeof noGlobal=="undefined"&&(window.jQuery=window.$=le),ee=le}),ne=__dcg_shared_module_exports__.c((e,t)=>{iB(),mg(),Ss(),E5(),qt(),sd.addWarningHandler(r=>void 0),sd.addCustomAttribute("href",r=>{let n=mS(r());return{value:`${mS(r())}`,bindings:{onMount(i){if(!["a","use"].includes(i.tagName.toLowerCase()))throw new Error("Cannot have an href on a non-link element.")},onUpdate(i){let o=mS(r());n!==o&&(n=o,i.setAttribute("href",o))}}}}),sd.addCustomAttribute("onTap",r=>({value:"",bindings:{onMount(n){ee(n).on("dcg-tap",r)}}})),sd.addCustomAttribute("onTapStart",r=>({bindings:{onMount(n){ee(n).on("dcg-tapstart",r)}}})),sd.addCustomAttribute("onTapMove",r=>({bindings:{onMount(n){ee(n).on("dcg-tapmove",r)}}})),sd.addCustomAttribute("onTapEnd",r=>({bindings:{onMount(n){ee(n).on("dcg-tapend",r)}}})),sd.addCustomAttribute("onLongHold",r=>({bindings:{onMount(n){ee(n).on("dcg-longhold",r)}}})),sd.addCustomAttribute("manageFocus",r=>r()===void 0?{}:{bindings:{onMount(n){r().shouldBeFocused()&&n.focus(),n.onfocus=function(i){r().shouldBeFocused()||r().onFocusedChanged(!0,i)},n.onblur=function(i){r().shouldBeFocused()&&i.target!==document.activeElement&&r().onFocusedChanged(!1,i)}},onUpdate(n){let i=r().shouldBeFocused(),o=document.activeElement===n;i&&!o?n.focus():o&&!i&&n.blur()},willUnmount(n){n.onfocus=null,n.onblur=null}}}),t.exports=sd}),CU=__dcg_shared_module_exports__.c(e=>{var t=e&&e.__extends||function(){var n=function(i,o){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,s){a.__proto__=s}||function(a,s){for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(a[l]=s[l])},n(i,o)};return function(i,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");n(i,o);function a(){this.constructor=i}i.prototype=o===null?Object.create(o):(a.prototype=o.prototype,new a)}}(),r=e&&e.__assign||function(){return r=Object.assign||function(n){for(var i,o=1,a=arguments.length;o<a;o++){i=arguments[o];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])}return n},r.apply(this,arguments)};(function(){var n=-1,i=1,o=Math.min,a=Math.max;function s(){}function l(k){for(;k;){if(!k.parent)return k;k=k.parent}}function c(k,b,h){if(!b){var m=new Error("prayer failed: "+k);if(h){var S={};m.dcgExtraErrorMetaData=S;for(var A in h){var q=h[A],Y=S[A]={};if(q){Y.localLatex=q.latex();var Q=l(q);Q&&(Y.rootLatex=Q.latex())}else Y.emptyNode=!0}}throw m}}function d(k){c("a direction was passed",k===n||k===i)}function u(k){var b=document.implementation.createHTMLDocument("");if(b.body.innerHTML=k,b.body.children.length===1)return b.body.children[0];for(var h=document.createDocumentFragment();b.body.firstChild;)h.appendChild(b.body.firstChild);return h}var p=function(k,b,h){var m;switch(k){case"svg":case"path":m=document.createElementNS("http://www.w3.org/2000/svg",k);break;default:m=document.createElement(k)}for(var S in b){var A=b[S];A!==void 0&&m.setAttribute(S,typeof A=="string"?A:String(A))}if(h)for(var q=0;q<h.length;q++)m.appendChild(h[q]);return m};p.text=function(k){return document.createTextNode(k)},p.block=function(k,b,h,m){var S=[h.html()];m!=null&&m.beforeChild&&S.unshift(m.beforeChild),m!=null&&m.afterChild&&S.push(m.afterChild);var A=p(k,b,S);return h.setDOM(A),G.linkElementByBlockNode(A,h),A},p.entityText=function(k){var b=u(k);return c("entity parses to a single text node",b instanceof DocumentFragment&&b.childNodes.length===1&&b.childNodes[0]instanceof Text),b.childNodes[0]};function g(k,b){var h,m;if(typeof(k==null?void 0:k.closest)=="function")return k.closest(b);if(!(k instanceof HTMLElement))return null;var S=Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,A=k;do{if(S.call(A,b))return A;A=(m=(h=A==null?void 0:A.parentElement)!==null&&h!==void 0?h:A==null?void 0:A.parentNode)!==null&&m!==void 0?m:null}while(A!==null&&A.nodeType===1);return null}var f=" ",y="​",E="˙",_="∑",w="∏",v="∐",T="∫";function M(k){return k.getClientRects().length?k.getBoundingClientRect():{top:0,left:0,height:0,width:0,x:0,y:0,bottom:0,right:0}}function C(){return window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft}function P(){return window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}var F=function(){var k,b;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(k=requestAnimationFrame,b=cancelAnimationFrame):(k=function(h){return setTimeout(h,13)},b=clearTimeout),function(h,m){var S=Date.now(),A,q=0;function Y(){var Ae=(Date.now()-S)/h;Ae<=q?be():q=Ae,m(q,be,Q)}function Q(){A!==void 0&&b(A),A=void 0}function be(){Q(),A=k(Y)}m(h<=0?1:0,be,Q)}}(),B=function(){function k(b){this.span=p("span",{class:"dcg-mq-aria-alert","aria-live":"assertive","aria-atomic":"true"}),this.msg="",this.items=[],this.controller=b}return k.prototype.attach=function(){var b=this.controller.container;this.span.parentNode!==b&&L(b).prepend(L(this.span))},k.prototype.queue=function(b,h){h===void 0&&(h=!1);var m="";if(b instanceof me){var S=b.mathspeak({ignoreShorthand:!0});h&&(b.parent&&b.parent.ariaLabel&&b.ariaLabel==="block"?m=b.parent.ariaLabel+" "+S:b.ariaLabel&&(m=b.ariaLabel+" "+S)),m===""&&(m=S)}else m=b||"";return this.items.push(m),this},k.prototype.queueDirOf=function(b){return d(b),this.queue(b===n?"before":"after")},k.prototype.queueDirEndOf=function(b){return d(b),this.queue(b===n?"beginning of":"end of")},k.prototype.alert=function(b){return this.attach(),b&&this.queue(b),this.items.length&&(this.msg=this.items.join(" ").replace(/ +(?= )/g,"").trim(),this.controller.containerHasFocus()&&(this.controller.options.logAriaAlerts&&this.msg&&console.log(this.msg),this.span.textContent=this.msg)),this.clear()},k.prototype.clear=function(b){return this.items.length=0,b!=null&&b.emptyContent&&(this.span.textContent=""),this},k}(),x=function(){function k(b,h){var m;arguments.length===1&&(h=b),!(!b||!h)&&(this.ends=(m={},m[n]=b,m[i]=h,m))}return k.create=function(b,h){arguments.length===1&&(h=b),c("No half-empty DOMFragments",!!b==!!h);var m=new k(b,h);return c("last is a forward sibling of first",m.isValid()),m},k.prototype.isEmpty=function(){return this.ends===void 0},k.prototype.isOneNode=function(){return!!(this.ends&&this.ends[n]===this.ends[i])},k.prototype.isValid=function(){if(!this.ends||this.ends[n]===this.ends[i])return!0;var b;return this.eachNode(function(h){return b=h}),b===this.ends[i]},k.prototype.firstNode=function(){return c("Fragment is not empty",this.ends),this.ends[n]},k.prototype.lastNode=function(){return c("Fragment is not empty",this.ends),this.ends[i]},k.prototype.children=function(){var b=this.oneNode(),h=b.firstChild,m=b.lastChild;return h&&m?new k(h,m):new k},k.prototype.join=function(b){if(!this.ends)return b;if(!b.ends)return this;for(var h=!1,m=this.ends[i].nextSibling;m;){if(m===b.ends[n]){h=!0;break}m=m.nextSibling}return c("sibling must be a forward DOM sibling of this fragment",h),new k(this.ends[n],b.ends[i])},k.prototype.oneNode=function(){return c("Fragment has a single node",this.ends&&this.ends[n]===this.ends[i]),this.ends[n]},k.prototype.oneElement=function(){var b=this.oneNode();return c("Node is an Element",b.nodeType===Node.ELEMENT_NODE),b},k.prototype.oneText=function(){var b=this.oneNode();return c("Node is Text",b.nodeType===Node.TEXT_NODE),b},k.prototype.eachNode=function(b){if(!this.ends)return this;for(var h=this.ends[i],m=this.ends[n],S=void 0;m&&(S=m.nextSibling,b(m),m!==h);m=S);return this},k.prototype.eachElement=function(b){return this.eachNode(function(h){h.nodeType===Node.ELEMENT_NODE&&b(h)}),this},k.prototype.text=function(){var b="";return this.eachNode(function(h){b+=h.textContent||""}),b},k.prototype.toNodeArray=function(){var b=[];return this.eachNode(function(h){return b.push(h)}),b},k.prototype.toElementArray=function(){var b=[];return this.eachElement(function(h){return b.push(h)}),b},k.prototype.toDocumentFragment=function(){var b=document.createDocumentFragment();return this.eachNode(function(h){return b.appendChild(h)}),b},k.prototype.insertBefore=function(b){return this.insDirOf(n,b)},k.prototype.insertAfter=function(b){return this.insDirOf(i,b)},k.prototype.append=function(b){return b.appendTo(this.oneElement()),this},k.prototype.prepend=function(b){return b.prependTo(this.oneElement()),this},k.prototype.appendTo=function(b){return this.insAtDirEnd(i,b)},k.prototype.prependTo=function(b){return this.insAtDirEnd(n,b)},k.prototype.parent=function(){if(!this.ends)return this;var b=this.ends[n].parentNode;return b?new k(b):new k},k.prototype.wrapAll=function(b){if(b.textContent="",!this.ends)return this;var h=this.ends[n].parentNode,m=this.ends[i].nextSibling;return this.appendTo(b),h&&h.insertBefore(b,m),this},k.prototype.replaceWith=function(b){var h,m=(h=this.ends)===null||h===void 0?void 0:h[i],S=m==null?void 0:m.parentNode,A=m==null?void 0:m.nextSibling;this.detach();var q=b.toDocumentFragment();return!m||!S?this:(S.insertBefore(q,A||null),this)},k.prototype.nthElement=function(b){if(this.ends&&!(b<0||b!==Math.floor(b)))for(var h=this.ends[n];h;){if(h.nodeType===Node.ELEMENT_NODE){if(b<=0)return h;b-=1}if(h===this.ends[i])return;h=h.nextSibling}},k.prototype.firstElement=function(){return this.nthElement(0)},k.prototype.lastElement=function(){if(this.ends)for(var b=this.ends[i];b;){if(b.nodeType===Node.ELEMENT_NODE)return b;if(b===this.ends[n])return;b=b.previousSibling}},k.prototype.first=function(){return new k(this.firstElement())},k.prototype.last=function(){return new k(this.lastElement())},k.prototype.eq=function(b){return new k(this.nthElement(b))},k.prototype.slice=function(b){if(!this.ends)return this;var h=this.nthElement(b);return h?new k(h,this.ends[i]):new k},k.prototype.next=function(){for(var b=this.oneNode();b;)if(b=b.nextSibling,b&&b.nodeType===Node.ELEMENT_NODE)return new k(b);return new k},k.prototype.prev=function(){for(var b=this.oneNode();b;)if(b=b.previousSibling,b&&b.nodeType===Node.ELEMENT_NODE)return new k(b);return new k},k.prototype.empty=function(){return this.eachElement(function(b){b.textContent=""}),this},k.prototype.remove=function(){return this.toDocumentFragment(),this},k.prototype.detach=function(){return this.remove()},k.prototype.insDirOf=function(b,h){var m;if(!this.ends)return this;var S=(m=h.ends)===null||m===void 0?void 0:m[b];return!S||!S.parentNode?this.detach():(N(b,S.parentNode,this.toDocumentFragment(),S),this)},k.prototype.insAtDirEnd=function(b,h){return this.ends?(O(b,this.toDocumentFragment(),h),this):this},k.prototype.hasClass=function(b){var h=!1;return this.eachElement(function(m){m.classList.contains(b)&&(h=!0)}),h},k.prototype.addClass=function(b){for(var h=function(Y){if(!Y)return"continue";m.eachElement(function(Q){Q.classList.add(Y)})},m=this,S=0,A=b.split(/\s+/);S<A.length;S++){var q=A[S];h(q)}return this},k.prototype.removeClass=function(b){for(var h=function(Y){if(!Y)return"continue";m.eachElement(function(Q){Q.classList.remove(Y)})},m=this,S=0,A=b.split(/\s+/);S<A.length;S++){var q=A[S];h(q)}return this},k.prototype.toggleClass=function(b,h){if(h===!0)return this.addClass(b);if(h===!1)return this.removeClass(b);for(var m=function(Q){if(!Q)return"continue";S.eachElement(function(be){be.classList.toggle(Q)})},S=this,A=0,q=b.split(/\s+/);A<q.length;A++){var Y=q[A];m(Y)}return this},k}(),L=x.create;function N(k,b,h,m){b.insertBefore(h,k===n?m:m.nextSibling)}function O(k,b,h){k===n?h.insertBefore(b,h.firstChild):h.appendChild(b)}var z=function(){function k(b,h,m){this.init(b,h,m)}return k.prototype.init=function(b,h,m){this.parent=b,this[n]=h,this[i]=m},k.copy=function(b){return new k(b.parent,b[n],b[i])},k}();function V(k,b){var h=k[n];if(h){var m=k[i];if(m)for(m=m[i];h!==m;h=h[i]){var S=b(h);if(S===!1)break}}}function $(k,b,h){var m=k[n];if(!m)return b;var S=k[i];if(!S)return b;for(S=S[i];m!==S;m=m[i])b=h(b,m);return b}var G=function(){function k(){var m;this[b]=0,this[h]=0,this.parent=0,this.ends=(m={},m[n]=0,m[i]=0,m),this.id=k.uniqueNodeId()}k.uniqueNodeId=function(){return k.idCounter+=1},k.getNodeOfElement=function(m){if(m){if(!m.nodeType)throw new Error("must pass an Element to NodeBase.getNodeOfElement");var S=m;return S.mqBlockNode||S.mqCmdNode}},k.linkElementByBlockNode=function(m,S){m.mqBlockNode=S},k.linkElementByCmdNode=function(m,S){m.mqCmdNode=S},k.prototype.setEnds=function(m){this.ends=m,c("No half-empty node ends",!!this.ends[n]==!!this.ends[i])},k.prototype.getEnd=function(m){return this.ends[m]},k.prototype.toString=function(){return"{{ MathQuill Node #"+this.id+" }}"},k.prototype.setDOM=function(m){return m&&c("DOM is an element or a text node",m.nodeType===Node.ELEMENT_NODE||m.nodeType===Node.TEXT_NODE),this._el=m,this},k.prototype.domFrag=function(){return L(this._el)},k.prototype.createDir=function(m,S){d(m);var A=this;return A.html(),A.domFrag().insDirOf(m,S.domFrag()),S[m]=A.adopt(S.parent,S[n],S[i]),A},k.prototype.createLeftOf=function(m){this.createDir(n,m)},k.prototype.selectChildren=function(m,S){return new H(m,S)},k.prototype.bubble=function(m){for(var S=this.getSelfNode(),A=S;A;A=A.parent){var q=m(A);if(q===!1)break}return this},k.prototype.postOrder=function(m){var S=this.getSelfNode();return function A(q){return q?(q.eachChild(A),m(q),!0):!1}(S),S},k.prototype.isEmpty=function(){return this.ends[n]===0&&this.ends[i]===0},k.prototype.isQuietEmptyDelimiter=function(m){if(!this.isEmpty()||!m||!this.parent||this.parent.ctrlSeq===void 0)return!1;var S=this.parent.ctrlSeq.replace(/^\\(left|right)?/,"");return m.hasOwnProperty(S)},k.prototype.isStyleBlock=function(){return!1},k.prototype.isTextBlock=function(){return!1},k.prototype.children=function(){return new U(this.getEnd(n),this.getEnd(i))},k.prototype.eachChild=function(m){return V(this.ends,m),this},k.prototype.foldChildren=function(m,S){return $(this.ends,m,S)},k.prototype.withDirAdopt=function(m,S,A,q){var Y=this.getSelfNode();return new U(Y,Y).withDirAdopt(m,S,A,q),this},k.prototype.adopt=function(m,S,A){var q=this.getSelfNode();return new U(q,q).adopt(m,S,A),this.getSelfNode()},k.prototype.disown=function(){var m=this.getSelfNode();return new U(m,m).disown(),this},k.prototype.remove=function(){return this.domFrag().remove(),this.disown()},k.prototype.shouldIgnoreSubstitutionInSimpleSubscript=function(m){var S=m.disableAutoSubstitutionInSubscripts;if(!S||!this.parent||!(this.parent.parent instanceof Qr))return!1;var A=this.parent.parent[n];return!(typeof S=="object"&&A instanceof Bt&&A.endsWord&&S.except[A.endsWord]||!this.parent.domFrag().hasClass("dcg-mq-sub"))},k.prototype.getSelfNode=function(){return this},k.prototype.parser=function(){c("Abstract parser() method is never called",!1)},k.prototype.html=function(){throw new Error("html() unimplemented in NodeBase")},k.prototype.text=function(){return""},k.prototype.latex=function(){var m={latex:"",startIndex:-1,endIndex:-1};return this.latexRecursive(m),m.latex},k.prototype.latexRecursive=function(m){},k.prototype.checkCursorContextOpen=function(m){m.startSelectionBefore===this&&(m.startIndex=m.latex.length),m.endSelectionBefore===this&&(m.endIndex=m.latex.length)},k.prototype.checkCursorContextClose=function(m){m.startSelectionAfter===this&&(m.startIndex=m.latex.length),m.endSelectionAfter===this&&(m.endIndex=m.latex.length)},k.prototype.finalizeTree=function(m,S){},k.prototype.contactWeld=function(m,S){},k.prototype.blur=function(m){},k.prototype.focus=function(){},k.prototype.intentionalBlur=function(){},k.prototype.reflow=function(){},k.prototype.registerInnerField=function(m,S){},k.prototype.chToCmd=function(m,S){c("Abstract chToCmd() method is never called",!1)},k.prototype.mathspeak=function(m){return""},k.prototype.seek=function(m,S){},k.prototype.siblingDeleted=function(m,S){},k.prototype.siblingCreated=function(m,S){},k.prototype.finalizeInsert=function(m,S){},k.prototype.fixDigitGrouping=function(m){},k.prototype.writeLatex=function(m,S){},k.prototype.write=function(m,S){};var b,h;return b=n,h=i,k.idCounter=0,k}();function W(k,b,h){c("a parent is always present",k),c("leftward is properly set up",function(){return b?b[i]===h&&b.parent===k:k.getEnd(n)===h}(),{parent:k,leftward:b,leftwardL:b&&b[n],leftwardR:b&&b[i],rightwardL:h&&h[n],rightwardR:h&&h[i]}),c("rightward is properly set up",function(){return h?h[n]===b&&h.parent===k:k.getEnd(i)===b}(),{parent:k,rightward:h,leftwardL:b&&b[n],leftwardR:b&&b[i],rightwardL:h&&h[n],rightwardR:h&&h[i],rightwardParent:h&&h.parent})}var U=function(){function k(b,h,m){var S,A;if(this.disowned=!1,m===void 0&&(m=n),d(m),c("no half-empty fragments",!b==!h,{withDir:b,oppDir:h}),!b||!h){this.setEnds((S={},S[n]=0,S[i]=0,S));return}c("withDir is passed to Fragment",b instanceof me),c("oppDir is passed to Fragment",h instanceof me),c("withDir and oppDir have the same parent",b.parent===h.parent);var q=(A={},A[m]=b,A[-m]=h,A);this.setEnds(q);var Y=0;this.each(function(Q){Y=Q}),c("following direction siblings from start reaches end",Y===q[i])}return k.prototype.getDOMFragFromEnds=function(){var b=this.ends[n],h=this.ends[i];return b===0||h===0?L():b===h?b.domFrag():b.domFrag().join(h.domFrag())},k.prototype.setEnds=function(b){this.ends=b},k.prototype.getEnd=function(b){return this.ends?this.ends[b]:0},k.prototype.domFrag=function(){return this.getDOMFragFromEnds()},k.prototype.withDirAdopt=function(b,h,m,S){return b===n?this.adopt(h,m,S):this.adopt(h,S,m)},k.prototype.adopt=function(b,h,m){var S;W(b,h,m);var A=this;this.disowned=!1;var q=A.ends[n];if(!q)return this;var Y=A.ends[i];if(!Y)return this;var Q=(S={},S[n]=b.getEnd(n),S[i]=b.getEnd(i),S);return h||(Q[n]=q),m?m[n]=Y:Q[i]=Y,b.setEnds(Q),Y[i]=m,A.each(function(be){return be[n]=h,be.parent=b,h&&(h[i]=be),h=be,!0}),A},k.prototype.disown=function(){var b,h=this,m=h.ends[n];if(!m||h.disowned)return h;this.disowned=!0;var S=h.ends[i];if(!S)return h;var A=m.parent;W(A,m[n],m),W(A,S,S[i]);var q=(b={},b[n]=A.getEnd(n),b[i]=A.getEnd(i),b);if(m[n]){var Y=m[n];Y[i]=S[i]}else q[n]=S[i];if(S[i]){var Q=S[i];Q[n]=m[n]}else q[i]=m[n];return q[n]&&q[i]?A.setEnds(q):A.ends=q,h},k.prototype.remove=function(){return this.domFrag().remove(),this.disown()},k.prototype.each=function(b){return V(this.ends,b),this},k.prototype.fold=function(b,h){return $(this.ends,b,h)},k}(),D={},de={};function ge(k){return k&&k.prototype instanceof me}var K=function(k){t(b,k);function b(h,m,S){var A=k.call(this,h,m,S)||this;return A.ancestors={},A}return b.fromCursor=function(h){return new b(h.parent,h[n],h[i])},b}(z),se=function(k){t(b,k);function b(h,m,S){var A=k.call(this,h,0,0)||this;return A.upDownCache={},A.cursorElement=p("span",{class:"dcg-mq-cursor"},[p.text(y)]),A._domFrag=L(),A.controller=S,A.options=m,A.setDOMFrag(L(A.cursorElement)),A.blink=function(){L(A.cursorElement).toggleClass("dcg-mq-blink")},A}return b.prototype.setDOMFrag=function(h){return this._domFrag=h,this},b.prototype.domFrag=function(){return this._domFrag},b.prototype.show=function(){if(L(this.cursorElement).removeClass("dcg-mq-blink"),this.setDOMFrag(L(this.cursorElement)),this.intervalId)clearInterval(this.intervalId);else{var h=this[i];if(h){var m=this.selection;m&&m.getEnd(n)[n]===this[n]?this.domFrag().insertBefore(m.domFrag()):this.domFrag().insertBefore(h.domFrag())}else this.domFrag().appendTo(this.parent.domFrag().oneElement());this.parent.focus()}return this.intervalId=setInterval(this.blink,500),this},b.prototype.hide=function(){return this.intervalId&&clearInterval(this.intervalId),this.intervalId=0,this.domFrag().detach(),this.setDOMFrag(L()),this},b.prototype.withDirInsertAt=function(h,m,S,A){var q=this.parent;this.parent=m,this[h]=S,this[-h]=A,q!==m&&q.blur&&q.blur(this)},b.prototype.insDirOf=function(h,m){return d(h),this.domFrag().insDirOf(h,m.domFrag()),this.withDirInsertAt(h,m.parent,m[h],m),this.parent.domFrag().addClass("dcg-mq-hasCursor"),this},b.prototype.insLeftOf=function(h){return this.insDirOf(n,h)},b.prototype.insRightOf=function(h){return this.insDirOf(i,h)},b.prototype.insAtDirEnd=function(h,m){return d(h),this.domFrag().insAtDirEnd(h,m.domFrag().oneElement()),this.withDirInsertAt(h,m,0,m.getEnd(h)),m.focus(),this},b.prototype.insAtLeftEnd=function(h){return this.insAtDirEnd(n,h)},b.prototype.insAtRightEnd=function(h){return this.insAtDirEnd(i,h)},b.prototype.jumpUpDown=function(h,m){var S=this;S.upDownCache[h.id]=z.copy(S);var A=S.upDownCache[m.id];if(A){var q=A[i];q?S.insLeftOf(q):S.insAtRightEnd(A.parent)}else{var Y=S.getBoundingClientRectWithoutMargin().left;m.seek(Y,S)}S.controller.aria.queue(m,!0)},b.prototype.getBoundingClientRectWithoutMargin=function(){var h=this.domFrag();h.removeClass("dcg-mq-cursor");var m=M(h.oneElement()),S=m.left,A=m.right;return h.addClass("dcg-mq-cursor"),{left:S,right:A}},b.prototype.unwrapGramp=function(){var h=this.parent.parent,m=h.parent,S=h[i],A=this,q=h[n];if(h.disown().eachChild(function(Ce){return Ce.isEmpty()||(Ce.children().adopt(m,q,S).each(function(Ye){return Ye.domFrag().insertBefore(h.domFrag()),!0}),q=Ce.getEnd(i)),!0}),!this[i]){var Y=this[n];if(Y)this[i]=Y[i];else for(;!this[i];){var Q=this.parent[i];if(Q)this.parent=Q,this[i]=Q.getEnd(n);else{this[i]=h[i],this.parent=m;break}}}var be=this[i];be?this.insLeftOf(be):this.insAtRightEnd(m),h.domFrag().remove();var Ae=h[n],Ne=h[i];Ae&&Ae.siblingDeleted(A.options,i),Ne&&Ne.siblingDeleted(A.options,n)},b.prototype.startSelection=function(){for(var h=this.anticursor=K.fromCursor(this),m=h.ancestors,S=h;S.parent;S=S.parent)m[S.parent.id]=S},b.prototype.endSelection=function(){delete this.anticursor},b.prototype.select=function(){var h,m=this.anticursor;if(this[n]===m[n]&&this.parent===m.parent)return!1;for(var S=this;S.parent;S=S.parent)if(S.parent.id in m.ancestors){h=S.parent;break}c("cursor and anticursor in the same tree",h);var A=h,q=m.ancestors[A.id],Y,Q,be=i;if(S[n]!==q){for(var Ae=S;Ae;Ae=Ae[i])if(Ae[i]===q[i]){be=n,Y=S,Q=q;break}}be===i&&(Y=q,Q=S),Y instanceof z&&(Y=Y[i]),Q instanceof z&&(Q=Q[n]),this.hide().selection=A.selectChildren(Y,Q);var Ne=this.selection.getEnd(be);return this.insDirOf(be,Ne),this.selectionChanged(),!0},b.prototype.resetToEnd=function(h){this.clearSelection();var m=h.root;this[i]=0,this[n]=m.getEnd(i),this.parent=m},b.prototype.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.selectionChanged()),this},b.prototype.deleteSelection=function(){var h=this.selection;h&&(this[n]=h.getEnd(n)[n],this[i]=h.getEnd(i)[i],h.remove(),this.selectionChanged(),delete this.selection)},b.prototype.replaceSelection=function(){var h=this.selection;return h&&(this[n]=h.getEnd(n)[n],this[i]=h.getEnd(i)[i],delete this.selection),h},b.prototype.depth=function(){for(var h=this,m=0;h=h.parent;)m+=h instanceof Je?1:0;return m},b.prototype.isTooDeep=function(h){return this.options.maxDepth!==void 0?this.depth()+(h||0)>this.options.maxDepth:!1},b.prototype.selectionChanged=function(){},b}(z),H=function(k){t(b,k);function b(h,m,S){var A=k.call(this,h,m,S)||this;return A._el=p("span",{class:"dcg-mq-selection"}),A.getDOMFragFromEnds().wrapAll(A._el),A}return b.prototype.isCleared=function(){return this._el===void 0},b.prototype.domFrag=function(){return this.isCleared()?this.getDOMFragFromEnds():L(this._el)},b.prototype.setEnds=function(h){c("Selection ends are never empty",h[n]&&h[i]),this.ends=h},b.prototype.getEnd=function(h){return this.ends[h]},b.prototype.adopt=function(h,m,S){return this.clear(),k.prototype.adopt.call(this,h,m,S)},b.prototype.clear=function(){var h=this.getDOMFragFromEnds();return this.domFrag().replaceWith(h),this._el=void 0,this},b.prototype.join=function(h,m){return m===void 0&&(m=""),this.fold("",function(S,A){return S+m+A[h]()})},b}(U),Z=function(){function k(b,h,m){this.textareaEventListeners={},this.id=b.id,this.data={},this.root=b,this.container=h,this.options=m,this.aria=new B(this.getControllerSelf()),this.ariaLabel="Math Input",this.ariaPostLabel="",b.controller=this.getControllerSelf(),this.cursor=b.cursor=new se(b,m,this.getControllerSelf())}return k.prototype.getControllerSelf=function(){return this},k.prototype.handle=function(b,h){var m,S=this.options.handlers,A=(m=this.options.handlers)===null||m===void 0?void 0:m.fns[b];if(A){var q=S==null?void 0:S.APIClasses[this.KIND_OF_MQ];c("APIClass is defined",q);var Y=new q(this);h===n||h===i?A(h,Y):A(Y)}},k.onNotify=function(b){k.notifyees.push(b)},k.prototype.notify=function(b){for(var h=0;h<k.notifyees.length;h+=1)k.notifyees[h](this.cursor,b);return this},k.prototype.setAriaLabel=function(b){var h=this.getAriaLabel();return b&&typeof b=="string"&&b!==""?this.ariaLabel=b:this.editable?this.ariaLabel="Math Input":this.ariaLabel="",this.ariaLabel!==h&&!this.containerHasFocus()&&this.updateMathspeak(),this},k.prototype.getAriaLabel=function(){return this.ariaLabel!=="Math Input"?this.ariaLabel:this.editable?"Math Input":""},k.prototype.setAriaPostLabel=function(b,h){var m=this;return b&&typeof b=="string"&&b!==""?(b!==this.ariaPostLabel&&typeof h=="number"&&(this._ariaAlertTimeout&&clearTimeout(this._ariaAlertTimeout),this._ariaAlertTimeout=setTimeout(function(){m.containerHasFocus()?m.aria.alert(m.root.mathspeak().trim()+" "+b.trim()):m.updateMathspeak()},h)),this.ariaPostLabel=b):(this._ariaAlertTimeout&&clearTimeout(this._ariaAlertTimeout),this.ariaPostLabel=""),this},k.prototype.getAriaPostLabel=function(){return this.ariaPostLabel||""},k.prototype.containerHasFocus=function(){return document.activeElement&&this.container.contains(document.activeElement)},k.prototype.getTextarea=function(){var b=this.textarea;return c("textarea initialized",b),b},k.prototype.getTextareaSpan=function(){var b=this.textareaSpan;return c("textareaSpan initialized",b),b},k.prototype.addTextareaEventListeners=function(b){if(this.textarea)for(var h in b){var m=h;this.removeTextareaEventListener(m),this.textarea.addEventListener(m,b[m])}},k.prototype.removeTextareaEventListener=function(b){if(this.textarea){var h=this.textareaEventListeners[b];h&&this.textarea.removeEventListener(b,h)}},k.prototype.exportMathSpeak=function(){return this.root.mathspeak()},k.prototype.updateMathspeak=function(b){},k.prototype.scrollHoriz=function(){},k.prototype.selectionChanged=function(){},k.prototype.setOverflowClasses=function(){},k.notifyees=[],k}(),ce={},Re={},he={},Ie=function(){function k(b){this.version=b}return k.prototype.assertJquery=function(){return c("Interface versions > 2 do not depend on JQuery",this.version<=2),c("JQuery is set for interface v < 3",this.jQuery),this.jQuery},k}(),Ee=function(){function k(){}return k}(),Be=function(){window.console&&console.warn(`You are using the MathQuill API without specifying an interface version, which will fail in v1.0.0. Easiest fix is to do the following before doing anything else:

    MathQuill = MathQuill.getInterface(1);
    // now MathQuill.MathField() works like it used to

See also the "\`dev\` branch (2014–2015) → v0.10.0 Migration Guide" at
  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide`)},J;function j(k){return Be(),J||(J=Te(1)),J(k)}j.prototype=Ee.prototype,j.VERSION="vv1.10",j.interfaceVersion=function(k){if(k!==1)throw"Only interface version 1 supported. You specified: "+k;return Be=function(){window.console&&console.warn(`You called MathQuill.interfaceVersion(1); to specify the interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:

    MathQuill = MathQuill.getInterface(1);
    // now MathQuill.MathField() works like it used to

See also the "\`dev\` branch (2014–2015) → v0.10.0 Migration Guide" at
  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide`)},Be(),j},j.getInterface=Te;var pe=Te.MIN=1,De=Te.MAX=3;function Te(k){if(k!==1&&k!==2&&k!==3)throw"Only interface versions between "+pe+" and "+De+" supported. You specified: "+k;var b=k;if(b<3){var h=window.jQuery;if(!h)throw"MathQuill interface version ".concat(b," requires jQuery 1.5.2+ to be loaded first");Ie.prototype.jQuery=h}var m=r(r({},he),{handlers:function(Ne){return{fns:Ne||{},APIClasses:Q}}});function S(Ne,Ce){for(var Ye in Ce)if(Ce.hasOwnProperty(Ye)){if(Ye==="substituteKeyboardEvents"&&b>=3)throw new Error(["As of interface version 3, the 'substituteKeyboardEvents'","option is no longer supported. Use 'overrideTypedText' and","'overrideKeystroke' instead."].join(" "));var Xe=Ce[Ye],ot=m[Ye];Ne[Ye]=ot?ot(Xe):Xe}}var A=b<3?Ie:function(Ne){t(Ce,Ne);function Ce(){return Ne!==null&&Ne.apply(this,arguments)||this}return Ce}(Ie),q=function(Ne){t(Ce,Ne);function Ce(Ye){var Xe=Ne.call(this)||this;return Xe.__controller=Ye,Xe.__options=Ye.options,Xe.id=Ye.id,Xe.data=Ye.data,Xe}return Ce.prototype.mathquillify=function(Ye){var Xe=this.__controller,ot=Xe.root,lt=Xe.container;Xe.createTextarea();var ht=L(lt).addClass(Ye).children().detach();ot.setDOM(L(p("span",{class:"dcg-mq-root-block","aria-hidden":!0})).appendTo(lt).oneElement()),G.linkElementByBlockNode(ot.domFrag().oneElement(),ot),this.latex(ht.text()),this.revert=function(){return Xe.removeMouseEventListener(),L(lt).removeClass("dcg-mq-editable-field dcg-mq-math-mode dcg-mq-text-mode").empty().append(ht),b<3?this.__options.assertJquery()(lt):lt}},Ce.prototype.setAriaLabel=function(Ye){return this.__controller.setAriaLabel(Ye),this},Ce.prototype.getAriaLabel=function(){return this.__controller.getAriaLabel()},Ce.prototype.config=function(Ye){return S(this.__options,Ye),this},Ce.prototype.el=function(){return this.__controller.container},Ce.prototype.text=function(){return this.__controller.exportText()},Ce.prototype.mathspeak=function(){return this.__controller.exportMathSpeak()},Ce.prototype.latex=function(Ye){if(arguments.length>0){this.__controller.renderLatexMath(Ye);var Xe=this.__controller.cursor;return this.__controller.blurred&&Xe.hide().parent.blur(Xe),this}return this.__controller.exportLatex()},Ce.prototype.selection=function(){return this.__controller.exportLatexSelection()},Ce.prototype.html=function(){return this.__controller.root.domFrag().oneElement().innerHTML.replace(/ jQuery\d+="(?:\d+|null)"/g,"").replace(/ mathquill-(?:command|block)-id="?\d+"?/g,"").replace(/<span class="?dcg-mq-cursor( dcg-mq-blink)?"?>.?<\/span>/i,"").replace(/ dcg-mq-hasCursor|dcg-mq-hasCursor ?/,"").replace(/ class=(""|(?= |>))/g,"")},Ce.prototype.reflow=function(){return this.__controller.root.postOrder(function(Ye){Ye.reflow()}),this},Ce.prototype.focus=function(){return this.__controller.getTextarea().focus(),this.__controller.editable&&this.__controller.scrollHoriz(),this},Ce.prototype.blur=function(){return this.__controller.getTextarea().blur(),this},Ce}(Ee),Y=function(Ne){t(Ce,Ne);function Ce(){return Ne!==null&&Ne.apply(this,arguments)||this}return Ce.prototype.mathquillify=function(Ye){return Ne.prototype.mathquillify.call(this,Ye),this.__controller.editable=!0,this.__controller.addMouseEventListener(),this.__controller.editablesTextareaEvents(),this},Ce.prototype.select=function(){return this.__controller.selectAll(),this},Ce.prototype.clearSelection=function(){return this.__controller.cursor.clearSelection(),this},Ce.prototype.write=function(Ye){this.__controller.writeLatex(Ye),this.__controller.scrollHoriz();var Xe=this.__controller.cursor;return this.__controller.blurred&&Xe.hide().parent.blur(Xe),this},Ce.prototype.empty=function(){var Ye,Xe=this.__controller.root,ot=this.__controller.cursor;return Xe.setEnds((Ye={},Ye[n]=0,Ye[i]=0,Ye)),Xe.domFrag().empty(),delete ot.selection,ot.insAtRightEnd(Xe),this},Ce.prototype.cmd=function(Ye){var Xe=this.__controller.notify(void 0),ot=Xe.cursor;if(/^\\[a-z]+$/i.test(Ye)&&!ot.isTooDeep()){Ye=Ye.slice(1);var lt=D[Ye],ht;lt&&(lt.constructor?ht=new lt(Ye):ht=lt(Ye),ot.selection&&ht.replaces(ot.replaceSelection()),ht.createLeftOf(ot.show()))}else ot.parent.write(ot,Ye);return Xe.scrollHoriz(),Xe.blurred&&ot.hide().parent.blur(ot),this},Ce.prototype.moveToDirEnd=function(Ye){return this.__controller.notify("move").cursor.insAtDirEnd(Ye,this.__controller.root),this},Ce.prototype.moveToLeftEnd=function(){return this.moveToDirEnd(n)},Ce.prototype.moveToRightEnd=function(){return this.moveToDirEnd(i)},Ce.prototype.keystroke=function(Ye,Xe){for(var ot=Ye.replace(/^\s+|\s+$/g,"").split(/\s+/),lt=0;lt<ot.length;lt+=1)this.__controller.keystroke(ot[lt],Xe);return this},Ce.prototype.typedText=function(Ye){for(var Xe=0;Xe<Ye.length;Xe+=1)this.__controller.typedText(Ye.charAt(Xe));return this},Ce.prototype.dropEmbedded=function(Ye,Xe,ot){var lt=Ye-C(),ht=Xe-P(),Dt=document.elementFromPoint(lt,ht);this.__controller.seek(Dt,lt,ht);var Mr=new vs().setOptions(ot);Mr.createLeftOf(this.__controller.cursor)},Ce.prototype.setAriaPostLabel=function(Ye,Xe){return this.__controller.setAriaPostLabel(Ye,Xe),this},Ce.prototype.getAriaPostLabel=function(){return this.__controller.getAriaPostLabel()},Ce.prototype.clickAt=function(Ye,Xe,ot){ot=ot||document.elementFromPoint(Ye,Xe);var lt=this.__controller,ht=lt.root,Dt=ht.domFrag().oneElement();return Dt.contains(ot)||(ot=Dt),lt.seek(ot,Ye,Xe),lt.blurred&&this.focus(),this},Ce.prototype.ignoreNextMousedown=function(Ye){return this.__controller.cursor.options.ignoreNextMousedown=Ye,this},Ce}(q),Q={AbstractMathQuill:q,EditableField:Y};c("API.StaticMath defined",ce.StaticMath),Q.StaticMath=ce.StaticMath(Q),c("API.MathField defined",ce.MathField),Q.MathField=ce.MathField(Q),c("API.InnerMathField defined",ce.InnerMathField),Q.InnerMathField=ce.InnerMathField(Q),ce.TextField&&(Q.TextField=ce.TextField(Q));var be=function(Ne){if(!Ne||!Ne.nodeType)return null;for(var Ce,Ye=L(Ne).children().toElementArray(),Xe=0,ot=Ye;Xe<ot.length;Xe++){var lt=ot[Xe];if(lt.classList.contains("dcg-mq-root-block")){Ce=lt;break}}var ht=G.getNodeOfElement(Ce),Dt=ht&&ht.controller,Mr=Dt&&Q[Dt.KIND_OF_MQ];return Dt&&Mr?new Mr(Dt):null};be.L=n,be.R=i,be.config=function(Ne){return S(A.prototype,Ne),this},be.registerEmbed=function(Ne,Ce){if(!/^[a-z][a-z0-9]*$/i.test(Ne))throw"Embed name must start with letter and be only letters and digits";Re[Ne]=Ce},be.StaticMath=Ae("StaticMath",Q.StaticMath),be.MathField=Ae("MathField",Q.MathField),be.InnerMathField=Ae("InnerMathField",Q.InnerMathField),Q.TextField&&(be.TextField=Ae("TextField",Q.TextField)),be.prototype=q.prototype,be.EditableField=function(){throw"wtf don't call me, I'm 'abstract'"},be.EditableField.prototype=Y.prototype,b<3&&(be.saneKeyboardEvents=ar);function Ae(Ne,Ce){c(Ne+" is defined",Ce);function Ye(Xe,ot){if(!Xe||!Xe.nodeType)return null;var lt=be(Xe);if(lt instanceof Ce)return lt;var ht=new Vt(new Ce.RootBlock,Xe,new A(b));return ht.KIND_OF_MQ=Ne,new Ce(ht).__mathquillify(ot||{},b)}return Ye.prototype=Ce.prototype,Ye}return be}j.noConflict=function(){return window.MathQuill=Se,j};var Se=window.MathQuill;window.MathQuill=j;function qe(k){k.moveOutOf=function(b){c("controller is defined",this.controller),this.controller.handle("moveOutOf",b)},k.deleteOutOf=function(b){c("controller is defined",this.controller),this.controller.handle("deleteOutOf",b)},k.selectOutOf=function(b){c("controller is defined",this.controller),this.controller.handle("selectOutOf",b)},k.upOutOf=function(){c("controller is defined",this.controller),this.controller.handle("upOutOf")},k.downOutOf=function(){c("controller is defined",this.controller),this.controller.handle("downOutOf")},k.reflow=function(){c("controller is defined",this.controller),this.controller.handle("reflow"),this.controller.handle("edited"),this.controller.handle("edit")}}function st(k,b){throw k?k="'"+k+"'":k="EOF","Parse Error: "+b+" at "+k}var Ve=function(){function k(b){this._=b}return k.prototype.parse=function(b){return this.skip(k.eof)._(""+b,h,st);function h(m,S){return S}},k.prototype.or=function(b){c("or is passed a parser",b instanceof k);var h=this;return new k(function(m,S,A){return h._(m,S,q);function q(Y){return b._(m,S,A)}})},k.prototype.then=function(b){var h=this;return new k(function(m,S,A){return h._(m,q,A);function q(Y,Q){var be=b instanceof k?b:b(Q);return c("a parser is returned",be instanceof k),be._(Y,S,A)}})},k.prototype.many=function(){var b=this;return new k(function(h,m,S){for(var A=[];b._(h,q,Y););return m(h,A);function q(Q,be){return h=Q,A.push(be),!0}function Y(){return!1}})},k.prototype.times=function(b,h){arguments.length<2&&(h=b);var m=this;return new k(function(S,A,q){for(var Y=[],Q=!0,be,Ae=0;Ae<b;Ae+=1)if(Q=!!m._(S,Ne,Ce),!Q)return q(S,be);for(;Ae<h&&Q;Ae+=1)m._(S,Ne,Ye);return A(S,Y);function Ne(Xe,ot){return Y.push(ot),S=Xe,!0}function Ce(Xe,ot){return be=ot,S=Xe,!1}function Ye(Xe,ot){return!1}})},k.prototype.result=function(b){return this.then(k.succeed(b))},k.prototype.atMost=function(b){return this.times(0,b)},k.prototype.atLeast=function(b){var h=this;return h.times(b).then(function(m){return h.many().map(function(S){return m.concat(S)})})},k.prototype.map=function(b){return this.then(function(h){return k.succeed(b(h))})},k.prototype.skip=function(b){return this.then(function(h){return b.result(h)})},k.string=function(b){var h=b.length,m="expected '"+b+"'";return new k(function(S,A,q){var Y=S.slice(0,h);return Y===b?A(S.slice(h),Y):q(S,m)})},k.regex=function(b){c("regexp parser is anchored",b.toString().charAt(1)==="^");var h="expected "+b;return new k(function(m,S,A){var q=b.exec(m);if(q){var Y=q[0];return S(m.slice(Y.length),Y)}else return A(m,h)})},k.succeed=function(b){return new k(function(h,m){return m(h,b)})},k.fail=function(b){return new k(function(h,m,S){return S(h,b)})},k.letter=k.regex(/^[a-z]/i),k.letters=k.regex(/^[a-z]*/i),k.digit=k.regex(/^[0-9]/),k.digits=k.regex(/^[0-9]*/),k.whitespace=k.regex(/^\s+/),k.optWhitespace=k.regex(/^\s*/),k.any=new k(function(b,h,m){return b?h(b.slice(1),b.charAt(0)):m(b,"expected any character")}),k.all=new k(function(b,h,m){return h("",b)}),k.eof=new k(function(b,h,m){return b?m(b,"expected EOF"):h(b,b)}),k}(),_e=function(){function k(){this.fn=s}return k.prototype.listen=function(b){this.fn=b,clearTimeout(this.timeoutId),this.timeoutId=setTimeout(this.fn)},k.prototype.listenOnce=function(b){var h=this;this.listen(function(){for(var m=[],S=0;S<arguments.length;S++)m[S]=arguments[S];h.clearListener(),b.apply(void 0,m)})},k.prototype.clearListener=function(){this.fn=s,clearTimeout(this.timeoutId)},k.prototype.trigger=function(){for(var b=[],h=0;h<arguments.length;h++)b[h]=arguments[h];this.fn.apply(this,b)},k}(),gt=function(){var k={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"},b={ArrowRight:"Right",ArrowLeft:"Left",ArrowDown:"Down",ArrowUp:"Up",Delete:"Del",Escape:"Esc"," ":"Spacebar"};function h(q){switch(S(q)){case"Right":case"Left":case"Down":case"Up":return!0}return!1}function m(q){return q.length===1&&q>="a"&&q<="z"}function S(q){var Y;if(q.key===void 0){var Q=q.which||q.keyCode;return k[Q]||String.fromCharCode(Q)}return m(q.key)?q.key.toUpperCase():(Y=b[q.key])!==null&&Y!==void 0?Y:q.key}function A(q){var Y=S(q),Q=[];return q.ctrlKey&&Q.push("Ctrl"),q.metaKey&&Q.push("Meta"),q.altKey&&Q.push("Alt"),q.shiftKey&&Q.push("Shift"),Q.length?(Y!=="Alt"&&Y!=="Control"&&Y!=="Meta"&&Y!=="Shift"&&Q.push(Y),Q.join("-")):Y}return function(q,Y){var Q=null,be=null,Ae=new _e;function Ne(){try{q instanceof HTMLTextAreaElement&&q.select()}catch(Pt){}}function Ce(Pt){Ae.trigger(),Ae.clearListener(),q instanceof HTMLTextAreaElement&&(q.value=Pt),Pt&&Ne(),Ye=!!Pt}var Ye=!1;function Xe(){return!("selectionStart"in q)||!(q instanceof HTMLTextAreaElement)?!1:q.selectionStart!==q.selectionEnd}function ot(){Y.options&&Y.options.overrideKeystroke?Y.options.overrideKeystroke(A(Q),Q):Y.keystroke(A(Q),Q)}function lt(Pt){Ae.trigger(Pt),Pt.target===q&&(Q=Pt,be=null,Ye&&Ae.listenOnce(function(en){en&&en.type==="focusout"||Ne()}),ot())}function ht(Pt){Ae.trigger(Pt),Pt.target===q&&(Q&&be&&ot(),be=Pt,h(Pt)?Ae.listenOnce(Rt):Ae.listen(Mr))}function Dt(Pt){Ae.trigger(Pt),Pt.target===q&&Q&&!be&&(h(Pt)?Ae.listenOnce(Rt):Ae.listen(Mr))}function Mr(){if(!Xe()&&q instanceof HTMLTextAreaElement){var Pt=q.value;Q&&(Q.key==="Unidentified"||!Q.altKey&&Q.ctrlKey&&!Q.metaKey&&Q.shiftKey&&(Q.key==="U"||Q.key==="Process"))||(Pt.length===1?(q.value="",Y.options&&Y.options.overrideTypedText?Y.options.overrideTypedText(Pt):Y.typedText(Pt)):Rt())}}function Rt(){q instanceof HTMLTextAreaElement&&q.value.length>1&&Ne()}function Qt(){Q=null,be=null,Ae.clearListener(),q instanceof HTMLTextAreaElement&&(q.value="")}function Yr(Pt){Ae.trigger(),Pt.target===q&&(document.activeElement!==q&&q.focus(),Ae.listen(function(){if(q instanceof HTMLTextAreaElement){var en=q.value;q.value="",en&&Y.paste(en)}}))}function jr(Pt){Ae.trigger(Pt)}return Y.KIND_OF_MQ==="StaticMath"?(Y.addTextareaEventListeners({keydown:function(Pt){var en,rn;(rn=(en=Y.options).overrideKeystroke)===null||rn===void 0||rn.call(en,A(Pt),Pt)}}),{select:Ce}):(Y.options&&Y.options.disableCopyPaste?Y.addTextareaEventListeners({keydown:lt,keypress:ht,keyup:Dt,focusout:Qt,copy:function(Pt){Pt.preventDefault()},cut:function(Pt){Pt.preventDefault()},paste:function(Pt){Ae.trigger(),Pt.preventDefault()},input:jr}):Y.addTextareaEventListeners({keydown:lt,keypress:ht,keyup:Dt,focusout:Qt,cut:function(){Ae.listenOnce(function(){Y.cut()})},copy:function(){Ae.listenOnce(function(){Y.copy()})},paste:Yr,input:jr}),{select:Ce})}}(),At=function(k){t(b,k);function b(){return k!==null&&k.apply(this,arguments)||this}return b.prototype.exportText=function(){return this.root.foldChildren("",function(h,m){return h+m.text()})},b}(Z);Z.onNotify(function(k,b){if(b==="edit"||b==="replace"||b===void 0){var h=k.controller;if(!h||!h.options.enableDigitGrouping||h.blurred!==!1)return;h.disableGroupingForSeconds(1)}});var zt=function(k){t(b,k);function b(){var h=k!==null&&k.apply(this,arguments)||this;return h.handleTextareaFocusEditable=function(){var m=h.cursor;h.updateMathspeak(),h.blurred=!1,clearTimeout(h.blurTimeout),L(h.container).addClass("dcg-mq-focused"),m.parent||m.insAtRightEnd(h.root),m.selection?(m.selection.domFrag().removeClass("dcg-mq-blur"),h.selectionChanged()):m.show(),h.setOverflowClasses()},h.handleTextareaBlurEditable=function(){h.textareaSelectionTimeout&&(clearTimeout(h.textareaSelectionTimeout),h.textareaSelectionTimeout=0),h.disableGroupingForSeconds(0),h.blurred=!0,h.blurTimeout=setTimeout(function(){h.root.postOrder(function(m){m.intentionalBlur()}),h.cursor.clearSelection().endSelection(),h.blur(),h.updateMathspeak({emptyContent:!0}),h.scrollHoriz()}),window.addEventListener("blur",h.handleWindowBlur)},h.handleTextareaFocusStatic=function(){h.cursor.selection||h.cursor.controller.selectAll(),h.blurred=!1},h.handleTextareaBlurStatic=function(){h.cursor.clearSelection(),h.updateMathspeak({emptyContent:!0})},h.handleWindowBlur=function(){clearTimeout(h.blurTimeout),h.cursor.selection&&h.cursor.selection.domFrag().addClass("dcg-mq-blur"),h.blurWithoutResettingCursor(),h.updateMathspeak({emptyContent:!0})},h}return b.prototype.disableGroupingForSeconds=function(h){var m=this;clearTimeout(this.__disableGroupingTimeout),h===0?this.root.domFrag().removeClass("dcg-mq-suppress-grouping"):(this.root.domFrag().addClass("dcg-mq-suppress-grouping"),this.__disableGroupingTimeout=setTimeout(function(){m.root.domFrag().removeClass("dcg-mq-suppress-grouping")},h*1e3))},b.prototype.blur=function(){this.blurWithoutResettingCursor(),this.options&&this.options.resetCursorOnBlur&&this.cursor.resetToEnd(this)},b.prototype.blurWithoutResettingCursor=function(){this.cursor.hide().parent.blur(this.cursor),L(this.container).removeClass("dcg-mq-focused"),window.removeEventListener("blur",this.handleWindowBlur)},b.prototype.addEditableFocusBlurListeners=function(){var h=this,m=h.cursor;this.addTextareaEventListeners({focus:this.handleTextareaFocusEditable,blur:this.handleTextareaBlurEditable}),h.blurred=!0,m.hide().parent.blur(m)},b.prototype.addStaticFocusBlurListeners=function(){this.addTextareaEventListeners({focus:this.handleTextareaFocusStatic,blur:this.handleTextareaBlurStatic})},b}(At),oe=!1,me=function(k){t(b,k);function b(){return k!==null&&k.apply(this,arguments)||this}return b.prototype.keystroke=function(h,m,S){var A=S.cursor;switch(h){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":S.ctrlDeleteDir(n);break;case"Shift-Backspace":case"Backspace":S.backspace();break;case"Esc":case"Tab":S.escapeDir(i,h,m);return;case"Shift-Tab":case"Shift-Esc":S.escapeDir(n,h,m);return;case"End":S.notify("move").cursor.insAtRightEnd(A.parent),S.aria.queue("end of").queue(A.parent,!0);break;case"Ctrl-End":S.notify("move").cursor.insAtRightEnd(S.root),S.aria.queue("end of").queue(S.ariaLabel).queue(S.root).queue(S.ariaPostLabel);break;case"Shift-End":S.selectToBlockEndInDir(i);break;case"Ctrl-Shift-End":S.selectToRootEndInDir(i);break;case"Home":S.notify("move").cursor.insAtLeftEnd(A.parent),S.aria.queue("beginning of").queue(A.parent,!0);break;case"Ctrl-Home":S.notify("move").cursor.insAtLeftEnd(S.root),S.aria.queue("beginning of").queue(S.ariaLabel).queue(S.root).queue(S.ariaPostLabel);break;case"Shift-Home":S.selectToBlockEndInDir(n);break;case"Ctrl-Shift-Home":S.selectToRootEndInDir(n);break;case"Left":S.moveLeft();break;case"Shift-Left":S.selectLeft();break;case"Ctrl-Left":break;case"Right":S.moveRight();break;case"Shift-Right":S.selectRight();break;case"Ctrl-Right":break;case"Up":S.moveUp();break;case"Down":S.moveDown();break;case"Shift-Up":S.withIncrementalSelection(function(q){if(A[n])for(;A[n];)q(n);else q(n)});break;case"Shift-Down":S.withIncrementalSelection(function(q){if(A[i])for(;A[i];)q(i);else q(i)});break;case"Ctrl-Up":break;case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":S.ctrlDeleteDir(i);break;case"Shift-Del":case"Del":S.deleteForward();break;case"Meta-A":case"Ctrl-A":S.selectAll();break;case"Ctrl-Alt-Up":A.parent.parent&&A.parent.parent instanceof b?S.aria.queue(A.parent.parent):S.aria.queue("nothing above");break;case"Ctrl-Alt-Down":A.parent&&A.parent instanceof b?S.aria.queue(A.parent):S.aria.queue("block is empty");break;case"Ctrl-Alt-Left":A.parent.parent&&A.parent.parent.getEnd(n)?S.aria.queue(A.parent.parent.getEnd(n)):S.aria.queue("nothing to the left");break;case"Ctrl-Alt-Right":A.parent.parent&&A.parent.parent.getEnd(i)?S.aria.queue(A.parent.parent.getEnd(i)):S.aria.queue("nothing to the right");break;case"Ctrl-Alt-Shift-Down":A.selection?S.aria.queue(A.selection.join("mathspeak"," ").trim()+" selected"):S.aria.queue("nothing selected");break;case"Ctrl-Alt-=":case"Ctrl-Alt-Shift-Right":S.ariaPostLabel.length?S.aria.queue(S.ariaPostLabel):S.aria.queue("no answer");break;default:return}S.aria.alert(),m==null||m.preventDefault(),S.scrollHoriz()},b.prototype.moveOutOf=function(h,m,S){c("overridden or never called on this node",!1)},b.prototype.moveTowards=function(h,m,S){c("overridden or never called on this node",!1)},b.prototype.deleteOutOf=function(h,m){c("overridden or never called on this node",!1)},b.prototype.deleteTowards=function(h,m){c("overridden or never called on this node",!1)},b.prototype.unselectInto=function(h,m){c("overridden or never called on this node",!1)},b.prototype.selectOutOf=function(h,m){c("overridden or never called on this node",!1)},b.prototype.selectTowards=function(h,m){c("overridden or never called on this node",!1)},b}(G);Z.onNotify(function(k,b){(b==="move"||b==="upDown")&&k.show().clearSelection()}),he.leftRightIntoCmdGoes=function(k){if(k&&k!=="up"&&k!=="down")throw'"up" or "down" required for leftRightIntoCmdGoes option, got "'+k+'"';return k},Z.onNotify(function(k,b){b!=="upDown"&&(k.upDownCache={})}),Z.onNotify(function(k,b){b==="edit"&&k.show().deleteSelection()}),Z.onNotify(function(k,b){b!=="select"&&k.endSelection()});var te=function(k){t(b,k);function b(){return k!==null&&k.apply(this,arguments)||this}return b.prototype.keystroke=function(h,m){this.cursor.parent.keystroke(h,m,this.getControllerSelf())},b.prototype.escapeDir=function(h,m,S){d(h);var A=this.cursor;if(A.parent!==this.root&&(S==null||S.preventDefault()),A.parent!==this.root)return A.clearSelection(),A.parent.moveOutOf(h,A),A.controller.aria.alert(),this.notify("move")},b.prototype.moveDir=function(h){d(h);var m=this.cursor,S=m.options.leftRightIntoCmdGoes,A=m[h];return m.selection?m.insDirOf(h,m.selection.getEnd(h)):A?A.moveTowards(h,m,S):m.parent.moveOutOf(h,m,S),this.notify("move")},b.prototype.moveLeft=function(){return this.moveDir(n)},b.prototype.moveRight=function(){return this.moveDir(i)},b.prototype.moveUp=function(){return this.moveUpDown("up")},b.prototype.moveDown=function(){return this.moveUpDown("down")},b.prototype.moveUpDown=function(h){var m=this,S=m.notify("upDown").cursor,A,q;h==="up"?(A="upInto",q="upOutOf"):(A="downInto",q="downOutOf");var Y=S[n],Q=S[i],be=Q&&Q[A],Ae=Y&&Y[A];return be?S.insAtLeftEnd(be):Ae?S.insAtRightEnd(Ae):S.parent.bubble(function(Ne){var Ce=Ne[q];if(Ce&&(typeof Ce=="function"&&(Ce=Ce.call(Ne,S)),Ce instanceof me&&S.jumpUpDown(Ne,Ce),Ce!==!0))return!1}),m},b.prototype.deleteDir=function(h){d(h);var m=this.cursor,S=m[h],A=m.parent.parent,q=m.controller;if(S&&S instanceof me)S.sides?q.aria.queue(S.parent.chToCmd(S.sides[-h].ch).mathspeak({createdLeftOf:m})):!S.blocks&&S.parent.ctrlSeq!=="\\text"&&q.aria.queue(S);else if(A&&A instanceof me)if(A.sides)q.aria.queue(A.parent.chToCmd(A.sides[h].ch).mathspeak({createdLeftOf:m}));else if(A.blocks&&A.mathspeakTemplate)if(A.upInto&&A.downInto)q.aria.queue(A.mathspeakTemplate[1]);else{var Y=A.mathspeakTemplate,Q=h===n?Y[0]:Y[Y.length-1];q.aria.queue(Q)}else q.aria.queue(A);var be=m.selection;if(this.notify("edit"),!be){var Ae=m[h];Ae?Ae.deleteTowards(h,m):m.parent.deleteOutOf(h,m)}var Ne=m[n],Ce=m[i];return Ne.siblingDeleted&&Ne.siblingDeleted(m.options,i),Ce.siblingDeleted&&Ce.siblingDeleted(m.options,n),m.parent.bubble(function(Ye){Ye.reflow()}),this},b.prototype.ctrlDeleteDir=function(h){d(h);var m=this.cursor;if(!m[h]||m.selection)return this.deleteDir(h);this.notify("edit");var S;h===n?S=new U(m.parent.getEnd(n),m[n]):S=new U(m[i],m.parent.getEnd(i)),m.controller.aria.queue(S),S.remove(),m.insAtDirEnd(h,m.parent);var A=m[n],q=m[i];return A&&A.siblingDeleted(m.options,i),q&&q.siblingDeleted(m.options,n),m.parent.bubble(function(Y){Y.reflow()}),this},b.prototype.backspace=function(){return this.deleteDir(n)},b.prototype.deleteForward=function(){return this.deleteDir(i)},b.prototype.startIncrementalSelection=function(){c("Multiple selections can't be simultaneously open",!oe),oe=!0,this.notify("select");var h=this.cursor;h.anticursor||h.startSelection()},b.prototype.selectDirIncremental=function(h){c("A selection is open",oe),oe=!0;var m=this.cursor,S=m.selection;d(h);var A=m[h];A?S&&S.getEnd(h)===A&&m.anticursor[-h]!==A?A.unselectInto(h,m):A.selectTowards(h,m):m.parent.selectOutOf(h,m)},b.prototype.finishIncrementalSelection=function(){c("A selection is open",oe);var h=this.cursor;h.clearSelection(),h.select()||h.show();var m=h.selection;m&&h.controller.aria.clear().queue(m.join("mathspeak"," ").trim()+" selected"),oe=!1},b.prototype.withIncrementalSelection=function(h){var m=this;try{this.startIncrementalSelection();try{h(function(S){return m.selectDirIncremental(S)})}finally{this.finishIncrementalSelection()}}finally{oe=!1}},b.prototype.selectDir=function(h){this.withIncrementalSelection(function(m){return m(h)})},b.prototype.selectLeft=function(){return this.selectDir(n)},b.prototype.selectRight=function(){return this.selectDir(i)},b.prototype.selectAll=function(){this.notify("move");var h=this.cursor;h.insAtRightEnd(this.root),this.withIncrementalSelection(function(m){for(;h[n];)m(n)})},b.prototype.selectToBlockEndInDir=function(h){var m=this.cursor;this.withIncrementalSelection(function(S){for(;m[h];)S(h)})},b.prototype.selectToRootEndInDir=function(h){var m=this,S=this.cursor;this.withIncrementalSelection(function(A){for(;S[h]||S.parent!==m.root;)A(h)})},b}(zt);(function(k){t(b,k);function b(h){return k.call(this)||this}return b})(me);var ae=function(){function k(Rt){var Qt=new Je;return Rt.adopt(Qt,0,0),Qt}function b(Rt){for(var Qt=Rt[0]||new Je,Yr=1;Yr<Rt.length;Yr+=1)Rt[Yr].children().adopt(Qt,Qt.getEnd(i),0);return Qt}var h=Ve.string,m=Ve.regex,S=Ve.letter,A=Ve.digit,q=Ve.any,Y=Ve.optWhitespace,Q=Ve.succeed,be=Ve.fail,Ae=S.map(function(Rt){return new Bt(Rt)}),Ne=A.map(function(Rt){return new ft(Rt)}),Ce=m(/^[^${}\\_^]/).map(function(Rt){return new fe(Rt)}),Ye=m(/^[^\\a-eg-zA-Z]/).or(h("\\").then(m(/^[a-z]+/i).or(m(/^\s+/).result(" ")).or(q))).then(function(Rt){var Qt=D[Rt];if(Qt)if(Qt.constructor){var Yr=Qt;return new Yr(Rt).parser()}else{var jr=Qt;return jr(Rt).parser()}else return be("unknown command: \\"+Rt)}),Xe=Ye.or(Ae).or(Ne).or(Ce),ot=h("{").then(function(){return ht}).skip(h("}")),lt=Y.then(ot.or(Xe.map(k))),ht=lt.many().map(b).skip(Y),Dt=h("[").then(lt.then(function(Rt){return Rt.join("latex")!=="]"?Q(Rt):be("")}).many().map(b).skip(Y)).skip(h("]")),Mr=ht;return Mr.block=lt,Mr.optBlock=Dt,Mr}();he.maxDepth=function(k){return typeof k=="number"?k:void 0};var He=function(k){t(b,k);function b(){return k!==null&&k.apply(this,arguments)||this}return b.prototype.cleanLatex=function(h){return h.replace(/(\\[a-z]+) (?![a-z])/gi,"$1")},b.prototype.exportLatex=function(){return this.cleanLatex(this.root.latex())},b.prototype.writeLatex=function(h){var m=this.notify("edit").cursor;return m.parent.writeLatex(m,h),this},b.prototype.exportLatexSelection=function(){var h={latex:"",startIndex:-1,endIndex:-1},m=this.cursor.selection;if(m)h.startSelectionBefore=m.getEnd(n),h.endSelectionAfter=m.getEnd(i);else{var S=this.cursor[n];S?h.startSelectionAfter=S:h.startSelectionBefore=this.cursor.parent;var A=this.cursor[i];A?h.endSelectionBefore=A:h.endSelectionAfter=this.cursor.parent}this.root.latexRecursive(h);for(var q=h.latex,Y=this.cleanLatex(q),Q=h.startIndex,be=h.endIndex,Ae=0,Ne=0;Ne<h.endIndex;Ne++)q[Ne]!==Y[Ae]?(Ne<h.startIndex&&(Q-=1),be-=1):Ae+=1;return{latex:Y,startIndex:Q,endIndex:be}},b.prototype.classifyLatexForEfficientUpdate=function(h){if(typeof h=="string"){var m=h.match(/-?[0-9.]+$/g);if(m&&m.length===1)return{latex:h,prefix:h.substr(0,h.length-m[0].length),digits:m[0]}}},b.prototype.updateLatexMathEfficiently=function(h,m){var S,A,q,Y,Q=this.root,be,Ae=this.classifyLatexForEfficientUpdate(h);if(Ae){if(be=this.classifyLatexForEfficientUpdate(m),!be||be.prefix!==Ae.prefix)return!1}else return!1;var Ne=be.digits,Ce=Ae.digits,Ye=!1,Xe=!1;Ne[0]==="-"&&(Ye=!0,Ne=Ne.substr(1)),Ce[0]==="-"&&(Xe=!0,Ce=Ce.substr(1));for(var ot=this.root.getEnd(i),lt=[],ht=Ne.length-1;ht>=0;ht--){if(!ot||ot.ctrlSeq!==Ne[ht]||ot.parent!==Q)return!1;lt.unshift(ot),ot=ot[n]}if(Ye&&!Xe){var Dt=ot;if(!Dt||Dt.ctrlSeq!=="-"||Dt[i]!==lt[0]||Dt.parent!==Q)return!1;var Mr=Dt[n];if(Mr&&Mr.parent!==Q)return!1;lt[0][n]=Dt[n],Q.getEnd(n)===Dt&&Q.setEnds((S={},S[n]=lt[0],S[i]=Q.getEnd(i),S)),Mr&&(Mr[i]=lt[0]),Dt.domFrag().remove()}if(!Ye&&Xe){var Rt=new Kr("-"),Qt=document.createElement("span");Qt.textContent="-",Rt.setDOM(Qt);var Yr=lt[0][n];Yr&&(Yr[i]=Rt),Q.getEnd(n)===lt[0]&&Q.setEnds((A={},A[n]=Rt,A[i]=Q.getEnd(i),A)),Rt.parent=Q,Rt[n]=lt[0][n],Rt[i]=lt[0],lt[0][n]=Rt,Rt.contactWeld(this.cursor),Rt.domFrag().insertBefore(lt[0].domFrag())}var jr=Math.min(Ne.length,Ce.length);for(ht=0;ht<jr;ht++){var Pt=Ce[ht];ot=lt[ht],ot.ctrlSeq!==Pt&&(ot.ctrlSeq=Pt,ot.domFrag().oneElement().textContent=Pt,ot.mathspeakName=Pt)}if(Ne.length>Ce.length)for(ot=lt[Ce.length-1],Q.setEnds((q={},q[n]=Q.getEnd(n),q[i]=ot,q)),ot[i]=0,ht=Ne.length-1;ht>=jr;ht--)lt[ht].domFrag().remove();if(Ce.length>Ne.length){var en=document.createDocumentFragment();for(ht=jr;ht<Ce.length;ht++){var rn=document.createElement("span");rn.className="dcg-mq-digit",rn.textContent=Ce[ht];var vn=new ft(Ce[ht]);vn.parent=Q,vn.setDOM(rn),en.appendChild(rn),vn[n]=Q.getEnd(i),vn[i]=0;var vc=vn[n];vc[i]=vn,Q.setEnds((Y={},Y[n]=Q.getEnd(n),Y[i]=vn,Y))}Q.domFrag().oneElement().appendChild(en)}var Ts=this.exportLatex();if(Ts!==h)return console.warn("tried updating latex efficiently but did not work. Attempted: "+h+" but wrote: "+Ts),!1;var Us=Q.getEnd(i);return Us&&Us.fixDigitGrouping(this.cursor.options),!0},b.prototype.renderLatexMathFromScratch=function(h){var m,S=this.root,A=this.cursor,q=Ve.all,Y=Ve.eof,Q=ae.skip(Y).or(q.result(!1)).parse(h);if(S.setEnds((m={},m[n]=0,m[i]=0,m)),Q&&Q.children().adopt(S,0,0),Q){var be=S.domFrag();be.children().remove(),be.oneElement().appendChild(Q.html()),S.finalizeInsert(A.options,A)}else S.domFrag().empty()},b.prototype.renderLatexMath=function(h){var m=this.cursor,S=this.root;this.notify("replace"),m.clearSelection();var A=this.exportLatex();(!S.getEnd(n)||!S.getEnd(i)||A!==h)&&(this.updateLatexMathEfficiently(h,A)||this.renderLatexMathFromScratch(h),this.updateMathspeak()),m.insAtRightEnd(S)},b.prototype.renderLatexText=function(h){var m,S=this.root,A=this.cursor;S.domFrag().children().slice(1).remove(),S.setEnds((m={},m[n]=0,m[i]=0,m)),delete A.selection,A.show().insAtRightEnd(S);var q=Ve.regex,Y=Ve.string,Q=Ve.eof,be=Ve.all,Ae=Y("$").then(ae).skip(Y("$").or(Q)).map(function(lt){var ht=new RootMathCommand(A);ht.createBlocks();var Dt=ht.getEnd(n);return lt.children().adopt(Dt,0,0),ht}),Ne=Y("\\$").result("$"),Ce=Ne.or(q(/^[^$]/)).map(function(lt){return new fe(lt)}),Ye=Ae.or(Ce).many(),Xe=Ye.skip(Q).or(be.result(!1)).parse(h);if(Xe){for(var ot=0;ot<Xe.length;ot+=1)Xe[ot].adopt(S,S.getEnd(i),0);L(S.html()).appendTo(S.domFrag().oneElement()),S.finalizeInsert(A.options,A)}},b}(te),Ue=function(k){return!1};Ie.prototype.ignoreNextMousedown=Ue;var It;(function(){Z.onNotify(function(k,b){(b==="edit"||b==="replace")&&It&&It.cursor===k&&It.cb()})})();var it=function(k){t(b,k);function b(){var h=k!==null&&k.apply(this,arguments)||this;return h.handleMouseDown=function(m){var S=g(m.target,".dcg-mq-root-block"),A=S&&G.getNodeOfElement(S)||G.getNodeOfElement(h.root.domFrag().oneElement()),q=A.domFrag().firstNode().ownerDocument,Y=A.controller,Q=Y.cursor,be=Q.blink,Ae=Y.getTextarea();if(m.preventDefault(),m.target.unselectable=!0,Q.options.ignoreNextMousedown(m)||g(m.target,".dcg-mq-ignore-mousedown"))return;var Ne=null;function Ce(Dt){Ne=Dt.target}function Ye(Dt){Q.anticursor||Q.startSelection(),Y.seek(Ne,Dt.clientX,Dt.clientY).cursor.select(),Q.selection&&Q.controller.aria.clear().queue(Q.selection.join("mathspeak")+" selected").alert(),Ne=null}function Xe(){S==null||S.removeEventListener("mousemove",Ce),q==null||q.removeEventListener("mousemove",Ye),q==null||q.removeEventListener("mouseup",lt),It=void 0}function ot(){Y.editable&&(Q.show(),Q.controller.aria.queue(Q.parent).alert())}function lt(){Q.blink=be,Q.selection||ot(),Xe()}var ht;It={cursor:Q,cb:function(){ht=!0,Q.blink=be,Q.clearSelection(),ot(),Xe()}},!(Y.blurred&&(Ae.focus(),ht))&&(Q.blink=s,Y.seek(m.target,m.clientX,m.clientY).cursor.startSelection(),S==null||S.addEventListener("mousemove",Ce),q==null||q.addEventListener("mousemove",Ye),q==null||q.addEventListener("mouseup",lt))},h}return b.prototype.addMouseEventListener=function(){this.container.addEventListener("mousedown",this.handleMouseDown)},b.prototype.removeMouseEventListener=function(){this.container.removeEventListener("mousedown",this.handleMouseDown)},b.prototype.seek=function(h,m,S){for(var A=this.notify("select").cursor,q;h&&(q=G.getNodeOfElement(h),!q);)h=h.parentElement;return q||(q=this.root),A.clearSelection().show(),q.seek(m,A),this.scrollHoriz(),this},b}(He),Cr=function(k){t(b,k);function b(){return k!==null&&k.apply(this,arguments)||this}return b.prototype.setOverflowClasses=function(){var h=this.root.domFrag().oneElement(),m=!1,S=!1;if(!this.blurred){var A=M(h).width,q=h.scrollWidth,Y=h.scrollLeft;m=q>A+Y,S=Y>0}h.classList.contains("dcg-mq-editing-overflow-right")!==m&&h.classList.toggle("dcg-mq-editing-overflow-right"),h.classList.contains("dcg-mq-editing-overflow-left")!==S&&h.classList.toggle("dcg-mq-editing-overflow-left")},b.prototype.scrollHoriz=function(){var h=this,m=this.cursor,S=m.selection,A=M(this.root.domFrag().oneElement());if(m.domFrag().isEmpty()&&!S){this.cancelScrollHoriz&&(this.cancelScrollHoriz(),this.cancelScrollHoriz=void 0);var q=this.root.domFrag().oneElement(),Y=q.scrollLeft;F(this.getScrollAnimationDuration(),function(lt,ht,Dt){lt>=1?(h.cancelScrollHoriz=void 0,q.scrollLeft=0,h.setOverflowClasses()):(h.cancelScrollHoriz=Dt,ht(),q.scrollLeft=Math.round((1-lt)*Y))});return}else if(S){var Q=M(S.domFrag().oneElement()),be=Q.left-(A.left+20),Ae=Q.right-(A.right-20);if(S.getEnd(n)===m[i])if(be<0)var Ne=be;else if(Ae>0)if(Q.left-Ae<A.left+20)var Ne=be;else var Ne=Ae;else return;else if(Ae>0)var Ne=Ae;else if(be<0)if(Q.right-be>A.right-20)var Ne=Ae;else var Ne=be;else return}else{var Ce=M(m.domFrag().oneElement()).left;if(Ce>A.right-20)var Ne=Ce-(A.right-20);else if(Ce<A.left+20)var Ne=Ce-(A.left+20);else return}var Ye=this.root.domFrag().oneElement();if(!(Ne<0&&Ye.scrollLeft===0)&&!(Ne>0&&Ye.scrollWidth<=Ye.scrollLeft+A.width)){this.cancelScrollHoriz&&(this.cancelScrollHoriz(),this.cancelScrollHoriz=void 0);var Xe=this.root.domFrag().oneElement(),ot=Xe.scrollLeft;F(this.getScrollAnimationDuration(),function(lt,ht,Dt){lt>=1?(h.cancelScrollHoriz=void 0,Xe.scrollLeft=Math.round(ot+Ne),h.setOverflowClasses()):(h.cancelScrollHoriz=Dt,ht(),Xe.scrollLeft=Math.round(ot+lt*Ne))})}},b.prototype.getScrollAnimationDuration=function(){var h;return(h=this.options.scrollAnimationDuration)!==null&&h!==void 0?h:100},b}(it);Ie.prototype.substituteTextarea=function(k){return p("textarea",{autocapitalize:"off",autocomplete:"off",autocorrect:"off",spellcheck:!1,"x-palm-disable-ste-all":!0,tabindex:k?void 0:"-1"})};function Gt(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(k){var b=Math.random()*16|0,h=k==="x"?b:b&3|8;return h.toString(16)})}function ar(k,b){return gt(k[0],b)}Ie.prototype.substituteKeyboardEvents=ar;var Vt=function(k){t(b,k);function b(){var h=k!==null&&k.apply(this,arguments)||this;return h.selectFn=s,h}return b.prototype.createTextarea=function(){this.textareaSpan=p("span",{class:"dcg-mq-textarea"});var h=this.options.tabbable!==void 0?this.options.tabbable:this.KIND_OF_MQ!=="StaticMath",m=this.options.substituteTextarea(h);if(!m.nodeType)throw"substituteTextarea() must return a DOM element, got "+m;!this.options.tabbable&&this.KIND_OF_MQ==="StaticMath"&&m.setAttribute("aria-hidden","true"),this.textarea=L(m).appendTo(this.textareaSpan).oneElement(),this.mathspeakSpan||(this.mathspeakId=Gt(),this.mathspeakSpan=p("span",{class:"dcg-mq-mathspeak",id:this.mathspeakId}),L(this.textareaSpan).prepend(L(this.mathspeakSpan))),this.mathspeakId&&(m==null||m.setAttribute("aria-labelledby",this.mathspeakId)),h&&this.mathspeakSpan&&this.mathspeakSpan.setAttribute("aria-hidden","true");var S=this;S.cursor.selectionChanged=function(){S.selectionChanged()}},b.prototype.selectionChanged=function(){var h=this;h.textareaSelectionTimeout||(h.textareaSelectionTimeout=setTimeout(function(){h.setTextareaSelection()}))},b.prototype.setTextareaSelection=function(){this.textareaSelectionTimeout=0;var h="";this.cursor.selection&&(h=this.cleanLatex(this.cursor.selection.join("latex")),this.options.statelessClipboard&&(h="$"+h+"$")),this.selectFn(h)},b.prototype.staticMathTextareaEvents=function(){var h=this;this.removeTextareaEventListener("cut"),this.removeTextareaEventListener("paste"),h.options.disableCopyPaste?this.removeTextareaEventListener("copy"):this.addTextareaEventListeners({copy:function(){h.setTextareaSelection()}}),this.addStaticFocusBlurListeners();var m=this.getTextarea(),S=gt(m,this).select;this.selectFn=S;var A=this.getTextareaSpan();L(this.container).prepend(L(A))},b.prototype.editablesTextareaEvents=function(){var h=this,m=h.getTextarea(),S=h.getTextareaSpan();if(this.options.version<3){var A=this.options.assertJquery(),q=this.options.substituteKeyboardEvents(A(m),this);this.selectFn=function(Q){q.select(Q)}}else{var Y=gt(m,this).select;this.selectFn=Y}L(this.container).prepend(L(S)),this.addEditableFocusBlurListeners(),this.updateMathspeak()},b.prototype.unbindEditablesEvents=function(){var h=this,m=h.getTextarea(),S=h.getTextareaSpan();this.selectFn=function(A){m instanceof HTMLTextAreaElement&&(m.value=A,A&&m.select())},L(S).remove(),this.removeTextareaEventListener("focus"),this.removeTextareaEventListener("blur"),h.blurred=!0,this.removeTextareaEventListener("cut"),this.removeTextareaEventListener("paste")},b.prototype.typedText=function(h){if(h===`
`)return this.handle("enter");var m=this.notify(void 0).cursor;m.parent.write(m,h),this.scrollHoriz()},b.prototype.cut=function(){var h=this,m=h.cursor;m.selection&&setTimeout(function(){h.notify("edit"),m.parent.bubble(function(S){S.reflow()}),h.options&&h.options.onCut&&h.options.onCut()})},b.prototype.copy=function(){this.setTextareaSelection()},b.prototype.paste=function(h){this.options.statelessClipboard&&(h.slice(0,1)==="$"&&h.slice(-1)==="$"?h=h.slice(1,-1):h="\\text{"+h+"}"),this.writeLatex(h).cursor.show(),this.scrollHoriz(),this.options&&this.options.onPaste&&this.options.onPaste()},b.prototype.setupStaticField=function(){this.updateMathspeak(),this.blurred=!0,this.cursor.hide().parent.blur(this.cursor)},b.prototype.updateMathspeak=function(h){var m=this,S=m.getAriaLabel(),A=/[A-Za-z0-9]$/.test(S)?S+":":S,q=m.root.mathspeak().trim(),Y=!!(h!=null&&h.emptyContent);this.aria.clear({emptyContent:Y}),m.mathspeakSpan&&(m.mathspeakSpan.textContent=(A+" "+q+" "+m.ariaPostLabel).trim())},b}(Cr),at=function(k){t(b,k);function b(){return k!==null&&k.apply(this,arguments)||this}return b.prototype.finalizeInsert=function(h,m){var S=this;S.postOrder(function(Y){Y.finalizeTree(h)}),S.postOrder(function(Y){Y.contactWeld(m)}),S.postOrder(function(Y){Y.blur(m)}),S.postOrder(function(Y){Y.reflow()});var A=S[i],q=S[n];A&&A.siblingCreated(h,n),q&&q.siblingCreated(h,i),S.bubble(function(Y){Y.reflow()})},b.prototype.prepareInsertionAt=function(h){var m=h.options.maxDepth;if(m!==void 0){var S=h.depth();if(S>m)return!1;this.removeNodesDeeperThan(m-S)}return!0},b.prototype.removeNodesDeeperThan=function(h){for(var m=0,S=[[this,m]],A;A=S.shift();){var q=A;q[0].children().each(function(Y){var Q=Y instanceof Je?1:0;m=q[1]+Q,m<=h?S.push([Y,m]):(Q?Y.children():Y).remove()})}},b}(me),We=function(){function k(b,h){this.childCount=b,this.render=h}return k}(),ue=function(k){t(b,k);function b(h,m,S){var A=k.call(this)||this;return A.textTemplate=[""],A.mathspeakTemplate=[""],A.setCtrlSeqHtmlAndText(h,m,S),A}return b.prototype.setEnds=function(h){c("MathCommand ends are never empty",h[n]&&h[i]),this.ends=h},b.prototype.getEnd=function(h){return this.ends[h]},b.prototype.setCtrlSeqHtmlAndText=function(h,m,S){this.ctrlSeq||(this.ctrlSeq=h),m&&(this.domView=m),S&&(this.textTemplate=S)},b.prototype.replaces=function(h){h.disown(),this.replacedFragment=h},b.prototype.isEmpty=function(){return this.foldChildren(!0,function(h,m){return h&&m.isEmpty()})},b.prototype.parser=function(){var h=this,m=ae.block;return m.times(this.numBlocks()).map(function(S){h.blocks=S;for(var A=0;A<S.length;A+=1)S[A].adopt(h,h.getEnd(i),0);return h})},b.prototype.createLeftOf=function(h){var m=this,S=m.replacedFragment;if(m.createBlocks(),k.prototype.createLeftOf.call(this,h),S){var A=m.getEnd(n);S.adopt(A,0,0),S.domFrag().appendTo(A.domFrag().oneElement()),m.placeCursor(h),m.prepareInsertionAt(h)}m.finalizeInsert(h.options,h),m.placeCursor(h)},b.prototype.createBlocks=function(){for(var h=this,m=h.numBlocks(),S=h.blocks=Array(m),A=0;A<m;A+=1){var q=S[A]=new Je;q.adopt(h,h.getEnd(i),0)}},b.prototype.placeCursor=function(h){h.insAtRightEnd(this.foldChildren(this.getEnd(n),function(m,S){return m.isEmpty()?m:S}))},b.prototype.moveTowards=function(h,m,S){var A;S==="up"?A=this.upInto:S==="down"&&(A=this.downInto);var q=A||this.getEnd(-h);m.insAtDirEnd(-h,q),m.controller.aria.queueDirEndOf(-h).queue(m.parent,!0)},b.prototype.deleteTowards=function(h,m){this.isEmpty()?m[h]=this.remove()[h]:this.moveTowards(h,m)},b.prototype.selectTowards=function(h,m){m[-h]=this,m[h]=this[h]},b.prototype.selectChildren=function(){return new H(this,this)},b.prototype.unselectInto=function(h,m){var S=m.anticursor,A=S.ancestors[this.id];m.insAtDirEnd(-h,A)},b.prototype.seek=function(h,m){function S(Q){var be,Ae=Q.domFrag().oneElement(),Ne=M(Ae).left,Ce=Ne+Ae.offsetWidth;return be={},be[n]=Ne,be[i]=Ce,be}var A=this,q=S(A);if(h<q[n])return m.insLeftOf(A);if(h>q[i])return m.insRightOf(A);var Y=q[n];A.eachChild(function(Q){var be=S(Q);if(h<be[n])return h-Y<be[n]-h?Q[n]?m.insAtRightEnd(Q[n]):m.insLeftOf(A):m.insAtLeftEnd(Q),!1;if(h>be[i]){Q[i]?Y=be[i]:q[i]-h<h-be[i]?m.insRightOf(A):m.insAtRightEnd(Q);return}else return Q.seek(h,m),!1})},b.prototype.numBlocks=function(){return this.domView.childCount},b.prototype.html=function(){var h=this.blocks;c("domView is defined",this.domView);var m=this.domView,S=m.render(h||[]);return this.setDOM(S),G.linkElementByCmdNode(S,this),S},b.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h),h.latex+=this.ctrlSeq||"",this.eachChild(function(m){h.latex+="{";var S=h.latex.length;m.latexRecursive(h);var A=h.latex.length;S===A&&(h.latex+=" "),h.latex+="}"}),this.checkCursorContextClose(h)},b.prototype.text=function(){var h=this,m=0;return h.foldChildren(h.textTemplate[m],function(S,A){m+=1;var q=A.text();return S&&h.textTemplate[m]==="("&&q[0]==="("&&q.slice(-1)===")"?S+q.slice(1,-1)+h.textTemplate[m]:S+q+(h.textTemplate[m]||"")})},b.prototype.mathspeak=function(){var h=this,m=0;return h.foldChildren(h.mathspeakTemplate[m]||"Start"+h.ctrlSeq+" ",function(S,A){return m+=1,S+" "+A.mathspeak()+" "+(h.mathspeakTemplate[m]+" "||"End"+h.ctrlSeq+" ")})},b}(at),X=function(k){t(b,k);function b(h,m,S,A){var q=k.call(this)||this;return q.setCtrlSeqHtmlTextAndMathspeak(h,m?new We(0,function(){return m.cloneNode(!0)}):void 0,S,A),q}return b.prototype.setCtrlSeqHtmlTextAndMathspeak=function(h,m,S,A){!S&&h&&(S=h.replace(/^\\/,"")),this.mathspeakName=A||S,k.prototype.setCtrlSeqHtmlAndText.call(this,h,m,[S||""])},b.prototype.parser=function(){return Ve.succeed(this)},b.prototype.numBlocks=function(){return 0},b.prototype.replaces=function(h){h.remove()},b.prototype.createBlocks=function(){},b.prototype.moveTowards=function(h,m){m.domFrag().insDirOf(h,this.domFrag()),m[-h]=this,m[h]=this[h],m.controller.aria.queue(this)},b.prototype.deleteTowards=function(h,m){m[h]=this.remove()[h]},b.prototype.seek=function(h,m){var S=this.domFrag().oneElement(),A=M(S).left;return h-A<S.offsetWidth/2?m.insLeftOf(this):m.insRightOf(this),m},b.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h),h.latex+=this.ctrlSeq||"",this.checkCursorContextClose(h)},b.prototype.text=function(){return this.textTemplate.join("")},b.prototype.mathspeak=function(h){return this.mathspeakName||""},b.prototype.placeCursor=function(){},b.prototype.isEmpty=function(){return!0},b}(ue),fe=function(k){t(b,k);function b(h,m,S){return k.call(this,h,p("span",{},[m||p.text(h)]),void 0,S)||this}return b}(X);function Oe(k,b,h){return function(){return new fe(k,b?p.entityText(b):void 0,h)}}var we=function(k){t(b,k);function b(h,m,S,A,q){var Y=this;return q?Y=k.call(this,h,p("span",{},[m||p.text(h||"")]),void 0,A)||this:Y=k.call(this,h,p("span",{class:"dcg-mq-binary-operator"},m?[m]:[]),S,A)||this,Y}return b.prototype.isBinaryOperator=function(){return!0},b}(X);function Ge(k,b,h,m){return function(){return new we(k,b?p.entityText(b):void 0,h,m)}}var Je=function(k){t(b,k);function b(){var h=k!==null&&k.apply(this,arguments)||this;return h.ariaLabel="block",h}return b.prototype.join=function(h){return this.foldChildren("",function(m,S){return m+S[h]()})},b.prototype.html=function(){var h=document.createDocumentFragment();return this.eachChild(function(m){var S=m.html();h.appendChild(S)}),h},b.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h),this.eachChild(function(m){return m.latexRecursive(h)}),this.checkCursorContextClose(h)},b.prototype.text=function(){var h=this.getEnd(n),m=this.getEnd(i);return h===m&&h!==0?h.text():this.join("text")},b.prototype.mathspeak=function(){var h="",m={};return this.controller&&(m=this.controller.options.autoOperatorNames),this.foldChildren([],function(S,A){if(A.isPartOfOperator)h+=A.mathspeak();else{if(h!==""){if(m._maxLength>0){var q=m[h.toLowerCase()];typeof q=="string"&&(h=q)}S.push(h+" "),h=""}var Y=A.mathspeak(),Q=A.ctrlSeq;isNaN(Q)&&Q!=="."&&(!A.parent||!A.parent.parent||!A.parent.parent.isTextBlock())&&(Y=" "+Y+" "),S.push(Y)}return S}).join("").replace(/ +(?= )/g,"").replace(/(\.)([0-9]+)/g,function(S,A,q){return A+q.split("").join(" ").trim()})},b.prototype.keystroke=function(h,m,S){if(S.options.spaceBehavesLikeTab&&(h==="Spacebar"||h==="Shift-Spacebar")){m==null||m.preventDefault(),S.escapeDir(h==="Shift-Spacebar"?n:i,h,m);return}return k.prototype.keystroke.call(this,h,m,S)},b.prototype.moveOutOf=function(h,m,S){var A;if(S==="up"?A=this.parent.upInto:S==="down"&&(A=this.parent.downInto),!A&&this[h]){var q=-h;m.insAtDirEnd(q,this[h]),m.controller.aria.queueDirEndOf(q).queue(m.parent,!0)}else m.insDirOf(h,this.parent),m.controller.aria.queueDirOf(h).queue(this.parent)},b.prototype.selectOutOf=function(h,m){m.insDirOf(h,this.parent)},b.prototype.deleteOutOf=function(h,m){m.unwrapGramp()},b.prototype.seek=function(h,m){var S=this.getEnd(i);if(!S)return m.insAtRightEnd(this);var A=S.domFrag().oneElement(),q=M(A).left;if(q+A.offsetWidth<h)return m.insAtRightEnd(this);var Y=this.getEnd(n);if(h<M(Y.domFrag().oneElement()).left)return m.insAtLeftEnd(this);for(;h<M(S.domFrag().oneElement()).left;)S=S[n];return S.seek(h,m)},b.prototype.chToCmd=function(h,m){var S;return h.match(/^[a-eg-zA-Z]$/)?new Bt(h):/^\d$/.test(h)?new ft(h):m&&m.typingSlashWritesDivisionSymbol&&h==="/"?D["÷"](h):m&&m.typingAsteriskWritesTimesSymbol&&h==="*"?D["×"](h):m&&m.typingPercentWritesPercentOf&&h==="%"?D.percentof(h):(S=de[h]||D[h])?S.constructor?new S(h):S(h):new fe(h)},b.prototype.write=function(h,m){var S=this.chToCmd(m,h.options);h.selection&&S.replaces(h.replaceSelection()),h.isTooDeep()||(S.createLeftOf(h.show()),m==="/"?h.controller.aria.alert("over"):h.controller.aria.alert(S.mathspeak({createdLeftOf:h})))},b.prototype.writeLatex=function(h,m){var S=Ve.all,A=Ve.eof,q=ae.skip(A).or(S.result(!1)).parse(m);if(q&&!q.isEmpty()&&q.prepareInsertionAt(h)){q.children().adopt(h.parent,h[n],h[i]),L(q.html()).insertBefore(h.domFrag()),h[n]=q.getEnd(i),q.finalizeInsert(h.options,h);var Y=q.getEnd(i),Q=q.getEnd(n),be=Y[i],Ae=Q[n];be&&be.siblingCreated(h.options,n),Ae&&Ae.siblingCreated(h.options,i),h.parent.bubble(function(Ne){Ne.reflow()})}},b.prototype.focus=function(){return this.domFrag().addClass("dcg-mq-hasCursor"),this.domFrag().removeClass("dcg-mq-empty"),this},b.prototype.blur=function(h){return this.domFrag().removeClass("dcg-mq-hasCursor"),this.isEmpty()&&(this.domFrag().addClass("dcg-mq-empty"),h&&this.isQuietEmptyDelimiter(h.options.quietEmptyDelimiters)&&this.domFrag().addClass("dcg-mq-quiet-delimiter")),this},b}(at);Ie.prototype.mouseEvents=!0,ce.StaticMath=function(k){var b;return b=function(h){t(m,h);function m(S){var A=h.call(this,S)||this,q=A.innerFields=[];return A.__controller.root.postOrder(function(Y){Y.registerInnerField(q,k.InnerMathField)}),A}return m.prototype.__mathquillify=function(S,A){return this.config(S),h.prototype.mathquillify.call(this,"dcg-mq-math-mode"),this.__controller.setupStaticField(),this.__options.mouseEvents&&this.__controller.addMouseEventListener(),this.__controller.staticMathTextareaEvents(),this},m.prototype.latex=function(S){var A=h.prototype.latex.apply(this,arguments);if(arguments.length>0){var q=this.innerFields=[];this.__controller.root.postOrder(function(Y){Y.registerInnerField(q,k.InnerMathField)}),this.__controller.updateMathspeak()}return A},m.prototype.setAriaLabel=function(S){return this.__controller.setAriaLabel(S),this},m.prototype.getAriaLabel=function(){return this.__controller.getAriaLabel()},m}(k.AbstractMathQuill),b.RootBlock=Je,b};var ut=function(k){t(b,k);function b(){return k!==null&&k.apply(this,arguments)||this}return b}(Je);qe(ut.prototype),ce.MathField=function(k){var b;return b=function(h){t(m,h);function m(){return h!==null&&h.apply(this,arguments)||this}return m.prototype.__mathquillify=function(S,A){return this.config(S),A>1&&(this.__controller.root.reflow=s),h.prototype.mathquillify.call(this,"dcg-mq-editable-field dcg-mq-math-mode"),delete this.__controller.root.reflow,this},m}(k.EditableField),b.RootBlock=ut,b},ce.InnerMathField=function(k){return c("MathField class is defined",k.MathField),function(b){t(h,b);function h(){return b!==null&&b.apply(this,arguments)||this}return h.prototype.makeStatic=function(){this.__controller.editable=!1,this.__controller.root.blur(),this.__controller.unbindEditablesEvents(),L(this.__controller.container).removeClass("dcg-mq-editable-field")},h.prototype.makeEditable=function(){this.__controller.editable=!0,this.__controller.editablesTextareaEvents(),this.__controller.cursor.insAtRightEnd(this.__controller.root),L(this.__controller.container).addClass("dcg-mq-editable-field")},h}(k.MathField)};var St="\\ ",Lt=".",dt=function(k){t(b,k);function b(){return k!==null&&k.apply(this,arguments)||this}return b.prototype.finalizeTree=function(h,m){this.sharedSiblingMethod(h,m)},b.prototype.siblingDeleted=function(h,m){this.sharedSiblingMethod(h,m)},b.prototype.siblingCreated=function(h,m){this.sharedSiblingMethod(h,m)},b.prototype.sharedSiblingMethod=function(h,m){m!==n&&this[i]instanceof b||this.fixDigitGrouping(h)},b.prototype.fixDigitGrouping=function(h){if(h.enableDigitGrouping){var m=this,S=m;do if(/^[0-9]$/.test(S.ctrlSeq))m=S;else if(S.ctrlSeq===St)m=S;else if(S.ctrlSeq===Lt)m=S;else break;while(S=m[n]);b.fixDigitGroupingFromLeft(h,m)}},b.fixDigitGroupingFromLeft=function(h,m){for(;m&&m.ctrlSeq===St;){if(!m[i])return;m=m[i]}if(m instanceof b){var S=m;c("node",S);var A=m,q=0,Y=0,Q=[];do{if(/^[0-9]$/.test(S.ctrlSeq))A=S,Y=0;else if(S.ctrlSeq===St)A=S,q+=1,Y=0;else if(S.ctrlSeq===Lt&&S instanceof b)A=S,Q.push(S),h.tripleDotsAreEllipsis&&(Y+=1);else break;if(Y==3)break}while(S=A[i]);if(Y===3){var be=Q.pop(),Ae=Q.pop(),Ne=Q.pop();if(be[i]instanceof b&&b.fixDigitGroupingFromLeft(h,be[i]),be.setGroupingClass("dcg-mq-ellipsis-end"),Ae.setGroupingClass("dcg-mq-ellipsis-middle"),Ne.setGroupingClass("dcg-mq-ellipsis-start"),A=Ne[n],m===Ne)return}for(;A!==m&&A&&A.ctrlSeq===St;)A=A[n],q-=1;if(!(m===A&&m&&m.ctrlSeq===St)){var Ce=q>0||Q.length>1;Ce?b.removeGroupingBetween(m,A):Q[0]?(Q[0]!==m&&b.addGroupingBetween(Q[0][n],m),Q[0]!==A&&b.removeGroupingBetween(Q[0],A)):b.addGroupingBetween(A,m)}}},b.removeGroupingBetween=function(h,m){var S=h;do if(S instanceof b&&S.setGroupingClass(void 0),!S||S===m)break;while(S=S[i])},b.addGroupingBetween=function(h,m){for(var S=h,A=0,q=0;S&&(q+=1,c("digit",S instanceof b),S!==m);)S=S[n];var Y=q%3;Y===0&&(Y=3);for(var S=h;S;){A+=1;var Q=void 0;if(q>=4&&(A===q?Q="dcg-mq-group-leading-"+Y:A%3===0&&A!==q&&(Q="dcg-mq-group-start"),Q||(Q="dcg-mq-group-other")),S instanceof b&&S.setGroupingClass(Q),S===m)break;S=S[n]}},b.prototype.setGroupingClass=function(h){this._groupingClass!==h&&(this._groupingClass&&this.domFrag().removeClass(this._groupingClass),h&&this.domFrag().addClass(h),this._groupingClass=h)},b}(X),ft=function(k){t(b,k);function b(h,m){return k.call(this,h,p("span",{class:"dcg-mq-digit"},[p.text(h)]),void 0,m)||this}return b.prototype.createLeftOf=function(h){var m=h[n],S=m&&m[n],A=h.parent.parent instanceof Qr?h.parent.parent.sub:void 0;h.options.autoSubscriptNumerals&&h.parent!==A&&(m instanceof kt&&m.isItalic!==!1||m instanceof Qr&&S instanceof kt&&S.isItalic!==!1)?(new za().createLeftOf(h),k.prototype.createLeftOf.call(this,h),h.insRightOf(h.parent.parent)):k.prototype.createLeftOf.call(this,h)},b.prototype.mathspeak=function(h){if(h&&h.createdLeftOf){var m=h.createdLeftOf,S=m[n],A=S&&S[n],q=m.parent.parent instanceof Qr?m.parent.parent.sub:void 0;if(m.options.autoSubscriptNumerals&&m.parent!==q&&(S instanceof kt&&S.isItalic!==!1||m[n]instanceof Qr&&A instanceof kt&&A.isItalic!==!1))return"Subscript "+k.prototype.mathspeak.call(this)+" Baseline"}return k.prototype.mathspeak.call(this)},b}(dt),kt=function(k){t(b,k);function b(h,m){return k.call(this,h,p("var",{},[m||p.text(h)]))||this}return b.prototype.text=function(){var h=this.ctrlSeq||"";return this.isPartOfOperator?h[0]=="\\"?h=h.slice(1,h.length):h[h.length-1]==" "&&(h=h.slice(0,-1)):(this[n]&&!(this[n]instanceof b)&&!(this[n]instanceof we)&&this[n].ctrlSeq!=="\\ "&&(h="*"+h),this[i]&&!(this[i]instanceof we)&&!(this[i]instanceof Qr)&&(h+="*")),h},b.prototype.mathspeak=function(){var h=this.ctrlSeq||"";return this.isPartOfOperator||h.length>1||this.parent&&this.parent.parent&&this.parent.parent.isTextBlock()?k.prototype.mathspeak.call(this):'"'+h+'"'},b}(X);function Ct(k,b,h){return function(){return new kt(k,p.entityText(b))}}Ie.prototype.autoCommands={_maxLength:0},he.autoCommands=function(k){if(typeof k!="string"||!/^[a-z]+(?: [a-z]+)*$/i.test(k))throw'"'+k+'" not a space-delimited list of only letters';for(var b=k.split(" "),h={},m=0,S=0;S<b.length;S+=1){var A=b[S];if(A.length<2)throw'autocommand "'+A+'" not minimum length of 2';if(D[A]===Zi)throw'"'+A+'" is a built-in operator name';h[A]=1,m=a(m,A.length)}return h._maxLength=m,h},Ie.prototype.quietEmptyDelimiters={},he.quietEmptyDelimiters=function(k){k===void 0&&(k="");for(var b=k.split(" "),h={},m=0;m<b.length;m+=1){var S=b[m];h[S]=1}return h},Ie.prototype.autoParenthesizedFunctions={_maxLength:0},he.autoParenthesizedFunctions=function(k){if(typeof k!="string"||!/^[a-z]+(?: [a-z]+)*$/i.test(k))throw'"'+k+'" not a space-delimited list of only letters';for(var b=k.split(" "),h={},m=0,S=0;S<b.length;S+=1){var A=b[S];if(A.length<2)throw'autocommand "'+A+'" not minimum length of 2';h[A]=1,m=a(m,A.length)}return h._maxLength=m,h};function ur(k,b){for(var h="",m=0;k instanceof Bt&&k.ctrlSeq===k.letter&&m<b;)h=k.letter+h,k=k[n],m+=1;return h}var Bt=function(k){t(b,k);function b(h){var m=k.call(this,h)||this;return m.letter=h,m}return b.prototype.checkAutoCmds=function(h){var m;if(!this.shouldIgnoreSubstitutionInSimpleSubscript(h.options)){var S=h.options.autoCommands,A=S._maxLength||0;if(A>0)for(var q=(m=ur(this,A))!==null&&m!==void 0?m:"";q.length;){if(S.hasOwnProperty(q)){for(var Y=this,Q=1;Y&&Q<q.length;Q+=1,Y=Y[n]);new U(Y,this).remove(),h[n]=Y[n];var be=D[q],Ae;return ge(be)?Ae=new be(q):Ae=be(q),Ae.createLeftOf(h)}q=q.slice(1)}}},b.prototype.autoParenthesize=function(h){var m=h.parent.getEnd(i);if(!(m&&m instanceof Hr&&m.ctrlSeq==="\\left(")&&!this.shouldIgnoreSubstitutionInSimpleSubscript(h.options)){for(var S="",A=this,q=0,Y=h.options.autoParenthesizedFunctions,Q=Y._maxLength||0,be=h.options.autoOperatorNames;A instanceof b&&q<Q;)S=A.letter+S,A=A[n],q+=1;for(;S.length;){if(Y.hasOwnProperty(S)&&be.hasOwnProperty(S))return h.parent.write(h,"(");S=S.slice(1)}}},b.prototype.createLeftOf=function(h){k.prototype.createLeftOf.call(this,h),this.checkAutoCmds(h),this.autoParenthesize(h)},b.prototype.italicize=function(h){return this.isItalic=h,this.isPartOfOperator=!h,h&&(delete this.endsCategory,delete this.endsWord),this.domFrag().toggleClass("dcg-mq-operator-name",!h),this},b.prototype.finalizeTree=function(h,m){this.sharedSiblingMethod(h,m)},b.prototype.siblingDeleted=function(h,m){this.sharedSiblingMethod(h,m)},b.prototype.siblingCreated=function(h,m){this.sharedSiblingMethod(h,m)},b.prototype.sharedSiblingMethod=function(h,m){m!==n&&this[i]instanceof b||this.autoUnItalicize(h)},b.prototype.autoUnItalicize=function(h){var m=h.autoOperatorNames;if(m._maxLength!==0&&!this.shouldIgnoreSubstitutionInSimpleSubscript(h)){for(var S=this.letter,A=this[n];A instanceof b;A=A[n])S=A.letter+S;for(var q=this[i];q instanceof b;q=q[i])S+=q.letter;var Y=A&&A[i],Q=q&&q[n];new U(Y||this.parent.getEnd(n),Q||this.parent.getEnd(i)).each(function(jr){jr instanceof b&&(jr.italicize(!0).domFrag().removeClass("dcg-mq-first dcg-mq-last dcg-mq-followed-by-supsub"),jr.ctrlSeq=jr.letter)});var be=m._maxLength||0;e:for(var Ae=0,Ne=A[i]||this.parent.getEnd(n);Ne&&Ae<S.length;Ae+=1,Ne=Ne[i])for(var Ce=o(be,S.length-Ae);Ce>0;Ce-=1){var Ye=S.slice(Ae,Ae+Ce),Xe=void 0;if(m.hasOwnProperty(Ye)){for(var ot=0,lt=Ne;ot<Ce;ot+=1,lt=lt[i])lt instanceof b&&(lt.italicize(!1),Xe=lt);var ht=Ot.hasOwnProperty(Ye);if(Ne.ctrlSeq=(ht?"\\":"\\operatorname{")+Ne.ctrlSeq,Xe.ctrlSeq+=ht?" ":"}",Xe.endsWord=Ye,h.infixOperatorNames[Ye]?Xe.endsCategory="infix":h.prefixOperatorNames[Ye]&&(Xe.endsCategory="prefix"),pr.hasOwnProperty(Ye)){var Dt=Xe[n],Mr=Dt&&Dt[n],Rt=Mr&&Mr[n];Rt.domFrag().addClass("dcg-mq-last")}if(this.shouldOmitPadding(Ne[n])||Ne.domFrag().addClass("dcg-mq-first"),!this.shouldOmitPadding(Xe[i]))if(Xe[i]instanceof Qr){var Qt=Xe[i],Yr=Qt.siblingCreated=Qt.siblingDeleted=function(){Qt.domFrag().toggleClass("dcg-mq-after-operator-name",!(Qt[i]instanceof Hr))};Yr()}else Xe.domFrag().toggleClass("dcg-mq-last",!(Xe[i]instanceof Hr));Ae+=Ce-1,Ne=Xe;continue e}}}},b.prototype.shouldOmitPadding=function(h){return!!(!h||h.ctrlSeq==="."||h instanceof we&&h.isBinaryOperator()||h instanceof xn)},b}(kt),Ot={};Ie.prototype.autoOperatorNames=Gr();var pr={limsup:1,liminf:1,projlim:1,injlim:1};function Gr(){for(var k={_maxLength:9},b="arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr".split(" "),h=0;h<b.length;h+=1)Ot[b[h]]=k[b[h]]=1;for(var m="sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" "),h=0;h<m.length;h+=1)Ot[m[h]]=1;for(var S="sin cos tan sec cosec csc cotan cot ctg".split(" "),h=0;h<S.length;h+=1)k[S[h]]=k["arc"+S[h]]=k[S[h]+"h"]=k["ar"+S[h]+"h"]=k["arc"+S[h]+"h"]=1;for(var A="gcf hcf lcm proj span".split(" "),h=0;h<A.length;h+=1)k[A[h]]=1;return k}he.autoOperatorNames=function(k){if(typeof k!="string")throw'"'+k+'" not a space-delimited list';if(!/^[a-z\|\-]+(?: [a-z\|\-]+)*$/i.test(k))throw'"'+k+'" not a space-delimited list of letters or "|"';for(var b=k.split(" "),h={},m=0,S=0;S<b.length;S+=1){var A=b[S];if(A.length<2)throw'"'+A+'" not minimum length of 2';if(A.indexOf("|")<0)h[A]=A,m=a(m,A.length);else{var q=A.split("|");if(q.length>2)throw'"'+A+'" has more than 1 mathspeak delimiter';if(q[0].length<2)throw'"'+A[0]+'" not minimum length of 2';h[q[0]]=q[1].replace(/-/g," "),m=a(m,q[0].length)}}return h._maxLength=m,h},Ie.prototype.infixOperatorNames={},he.infixOperatorNames=kr,Ie.prototype.prefixOperatorNames={},he.prefixOperatorNames=kr,Ie.prototype.disableAutoSubstitutionInSubscripts=!1,he.disableAutoSubstitutionInSubscripts=function(k){if(typeof k=="boolean")return k;if(typeof k!="object"||k===null||!("except"in k))throw'"'+k+'" not an object with property "except"';return{except:kr(k.except)}};function kr(k){if(typeof k!="string")throw'"'+k+'" not a space-delimited list';if(!/^[a-z]+(?: [a-z]+)*$/i.test(k))throw'"'+k+'" not a space-delimited list of letters';for(var b=k.split(" "),h={},m=0;m<b.length;m+=1){var S=b[m];if(S.length<2)throw'"'+S+'" not minimum length of 2';h[S]=!0}return h}var Zi=function(k){t(b,k);function b(h){return k.call(this,h||"")||this}return b.prototype.createLeftOf=function(h){for(var m=this.ctrlSeq,S=0;S<m.length;S+=1)new Bt(m.charAt(S)).createLeftOf(h)},b.prototype.parser=function(){for(var h=this.ctrlSeq,m=new Je,S=0;S<h.length;S+=1)new Bt(h.charAt(S)).adopt(m,m.getEnd(i),0);return Ve.succeed(m.children())},b}(X);for(var Dn in Ie.prototype.autoOperatorNames)Ie.prototype.autoOperatorNames.hasOwnProperty(Dn)&&(D[Dn]=Zi);D.operatorname=function(k){t(b,k);function b(){return k!==null&&k.apply(this,arguments)||this}return b.prototype.createLeftOf=function(){},b.prototype.numBlocks=function(){return 1},b.prototype.parser=function(){return ae.block.map(function(h){var m=!0,S="",A=h.children();return A.each(function(q){q instanceof Bt?S+=q.letter:m=!1}),m&&S==="ans"?Ua():A})},b}(ue),D.f=function(k){t(b,k);function b(){var h=this,m="f";return h=k.call(this,m)||this,h.letter=m,h.domView=new We(0,function(){return p("var",{class:"dcg-mq-f"},[p.text("f")])}),h}return b.prototype.italicize=function(h){return this.domFrag().eachElement(function(m){return m.textContent="f"}),this.domFrag().toggleClass("dcg-mq-f",h),k.prototype.italicize.call(this,h)},b}(Bt),D[" "]=D.space=function(){return new dt("\\ ",p("span",{},[p.text(f)])," ")},D["."]=function(){return new dt(".",p("span",{class:"dcg-mq-digit"},[p.text(".")]),".")},D["'"]=D.prime=Oe("'","&prime;","prime"),D["″"]=D.dprime=Oe("″","&Prime;","double prime"),D.backslash=Oe("\\backslash ","\\","backslash"),de["\\"]||(de["\\"]=D.backslash),D.$=Oe("\\$","$","dollar"),D["□"]=D.square=Oe("\\square ","□","square"),D.mid=Oe("\\mid ","∣","mid");var $r=function(k){t(b,k);function b(h,m,S){return k.call(this,h,p("span",{class:"dcg-mq-nonSymbola"},[m||p.text(h)]))||this}return b}(X);D["@"]=function(){return new $r("@")},D["&"]=function(){return new $r("\\&",p.entityText("&amp;"),"and")},D["%"]=function(k){t(b,k);function b(){return k.call(this,"\\%",p.text("%"),"percent")||this}return b.prototype.parser=function(){var h=Ve.optWhitespace,m=Ve.string;return h.then(m("\\operatorname{of}").map(function(){return Xa()})).or(k.prototype.parser.call(this))},b}($r),D["∥"]=D.parallel=Oe("\\parallel ","&#x2225;","parallel"),D["∦"]=D.nparallel=Oe("\\nparallel ","&#x2226;","not parallel"),D["⟂"]=D.perp=Oe("\\perp ","&#x27C2;","perpendicular");function Zt(k){return Ct("\\"+k+" ","&"+k+";")}D.α=D.alpha=Zt("alpha"),D.β=D.beta=Zt("beta"),D.γ=D.gamma=Zt("gamma"),D.δ=D.delta=Zt("delta"),D.ζ=D.zeta=Zt("zeta"),D.η=D.eta=Zt("eta"),D.θ=D.theta=Zt("theta"),D.ι=D.iota=Zt("iota"),D.κ=D.kappa=Zt("kappa"),D.μ=D.mu=Zt("mu"),D.ν=D.nu=Zt("nu"),D.ξ=D.xi=Zt("xi"),D.ρ=D.rho=Zt("rho"),D.σ=D.sigma=Zt("sigma"),D.τ=D.tau=Zt("tau"),D.χ=D.chi=Zt("chi"),D.ψ=D.psi=Zt("psi"),D.ω=D.omega=Zt("omega"),D.ϕ=D.phi=Ct("\\phi ","&#981;"),D.φ=D.phiv=D.varphi=Ct("\\varphi ","&phi;"),D["ϵ"]=D.epsilon=Ct("\\epsilon ","&#1013;"),D.ε=D.epsiv=D.varepsilon=Ct("\\varepsilon ","&epsilon;"),D.ϖ=D.piv=D.varpi=Ct("\\varpi ","&piv;"),D.ς=D.sigmaf=D.sigmav=D.varsigma=Ct("\\varsigma ","&sigmaf;"),D.ϑ=D.thetav=D.vartheta=D.thetasym=Ct("\\vartheta ","&thetasym;"),D.υ=D.upsilon=D.upsi=Ct("\\upsilon ","&upsilon;"),D.Ϝ=D.gammad=D.Gammad=D.digamma=Ct("\\digamma ","&#989;"),D.ϰ=D.kappav=D.varkappa=Ct("\\varkappa ","&#1008;"),D.ϱ=D.rhov=D.varrho=Ct("\\varrho ","&#1009;"),D.pi=D.π=function(){return new $r("\\pi ",p.entityText("&pi;"),"pi")},D.λ=D.lambda=function(){return new $r("\\lambda ",p.entityText("&lambda;"),"lambda")},D.Υ=D.Upsilon=D.Upsi=D.upsih=D.Upsih=function(){return new X("\\Upsilon ",p("var",{style:"font-family: serif"},[p.entityText("&upsih;")]),"capital upsilon")};function xr(k){return function(){return new fe("\\"+k+" ",p.entityText("&"+k+";"))}}D.Γ=D.Gamma=xr("Gamma"),D.Δ=D.Delta=xr("Delta"),D.Θ=D.Theta=xr("Theta"),D.Λ=D.Lambda=xr("Lambda"),D.Ξ=D.Xi=xr("Xi"),D.Π=D.Pi=xr("Pi"),D.Σ=D.Sigma=xr("Sigma"),D.Φ=D.Phi=xr("Phi"),D.Ψ=D.Psi=xr("Psi"),D.Ω=D.Omega=xr("Omega"),D["∀"]=D.forall=xr("forall");var Lr=function(k){t(b,k);function b(h){var m=k.call(this)||this;return m.latexStr=h,m}return b.prototype.createLeftOf=function(h){var m=ae.parse(this.latexStr);m.children().adopt(h.parent,h[n],h[i]),h[n]=m.getEnd(i),L(m.html()).insertBefore(h.domFrag()),m.finalizeInsert(h.options,h);var S=m.getEnd(i),A=S&&S[i];A&&A.siblingCreated(h.options,n);var q=m.getEnd(n),Y=q&&q[n];Y&&Y.siblingCreated(h.options,i),h.parent.bubble(function(Q){Q.reflow()})},b.prototype.mathspeak=function(){return ae.parse(this.latexStr).mathspeak()},b.prototype.parser=function(){var h=ae.parse(this.latexStr).children();return Ve.succeed(h)},b}(ue);D["⁰"]=function(){return new Lr("^0")},D["¹"]=function(){return new Lr("^1")},D["²"]=function(){return new Lr("^2")},D["³"]=function(){return new Lr("^3")},D["⁴"]=function(){return new Lr("^4")},D["⁵"]=function(){return new Lr("^5")},D["⁶"]=function(){return new Lr("^6")},D["⁷"]=function(){return new Lr("^7")},D["⁸"]=function(){return new Lr("^8")},D["⁹"]=function(){return new Lr("^9")},D["¼"]=function(){return new Lr("\\frac14")},D["½"]=function(){return new Lr("\\frac12")},D["¾"]=function(){return new Lr("\\frac34")},D["√"]=function(){return new Lr("\\sqrt{}")};function nn(k){return k instanceof we||k instanceof Bt&&k.endsCategory=="infix"}function tn(k){if(!k)return!1;var b=k[n];if(b){if(nn(b)||b instanceof Bt&&b.endsCategory=="prefix"||!(b instanceof Hr)&&/^(\\ )|[,;:\(\[]$/.test(b.ctrlSeq))return!1}else return k.parent&&k.parent.parent&&k.parent.parent.isStyleBlock()?tn(k.parent.parent):!1;return!0}var Kr=function(k){t(b,k);function b(h,m,S){return k.call(this,h,m,void 0,S,!0)||this}return b.prototype.isBinaryOperator=function(){return tn(this)},b.prototype.contactWeld=function(h,m){this.sharedSiblingMethod(h.options,m)},b.prototype.siblingCreated=function(h,m){this.sharedSiblingMethod(h,m)},b.prototype.siblingDeleted=function(h,m){this.sharedSiblingMethod(h,m)},b.prototype.sharedSiblingMethod=function(h,m){if(m!==i)return this.domFrag().oneElement().className=tn(this)?"dcg-mq-binary-operator":"",this},b}(we);D["+"]=function(k){t(b,k);function b(){return k.call(this,"+",p.text("+"))||this}return b.prototype.mathspeak=function(){return tn(this)?"plus":"positive"},b}(Kr);var ea=function(k){t(b,k);function b(){return k.call(this,"-",p.entityText("&minus;"))||this}return b.prototype.mathspeak=function(){return tn(this)?"minus":"negative"},b}(Kr);D["−"]=D["—"]=D["–"]=D["-"]=ea,D["±"]=D.pm=D.plusmn=D.plusminus=function(){return new Kr("\\pm ",p.entityText("&plusmn;"),"plus-or-minus")},D.mp=D.mnplus=D.minusplus=function(){return new Kr("\\mp ",p.entityText("&#8723;"),"minus-or-plus")},de["*"]=D.sdot=D.cdot=Ge("\\cdot ","&middot;","*","times");var na=function(k){t(b,k);function b(){return k.call(this,"\\to ",p.entityText("&rarr;"),"to")||this}return b.prototype.deleteTowards=function(h,m){if(h===n){var S=m[n];new U(S,this).remove(),m[n]=S[n],new ea().createLeftOf(m),m[n].bubble(function(A){A.reflow()});return}k.prototype.deleteTowards.call(this,h,m)},b}(we);D["→"]=D.to=na;var Un=function(k){t(b,k);function b(h,m){var S=this,A=m?"Strict":"";return S=k.call(this,h["ctrlSeq".concat(A)],p.entityText(h["htmlEntity".concat(A)]),h["text".concat(A)],h["mathspeak".concat(A)])||this,S.data=h,S.strict=m,S}return b.prototype.swap=function(h){this.strict=h;var m=h?"Strict":"";this.ctrlSeq=this.data["ctrlSeq".concat(m)],this.domFrag().children().replaceWith(L(p.entityText(this.data["htmlEntity".concat(m)]))),this.textTemplate=[this.data["text".concat(m)]],this.mathspeakName=this.data["mathspeak".concat(m)]},b.prototype.deleteTowards=function(h,m){if(h===n&&!this.strict){this.swap(!0),this.bubble(function(S){S.reflow()});return}k.prototype.deleteTowards.call(this,h,m)},b}(we),aa={ctrlSeq:"\\le ",htmlEntity:"&le;",text:"≤",mathspeak:"less than or equal to",ctrlSeqStrict:"<",htmlEntityStrict:"&lt;",textStrict:"<",mathspeakStrict:"less than"},fa={ctrlSeq:"\\ge ",htmlEntity:"&ge;",text:"≥",mathspeak:"greater than or equal to",ctrlSeqStrict:">",htmlEntityStrict:"&gt;",textStrict:">",mathspeakStrict:"greater than"},ac=function(k){t(b,k);function b(){return k.call(this,fa,!0)||this}return b.prototype.createLeftOf=function(h){var m=h[n];if(m instanceof we&&m.ctrlSeq==="-"){var S=m;h[n]=S[n],S.remove(),new na().createLeftOf(h),h[n].bubble(function(A){A.reflow()});return}k.prototype.createLeftOf.call(this,h)},b}(Un);D["<"]=D.lt=function(){return new Un(aa,!0)},D[">"]=D.gt=ac,D["≤"]=D.le=D.leq=function(){return new Un(aa,!1)},D["≥"]=D.ge=D.geq=function(){return new Un(fa,!1)},D["∞"]=D.infty=D.infin=D.infinity=Oe("\\infty ","&infin;","infinity"),D["≠"]=D.ne=D.neq=Ge("\\ne ","&ne;","not equal");var ba=function(k){t(b,k);function b(){return k.call(this,"=",p.text("="),"=","equals")||this}return b.prototype.createLeftOf=function(h){var m=h[n];if(m instanceof Un&&m.strict){m.swap(!1),m.bubble(function(S){S.reflow()});return}k.prototype.createLeftOf.call(this,h)},b}(we);D["="]=ba,D["×"]=D.times=D.cross=Ge("\\times ","&times;","[x]","times"),D["÷"]=D.div=D.divide=D.divides=Ge("\\div ","&divide;","[/]","over");var va=function(k){t(b,k);function b(){return k.call(this,"\\sim ",p.text("~"),"~","tilde")||this}return b.prototype.createLeftOf=function(h){if(h[n]instanceof b){var m=h[n];h[n]=m[n],m.remove(),new Na().createLeftOf(h),h[n].bubble(function(S){S.reflow()});return}k.prototype.createLeftOf.call(this,h)},b}(we),Na=function(k){t(b,k);function b(){return k.call(this,"\\approx ",p.entityText("&approx;"),"≈","approximately equal")||this}return b.prototype.deleteTowards=function(h,m){if(h===n){var S=m[n];new U(S,this).remove(),m[n]=S[n],new va().createLeftOf(m),m[n].bubble(function(A){A.reflow()});return}k.prototype.deleteTowards.call(this,h,m)},b}(we);D.tildeNbsp=Oe("~",f," "),D.sim=va,D["≈"]=D.approx=Na,de["~"]=D.sim,D["~"]=D.tildeNbsp,he.interpretTildeAsSim=function(k){var b=!!k;return b?D["~"]=D.sim:D["~"]=D.tildeNbsp,b},D["◯"]=D.bigcirc=Oe("\\bigcirc ","&#9711;","circle"),D["∠"]=D.ang=D.angle=Oe("\\angle ","&ang;","angle"),D["°"]=D.degree=Oe("\\degree ","&deg;","degrees"),D["△"]=D.triangle=Oe("\\triangle ","&#9651;","triangle"),D["≅"]=D.cong=Ge("\\cong ","&cong;","cong","congruent"),D["∡"]=D.measuredangle=Oe("\\measuredangle ","&#8737;","measured angle"),D["▱"]=D.parallelogram=Oe("\\parallelogram ","&#9649;","parallelogram"),D["≇"]=D.ncong=Ge("\\ncong ","&ncong;","ncong","not congruent"),D["≁"]=D.nsim=Ge("\\nsim ","&nsim;","nsim","not similar");var li={sqrt:{width:"",html:function(){return p("svg",{preserveAspectRatio:"none",viewBox:"0 0 32 54"},[p("path",{d:"M0 33 L7 27 L12.5 47 L13 47 L30 0 L32 0 L13 54 L11 54 L4.5 31 L0 33"})])}},"|":{width:".4em",html:function(){return p("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[p("path",{d:"M4.4 0 L4.4 54 L5.6 54 L5.6 0"})])}},"[":{width:".55em",html:function(){return p("svg",{preserveAspectRatio:"none",viewBox:"0 0 11 24"},[p("path",{d:"M8 0 L3 0 L3 24 L8 24 L8 23 L4 23 L4 1 L8 1"})])}},"]":{width:".55em",html:function(){return p("svg",{preserveAspectRatio:"none",viewBox:"0 0 11 24"},[p("path",{d:"M3 0 L8 0 L8 24 L3 24 L3 23 L7 23 L7 1 L3 1"})])}},"(":{width:".55em",html:function(){return p("svg",{preserveAspectRatio:"none",viewBox:"3 0 106 186"},[p("path",{d:"M85 0 A61 101 0 0 0 85 186 L75 186 A75 101 0 0 1 75 0"})])}},")":{width:".55em",html:function(){return p("svg",{preserveAspectRatio:"none",viewBox:"3 0 106 186"},[p("path",{d:"M24 0 A61 101 0 0 1 24 186 L34 186 A75 101 0 0 0 34 0"})])}},"{":{width:".7em",html:function(){return p("svg",{preserveAspectRatio:"none",viewBox:"10 0 210 350"},[p("path",{d:"M170 0 L170 6 A47 52 0 0 0 123 60 L123 127 A35 48 0 0 1 88 175 A35 48 0 0 1 123 223 L123 290 A47 52 0 0 0 170 344 L170 350 L160 350 A58 49 0 0 1 102 301 L103 220 A45 40 0 0 0 58 180 L58 170 A45 40 0 0 0 103 130 L103 49 A58 49 0 0 1 161 0"})])}},"}":{width:".7em",html:function(){return p("svg",{preserveAspectRatio:"none",viewBox:"10 0 210 350"},[p("path",{d:"M60 0 L60 6 A47 52 0 0 1 107 60 L107 127 A35 48 0 0 0 142 175 A35 48 0 0 0 107 223 L107 290 A47 52 0 0 1 60 344 L60 350 L70 350 A58 49 0 0 0 128 301 L127 220 A45 40 0 0 1 172 180 L172 170 A45 40 0 0 1 127 130 L127 49 A58 49 0 0 0 70 0"})])}},"&#8741;":{width:".7em",html:function(){return p("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[p("path",{d:"M3.2 0 L3.2 54 L4 54 L4 0 M6.8 0 L6.8 54 L6 54 L6 0"})])}},"&lang;":{width:".55em",html:function(){return p("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[p("path",{d:"M6.8 0 L3.2 27 L6.8 54 L7.8 54 L4.2 27 L7.8 0"})])}},"&rang;":{width:".55em",html:function(){return p("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[p("path",{d:"M3.2 0 L6.8 27 L3.2 54 L2.2 54 L5.8 27 L2.2 0"})])}}},vi="➤",Zr=function(k){t(b,k);function b(h,m,S,A,q){var Y=k.call(this,h,new We(1,function(Q){var be,Ae;return p.block(m,S,Q[0],{beforeChild:(be=q==null?void 0:q.beforeChild)===null||be===void 0?void 0:be.call(q),afterChild:(Ae=q==null?void 0:q.afterChild)===null||Ae===void 0?void 0:Ae.call(q)})}))||this;return Y.ariaLabel=A||h.replace(/^\\/,""),Y.mathspeakTemplate=["Start"+Y.ariaLabel+",","End"+Y.ariaLabel],Y.shouldNotSpeakDelimiters=q&&q.shouldNotSpeakDelimiters,Y}return b.prototype.mathspeak=function(h){return!this.shouldNotSpeakDelimiters||h&&h.ignoreShorthand?k.prototype.mathspeak.call(this):this.foldChildren("",function(m,S){return m+" "+S.mathspeak(h)}).trim()},b}(ue);D.mathrm=function(k){t(b,k);function b(){return k.call(this,"\\mathrm","span",{class:"dcg-mq-roman dcg-mq-font"},"Roman Font",{shouldNotSpeakDelimiters:!0})||this}return b.prototype.isTextBlock=function(){return!0},b}(Zr),D.mathit=function(){return new Zr("\\mathit","i",{class:"dcg-mq-font"},"Italic Font")},D.mathbf=function(){return new Zr("\\mathbf","b",{class:"dcg-mq-font"},"Bold Font")},D.mathsf=function(){return new Zr("\\mathsf","span",{class:"dcg-mq-sans-serif dcg-mq-font"},"Serif Font")},D.mathtt=function(){return new Zr("\\mathtt","span",{class:"dcg-mq-monospace dcg-mq-font"},"Math Text")},D.underline=function(){return new Zr("\\underline","span",{class:"dcg-mq-non-leaf dcg-mq-underline"},"Underline")},D.overline=D.bar=function(){return new Zr("\\overline","span",{class:"dcg-mq-non-leaf dcg-mq-overline"},"Overline")},D.overrightarrow=function(){return new Zr("\\overrightarrow","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow"},"Over Right Arrow",{afterChild:function(){return p("span",{class:"dcg-mq-arrow-right-content"},[p.text(vi)])}})},D.overleftarrow=function(){return new Zr("\\overleftarrow","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow"},"Over Left Arrow",{beforeChild:function(){return p("span",{class:"dcg-mq-arrow-left-content"},[p.text(vi)])}})},D.overleftrightarrow=function(){return new Zr("\\overleftrightarrow ","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow"},"Over Left and Right Arrow",{beforeChild:function(){return p("span",{class:"dcg-mq-arrow-left-content"},[p.text(vi)])},afterChild:function(){return p("span",{class:"dcg-mq-arrow-right-content"},[p.text(vi)])}})},D.overarc=function(){return new Zr("\\overarc","span",{class:"dcg-mq-non-leaf dcg-mq-overarc"},"Over Arc")},D.dot=function(){return new ue("\\dot",new We(1,function(k){return p("span",{class:"dcg-mq-non-leaf"},[p("span",{class:"dcg-mq-dot-recurring-inner"},[p("span",{class:"dcg-mq-dot-recurring"},[p.text(E)]),p.block("span",{class:"dcg-mq-empty-box"},k[0])])])}))},D.textcolor=function(k){t(b,k);function b(){return k!==null&&k.apply(this,arguments)||this}return b.prototype.setColor=function(h){this.color=h,this.domView=new We(1,function(m){return p.block("span",{class:"dcg-mq-textcolor",style:"color:"+h},m[0])}),this.ariaLabel=h.replace(/^\\/,""),this.mathspeakTemplate=["Start "+this.ariaLabel+",","End "+this.ariaLabel]},b.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h);var m=this.blocks[0];h.latex+="\\textcolor{"+this.color+"}{",m.latexRecursive(h),h.latex+="}",this.checkCursorContextClose(h)},b.prototype.parser=function(){var h=this,m=Ve.optWhitespace,S=Ve.string,A=Ve.regex;return m.then(S("{")).then(A(/^[#\w\s.,()%-]*/)).skip(S("}")).then(function(q){return h.setColor(q),k.prototype.parser.call(h)})},b.prototype.isStyleBlock=function(){return!0},b}(ue),D.class=function(k){t(b,k);function b(){return k!==null&&k.apply(this,arguments)||this}return b.prototype.parser=function(){var h=this,m=Ve.string,S=Ve.regex;return Ve.optWhitespace.then(m("{")).then(S(/^[-\w\s\\\xA0-\xFF]*/)).skip(m("}")).then(function(A){return h.cls=A||"",h.domView=new We(1,function(q){return p.block("span",{class:"dcg-mq-class ".concat(A)},q[0])}),h.ariaLabel=A+" class",h.mathspeakTemplate=["Start "+h.ariaLabel+",","End "+h.ariaLabel],k.prototype.parser.call(h)})},b.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h);var m=this.blocks[0];h.latex+="\\class{"+this.cls+"}{",m.latexRecursive(h),h.latex+="}",this.checkCursorContextClose(h)},b.prototype.isStyleBlock=function(){return!0},b}(ue);var wi=/^[\+\-]?[\d]+$/;function oo(k){if(!k)return"";var b="";return k.eachChild(function(h){h.ctrlSeq!==void 0&&(b+=h.ctrlSeq)}),b}Ie.prototype.charsThatBreakOutOfSupSub="";var Qr=function(k){t(b,k);function b(){var h=k!==null&&k.apply(this,arguments)||this;return h.ctrlSeq="_{...}^{...}",h}return b.prototype.setEnds=function(h){c("SupSub ends must be MathBlocks",h[n]instanceof Je&&h[i]instanceof Je),this.ends=h},b.prototype.getEnd=function(h){return this.ends[h]},b.prototype.createLeftOf=function(h){if(!(!this.replacedFragment&&!h[n]&&h.options.supSubsRequireOperand))return k.prototype.createLeftOf.call(this,h)},b.prototype.contactWeld=function(h){for(var m=n;m;m=m===n?i:!1){var S=this[m],A=void 0;if(S instanceof b){for(var q="sub";q;q=q==="sub"?"sup":!1){var Y=this[q],Q=S[q];if(Y){if(!Q)S.addBlock(Y.disown());else if(Y.isEmpty())A=new z(Q,0,Q.getEnd(n));else{Y.domFrag().children().insAtDirEnd(-m,Q.domFrag().oneElement());var be=Y.children().disown();A=new z(Q,be.getEnd(i),Q.getEnd(n)),m===n?be.adopt(Q,Q.getEnd(i),0):be.adopt(Q,0,Q.getEnd(n))}this.placeCursor=function(Ae,Ne){return function(Ce){Ce.insAtDirEnd(-m,Ae||Ne)}}(Q,Y)}}this.remove(),h&&h[n]===this&&(m===i&&A?A[n]?h.insRightOf(A[n]):h.insAtLeftEnd(A.parent):h.insRightOf(S));break}}},b.prototype.finalizeTree=function(){var h=this.getEnd(n);h.write=function(m,S){if(m.options.autoSubscriptNumerals&&this===this.parent.sub&&"0123456789".indexOf(S)>=0){var A=this.chToCmd(S,m.options);A instanceof X?m.deleteSelection():m.clearSelection().insRightOf(this.parent),A.createLeftOf(m.show()),m.controller.aria.queue("Baseline").alert(A.mathspeak({createdLeftOf:m}));return}m[n]&&!m[i]&&!m.selection&&m.options.charsThatBreakOutOfSupSub.indexOf(S)>-1&&(m.insRightOf(this.parent),m.controller.aria.queue("Baseline")),Je.prototype.write.call(this,m,S)}},b.prototype.moveTowards=function(h,m,S){m.options.autoSubscriptNumerals&&!this.sup?m.insDirOf(h,this):k.prototype.moveTowards.call(this,h,m,S)},b.prototype.deleteTowards=function(h,m){if(m.options.autoSubscriptNumerals&&this.sub){var S=this.sub.getEnd(-h);S instanceof X?S.remove():S&&S.deleteTowards(h,m.insAtDirEnd(-h,this.sub)),this.sub.isEmpty()&&(this.sub.deleteOutOf(n,m.insAtLeftEnd(this.sub)),this.sup&&m.insDirOf(-h,this))}else k.prototype.deleteTowards.call(this,h,m)},b.prototype.latexRecursive=function(h){if(this.checkCursorContextOpen(h),this.sub){h.latex+="_{";var m=h.latex.length;this.sub.latexRecursive(h);var S=h.latex.length;m===S&&(h.latex+=" "),h.latex+="}"}if(this.sup){h.latex+="^{";var m=h.latex.length;this.sup.latexRecursive(h);var S=h.latex.length;m===S&&(h.latex+=" "),h.latex+="}"}this.checkCursorContextClose(h)},b.prototype.text=function(){function h(m,S){var A=S&&S.text()||"";return S?m+(A.length===1?A:"("+(A||" ")+")"):""}return h("_",this.sub)+h("^",this.sup)},b.prototype.addBlock=function(h){this.supsub==="sub"?(this.sup=this.upInto=this.sub.upOutOf=h,h.adopt(this,this.sub,0).downOutOf=this.sub,h.setDOM(L(p("span",{class:"dcg-mq-sup"})).append(h.domFrag().children()).prependTo(this.domFrag().oneElement()).oneElement()),G.linkElementByBlockNode(h.domFrag().oneElement(),h)):(this.sub=this.downInto=this.sup.downOutOf=h,h.adopt(this,0,this.sup).upOutOf=this.sup,this.domFrag().removeClass("dcg-mq-sup-only"),h.setDOM(L(p("span",{class:"dcg-mq-sub"})).append(h.domFrag().children()).appendTo(this.domFrag().oneElement()).oneElement()),G.linkElementByBlockNode(h.domFrag().oneElement(),h),this.domFrag().append(L(p("span",{style:"display:inline-block;width:0"},[p.text(y)]))));for(var m=0;m<2;m+=1)(function(S,A,q,Y){var Q=S[A];Q.deleteOutOf=function(be,Ae){if(Ae.insDirOf(this[be]?-be:be,this.parent),!this.isEmpty()){var Ne=this.getEnd(be);this.children().disown().withDirAdopt(be,Ae.parent,Ae[be],Ae[-be]).domFrag().insDirOf(-be,Ae.domFrag()),Ae[-be]=Ne}S.supsub=q,delete S[A],delete S["".concat(Y,"Into")];var Ce=S[q];Ce["".concat(Y,"OutOf")]=co,delete Ce.deleteOutOf,A==="sub"&&S.domFrag().addClass("dcg-mq-sup-only").children().last().remove(),this.remove()}})(this,"sub sup".split(" ")[m],"sup sub".split(" ")[m],"down up".split(" ")[m])},b}(ue);function co(k){var b=this.parent,h=k;do{if(h[i])return k.insLeftOf(b);h=h.parent.parent}while(h!==b);k.insRightOf(b)}var za=function(k){t(b,k);function b(){var h=k!==null&&k.apply(this,arguments)||this;return h.supsub="sub",h.domView=new We(1,function(m){return p("span",{class:"dcg-mq-supsub dcg-mq-non-leaf"},[p.block("span",{class:"dcg-mq-sub"},m[0]),p("span",{style:"display:inline-block;width:0"},[p.text(y)])])}),h.textTemplate=["_"],h.mathspeakTemplate=["Subscript,",", Baseline"],h.ariaLabel="subscript",h}return b.prototype.finalizeTree=function(){this.downInto=this.sub=this.getEnd(n),this.sub.upOutOf=co,k.prototype.finalizeTree.call(this)},b}(Qr);D.subscript=D._=za,D.superscript=D.supscript=D["^"]=function(k){t(b,k);function b(){var h=k!==null&&k.apply(this,arguments)||this;return h.supsub="sup",h.domView=new We(1,function(m){return p("span",{class:"dcg-mq-supsub dcg-mq-non-leaf dcg-mq-sup-only"},[p.block("span",{class:"dcg-mq-sup"},m[0])])}),h.textTemplate=["^(",")"],h.ariaLabel="superscript",h.mathspeakTemplate=["Superscript,",", Baseline"],h}return b.prototype.mathspeak=function(h){var m=this.upInto;if(m!==void 0){var S=oo(m);if((!h||!h.ignoreShorthand)&&wi.test(S)){if(S==="0")return"to the 0 power";if(S==="2")return"squared";if(S==="3")return"cubed";var A="";/^[+-]?\d{1,3}$/.test(S)&&(/(11|12|13|4|5|6|7|8|9|0)$/.test(S)?A="th":/1$/.test(S)?A="st":/2$/.test(S)?A="nd":/3$/.test(S)&&(A="rd"));var q=typeof m=="object"?m.mathspeak():S;return"to the "+q+A+" power"}}return k.prototype.mathspeak.call(this)},b.prototype.finalizeTree=function(){this.upInto=this.sup=this.getEnd(i),this.sup.downOutOf=co,k.prototype.finalizeTree.call(this)},b}(Qr);var xn=function(k){t(b,k);function b(h,m,S){var A=k.call(this)||this;A.ariaLabel=S||h.replace(/^\\/,"");var q=new We(2,function(Y){return p("span",{class:"dcg-mq-large-operator dcg-mq-non-leaf"},[p("span",{class:"dcg-mq-to"},[p.block("span",{},Y[1])]),p("big",{},[p.text(m)]),p("span",{class:"dcg-mq-from"},[p.block("span",{},Y[0])])])});return X.prototype.setCtrlSeqHtmlTextAndMathspeak.call(A,h,q),A}return b.prototype.createLeftOf=function(h){k.prototype.createLeftOf.call(this,h),h.options.sumStartsWithNEquals&&(new Bt("n").createLeftOf(h),new ba().createLeftOf(h))},b.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h),h.latex+=this.ctrlSeq+"_{";var m=h.latex.length;this.getEnd(n).latexRecursive(h);var S=h.latex.length;S===m&&(h.latex+=" "),h.latex+="}^{",m=h.latex.length,this.getEnd(i).latexRecursive(h),S=h.latex.length,m===S&&(h.latex+=" "),h.latex+="}",this.checkCursorContextClose(h)},b.prototype.mathspeak=function(){return"Start "+this.ariaLabel+" from "+this.getEnd(n).mathspeak()+" to "+this.getEnd(i).mathspeak()+", end "+this.ariaLabel+", "},b.prototype.parser=function(){for(var h=Ve.string,m=Ve.optWhitespace,S=Ve.succeed,A=ae.block,q=this,Y=q.blocks=[new Je,new Je],Q=0;Q<Y.length;Q+=1)Y[Q].adopt(q,q.getEnd(i),0);return m.then(h("_").or(h("^"))).then(function(be){var Ae=Y[be==="_"?0:1];return A.then(function(Ne){return Ne.children().adopt(Ae,Ae.getEnd(i),0),S(q)})}).many().result(q)},b.prototype.finalizeTree=function(){var h=this.getEnd(n),m=this.getEnd(i);h.ariaLabel="lower bound",m.ariaLabel="upper bound",this.downInto=h,this.upInto=m,h.upOutOf=m,m.downOutOf=h},b}(ue);D["∑"]=D.sum=D.summation=function(){return new xn("\\sum ",_,"sum")},D["∏"]=D.prod=D.product=function(){return new xn("\\prod ",w,"product")},D.coprod=D.coproduct=function(){return new xn("\\coprod ",v,"co product")},D["∫"]=D.int=D.integral=function(k){t(b,k);function b(){var h=k.call(this,"\\int ","","integral")||this;return h.ariaLabel="integral",h.domView=new We(2,function(m){return p("span",{class:"dcg-mq-int dcg-mq-non-leaf"},[p("big",{},[p.text(T)]),p("span",{class:"dcg-mq-supsub dcg-mq-non-leaf"},[p("span",{class:"dcg-mq-sup"},[p.block("span",{class:"dcg-mq-sup-inner"},m[1])]),p.block("span",{class:"dcg-mq-sub"},m[0]),p("span",{style:"display:inline-block;width:0"},[p.text(y)])])])}),h}return b.prototype.createLeftOf=function(h){ue.prototype.createLeftOf.call(this,h)},b}(xn);var Ba=D.frac=D.dfrac=D.cfrac=D.fraction=function(k){t(b,k);function b(){var h=k!==null&&k.apply(this,arguments)||this;return h.ctrlSeq="\\frac",h.domView=new We(2,function(m){return p("span",{class:"dcg-mq-fraction dcg-mq-non-leaf"},[p.block("span",{class:"dcg-mq-numerator"},m[0]),p.block("span",{class:"dcg-mq-denominator"},m[1]),p("span",{style:"display:inline-block;width:0"},[p.text(y)])])}),h.textTemplate=["(",")/(",")"],h}return b.prototype.finalizeTree=function(){var h=this.getEnd(n),m=this.getEnd(i);this.upInto=m.upOutOf=h,this.downInto=h.downOutOf=m,h.ariaLabel="numerator",m.ariaLabel="denominator",this.getFracDepth()>1?this.mathspeakTemplate=["StartNestedFraction,","NestedOver",", EndNestedFraction"]:this.mathspeakTemplate=["StartFraction,","Over",", EndFraction"]},b.prototype.mathspeak=function(h){if(h&&h.createdLeftOf){var m=h.createdLeftOf;return m.parent.mathspeak()}var S=oo(this.getEnd(n)),A=oo(this.getEnd(i));if((!h||!h.ignoreShorthand)&&wi.test(S)&&wi.test(A)){var q=S==="1"||S==="-1",Y="";if(A==="2"?Y=q?"half":"halves":A==="3"?Y=q?"third":"thirds":A==="4"?Y=q?"quarter":"quarters":A==="5"?Y=q?"fifth":"fifths":A==="6"?Y=q?"sixth":"sixths":A==="7"?Y=q?"seventh":"sevenths":A==="8"?Y=q?"eighth":"eighths":A==="9"&&(Y=q?"ninth":"ninths"),Y!==""){for(var Q="",be=!1,Ae=this[n];Ae&&Ae[n]!==void 0;Ae=Ae[n])if(Ae.ctrlSeq!=="\\ ")if(wi.test(Ae.ctrlSeq||""))be=!0;else{be=!1;break}return be&&(Q+="and "),Q+=this.getEnd(n).mathspeak()+" "+Y,Q}}return k.prototype.mathspeak.call(this)},b.prototype.getFracDepth=function(){var h=0,m=function(S,A){return S instanceof me&&S.ctrlSeq&&S.ctrlSeq.toLowerCase().search("frac")>=0&&(A+=1),S&&S.parent?m(S.parent,A):A};return m(this,h)},b}(ue),sc=D.over=de["/"]=function(k){t(b,k);function b(){return k!==null&&k.apply(this,arguments)||this}return b.prototype.createLeftOf=function(h){if(!this.replacedFragment){var m=h[n],S=h.options.typingSlashCreatesNewFraction&&this instanceof Ba;if(!S)for(;m&&!(nn(m)||m instanceof dt&&m._groupingClass==="dcg-mq-ellipsis-end"||m instanceof(D.text||s)||m instanceof xn||m.ctrlSeq==="\\ "||/^[,;:]$/.test(m.ctrlSeq));)m=m[n];if(m instanceof xn&&m[i]instanceof Qr){m=m[i];var A=m[i];A instanceof Qr&&A.ctrlSeq!=m.ctrlSeq&&(m=m[i])}if(m!==h[n]&&!h.isTooDeep(1)){var A=m[i],q=h[n];this.replaces(new U(A||h.parent.getEnd(n),q)),h[n]=m}}k.prototype.createLeftOf.call(this,h)},b}(Ba),Ua=function(){return new X("\\operatorname{ans}",p("span",{class:"dcg-mq-ans"},[p.text("ans")]),"ans")};D.ans=Ua;var Xa=function(){return new X("\\%\\operatorname{of}",p("span",{class:"dcg-mq-nonSymbola dcg-mq-operator-name"},[p.text("% of ")]),"percent of")};D.percent=D.percentof=Xa;var lc=function(k){t(b,k);function b(){var h=k!==null&&k.apply(this,arguments)||this;return h.tokenId="",h.ctrlSeq="\\token",h.textTemplate=["token(",")"],h.mathspeakTemplate=["StartToken,",", EndToken"],h.ariaLabel="token",h}return b.prototype.html=function(){var h=p("span",{class:"dcg-mq-token dcg-mq-ignore-mousedown","data-dcg-mq-token":this.tokenId});return this.setDOM(h),G.linkElementByCmdNode(h,this),h},b.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h),h.latex+="\\token{"+this.tokenId+"}",this.checkCursorContextClose(h)},b.prototype.mathspeak=function(){var h=[];return this.domFrag().children().eachElement(function(m){var S=m.getAttribute("aria-label");typeof S=="string"&&S!==""&&h.push(S)}),h.length>0?h.join(" ").trim():"token "+this.tokenId},b.prototype.parser=function(){var h=this;return ae.block.map(function(m){var S=m.getEnd(n);if(S)for(h.tokenId+=S.ctrlSeq;S=S[i];)h.tokenId+=S.ctrlSeq;return h})},b}(X);D.token=lc;var Za=function(k){t(b,k);function b(){var h=k!==null&&k.apply(this,arguments)||this;return h.ctrlSeq="\\sqrt",h.domView=new We(1,function(m){return p("span",{class:"dcg-mq-non-leaf dcg-mq-sqrt-container"},[p("span",{class:"dcg-mq-scaled dcg-mq-sqrt-prefix"},[li.sqrt.html()]),p.block("span",{class:"dcg-mq-non-leaf dcg-mq-sqrt-stem"},m[0])])}),h.textTemplate=["sqrt(",")"],h.mathspeakTemplate=["StartRoot,",", EndRoot"],h.ariaLabel="root",h}return b.prototype.parser=function(){return ae.optBlock.then(function(h){return ae.block.map(function(m){var S=new uo;return S.blocks=[h,m],h.adopt(S,0,0),m.adopt(S,h,0),S})}).or(k.prototype.parser.call(this))},b.prototype.deleteTowards=function(h,m){if(!this.isEmpty()&&h===1){this.moveTowards(i,m),m.parent.deleteOutOf(n,m);return}k.prototype.deleteTowards.call(this,h,m)},b}(ue);D.sqrt=Za,D.hat=function(k){t(b,k);function b(){var h=k!==null&&k.apply(this,arguments)||this;return h.ctrlSeq="\\hat",h.domView=new We(1,function(m){return p("span",{class:"dcg-mq-non-leaf"},[p("span",{class:"dcg-mq-hat-prefix"},[p.text("^")]),p.block("span",{class:"dcg-mq-hat-stem"},m[0])])}),h.textTemplate=["hat(",")"],h}return b}(ue);var uo=function(k){t(b,k);function b(){var h=k!==null&&k.apply(this,arguments)||this;return h.domView=new We(2,function(m){return p("span",{class:"dcg-mq-nthroot-container dcg-mq-non-leaf"},[p.block("sup",{class:"dcg-mq-nthroot dcg-mq-non-leaf"},m[0]),p("span",{class:"dcg-mq-scaled dcg-mq-sqrt-container"},[p("span",{class:"dcg-mq-sqrt-prefix dcg-mq-scaled"},[li.sqrt.html()]),p.block("span",{class:"dcg-mq-sqrt-stem dcg-mq-non-leaf"},m[1])])])}),h.textTemplate=["sqrt[","](",")"],h}return b.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h),h.latex+="\\sqrt[",this.getEnd(n).latexRecursive(h),h.latex+="]{",this.getEnd(i).latexRecursive(h),h.latex+="}",this.checkCursorContextClose(h)},b.prototype.mathspeak=function(){var h=this.getEnd(n).mathspeak(),m=this.getEnd(i).mathspeak();return this.getEnd(n).ariaLabel="Index",this.getEnd(i).ariaLabel="Radicand",h==="3"?"Start Cube Root, "+m+", End Cube Root":"Root Index "+h+", Start Root, "+m+", End Root"},b.prototype.deleteTowards=function(h,m){ue.prototype.deleteTowards.call(this,h,m)},b}(Za);D.nthroot=uo,D.cbrt=function(k){t(b,k);function b(){return k!==null&&k.apply(this,arguments)||this}return b.prototype.createLeftOf=function(h){k.prototype.createLeftOf.call(this,h),new ft("3").createLeftOf(h),h.controller.moveRight()},b}(uo);var ts=function(k){t(b,k);function b(h,m,S){var A=new We(1,function(q){return p("span",{class:"dcg-mq-non-leaf"},[p("span",{class:"dcg-mq-diacritic-above"},[m]),p.block("span",{class:"dcg-mq-diacritic-stem"},q[0])])});return k.call(this,h,A,S)||this}return b}(ue);D.vec=function(){return new ts("\\vec",p.entityText("&rarr;"),["vec(",")"])},D.tilde=function(){return new ts("\\tilde",p.text("~"),["tilde(",")"])};var ys=function(k){t(b,k);function b(){return k!==null&&k.apply(this,arguments)||this}return b.prototype.setDOM=function(h){var m;k.prototype.setDOM.call(this,h);var S=this.domFrag().children();return S.isEmpty()||(this.delimFrags=(m={},m[n]=S.first(),m[i]=S.last(),m)),this},b}(ue),Hr=function(k){t(b,k);function b(h,m,S,A,q){var Y,Q=k.call(this,"\\left"+A,void 0,[m,S])||this;return Q.side=h,Q.sides=(Y={},Y[n]={ch:m,ctrlSeq:A},Y[i]={ch:S,ctrlSeq:q},Y),Q}return b.prototype.numBlocks=function(){return 1},b.prototype.html=function(){var h=this,m=this.getSymbol(n),S=this.getSymbol(i);return this.domView=new We(1,function(A){return p("span",{class:"dcg-mq-non-leaf dcg-mq-bracket-container"},[p("span",{style:"width:"+m.width,class:"dcg-mq-scaled dcg-mq-bracket-l dcg-mq-paren"+(h.side===i?" dcg-mq-ghost":"")},[m.html()]),p.block("span",{style:"margin-left:"+m.width+";margin-right:"+S.width,class:"dcg-mq-bracket-middle dcg-mq-non-leaf"},A[0]),p("span",{style:"width:"+S.width,class:"dcg-mq-scaled dcg-mq-bracket-r dcg-mq-paren"+(h.side===n?" dcg-mq-ghost":"")},[S.html()])])}),k.prototype.html.call(this)},b.prototype.getSymbol=function(h){var m=this.sides[h||i].ch;return li[m]||{width:"0",html:""}},b.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h),h.latex+="\\left"+this.sides[n].ctrlSeq,this.getEnd(n).latexRecursive(h),h.latex+="\\right"+this.sides[i].ctrlSeq,this.checkCursorContextClose(h)},b.prototype.mathspeak=function(h){var m=this.sides[n].ch,S=this.sides[i].ch;if(m==="|"&&S==="|")this.mathspeakTemplate=["StartAbsoluteValue,",", EndAbsoluteValue"],this.ariaLabel="absolute value";else if(h&&h.createdLeftOf&&this.side){var A="";return this.side===n?A=this.textTemplate[0]:this.side===i&&(A=this.textTemplate[1]),(this.side===n?"left ":"right ")+zn[A]}else this.mathspeakTemplate=["left "+zn[m]+",",", right "+zn[S]],this.ariaLabel=zn[m]+" block";return k.prototype.mathspeak.call(this)},b.prototype.matchBrack=function(h,m,S){return S instanceof b&&S.side&&S.side!==-m&&(!h.restrictMismatchedBrackets||ci[this.sides[this.side].ch]===S.sides[S.side].ch||h.restrictMismatchedBrackets!=="none"&&{"(":"]","[":")"}[this.sides[n].ch]===S.sides[i].ch)&&S},b.prototype.closeOpposing=function(h){h.side=0,h.sides[this.side]=this.sides[this.side];var m=h.delimFrags[this.side===n?n:i].removeClass("dcg-mq-ghost");this.replaceBracket(m,this.side)},b.prototype.createLeftOf=function(h){var m;if(!this.replacedFragment){var S=h.options;this.sides[n].ch==="|"?m=this.matchBrack(S,i,h[i])||this.matchBrack(S,n,h[n])||this.matchBrack(S,0,h.parent.parent):m=this.matchBrack(S,-this.side,h[-this.side])||this.matchBrack(S,-this.side,h.parent.parent)}if(m){var A=this.side=-m.side;this.closeOpposing(m),m===h.parent.parent&&h[A]&&new U(h[A],h.parent.getEnd(A),-A).disown().withDirAdopt(-A,m.parent,m,m[A]).domFrag().insDirOf(A,m.domFrag()),m.bubble(function(q){q.reflow()})}else m=this,A=m.side,m.replacedFragment?m.side=0:h[-A]&&(m.replaces(new U(h[-A],h.parent.getEnd(-A),A)),h[-A]=0),k.prototype.createLeftOf.call(this,h);A===n?h.insAtLeftEnd(m.getEnd(n)):h.insRightOf(m)},b.prototype.placeCursor=function(){},b.prototype.unwrap=function(){this.getEnd(n).children().disown().adopt(this.parent,this,this[i]).domFrag().insertAfter(this.domFrag()),this.remove()},b.prototype.deleteSide=function(h,m,S){var A=this.parent,q=this[h],Y=A.getEnd(h);if(h===this.side){this.unwrap(),q?S.insDirOf(-h,q):S.insAtDirEnd(h,A);return}var Q=S.options,be=!this.side;if(this.side=-h,this.matchBrack(Q,h,this.getEnd(n).getEnd(this.side))){this.closeOpposing(this.getEnd(n).getEnd(this.side));var Ae=this.getEnd(n).getEnd(h);this.unwrap(),Ae&&Ae.siblingCreated(S.options,h),q?S.insDirOf(-h,q):S.insAtDirEnd(h,A)}else{if(this.matchBrack(Q,h,this.parent.parent))this.parent.parent.closeOpposing(this),this.parent.parent.unwrap();else if(m&&be){this.unwrap(),q?S.insDirOf(-h,q):S.insAtDirEnd(h,A);return}else{this.sides[h]=cc(this),this.delimFrags[n].removeClass("dcg-mq-ghost"),this.delimFrags[i].removeClass("dcg-mq-ghost");var Ne=this.delimFrags[h].addClass("dcg-mq-ghost");this.replaceBracket(Ne,h)}if(q){var Ce=this.getEnd(n),Ae=Ce.getEnd(h);Ce.domFrag().removeClass("dcg-mq-empty"),new U(q,Y,-h).disown().withDirAdopt(-h,Ce,Ae,0).domFrag().insAtDirEnd(h,Ce.domFrag().oneElement()),Ae&&Ae.siblingCreated(S.options,h),S.insDirOf(-h,q)}else m?S.insDirOf(h,this):S.insAtDirEnd(h,this.getEnd(n))}},b.prototype.replaceBracket=function(h,m){var S=this.getSymbol(m);if(h.children().replaceWith(L(S.html())),h.oneElement().style.width=S.width,m===n){var A=h.next();A.isEmpty()||(A.oneElement().style.marginLeft=S.width)}else{var q=h.prev();q.isEmpty()||(q.oneElement().style.marginRight=S.width)}},b.prototype.deleteTowards=function(h,m){this.deleteSide(-h,!1,m)},b.prototype.finalizeTree=function(){this.getEnd(n).deleteOutOf=function(h,m){this.parent.deleteSide(h,!0,m)},this.finalizeTree=this.intentionalBlur=function(){this.delimFrags[this.side===n?i:n].removeClass("dcg-mq-ghost"),this.side=0}},b.prototype.siblingCreated=function(h,m){m===-this.side&&this.finalizeTree()},b}(ys);function cc(k){var b=k.side,h=k.sides[b];return{ch:ci[h.ch],ctrlSeq:ci[h.ctrlSeq]}}var ci={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{","\\{":"\\}","\\}":"\\{","&lang;":"&rang;","&rang;":"&lang;","\\langle ":"\\rangle ","\\rangle ":"\\langle ","|":"|","\\lVert ":"\\rVert ","\\rVert ":"\\lVert "},zn={"&lang;":"angle-bracket","&rang;":"angle-bracket","|":"pipe"};function po(k,m,h){var m=m||k,S=ci[k],A=ci[m];de[k]=function(){return new Hr(n,k,S,m,A)},de[S]=function(){return new Hr(i,k,S,m,A)},zn[k]=zn[S]=h}po("(","","parenthesis"),po("[","","bracket"),po("{","\\{","brace"),D.langle=function(){return new Hr(n,"&lang;","&rang;","\\langle ","\\rangle ")},D.rangle=function(){return new Hr(i,"&lang;","&rang;","\\langle ","\\rangle ")},de["|"]=function(){return new Hr(n,"|","|","|","|")},D.lVert=function(){return new Hr(n,"&#8741;","&#8741;","\\lVert ","\\rVert ")},D.rVert=function(){return new Hr(i,"&#8741;","&#8741;","\\lVert ","\\rVert ")},D.left=function(k){t(b,k);function b(){return k!==null&&k.apply(this,arguments)||this}return b.prototype.parser=function(){var h=Ve.regex,m=Ve.string,S=Ve.optWhitespace;return S.then(h(/^(?:[([|]|\\\{|\\langle(?![a-zA-Z])|\\lVert(?![a-zA-Z]))/)).then(function(A){var q=A.replace(/^\\/,"");return A=="\\langle"&&(q="&lang;",A=A+" "),A=="\\lVert"&&(q="&#8741;",A=A+" "),ae.then(function(Y){return m("\\right").skip(S).then(h(/^(?:[\])|]|\\\}|\\rangle(?![a-zA-Z])|\\rVert(?![a-zA-Z]))/)).map(function(Q){var be=Q.replace(/^\\/,"");Q=="\\rangle"&&(be="&rang;",Q=Q+" "),Q=="\\rVert"&&(be="&#8741;",Q=Q+" ");var Ae=new Hr(0,q,be,A,Q);return Ae.blocks=[Y],Y.adopt(Ae,0,0),Ae})})})},b}(ue),D.right=function(k){t(b,k);function b(){return k!==null&&k.apply(this,arguments)||this}return b.prototype.parser=function(){return Ve.fail("unmatched \\right")},b}(ue);var wo=li["("],Io=li[")"],xs=function(k){t(b,k);function b(){var h=k!==null&&k.apply(this,arguments)||this;return h.ctrlSeq="\\binom",h.domView=new We(2,function(m){return p("span",{class:"dcg-mq-non-leaf dcg-mq-bracket-container"},[p("span",{style:"width:"+wo.width,class:"dcg-mq-paren dcg-mq-bracket-l dcg-mq-scaled"},[wo.html()]),p("span",{style:"margin-left:"+wo.width+"; margin-right:"+Io.width,class:"dcg-mq-non-leaf dcg-mq-bracket-middle"},[p("span",{class:"dcg-mq-array dcg-mq-non-leaf"},[p.block("span",{},m[0]),p.block("span",{},m[1])])]),p("span",{style:"width:"+Io.width,class:"dcg-mq-paren dcg-mq-bracket-r dcg-mq-scaled"},[Io.html()])])}),h.textTemplate=["choose(",",",")"],h.mathspeakTemplate=["StartBinomial,","Choose",", EndBinomial"],h.ariaLabel="binomial",h}return b.prototype.finalizeTree=function(){var h=this.getEnd(n),m=this.getEnd(i);this.upInto=m.upOutOf=h,this.downInto=h.downOutOf=m,h.ariaLabel="upper index",m.ariaLabel="lower index"},b}(ys);D.binom=D.binomial=xs,D.choose=function(k){t(b,k);function b(){return k!==null&&k.apply(this,arguments)||this}return b.prototype.createLeftOf=function(h){sc.prototype.createLeftOf.call(this,h)},b}(xs);var yc=function(k){t(b,k);function b(){var h=k!==null&&k.apply(this,arguments)||this;return h.ctrlSeq="\\MathQuillMathField",h.domView=new We(1,function(m){return p("span",{class:"dcg-mq-editable-field"},[p.block("span",{class:"dcg-mq-root-block","aria-hidden":"true"},m[0])])}),h}return b.prototype.parser=function(){var h=this,m=Ve.string,S=Ve.regex,A=Ve.succeed;return m("[").then(S(/^[a-z][a-z0-9]*/i)).skip(m("]")).map(function(q){h.name=q}).or(A(void 0)).then(k.prototype.parser.call(this))},b.prototype.finalizeTree=function(h){var m=new Vt(this.getEnd(n),this.domFrag().oneElement(),h);m.KIND_OF_MQ="MathField",m.editable=!0,m.createTextarea(),m.editablesTextareaEvents(),m.cursor.insAtRightEnd(m.root),qe(m.root);function S(A){if(A.parentNode&&!L(A).hasClass("dcg-mq-root-block")&&S(A.parentNode),A.nodeType===Node.ELEMENT_NODE){var q=A;q.getAttribute("aria-hidden")==="true"&&(q.removeAttribute("aria-hidden"),L(A).children().eachElement(function(Y){Y.setAttribute("aria-hidden","true")}))}}S(this.domFrag().parent().oneElement()),this.domFrag().oneElement().removeAttribute("aria-hidden")},b.prototype.registerInnerField=function(h,m){var S=this.getEnd(n).controller,A=new m(S);h[this.name]=A,h.push(A)},b.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h),this.getEnd(n).latexRecursive(h),this.checkCursorContextClose(h)},b.prototype.text=function(){return this.getEnd(n).text()},b}(ue);D.editable=D.MathQuillMathField=yc;var vs=function(k){t(b,k);function b(){return k!==null&&k.apply(this,arguments)||this}return b.prototype.setOptions=function(h){function m(){return""}return this.text=h.text||m,this.domView=new We(0,function(){return p("span",{},[u(h.htmlString||"")])}),this.latex=h.latex||m,this},b.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h),h.latex+=this.latex(),this.checkCursorContextClose(h)},b.prototype.parser=function(){var h=this,m=Ve.string,S=Ve.regex,A=Ve.succeed;return m("{").then(S(/^[a-z][a-z0-9]*/i)).skip(m("}")).then(function(q){return m("[").then(S(/^[-\w\s]*/)).skip(m("]")).or(A(void 0)).map(function(Y){return h.setOptions(Re[q](Y))})})},b}(X);if(D.embed=vs,window.jQuery){J=Te(1);for(var ws in J)(function(k,b){typeof b=="function"?(j[k]=function(){return Be(),b.apply(this,arguments)},j[k].prototype=b.prototype):j[k]=b})(ws,J[ws])}})()}),sK=__dcg_shared_module_exports__.c((e,t)=>{t.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}}),cK=__dcg_shared_module_exports__.c((e,t)=>{var r=/([\w-]+)|=|(['"])([.\s\S]*?)\2/g,n=sK();t.exports=function(i){var o=0,a,s=!0,l={type:"tag",name:"",voidElement:!1,attrs:{},children:[]};return i.replace(r,function(c){if(c==="="){s=!0,o++;return}s?o===0?((n[c]||i.charAt(i.length-2)==="/")&&(l.voidElement=!0),l.name=c):(l.attrs[a]=c.replace(/^['"]|['"]$/g,""),a=void 0):(a&&(l.attrs[a]=a),a=c),o++,s=!1}),l}}),pK=__dcg_shared_module_exports__.c((e,t)=>{var r=/(?:<!--[\S\s]*?-->|<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>)/g,n=cK(),i=Object.create?Object.create(null):{};function o(a,s,l,c,d){var u=s.indexOf("<",c),p=s.slice(c,u===-1?void 0:u);/^\s*$/.test(p)&&(p=" "),(!d&&u>-1&&l+a.length>=0||p!==" ")&&a.push({type:"text",content:p})}t.exports=function(a,s){s||(s={}),s.components||(s.components=i);var l=[],c,d=-1,u=[],p={},g=!1;return a.replace(r,function(f,y){if(g){if(f!=="</"+c.name+">")return;g=!1}var E=f.charAt(1)!=="/",_=f.indexOf("<!--")===0,w=y+f.length,v=a.charAt(w),T;E&&!_&&(d++,c=n(f),c.type==="tag"&&s.components[c.name]&&(c.type="component",g=!0),!c.voidElement&&!g&&v&&v!=="<"&&o(c.children,a,d,w,s.ignoreWhitespace),p[c.tagName]=c,d===0&&l.push(c),T=u[d-1],T&&T.children.push(c),u[d]=c),(_||!E||c.voidElement)&&(_||d--,!g&&v!=="<"&&v&&(T=d===-1?l:u[d].children,o(T,a,d,w,s.ignoreWhitespace)))}),!l.length&&a.length&&o(l,a,0,0,s.ignoreWhitespace),l}}),gK=__dcg_shared_module_exports__.c((e,t)=>{function r(i){var o=[];for(var a in i)o.push(a+'="'+i[a]+'"');return o.length?" "+o.join(" "):""}function n(i,o){switch(o.type){case"text":return i+o.content;case"tag":return i+="<"+o.name+(o.attrs?r(o.attrs):"")+(o.voidElement?"/>":">"),o.voidElement?i:i+o.children.reduce(n,"")+"</"+o.name+">"}}t.exports=function(i){return i.reduce(function(o,a){return o+n("",a)},"")}}),fK=__dcg_shared_module_exports__.c((e,t)=>{t.exports={parse:pK(),stringify:gK()}}),td={};__dcg_shared_module_exports__.d(td,{UnicodeBraille:()=>sa,latexToNemeth:()=>lp,latexToUeb:()=>cp,nemethToLatex:()=>fM,uebToLatex:()=>bM,version:()=>GX});var T3=Object.defineProperty,Hj=Object.getOwnPropertyNames,p3=Object.getOwnPropertySymbols,Kj=Object.prototype.hasOwnProperty,Wj=Object.prototype.propertyIsEnumerable,u3=(e,t,r)=>t in e?T3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Jm=(e,t)=>{for(var r in t||(t={}))Kj.call(t,r)&&u3(e,r,t[r]);if(p3)for(var r of p3(t))Wj.call(t,r)&&u3(e,r,t[r]);return e},Qm=(e=>typeof __dcg_shared_module_exports__.a!="undefined"?__dcg_shared_module_exports__.a:typeof Proxy!="undefined"?new Proxy(e,{get:(t,r)=>(typeof __dcg_shared_module_exports__.a!="undefined"?__dcg_shared_module_exports__.a:t)[r]}):e)(function(e){if(typeof __dcg_shared_module_exports__.a!="undefined")return __dcg_shared_module_exports__.a.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),nM=(e,t)=>function(){return t||(0,e[Hj(e)[0]])((t={exports:{}}).exports,t),t.exports},aM=(e,t)=>{for(var r in t)T3(e,r,{get:t[r],enumerable:!0})},$j=nM({"generated/latex.jison.js"(e,t){var r=function(){var n=function(N,O,z,V){for(z=z||{},V=N.length;V--;z[N[V]]=O);return z},i=[1,13],o=[1,14],a=[1,15],s=[1,16],l=[1,17],c=[1,21],d=[1,18],u=[1,19],p=[1,20],g=[1,22],f=[1,23],y=[1,28],E=[1,30],_=[1,31],w=[1,32],v=[1,33],T=[1,29],M=[5,21,27,38],C=[5,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],P=[5,10,12,13,14,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],F=[5,10,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],B={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,level:6,expression:7,subscript:8,superscript:9,_:10,atom:11,"^":12,"PRIMES^":13,PRIMES:14,delimited_group:15,typeform:16,frac:17,radical:18,LEFT:19,delimiter:20,RIGHT:21,FRAC:22,OPERATOR_NAME:23,MATHRM:24,TEXT:25,RADICAL_OPTARG:26,CLOSE_OPTARG:27,RADICAL:28,curly_group:29,greek:30,command:31,SYMBOL:32,DELIMITER:33,DELIMITER_COMMAND:34,GREEK:35,COMMAND:36,"{":37,"}":38,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",10:"_",12:"^",13:"PRIMES^",14:"PRIMES",19:"LEFT",21:"RIGHT",22:"FRAC",23:"OPERATOR_NAME",24:"MATHRM",25:"TEXT",26:"RADICAL_OPTARG",27:"CLOSE_OPTARG",28:"RADICAL",32:"SYMBOL",33:"DELIMITER",34:"DELIMITER_COMMAND",35:"GREEK",36:"COMMAND",37:"{",38:"}"},productions_:[0,[3,2],[3,1],[4,3],[4,2],[4,1],[4,2],[4,1],[6,2],[6,2],[6,1],[6,1],[8,2],[9,2],[9,2],[9,1],[7,1],[7,1],[7,1],[7,1],[7,1],[15,5],[15,4],[17,3],[16,2],[16,2],[16,2],[18,4],[18,3],[18,2],[18,2],[11,1],[11,1],[11,1],[11,1],[11,1],[20,1],[20,1],[30,1],[31,1],[29,3],[29,2]],performAction:function(N,O,z,V,$,G,W){var U=G.length-1;switch($){case 1:return G[U-1];case 2:return V.group();case 3:this.$=V.group(G[U-2],G[U-1],G[U]);break;case 4:case 6:this.$=V.group(G[U-1],G[U]);break;case 5:case 7:this.$=V.group(G[U]);break;case 8:this.$=V.level({_:V.group(G[U-1]),"^":V.group(G[U])});break;case 9:this.$=V.level({_:V.group(G[U]),"^":V.group(G[U-1])});break;case 10:this.$=V.level({"^":V.group(G[U])});break;case 11:this.$=V.level({_:V.group(G[U])});break;case 12:case 13:this.$=G[U];break;case 14:this.$=V.processPrimes(G[U-1],G[U]);break;case 15:this.$=V.processPrimes(G[U],V.group());break;case 21:this.$=V.group(G[U-3],G[U-2],G[U]);break;case 22:this.$=V.group(G[U-2],G[U]);break;case 23:this.$=V.fraction(V.group(G[U-1]),V.group(G[U]));break;case 24:this.$=V.typeform("operator_name",V.group(G[U]));break;case 25:this.$=V.typeform("mathrm",V.group(G[U]));break;case 26:this.$=V.typeform("text",V.group(G[U]));break;case 27:this.$=V.radical(G[U],V.group(G[U-2]));break;case 28:this.$=V.radical(V.group(G[U]),V.group());break;case 29:case 30:this.$=V.radical(V.group(G[U]));break;case 35:case 36:this.$=V.terminal(G[U]);break;case 37:case 39:this.$=V.command(G[U]);break;case 38:this.$=V.greek(G[U]);break;case 40:this.$=G[U-1];break;case 41:this.$=V.group();break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:6,9:7,10:i,11:12,12:o,13:a,14:s,15:8,16:9,17:10,18:11,19:l,20:25,22:c,23:d,24:u,25:p,26:g,28:f,29:24,30:26,31:27,32:y,33:E,34:_,35:w,36:v,37:T},{1:[3]},{5:[1,34]},{1:[2,2]},n(M,[2,5],{15:8,16:9,17:10,18:11,11:12,29:24,20:25,30:26,31:27,7:35,19:l,22:c,23:d,24:u,25:p,26:g,28:f,32:y,33:E,34:_,35:w,36:v,37:T}),n(M,[2,7],{6:4,7:5,8:6,9:7,15:8,16:9,17:10,18:11,11:12,29:24,20:25,30:26,31:27,4:36,10:i,12:o,13:a,14:s,19:l,22:c,23:d,24:u,25:p,26:g,28:f,32:y,33:E,34:_,35:w,36:v,37:T}),n(C,[2,11],{9:37,12:o,13:a,14:s}),n(C,[2,10],{8:38,10:i}),n(P,[2,16]),n(P,[2,17]),n(P,[2,18]),n(P,[2,19]),n(P,[2,20]),{11:39,20:25,29:24,30:26,31:27,32:y,33:E,34:_,35:w,36:v,37:T},{11:40,20:25,29:24,30:26,31:27,32:y,33:E,34:_,35:w,36:v,37:T},{11:41,20:25,29:24,30:26,31:27,32:y,33:E,34:_,35:w,36:v,37:T},n(F,[2,15]),{20:42,33:E,34:_},{11:43,20:25,29:24,30:26,31:27,32:y,33:E,34:_,35:w,36:v,37:T},{11:44,20:25,29:24,30:26,31:27,32:y,33:E,34:_,35:w,36:v,37:T},{11:45,20:25,29:24,30:26,31:27,32:y,33:E,34:_,35:w,36:v,37:T},{11:46,20:25,29:24,30:26,31:27,32:y,33:E,34:_,35:w,36:v,37:T},{4:47,6:4,7:5,8:6,9:7,10:i,11:12,12:o,13:a,14:s,15:8,16:9,17:10,18:11,19:l,20:25,22:c,23:d,24:u,25:p,26:g,27:[1,48],28:f,29:24,30:26,31:27,32:y,33:E,34:_,35:w,36:v,37:T},{11:49,17:50,20:25,22:c,29:24,30:26,31:27,32:y,33:E,34:_,35:w,36:v,37:T},n(P,[2,31]),n(P,[2,32]),n(P,[2,33]),n(P,[2,34]),n(P,[2,35]),{4:51,6:4,7:5,8:6,9:7,10:i,11:12,12:o,13:a,14:s,15:8,16:9,17:10,18:11,19:l,20:25,22:c,23:d,24:u,25:p,26:g,28:f,29:24,30:26,31:27,32:y,33:E,34:_,35:w,36:v,37:T,38:[1,52]},n(P,[2,36]),n(P,[2,37]),n(P,[2,38]),n(P,[2,39]),{1:[2,1]},n(M,[2,4],{6:4,7:5,8:6,9:7,15:8,16:9,17:10,18:11,11:12,29:24,20:25,30:26,31:27,4:53,10:i,12:o,13:a,14:s,19:l,22:c,23:d,24:u,25:p,26:g,28:f,32:y,33:E,34:_,35:w,36:v,37:T}),n(M,[2,6]),n(C,[2,8]),n(C,[2,9]),n([5,12,13,14,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],[2,12]),n(F,[2,13]),n(F,[2,14]),{4:54,6:4,7:5,8:6,9:7,10:i,11:12,12:o,13:a,14:s,15:8,16:9,17:10,18:11,19:l,20:25,21:[1,55],22:c,23:d,24:u,25:p,26:g,28:f,29:24,30:26,31:27,32:y,33:E,34:_,35:w,36:v,37:T},n(P,[2,24]),n(P,[2,25]),n(P,[2,26]),{11:56,20:25,29:24,30:26,31:27,32:y,33:E,34:_,35:w,36:v,37:T},{27:[1,57]},{11:58,20:25,29:24,30:26,31:27,32:y,33:E,34:_,35:w,36:v,37:T},n(P,[2,29]),n(P,[2,30]),{38:[1,59]},n(P,[2,41]),n(M,[2,3]),{21:[1,60]},{20:61,33:E,34:_},n(P,[2,23]),{11:62,20:25,29:24,30:26,31:27,32:y,33:E,34:_,35:w,36:v,37:T},n(P,[2,28]),n(P,[2,40]),{20:63,33:E,34:_},n(P,[2,22]),n(P,[2,27]),n(P,[2,21])],defaultActions:{3:[2,2],34:[2,1]},parseError:function(N,O){if(O.recoverable)this.trace(N);else{var z=new Error(N);throw z.hash=O,z}},parse:function(N){var O=this,z=[0],V=[null],$=[],G=this.table,W="",U=0,D=0,de=0,ge=2,K=1,se=$.slice.call(arguments,1),H=Object.create(this.lexer),Z={yy:{}};for(var ce in this.yy)Object.prototype.hasOwnProperty.call(this.yy,ce)&&(Z.yy[ce]=this.yy[ce]);H.setInput(N,Z.yy),Z.yy.lexer=H,Z.yy.parser=this,typeof H.yylloc=="undefined"&&(H.yylloc={});var Re=H.yylloc;$.push(Re);var he=H.options&&H.options.ranges;typeof Z.yy.parseError=="function"?this.parseError=Z.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var Ie=function(){var gt;return gt=H.lex()||K,typeof gt!="number"&&(gt=O.symbols_[gt]||gt),gt},Ee,Be,J,j,pe,De,Te={},Se,qe,st,Ve;;){if(J=z[z.length-1],this.defaultActions[J]?j=this.defaultActions[J]:((Ee===null||typeof Ee=="undefined")&&(Ee=Ie()),j=G[J]&&G[J][Ee]),typeof j=="undefined"||!j.length||!j[0]){var _e="";Ve=[];for(Se in G[J])this.terminals_[Se]&&Se>ge&&Ve.push("'"+this.terminals_[Se]+"'");H.showPosition?_e="Parse error on line "+(U+1)+`:
`+H.showPosition()+`
Expecting `+Ve.join(", ")+", got '"+(this.terminals_[Ee]||Ee)+"'":_e="Parse error on line "+(U+1)+": Unexpected "+(Ee==K?"end of input":"'"+(this.terminals_[Ee]||Ee)+"'"),this.parseError(_e,{text:H.match,token:this.terminals_[Ee]||Ee,line:H.yylineno,loc:Re,expected:Ve})}if(j[0]instanceof Array&&j.length>1)throw new Error("Parse Error: multiple actions possible at state: "+J+", token: "+Ee);switch(j[0]){case 1:z.push(Ee),V.push(H.yytext),$.push(H.yylloc),z.push(j[1]),Ee=null,Be?(Ee=Be,Be=null):(D=H.yyleng,W=H.yytext,U=H.yylineno,Re=H.yylloc,de>0);break;case 2:if(qe=this.productions_[j[1]][1],Te.$=V[V.length-qe],Te._$={first_line:$[$.length-(qe||1)].first_line,last_line:$[$.length-1].last_line,first_column:$[$.length-(qe||1)].first_column,last_column:$[$.length-1].last_column},he&&(Te._$.range=[$[$.length-(qe||1)].range[0],$[$.length-1].range[1]]),De=this.performAction.apply(Te,[W,D,U,Z.yy,j[1],V,$].concat(se)),typeof De!="undefined")return De;qe&&(z=z.slice(0,-1*qe*2),V=V.slice(0,-1*qe),$=$.slice(0,-1*qe)),z.push(this.productions_[j[1]][0]),V.push(Te.$),$.push(Te._$),st=G[z[z.length-2]][z[z.length-1]],z.push(st);break;case 3:return!0}}return!0}},x=function(){var N={EOF:1,parseError:function(O,z){if(this.yy.parser)this.yy.parser.parseError(O,z);else throw new Error(O)},setInput:function(O,z){return this.yy=z||this.yy||{},this._input=O,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var O=this._input[0];this.yytext+=O,this.yyleng++,this.offset++,this.match+=O,this.matched+=O;var z=O.match(/(?:\r\n?|\n).*/g);return z?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),O},unput:function(O){var z=O.length,V=O.split(/(?:\r\n?|\n)/g);this._input=O+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-z),this.offset-=z;var $=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),V.length-1&&(this.yylineno-=V.length-1);var G=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:V?(V.length===$.length?this.yylloc.first_column:0)+$[$.length-V.length].length-V[0].length:this.yylloc.first_column-z},this.options.ranges&&(this.yylloc.range=[G[0],G[0]+this.yyleng-z]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(O){this.unput(this.match.slice(O))},pastInput:function(){var O=this.matched.substr(0,this.matched.length-this.match.length);return(O.length>20?"...":"")+O.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var O=this.match;return O.length<20&&(O+=this._input.substr(0,20-O.length)),(O.substr(0,20)+(O.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var O=this.pastInput(),z=new Array(O.length+1).join("-");return O+this.upcomingInput()+`
`+z+"^"},test_match:function(O,z){var V,$,G;if(this.options.backtrack_lexer&&(G={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(G.yylloc.range=this.yylloc.range.slice(0))),$=O[0].match(/(?:\r\n?|\n).*/g),$&&(this.yylineno+=$.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:$?$[$.length-1].length-$[$.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+O[0].length},this.yytext+=O[0],this.match+=O[0],this.matches=O,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(O[0].length),this.matched+=O[0],V=this.performAction.call(this,this.yy,this,z,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),V)return V;if(this._backtrack){for(var W in G)this[W]=G[W];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var O,z,V,$;this._more||(this.yytext="",this.match="");for(var G=this._currentRules(),W=0;W<G.length;W++)if(V=this._input.match(this.rules[G[W]]),V&&(!z||V[0].length>z[0].length)){if(z=V,$=W,this.options.backtrack_lexer){if(O=this.test_match(V,G[W]),O!==!1)return O;if(this._backtrack){z=!1;continue}else return!1}else if(!this.options.flex)break}return z?(O=this.test_match(z,G[$]),O!==!1?O:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var O=this.next();return O||this.lex()},begin:function(O){this.conditionStack.push(O)},popState:function(){var O=this.conditionStack.length-1;return O>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(O){return O=this.conditionStack.length-1-Math.abs(O||0),O>=0?this.conditionStack[O]:"INITIAL"},pushState:function(O){this.begin(O)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(O,z,V,$){switch(V){case 0:break;case 1:return this.begin("optarg"),26;case 2:return this.popState(),27;case 3:return 23;case 4:return 24;case 5:return 25;case 6:return 28;case 7:return 22;case 8:return 13;case 9:return 14;case 10:return 12;case 11:return 10;case 12:return 19;case 13:return 21;case 14:return 34;case 15:return 33;case 16:return 37;case 17:return 38;case 18:return 32;case 19:return 32;case 20:return 32;case 21:return 35;case 22:return 35;case 23:return 36;case 24:return 32;case 25:return 5}},rules:[/^(?:\s+)/,/^(?:(\\sqrt)\s*\[)/,/^(?:\])/,/^(?:(\\operatorname))/,/^(?:(\\mathrm))/,/^(?:(\\text))/,/^(?:(\\sqrt))/,/^(?:(\\frac))/,/^(?:'+\^)/,/^(?:'+)/,/^(?:\^)/,/^(?:[_])/,/^(?:(\\left))/,/^(?:(\\right))/,/^(?:(\\langle|\\rangle|\\vert|\\Vert))/,/^(?:\[|\]|\\\{|\\\}|\(|\)|\||\\\|)/,/^(?:\{)/,/^(?:\})/,/^(?:\\(infty))/,/^(?:\\(int))/,/^(?:!)/,/^(?:\\(alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|omicron|pi|rho|sigma|tau|xi|upsilon|phi|chi|psi|omega))/,/^(?:\\(Alpha|Beta|Gamma|Delta|Epsilon|Zeta|Eta|Theta|Iota|Kappa|Lambda|Mu|Nu|Omicron|Pi|Rho|Sigma|Tau|Xi|Upsilon|Phi|Chi|Psi|Omega))/,/^(?:\\[A-Za-z]+)/,/^(?:\\.|.)/,/^(?:$)/],conditions:{optarg:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],inclusive:!0},INITIAL:{rules:[0,1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],inclusive:!0}}};return N}();B.lexer=x;function L(){this.yy={}}return L.prototype=B,B.Parser=L,new L}();typeof Qm!="undefined"&&typeof e!="undefined"&&(e.parser=r,e.Parser=r.Parser,e.parse=function(){return r.parse.apply(r,arguments)},e.main=function(){},typeof t!="undefined"&&Qm.main===t&&e.main(process.argv.slice(1)))}}),D3=nM({"generated/nemeth-to-latex.jison.js"(e,t){var r=function(){var n=function(oe,me,te,ae){for(te=te||{},ae=oe.length;ae--;te[oe[ae]]=me);return te},i=[1,11],o=[1,12],a=[1,13],s=[1,79],l=[1,80],c=[1,77],d=[1,78],u=[1,39],p=[1,40],g=[1,67],f=[1,68],y=[1,69],E=[1,70],_=[1,71],w=[1,72],v=[1,73],T=[1,74],M=[1,75],C=[1,76],P=[1,41],F=[1,35],B=[1,36],x=[1,37],L=[1,38],N=[1,42],O=[1,43],z=[1,44],V=[1,45],$=[1,46],G=[1,47],W=[1,48],U=[1,49],D=[1,50],de=[1,51],ge=[1,52],K=[1,53],se=[1,54],H=[1,55],Z=[1,56],ce=[1,57],Re=[1,58],he=[1,59],Ie=[1,60],Ee=[1,61],Be=[1,17],J=[1,62],j=[1,63],pe=[1,64],De=[1,65],Te=[1,66],Se=[5,12,13,14,18,24,25],qe=[5,11,12,13,14,15,17,18,20,21,23,24,25,27,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91],st=[1,84],Ve=[5,11,12,13,14,15,17,18,20,21,23,24,25,27,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,91],_e=[5,11,12,13,14,15,17,18,20,21,23,24,25,27,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91],gt={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,element:6,index_element:7,modified_expression:8,radical:9,primes:10,OPEN_MODEXP:11,MODEXP_UNDER:12,MODEXP_OVER:13,CLOSE_MODEXP:14,RADICAL_INDEX:15,index_group:16,OPEN_RADICAL:17,CLOSE_RADICAL:18,level:19,LEVEL:20,BASELINE:21,frac:22,OPEN_FRAC:23,SLASH:24,CLOSE_FRAC:25,geo_token:26,GEO_TOKEN:27,number:28,subscript_head:29,atom:30,command:31,greek:32,letter:33,comma:34,period:35,space:36,operation:37,comparison:38,level_with_comparison:39,ellipsis:40,colon:41,infinity:42,integral:43,factorial:44,ampersand:45,question_mark:46,bracket:47,",":48,".":49,"[":50,"{":51,"(":52,"]":53,"}":54,")":55,LANGLE:56,RANGLE:57,PIPE:58,DOUBLE_PIPE:59,SPACE:60,COMMAND:61,GREEK:62,LETTER:63,CAPITAL_LETTER:64,"+":65,"-":66,CDOT:67,TIMES:68,"*":69,"/":70,DIV:71,PERCENT_OF:72,PERCENT:73,MEASURED_ANGLE:74,ANGLE:75,CIRCLE:76,PARALLELOGRAM:77,TO:78,TRIANGLE:79,DEGREE:80,COMPARISON:81,LEVEL_WITH_COMPARISON:82,ELLIPSIS:83,COLON:84,NUMBER:85,INFINITY:86,INTEGRAL:87,FACTORIAL:88,"&":89,PRIMES:90,"?":91,unknown:92,UNKNOWN:93,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",11:"OPEN_MODEXP",12:"MODEXP_UNDER",13:"MODEXP_OVER",14:"CLOSE_MODEXP",15:"RADICAL_INDEX",17:"OPEN_RADICAL",18:"CLOSE_RADICAL",20:"LEVEL",21:"BASELINE",23:"OPEN_FRAC",24:"SLASH",25:"CLOSE_FRAC",27:"GEO_TOKEN",48:",",49:".",50:"[",51:"{",52:"(",53:"]",54:"}",55:")",56:"LANGLE",57:"RANGLE",58:"PIPE",59:"DOUBLE_PIPE",60:"SPACE",61:"COMMAND",62:"GREEK",63:"LETTER",64:"CAPITAL_LETTER",65:"+",66:"-",67:"CDOT",68:"TIMES",69:"*",70:"/",71:"DIV",72:"PERCENT_OF",73:"PERCENT",74:"MEASURED_ANGLE",75:"ANGLE",76:"CIRCLE",77:"PARALLELOGRAM",78:"TO",79:"TRIANGLE",80:"DEGREE",81:"COMPARISON",82:"LEVEL_WITH_COMPARISON",83:"ELLIPSIS",84:"COLON",85:"NUMBER",86:"INFINITY",87:"INTEGRAL",88:"FACTORIAL",89:"&",90:"PRIMES",91:"?",93:"UNKNOWN"},productions_:[0,[3,2],[3,1],[4,2],[4,1],[6,1],[6,1],[6,2],[6,1],[8,7],[8,6],[8,5],[8,6],[8,5],[8,5],[8,4],[8,4],[8,3],[8,4],[8,4],[8,4],[8,4],[8,3],[8,3],[8,2],[9,5],[9,4],[9,4],[9,3],[9,3],[9,2],[19,1],[19,1],[22,5],[22,4],[22,4],[22,3],[26,2],[16,2],[16,1],[7,3],[7,2],[7,2],[7,3],[7,2],[7,2],[7,1],[7,1],[7,1],[29,1],[29,1],[29,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[34,1],[35,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[36,1],[31,1],[32,1],[33,1],[33,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[38,1],[39,1],[40,1],[41,1],[28,1],[42,1],[43,1],[44,1],[45,1],[10,1],[46,1],[92,1]],performAction:function(oe,me,te,ae,He,Ue,It){var it=Ue.length-1;switch(He){case 1:return Ue[it-1];case 2:return ae.group();case 3:case 38:case 42:case 44:case 45:this.$=ae.group(Ue[it-1],Ue[it]);break;case 4:case 39:this.$=ae.group(Ue[it]);break;case 7:this.$=ae.group(Ue[it-1],Ue[it]);break;case 9:this.$=ae.modified_expression(Ue[it-5],Ue[it-3],Ue[it-1]);break;case 10:this.$=ae.modified_expression(Ue[it-4],Ue[it-2]);break;case 11:this.$=ae.modified_expression(Ue[it-3],Ue[it-1]);break;case 12:this.$=ae.modified_expression(Ue[it-4],ae.group(),Ue[it-1]);break;case 13:this.$=ae.modified_expression(Ue[it-3],ae.group(),Ue[it-1]);break;case 14:this.$=ae.modified_expression(Ue[it-3],ae.group(),ae.group());break;case 15:case 16:this.$=ae.modified_expression(Ue[it-2],ae.group());break;case 17:this.$=ae.modified_expression(Ue[it-1]);break;case 18:case 19:case 22:case 23:case 24:this.$=ae.modified_expression(ae.group());break;case 20:case 21:ae.warnOrError("Multi-level modified expressions are not supported."),this.$=ae.modified_expression(ae.group());break;case 25:this.$=ae.radical(Ue[it-1],Ue[it-3]);break;case 26:this.$=ae.radical(Ue[it-1],ae.group());break;case 27:this.$=ae.radical(ae.group(),Ue[it-2]);break;case 28:this.$=ae.radical(ae.group(),ae.group());break;case 29:this.$=ae.radical(Ue[it-1]);break;case 30:this.$=ae.radical(ae.group());break;case 31:this.$=ae.level(Ue[it]);break;case 32:this.$=ae.baseline();break;case 33:this.$=ae.fraction(Ue[it-3],Ue[it-1]);break;case 34:this.$=ae.fraction(Ue[it-2],ae.group());break;case 35:this.$=ae.fraction(ae.group(),Ue[it-1]);break;case 36:this.$=ae.fraction(ae.group(),ae.group());break;case 37:this.$=ae.geo_token(Ue[it]);break;case 40:this.$=ae.group(ae.simple_subscript(Ue[it-2],Ue[it]),Ue[it-1]);break;case 41:this.$=ae.simple_subscript(Ue[it-1],Ue[it]);break;case 43:ae.warnOrError("Illegal use of Nemeth primes"),this.$=ae.group(ae.simple_subscript(Ue[it-2],Ue[it-1]),Ue[it]);break;case 69:this.$=ae.terminal(",");break;case 70:this.$=ae.terminal(".");break;case 71:this.$=ae.terminal("[");break;case 72:this.$=ae.terminal("\\{");break;case 73:this.$=ae.terminal("(");break;case 74:this.$=ae.terminal("]");break;case 75:this.$=ae.terminal("\\}");break;case 76:this.$=ae.terminal(")");break;case 77:this.$=ae.terminal("\\langle ");break;case 78:this.$=ae.terminal("\\rangle ");break;case 79:this.$=ae.terminal("|");break;case 80:this.$=ae.terminal("\\|");break;case 81:this.$=ae.terminal(" ");break;case 82:this.$=ae.command(Ue[it].toLowerCase());break;case 83:this.$=ae.terminal(ae.greek(Ue[it]));break;case 84:this.$=ae.terminal(Ue[it].toLowerCase());break;case 85:this.$=ae.terminal(Ue[it].toUpperCase());break;case 86:this.$=ae.terminal("+");break;case 87:this.$=ae.terminal("-");break;case 88:this.$=ae.terminal("\\cdot ");break;case 89:this.$=ae.terminal("\\times ");break;case 90:this.$=ae.terminal("*");break;case 91:this.$=ae.terminal("/");break;case 92:this.$=ae.terminal("\\div ");break;case 93:this.$=ae.terminal("\\%\\operatorname{of}");break;case 94:this.$=ae.terminal("\\%");break;case 95:this.$=ae.terminal("\\measuredangle ");break;case 96:this.$=ae.terminal("\\angle ");break;case 97:this.$=ae.terminal("\\bigcirc ");break;case 98:this.$=ae.terminal("\\parallelogram ");break;case 99:this.$=ae.terminal("\\to ");break;case 100:this.$=ae.terminal("\\triangle ");break;case 101:this.$=ae.terminal("\\degree ");break;case 102:this.$=ae.comparison(Ue[it].trim());break;case 103:this.$=ae.level_with_comparison(Ue[it].trim());break;case 104:this.$=ae.terminal("\\ldots ");break;case 105:this.$=ae.terminal(":");break;case 106:this.$=ae.terminal(Ue[it]);break;case 107:this.$=ae.terminal("\\infty ");break;case 108:this.$=ae.terminal("\\int ");break;case 109:this.$=ae.terminal("!");break;case 110:this.$=ae.terminal("\\&");break;case 111:this.$=ae.primes(Ue[it]);break;case 112:this.$=ae.terminal("?");break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:6,9:7,11:i,15:o,17:a,19:34,20:s,21:l,22:32,23:c,26:33,27:d,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:p,50:g,51:f,52:y,53:E,54:_,55:w,56:v,57:T,58:M,59:C,60:P,61:F,62:B,63:x,64:L,65:N,66:O,67:z,68:V,69:$,70:G,71:W,72:U,73:D,74:de,75:ge,76:K,77:se,78:H,79:Z,80:ce,81:Re,82:he,83:Ie,84:Ee,85:Be,86:J,87:j,88:pe,89:De,91:Te},{1:[3]},{5:[1,81]},{1:[2,2]},n(Se,[2,4],{6:4,7:5,8:6,9:7,29:8,28:9,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,22:32,26:33,19:34,4:82,11:i,15:o,17:a,20:s,21:l,23:c,27:d,48:u,49:p,50:g,51:f,52:y,53:E,54:_,55:w,56:v,57:T,58:M,59:C,60:P,61:F,62:B,63:x,64:L,65:N,66:O,67:z,68:V,69:$,70:G,71:W,72:U,73:D,74:de,75:ge,76:K,77:se,78:H,79:Z,80:ce,81:Re,82:he,83:Ie,84:Ee,85:Be,86:J,87:j,88:pe,89:De,91:Te}),n(qe,[2,5]),n(qe,[2,6]),n(qe,[2,8],{10:83,90:st}),n(Ve,[2,46],{10:85,28:86,85:Be,90:st}),n(qe,[2,47],{10:87,90:st}),n(qe,[2,48],{10:88,90:st}),{4:89,6:4,7:5,8:6,9:7,11:i,12:[1,91],13:[1,90],14:[1,92],15:o,17:a,19:34,20:s,21:l,22:32,23:c,26:33,27:d,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:p,50:g,51:f,52:y,53:E,54:_,55:w,56:v,57:T,58:M,59:C,60:P,61:F,62:B,63:x,64:L,65:N,66:O,67:z,68:V,69:$,70:G,71:W,72:U,73:D,74:de,75:ge,76:K,77:se,78:H,79:Z,80:ce,81:Re,82:he,83:Ie,84:Ee,85:Be,86:J,87:j,88:pe,89:De,91:Te},{7:95,16:93,17:[1,94],19:34,20:s,21:l,22:32,23:c,26:33,27:d,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:p,50:g,51:f,52:y,53:E,54:_,55:w,56:v,57:T,58:M,59:C,60:P,61:F,62:B,63:x,64:L,65:N,66:O,67:z,68:V,69:$,70:G,71:W,72:U,73:D,74:de,75:ge,76:K,77:se,78:H,79:Z,80:ce,81:Re,82:he,83:Ie,84:Ee,85:Be,86:J,87:j,88:pe,89:De,91:Te},{4:96,6:4,7:5,8:6,9:7,11:i,15:o,17:a,18:[1,97],19:34,20:s,21:l,22:32,23:c,26:33,27:d,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:p,50:g,51:f,52:y,53:E,54:_,55:w,56:v,57:T,58:M,59:C,60:P,61:F,62:B,63:x,64:L,65:N,66:O,67:z,68:V,69:$,70:G,71:W,72:U,73:D,74:de,75:ge,76:K,77:se,78:H,79:Z,80:ce,81:Re,82:he,83:Ie,84:Ee,85:Be,86:J,87:j,88:pe,89:De,91:Te},n(_e,[2,49]),n(_e,[2,50]),n(_e,[2,51]),n(_e,[2,106]),n(_e,[2,52]),n(_e,[2,53]),n(_e,[2,54]),n(_e,[2,55]),n(_e,[2,56]),n(_e,[2,57]),n(_e,[2,58]),n(_e,[2,59]),n(_e,[2,60]),n(_e,[2,61]),n(_e,[2,62]),n(_e,[2,63]),n(_e,[2,64]),n(_e,[2,65]),n(_e,[2,66]),n(_e,[2,67]),n(_e,[2,68]),n(_e,[2,82]),n(_e,[2,83]),n(_e,[2,84]),n(_e,[2,85]),n(_e,[2,69]),n(_e,[2,70]),n(_e,[2,81]),n(_e,[2,86]),n(_e,[2,87]),n(_e,[2,88]),n(_e,[2,89]),n(_e,[2,90]),n(_e,[2,91]),n(_e,[2,92]),n(_e,[2,93]),n(_e,[2,94]),n(_e,[2,95]),n(_e,[2,96]),n(_e,[2,97]),n(_e,[2,98]),n(_e,[2,99]),n(_e,[2,100]),n(_e,[2,101]),n(_e,[2,102]),n(_e,[2,103]),n(_e,[2,104]),n(_e,[2,105]),n(_e,[2,107]),n(_e,[2,108]),n(_e,[2,109]),n(_e,[2,110]),n(_e,[2,112]),n(_e,[2,71]),n(_e,[2,72]),n(_e,[2,73]),n(_e,[2,74]),n(_e,[2,75]),n(_e,[2,76]),n(_e,[2,77]),n(_e,[2,78]),n(_e,[2,79]),n(_e,[2,80]),{4:98,6:4,7:5,8:6,9:7,11:i,15:o,17:a,19:34,20:s,21:l,22:32,23:c,24:[1,99],26:33,27:d,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:p,50:g,51:f,52:y,53:E,54:_,55:w,56:v,57:T,58:M,59:C,60:P,61:F,62:B,63:x,64:L,65:N,66:O,67:z,68:V,69:$,70:G,71:W,72:U,73:D,74:de,75:ge,76:K,77:se,78:H,79:Z,80:ce,81:Re,82:he,83:Ie,84:Ee,85:Be,86:J,87:j,88:pe,89:De,91:Te},{28:100,85:Be},n(_e,[2,31]),n(_e,[2,32]),{1:[2,1]},n(Se,[2,3]),n(qe,[2,7]),n(qe,[2,111]),n(Ve,[2,42],{28:101,85:Be}),n(qe,[2,41],{10:102,90:st}),n(qe,[2,44]),n(qe,[2,45]),{12:[1,103],13:[1,104],14:[1,105]},{12:[1,106],13:[1,107],14:[1,108]},{12:[1,110],13:[1,109],14:[1,111]},n(qe,[2,24]),{17:[1,112]},{4:113,6:4,7:5,8:6,9:7,11:i,15:o,17:a,18:[1,114],19:34,20:s,21:l,22:32,23:c,26:33,27:d,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:p,50:g,51:f,52:y,53:E,54:_,55:w,56:v,57:T,58:M,59:C,60:P,61:F,62:B,63:x,64:L,65:N,66:O,67:z,68:V,69:$,70:G,71:W,72:U,73:D,74:de,75:ge,76:K,77:se,78:H,79:Z,80:ce,81:Re,82:he,83:Ie,84:Ee,85:Be,86:J,87:j,88:pe,89:De,91:Te},{7:95,16:115,17:[2,39],19:34,20:s,21:l,22:32,23:c,26:33,27:d,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:p,50:g,51:f,52:y,53:E,54:_,55:w,56:v,57:T,58:M,59:C,60:P,61:F,62:B,63:x,64:L,65:N,66:O,67:z,68:V,69:$,70:G,71:W,72:U,73:D,74:de,75:ge,76:K,77:se,78:H,79:Z,80:ce,81:Re,82:he,83:Ie,84:Ee,85:Be,86:J,87:j,88:pe,89:De,91:Te},{18:[1,116]},n(_e,[2,30]),{24:[1,117]},{4:118,6:4,7:5,8:6,9:7,11:i,15:o,17:a,19:34,20:s,21:l,22:32,23:c,25:[1,119],26:33,27:d,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:p,50:g,51:f,52:y,53:E,54:_,55:w,56:v,57:T,58:M,59:C,60:P,61:F,62:B,63:x,64:L,65:N,66:O,67:z,68:V,69:$,70:G,71:W,72:U,73:D,74:de,75:ge,76:K,77:se,78:H,79:Z,80:ce,81:Re,82:he,83:Ie,84:Ee,85:Be,86:J,87:j,88:pe,89:De,91:Te},n(_e,[2,37]),n(qe,[2,40]),n(qe,[2,43]),{4:120,6:4,7:5,8:6,9:7,11:i,13:[1,121],14:[1,122],15:o,17:a,19:34,20:s,21:l,22:32,23:c,26:33,27:d,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:p,50:g,51:f,52:y,53:E,54:_,55:w,56:v,57:T,58:M,59:C,60:P,61:F,62:B,63:x,64:L,65:N,66:O,67:z,68:V,69:$,70:G,71:W,72:U,73:D,74:de,75:ge,76:K,77:se,78:H,79:Z,80:ce,81:Re,82:he,83:Ie,84:Ee,85:Be,86:J,87:j,88:pe,89:De,91:Te},{4:123,6:4,7:5,8:6,9:7,11:i,14:[1,124],15:o,17:a,19:34,20:s,21:l,22:32,23:c,26:33,27:d,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:p,50:g,51:f,52:y,53:E,54:_,55:w,56:v,57:T,58:M,59:C,60:P,61:F,62:B,63:x,64:L,65:N,66:O,67:z,68:V,69:$,70:G,71:W,72:U,73:D,74:de,75:ge,76:K,77:se,78:H,79:Z,80:ce,81:Re,82:he,83:Ie,84:Ee,85:Be,86:J,87:j,88:pe,89:De,91:Te},n(qe,[2,17]),{14:[1,125]},{14:[1,126]},n(qe,[2,22]),{14:[1,127]},{14:[1,128]},n(qe,[2,23]),{4:129,6:4,7:5,8:6,9:7,11:i,15:o,17:a,18:[1,130],19:34,20:s,21:l,22:32,23:c,26:33,27:d,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:p,50:g,51:f,52:y,53:E,54:_,55:w,56:v,57:T,58:M,59:C,60:P,61:F,62:B,63:x,64:L,65:N,66:O,67:z,68:V,69:$,70:G,71:W,72:U,73:D,74:de,75:ge,76:K,77:se,78:H,79:Z,80:ce,81:Re,82:he,83:Ie,84:Ee,85:Be,86:J,87:j,88:pe,89:De,91:Te},{18:[1,131]},n(_e,[2,28]),{17:[2,38]},n(_e,[2,29]),{4:132,6:4,7:5,8:6,9:7,11:i,15:o,17:a,19:34,20:s,21:l,22:32,23:c,25:[1,133],26:33,27:d,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:p,50:g,51:f,52:y,53:E,54:_,55:w,56:v,57:T,58:M,59:C,60:P,61:F,62:B,63:x,64:L,65:N,66:O,67:z,68:V,69:$,70:G,71:W,72:U,73:D,74:de,75:ge,76:K,77:se,78:H,79:Z,80:ce,81:Re,82:he,83:Ie,84:Ee,85:Be,86:J,87:j,88:pe,89:De,91:Te},{25:[1,134]},n(_e,[2,36]),{13:[1,135],14:[1,136]},{4:137,6:4,7:5,8:6,9:7,11:i,14:[1,138],15:o,17:a,19:34,20:s,21:l,22:32,23:c,26:33,27:d,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:p,50:g,51:f,52:y,53:E,54:_,55:w,56:v,57:T,58:M,59:C,60:P,61:F,62:B,63:x,64:L,65:N,66:O,67:z,68:V,69:$,70:G,71:W,72:U,73:D,74:de,75:ge,76:K,77:se,78:H,79:Z,80:ce,81:Re,82:he,83:Ie,84:Ee,85:Be,86:J,87:j,88:pe,89:De,91:Te},n(qe,[2,16]),{14:[1,139]},n(qe,[2,15]),n(qe,[2,18]),n(qe,[2,20]),n(qe,[2,19]),n(qe,[2,21]),{18:[1,140]},n(_e,[2,27]),n(_e,[2,26]),{25:[1,141]},n(_e,[2,34]),n(_e,[2,35]),{4:142,6:4,7:5,8:6,9:7,11:i,14:[1,143],15:o,17:a,19:34,20:s,21:l,22:32,23:c,26:33,27:d,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:p,50:g,51:f,52:y,53:E,54:_,55:w,56:v,57:T,58:M,59:C,60:P,61:F,62:B,63:x,64:L,65:N,66:O,67:z,68:V,69:$,70:G,71:W,72:U,73:D,74:de,75:ge,76:K,77:se,78:H,79:Z,80:ce,81:Re,82:he,83:Ie,84:Ee,85:Be,86:J,87:j,88:pe,89:De,91:Te},n(qe,[2,11]),{14:[1,144]},n(qe,[2,14]),n(qe,[2,13]),n(_e,[2,25]),n(_e,[2,33]),{14:[1,145]},n(qe,[2,10]),n(qe,[2,12]),n(qe,[2,9])],defaultActions:{3:[2,2],81:[2,1],115:[2,38]},parseError:function(oe,me){if(me.recoverable)this.trace(oe);else{var te=new Error(oe);throw te.hash=me,te}},parse:function(oe){var me=this,te=[0],ae=[null],He=[],Ue=this.table,It="",it=0,Cr=0,Gt=0,ar=2,Vt=1,at=He.slice.call(arguments,1),We=Object.create(this.lexer),ue={yy:{}};for(var X in this.yy)Object.prototype.hasOwnProperty.call(this.yy,X)&&(ue.yy[X]=this.yy[X]);We.setInput(oe,ue.yy),ue.yy.lexer=We,ue.yy.parser=this,typeof We.yylloc=="undefined"&&(We.yylloc={});var fe=We.yylloc;He.push(fe);var Oe=We.options&&We.options.ranges;typeof ue.yy.parseError=="function"?this.parseError=ue.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var we=function(){var pr;return pr=We.lex()||Vt,typeof pr!="number"&&(pr=me.symbols_[pr]||pr),pr},Ge,Je,ut,St,Lt,dt,ft={},kt,Ct,ur,Bt;;){if(ut=te[te.length-1],this.defaultActions[ut]?St=this.defaultActions[ut]:((Ge===null||typeof Ge=="undefined")&&(Ge=we()),St=Ue[ut]&&Ue[ut][Ge]),typeof St=="undefined"||!St.length||!St[0]){var Ot="";Bt=[];for(kt in Ue[ut])this.terminals_[kt]&&kt>ar&&Bt.push("'"+this.terminals_[kt]+"'");We.showPosition?Ot="Parse error on line "+(it+1)+`:
`+We.showPosition()+`
Expecting `+Bt.join(", ")+", got '"+(this.terminals_[Ge]||Ge)+"'":Ot="Parse error on line "+(it+1)+": Unexpected "+(Ge==Vt?"end of input":"'"+(this.terminals_[Ge]||Ge)+"'"),this.parseError(Ot,{text:We.match,token:this.terminals_[Ge]||Ge,line:We.yylineno,loc:fe,expected:Bt})}if(St[0]instanceof Array&&St.length>1)throw new Error("Parse Error: multiple actions possible at state: "+ut+", token: "+Ge);switch(St[0]){case 1:te.push(Ge),ae.push(We.yytext),He.push(We.yylloc),te.push(St[1]),Ge=null,Je?(Ge=Je,Je=null):(Cr=We.yyleng,It=We.yytext,it=We.yylineno,fe=We.yylloc,Gt>0);break;case 2:if(Ct=this.productions_[St[1]][1],ft.$=ae[ae.length-Ct],ft._$={first_line:He[He.length-(Ct||1)].first_line,last_line:He[He.length-1].last_line,first_column:He[He.length-(Ct||1)].first_column,last_column:He[He.length-1].last_column},Oe&&(ft._$.range=[He[He.length-(Ct||1)].range[0],He[He.length-1].range[1]]),dt=this.performAction.apply(ft,[It,Cr,it,ue.yy,St[1],ae,He].concat(at)),typeof dt!="undefined")return dt;Ct&&(te=te.slice(0,-1*Ct*2),ae=ae.slice(0,-1*Ct),He=He.slice(0,-1*Ct)),te.push(this.productions_[St[1]][0]),ae.push(ft.$),He.push(ft._$),ur=Ue[te[te.length-2]][te[te.length-1]],te.push(ur);break;case 3:return!0}}return!0}},At=function(){var oe={EOF:1,parseError:function(me,te){if(this.yy.parser)this.yy.parser.parseError(me,te);else throw new Error(me)},setInput:function(me,te){return this.yy=te||this.yy||{},this._input=me,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var me=this._input[0];this.yytext+=me,this.yyleng++,this.offset++,this.match+=me,this.matched+=me;var te=me.match(/(?:\r\n?|\n).*/g);return te?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),me},unput:function(me){var te=me.length,ae=me.split(/(?:\r\n?|\n)/g);this._input=me+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-te),this.offset-=te;var He=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),ae.length-1&&(this.yylineno-=ae.length-1);var Ue=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:ae?(ae.length===He.length?this.yylloc.first_column:0)+He[He.length-ae.length].length-ae[0].length:this.yylloc.first_column-te},this.options.ranges&&(this.yylloc.range=[Ue[0],Ue[0]+this.yyleng-te]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(me){this.unput(this.match.slice(me))},pastInput:function(){var me=this.matched.substr(0,this.matched.length-this.match.length);return(me.length>20?"...":"")+me.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var me=this.match;return me.length<20&&(me+=this._input.substr(0,20-me.length)),(me.substr(0,20)+(me.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var me=this.pastInput(),te=new Array(me.length+1).join("-");return me+this.upcomingInput()+`
`+te+"^"},test_match:function(me,te){var ae,He,Ue;if(this.options.backtrack_lexer&&(Ue={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(Ue.yylloc.range=this.yylloc.range.slice(0))),He=me[0].match(/(?:\r\n?|\n).*/g),He&&(this.yylineno+=He.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:He?He[He.length-1].length-He[He.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+me[0].length},this.yytext+=me[0],this.match+=me[0],this.matches=me,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(me[0].length),this.matched+=me[0],ae=this.performAction.call(this,this.yy,this,te,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),ae)return ae;if(this._backtrack){for(var It in Ue)this[It]=Ue[It];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var me,te,ae,He;this._more||(this.yytext="",this.match="");for(var Ue=this._currentRules(),It=0;It<Ue.length;It++)if(ae=this._input.match(this.rules[Ue[It]]),ae&&(!te||ae[0].length>te[0].length)){if(te=ae,He=It,this.options.backtrack_lexer){if(me=this.test_match(ae,Ue[It]),me!==!1)return me;if(this._backtrack){te=!1;continue}else return!1}else if(!this.options.flex)break}return te?(me=this.test_match(te,Ue[He]),me!==!1?me:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var me=this.next();return me||this.lex()},begin:function(me){this.conditionStack.push(me)},popState:function(){var me=this.conditionStack.length-1;return me>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(me){return me=this.conditionStack.length-1-Math.abs(me||0),me>=0?this.conditionStack[me]:"INITIAL"},pushState:function(me){this.begin(me)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(me,te,ae,He){switch(ae){case 0:return this.begin("modexp"),11;case 1:return 21;case 2:return this.begin("modexp"),11;case 3:return 12;case 4:return 13;case 5:return this.popState(),14;case 6:return 65;case 7:return 66;case 8:return 67;case 9:return 68;case 10:return 69;case 11:return 70;case 12:return 71;case 13:return 56;case 14:return 50;case 15:return 51;case 16:return 52;case 17:return 57;case 18:return 53;case 19:return 54;case 20:return 55;case 21:return 59;case 22:return 58;case 23:return 84;case 24:return 72;case 25:return 73;case 26:return 74;case 27:return 75;case 28:return 76;case 29:return 77;case 30:return 78;case 31:return 79;case 32:return 80;case 33:return 82;case 34:return 82;case 35:return 82;case 36:return 82;case 37:return 82;case 38:return 82;case 39:return 82;case 40:return 82;case 41:return 82;case 42:return 81;case 43:return 82;case 44:return 82;case 45:return 81;case 46:return 81;case 47:return 81;case 48:return 81;case 49:return 81;case 50:return 81;case 51:return 81;case 52:return 81;case 53:return 81;case 54:return 81;case 55:return 81;case 56:return 83;case 57:return 20;case 58:return 49;case 59:return 21;case 60:return 90;case 61:return 62;case 62:return 15;case 63:return this.begin("radical"),17;case 64:return this.popState(),18;case 65:return 18;case 66:return 87;case 67:return 89;case 68:return 88;case 69:return 61;case 70:return 61;case 71:return 27;case 72:return te.yytext=this.matches[1],85;case 73:return 23;case 74:return 24;case 75:return 25;case 76:return te.yytext=this.matches[1],64;case 77:return 63;case 78:return 86;case 79:return 91;case 80:return 48;case 81:return 49;case 82:return 60;case 83:return 5;case 84:return 93}},rules:[/^(?:"(?=[^>\]]+%))/,/^(?:")/,/^(?:"(?=[^>\]]+\]|[^>\]]+%))/,/^(?:%)/,/^(?:<)/,/^(?:\])/,/^(?:[+])/,/^(?:[-])/,/^(?:[*])/,/^(?:[@][*])/,/^(?:[@][\#])/,/^(?:[_][/])/,/^(?:[.][/])/,/^(?:[.][.][(])/,/^(?:[@][(])/,/^(?:[.][(])/,/^(?:[(])/,/^(?:[.][.][)])/,/^(?:[@][)])/,/^(?:[.][)])/,/^(?:[)])/,/^(?:[\\][\\])/,/^(?:[\\])/,/^(?:[_][3])/,/^(?:[@][0][O][F][ ]?)/,/^(?:[@][0])/,/^(?:[M][$][\[][ ])/,/^(?:[$][\[][ ])/,/^(?:[$]C[ ])/,/^(?:[$]G[ ])/,/^(?:[ ][$]O[ ])/,/^(?:[$]T[ ])/,/^(?:[^][.][*])/,/^(?:[ ][\^;]+[.]K[ ])/,/^(?:[\^;]+[=])/,/^(?:[ ][\^;]+[/][.]K[ ])/,/^(?:[ ][\^;]+[@][:][@][:][ ])/,/^(?:[ ][\^;]+["]K[:][ ])/,/^(?:[ ][\^;]+[.]1[:][ ])/,/^(?:[ ][\^;]+["]K[ ])/,/^(?:[ ][\^;]+[.]1[ ])/,/^(?:[ ][\^;]+[/][$][L][ ])/,/^(?:[ ][.]K[ ])/,/^(?:[ ][\^;]+[/]?[$][L][ ])/,/^(?:[ ][\^;]+[$]P[ ])/,/^(?:[=])/,/^(?:[ ][/][.]K[ ])/,/^(?:[ ][@][:][@][:][ ])/,/^(?:[ ][/]?[@][:][.][K][ ])/,/^(?:[ ]["]K[:][ ])/,/^(?:[ ][.]1[:][ ])/,/^(?:[ ]["]K[ ])/,/^(?:[ ][.]1[ ])/,/^(?:[/]?[@][:])/,/^(?:[ ][/]?[$][L][ ])/,/^(?:[ ][$]P[ ])/,/^(?:[ ]['][']['][ ])/,/^(?:[\^;]+)/,/^(?:[.]["])/,/^(?:["])/,/^(?:[']+)/,/^(?:[.][,]?[ABGDEZ\?\:IKLMNXOPRSTUYF\&W])/,/^(?:[.]*[<])/,/^(?:[.]*[>])/,/^(?:[.]*\])/,/^(?:[.]*\])/,/^(?:!)/,/^(?:[_]&)/,/^(?:&)/,/^(?:(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?)/,/^(?:(ARG|DET|EXP|IM|INF|LIM|LN|LOG|MAX|MIN|MOD|RE|SUP))/,/^(?:(TOKEN)[ ]?)/,/^(?:#?(\d*\.?\d+))/,/^(?:[,]*[?])/,/^(?:[,]*[/])/,/^(?:[,]*#)/,/^(?:[,]([A-Z]))/,/^(?:[A-Z])/,/^(?:[,][=])/,/^(?:[_][8])/,/^(?:[,][ ]?)/,/^(?:[.])/,/^(?:[ ])/,/^(?:$)/,/^(?:.)/],conditions:{radical:{rules:[0,1,2,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84],inclusive:!0},modexp:{rules:[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84],inclusive:!0},INITIAL:{rules:[2,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84],inclusive:!0}}};return oe}();gt.lexer=At;function zt(){this.yy={}}return zt.prototype=gt,gt.Parser=zt,new zt}();typeof Qm!="undefined"&&typeof e!="undefined"&&(e.parser=r,e.Parser=r.Parser,e.parse=function(){return r.parse.apply(r,arguments)},e.main=function(){},typeof t!="undefined"&&Qm.main===t&&e.main(process.argv.slice(1)))}}),k3=nM({"generated/ueb-to-latex.jison.js"(e,t){var r=function(){var n=function(Vt,at,We,ue){for(We=We||{},ue=Vt.length;ue--;We[Vt[ue]]=at);return We},i=[1,15],o=[1,16],a=[1,17],s=[1,37],l=[1,38],c=[1,39],d=[1,40],u=[1,45],p=[1,14],g=[1,49],f=[1,50],y=[1,41],E=[1,42],_=[1,43],w=[1,59],v=[1,44],T=[1,46],M=[1,47],C=[1,48],P=[1,57],F=[1,58],B=[1,60],x=[1,61],L=[1,62],N=[1,63],O=[1,64],z=[1,65],V=[1,66],$=[1,67],G=[1,68],W=[1,69],U=[1,70],D=[1,71],de=[1,72],ge=[1,73],K=[1,74],se=[1,75],H=[1,76],Z=[1,77],ce=[1,78],Re=[1,79],he=[1,80],Ie=[1,81],Ee=[1,82],Be=[1,83],J=[1,84],j=[1,85],pe=[1,86],De=[1,87],Te=[1,88],Se=[1,89],qe=[1,51],st=[1,52],Ve=[1,53],_e=[1,54],gt=[1,55],At=[1,90],zt=[1,56],oe=[5,14,18,19,32,55,56,57],me=[5,10,13,14,15,18,19,32,55,56,57],te=[5,10,13,14,15,17,18,19,21,23,24,26,31,32,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],ae=[1,98],He=[1,99],Ue=[1,100],It=[2,40],it=[10,13,15,17,21,23,24,26,31,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],Cr={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,expression_group:6,delimited_expression:7,level:8,radical:9,LEVEL:10,basic_token:11,bracketed_expression:12,RADICAL_WITH_INDEX:13,CLOSE_RADICAL:14,RADICAL:15,frac:16,OPEN_FRAC:17,OVER:18,CLOSE_FRAC:19,simple_frac:20,NUMBER:21,NUMBER_FRAC_DENOMINATOR:22,NUMBER_FRAC_NUMERATOR_BAD:23,NUMBER_FRAC_DENOMINATOR_BAD:24,geo_token:25,GEO_TOKEN:26,number:27,atom:28,lbracket:29,rbracket:30,OPEN_GROUP:31,CLOSE_GROUP:32,command:33,greek:34,letter:35,comma:36,period:37,colon:38,infinity:39,integral:40,factorial:41,ampersand:42,question_mark:43,bracket:44,space:45,operation:46,comparison:47,ellipsis:48,primes:49,",":50,".":51,"[":52,"{":53,"(":54,"]":55,"}":56,")":57,SPACE:58,COMMAND:59,GREEK:60,CAPITAL_LETTER:61,LETTER:62,PIPE:63,DOUBLE_PIPE:64,"+":65,"-":66,CDOT:67,TIMES:68,"*":69,DIV:70,SLASH:71,PERCENT_OF:72,PERCENT:73,TO:74,ANGLE:75,MEASURED_ANGLE:76,DEGREE:77,CIRCLE:78,PARALLELOGRAM:79,TRIANGLE:80,"=":81,NEQ:82,"<":83,">":84,LEQ:85,APPROX:86,GEQ:87,SIM:88,NSIM:89,PARALLEL:90,PERPENDICULAR:91,CONG:92,NCONG:93,ELLIPSIS:94,COLON:95,INFINITY:96,INTEGRAL:97,FACTORIAL:98,"&":99,PRIMES:100,"?":101,unknown:102,UNKNOWN:103,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",10:"LEVEL",13:"RADICAL_WITH_INDEX",14:"CLOSE_RADICAL",15:"RADICAL",17:"OPEN_FRAC",18:"OVER",19:"CLOSE_FRAC",21:"NUMBER",22:"NUMBER_FRAC_DENOMINATOR",23:"NUMBER_FRAC_NUMERATOR_BAD",24:"NUMBER_FRAC_DENOMINATOR_BAD",26:"GEO_TOKEN",31:"OPEN_GROUP",32:"CLOSE_GROUP",50:",",51:".",52:"[",53:"{",54:"(",55:"]",56:"}",57:")",58:"SPACE",59:"COMMAND",60:"GREEK",61:"CAPITAL_LETTER",62:"LETTER",63:"PIPE",64:"DOUBLE_PIPE",65:"+",66:"-",67:"CDOT",68:"TIMES",69:"*",70:"DIV",71:"SLASH",72:"PERCENT_OF",73:"PERCENT",74:"TO",75:"ANGLE",76:"MEASURED_ANGLE",77:"DEGREE",78:"CIRCLE",79:"PARALLELOGRAM",80:"TRIANGLE",81:"=",82:"NEQ",83:"<",84:">",85:"LEQ",86:"APPROX",87:"GEQ",88:"SIM",89:"NSIM",90:"PARALLEL",91:"PERPENDICULAR",92:"CONG",93:"NCONG",94:"ELLIPSIS",95:"COLON",96:"INFINITY",97:"INTEGRAL",98:"FACTORIAL",99:"&",100:"PRIMES",101:"?",103:"UNKNOWN"},productions_:[0,[3,2],[3,1],[4,3],[4,2],[4,1],[4,2],[4,1],[7,1],[7,1],[8,2],[8,2],[8,2],[9,4],[9,3],[9,3],[9,2],[9,4],[9,3],[9,2],[16,5],[16,4],[16,4],[16,3],[16,2],[20,2],[20,1],[20,1],[25,2],[11,1],[11,1],[11,1],[6,2],[6,2],[6,1],[6,1],[12,3],[12,2],[12,3],[12,2],[27,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[36,1],[37,1],[29,1],[29,1],[29,1],[30,1],[30,1],[30,1],[45,1],[33,1],[34,1],[35,1],[35,1],[44,1],[44,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[48,1],[38,1],[39,1],[40,1],[41,1],[42,1],[49,1],[43,1],[102,1]],performAction:function(Vt,at,We,ue,X,fe,Oe){var we=fe.length-1;switch(X){case 1:return fe[we-1];case 2:return ue.group();case 3:case 36:this.$=ue.group(fe[we-2],fe[we-1],fe[we]);break;case 4:case 6:case 32:case 33:case 37:this.$=ue.group(fe[we-1],fe[we]);break;case 5:case 7:case 34:case 35:this.$=ue.group(fe[we]);break;case 10:case 11:case 12:this.$=ue.basic_level(fe[we-1],ue.group(fe[we]));break;case 13:case 17:this.$=ue.radical(fe[we-1],ue.group(fe[we-2]));break;case 14:case 15:this.$=ue.radical(ue.group(),ue.group(fe[we-1]));break;case 16:this.$=ue.radical(ue.group(),ue.group());break;case 18:this.$=ue.radical(fe[we-1]);break;case 19:this.$=ue.radical(ue.group());break;case 20:this.$=ue.fraction(fe[we-3],fe[we-1]);break;case 21:this.$=ue.fraction(fe[we-2],ue.group());break;case 22:this.$=ue.fraction(ue.group(),fe[we-1]);break;case 23:case 24:this.$=ue.fraction(ue.group(),ue.group());break;case 25:this.$=ue.fraction(ue.group(ue.terminal(ue.to_number(fe[we-1]))),ue.group(ue.terminal(ue.to_number(fe[we]))));break;case 26:this.$=ue.fraction(ue.group(ue.terminal(ue.to_number(fe[we]))),ue.group());break;case 27:this.$=ue.fraction(ue.group(),ue.group(ue.terminal(ue.to_number(fe[$01]))));break;case 28:this.$=ue.geo_token(fe[we]);break;case 38:this.$=ue.group(fe[we-1]);break;case 39:this.$=ue.group();break;case 40:this.$=ue.terminal(ue.to_number(fe[we]));break;case 60:this.$=ue.terminal(",");break;case 61:this.$=ue.terminal(".");break;case 62:this.$=ue.terminal("[");break;case 63:this.$=ue.terminal("\\{");break;case 64:this.$=ue.terminal("(");break;case 65:this.$=ue.terminal("]");break;case 66:this.$=ue.terminal("\\}");break;case 67:this.$=ue.terminal(")");break;case 68:this.$=ue.terminal(" ");break;case 69:this.$=ue.command("\\"+fe[we].trim().toLowerCase());break;case 70:this.$=ue.terminal(ue.greek(fe[we]));break;case 71:this.$=ue.terminal(fe[we].toUpperCase());break;case 72:this.$=ue.terminal(fe[we].toLowerCase());break;case 73:this.$=ue.terminal("|");break;case 74:this.$=ue.terminal("\\|");break;case 75:this.$=ue.terminal("+");break;case 76:this.$=ue.terminal("-");break;case 77:this.$=ue.terminal("\\cdot ");break;case 78:this.$=ue.terminal("\\times ");break;case 79:this.$=ue.terminal("*");break;case 80:this.$=ue.terminal("\\div ");break;case 81:this.$=ue.terminal("/");break;case 82:this.$=ue.terminal("\\%\\operatorname{of}");break;case 83:this.$=ue.terminal("\\%");break;case 84:this.$=ue.terminal("\\to ");break;case 85:this.$=ue.terminal("\\angle ");break;case 86:this.$=ue.terminal("\\measuredangle ");break;case 87:this.$=ue.terminal("\\degree ");break;case 88:this.$=ue.terminal("\\bigcirc ");break;case 89:this.$=ue.terminal("\\parallelogram ");break;case 90:this.$=ue.terminal("\\triangle ");break;case 91:this.$=ue.terminal("=");break;case 92:this.$=ue.terminal("\\neq ");break;case 93:this.$=ue.terminal("<");break;case 94:this.$=ue.terminal(">");break;case 95:this.$=ue.terminal("\\leq ");break;case 96:this.$=ue.terminal("\\approx ");break;case 97:this.$=ue.terminal("\\geq ");break;case 98:this.$=ue.terminal("\\sim ");break;case 99:this.$=ue.terminal("\\nsim ");break;case 100:this.$=ue.terminal("\\parallel ");break;case 101:this.$=ue.terminal("\\perp ");break;case 102:this.$=ue.terminal("\\cong ");break;case 103:this.$=ue.terminal("\\ncong ");break;case 104:this.$=ue.terminal("\\ldots ");break;case 105:this.$=ue.terminal(":");break;case 106:this.$=ue.terminal("\\infty ");break;case 107:this.$=ue.terminal("\\int ");break;case 108:this.$=ue.terminal("!");break;case 109:this.$=ue.terminal("\\&");break;case 110:this.$=ue.primes(fe[we]);break;case 111:this.$=ue.terminal("?");break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:8,9:9,10:i,11:6,12:7,13:o,15:a,16:11,17:s,20:12,21:l,23:c,24:d,25:20,26:u,27:18,28:10,29:13,31:p,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:g,51:f,52:y,53:E,54:_,58:w,59:v,60:T,61:M,62:C,63:P,64:F,65:B,66:x,67:L,68:N,69:O,70:z,71:V,72:$,73:G,74:W,75:U,76:D,77:de,78:ge,79:K,80:se,81:H,82:Z,83:ce,84:Re,85:he,86:Ie,87:Ee,88:Be,89:J,90:j,91:pe,92:De,93:Te,94:Se,95:qe,96:st,97:Ve,98:_e,99:gt,100:At,101:zt},{1:[3]},{5:[1,91]},{1:[2,2]},n(oe,[2,5],{8:8,9:9,7:92,10:i,13:o,15:a}),n(oe,[2,7],{6:4,7:5,11:6,12:7,8:8,9:9,28:10,16:11,20:12,29:13,27:18,33:19,25:20,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,4:93,10:i,13:o,15:a,17:s,21:l,23:c,24:d,26:u,31:p,50:g,51:f,52:y,53:E,54:_,58:w,59:v,60:T,61:M,62:C,63:P,64:F,65:B,66:x,67:L,68:N,69:O,70:z,71:V,72:$,73:G,74:W,75:U,76:D,77:de,78:ge,79:K,80:se,81:H,82:Z,83:ce,84:Re,85:he,86:Ie,87:Ee,88:Be,89:J,90:j,91:pe,92:De,93:Te,94:Se,95:qe,96:st,97:Ve,98:_e,99:gt,100:At,101:zt}),n(me,[2,34],{11:6,12:7,28:10,16:11,20:12,29:13,27:18,33:19,25:20,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,6:94,17:s,21:l,23:c,24:d,26:u,31:p,50:g,51:f,52:y,53:E,54:_,58:w,59:v,60:T,61:M,62:C,63:P,64:F,65:B,66:x,67:L,68:N,69:O,70:z,71:V,72:$,73:G,74:W,75:U,76:D,77:de,78:ge,79:K,80:se,81:H,82:Z,83:ce,84:Re,85:he,86:Ie,87:Ee,88:Be,89:J,90:j,91:pe,92:De,93:Te,94:Se,95:qe,96:st,97:Ve,98:_e,99:gt,100:At,101:zt}),n(me,[2,35],{11:6,12:7,28:10,16:11,20:12,29:13,27:18,33:19,25:20,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,6:95,17:s,21:l,23:c,24:d,26:u,31:p,50:g,51:f,52:y,53:E,54:_,58:w,59:v,60:T,61:M,62:C,63:P,64:F,65:B,66:x,67:L,68:N,69:O,70:z,71:V,72:$,73:G,74:W,75:U,76:D,77:de,78:ge,79:K,80:se,81:H,82:Z,83:ce,84:Re,85:he,86:Ie,87:Ee,88:Be,89:J,90:j,91:pe,92:De,93:Te,94:Se,95:qe,96:st,97:Ve,98:_e,99:gt,100:At,101:zt}),n(te,[2,8]),n(te,[2,9]),n(te,[2,29]),n(te,[2,30]),n(te,[2,31]),{4:96,6:4,7:5,8:8,9:9,10:i,11:6,12:7,13:o,15:a,16:11,17:s,20:12,21:l,23:c,24:d,25:20,26:u,27:18,28:10,29:13,30:97,31:p,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:g,51:f,52:y,53:E,54:_,55:ae,56:He,57:Ue,58:w,59:v,60:T,61:M,62:C,63:P,64:F,65:B,66:x,67:L,68:N,69:O,70:z,71:V,72:$,73:G,74:W,75:U,76:D,77:de,78:ge,79:K,80:se,81:H,82:Z,83:ce,84:Re,85:he,86:Ie,87:Ee,88:Be,89:J,90:j,91:pe,92:De,93:Te,94:Se,95:qe,96:st,97:Ve,98:_e,99:gt,100:At,101:zt},{4:101,6:4,7:5,8:8,9:9,10:i,11:6,12:7,13:o,15:a,16:11,17:s,20:12,21:l,23:c,24:d,25:20,26:u,27:18,28:10,29:13,31:p,32:[1,102],33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:g,51:f,52:y,53:E,54:_,58:w,59:v,60:T,61:M,62:C,63:P,64:F,65:B,66:x,67:L,68:N,69:O,70:z,71:V,72:$,73:G,74:W,75:U,76:D,77:de,78:ge,79:K,80:se,81:H,82:Z,83:ce,84:Re,85:he,86:Ie,87:Ee,88:Be,89:J,90:j,91:pe,92:De,93:Te,94:Se,95:qe,96:st,97:Ve,98:_e,99:gt,100:At,101:zt},{9:105,11:103,12:104,13:o,15:a,16:11,17:s,20:12,21:l,23:c,24:d,25:20,26:u,27:18,28:10,29:13,31:p,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:g,51:f,52:y,53:E,54:_,58:w,59:v,60:T,61:M,62:C,63:P,64:F,65:B,66:x,67:L,68:N,69:O,70:z,71:V,72:$,73:G,74:W,75:U,76:D,77:de,78:ge,79:K,80:se,81:H,82:Z,83:ce,84:Re,85:he,86:Ie,87:Ee,88:Be,89:J,90:j,91:pe,92:De,93:Te,94:Se,95:qe,96:st,97:Ve,98:_e,99:gt,100:At,101:zt},{11:106,12:107,14:[1,108],16:11,17:s,20:12,21:l,23:c,24:d,25:20,26:u,27:18,28:10,29:13,31:p,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:g,51:f,52:y,53:E,54:_,58:w,59:v,60:T,61:M,62:C,63:P,64:F,65:B,66:x,67:L,68:N,69:O,70:z,71:V,72:$,73:G,74:W,75:U,76:D,77:de,78:ge,79:K,80:se,81:H,82:Z,83:ce,84:Re,85:he,86:Ie,87:Ee,88:Be,89:J,90:j,91:pe,92:De,93:Te,94:Se,95:qe,96:st,97:Ve,98:_e,99:gt,100:At,101:zt},{4:109,6:4,7:5,8:8,9:9,10:i,11:6,12:7,13:o,14:[1,110],15:a,16:11,17:s,20:12,21:l,23:c,24:d,25:20,26:u,27:18,28:10,29:13,31:p,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:g,51:f,52:y,53:E,54:_,58:w,59:v,60:T,61:M,62:C,63:P,64:F,65:B,66:x,67:L,68:N,69:O,70:z,71:V,72:$,73:G,74:W,75:U,76:D,77:de,78:ge,79:K,80:se,81:H,82:Z,83:ce,84:Re,85:he,86:Ie,87:Ee,88:Be,89:J,90:j,91:pe,92:De,93:Te,94:Se,95:qe,96:st,97:Ve,98:_e,99:gt,100:At,101:zt},n(te,[2,41]),n(te,[2,42]),n(te,[2,43]),n(te,[2,44]),n(te,[2,45]),n(te,[2,46]),n(te,[2,47]),n(te,[2,48]),n(te,[2,49]),n(te,[2,50]),n(te,[2,51]),n(te,[2,52]),n(te,[2,53]),n(te,[2,54]),n(te,[2,55]),n(te,[2,56]),n(te,[2,57]),n(te,[2,58]),n(te,[2,59]),{4:111,6:4,7:5,8:8,9:9,10:i,11:6,12:7,13:o,15:a,16:11,17:s,18:[1,112],19:[1,113],20:12,21:l,23:c,24:d,25:20,26:u,27:18,28:10,29:13,31:p,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:g,51:f,52:y,53:E,54:_,58:w,59:v,60:T,61:M,62:C,63:P,64:F,65:B,66:x,67:L,68:N,69:O,70:z,71:V,72:$,73:G,74:W,75:U,76:D,77:de,78:ge,79:K,80:se,81:H,82:Z,83:ce,84:Re,85:he,86:Ie,87:Ee,88:Be,89:J,90:j,91:pe,92:De,93:Te,94:Se,95:qe,96:st,97:Ve,98:_e,99:gt,100:At,101:zt},n(te,It,{22:[1,114]}),n(te,[2,26]),n(te,[2,27]),n(it,[2,62]),n(it,[2,63]),n(it,[2,64]),n(te,[2,69]),{21:[1,116],27:115},n(te,[2,70]),n(te,[2,71]),n(te,[2,72]),n(te,[2,60]),n(te,[2,61]),n(te,[2,105]),n(te,[2,106]),n(te,[2,107]),n(te,[2,108]),n(te,[2,109]),n(te,[2,111]),n(te,[2,73]),n(te,[2,74]),n(te,[2,68]),n(te,[2,75]),n(te,[2,76]),n(te,[2,77]),n(te,[2,78]),n(te,[2,79]),n(te,[2,80]),n(te,[2,81]),n(te,[2,82]),n(te,[2,83]),n(te,[2,84]),n(te,[2,85]),n(te,[2,86]),n(te,[2,87]),n(te,[2,88]),n(te,[2,89]),n(te,[2,90]),n(te,[2,91]),n(te,[2,92]),n(te,[2,93]),n(te,[2,94]),n(te,[2,95]),n(te,[2,96]),n(te,[2,97]),n(te,[2,98]),n(te,[2,99]),n(te,[2,100]),n(te,[2,101]),n(te,[2,102]),n(te,[2,103]),n(te,[2,104]),n(te,[2,110]),{1:[2,1]},n(oe,[2,4],{6:4,7:5,11:6,12:7,8:8,9:9,28:10,16:11,20:12,29:13,27:18,33:19,25:20,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,4:117,10:i,13:o,15:a,17:s,21:l,23:c,24:d,26:u,31:p,50:g,51:f,52:y,53:E,54:_,58:w,59:v,60:T,61:M,62:C,63:P,64:F,65:B,66:x,67:L,68:N,69:O,70:z,71:V,72:$,73:G,74:W,75:U,76:D,77:de,78:ge,79:K,80:se,81:H,82:Z,83:ce,84:Re,85:he,86:Ie,87:Ee,88:Be,89:J,90:j,91:pe,92:De,93:Te,94:Se,95:qe,96:st,97:Ve,98:_e,99:gt,100:At,101:zt}),n(oe,[2,6]),n(me,[2,32]),n(me,[2,33]),{30:118,55:ae,56:He,57:Ue},n(te,[2,37]),n(te,[2,65]),n(te,[2,66]),n(te,[2,67]),{32:[1,119]},n(te,[2,39]),n(te,[2,10]),n(te,[2,11]),n(te,[2,12]),{4:120,6:4,7:5,8:8,9:9,10:i,11:6,12:7,13:o,14:[1,121],15:a,16:11,17:s,20:12,21:l,23:c,24:d,25:20,26:u,27:18,28:10,29:13,31:p,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:g,51:f,52:y,53:E,54:_,58:w,59:v,60:T,61:M,62:C,63:P,64:F,65:B,66:x,67:L,68:N,69:O,70:z,71:V,72:$,73:G,74:W,75:U,76:D,77:de,78:ge,79:K,80:se,81:H,82:Z,83:ce,84:Re,85:he,86:Ie,87:Ee,88:Be,89:J,90:j,91:pe,92:De,93:Te,94:Se,95:qe,96:st,97:Ve,98:_e,99:gt,100:At,101:zt},{4:123,6:4,7:5,8:8,9:9,10:i,11:6,12:7,13:o,14:[1,122],15:a,16:11,17:s,20:12,21:l,23:c,24:d,25:20,26:u,27:18,28:10,29:13,31:p,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:g,51:f,52:y,53:E,54:_,58:w,59:v,60:T,61:M,62:C,63:P,64:F,65:B,66:x,67:L,68:N,69:O,70:z,71:V,72:$,73:G,74:W,75:U,76:D,77:de,78:ge,79:K,80:se,81:H,82:Z,83:ce,84:Re,85:he,86:Ie,87:Ee,88:Be,89:J,90:j,91:pe,92:De,93:Te,94:Se,95:qe,96:st,97:Ve,98:_e,99:gt,100:At,101:zt},n(te,[2,16]),{14:[1,124]},n(te,[2,19]),{18:[1,125]},{4:126,6:4,7:5,8:8,9:9,10:i,11:6,12:7,13:o,15:a,16:11,17:s,19:[1,127],20:12,21:l,23:c,24:d,25:20,26:u,27:18,28:10,29:13,31:p,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:g,51:f,52:y,53:E,54:_,58:w,59:v,60:T,61:M,62:C,63:P,64:F,65:B,66:x,67:L,68:N,69:O,70:z,71:V,72:$,73:G,74:W,75:U,76:D,77:de,78:ge,79:K,80:se,81:H,82:Z,83:ce,84:Re,85:he,86:Ie,87:Ee,88:Be,89:J,90:j,91:pe,92:De,93:Te,94:Se,95:qe,96:st,97:Ve,98:_e,99:gt,100:At,101:zt},n(te,[2,24]),n(te,[2,25]),n(te,[2,28]),n(te,It),n(oe,[2,3]),n(te,[2,36]),n(te,[2,38]),{14:[1,128]},n(te,[2,15]),n(te,[2,14]),{14:[1,129]},n(te,[2,18]),{4:130,6:4,7:5,8:8,9:9,10:i,11:6,12:7,13:o,15:a,16:11,17:s,19:[1,131],20:12,21:l,23:c,24:d,25:20,26:u,27:18,28:10,29:13,31:p,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:g,51:f,52:y,53:E,54:_,58:w,59:v,60:T,61:M,62:C,63:P,64:F,65:B,66:x,67:L,68:N,69:O,70:z,71:V,72:$,73:G,74:W,75:U,76:D,77:de,78:ge,79:K,80:se,81:H,82:Z,83:ce,84:Re,85:he,86:Ie,87:Ee,88:Be,89:J,90:j,91:pe,92:De,93:Te,94:Se,95:qe,96:st,97:Ve,98:_e,99:gt,100:At,101:zt},{19:[1,132]},n(te,[2,23]),n(te,[2,13]),n(te,[2,17]),{19:[1,133]},n(te,[2,21]),n(te,[2,22]),n(te,[2,20])],defaultActions:{3:[2,2],91:[2,1]},parseError:function(Vt,at){if(at.recoverable)this.trace(Vt);else{var We=new Error(Vt);throw We.hash=at,We}},parse:function(Vt){var at=this,We=[0],ue=[null],X=[],fe=this.table,Oe="",we=0,Ge=0,Je=0,ut=2,St=1,Lt=X.slice.call(arguments,1),dt=Object.create(this.lexer),ft={yy:{}};for(var kt in this.yy)Object.prototype.hasOwnProperty.call(this.yy,kt)&&(ft.yy[kt]=this.yy[kt]);dt.setInput(Vt,ft.yy),ft.yy.lexer=dt,ft.yy.parser=this,typeof dt.yylloc=="undefined"&&(dt.yylloc={});var Ct=dt.yylloc;X.push(Ct);var ur=dt.options&&dt.options.ranges;typeof ft.yy.parseError=="function"?this.parseError=ft.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var Bt=function(){var Kr;return Kr=dt.lex()||St,typeof Kr!="number"&&(Kr=at.symbols_[Kr]||Kr),Kr},Ot,pr,Gr,kr,Zi,Dn,$r={},Zt,xr,Lr,nn;;){if(Gr=We[We.length-1],this.defaultActions[Gr]?kr=this.defaultActions[Gr]:((Ot===null||typeof Ot=="undefined")&&(Ot=Bt()),kr=fe[Gr]&&fe[Gr][Ot]),typeof kr=="undefined"||!kr.length||!kr[0]){var tn="";nn=[];for(Zt in fe[Gr])this.terminals_[Zt]&&Zt>ut&&nn.push("'"+this.terminals_[Zt]+"'");dt.showPosition?tn="Parse error on line "+(we+1)+`:
`+dt.showPosition()+`
Expecting `+nn.join(", ")+", got '"+(this.terminals_[Ot]||Ot)+"'":tn="Parse error on line "+(we+1)+": Unexpected "+(Ot==St?"end of input":"'"+(this.terminals_[Ot]||Ot)+"'"),this.parseError(tn,{text:dt.match,token:this.terminals_[Ot]||Ot,line:dt.yylineno,loc:Ct,expected:nn})}if(kr[0]instanceof Array&&kr.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Gr+", token: "+Ot);switch(kr[0]){case 1:We.push(Ot),ue.push(dt.yytext),X.push(dt.yylloc),We.push(kr[1]),Ot=null,pr?(Ot=pr,pr=null):(Ge=dt.yyleng,Oe=dt.yytext,we=dt.yylineno,Ct=dt.yylloc,Je>0);break;case 2:if(xr=this.productions_[kr[1]][1],$r.$=ue[ue.length-xr],$r._$={first_line:X[X.length-(xr||1)].first_line,last_line:X[X.length-1].last_line,first_column:X[X.length-(xr||1)].first_column,last_column:X[X.length-1].last_column},ur&&($r._$.range=[X[X.length-(xr||1)].range[0],X[X.length-1].range[1]]),Dn=this.performAction.apply($r,[Oe,Ge,we,ft.yy,kr[1],ue,X].concat(Lt)),typeof Dn!="undefined")return Dn;xr&&(We=We.slice(0,-1*xr*2),ue=ue.slice(0,-1*xr),X=X.slice(0,-1*xr)),We.push(this.productions_[kr[1]][0]),ue.push($r.$),X.push($r._$),Lr=fe[We[We.length-2]][We[We.length-1]],We.push(Lr);break;case 3:return!0}}return!0}},Gt=function(){var Vt={EOF:1,parseError:function(at,We){if(this.yy.parser)this.yy.parser.parseError(at,We);else throw new Error(at)},setInput:function(at,We){return this.yy=We||this.yy||{},this._input=at,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var at=this._input[0];this.yytext+=at,this.yyleng++,this.offset++,this.match+=at,this.matched+=at;var We=at.match(/(?:\r\n?|\n).*/g);return We?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),at},unput:function(at){var We=at.length,ue=at.split(/(?:\r\n?|\n)/g);this._input=at+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-We),this.offset-=We;var X=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),ue.length-1&&(this.yylineno-=ue.length-1);var fe=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:ue?(ue.length===X.length?this.yylloc.first_column:0)+X[X.length-ue.length].length-ue[0].length:this.yylloc.first_column-We},this.options.ranges&&(this.yylloc.range=[fe[0],fe[0]+this.yyleng-We]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(at){this.unput(this.match.slice(at))},pastInput:function(){var at=this.matched.substr(0,this.matched.length-this.match.length);return(at.length>20?"...":"")+at.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var at=this.match;return at.length<20&&(at+=this._input.substr(0,20-at.length)),(at.substr(0,20)+(at.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var at=this.pastInput(),We=new Array(at.length+1).join("-");return at+this.upcomingInput()+`
`+We+"^"},test_match:function(at,We){var ue,X,fe;if(this.options.backtrack_lexer&&(fe={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(fe.yylloc.range=this.yylloc.range.slice(0))),X=at[0].match(/(?:\r\n?|\n).*/g),X&&(this.yylineno+=X.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:X?X[X.length-1].length-X[X.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+at[0].length},this.yytext+=at[0],this.match+=at[0],this.matches=at,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(at[0].length),this.matched+=at[0],ue=this.performAction.call(this,this.yy,this,We,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),ue)return ue;if(this._backtrack){for(var Oe in fe)this[Oe]=fe[Oe];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var at,We,ue,X;this._more||(this.yytext="",this.match="");for(var fe=this._currentRules(),Oe=0;Oe<fe.length;Oe++)if(ue=this._input.match(this.rules[fe[Oe]]),ue&&(!We||ue[0].length>We[0].length)){if(We=ue,X=Oe,this.options.backtrack_lexer){if(at=this.test_match(ue,fe[Oe]),at!==!1)return at;if(this._backtrack){We=!1;continue}else return!1}else if(!this.options.flex)break}return We?(at=this.test_match(We,fe[X]),at!==!1?at:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var at=this.next();return at||this.lex()},begin:function(at){this.conditionStack.push(at)},popState:function(){var at=this.conditionStack.length-1;return at>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(at){return at=this.conditionStack.length-1-Math.abs(at||0),at>=0?this.conditionStack[at]:"INITIAL"},pushState:function(at){this.begin(at)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(at,We,ue,X){switch(ue){case 0:this.begin("captext");return;case 1:return 61;case 2:return this.popState(),61;case 3:return 65;case 4:return 66;case 5:return 67;case 6:return 68;case 7:return 69;case 8:return 70;case 9:return 52;case 10:return 53;case 11:return 54;case 12:return 55;case 13:return 56;case 14:return 57;case 15:return 82;case 16:return 85;case 17:return 86;case 18:return 87;case 19:return 81;case 20:return 83;case 21:return 84;case 22:return 89;case 23:return 88;case 24:return 72;case 25:return 73;case 26:return 74;case 27:return 76;case 28:return 75;case 29:return 78;case 30:return 79;case 31:return 80;case 32:return 93;case 33:return 92;case 34:return 94;case 35:return 13;case 36:return 15;case 37:return 14;case 38:return 10;case 39:return 31;case 40:return 32;case 41:return 97;case 42:return 98;case 43:return 99;case 44:return 17;case 45:return 18;case 46:return 19;case 47:return 90;case 48:return 91;case 49:return 96;case 50:return We.yytext=this.matches[1],21;case 51:return We.yytext=this.matches[1],22;case 52:return We.yytext=this.matches[1],24;case 53:return 71;case 54:return 50;case 55:return 51;case 56:return 100;case 57:return 64;case 58:return 63;case 59:return 95;case 60:return 59;case 61:return 59;case 62:return 26;case 63:return 60;case 64:return 77;case 65:return We.yytext=this.matches[1],61;case 66:return 62;case 67:return;case 68:return 101;case 69:return;case 70:return 58;case 71:return 5;case 72:return 103}},rules:[/^(?:([,][,])(?=[A-Z]))/,/^(?:[A-Z](?=[A-Z]))/,/^(?:[A-Z])/,/^(?:["][6])/,/^(?:["][-])/,/^(?:["][4])/,/^(?:["][8])/,/^(?:["][9])/,/^(?:["][/])/,/^(?:[.][<])/,/^(?:[_][<])/,/^(?:["][<])/,/^(?:[.][>])/,/^(?:[_][>])/,/^(?:["][>])/,/^(?:["][7][@][:])/,/^(?:[_][@][<])/,/^(?:[\^][9])/,/^(?:[_][@][>])/,/^(?:["][7])/,/^(?:[@][<])/,/^(?:[@][>])/,/^(?:[@][9][@][:])/,/^(?:[@][9])/,/^(?:[.][0][O][F][ ]?)/,/^(?:[.][0])/,/^(?:[:][O])/,/^(?:[.][_][\[])/,/^(?:[_][\[])/,/^(?:[$][=])/,/^(?:[$][@][#][D])/,/^(?:[$][#][C])/,/^(?:["][_][9][@][:])/,/^(?:["][_][9])/,/^(?:[4][4][4])/,/^(?:[%][9])/,/^(?:[%])/,/^(?:[\+])/,/^(?:[95]+(?=.))/,/^(?:[<])/,/^(?:[>])/,/^(?:!)/,/^(?:[6])/,/^(?:[@]&)/,/^(?:[(])/,/^(?:[.][/])/,/^(?:[)])/,/^(?:#[L])/,/^(?:#-)/,/^(?:#=)/,/^(?:#([A-J4]+))/,/^(?:[/]([A-J4]+))/,/^(?:[#][/]([A-J4]+))/,/^(?:[_]?[/])/,/^(?:[1])/,/^(?:[4])/,/^(?:[7]+)/,/^(?:[_][\\][_][\\])/,/^(?:[_][\\])/,/^(?:[3])/,/^(?:(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?)/,/^(?:(ARG|DET|EXP|IM|INF|LIM|LN|LOG|MAX|MIN|MOD|RE|SUP))/,/^(?:(TOKEN)[ ]?)/,/^(?:[,]?[.][ABGDEZ\?\:IKLMNXOPRSTUYF\&W])/,/^(?:[^][J])/,/^(?:[,]([A-Z]))/,/^(?:[A-Z])/,/^(?:[,]['])/,/^(?:[8])/,/^(?:[;])/,/^(?:[ ])/,/^(?:$)/,/^(?:.)/],conditions:{captext:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72],inclusive:!0},INITIAL:{rules:[0,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72],inclusive:!0}}};return Vt}();Cr.lexer=Gt;function ar(){this.yy={}}return ar.prototype=Cr,Cr.Parser=ar,new ar}();typeof Qm!="undefined"&&typeof e!="undefined"&&(e.parser=r,e.Parser=r.Parser,e.parse=function(){return r.parse.apply(r,arguments)},e.main=function(){},typeof t!="undefined"&&Qm.main===t&&e.main(process.argv.slice(1)))}}),sM=["abs","ans","arccosh","arccot","arccoth","arccsc","arccsch","arcsec","arcsech","arcsinh","arctanh","binomialdist","boxplot","cdf","ceil","corr","cov","csch","distance","dotplot","erf","floor","gcf","histogram","IndependentTTest","iTTest","ittest","lcm","length","mad","mcd","mcm","mean","median","midpoint","mod","nCr","normaldist","nPr","pdf","poissondist","polygon","quantile","quartile","random","round","sech","sign","signum","sgn","stdDev","stddev","stdDevP","stddevp","stdev","stdevp","tdist","total","TScore","TScore","Tscore","tscore","tscore","TTest","ttest","var","variance","varp"],RC=sM,jj=I3(sM),lM;function _3(e){let t=!1,r=0,n="",i="";for(let o of e)if(o.type==="terminal"&&/[A-Za-z]/.test(o.value))n+=o.value,r++;else break;return i=n.replace(lM,"\\operatorname{$1}"),t=r>0&&i!==n,{modified:t,terminalCount:r,value:i}}function cM(e){return RC.indexOf(e.toLowerCase())!==-1}function FC(e){if(!Array.isArray(e))throw new Error("Operator names must be an array, got "+typeof e);for(let t of e)if(typeof t!="string")throw new Error("Operator names must be strings, found "+typeof t);RC=e,Yj()}function NC(){RC=sM,lM=jj}function Yj(){lM=I3(RC)}function I3(e){let t=e.sort((r,n)=>n.length-r.length||n.localeCompare(r)).join("|");return new RegExp("("+t+")","g")}var A3={};aM(A3,{command:()=>dM,fraction:()=>Qj,greek:()=>Xj,group:()=>pM,level:()=>G3,processPrimes:()=>Jj,radical:()=>Zj,terminal:()=>M3,typeform:()=>L3});function M3(e){return{type:"terminal",value:e}}function dM(e){return{type:"command",value:e}}function Xj(e){return{type:"greek",value:e}}function G3(e){return{subscript:e._,superscript:e["^"],type:"level"}}function Jj(e,t){let r=[],n=e.match(/'+/);if(n!==null){let i=n[0].length;for(let o=0;o<i;o++)r.push(dM("\\prime"))}return pM(r,t)}function Qj(e,t){return{type:"fraction",numerator:e,denominator:t}}function L3(e,t){return{name:e,type:"typeform",value:t}}function Zj(e,t){return{type:"radical",index:t,radicand:e}}function pM(...e){return Array.prototype.concat.apply([],e)}var IC={"~":"\\ ","\\,":"\\ ","\\:":"\\ ","\\;":"\\ ","\\!":"\\ "},h3={"\\Vert":"\\|","\\ge":"\\geq","\\le":"\\leq","\\vert":"|"},eY={"\\space":!0};function bu(e){let t=[];for(let r=0;r<e.length;r++){let n=e[r];switch(n.type){case"command":let i=n.value.slice(1).trim();h3.hasOwnProperty(n.value)?t.push(dM(h3[n.value])):cM(i)?t.push(L3("operator_name",tY(i))):eY[n.value]||t.push(n);break;case"level":let o={subscript:n.subscript&&n.subscript.length>0?bu(n.subscript):void 0,superscript:n.superscript&&n.superscript.length>0?bu(n.superscript):void 0,type:n.type};(o.subscript||o.superscript)&&t.push(o);break;case"fraction":t.push({denominator:bu(n.denominator),numerator:bu(n.numerator),type:n.type});break;case"radical":t.push({index:n.index?bu(n.index):void 0,radicand:bu(n.radicand),type:n.type});break;case"terminal":rY(e.slice(r))?(t.push({type:"command",value:"\\ldots"}),r+=2):t.push({type:n.type,value:IC.hasOwnProperty(n.value)?IC[n.value]:n.value});break;case"typeform":t.push(n);break;case"greek":t.push({type:n.type,value:IC.hasOwnProperty(n.value)?IC[n.value]:n.value});break;default:throw new Error(`Unexpected item:
`+JSON.stringify({group:e,item:n}))}}return t}function tY(e){let t=[];for(let r of e)t.push(M3(r));return t}function rY(e){let t=0;for(let r=0;r<Math.min(3,e.length);r++){let n=e[r];n.type==="terminal"&&n.value==="."&&t++}return t===3}function uM(e){if(!e.hash)throw e;return{_diagnostic:{expected:e.hash.expected,message:e.message,text:e.hash.text,token:e.hash.token},location:e.hash.loc}}var P3=$j();P3.parser.yy=A3;function V3(e){try{return{isError:!1,value:P3.parser.parse(e)}}catch(t){return{isError:!0,error:uM(t)}}}function oY(e){return e.isError}function iY(e,t){return oY(e)?e:{isError:!1,value:t(e.value)}}function Zm(e,t){let r=iY(e,t);return e.warnings&&(r.warnings=e.warnings),r}function nY(e){return Zm(V3(e),t=>fY(bu(t)))}var g3={"!":"&","*":"@#",",":", ","/":"_/",":":"_3","<":' "K ',"=":" .K ",">":" .1 ","?":"_8","[":"@(","\\ ":" ","\\%":"@0","\\&":"_&","\\,":" ","\\infty":",=","\\int":"!","\\{":".(","\\|":"\\\\","\\}":".)","]":"@)","|":"\\"};function XA(e){return/^[a-z]$/.test(e.value)?e.value.toUpperCase():/^[A-Z]$/.test(e.value)?","+e.value:/^[0-9.]$/.test(e.value)||/^[+\-()]$/.test(e.value)?e.value:g3.hasOwnProperty(e.value)?g3[e.value]:"[terminal: "+e.value+"]"}var m3={"\\Vert":"\\\\","\\angle":"$[ ","\\approx":" @:@: ","\\bigcirc":"$C ","\\cong":" @:.K ","\\cdot":"*","\\degree":"~.*","\\div":"./","\\ge":" .1: ","\\geq":" .1: ","\\langle":"..(","\\ldots":" ''' ","\\le":' "K: ',"\\leq":' "K: ',"\\measuredangle":"M$[ ","\\ncong":" /@:.K ","\\ne":" /.K ","\\neq":" /.K ","\\nparallel":" /$L ","\\nsim":"/@:","\\parallel":" $L ","\\parallelogram":"$G ","\\perp":" $P ","\\prime":"'","\\prod":".,P","\\rangle":"..)","\\sim":"@:","\\sum":".,S","\\times":"@*","\\to":" $O ","\\triangle":"$T ","\\vert":"\\"},f3={"\\Alpha":".,A","\\Beta":".,B","\\Chi":".,&","\\Delta":".,D","\\Epsilon":".,E","\\Eta":".,:","\\Gamma":".,G","\\Iota":".,I","\\Kappa":".,K","\\Lambda":".,L","\\Mu":".,M","\\Nu":".,N","\\Omega":".,W","\\Omicron":".,O","\\Phi":".,F","\\Pi":".,P","\\Psi":".,Y","\\Rho":".,R","\\Sigma":".,S","\\Tau":".,T","\\Theta":".,?","\\Upsilon":".,U","\\Xi":".,X","\\Zeta":".,Z","\\alpha":".A","\\beta":".B","\\chi":".&","\\delta":".D","\\epsilon":".E","\\eta":".:","\\gamma":".G","\\iota":".I","\\kappa":".K","\\lambda":".L","\\mu":".M","\\nu":".N","\\omega":".W","\\omicron":".O","\\phi":".F","\\pi":".P","\\psi":".Y","\\rho":".R","\\sigma":".S","\\tau":".T","\\theta":".?","\\upsilon":".U","\\xi":".X","\\zeta":".Z"};function b3(e){return m3.hasOwnProperty(e.value)?m3[e.value]:e.value.slice(1).toUpperCase()+" "}function aY(e){return f3.hasOwnProperty(e.value)?f3[e.value]:e.value.slice(1).toUpperCase()+" "}function sY(e){return e.value==="\\space"}function lY(e,t){return e.isStartOfLine&&/^-?$/.test(t)||/\s-?$/.test(t)||e.wasFraction}function cY(e){return e.value==="\\sum"||e.value==="\\prod"}function dY(e,t){if(t>=e.length)return!1;let r=e[t];if(r.type==="terminal"){if(/^[0-9]$/.test(r.value))return!0;if(r.value!=="."||t+1>=e.length)return!1;if(r=e[t+1],r.type==="terminal")return/^[0-9]$/.test(r.value)}return!1}function xu(e,t){let r="",n=e.levelIndicator,i=0,o=!1;for(let a=0;a<t.length;a++){dY(t,a)&&(n===""&&/[A-Z]$/.test(r)?r+=Zc(n):lY(e,r)&&(r+="#"));let s=t[a],l=a<t.length-1?t[a+1]:null;switch(s.type!=="level"&&n!==e.levelIndicator&&(JA(s)?n="":(e.wasModifiedExpression&&e.levelIndicator===""?e=Js(e,{wasModifiedExpression:!1}):r+=Zc(e.levelIndicator),n=e.levelIndicator)),s.type){case"terminal":!e.wasModifiedExpression&&n!==""&&JA(s)?r+=" "+Zc(n)+XA(s).trim()+" ":r+=XA(s),s.value==="."&&l&&(l.type==="terminal"&&/^[^_\d,]/.test(XA(l))||l.type==="greek")&&(r+='"'),e=Js(e,{wasFraction:!1,wasRomanCommand:!1});break;case"command":if(!sY(s)){let g=cY(s);g&&(r+='"'),!g&&n!==""&&JA(s)?r+=" "+Zc(n)+b3(s).trim()+" ":r+=b3(s),e=Js(e,{wasFraction:!1,wasModifiedExpression:g,wasRomanCommand:!0})}break;case"greek":r+=aY(s),e=Js(e,{wasFraction:!1});break;case"fraction":let c=pY(e,s);r+=c.value,i=Math.max(i,c.fractionLevel),e=Js(e,{wasFraction:!0,wasRomanCommand:!1});break;case"radical":let d=uY(e,s);r+=d.value,i=Math.max(i,d.fractionLevel),e=Js(e,{wasFraction:!1,wasRomanCommand:!1});break;case"level":!e.wasModifiedExpression&&e.wasRomanCommand?(o=/\s$/.test(r),o&&(r=r.replace(/\s$/,""))):o=!1;let u=r.length>0&&/[A-Za-z]/.test(r[r.length-1])===!0,p=hY(e,u,o,s);r+=p.value,n=p.levelIndicator,e=Js(e,{wasFraction:!1,wasRomanCommand:!1});break;case"typeform":r+=xu(e,s.value).value,s.name==="operator_name"&&(r+=" "),e=Js(e,{wasFraction:!1,wasModifiedExpression:!1,wasRomanCommand:!1});break}}return{fractionLevel:i,levelIndicator:n,value:r}}function pY(e,t){e=Js(e,{isStartOfLine:!1});let r=xu(e,t.numerator),n=xu(e,t.denominator),i=Math.max(r.fractionLevel,n.fractionLevel),o="";for(let s=0;s<i;s++)o+=",";let a=o+"?"+r.value;return r.levelIndicator!==e.levelIndicator&&(a+=Zc(e.levelIndicator)),/\.$/.test(r.value)&&(a+='"'),a+=o+"/"+n.value,n.levelIndicator!==e.levelIndicator&&(a+=Zc(e.levelIndicator)),/\.$/.test(n.value)&&(a+='"'),a+=o+"#",{fractionLevel:i+1,value:a}}function uY(e,t){let r=e.radicalLevel,n="",i="";for(let a=0;a<r;a++)i+=".";if(t.index){n+=i+"<";let a=xu(Js(e,{isStartOfLine:!1}),t.index);n+=a.value,/\.$/.test(a.value)&&(n+='"'),a.levelIndicator!==e.levelIndicator&&(n+=Zc(e.levelIndicator)),n+=">"}else n+=i+">";let o=xu(Js(e,{isStartOfLine:!1,radicalLevel:r+1}),t.radicand);return n+=o.value,/\.$/.test(o.value)&&(n+='"'),o.levelIndicator!==e.levelIndicator&&(n+=Zc(e.levelIndicator)),n+=i+"]",{fractionLevel:o.fractionLevel,value:n}}function hY(e,t,r,n){let i=e.levelIndicator,o="",a=gY(n.superscript);if(o+=a,n.subscript){e.wasModifiedExpression&&(o+="%"),i=e.levelIndicator+";";let s=xu(Js(e,{isStartOfLine:!1,levelIndicator:i}),n.subscript);t&&/^[0-9]*(\.|\,)?[0-9]+$/.test(s.value)&&i.length<=1?i=e.levelIndicator:!e.wasModifiedExpression&&n.subscript[0]&&n.subscript[0].type!=="level"&&(o+=Zc(i)),o+=s.value,/\.$/.test(s.value)&&(o+='"')}if(n.superscript){e.wasModifiedExpression&&(o+="<"),i=e.levelIndicator+"^";let s=xu(Js(e,{isStartOfLine:!1,levelIndicator:i}),n.superscript.slice(a.length));!e.wasModifiedExpression&&n.superscript[0]&&n.superscript[0].type!=="level"&&s.value!==""&&(o+=Zc(i)),o+=s.value,/\.$/.test(s.value)&&(o+='"')}return e.wasModifiedExpression?o+="]":e.wasRomanCommand&&r&&(o+=" ",i=i.slice(0,i.length-1)),{levelIndicator:i,value:o}}function gY(e){let t="";if(e)for(let r of e)if(r.type==="command"&&r.value==="\\prime")t+="'";else break;return t}function Zc(e){return e||'"'}function mY(){return{isStartOfLine:!0,levelIndicator:"",radicalLevel:0,wasFraction:!1,wasModifiedExpression:!1,wasRomanCommand:!1}}function Js(e,t){return Jm(Jm({},e),t)}function JA(e){return e.type==="terminal"||e.type==="command"?/^<|>|\=|\\leq?|\\geq?|\\neq?$/.test(e.value):!1}function fY(e){let t=mY();return xu(t,e).value}function bY(e){return Zm(V3(e),t=>IY(bu(t)))}var y3={"!":"6","(":'"<',")":'">',"*":'"9',"+":'"6',",":"1","-":'"-',".":"4","/":"_/",":":"3","<":"@<","=":'"7',">":"@>","?":"8","[":".<","\\ ":" ","\\%":".0","\\&":"@&","\\,":" ","\\infty":"#=","\\int":"!","\\{":"_<","\\|":"_\\_\\","\\}":"_>","]":".>","|":"_\\"};function yY(e,t,r){let n="",i=t.value,o=r&&r.type==="terminal"?r.value:"";return O3(i,e)&&(n+=";"),/^[\D]/.test(i)&&(e=ed(e,{wasNumber:!1})),/^[a-z]$/.test(i)?e.capsLock?(e=ed(e,{capsLock:!1}),n+=",'"+i.toUpperCase()):n+=i.toUpperCase():/^[A-Z]$/.test(i)?e.capsLock?n+=i:/[A-Z]/.test(o)?(e=ed(e,{capsLock:!0}),n+=",,"+i):n+=","+i:(e=ed(e,{capsLock:!1}),/^[0-9.]$/.test(i)?n+=SY(i):y3.hasOwnProperty(i)?n+=y3[i]:n+="[terminal: "+i+"]"),{value:n,ctx:e}}var x3={"\\Vert":"_\\_\\","\\angle":"_{","\\approx":"^9","\\bigcirc":"$=","\\cdot":'"4',"\\cong":'"_9',"\\degree":"~J","\\div":'"/',"\\ge":"_@>","\\geq":"_@>","\\langle":"@<","\\ldots":"444","\\le":"_@<","\\leq":"_@<","\\measuredangle":"._{","\\ncong":'"_9@:',"\\ne":'"7@:',"\\neq":'"7@:',"\\nsim":"@9@:","\\parallel":"#L","\\parallelogram":"$@#D","\\perp":"#-","\\prime":"7","\\prod":",.P","\\rangle":"@>","\\sim":"@9","\\sum":",.S","\\times":'"8',"\\to":":O","\\triangle":"$#C","\\vert":"_\\"},w3={"\\Alpha":",.A","\\Beta":",.B","\\Chi":",.&","\\Delta":",.D","\\Epsilon":",.E","\\Eta":",.:","\\Gamma":",.G","\\Iota":",.I","\\Kappa":",.K","\\Lambda":",.L","\\Mu":",.M","\\Nu":",.N","\\Omega":",.W","\\Omicron":",.O","\\Phi":",.F","\\Pi":",.P","\\Psi":",.Y","\\Rho":",.R","\\Sigma":",.S","\\Tau":",.T","\\Theta":",.?","\\Upsilon":",.U","\\Xi":",.X","\\Zeta":",.Z","\\alpha":".A","\\beta":".B","\\chi":".&","\\delta":".D","\\epsilon":".E","\\eta":".:","\\gamma":".G","\\iota":".I","\\kappa":".K","\\lambda":".L","\\mu":".M","\\nu":".N","\\omega":".W","\\omicron":".O","\\phi":".F","\\pi":".P","\\psi":".Y","\\rho":".R","\\sigma":".S","\\tau":".T","\\theta":".?","\\upsilon":".U","\\xi":".X","\\zeta":".Z"};function xY(e,t){let r;return x3.hasOwnProperty(e.value)?r=x3[e.value]:r=e.value.slice(1).toUpperCase()+" ",O3(r,t)&&(r=";"+r),/^[\D]/.test(r)&&(t=ed(t,{wasNumber:!1})),{value:r,ctx:t}}function wY(e){return w3.hasOwnProperty(e.value)?w3[e.value]:e.value.slice(1).toUpperCase()+" "}function vY(e){return e.value==="\\space"}function CY(e,t){if(t<e.length){let r=e[t];if(r.type==="terminal"){if(/^\d$/.test(r.value))return!0;if(r.value!=="."||t+1>=e.length)return!1;if(r=e[t+1],r.type==="terminal")return/^\d$/.test(r.value)}}return!1}function SY(e){let t="";for(let r of e)r===","?t+="1":r==="."?t+="4":r==="0"?t+="J":t+=String.fromCharCode(64+Number(r));return t}function wu(e,t){let r,n,i="",o=!0;for(let a=0;a<t.length;a++){CY(t,a)?(e=ed(e,{wasNumber:!0}),o&&(i+="#",o=!1)):o=!0;let s=t[a];switch(s.type){case"terminal":let l=a<t.length-1?t[a+1]:void 0;r=yY(e,s,l),e=r.ctx,i+=r.value,i[i.length-1]===" "&&(o=!0);break;case"command":vY(s)||(n=xY(s,e),e=n.ctx,i+=n.value,i[i.length-1]===" "&&(o=!0));break;case"greek":i+=wY(s),i[i.length-1]===" "&&(o=!0);break;case"fraction":let c=EY(e,s);i+=c.value,e=c.ctx,o=!1;break;case"radical":let d=TY(e,s);i+=d.value,o=!0;break;case"level":let u=DY(e,s);i+=u.value,e=u.ctx,o=!0;break;case"typeform":let p=wu(e,s.value).value;i+=p,/(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?/.test(p)&&(i+=" ");break}}return{ctx:e,value:i}}function O3(e,t){return t.wasNumber&&/^[A-Ja-j]/.test(e)}function EY(e,t){let r=wu(e,t.numerator),n=wu(e,t.denominator),i;return eM(r.value)&&eM(n.value)?(e=ed(e,{wasNumber:!0}),i=r.value+"/"+n.value.slice(1)):(e=ed(e,{wasNumber:!1}),i="("+r.value+"./"+n.value+")"),{ctx:e,value:i}}function eM(e){return/^\#[A-J41]+$/.test(e)}function TY(e,t){let r="%",n=wu(e,t.radicand);if(t.index){let i=wu(e,pM(G3({"^":t.index})));r+=i.value,/\#[A-J]$/.test(i.value)&&/^[A-J]/.test(n.value)&&(r+=";")}return r+=n.value+"+",{ctx:e,value:r}}function DY(e,t){let r="",n=kY(t.superscript);r+=n;let i;if(t.subscript){let o=wu(e,t.subscript);C3(t.subscript,o.value,0)?i="<"+v3(o.value)+">":i=o.value,e=ed(e,{wasNumber:o.ctx.wasNumber}),i!==""&&(r+="5"+i)}if(t.superscript){let o=wu(e,t.superscript.slice(n.length));C3(t.superscript,o.value,n.length)?i="<"+v3(o.value)+">":i=o.value,e=ed(e,{wasNumber:o.ctx.wasNumber}),(n===""||i!=="")&&(r+="9"+i)}return{ctx:e,value:r}}function v3(e){return/^;/.test(e)?e.slice(1):e}function kY(e){let t="";if(e)for(let r of e)if(r.type==="command"&&r.value==="\\prime")t+="7";else break;return t}function C3(e,t,r){let n=e[0],i=(t.match(/\</g)||[]).length,o=/^["|\.|_]?\</.test(t),a=(t.match(/\>/g)||[]).length,s=/["|\.|_]?\>$/.test(t);return!eM(t)&&e.length-r>1&&i===0&&a===0||i>0&&a>0&&(!o||!s)||i>1||a>1||n&&n.type==="typeform"}function _Y(){return{capsLock:!1,wasNumber:!1}}function ed(e,t){return Jm(Jm({},e),t)}function IY(e){let t=_Y();return wu(t,e).value}var tM={};aM(tM,{baseline:()=>VY,command:()=>MY,comparison:()=>PY,expression:()=>BY,fraction:()=>RY,geo_token:()=>GY,greek:()=>zY,group:()=>qY,level:()=>hM,level_with_comparison:()=>LY,modified_expression:()=>FY,primes:()=>OY,radical:()=>NY,simple_subscript:()=>UY,terminal:()=>AY});function AY(e){return{type:"terminal",value:e}}function MY(e){return{type:"command",value:"\\"+e.trim()+" "}}function GY(e){return{type:"geo_token",index:e}}var R3={'"K':"<",'"K:':"\\leq ",$L:"\\parallel ",$O:"\\to ",$P:"\\perp ",".1":">",".1:":"\\geq ",".K":"=","@:.K":"\\cong ","/@:.K":"\\ncong ","@:@:":"\\approx","/$L":"\\nparallel ","/.K":"\\neq ","=":"=","@:":"\\sim ","/@:":"\\nsim "};function LY(e){let t=/[\^;]+/.exec(e),r=t?t.toString():"",n=e.slice(hM.length);return{type:"level_with_comparison",level:r,value:R3[n]}}function PY(e){return{type:"comparison",value:R3[e]}}function hM(e){return{type:"level",value:e}}function VY(){return hM("")}function OY(e){return{type:"primes",value:e}}function RY(e,t){return{type:"fraction",numerator:e,denominator:t}}function FY(e,t,r){return{type:"modified_expression",expression:e,under:t,over:r}}function NY(e,t){return{type:"radical",value:e,index:t}}function BY(e){return{type:"expression",value:e}}function UY(e,t){return{type:"simple_subscript",base:e,subscript:t}}var S3={".&":"\\chi",".,&":"\\Chi",".,:":"\\Eta",".,?":"\\Theta",".,A":"\\Alpha",".,B":"\\Beta",".,D":"\\Delta",".,E":"\\Epsilon",".,F":"\\Phi",".,G":"\\Gamma",".,I":"\\Iota",".,K":"\\Kappa",".,L":"\\Lambda",".,M":"\\Mu",".,N":"\\Nu",".,O":"\\Omicron",".,P":"\\prod",".,R":"\\Rho",".,S":"\\sum",".,T":"\\Tau",".,U":"\\Upsilon",".,W":"\\Omega",".,X":"\\Xi",".,Y":"\\Psi",".,Z":"\\Zeta",".:":"\\eta",".?":"\\theta",".A":"\\alpha",".B":"\\beta",".D":"\\delta",".E":"\\epsilon",".F":"\\phi",".G":"\\gamma",".I":"\\iota",".K":"\\kappa",".L":"\\lambda",".M":"\\mu",".N":"\\nu",".O":"\\omicron",".P":"\\pi",".R":"\\rho",".S":"\\sigma",".T":"\\tau",".U":"\\upsilon",".W":"\\omega",".X":"\\xi",".Y":"\\psi",".Z":"\\zeta"};function zY(e){if(S3.hasOwnProperty(e))return S3[e]+" ";throw new Error("Unknown Greek letter")}function qY(...e){return Array.prototype.concat.apply([],e)}var gM=D3(),PC=gM.parser.lexer,ag=Object.create(PC),HY=ag,Ox=gM.parser.terminals_,Pi=gM.parser.symbols_;ag.setInput=function(e,t){this.delimiterStack=[],this.outputQueue=[],this.canAcceptPrimes=!1,PC.setInput.call(this,e,t)},ag.lex=function(){let e=-1;if(!this)return e;if(this.outputQueue.length)return this.outputQueue.shift();let t=PC.lex.call(this);for(;Ox[t]==="UNKNOWN"||!this.canAcceptPrimes&&Ox[t]==="PRIMES";)this.warn(),t=PC.lex.call(this);this.canAcceptPrimes=!0;let r,n,i=this.delimiterStack?this.delimiterStack[this.delimiterStack.length-1]:-1;switch(Ox[t]){case"OPEN_FRAC":case"OPEN_MODEXP":this.delimiterStack.push(t),this.canAcceptPrimes=!1;break;case"RADICAL_INDEX":i===Pi.RADICAL_INDEX&&(this.delimiterStack.pop(),this.pushCloseTokens(i)),this.delimiterStack.push(t),this.canAcceptPrimes=!1;break;case"OPEN_RADICAL":i===Pi.RADICAL_INDEX&&this.delimiterStack.pop(),this.delimiterStack.push(t),this.canAcceptPrimes=!1;break;case"SLASH":for(r=!1;this.delimiterStack.length;)if(n=this.delimiterStack.pop()||-1,n===Pi.OPEN_FRAC){r=!0;break}else this.pushCloseTokens(n);r||this.pushOpenTokens(t),this.delimiterStack.push(t),this.canAcceptPrimes=!1;break;case"CLOSE_FRAC":for(r=!1;this.delimiterStack.length;)if(n=this.delimiterStack.pop()||-1,n===Pi.SLASH){r=!0;break}else if(n===Pi.OPEN_FRAC){this.addMissingToken(Pi.SLASH),r=!0;break}else this.pushCloseTokens(n);if(!r)return this.warn(),this.canAcceptPrimes=!1,this.lex();break;case"CLOSE_RADICAL":for(r=!1;this.delimiterStack.length;)if(n=this.delimiterStack.pop()||-1,n===Pi.OPEN_RADICAL){r=!0;break}else if(n===Pi.RADICAL_INDEX){r=!0,this.addMissingToken(Pi.OPEN_RADICAL);break}else this.pushCloseTokens(n);r||this.pushOpenTokens(t);break;case"CLOSE_MODEXP":for(r=!1;this.delimiterStack.length;)if(n=this.delimiterStack.pop()||-1,n===Pi.OPEN_MODEXP){r=!0;break}else this.pushCloseTokens(n);r||this.pushOpenTokens(t);break;case"EOF":for(;this.delimiterStack.length;)n=this.delimiterStack.pop()||-1,this.pushCloseTokens(n);break}return this.outputQueue.push(t),e=this.outputQueue.shift()||-1,e},ag.warn=function(){this.yylloc&&this.yy.warnings.push({location:this.yylloc})},ag.addMissingToken=function(e){this.outputQueue.push(e),this.warn()},ag.pushCloseTokens=function(e){switch(Ox[e]){case"OPEN_FRAC":this.addMissingToken(Pi.SLASH),this.addMissingToken(Pi.CLOSE_FRAC);break;case"SLASH":this.addMissingToken(Pi.CLOSE_FRAC);break;case"RADICAL_INDEX":this.addMissingToken(Pi.OPEN_RADICAL),this.addMissingToken(Pi.CLOSE_RADICAL);break;case"OPEN_RADICAL":this.addMissingToken(Pi.CLOSE_RADICAL);break;case"OPEN_MODEXP":this.addMissingToken(Pi.CLOSE_MODEXP);break}},ag.pushOpenTokens=function(e){switch(Ox[e]){case"SLASH":this.addMissingToken(Pi.OPEN_FRAC);break;case"CLOSE_FRAC":this.addMissingToken(Pi.OPEN_FRAC),this.addMissingToken(Pi.SLASH);break;case"CLOSE_RADICAL":this.addMissingToken(Pi.OPEN_RADICAL);break;case"CLOSE_MODEXP":this.addMissingToken(Pi.OPEN_MODEXP);break}};var KY=D3();function WY(e,t){t||(t={});let r=KY.parser,n=Object.create(r);n.yy=tM,n.yy.warnOrError=o=>{n.parseError(o,{recoverable:!1})};let i=Object.create(r);i.yy=Jm({warnings:[]},tM),i.yy.warnOrError=o=>{i.yy.warnings.push(o)},i.lexer=HY,t.strict?r=n:r=i;try{return{isError:!1,value:r.parse(e),warnings:r.yy.warnings||[]}}catch(o){return{error:uM(o),isError:!0}}}function yu(e,t){let r="",n=t,i="",o=!1,a="",s="",l=$Y(e);for(let c=0;c<e.length;c++){let d=e[c],u=c+1<e.length?e[c+1]:null;switch(d.type){case"terminal":let p=_3(e.slice(c));p.value!==""?(r+=p.value,c+=p.terminalCount-1,o=o||p.modified):d.value===" "?(o?(i=a,r+=Vx(n,i),n=i):r+="\\ ",o=!1):(l[c]===GC?r+="\\left":l[c]===rM&&(r+="\\right"),r+=d.value);break;case"comparison":i="",r+=Vx(n,i),n=i,o=!1,r+=d.value;break;case"level_with_comparison":r+=Vx(n,d.level),n=d.level,o=!1,r+=d.value;break;case"command":let g=d.value.slice(1).trim();u&&u.type==="terminal"&&/[a-z]/.test(u.value)?(r+=g,o=!1):cM(g)?(r+="\\operatorname{"+g+"}",o=!0):(r+=d.value,o=!0),a=n;break;case"expression":r+=d.value;break;case"fraction":r+=JY(d.numerator,d.denominator,n);break;case"geo_token":r+="\\token{"+d.index.value+"}";break;case"modified_expression":r+=yu(d.expression,n)+" ",d.under&&(r+="_{"+yu(d.under,n)+"}"),d.over&&(r+="^{"+yu(d.over,n)+"}");break;case"radical":r+="\\sqrt",d.index&&(r+="["+yu(d.index,n)+"]"),r+="{"+yu(d.value,n)+"}";break;case"simple_subscript":n===""?(r+=d.base.value+"_{"+d.subscript.value+"}",d.base.type==="command"&&(o=!0,a=n)):r+=d.base.value+d.subscript.value;break;case"level":r+=Vx(n,d.value,s),n=d.value,d.value==="^"&&s!==""&&(s="");break;case"primes":u&&u.type==="level"&&u.value===";"?s=d.value:n!==""?(r+=Array(d.value.length+1).join("\\prime "),s=""):(r+=d.value,s="");break}}return r+=Vx(n,t)+s,r.replace(/([^\\])( )$/,"$1")}var GC=1,rM=-1,AC=0,QA=2;function $Y(e){let t=[],r=[];for(let n=0;n<e.length;n++){let i=e[n];if(jY(i))t.push({direction:GC,index:n}),r.push(AC);else if(YY(i)){for(;t.length&&t[t.length-1].direction===QA;)t.pop();if(t.length){let o=t.pop();if(o){let a=o.index;r[a]=GC,r.push(rM)}}else r.push(AC)}else if(XY(i))if(t.length&&t[t.length-1].direction===QA){let o=t.pop();if(o){let a=o.index;r[a]=GC,r.push(rM)}}else t.push({direction:QA,index:n}),r.push(AC);else r.push(AC)}return r}function jY(e){return e.type==="terminal"?/^(\\langle |\[|\(|\\{)$/.test(e.value):!1}function YY(e){return e.type==="terminal"?/^(\\rangle |\]|\)|\\})$/.test(e.value):!1}function XY(e){return e.type==="terminal"?/^(\\\||\|)$/.test(e.value):!1}function JY(e,t,r){return"\\frac{"+yu(e,r)+"}{"+yu(t,r)+"}"}function Vx(e,t,r){let n="",i,o,a,s=Math.max(e.length,t.length);for(i=0;i<s&&e[i]===t[i];i++);for(o=e.length-1;o>=i;o--)n+="}";for(a=i;a<t.length;a++)t[a]==="^"&&(r&&(n+=r),n+="^{"),t[a]===";"&&(n+="_{");return n}function QY(e){return yu(e,"")}function ZY(e,t){return t&&t.operatorNames?FC(t.operatorNames):NC(),Zm(WY(e,t),QY)}var mM=k3(),VC=mM.parser.lexer,sg=Object.create(VC),eX=sg,OC=mM.parser.terminals_,Cn=mM.parser.symbols_;sg.setInput=function(e,t){this.delimiterStack=[],this.outputQueue=[],VC.setInput.call(this,e,t)},sg.lex=function(){let e=-1;if(this.outputQueue.length)return this.outputQueue.shift();let t=VC.lex.call(this);for(;OC[t]==="UNKNOWN";)this.warn(),t=VC.lex.call(this);let r,n,i=this.delimiterStack?this.delimiterStack[this.delimiterStack.length-1]:-1;switch(OC[t]){case"OPEN_FRAC":this.delimiterStack.push(t);break;case"OPEN_GROUP":this.delimiterStack.push(t);break;case"RADICAL_WITH_INDEX":i===Cn.RADICAL_WITH_INDEX&&(this.delimiterStack.pop(),this.pushCloseTokens(i)),this.delimiterStack.push(t);break;case"RADICAL":i===Cn.RADICAL_WITH_INDEX&&this.delimiterStack.pop(),this.delimiterStack.push(t);break;case"OVER":for(r=!1;this.delimiterStack.length;)if(n=this.delimiterStack.pop()||-1,n===Cn.OPEN_FRAC){r=!0;break}else this.pushCloseTokens(n);r||this.pushOpenTokens(t),this.delimiterStack.push(t);break;case"CLOSE_FRAC":for(r=!1;this.delimiterStack.length;)if(n=this.delimiterStack.pop()||-1,n===Cn.OVER){r=!0;break}else if(n===Cn.OPEN_FRAC){this.outputQueue.push(Cn.OVER),r=!0;break}else this.pushCloseTokens(n);r||this.pushOpenTokens(t);break;case"CLOSE_GROUP":for(r=!1;this.delimiterStack.length;)if(n=this.delimiterStack.pop()||-1,n===Cn.OPEN_GROUP){r=!0;break}else this.pushCloseTokens(n);r||this.pushOpenTokens(t);break;case"CLOSE_RADICAL":for(r=!1;this.delimiterStack.length;)if(n=this.delimiterStack.pop()||-1,n===Cn.RADICAL||n===Cn.RADICAL_WITH_INDEX){r=!0;break}else this.pushCloseTokens(n);r||this.pushOpenTokens(t);break;case"EOF":for(;this.delimiterStack.length;)n=this.delimiterStack.pop()||-1,this.pushCloseTokens(n);break}return this.outputQueue.push(t),e=this.outputQueue.shift()||-1,e},sg.warn=function(){this.yylloc&&this.yy.warnings.push({location:this.yylloc})},sg.addMissingToken=function(e){this.outputQueue.push(e),this.warn()},sg.pushCloseTokens=function(e){switch(OC[e]){case"OPEN_FRAC":this.addMissingToken(Cn.OVER),this.addMissingToken(Cn.CLOSE_FRAC);break;case"OVER":this.addMissingToken(Cn.CLOSE_FRAC);break;case"OPEN_GROUP":this.addMissingToken(Cn.CLOSE_GROUP);break;case"RADICAL_WITH_INDEX":case"RADICAL":this.addMissingToken(Cn.CLOSE_RADICAL);break}},sg.pushOpenTokens=function(e){switch(OC[e]){case"OVER":this.addMissingToken(Cn.OPEN_FRAC);break;case"CLOSE_FRAC":this.addMissingToken(Cn.OPEN_FRAC),this.addMissingToken(Cn.OVER);break;case"CLOSE_GROUP":this.addMissingToken(Cn.OPEN_GROUP);break;case"CLOSE_RADICAL":this.addMissingToken(Cn.RADICAL);break}};var oM={};aM(oM,{basic_level:()=>oX,bracketed_level:()=>iX,command:()=>rX,expression:()=>cX,fraction:()=>aX,geo_token:()=>lX,greek:()=>pX,group:()=>dX,primes:()=>nX,radical:()=>sX,terminal:()=>tX,to_number:()=>uX});function tX(e){return{type:"terminal",value:e}}function rX(e){return{type:"command",value:e}}function oX(e,t){return{type:"basic_level",level:e,value:t}}function iX(e,t,r,n){return{type:"bracketed_level",level:e,lbrack:t,value:r,rbrack:n}}function nX(e){return{type:"primes",value:e.length>0?Array(e.length+1).join("'"):""}}function aX(e,t){return{type:"fraction",numerator:e,denominator:t}}function sX(e,t){return{type:"radical",value:e,index:t}}function lX(e){return{type:"geo_token",index:e}}function cX(e){return{type:"expression",value:e}}function dX(...e){return Array.prototype.concat.apply([],e)}var E3={",.&":"\\Chi",",.:":"\\Eta",",.?":"\\Theta",",.A":"\\Alpha",",.B":"\\Beta",",.D":"\\Delta",",.E":"\\Epsilon",",.F":"\\Phi",",.G":"\\Gamma",",.I":"\\Iota",",.K":"\\Kappa",",.L":"\\Lambda",",.M":"\\Mu",",.N":"\\Nu",",.O":"\\Omicron",",.P":"\\prod",",.R":"\\Rho",",.S":"\\sum",",.T":"\\Tau",",.U":"\\Upsilon",",.W":"\\Omega",",.X":"\\Xi",",.Y":"\\Psi",",.Z":"\\Zeta",".&":"\\chi",".:":"\\eta",".?":"\\theta",".A":"\\alpha",".B":"\\beta",".D":"\\delta",".E":"\\epsilon",".F":"\\phi",".G":"\\gamma",".I":"\\iota",".K":"\\kappa",".L":"\\lambda",".M":"\\mu",".N":"\\nu",".O":"\\omicron",".P":"\\pi",".R":"\\rho",".S":"\\sigma",".T":"\\tau",".U":"\\upsilon",".W":"\\omega",".X":"\\xi",".Y":"\\psi",".Z":"\\zeta"};function pX(e){if(E3.hasOwnProperty(e))return E3[e]+" ";throw new Error("Unknown Greek letter")}function uX(e){let t="";for(let r of e)r==="4"?t+=".":r==="J"?t+="0":t+=r.charCodeAt(0)-64;return t}var hX=k3();function gX(e,t){t||(t={});let r=hX.parser,n=Object.create(r);n.yy=oM;let i=Object.create(r);i.yy=Jm({warnings:[]},oM),i.lexer=eX,t.strict?r=n:r=i;try{return{isError:!1,value:r.parse(e),warnings:r.yy.warnings||[]}}catch(o){return{error:uM(o),isError:!0}}}function ng(e,t){let r="",n=!1,i="",o=mX(e);for(let a=0;a<e.length;a++){let s=e[a],l=a+1<e.length?e[a+1]:null;switch(s.type){case"terminal":let c=_3(e.slice(a));c.value!==""?(r+=c.value,a+=c.terminalCount-1):s.value===" "&&!n?r+="\\ ":(o[a]===LC?r+="\\left":o[a]===iM&&(r+="\\right"),r+=s.value),n=!1;break;case"command":let d=s.value.slice(1).trim();l&&l.type==="terminal"&&/[a-z]/.test(l.value)?(r+=d,n=!1):cM(d)?(r+="\\operatorname{"+d+"}",n=!0):(r+=s.value,n=!0);break;case"expression":r+=s.value;break;case"fraction":r+=xX(s.numerator,s.denominator);break;case"radical":r+="\\sqrt",s.index&&(r+="["+ng(s.index)+"]"),r+="{"+ng(s.value)+"}";break;case"geo_token":r+="\\token{"+s.index.value+"}";break;case"basic_level":r+=wX(s.level,s.value,i),s.level==="9"&&(i="");break;case"bracketed_level":r+=vX(s.level,s.lbrack,s.value,s.rbrack,i),s.level==="9"&&(i="");break;case"primes":l&&(l.type==="basic_level"||l.type==="bracketed_level")&&l.level==="5"?i=s.value:t&&t!==""?(r+=Array(s.value.length+1).join("\\prime "),i=""):(r+=s.value,i="");break}}return r+=i,r.replace(/([^\\])( )$/,"$1")}var LC=1,iM=-1,MC=0,ZA=2;function mX(e){let t=[],r=[];for(let n=0;n<e.length;n++){let i=e[n];if(fX(i))t.push({direction:LC,index:n}),r.push(MC);else if(bX(i)){for(;t.length&&t[t.length-1].direction===ZA;)t.pop();if(t.length){let o=t.pop();if(o){let a=o.index;r[a]=LC,r.push(iM)}}else r.push(MC)}else if(yX(i))if(t.length&&t[t.length-1].direction===ZA){let o=t.pop();if(o){let a=o.index;r[a]=LC,r.push(iM)}}else t.push({direction:ZA,index:n}),r.push(MC);else r.push(MC)}return r}function fX(e){return e.type==="terminal"?/^(\\langle |\[|\(|\\{)$/.test(e.value):!1}function bX(e){return e.type==="terminal"?/^(\\rangle |\]|\)|\\})$/.test(e.value):!1}function yX(e){return e.type==="terminal"?/^(\\\||\|)$/.test(e.value):!1}function xX(e,t){return"\\frac{"+ng(e)+"}{"+ng(t)+"}"}function wX(e,t,r){let n="",i="{"+ng(t,e)+"}";return e==="9"?n+=r+"^"+i:e==="5"&&(n+="_"+i),n}function vX(e,t,r,n,i){let o="",a="{"+t+ng(r,e)+n+"}";return e==="9"?o+=i+"^"+a:e==="5"&&(o+="_"+a),o}var CX=ng;function SX(e,t){return t&&t.operatorNames?FC(t.operatorNames):NC(),Zm(gX(e,t),r=>CX(r,""))}var F3=` A1B'K2L@CIF/MSP"E3H9O6R^DJG>NTQ,*5<-U8V.%[$+X!&;:4\\0Z7(_?W]#Y)=`,N3=10240;function EX(e){return String.fromCharCode(N3+e)}function TX(e){return e.charCodeAt(0)-N3}function DX(e){return F3[e]}function kX(e){return F3.indexOf(e)}function _X(e){let t="";for(let r of e)t+=EX(kX(r));return t}function B3(e){let t="";for(let r of e)t+=DX(TX(r));return t}function IX(e){return B3(e).replace(/[@-^]/g,t=>String.fromCharCode(t.charCodeAt(0)+32))}function AX(e){let t="";if(e)for(let r of e){let n=r.charCodeAt(0);96<=n&&n<=127&&(n-=32,r=String.fromCharCode(n)),32<=n&&n<=95&&(r=_X(r),n=r.charCodeAt(0)),10305<=n&&n<=10495&&(n=10240+(n-1024)%64,r=String.fromCharCode(n)),10240<=n&&n<=10304?t+=r:t+="⠀"}return t}function MX(e){for(let t=0;t<e.length;t++){let r=e.charCodeAt(t);if(r<10240||r>10304)return!1}return!0}function U3(e){if(!MX(e))throw new Error("EncodingError: Expected input to be six-dot unicode braille characters.")}function fM(e,t){return U3(e),ZY(sa.toBrailleAscii(e),t)}function lp(e,t){return t&&t.operatorNames?FC(t.operatorNames):NC(),Zm(nY(e),sa.coerceToSixDotCells)}function bM(e,t){return U3(e),SX(sa.toBrailleAscii(e),t)}function cp(e,t){return t&&t.operatorNames?FC(t.operatorNames):NC(),Zm(bY(e),sa.coerceToSixDotCells)}var sa={coerceToSixDotCells:AX,toBrailleAscii:B3,toExpandedBrailleAscii:IX},GX="1.0.3",z3=1,q3=2,H3=4,K3=8,zC=15,W3=12,$3=3,j3=1,Y3=2,X3=3,J3=4,lg=5,ef=6;function vu(e,t,r){let n=[],i=e.length;if(r===lg)for(let o=0;o<i;o+=2){let a=t.mapX(e[o]),s=t.mapY(e[o+1]);n.push(a,s)}else if(r===ef)for(let o=0;o<i;o+=2){let a=t.mapX(e[o+1]),s=t.mapY(e[o]);n.push(a,s)}else if(r===j3)for(let o=0;o<e.length;o+=2){let a=e[o],s=e[o+1],l=t.mapX(s*Math.cos(a)),c=t.mapY(s*Math.sin(a));n.push(l,c)}else if(r===Y3)for(let o=0;o<e.length;o+=2){let a=e[o],s=e[o+1];s<0&&(s=0);let l=t.mapX(s*Math.cos(a)),c=t.mapY(s*Math.sin(a));n.push(l,c)}else if(r===X3)for(let o=0;o<e.length;o+=2){let a=e[o]*Math.PI/180,s=e[o+1],l=t.mapX(s*Math.cos(a)),c=t.mapY(s*Math.sin(a));n.push(l,c)}else if(r===J3)for(let o=0;o<e.length;o+=2){let a=e[o]*Math.PI/180,s=e[o+1];s<0&&(s=0);let l=t.mapX(s*Math.cos(a)),c=t.mapY(s*Math.sin(a));n.push(l,c)}return n}function Q3(e,t){return yM(e,t,zC,!0)}function Z3(e,t){return LX(e,t)}function BC(e,t,r,n){let i=[],o,a,s,l;n?(a=e[0],s=e[1],o=2,l=t(a,s),l&&i.push(a,s)):(a=e[e.length-2],s=e[e.length-1],o=0,l=t(a,s));for(let c=o;c<e.length;c+=2){let d=a,u=s,p=l;a=e[c],s=e[c+1],l=t(a,s),!(!l&&!p)&&(l&&p&&i.push(a,s),l&&!p&&(i.push(...r(a,s,d,u)),i.push(a,s)),!l&&p&&i.push(...r(d,u,a,s)))}return i}function UC(e,t,r,n){let i=[[]],o=0,a,s,l,c;s=e[0],l=e[1],a=2,c=t(s,l),c&&i[o].push(s,l);for(let d=a;d<e.length;d+=2){let u=s,p=l,g=c;s=e[d],l=e[d+1],c=t(s,l),!(!c&&!g)&&(c&&g&&i[o].push(s,l),c&&!g&&(i[o].push(...r(s,l,u,p)),i[o].push(s,l)),!c&&g&&(i[o].push(...r(u,p,s,l)),o++,i[o]=[]))}return i.filter(d=>d.length>0)}var eN=e=>function(t,r){return t>=e},tN=e=>function(t,r){return t<=e},rN=e=>function(t,r){return r>=e},oN=e=>function(t,r){return r<=e},iN=e=>function(t,r,n,i){let o=i-r;return[e,r+o*(e-t)/(n-t)]},nN=e=>function(t,r,n,i){let o=i-r;return[e,r+o*(e-t)/(n-t)]},aN=e=>function(t,r,n,i){let o=n-t;return[t+o*(e-r)/(i-r),e]},sN=e=>function(t,r,n,i){let o=n-t;return[t+o*(e-r)/(i-r),e]};function yM(e,t,r,n){let i=e;return r&H3&&(i=BC(e,eN(t.xmin),iN(t.xmin),n)),r&q3&&(i=BC(i,rN(t.ymin),aN(t.ymin),n)),r&K3&&(i=BC(i,tN(t.xmax),nN(t.xmax),n)),r&z3&&(i=BC(i,oN(t.ymax),sN(t.ymax),n)),i}function LX(e,t,r,n){let i=[e];return i=__dcg_shared_module_exports__.t(i.map(o=>UC(o,eN(t.xmin),iN(t.xmin))),!0),i=__dcg_shared_module_exports__.t(i.map(o=>UC(o,rN(t.ymin),aN(t.ymin))),!0),i=__dcg_shared_module_exports__.t(i.map(o=>UC(o,tN(t.xmax),nN(t.xmax))),!0),i=__dcg_shared_module_exports__.t(i.map(o=>UC(o,oN(t.ymax),sN(t.ymax))),!0),i}function lN(e,t,r){let n=[],i=e[0],o=i+r,a=[];n.push(a);for(let s=0;s<e.length;s+=2){let l=e[s],c=e[s+1];if(c<0&&(c=0),l>=o){for(a=[],n.push(a),i=e[s-2],o=i;l>=o;)o+=r;s-=4}else a.push(l,c)}if(t===0)for(let s=0;s<n.length;s++)n[s].push(0,0);else{let s=r/16,l=t;for(let c=0;c<n.length;c++){let d=n[c];i=d[0],o=d[d.length-2];for(let u=o;u>i;u-=s)d.push(u,l);d.push(i,l)}}return n}function xM(e,t){return e=e.slice(),e.push(e[e.length-2],t),e.push(e[0],t),[e]}function Rx(e,t,r){switch(e){case 1:return ef;case 8:case 5:case 2:return lg;case 6:return r.degreeMode?t?J3:X3:t?Y3:j3}}function io(e,t){if(/^\s*(\-|\+)?([0-9]+(\.[0-9]+)?)\s*$/.test(e))return parseFloat(e);let r=__dcg_shared_module_exports__.Nb(__dcg_shared_module_exports__.qc);return r.trigAngleMultiplier=new __dcg_shared_module_exports__.pc(t?Math.PI/180:1),+__dcg_shared_module_exports__.Wc(e).tryGetConcreteTree(__dcg_shared_module_exports__.Xc,r).asValue()}var sS={};__dcg_shared_module_exports__.d(sS,{CLCalculator:()=>ON,Label:()=>__dcg_shared_module_exports__.qa,applyDiff:()=>FN,applyLocalizationMap:()=>HN,blankGeometryCalculatorState:()=>xQ,blankGraphingCalculatorState:()=>yQ,builtInFrame:()=>mQ,calculateDiff:()=>UN,colorHelpers:()=>__dcg_shared_module_exports__.Td,context:()=>gQ,expressionParser:()=>WM,extractLocalizationMap:()=>qN,formatLatex:()=>tB,migrateGeoStateToCalcState:()=>ug,migrateToLatest:()=>dc,numberToDecimalString:()=>__dcg_shared_module_exports__.ce,numberToLatex:()=>__dcg_shared_module_exports__.be,parseNodes:()=>oB,parser:()=>uQ,policies:()=>bQ,replaceIdentifierWithLatex:()=>PM,treeQueries:()=>hQ,types:()=>fQ});var wM={enabled:!1,latex:"",hoveredImage:"",depressedImage:""},qC={center:"\\left(0,0\\right)",angle:"0",width:"10",height:"10",opacity:"1",clickableInfo:wM,description:"",draggable:!1},cN=R({folderId:"",hidden:!1,secret:!1,readonly:!1,disableGraphInteractions:!1,foreground:!1,name:""},qC);function HC(e){return ie(R(R({},cN),e),{clickableInfo:R(R({},wM),e.clickableInfo)})}function dN(e){let t=__dcg_shared_module_exports__.md(cN,e),r=__dcg_shared_module_exports__.nd(wM,e.clickableInfo);return r===void 0?delete t.clickableInfo:t.clickableInfo=r,t}function vM(e){return __dcg_shared_module_exports__.td(e,qC)}function KC(e){return ie(R({type:"image",id:e.id},vM(e)),{guid:"",index:0,color:"",shouldGraph:e.hidden,showPoints:!1})}var pN={folderId:"",secret:!1,readonly:!1},dg={latex:"",color:"",hidden:!1,values:[],points:!0,lines:!1,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineOpacity:"",lineWidth:"",pointOpacity:"",pointSize:"",disableGraphInteractions:!1};function WC(e){let t=(e.columns||[]).map(r=>R(R({},dg),r));return ie(R(R({},pN),e),{columns:t})}function uN(e){return e=ie(R({},e),{columns:e.columns.map(t=>__dcg_shared_module_exports__.md(dg,t))}),__dcg_shared_module_exports__.md(pN,e)}function $C(e){return{type:"table",id:e.id,columns:e.columns.map(t=>ie(R({},t),{tableId:e.id})),regression:e.regression}}var of={handlerLatex:"",minStepLatex:"",open:!1,playing:!1};function jC(e){return{type:"ticker",id:e.id,handlerLatex:e.handlerLatex,minStepLatex:e.minStepLatex,shouldGraph:!1}}function hN(e){return __dcg_shared_module_exports__.nd(of,e)}function YC(e){return R(R({},of),e)}function CM(){return{type:"folder",id:__dcg_shared_module_exports__.xd,title:"geometry",secret:!0}}var nf={version:_l,randomSeed:"",graph:{viewport:{xmin:-10,ymin:-13.25,xmax:10,ymax:13.25},showGrid:!1,product:"geometry-calculator",showXAxis:!1,showYAxis:!1,degreeMode:!0},expressions:{list:[CM(),{id:"1",type:"expression"}]}};function FX(e){typeof e.min=="number"&&(e.min=""+e.min),typeof e.max=="number"&&(e.max=""+e.max),typeof e.step=="number"&&(e.step=""+e.step)}function NX(e){e.slider&&FX(e.slider),typeof e.id!="string"&&(e.id=""+e.id)}function BX(e,t){let r=UX(e)+1,n={},i,o;for(let a of e)if(NX(a),a.type==="folder")i=a.id,n[a.id]&&(a.id=""+r,r+=1),o=a.id,n[a.id]=!0,a.hasOwnProperty("folderId")&&delete a.folderId;else{if(i!==void 0&&a.folderId===i?a.folderId=o:(a.folderId&&(a.folderId=""),i=void 0,o=void 0),a.type==="table"&&Array.isArray(a.columns))for(let s of a.columns)n[s.id]&&(s.id=""+r,r+=1),n[s.id]=!0;n[a.id]&&(a.id=""+r,r+=1),n[a.id]=!0}t==="geometry-calculator"&&!n[__dcg_shared_module_exports__.xd]&&e.push(CM())}function gN(e,t){let r=parseFloat(t);return r!==Math.floor(r)?e:Math.max(e,r)}function UX(e){let t=0;for(let r of e)if(t=gN(t,r.id),r.type==="table"&&Array.isArray(r.column))for(let n of r.columns)gN(t,n.id);return t}function XC(e){var t,r;let n=__dcg_shared_module_exports__.Jc(e),i=n.graph&&n.graph.product,o=n.expressions.list;return Array.isArray(o)&&BX(o,i),(t=n.graph)!=null&&t.complex&&(r=n.graph)!=null&&r.degreeMode&&(n.graph.degreeMode=!1),n}var SM={NONE:"NONE",POSITIVE:"POSITIVE",BOTH:"BOTH"},zX={expression:!0,table:!0,image:!0,folder:!0,text:!0};function qX(e){if(e.type){if(zX.hasOwnProperty(e.type))return e.type;throw new Error("Invalid item type: '"+e.type+"'.")}return e.text!==void 0?"text":e.columns!==void 0||e.headings!==void 0?"table":"expression"}function JC(e){return e.replace(/\\(total|length|mean|median|quantile|stdev|stddev|stdDev|stdevp|stddevp|stdDevP|var|variance|cov|corr|ceil|floor|round|abs|mod|lcm|mcm|mcd|nCr|nPr|signum|sign|arcsinh|arccosh|arctanh|arccsch|arcsech|arccoth|arccsc|arcsec|arccot)/g,"\\operatorname{$1}")}function HX(e){let t={};for(let r in e)e.hasOwnProperty(r)&&(r==="latex"?t[r]=JC(e[r]):r==="values"?t[r]=e[r].map(JC):t[r]=e[r]);return t}function KX(e){let t=qX(e),r={},n;switch(t){case"expression":for(n in e)e.hasOwnProperty(n)&&(n==="latex"?r[n]=JC(e[n]):r[n]=e[n]);return r.type=t,r;case"table":for(n in e)e.hasOwnProperty(n)&&(n==="columns"?r[n]=e[n].map(HX):r[n]=e[n]);return r.type=t,r;case"image":for(n in e)e.hasOwnProperty(n)&&(n==="width"||n==="height"||n==="x"||n==="y"?r[n]=JC(e[n]):r[n]=e[n]);return r.type=t,r;case"text":case"folder":for(n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r.type=t,r}}var mN={none:SM.NONE,both:SM.BOTH,positive:SM.POSITIVE};function WX(e){let t={};for(let r in e)e.hasOwnProperty(r)&&(r==="xAxisArrows"||r==="yAxisArrows"||(t[r]=e[r]));return t.xAxisArrowMode=mN[e.xAxisArrows||"none"],t.yAxisArrowMode=mN[e.yAxisArrows||"none"],t}function fN(e){if(e.version)throw new Error("Unexpected version: "+e.version);let t={};return t.graph=WX(e.graph),t.expressions={list:e.expressions.list.map(KX)},t.version=0,t}function QC(e){return e.replace(/\\(sech|csch)/g,"\\operatorname{$1}")}function $X(e){let t={};for(let r in e)e.hasOwnProperty(r)&&(r==="latex"?t[r]=QC(e[r]):r==="values"?t[r]=e[r].map(QC):t[r]=e[r]);return t}function jX(e){let t=e.type,r={},n;switch(t){case"expression":for(n in e)e.hasOwnProperty(n)&&(n==="latex"?r[n]=QC(e[n]):r[n]=e[n]);return r;case"table":for(n in e)e.hasOwnProperty(n)&&(n==="columns"?r[n]=e[n].map($X):r[n]=e[n]);return r;case"image":for(n in e)e.hasOwnProperty(n)&&(n==="width"||n==="height"||n==="x"||n==="y"?r[n]=QC(e[n]):r[n]=e[n]);return r;case"text":case"folder":for(n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r;default:throw new Error("Unexpected expression type: "+t)}}function bN(e){if(e.version)throw new Error("Unexpected version: "+e.version);let t={};return t.graph=e.graph,t.expressions={list:e.expressions.list.map(jX)},t.version=1,t}var YX=2,XX="#C0504D",JX="#4F81BD",QX="#9BBB59",ZX="#8064A2",eJ="#F79646",tJ="#000000";function yN(e){switch(e){case XX:return __dcg_shared_module_exports__.Rd.RED;case JX:return __dcg_shared_module_exports__.Rd.BLUE;case QX:return __dcg_shared_module_exports__.Rd.GREEN;case ZX:return __dcg_shared_module_exports__.Rd.PURPLE;case eJ:return __dcg_shared_module_exports__.Rd.ORANGE;case tJ:return __dcg_shared_module_exports__.Rd.BLACK;default:return e}}function rJ(e){let t={};for(let r in e)e.hasOwnProperty(r)&&(r==="color"?t[r]=yN(e[r]):t[r]=e[r]);return t}function oJ(e){let t=e.type,r={},n;switch(t){case"expression":for(n in e)e.hasOwnProperty(n)&&(n==="color"?r[n]=yN(e[n]):r[n]=e[n]);return r;case"table":for(n in e)e.hasOwnProperty(n)&&(n==="columns"?r[n]=e[n].map(rJ):r[n]=e[n]);return r;case"image":case"text":case"folder":for(n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r;default:throw new Error("Unexpected expression type: "+t)}}function xN(e){if(e.version>1)throw new Error("Unexpected version: "+e.version);let t={};return t.graph=e.graph,t.expressions={list:e.expressions.list.map(oJ)},t.version=YX,t}function EM(e){if(typeof e=="string")return e;if(e===void 0)return"";let t=e+"";return t=t.replace(/1e\+?([-\d]+)/,"10^{$1}"),t=t.replace(/([-\d\.]+)e\+?([-\d]+)/,"$1\\cdot 10^{$2}"),t}function iJ(e){let t=e.type,r={},n;switch(t){case"expression":for(n in e)e.hasOwnProperty(n)&&(n==="sliderMax"||n==="sliderMin"||n==="sliderInterval"?r[n]=EM(e[n]):n==="domain"?r[n]={max:EM(e[n].max),min:EM(e[n].min)}:r[n]=e[n]);return r.hasOwnProperty("sliderMin")&&r.sliderInterval===void 0&&(r.sliderInterval=""),r;case"image":case"table":case"text":case"folder":for(n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r;default:throw new Error("Unexpected expression type: "+t)}}function wN(e){if(e.version>2)throw new Error("Unexpected version: "+e.version);let t={};return t.graph=e.graph,t.expressions={list:e.expressions.list.map(iJ)},t.version=3,t}function vN(e){switch(e){case"point":return"POINT";case"cross":return"CROSS";case"open":return"OPEN";case"normal":return"SOLID";case"dashed":return"DASHED";case"dotted":return"DOTTED";default:return e}}function nJ(e){let t={};for(let r in e)e.hasOwnProperty(r)&&(r==="style"?t[r]=vN(e[r]):t[r]=e[r]);return t}function aJ(e){let t=e.type,r={},n;switch(t){case"expression":for(n in e)e.hasOwnProperty(n)&&(n==="style"?r[n]=vN(e[n]):r[n]=e[n]);return r;case"table":for(n in e)e.hasOwnProperty(n)&&(n==="columns"?r[n]=e[n].map(nJ):r[n]=e[n]);return r;case"image":case"text":case"folder":for(n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r;default:throw new Error("Unexpected expression type: "+t)}}function CN(e){if(e.version!==3)throw new Error("Unexpected version: "+e.version);let t={};return t.graph=e.graph,t.expressions={list:e.expressions.list.map(aJ)},t.version=4,t}function sJ(e){let t={},r;for(let n in e)if(e.hasOwnProperty(n))switch(r=e[n],n){case"showAxes":t.showXAxis=r,t.showYAxis=r;break;case"showLabels":t.xAxisNumbers=r,t.yAxisNumbers=r,t.polarNumbers=r;break;case"labelXMode":t.xAxisStep=r==="pi"?Math.PI:0;break;case"labelYMode":t.yAxisStep=r==="pi"?Math.PI:0;break;default:t[n]=r}return t}function lJ(e){let t={};for(let r in e)e.hasOwnProperty(r)&&(r==="showPoints"||r==="showLine"||(t[r]=e[r]));return(e.showPoints!==void 0||e.showLine!==void 0)&&(e.showPoints&&e.showLine?t.columnMode="POINTS_AND_LINES":e.showPoints?t.columnMode="POINTS":e.showLine?t.columnMode="LINES":(t.hidden=!0,t.columnMode="POINTS")),t}function cJ(e){let t=e.type,r={},n;switch(t){case"expression":e.hidden===void 0?e.hasOwnProperty("graphed")?r.hidden=!e.graphed:e.hasOwnProperty("userRequestedGraphing")?r.hidden=e.userRequestedGraphing==="never":r.hidden=!1:r.hidden=e.hidden;for(n in e)if(e.hasOwnProperty(n)&&!(n==="graphed"||n==="userRequestedGraphing"||n==="hidden")&&n!=="slider"){if(n==="color"){typeof e.color=="object"?r.color=e.color.value:r.color=e.color;continue}if(n==="style"){r.style=e.style==="normal"?"SOLID":e.style;continue}if(n==="sliderInterval"){r.sliderInterval=e.sliderInterval==="undefined"?"":e.sliderInterval;continue}r[n]=e[n]}return r;case"table":if(e.headings||e.columns){let i=e.headings?e.headings:e.columns;if(r.columns=i.map(lJ),e.rows)for(let o=0;o<r.columns.length;o++){let a=r.columns[o];a.values=[];for(let s=0;s<e.rows.length;s++)a.values.push(e.rows[s][o])}}for(n in e)e.hasOwnProperty(n)&&(n==="rows"||n==="headings"||n==="columns"||(r[n]=e[n]));return r;case"image":case"text":case"folder":for(n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r;default:throw new Error("Unexpected expression type: "+t)}}function SN(e){if(e.version!==4)throw new Error("Unexpected version: "+e.version);return{version:5,graph:sJ(e.graph),expressions:{list:e.expressions.list.map(cJ)}}}var pJ=6;function uJ(e){return e.length<2?!1:e[0]==="`"&&e[e.length-1]==="`"}function hJ(e){if(uJ(e))return{raw:e,parts:[e]};let t="({"+["[a-zA-Z][0-9]*","[a-zA-Z]_[a-zA-Z0-9]+","[a-zA-Z]_\\{[a-zA-Z0-9]+\\}"].join("})|({")+"})",r=new RegExp(t,"g"),n=[],i=0,o=0,a;for(;a=r.exec(e);){o=a.index,o>i&&n.push(e.substr(i,o-i));let s=a[0],l=s.replace(/[{}\$]/g,"").replace(/^([a-zA-Z])([0-9]+)$/,"$1_$2");n.push({symbol:l,str:s}),i=a.index+s.length}return i<e.length&&n.push(e.substr(i)),{raw:e,parts:n}}function gJ(e){let t={};for(let r in e)if(e.hasOwnProperty(r)&&r!=="style")if(r==="values"&&(t[r]=e[r].map(n=>n?""+n:"")),r==="columnMode"&&!e.hasOwnProperty("points")&&!e.hasOwnProperty("lines"))switch(e[r]){case"LINES":t.points=!1,t.lines=!0;break;case"POINTS_AND_LINES":t.points=!0,t.lines=!0;break;default:t.points=!0,t.lines=!1}else t[r]=e[r];return t.hasOwnProperty("pointStyle")||(t.pointStyle="POINT"),t.hasOwnProperty("lineStyle")||(t.lineStyle="SOLID"),t.id=""+t.id,t}var EN={sliderMin:"min",sliderMax:"max",sliderInterval:"step",sliderHardMin:"hardMin",sliderHardMax:"hardMax",sliderAnimationPeriod:"animationPeriod",sliderLoopMode:"loopMode",sliderPlayDirection:"playDirection",sliderIsPlaying:"isPlaying"};function mJ(e){let t=hJ(e),r="";return __dcg_shared_module_exports__.g(t.parts,n=>{r+=typeof n=="object"&&n.str?"$"+n.str:n}),r}function fJ(e,t){let r=e.latex.split("=");if(r.length!==2)return;let n=io(r[1],t);if(!isFinite(n))return;let i=e.slider.hardMin?io(e.slider.min||"-10",t):void 0,o=e.slider.hardMax?io(e.slider.max||"10",t):void 0,a=e.slider.step?io(e.slider.step,t):void 0,s=__dcg_shared_module_exports__.yc({target:n,step:a,hardMin:i,hardMax:o});s.min||(delete e.slider.hardMin,delete e.slider.min),s.max||(delete e.slider.hardMax,delete e.slider.max),s.step||delete e.slider.step}function bJ(e,t,r,n){let i=e.type,o={},a;switch(i){case"folder":for(a in e)e.hasOwnProperty(a)&&(a==="memberIds"||(o[a]=e[a]));break;case"expression":for(a in e)if(e.hasOwnProperty(a)){if(a==="style"&&!e.hasOwnProperty("pointStyle")&&!e.hasOwnProperty("lineStyle")){let s=e[a];__dcg_shared_module_exports__.l(["POINT","OPEN","CROSS"],s)?(o.pointStyle=s,o.lineStyle="SOLID"):__dcg_shared_module_exports__.l(["SOLID","DASHED","DOTTED"],s)?(o.pointStyle="POINT",o.lineStyle=s):(o.pointStyle="POINT",o.lineStyle="SOLID");continue}EN.hasOwnProperty(a)?(o.slider=o.slider||{},o.slider[EN[a]]=e[a]):o[a]=e[a],e.label&&(o.label=mJ(e.label))}o.latex&&o.slider&&!o.slider.isPlaying&&fJ(o,n),o.hasOwnProperty("fillOpacity")||(o.fillOpacity=.4),o.label===!1&&(o.label=""),o.labelSize||(o.labelSize="medium"),o.labelOrientation||(o.labelOrientation="default"),o.verticalLabel||(o.verticalLabel=!1),o.interactiveLabel||(o.interactiveLabel=!1);break;case"image":for(a in e)!e.hasOwnProperty(a)||a==="x"||a==="y"||(o[a]=e[a]);o.center="\\left("+(e.x||"0")+","+(e.y||"0")+"\\right)",o.angle=e.angle||"0",o.foreground=!!o.foreground;break;case"text":for(a in e)e.hasOwnProperty(a)&&(o[a]=e[a]);break;case"table":for(a in e)e.hasOwnProperty(a)&&(a==="columns"?o[a]=e[a].map(gJ):o[a]=e[a]);break;default:throw new Error("Unexpected expression type: "+i)}if(o.id=""+o.id,e.type==="folder")t.folderId=o.id,t.memberIds=e.memberIds,o.folderId="";else{let s=r[o.id];t.memberIds&&t.memberIds[s]?o.folderId=t.folderId:(o.folderId="",t.folderId=void 0,t.memberIds=void 0)}return o}function yJ(e){let t=0,r=/^[0-9]+$/;for(let n=e.length-1;n>=0;n--){let i=e[n],o=i.id,a;if(r.test(o)&&(a=parseInt(o,10),a>t&&(t=a)),i.type==="table"&&i.columns)for(let s=i.columns.length-1;s>=0;s--)o=i.columns[s].id,r.test(o)&&(a=parseInt(o,10),a>t&&(t=a))}return t+1}function TN(e){if(e.version!==5)throw new Error("Unexpected version: "+e.version);let t=!!(e.graph&&e.graph.degreeMode),r=e.expressions.list,n=-1,i={},o={},a={};return{version:pJ,graph:e.graph,expressions:{list:r.map(s=>(i[s.id]?(n===-1&&(n=yJ(r)),o[n]=s.id,s=__dcg_shared_module_exports__.Jc(s),s.id=n+"",n+=1):o[s.id]=s.id,i[s.id]=!0,bJ(s,a,o,t)))}}}function TM(e){if(e.version!==6)throw new Error(`Unexpected version: ${e.version}`);let t=e.expressions.list.map(r=>{if(r.type==="expression"&&r.domain){let n=ie(R({},r),{parametricDomain:{min:r.domain.min,max:r.domain.max}});return delete n.domain,n}return r});return{version:7,randomSeed:e.randomSeed,graph:e.graph,expressions:{list:t}}}function xJ(e){return e.length===1?`0${e}`:e}function rd(){let e=new Uint8Array(16);if(typeof crypto!="undefined")crypto.getRandomValues(e);else if(typeof msCrypto!="undefined")msCrypto.getRandomValues(e);else return __dcg_shared_module_exports__.O(Date.now().toString()+Math.random().toString());return Array.prototype.slice.call(e).map(t=>xJ(t.toString(16))).join("")}function DM(e){let t=e.split("_");return t.length===2&&t[1]&&t[1].length===1?t[0]+"_{"+t[1]+"}":e}function DN(e){return e=__dcg_shared_module_exports__.Jc(e),!e.rules&&(e.assignment||e.expression)&&(e.rules=[{id:"1",assignment:e.assignment||"",expression:e.expression||""}]),delete e.assignment,delete e.expression,e}function Fx(e){let t=/\\operatorname(?:\{stdev\}p|\{stddev\}p|\{stdDev\}P|\{var\}iance)/g;return e.replace(t,r=>{switch(r){case"\\operatorname{stdev}p":return"\\operatorname{stdevp}";case"\\operatorname{stddev}p":return"\\operatorname{stddevp}";case"\\operatorname{stdDev}P":return"\\operatorname{stdDevP}";case"\\operatorname{var}iance":return"\\operatorname{variance}";default:return""}})}function wJ(e){return e.columns?ie(R({},e),{columns:e.columns.map(vJ)}):e}function vJ(e){let{latex:t,values:r}=e,n=R({},e);return t&&(n.latex=Fx(t),n.latex=DM(n.latex)),r&&(n.values=r.map(i=>i?Fx(i):"")),n}function kM(e){if(e.version!==7)throw new Error(`Unexpected version: ${e.version}`);let t=e.expressions.list.map(r=>{if(r.type==="image"){let n=ie(R({},r),{opacity:""});r.hasOwnProperty("stringOpacity")?n.opacity=r.stringOpacity:r.hasOwnProperty("opacity")?n.opacity=r.opacity+"":delete n.opacity,r.clickableInfo&&(n.clickableInfo=DN(r.clickableInfo)),delete n.stringOpacity;for(let i in r)if(i==="x"||i==="y"||i==="width"||i==="height"){let o=r[i];o&&(n[i]=Fx(o))}return n}else if(r.type==="expression"){let n=ie(R({},r),{fillOpacity:"",lineStyle:"SOLID"});if(r.lineStyle==="SINGLE_PIXEL"?n.lineWidth="1":r.hasOwnProperty("lineStyle")?n.lineStyle=r.lineStyle:delete n.lineStyle,n.hasOwnProperty("lineWidth")||(n.lineWidth=""),n.hasOwnProperty("lineOpacity")||(n.lineOpacity=""),n.hasOwnProperty("pointOpacity")||(n.pointOpacity=""),n.hasOwnProperty("pointSize")||(n.pointSize=""),n.hasOwnProperty("colorLatex")||(n.colorLatex=""),typeof r.latex=="string"&&(n.latex=Fx(r.latex)),r.latex&&(n.latex=Fx(r.latex)),r.hasOwnProperty("stringFillOpacity")?n.fillOpacity=r.stringFillOpacity:r.hasOwnProperty("fillOpacity")?n.fillOpacity=r.fillOpacity+"":delete n.fillOpacity,n.slider&&r.slider&&r.slider.newLoopMode&&(n.slider=__dcg_shared_module_exports__.Jc(n.slider),n.slider.loopMode=r.slider.newLoopMode,delete n.slider.newLoopMode),n.residualVariable&&(n.residualVariable=DM(n.residualVariable)),n.regressionParameters){n.regressionParameters={};for(let i in r.regressionParameters){let o=DM(i),a=r.regressionParameters[i];n.regressionParameters[o]=a}}return r.clickableInfo&&(n.clickableInfo=DN(r.clickableInfo)),n}else if(r.type==="table")return wJ(r);return r});return{version:8,randomSeed:e.randomSeed||rd(),graph:e.graph,expressions:{list:t}}}function CJ(e,t,r){if(e.verticalLabel)switch(delete t.verticalLabel,r?t.labelAngle="90":t.labelAngle="\\frac{\\pi}{2}",e.labelOrientation){case"above":t.labelOrientation="right";break;case"below":t.labelOrientation="left";break;case"left":t.labelOrientation="above";break;case"right":t.labelOrientation="below";break}e.extendedLabelOrientation&&(t.labelOrientation=e.extendedLabelOrientation,delete t.extendedLabelOrientation)}function SJ(e,t){if(e.vizProps)switch(e.vizProps.dotplotSize){case"small":t.pointSize="9";break;case"large":t.pointSize="20";break}if(e.vizProps){let r=R({},e.vizProps);delete r.dotplotSize,Object.keys(r).length?t.vizProps=r:delete t.vizProps}}function _M(e){return e.filter(({assignment:t,expression:r})=>!!t&&!!r)}function IM(e){return e.map(({assignment:t,expression:r})=>`${t}\\to ${r}`).join(",")||""}function AM(e){let t=JSON.stringify(e),r=/_(\d)|_\{(\d+)\}/g,n,i={};for(;(n=r.exec(t))!==null;){let o=n[1]!==void 0?n[1]:n[2];i[o]=!0}return i}function MM(e,t){for(let r=t+1;;r++)if(!e[r])return r}function kN(e){let t=JSON.stringify(e),r=/"(\d+)"/g,n,i={};for(;(n=r.exec(t))!==null;){let o=n[1]!==void 0?n[1]:n[2];i[o]=!0}return i}function _N(e,t){for(let r=t+1;;r++)if(!e[r])return r}function EJ(e){if(/^\d+$/.test(e)){let t=parseInt(e,10);return t===0?"\\infty":""+Math.round(1e3/t)}else return`\\frac{1000}{${e}}`}function TJ(e,t){let r={handlerLatex:e,playing:!0,open:!0};return t!==void 0&&(r.minStepLatex=EJ(t)),r}function GM(e){if(e.version!==8)throw new Error(`Unexpected version: ${e.version}`);let t=!1;e.graph&&e.graph.degreeMode&&(t=!0);let r=e.expressions.ticker||of,n=0,i,o=0,a,s=[];for(let d of e.expressions.list)switch(d.type){case"expression":{let u=R({},d);CJ(d,u,t),SJ(d,u);let p;if(d.clickableInfo&&d.clickableInfo.rules){let l=d.clickableInfo,{rules:g}=l,f=Vo(l,["rules"]),y=f,E=_M(g),_=IM(E);if(E.length>1){i||(i=AM(e)),n=MM(i,n),a||(a=kN(e)),o=_N(a,o);let w=`A_{${n}}`;y.latex=w,p={type:"expression",id:""+o,latex:`${w}=${_}`},d.folderId!==void 0&&(p.folderId=d.folderId)}else y.latex=_;u.clickableInfo=y}u.clickableInfo&&u.clickableInfo.enabled&&u.hidden&&(u.clickableInfo.enabled=!1),s.push(u),p&&s.push(p);break}case"image":{if(d.clickableInfo&&d.clickableInfo.rules){let u=R({},d),c=d.clickableInfo,{rules:p}=c,g=Vo(c,["rules"]),f=g,y=_M(p),E=IM(y),_;if(y.length>1){i||(i=AM(e)),n=MM(i,n),a||(a=kN(e)),o=_N(a,o);let w=`A_{${n}}`;f.latex=w,_={type:"expression",id:""+o,latex:`${w}=${E}`},d.folderId!==void 0&&(_.folderId=d.folderId)}else f.latex=E;u.clickableInfo=f,s.push(u),_&&s.push(_)}else s.push(d);break}case"simulation":{let u;if(d.clickableInfo&&d.clickableInfo.rules){let g=_M(d.clickableInfo.rules);u=IM(g)}else u="";if(d.isPlaying&&u!==""){i||(i=AM(e)),n=MM(i,n);let g=`A_{${n}}`;u=`${g}=${u}`,r=TJ(g,d.fps)}let p={type:"expression",id:d.id,latex:u};d.folderId!==void 0&&(p.folderId=d.folderId),s.push(p);break}default:s.push(d);break}return{version:9,randomSeed:e.randomSeed||rd(),graph:e.graph,expressions:{list:s,ticker:r}}}function DJ(e){switch(e.type){case"TokenNode":case"Letter":return!0;case"OperatorName":{for(let t of e.arg.args)if(t.type!=="Letter")return!1;return!0}case"Cmd":return __dcg_shared_module_exports__.Kc(e.val);default:return!1}}function LM(e){let t;try{t=__dcg_shared_module_exports__.Vc(e)}catch(i){return}if(t.args.length===0||t.args.length>2)return;let r=t.args[0];if(!DJ(r))return;let n;if(t.args.length>1){let i=t.args[1];if(i.type!=="SupSub")return;let{sup:o,sub:a}=i;if(o!==void 0||a===void 0)return;for(let s of a.args)if(s.type!=="Letter"&&s.type!=="Digit")return;n=a}return{base:r,subscript:n}}function ya(e){return LM(e)!==void 0}function GN(e){let t=__dcg_shared_module_exports__.Vc(e),r=__dcg_shared_module_exports__.Rc(t);switch(r.type){case"Letter":return r.val;case"Cmd":return r.val;default:return}}function IN(e){return e.replace(/^(\\? )+|(\\? )+$/g,"")}function Nx(e){let t=e.indexOf("=");if(t===-1)return;let r=IN(e.slice(0,t));if(ya(r))return r;try{let n=__dcg_shared_module_exports__.Vc(`${r}=0`),i=__dcg_shared_module_exports__.Rc(n);if(i.type==="Comparator"&&i.symbol==="="&&__dcg_shared_module_exports__.Oc(i.args[0])){let o=e.indexOf("\\left(");if(o===-1&&(o=e.indexOf("(")),o===-1)return;let a=IN(e.slice(0,o));if(ya(a))return a}}catch(n){}}function ZC(e,t){let r=LM(t);if(r===void 0)return[];let n=[],i;try{i=__dcg_shared_module_exports__.Vc(e)}catch(o){return n}return sf(i,r,n,{wrapInBraces:!1}),n}function Il(e,t){return ZC(e,t).length!==0}function eS(e,t,r){return LM(r)===void 0?e:PM(e,t,r)}function PM(e,t,r){let n=ZC(e,t);if(n.length===0)return e;let i="",o=0;for(let a of n){if(i+=e.slice(o,a.base.start),/[a-z]$/i.test(i)&&t[0]=="\\"&&r[0]!=="\\"&&(i+=" "),a.wrapInBraces&&(i+="{"),i+=r,o=a.base.end,a.subscript){let s=0,l=0;for(let c=a.subscript.start;c>=0;c--)if(e[c]==="{"&&(s+=1),e[c]==="_"){l=c;break}i+=e.slice(o,l),o=a.subscript.end;for(let c=a.subscript.end;c<e.length&&!(s<=0);c++)e[c]==="}"&&(s-=1,o=c+1)}a.wrapInBraces&&(i+="}")}return i+=e.slice(o,e.length),i}function AN(e,t){if(e.args.length!==t.args.length)return!1;for(let r=0;r<e.args.length;r++){let n=e.args[r],i=t.args[r];if(!(n.type==="Letter"&&i.type==="Letter"&&n.val===i.val)&&!(n.type==="Digit"&&i.type==="Digit"&&n.val===i.val))return!1}return!0}function kJ(e,t,r){let n=e.arg.args,i=t.arg.args;if(n.length===i.length){for(let o=0;o<n.length;o++){let a=n[o],s=i[o];if(a.type!=="Digit"||a.type!==s.type||a.val!==s.val)return}r.push({base:t.span,wrapInBraces:!1})}}function sf(e,t,r,{wrapInBraces:n}){let{base:i,subscript:o}=t;for(let a=0;a<e.args.length;a++){let s=a-1>=0?e.args[a-1]:void 0,l=e.args[a],c;if(a+1<e.args.length){let d=e.args[a+1];d.type==="SupSub"&&d.sub!==void 0&&(c=d.sub)}switch(l.type){case"Letter":case"Cmd":if(i.type!==l.type||i.val!==l.val)break;if(o&&c&&AN(o,c))r.push({base:l.span,subscript:c.span,wrapInBraces:n});else if(!o&&!c){if((s==null?void 0:s.type)==="Symbol"&&s.val==="."&&l.type==="Letter"&&(i.val==="x"||i.val==="y"||i.val==="z"))break;r.push({base:l.span,wrapInBraces:n})}break;case"OperatorName":{if(i.type!==l.type||i.arg.args.length!==l.arg.args.length)break;let d=!0;for(let u=0;u<i.arg.args.length;u++){let p=i.arg.args[u],g=l.arg.args[u];if(p.type!=="Letter"||g.type!=="Letter"||p.val!==g.val){d=!1;break}}if(!d)break;o&&c&&AN(o,c)?r.push({base:l.span,subscript:c.span,wrapInBraces:n}):!o&&!c&&r.push({base:l.span,wrapInBraces:n});break}case"Digit":case"Symbol":case"EscapedSymbol":break;case"LeftRight":case"Sqrt":sf(l.arg,t,r,{wrapInBraces:!1});break;case"Frac":sf(l.num,t,r,{wrapInBraces:!1}),sf(l.den,t,r,{wrapInBraces:!1});break;case"SupSub":(s==null?void 0:s.type)==="Cmd"&&__dcg_shared_module_exports__.Mc(s.val)&&l.sub&&sf(l.sub,t,r,{wrapInBraces:!MN(l.sub,"_")}),l.sup&&sf(l.sup,t,r,{wrapInBraces:!MN(l.sup,"^")});break;case"TokenNode":{if(i.type!==l.type)break;kJ(i,l,r)}break;default:{let d=l;throw new Error("Unexpected token type: "+d.type)}}}}function MN(e,t){for(let r=e.span.start;r>=0;r--){let n=e.span.input[r];if(n===t)break;if(n==="{")return!0}return!1}function LN(e){e.clickableInfo&&(e.description===void 0&&e.clickableInfo.description!==void 0&&(e.description=e.clickableInfo.description),delete e.clickableInfo.description,Object.keys(e.clickableInfo).length===0&&delete e.clickableInfo)}function _J(e){switch(e.labelSize){case"small":e.labelSize="0.85";break;case"medium":e.labelSize="1";break;case"large":e.labelSize="1.35";break}}function IJ(e){let t=0,r=/^[0-9]+$/;for(let n=e.length-1;n>=0;n--){let i=e[n],o=i.id;if(r.test(o)){let a=parseInt(o,10);a>t&&(t=a)}if(i.type==="table"&&i.columns){for(let a=i.columns.length-1;a>=0;a--)if(o=i.columns[a].id,!!o&&r.test(o)){let s=parseInt(o,10);s>t&&(t=s)}}}return t}function VM(e){if(e.version!==9)throw new Error(`Unexpected version: ${e.version}`);let t=[],r={},n=IJ(e.expressions.list);for(let i of e.expressions.list)switch(i.type){case"expression":{let s=R({},i);LN(s),_J(s),t.push(s);break}case"image":{let s=R({},i);LN(s);let l=s.description;(l===void 0||l==="")&&s.draggable&&s.center!==void 0&&s.center!==""&&(r[s.center]===void 0?r[s.center]=[s]:r[s.center].push(s)),t.push(s);break}case"table":let o=R({},i);if(!o.columns||!ya(o.columns[0].latex)){t.push(o);break}let a=o.columns[0].latex;for(let s=1;s<o.columns.length;s++){let l=o.columns[s];if(!l.lines||!Il(l.latex,a))continue;delete l.lines,n++;let c={type:"expression",latex:"y="+eS(l.latex,a,"x"),id:`${n}`};l.color&&(c.color=l.color),l.lineStyle&&(c.lineStyle=l.lineStyle),l.lineWidth&&(c.lineWidth=l.lineWidth),l.lineOpacity&&(c.lineOpacity=l.lineOpacity),t.push(c)}t.push(o);break;default:t.push(i);break}for(let i of t){if(i.type!=="expression"||i.latex===void 0||i.latex===""||i.latex.indexOf("=")===-1||i.dragMode===void 0||i.dragMode==="NONE"||i.label===void 0||i.label==="")continue;let o=i.latex.slice(0,i.latex.indexOf("=")),a=r[o];if(a!==void 0)for(let s of a)s.description=i.label}return ie(R({},e),{version:10,expressions:ie(R({},e.expressions),{list:t})})}function AJ(e){let t=/[ \\]*=[ \\]*\\operatorname\{(dilation|reflection|rotation|translation)\}\\left\(/g;return e.type!=="expression"||!e.latex||(e.latex=e.latex.replace(t,(r,n)=>{switch(n){case"dilation":return"\\left(x\\right)=\\operatorname{dilate}\\left(x,";case"rotation":return"\\left(x\\right)=\\operatorname{rotate}\\left(x,";case"reflection":return"\\left(x\\right)=\\operatorname{reflect}\\left(x,";case"translation":return"\\left(x\\right)=\\operatorname{translate}\\left(x,";default:return""}})),e}function MJ(e,t){var r;if(e.type==="image"&&e.folderId&&!e.draggable&&!((r=e.clickableInfo)!=null&&r.enabled)&&t.has(e.folderId)&&e.disableGraphInteractions!==!1){let n=R({},e);return n.disableGraphInteractions=!0,n}else return e}function GJ(e){var t;if(e.type!=="expression")return e;let r=R({},e),n=(t=(e.latex||"").split("=")[0])==null?void 0:t.trim(),i=e.parametricDomain3Du,o=e.parametricDomain3Dv,a=e.parametricDomain;return n==="r"||(n==="z"?(i&&(r.parametricDomain3Dr=R({},i)),o&&(r.polarDomain=R({},o))):n==="\\rho"?(i&&(r.polarDomain=R({},i)),o&&(r.parametricDomain3Dphi=R({},o))):e.polarDomain||a&&(r.parametricDomain3Du=R({},a),r.parametricDomain3Dv=R({},a))),r}function OM(e){if(e.version!==10)throw new Error(`Unexpected version: ${e.version}`);let t=R({},e.graph);delete t.projectorMode;let r=R({},e.expressions),n=[],i=new Set;for(let o of r.list)o.type==="folder"&&o.collapsed&&i.add(o.id);for(let o of r.list)switch(o.type){case"expression":{if((t==null?void 0:t.product)==="geometry-calculator"){let a=R({},o);AJ(a),n.push(a)}else if((t==null?void 0:t.product)==="graphing-3d"){let a=GJ(o);n.push(a)}else n.push(o);break}case"image":{n.push(MJ(o,i));break}default:n.push(o)}return r.list=n,ie(R({},e),{version:11,graph:t,expressions:r})}function RM(e){var t,r;if(e.version!==11)throw new Error(`Unexpected version: ${e.version}`);let n=(t=e.includeFunctionParametersInRandomSeed)!=null?t:!1,i=R({},e.expressions),o=[];for(let a of i.list)switch(a.type){case"expression":{if(((r=e.graph)==null?void 0:r.product)==="graphing-3d"&&!e.doNotMigrate3dLineWidthZero){let s=LJ(a);o.push(s)}else o.push(a);break}default:o.push(a)}return i.list=o,ie(R({},e),{expressions:i,includeFunctionParametersInRandomSeed:n,version:12})}function LJ(e){return e.type!=="expression"||e.lineWidth!=="0"?e:ie(R({},e),{lineWidth:"0.1"})}function PN(e){var t,r;let n=(t=e.includeFunctionParametersInRandomSeed)!=null?t:!0,i=((r=e.graph)==null?void 0:r.product)==="graphing-3d"?ie(R({},e),{includeFunctionParametersInRandomSeed:n,doNotMigrate3dLineWidthZero:!0,version:11}):ie(R({},e),{includeFunctionParametersInRandomSeed:n,version:11});return i.includeFunctionParametersInRandomSeed===!1&&delete i.includeFunctionParametersInRandomSeed,i}var FM=[fN,bN,xN,wN,CN,SN,TN,TM,kM,GM,VM,OM,RM],_l=12;function dc(e){if(e.version>_l)return typeof console!="undefined"&&console.warn&&console.warn("Loading saved state with version "+e.version+" but last known version is "+_l+". States saved in a newer version of the calculator may not load correctly in an older version of the calculator."),XC(e);if(e.hasOwnProperty("version")&&!FM[e.version])return typeof console!="undefined"&&console.warn&&console.warn("State has invalid version "+e.version+". If a version is present, it should be a non-negative integer less than or equal to "+_l+"."),XC(e);for(e.hasOwnProperty("version")||(e=FM[0](e));e.version<_l;)e=FM[e.version+1](e);return XC(e)}function PJ(e){return PN(e)}function VN(e){return PJ(dc(e))}function ON(e){let t=dc(e),r={},n=t.graph.degreeMode,i=t.randomSeed,o=t.graph.product==="geometry-calculator"?"geometry":t.graph.product==="graphing-3d"?"graphing_3d":"graphing";function a(s){switch(s.type){case void 0:case"expression":{let l=__dcg_shared_module_exports__.Hd(__dcg_shared_module_exports__.Dd(s,{is3d:!1,defaultLogModeRegressions:!1}));r[l.id]=l}break;case"table":{let l=$C(WC(s));r[l.id]=l}break;case"image":{let l=KC(HC(s));r[l.id]=l;break}case"folder":case"text":break;default:return s}}for(let s of t.expressions.list)a(s);if(t.version>=10&&t.expressions.ticker){let s="dcg_ticker_guid_internal",l=ie(R({},YC(t.expressions.ticker)),{id:s});r[s]=jC(l)}return{setExpression(s){a(s)},getChangeSet(){return{statements:r,isCompleteState:!0,degreeMode:n,globalRandomSeed:i,evaluationMode:o}}}}function FN(e,t){let r=__dcg_shared_module_exports__.Jc(e);return tS(r,t)}function tS(e,t){for(let r of __dcg_shared_module_exports__.B(t)){let n=t[r];OJ(n)?e[r]=n.s:RJ(n)?delete e[r]:FJ(n)?e[r]=VJ(e[r],n.l):NJ(n)&&(e[r]=tS(e[r],n.e))}return e}function VJ(e,t){let r=[];for(let i=0;i<e.length;i++){let o=t[i];o&&o.a&&r.push(...RN(e,o.a)),o&&o.e?r.push(tS(e[i],o.e)):(!o||!o.d)&&r.push(e[i])}let n=t[e.length];return n&&n.a&&r.push(...RN(e,n.a)),r}function RN(e,t){let r=[];for(let n of t)if(BJ(n))r.push(n.s);else if(UJ(n)){let i=e[n.m.f];n.m.e?r.push(tS(i,n.m.e)):r.push(i)}return r}function OJ(e){return e.hasOwnProperty("s")}function RJ(e){return e.hasOwnProperty("d")}function FJ(e){return e.hasOwnProperty("l")}function NJ(e){return e.hasOwnProperty("e")}function BJ(e){return e.hasOwnProperty("s")}function UJ(e){return e.hasOwnProperty("m")}function NN(e){let t=e.length,r=new Array(t),n=new Array(t+1),i=0;for(let s=0;s<t;s++){let l;if(e[n[i]]<e[s])l=i+1;else{let c=1,d=i-1;for(;c<=d;){let u=Math.ceil((c+d)/2);e[n[u]]<e[s]?c=u+1:d=u-1}l=c}r[s]=n[l-1],n[l]=s,l>i&&(i=l)}let o=new Array(i),a=n[i];for(let s=i-1;s>=0;s--)o[s]=e[a],a=r[a];return o}function UN(e,t){return rS(e,t,0)}function rS(e,t,r){let n={};for(let i in e){if(!e.hasOwnProperty(i))continue;if(!t.hasOwnProperty(i)){n[i]={d:1};continue}let o=e[i],a=t[i],s=zJ(o,a,r,i);s&&(n[i]=s)}for(let i in t)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(n[i]={s:t[i]});return n}function zJ(e,t,r,n){if(__dcg_shared_module_exports__.G(e)&&__dcg_shared_module_exports__.G(t)){if(r===1&&n==="list"||r===2&&n==="columns")return HJ(e,t);if(!__dcg_shared_module_exports__.E(e,t))return{s:t}}else if(__dcg_shared_module_exports__.H(e)&&__dcg_shared_module_exports__.H(t)){let i=rS(e,t,qJ(r,n));if(!__dcg_shared_module_exports__.F(i))return{e:i}}else if(!__dcg_shared_module_exports__.E(e,t))return{s:t}}function qJ(e,t){return e===0&&t==="expressions"?1:3}function HJ(e,t){let r={},n={};for(let s=0;s<e.length;s++){if(n[e[s].id]!==void 0)return{s:t};n[e[s].id]=s}let i={};for(let s=0;s<t.length;s++){if(i[t[s].id]!==void 0)return{s:t};i[t[s].id]=s}let o=KJ(e,t,n),a=0;for(let s=0;s<e.length;s++){let l=e[s];if(!o[l.id])r[s]={d:1};else{let c=i[l.id],d=t[c],u={};if(a!==c&&(u.a=t.slice(a,c).map(p=>BN(e,n,p))),!__dcg_shared_module_exports__.E(l,d)){let p=l.type==="table"&&d.type==="table";u.e=rS(l,d,p?2:3)}__dcg_shared_module_exports__.F(u)||(r[s]=u),a=c+1}}if(a<t.length&&(r[e.length]={a:t.slice(a,t.length).map(s=>BN(e,n,s))}),!__dcg_shared_module_exports__.F(r))return{l:r}}function BN(e,t,r){if(t[r.id]){let n=e[t[r.id]],i={f:t[r.id]};return __dcg_shared_module_exports__.E(n,r)||(i.e=rS(n,r,3)),{m:i}}return{s:r}}function KJ(e,t,r){let n={},i=t.filter(a=>r[a.id]!==void 0).map(a=>r[a.id]),o=NN(i);for(let a of o)n[e[a].id]=!0;return n}function zN(e){return e.location==="expression"||e.location==="object"?`${e.location}:${e.id}:${e.path}`:`${e.location}:${e.path}`}function NM(e){let t=()=>new Error(`Invalid key: ${e}`),r=e.split(":"),n=r[0];if(!n||n!="expression"&&n!="settings"&&n!="object")throw t();if(n=="settings"){if(r.length!=2)throw t();return{location:n,path:r[1]}}if(r.length!=3)throw t();return{location:n,id:r[1],path:r[2]}}function oS(e,t,r){if(!e)return;let n=t.split("."),i=e;for(let o=0;o<n.length;o++){let a=n[o];if(!i[a])break;o==n.length-1&&typeof i[a]=="string"?i[a]=r:i=i[a]}}function BM(e,t){return(r,n,i,o)=>{if(r){let a=zN(ie(R({},t),{path:n}));e[a]={value:r,type:i,context:o}}}}function WJ(e){var t,r;let n={},i=BM(n,{location:"expression",id:e.id});switch(e.type){case"expression":i(e.label,"label","interpolated-string","expression-list-expression-label"),i(e.description,"description","string","expression-list-expression-clickable-description");break;case"image":i(e.image_url,"image_url","image","expression-list-image-url"),i(e.description,"description","string","expression-list-image-clickable-description"),i((t=e.clickableInfo)==null?void 0:t.hoveredImage,"clickableInfo.hoveredImage","image","expression-list-image-clickable-hovered"),i((r=e.clickableInfo)==null?void 0:r.depressedImage,"clickableInfo.depressedImage","image","expression-list-image-clickable-depressed");break;case"text":i(e.text,"text","string","expression-list-note-text");break;case"folder":i(e.title,"title","string","expression-list-folder-title");break}return n}function $J(e){let t={},r=BM(t,{location:"settings"});return r(e.graph.xAxisLabel,"xAxisLabel","string","settings-xaxis-label"),r(e.graph.yAxisLabel,"yAxisLabel","string","settings-yaxis-label"),t}function jJ(e){let t={},r=BM(t,{location:"object",id:e.id});return r(e.label,"label","string","geometry-object-label"),e.type==="image"&&r(e.url,"url","image","geometry-object-image-url"),t}function qN(e){let t={};if(e.type=="graph"){let r=e.graphState.expressions.list;for(let i of r){let o=WJ(i);for(let a in o)t[a]=o[a]}let n=$J(e.graphState);for(let i in n)t[i]=n[i]}else{let r=e.geometryState.objects;for(let n in r){let i=jJ(r[n]);for(let o in i)t[o]=i[o]}}return t}function HN(e,t,r){var n;let i=__dcg_shared_module_exports__.Jc(e);if(r==="graph"){let o={},a=(n=i.expressions)==null?void 0:n.list,s=Array.isArray(a)?a:[];for(let l of s)o[l.id]=l;for(let l in t){let c=NM(l);c.location=="expression"?oS(o[c.id],c.path,t[l].value):oS(i.graph,c.path,t[l].value)}}else if(i.objects)for(let o in t){let a=NM(o);a.location=="object"&&oS(i.objects[a.id],a.path,t[o].value)}return i}function iS(e,t){switch(e.type){case"Mul":case"DotMul":case"CrossMul":case"Div":case"Prime":case"Call":case"ImplicitCall":case"Dot":case"Pipes":case"Sqrt":case"Nthroot":case"Frac":case"Derivative":case"Integral":case"EmptyIntegral":case"Sum":case"Product":case"Piecewise":case"Paren":case"Juxt":case"Superscript":case"Bang":case"Index":case"Comparator":case"ComparatorChain":case"Tilde":case"Pos":case"Neg":case"Add":case"Sub":case"List":case"Seq":case"Colon":case"Ellipsis":case"PercentOf":case"RightArrow":case"For":case"With":{let r=0;for(let n of e.args)r+=iS(n,t);return r}case"Decimal":return t===void 0||parseFloat(e.val)===t?1:0;case"MixedNumber":{if(t===void 0)return 3;let r=0;return parseFloat(e.whole)===t&&(r+=1),parseFloat(e.num)===t&&(r+=1),parseFloat(e.den)===t&&(r+=1),r}case"Letter":case"EmptyPiecewise":case"Cmd":case"EmptyRangeEnd":return 0;case"Subscript":return iS(e.args[0],t);default:throw`Unexpected surface node ${e.type}.`}}var YJ={version:_l,randomSeed:"",graph:{viewport:{xmin:-10,ymin:-13.25,xmax:10,ymax:13.25}},expressions:{list:[{id:"1",type:"expression"}]}},Bx=YJ;function XJ(e){return ie(R({},e),{version:"0"})}var KN=XJ,JJ={centerX:0,centerY:0,size:15},QJ={scale:1,unit:"",visible:!1,showLegend:!1};function ZJ(e){let t=e.objects||{},r=__dcg_shared_module_exports__.Jc(t);for(let n in r){let i=r[n];i.label&&(i.showLabel=!0)}return{version:"1",objects:r,viewport:e.viewport||JJ,customTools:e.customTools||{},grid:e.grid||QJ}}var WN=ZJ;function eQ(e){return(e.type==="point"||e.type==="glider")&&!e.draggable}function tQ(e){let t=e.objects||{},r=__dcg_shared_module_exports__.Jc(t),n=__dcg_shared_module_exports__.Jc(e.grid);for(let i in r){let o=r[i];eQ(o)&&(o.draggable=!0),o.type==="angle"&&o.showLabel&&!o.label&&(o.label="{angle}"),o.type==="segment"&&o.showLabel&&!o.label&&(o.label="{length}")}return n.unit="",n.scale=1,{version:"2",objects:r,viewport:e.viewport,customTools:e.customTools||{},grid:n}}var $N=tQ;function UM(e){return e&&(e.type==="circle"||e.type==="compass")}function rQ(e){let t=__dcg_shared_module_exports__.Jc(e.objects||{});for(let r in t){let n=t[r];if(n.type==="point")n.y=-n.y;else if(n.type==="glider"){let i=t[n.parents.host];UM(i)&&(n.t=-n.t)}else if(n.type==="intersection"){let i=t[n.parents.host1],o=t[n.parents.host2];UM(i)&&UM(o)&&(n.negRoot=!n.negRoot)}}return{version:"3",objects:t,viewport:e.viewport,customTools:e.customTools||{},graphSettings:{showGrid:!!(e.grid||{}).visible,showAxes:!1,showAxisNumbers:!1}}}var jN=rQ;function oQ(e){let t=__dcg_shared_module_exports__.Jc(e.objects||{});for(let r in t){let n=t[r];n.draggable===!1&&(n.locked=!0),delete n.draggable}return ie(R({},e),{version:"4",objects:t})}var YN=oQ,nS=[KN,WN,$N,jN,YN],iQ="4";function zM(e){let t=parseInt(iQ,10),r=parseInt(e.version||"0",10);for(r>t&&typeof console!="undefined"&&console.warn&&console.warn(`Loading saved state with version ${r}, but last known version is ${t}. States saved in a newer version of the geometry tool may not load correctly in older versions of the tool.`),nS[r]||typeof console!="undefined"&&console.warn&&console.warn(`State has invalid version: ${r}. If a version is present, it should be a non-negative integer less than or equal to ${t}.`),r===0&&(e=nS[0](e));r<t;)r+=1,nS[r]&&(e=nS[r](e));return e}function pg(e,t){let r=t[e];return r.type==="transformed-object"?pg(r.parents.object,t):r.type}function XN(e){switch(e){case"circle":case"compass":case"arc":return!0}return!1}function aQ(e,t,r){let n=pg(t,r);if(n==="circle"||n==="compass"){let i=e/(2*Math.PI);return i<0?i+1:i}return e}function JN(e){switch(e){case"scaled-rotation":case"vector":return!0}return!1}function sQ(e){switch(e){case"point":case"midpoint":case"glider":case"intersection":case"polygon":return"P";case"line":case"segment":case"ray":case"vector":case"parallel":case"perpendicular":return"L";case"circle":case"compass":return"C";case"arc":case"angle":return"A";case"image":return"I";case"dilation":case"rotation":case"translation":case"reflection":case"scaled-rotation":return"T";case"transformed-object":return"T";default:return e}}function ug(e){let t=zM(e),r={},n={},i=w=>{if(n.hasOwnProperty(w))return n[w];let v=pg(w,t.objects);if(!JN(v)){let P=r.token||1;r.token=P+1;let F="\\token{"+P+"}";return n[w]=F,F}let T=sQ(v),M=r[T]||1;r[T]=M+1;let C=T+"_{"+M+"}";return n[w]=C,C};function o(w){let v=r[w]||1;return r[w]=v+1,w+"_{"+v+"}"}let a=(w,v,T)=>i(w)+"=\\operatorname{"+v+"}\\left("+T.map(i).join(",")+"\\right)",s=w=>`\\operatorname{segment}\\left(${w}.\\operatorname{start},${w}.\\operatorname{end}\\right)`,{centerX:l,centerY:c,size:d}=t.viewport;d*=1.25;let u=1,p=d/(1+u),g=p*u,f={version:11,randomSeed:"",expressions:{list:[]},graph:{product:"geometry-calculator",viewport:{xmin:l-p,xmax:l+p,ymin:c-g,ymax:c+g},showGrid:!1,showXAxis:!1,showYAxis:!1,squareAxes:!0,degreeMode:!0}};t.graphSettings.showGrid&&(f.graph.showGrid=!0,f.graph.xAxisMinorSubdivisions=1,f.graph.yAxisMinorSubdivisions=1,f.graph.xAxisStep=1,f.graph.yAxisStep=1);let y=f.expressions.list,E=[],_=[];for(let w in t.objects){let v=t.objects[w],T=pg(v.id,t.objects),M={id:v.id,type:"expression",color:v.color,hidden:!!v.hidden};if(!JN(T)&&(M.folderId=__dcg_shared_module_exports__.xd),v.locked&&(M.dragMode="NONE"),!v.hidden&&v.label&&v.showLabel){if(M.label=v.label,M.showLabel=!0,T==="segment"&&v.label.indexOf("{length}")!==-1)if(v.label==="{length}")M.label="";else{let C=o("l"),P=C+"=\\operatorname{round}\\left(\\operatorname{length}\\left("+i(v.id)+"\\right),2\\right)";_.push({id:"len-"+M.id,type:"expression",latex:P}),M.label=M.label.replace(/\{length\}/g,"${"+C+"}")}if(T==="angle"&&v.label.indexOf("{angle}")!==-1)if(v.label==="{angle}")M.label="";else{let C=o("a"),P=C+"=\\operatorname{round}\\left("+i(v.id)+"\\right)";_.push({id:"angle-"+M.id,type:"expression",latex:P}),M.label=M.label.replace(/\{angle}/g,"${"+C+"}°")}if(T==="polygon"&&v.label.indexOf("{area}")!==-1)if(v.label==="{area}")M.label="";else{let C=o("a"),P=C+"=\\operatorname{round}\\left(\\operatorname{area}\\left("+i(v.id)+"\\right),2\\right)";_.push({id:"area-"+M.id,type:"expression",latex:P}),M.label=M.label.replace(/\{area\}/g,"${"+C+"}")}if(T==="polygon"&&v.label.indexOf("{perimeter}")!==-1){let C=o("p"),P=C+"=\\operatorname{round}\\left(\\operatorname{perimeter}\\left("+i(v.id)+"\\right),2\\right)";_.push({id:"perim-"+M.id,type:"expression",latex:P}),M.label=M.label.replace(/\{perimeter\}/g,"${"+C+"}")}}switch(v.type){case"point":{let V=v.x===null?0:v.x,$=v.y===null?0:v.y;M.latex=i(v.id)+"=\\left("+__dcg_shared_module_exports__.ce(V)+","+__dcg_shared_module_exports__.ce($)+"\\right)";break}case"glider":{let V=pg(v.parents.host,t.objects),$=i(v.parents.host);V==="vector"&&($=s($)),M.latex=i(v.id)+"=\\operatorname{glider}\\left("+$+","+__dcg_shared_module_exports__.ce(aQ(v.t,v.parents.host,t.objects))+"\\right)";break}case"intersection":let C=pg(v.parents.host1,t.objects),P=pg(v.parents.host2,t.objects),F=i(v.parents.host1),B=i(v.parents.host2);C==="vector"&&(F=s(F)),P==="vector"&&(B=s(B));let x=v.negRoot;(XN(C)&&!XN(P)||P==="arc")&&(x=!x);let L=x?[F,B]:[B,F];M.latex=i(w)+"=\\operatorname{intersection}\\left("+L.join(",")+"\\right)";break;case"midpoint":M.latex=a(v.id,v.type,[v.parents.straight]);break;case"circle":M.latex=a(v.id,v.type,[v.parents.point1,v.parents.point2]);break;case"arc":M.latex=a(v.id,v.type,[v.parents.point1,v.parents.point2,v.parents.point3]);break;case"compass":M.latex=a(v.id,"circle",[v.parents.center,v.parents.straight]);break;case"line":case"segment":case"ray":case"vector":M.latex=a(v.id,v.type,[v.parents.point1,v.parents.point2]);break;case"parallel":case"perpendicular":M.latex=a(v.id,v.type,[v.parents.straight,v.parents.point]);break;case"polygon":M.latex=a(v.id,v.type,v.parents.points);break;case"angle":M.latex=a(v.id,v.type,[v.parents.point1,v.parents.point2,v.parents.point3]);break;case"transformed-object":M.latex=i(v.id)+"="+i(v.parents.transformation)+"\\left("+i(v.parents.object)+"\\right)";break;case"dilation":M.latex=i(v.id)+"\\left(x\\right)=\\operatorname{dilate}\\left(x,"+i(v.parents.center)+","+(v.scaleFactor||"0/0")+"\\right)";break;case"reflection":M.latex=i(v.id)+"\\left(x\\right)=\\operatorname{reflect}\\left(x,"+i(v.parents.straight)+"\\right)";break;case"translation":M.latex=i(v.id)+"\\left(x\\right)=\\operatorname{translate}\\left(x,"+i(v.parents.from)+","+i(v.parents.to)+"\\right)";break;case"rotation":M.latex=i(v.id)+"\\left(x\\right)=\\operatorname{rotate}\\left(x,"+i(v.parents.center)+","+(v.angle||"0/0")+"\\right)";break;case"scaled-rotation":let N=i(v.parents.center),O=i(v.parents.from),z=i(v.parents.to);M.latex=i(v.id)+`\\left(x\\right)=\\operatorname{rotate}\\left(\\operatorname{dilate}\\left(x,${N},\\frac{\\left|${z}-${N}\\right|}{\\left|${O}-${N}\\right|}\\right),${N},\\operatorname{directedangle}\\left(${O},${N},${z}\\right)\\right)`;break;case"image":break;default:return v}M.latex&&(M.folderId===__dcg_shared_module_exports__.xd?E.push(M):_.push(M))}return y.push({type:"folder",id:__dcg_shared_module_exports__.xd,title:"geometry",secret:!0}),y.push.apply(y,E),y.push.apply(y,_),f}function QN(e){return e==="<="?"\\le ":e===">="?"\\ge ":e}function Wr(e){switch(e.type){case"Comparator":return Sn(e.args,QN(e.symbol));case"ComparatorChain":{let i="";for(let o=0;o<e.symbols.length;o++)i+=Wr(e.args[o])+QN(e.symbols[o]);return i+=Wr(e.args[e.args.length-1]),i}case"Tilde":return Sn(e.args,"~");case"Pos":return"+"+Wr(e.args[0]);case"Neg":return"-"+Wr(e.args[0]);case"Add":return Sn(e.args,"+");case"Sub":return Sn(e.args,"-");case"Mul":return Sn(e.args,"*");case"DotMul":return Sn(e.args,"\\cdot ");case"CrossMul":return Sn(e.args,"\\times ");case"Div":return Sn(e.args,"/");case"Bang":return Wr(e.args[0])+"!";case"Call":let t=HM(e.args);return t?t.script+"\\left("+t.arg+"\\right)":Wr(e.args[0])+"\\left("+Wr(e.args[1])+"\\right)";case"Paren":return"\\left("+Wr(e.args[0])+"\\right)";case"List":return"\\left["+e.args.map(Wr).join(",")+"\\right]";case"Pipes":return"\\left|"+Wr(e.args[0])+"\\right|";case"Index":return Wr(e.args[0])+"\\left["+Wr(e.args[1])+"\\right]";case"Subscript":return Sn(e.args,"_",!0);case"Superscript":return Sn(e.args,"^",!0);case"Prime":if(e.args[0].type==="Call"){let i=HM(e.args[0].args);return i?i.script+qM(e.nprimes)+"\\left("+i.arg+"\\right)":Wr(e.args[0].args[0])+qM(e.nprimes)+"\\left("+Wr(e.args[0].args[1])+"\\right)"}return Wr(e.args[0])+qM(e.nprimes);case"Seq":return e.args.map(Wr).join(",");case"Sqrt":return"\\sqrt"+Ux(Wr(e.args[0]));case"Nthroot":return"\\sqrt["+Wr(e.args[0])+"]"+Ux(Wr(e.args[1]));case"Frac":return"\\frac{"+Wr(e.args[0])+"}{"+Wr(e.args[1])+"}";case"Derivative":return"\\frac{d}{d"+Wr(e.args[0])+"}"+Wr(e.args[1]);case"Integral":case"EmptyIntegral":if(e.args[0].type!=="Cmd")throw new Error("Expected first argument of an integral to be the variable");let r="d"+e.args[0].val;if(e.args.length===3)return zx("int",e.args[1],e.args[2])+r;let n=Wr(e.args[3]);return zx("int",e.args[1],e.args[2])+n+r;case"Sum":return ZN(e.args,"sum");case"Product":return ZN(e.args,"prod");case"Piecewise":return"\\{"+Wr(e.args[0])+"\\}";case"EmptyPiecewise":return"\\{\\}";case"Colon":return Sn(e.args,":");case"Ellipsis":return Sn(e.args,"...");case"For":return Sn(e.args,"\\for ");case"With":return Sn(e.args,"\\with ");case"Dot":return Sn(e.args,".");case"PercentOf":return Sn(e.args,"\\% \\of ");case"RightArrow":return Sn(e.args,"->");case"Juxt":return Sn(e.args,e.args[0].type==="Cmd"?" ":"");case"ImplicitCall":{let i=HM(e.args);return i?i.script+i.arg:Sn(e.args,"")}case"MixedNumber":return e.whole+"\\frac{"+e.num+"}{"+e.den+"}";case"Letter":case"Decimal":case"Alphanumeric":return e.val;case"Cmd":return"\\"+e.val;case"EmptyRangeEnd":return"EmptyRangeEnd";case"Err":throw e.error;default:return e}}function Ux(e){return e.length>1?"{"+e+"}":e}function zx(e,t,r){let n=Ux(Wr(t));if(r){let i=Ux(Wr(r));return`\\${e}_${n}^${i}`}return`\\${e}_${n}`}function Sn(e,t,r=!1){let n=Wr(e[0]),i=r?Ux(Wr(e[1])):Wr(e[1]);return n+t+i}function ZN(e,t){let r=Wr(e[0]);return zx(t,e[1],e[2])+r}function qM(e){let t="";for(let r=0;r<e;r++)t+="'";return t}function eB(e){return e.type==="Cmd"&&e.val==="logbase"}function HM(e){let t=e[1],r;if(e[1].type==="Seq"&&e[1].args.length===2&&(t=e[1].args[1],r=e[1].args[0]),e[0].type==="Superscript"&&eB(e[0].args[0]))return{script:zx("log",t,e[0].args[1]),arg:r?Wr(r):""};if(eB(e[0]))return{script:zx("log",t),arg:r?Wr(r):""}}function tB(e){let t=WM.parse(e.latex);if(t.type=="Err")return;let r=on(t);for(;r.type==="Paren";)r=r.args[0];return od(r)?{latex:e.latex}:{latex:Wr(r)}}function lQ(e){return e.isPseudoSurfaceNode}function od(e){switch(e.type){case"Letter":case"Decimal":case"Cmd":return e.val==="0";case"Paren":return od(e.args[0]);default:return!1}}function Cu(e){switch(e.type){case"Letter":case"Decimal":case"Cmd":return e.val==="1";case"Paren":return Cu(e.args[0]);default:return!1}}function rB(e){return e.type==="Neg"?Cu(e.args[0]):e.type==="Paren"?rB(e.args[0]):!1}function aS(e){return{isPseudoSurfaceNode:!0,type:"Decimal",span:e,val:"0"}}function KM(e,t){return{isPseudoSurfaceNode:!0,type:"Neg",span:t,args:[e]}}function cQ(e,t){return{isPseudoSurfaceNode:!0,type:"Paren",span:t,args:[e]}}function Cs(e,t){return ie(R({},e),{span:t})}function on(e,t){let r;switch(e.type){case"Add":{let o=on(e.args[0]),a=on(e.args[1]);if(od(o))return Cs(a,e.span);if(od(a))return Cs(o,e.span);let s;if(a.type==="Neg"?s=on(a.args[0]):a.type==="Paren"&&a.args[0].type==="Neg"&&(s=on(a.args[0].args[0])),s!==void 0)return{isPseudoSurfaceNode:!0,type:"Sub",span:e.span,args:[o,s]};r=[o,a];break}case"Sub":{let o=on(e.args[0]),a=on(e.args[1]);if(od(o))return KM(a,e.span);if(od(a))return Cs(o,e.span);let s;if(a.type==="Neg"?s=a.args[0]:a.type==="Paren"&&a.args[0].type==="Neg"&&(s=a.args[0].args[0]),s)return{isPseudoSurfaceNode:!0,type:"Add",span:e.span,args:[o,s]};r=[o,a];break}case"Mul":{let o=on(e.args[0]),a=on(e.args[1]);if(Cu(o))return Cs(a,e.span);if(Cu(a))return Cs(o,e.span);if(od(o)||od(a))return aS(e.span);r=[o,a];break}case"Juxt":{let o=on(e.args[0],e),a=on(e.args[1],e);if(Cu(o))return Cs(a,e.span);if(Cu(a))return Cs(o,e.span);if(rB(o))return KM(a,e.span);if(od(o)||od(a))return aS(e.span);if(o.type==="Neg"){let s=ie(R({},e),{type:"Juxt",isPseudoSurfaceNode:!0,args:[o.args[0],a]});return KM(s,e.span)}r=[o,a];break}case"Frac":case"Div":{let o=on(e.args[0]),a=on(e.args[1]);if(Cu(a))return Cs(o,e.span);r=[o,a];break}case"Superscript":let n=on(e.args[0]),i=on(e.args[1]);if(Cu(i))return Cs(n,e.span);(t==null?void 0:t.type)==="Juxt"&&t.args[0].type==="Decimal"&&n.type==="Decimal"&&(n=cQ(n,n.span)),r=[n,i];break;case"Paren":{let o=on(e.args[0]);if((t==null?void 0:t.type)!=="Juxt"){if(__dcg_shared_module_exports__.Nc(o))return Cs(o,e.span);let a="args"in o?o.args:void 0;if((!a||a.length<=1)&&o.type!=="Neg")return Cs(o,e.span)}r=[o];break}case"Pos":{let o=on(e.args[0]);return Cs(o,e.span)}case"Neg":{let o=on(e.args[0]),a="args"in o?o.args[0]:void 0;if(o.type==="Paren"&&a&&a.type==="Neg"&&a.args[0])return Cs(on(a.args[0]),e.span);if(o.type==="Neg"&&a)return Cs(a,e.span);r=[o];break}case"Cmd":case"Letter":case"Decimal":case"MixedNumber":case"EmptyRangeEnd":case"EmptyPiecewise":case"ComparatorChain":return ie(R({},e),{isPseudoSurfaceNode:!0});default:r=e.args.map(o=>lQ(o)?o:o.type==="Alphanumeric"?ie(R({},o),{isPseudoSurfaceNode:!0}):on(o))}return ie(R({},e),{isPseudoSurfaceNode:!0,args:r})}function dQ(e,t){return e==null&&(e=""),__dcg_shared_module_exports__.Wc(e,t)}function pQ(e){if(e!=null)try{let t=__dcg_shared_module_exports__.Vc(e);return __dcg_shared_module_exports__.Rc(t)}catch(t){let r=t instanceof oB.Base?t.getInputSpan():void 0;r||(r=__dcg_shared_module_exports__.ta(e,0,e.length));let n=ie(R({},__dcg_shared_module_exports__.Qc()),{originalError:t});return __dcg_shared_module_exports__.Pc(r,n)}}var uQ={parse:dQ},WM={parse:pQ},hQ={countNumbers:iS},gQ=__dcg_shared_module_exports__.pe,mQ=__dcg_shared_module_exports__.qc,fQ=__dcg_shared_module_exports__.Fb,oB=__dcg_shared_module_exports__.wc,bQ={graphing:new __dcg_shared_module_exports__.ae({enableGeometry:!1,enable3d:!1,scales:void 0,includeFunctionParametersInRandomSeed:!0,isComplexEnabled:!1,customRegressions:!0}),scientific:new __dcg_shared_module_exports__.ke({singleExpression:!1}),fourFunction:new __dcg_shared_module_exports__.Ib({singleExpression:!1})},yQ=Bx,xQ=nf,zpe=__dcg_shared_module_exports__.e(ne()),el=__dcg_shared_module_exports__.e(ne()),mt=class extends el.Class{template(){return el.createElement("div",{role:el.const("checkbox"),tabIndex:()=>this.props.disabled&&this.props.disabled()?-1:0,"aria-label":()=>{var e,t;return(t=(e=this.props).ariaLabel)==null?void 0:t.call(e)},"aria-labelledby":()=>{var e,t;return(t=(e=this.props).labelledBy)==null?void 0:t.call(e)},"aria-describedby":()=>{var e,t;return(t=(e=this.props).describedBy)==null?void 0:t.call(e)},"aria-disabled":()=>this.props.disabled&&this.props.disabled()?!0:void 0,"aria-checked":()=>this.props.checked(),"aria-required":()=>this.props.required?this.props.required():void 0,manageFocus:()=>{var e,t;return(t=(e=this.props).manageFocus)==null?void 0:t.call(e)},class:()=>({"dcg-component-checkbox":!0,"dcg-checked":this.props.checked(),"dcg-disabled":this.props.disabled&&this.props.disabled(),"dcg-small":this.props.small&&this.props.small(),[this.props.class===void 0?"":this.props.class()]:this.props.class!==void 0}),style:()=>this.props.style?this.props.style():{},onTap:this.bindFn(this.onChange)},el.createElement("span",{class:el.const("dcg-checkbox")},el.createElement("i",{class:el.const("dcg-icon-check"),"aria-hidden":el.const("true")})),el.createElement("span",{class:el.const("dcg-checkbox-children")},this.props.children))}onChange(e){let t=e.target;t&&t.getAttribute("href")||this.props.disabled&&this.props.disabled()||this.props.onChange(!this.props.checked())}};qt(),function(){{let e="_*_";ee.Event.prototype.wasHandled=function(t){t=t||e;let r=this.originalEvent,n=r&&r.handledBy;if(n&&n[t])return!0;if(t!==e)return!1;let i=this.target.closest("[handleEvent]");return i&&i!==this.currentTarget?i.getAttribute("handleEvent")!=="false":!1},ee.Event.prototype.handle=function(t){t=t||e;let r=this.originalEvent;if(!r)return;let n=r.handledBy;n||(n=r.handledBy={}),n[t]=!0}}}();var cl=__dcg_shared_module_exports__.e(ne());qt(),mg();var uZ=e=>XM(e)||e==="localhost",hG=e=>{let{search:t,hostname:r}=typeof location!="undefined"?location:typeof window!="undefined"?window.location:new Location;return uZ(r)?new URLSearchParams(t):new URLSearchParams},Du=(e,t=hG())=>t.get(e)||void 0,$5=(e,t=hG())=>{let r=t.get(e)||void 0;return r?parseInt(r,10):void 0},ku=(e,t=hG())=>t.has(e)&&t.get(e)!=="false";navigator.userAgent.match(/MSIE 8.0/i),navigator.userAgent.match(/MSIE 9.0/i);var Y5=navigator.userAgent.match(/MSIE/i)!==null||navigator.userAgent.match(/Trident/i)!==null&&navigator.userAgent.match(/rv:11/i)!==null;navigator.userAgent.match(/Edge/i);var tl=navigator.userAgent.match(/iPad/i)!==null,Df=navigator.userAgent.match(/Mobile|Android/i)!==null||ku("forceMobile"),Qx=navigator.userAgent.match(/Android/i)!==null,Ml=navigator.userAgent.match(/(iPad|iPhone|iPod)/i)!==null||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1;navigator.userAgent.match(/Chrome/i);var FS=navigator.userAgent.match(/Firefox/i)!==null,NS=navigator.userAgent.match(/^((?!chrome|android).)*safari/i)!==null,Zo=navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)!==null,X5=navigator.platform.match(/(Win32)/i)!==null,J5=navigator.userAgent.match(/Touch/i)!==null;navigator.userAgent.match(/Kindle/i)!==null||navigator.userAgent.match(/Silk/i),navigator.userAgent.match(/KeyWeb/i);var mp=window.parent!==window,Q5=Ml||Qx||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)||ku("forceTouchDevice"),yg=(()=>{let e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return e?[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||"0",10)]:null})();(()=>{let e=navigator.appVersion.match(/OS X (\d+)_(\d+)_?(\d+)?/);return e?[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||"0",10)]:null})(),(()=>{let e=navigator.appVersion.match(/Chrom(e|ium)\/([0-9]+)\.([0-9]+)\.?([0-9]+)?/);return e?[parseInt(e[2],10),parseInt(e[3],10),parseInt(e[4]||"0",10)]:null})();var BS=!(!("inputMode"in document.createElement("textarea"))||Ml&&yg&&yg[0]<15);(()=>{let e=document.createElement("canvas");return!!(e.getContext&&e.getContext("2d"))})();var Z5=window.matchMedia("(prefers-reduced-motion: reduce)").matches||document.location.search.indexOf("prefersReducedMotion")>=0,eU=()=>document.createElement("video");(()=>{let e=eU();return e.canPlayType&&!!e.canPlayType('video/webm; codecs="vp8, vorbis"')})(),Fr(this,null,function*(){if(Du("autoplay")!==void 0)return ku("autoplay");let e=eU();e.src="data:video/mp4;base64,AAAAIGZ0eXBpc29tAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAAAu1tZGF0AAACrQYF//+p3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE1NSByMjkwMSA3ZDBmZjIyIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxOCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MzoweDExMyBtZT1oZXggc3VibWU9NyBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0xIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MSA4eDhkY3Q9MSBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0tMiB0aHJlYWRzPTMgbG9va2FoZWFkX3RocmVhZHM9MSBzbGljZWRfdGhyZWFkcz0wIG5yPTAgZGVjaW1hdGU9MSBpbnRlcmxhY2VkPTAgYmx1cmF5X2NvbXBhdD0wIGNvbnN0cmFpbmVkX2ludHJhPTAgYmZyYW1lcz0zIGJfcHlyYW1pZD0yIGJfYWRhcHQ9MSBiX2JpYXM9MCBkaXJlY3Q9MSB3ZWlnaHRiPTEgb3Blbl9nb3A9MCB3ZWlnaHRwPTIga2V5aW50PTI1MCBrZXlpbnRfbWluPTEgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD00MCByYz1jcmYgbWJ0cmVlPTEgY3JmPTI4LjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IGlwX3JhdGlvPTEuNDAgYXE9MToxLjAwAIAAAAAwZYiEAD//8m+P5OXfBeLGOfKE3xkODvFZuBflHv/+VwJIta6cbpIo4ABLoKBaYTkTAAAC7m1vb3YAAABsbXZoZAAAAAAAAAAAAAAAAAAAA+gAAAPoAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIYdHJhawAAAFx0a2hkAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAPoAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAACgAAAAWgAAAAAAJGVkdHMAAAAcZWxzdAAAAAAAAAABAAAD6AAAAAAAAQAAAAABkG1kaWEAAAAgbWRoZAAAAAAAAAAAAAAAAAAAQAAAAEAAVcQAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAAATttaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAD7c3RibAAAAJdzdHNkAAAAAAAAAAEAAACHYXZjMQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAACgAFoASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAADFhdmNDAWQACv/hABhnZAAKrNlCjfkhAAADAAEAAAMAAg8SJZYBAAZo6+JLIsAAAAAYc3R0cwAAAAAAAAABAAAAAQAAQAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAEAAAABAAAAFHN0c3oAAAAAAAAC5QAAAAEAAAAUc3RjbwAAAAAAAAABAAAAMAAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTguMTIuMTAw",e.muted=!0,e.playsInline=!0,e.style.display="none";let t=yield new Promise(r=>{document.readyState!=="loading"?r(document.body):document.addEventListener("DOMContentLoaded",()=>r(document.body))});t.appendChild(e);try{yield e.play()}catch(r){return!1}finally{t.removeChild(e)}return!0});var j5,US=(j5=window.matchMedia("(forced-colors: active)"))==null?void 0:j5.matches,sr={};__dcg_shared_module_exports__.d(sr,{ALT:()=>fG,BACKSPACE:()=>_u,CAPSLOCK:()=>yG,CONTROL:()=>mG,DELETE:()=>sU,DOWN:()=>Kn,END:()=>fp,ENTER:()=>xg,ESCAPE:()=>kn,HOME:()=>wg,LEFT:()=>ld,META:()=>bG,PAGEDOWN:()=>Au,PAGEUP:()=>Iu,RIGHT:()=>cd,SHIFT:()=>tw,SPACEBAR:()=>xG,TAB:()=>rl,UP:()=>xa,isBacktick:()=>gZ,isEnterOrSpace:()=>kf,isHelp:()=>mZ,isModifierKey:()=>rw,isRedo:()=>ew,isSelectAll:()=>hZ,isSwitchPanes:()=>gG,isUndo:()=>Zx,lookup:()=>ke,lookupChar:()=>Ko});var Zx=e=>!e.altKey&&!e.shiftKey&&(e.ctrlKey||e.metaKey)&&(e.key=="z"||e.which==90),ew=e=>!e.altKey&&(e.ctrlKey||e.metaKey)&&(e.key==="y"||e.which==89||e.shiftKey&&(e.key==="Z"||e.key==="z"||e.which===90)),hZ=e=>!e.altKey&&(e.ctrlKey||e.metaKey)&&(e.key==="a"||e.key==="A"||e.which==65),gZ=e=>!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(e.key==="`"||e.which==192),mZ=e=>!e.altKey&&(e.ctrlKey||e.metaKey)&&(e.key==="/"||e.which==191),gG=e=>e.key==="F6"||e.key==="f6"||e.which===117||e.keyCode===117,_u="Backspace",rl="Tab",xg="Enter",tw="Shift",mG="Control",fG="Alt",bG="Meta",yG="CapsLock",kn="Esc",xG="Space",Iu="PageUp",Au="PageDown",fp="End",wg="Home",ld="Left",xa="Up",cd="Right",Kn="Down",sU="Del",tU={8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",46:"Del",91:"Meta",93:"Meta"},rU={Backspace:_u,Tab:rl,Enter:xg,Shift:tw,Control:mG,Alt:fG,Meta:bG,CapsLock:yG,Escape:kn," ":xG,PageUp:Iu,PageDown:Au,End:fp,Home:wg,ArrowLeft:ld,ArrowUp:xa,ArrowRight:cd,ArrowDown:Kn,Delete:sU},rw=e=>{let t=[tw,fG,mG,yG,bG];return!!e.key&&t.includes(e.key)},kf=e=>ke(e)===xg||ke(e)===xG,oU={UIKeyInputUpArrow:xa,UIKeyInputDownArrow:Kn,UIKeyInputLeftArrow:ld,UIKeyInputRightArrow:cd,UIKeyInputEscape:kn,UIKeyInputPageUp:Iu,UIKeyInputPageDown:Au},wG=["0123456789abcdefghijklmnopqrstuvwxyz","º¡™£¢∞§¶•ªå∫ç∂ ƒ©˙ ∆˚¬µ øπœ®ß† √∑≈¥Ω","‚⁄€‹›ﬁﬂ‡°·ÅıÇÎ´Ï˝ÓˆÔÒÂ˜Ø∏Œ‰Íˇ¨◊„˛Á¸"].map(e=>e.split("")),iU=wG[0],nU=wG[1],aU=wG[2],lU={},cU={};for(let e=0;e<iU.length;e++){let t=iU[e];nU[e]!==" "&&(lU[nU[e]]=t.toUpperCase()),aU[e]!==" "&&(cU[aU[e]]=t.toUpperCase())}var ke=e=>{if(e.key&&rU[e.key])return rU[e.key];if(e.which&&tU[e.which])return tU[e.which];if(e.key&&oU[e.key])return oU[e.key]},Ko=e=>{if(!e.key)return String.fromCharCode(e.which||-1);if(Zo&&e.altKey){let t=e.shiftKey?cU:lU;if(t[e.key])return t[e.key]}if(e.key.length===1)return e.key.toUpperCase();if(e.key==="Enter")return"\r";if(e.key==="Tab")return"	"};qt();var Gl=function(e){if(!e)return;let t=e.getBoundingClientRect();return{top:t.top+window.scrollY,left:t.left+window.scrollX}},Wn=function(e,t){Object.assign(e.style,t)};function bp(e){return!!(e&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length))}function dU(e){if(document.readyState!=="loading")e();else{let t=function(){document.removeEventListener("DOMContentLoaded",t),e()};document.addEventListener("DOMContentLoaded",t)}}var fZ=document.location.href.indexOf("dcgDebugTouchTracking=dcgYES")!==-1,Mu,_f;window._touchtracking_id_counter==null&&(window._touchtracking_id_counter=0),window._touchtracking_id_counter+=1;var iw="touchtracking_id_"+window._touchtracking_id_counter,di=function(e){_f&&(_f.value="("+Date.now()+") "+e+`
`+_f.value)};function nw(e){if(e.classList.add("dcg-tap-container",iw),Ml&&e.style.setProperty("--dcg-minimum-input-font-size","16px"),fZ){Mu&&Mu.remove(),Mu=document.createElement("div"),Wn(Mu,{position:"absolute",bottom:"10px",right:"10px"});let t=document.createElement("textarea");t.setAttribute("rows","30"),t.setAttribute("cols","40"),Mu.append(t);let r=document.createElement("div");r.id="dcg-touchtracking-debug-copy",r.classList.add("dcg-btn-blue"),r.innerText="COPY LOGS",Mu.append(r),_f=Mu.querySelector("textarea"),e.append(Mu),r.addEventListener("mousedown",()=>{_f&&(_f.select(),document.execCommand("copy"))},!0),di("monitor touches")}}var Mf=0,Ll=1,aw=2,If=3,xp=4,vr=Mf,vG={},hc={},yp=[],CG=0,ow=null,qS=null,Gu=!1,zS=null,pU=Gu,Lu=function(e){let t=document.activeElement;e.type.startsWith("key")?rw(e)||(Gu=!0):e.type.startsWith("pointer")&&(Gu=!1);let r=!!(t&&wp(t));t&&!t.closest(".dcg-tap-container."+iw)&&(t=null),t!==zS?(zS&&zS.classList.remove("dcg-focus-visible"),t&&(Gu||r)&&t.classList.add("dcg-focus-visible")):pU!==Gu&&t&&!r&&(Gu?t.classList.add("dcg-focus-visible"):t.classList.remove("dcg-focus-visible")),pU=Gu,zS=t};document.addEventListener("keydown",Lu,{capture:!0}),document.addEventListener("keydown",Lu),document.addEventListener("pointerdown",Lu),document.addEventListener("pointerdown",Lu,{capture:!0}),document.addEventListener("focusin",Lu,{capture:!0}),document.addEventListener("focusin",Lu),document.addEventListener("focusout",Lu,{capture:!0}),document.addEventListener("focusout",Lu);var uU,Es=[],SG=function(e){if(!(e instanceof Element))return[];let t=e.closest(".dcg-tap-container."+iw);if(!t)return[];let r=e,n=[];for(;r;){if(n.push(r),r===t)return n;r=r.parentNode}return[]},HS=function(e,t){qS=null,vr=e,di("beginMode:"+vr),vr===Ll?yp=SG(t.originalEvent.touches[0].target):yp=SG(t.target),yp.forEach(r=>{r.classList.add("dcg-depressed")}),yp.forEach(r=>{let n=ee(r);n.data({originalScrollTop:n.scrollTop(),originalScrollLeft:n.scrollLeft()})}),hc={}};function wp(e){let t=["text","password","email","number","url","search"];return e.matches("input")&&t.indexOf(e.type)>=0||e.matches('textarea, [role="textbox"], [contenteditable=true]')||e.classList.contains("dcg-mathquill-input-span")}var Gf=function(e){if(!(e instanceof Element))return!1;let t=e.closest(".dcg-tap-container");return t?t.matches(".dcg-tap-container."+iw):!1},bZ=function(e){return vr!==If&&!wp(e)&&Gf(e)},Lf=function(e,t){qS=null;let r=!1;di("endMode:"+vr),document.querySelectorAll(".dcg-depressed").forEach(i=>{i.classList.remove("dcg-depressed")});let n=document.activeElement;if(!xU(e.target)&&n&&bZ(n))try{n.blur()}catch(i){}if(yp.forEach(i=>{let o=ee(i),a=o.data("originalScrollTop")-o.scrollTop(),s=o.data("originalScrollLeft")-o.scrollLeft();(a||s)&&(hc.scroll=!0)}),hc["dcg-tapstart"]===1&&hc["dcg-tapend"]===1&&!hc["dcg-tapcancel"]&&!hc.scroll){di("potential dcg-tap");let i=t.changedTouches[0].clientX,o=t.changedTouches[0].clientY;if(e&&!e.device&&i===0&&o===0){di("event appears to be simulated"),r=!0,vr=If;let l=e.target.getBoundingClientRect();i=(l.left+l.right)/2,o=(l.top+l.bottom)/2}di("potential dcg-tap coords:"+i+":"+o);let a=!1,s=!1;for(let l of yp){if(a)break;let c;if(typeof l.getBoundingClientRect=="function"&&(c=l.getBoundingClientRect()),typeof l.getAttribute=="function"&&l.getAttribute("tapboundary")==="true"&&(a=!0),!(c&&(i<c.left||o<c.top||i>c.right||o>c.bottom))){qS=l,s=!0,Ha("dcg-tap",e,{target:qS,touches:t.touches,changedTouches:t.changedTouches});break}}di("result of dcg-tap:  did_dispatch="+s+"  did_escape="+a)}vr===Ll||vr===xp?ow=setTimeout(()=>{ow=null,CG=new Date().getTime()},1e3):r&&(ow=setTimeout(()=>{ow=null,CG=new Date().getTime()},100)),yp=[],vr=Mf},Af=function(){return ow||new Date().getTime()-CG<500},fU=function(e){return e.identifier!==void 0?e.identifier:e.pointerId},hU=function(e){let t=[];for(let r of e)t.push({identifier:fU(r),x:r.pageX,y:r.pageY,screenX:r.screenX,screenY:r.screenY,pageX:r.pageX,pageY:r.pageY,clientX:r.clientX,clientY:r.clientY});return t},Ha=function(e,t,r){let n=fU(t),i=hU(r.touches),o=hU(r.changedTouches);if(di("dispatchEvent:"+e),e==="dcg-tapstart")vG[n]={type:e,pageX:o[0].pageX,pageY:o[0].pageY};else if(e==="dcg-tapmove"){let c=o[0],d=vG[n];if(d&&c.pageX===d.pageX&&c.pageY===d.pageY||(vr===Ll||vr===xp)&&d&&d.type==="dcg-tapstart"&&Math.abs(d.pageX-c.pageX)+Math.abs(d.pageY-c.pageY)<2)return;vG[n]={type:e,pageX:o[0].pageX,pageY:o[0].pageY}}let a=e.toLowerCase();hc[a]===void 0?hc[a]=1:hc[a]+=1;let s=ee.event.fix(t.originalEvent);s.type=e,s.device=vr===Ll||vr===xp?"touch":vr===If?"keyboard":"mouse",s.touches=i,s.changedTouches=o,s.target=r.target?r.target:t.target;let l=s.device!=="keyboard"&&hc["dcg-longhold"]>0;s.wasLongheld=function(){return l},s.preventTap=function(){hc["dcg-tapcancel"]=1},clearTimeout(uU),s.type==="dcg-tapstart"&&s.device!=="keyboard"&&s.touches.length===1&&(uU=setTimeout(()=>{Ha("dcg-longhold",t,r)},500)),s.target&&s.target.nodeName&&s.target.nodeName.toLowerCase()==="a"&&s.type==="dcg-tap"&&s.device==="keyboard"&&s.target.click&&s.target.click(),di("trigger event:"+s.type),ee(s.target).trigger(s)},KS=function(e){let t=yp,r=!!yp.length,n=document.querySelectorAll(".dcg-tap-container."+iw+" .dcg-hovered"),i=Array.from(n).filter(Gf),o=[],a=[],s=[];e&&SG(e).forEach(l=>{(!r||t.indexOf(l)!==-1)&&(i.indexOf(l)===-1&&s.push(l),o.push(l))});for(let l of i)o.indexOf(l)===-1&&a.push(l);a.forEach(l=>{l&&l.classList.remove("dcg-hovered"),ee(l).trigger("tipsyhide")}),s.forEach(l=>{l&&l.classList.add("dcg-hovered"),ee(l).trigger("tipsyshow")})},WS=function(e){for(let t of Es)if(t.pointerId===e)return!0;return!1},EG=function(e){for(let t=0;t<Es.length;t++)Es[t].pointerId===e&&Es.splice(t,1)},bU=function(e){vr===Mf&&HS(xp,e),TG(),KS(null),Es.push(e.originalEvent),Ha("dcg-tapstart",e,{touches:Es,changedTouches:[e.originalEvent]})},gU=function(e){EG(e.originalEvent.pointerId);let t={touches:Es,changedTouches:[e.originalEvent]};Ha("dcg-tapcancel",e,t),Es.length===0&&Lf(e,t)},mU=function(e){EG(e.originalEvent.pointerId);let t={touches:Es,changedTouches:[e.originalEvent]};Ha("dcg-tapend",e,t),Es.length===0&&Lf(e,t)},$S=function(e){return e.originalEvent.pointerType==="touch"},Pf=function(e,t){e.trim().split(/\s+/).forEach(r=>{let n=yZ?{passive:!1}:void 0;document.addEventListener(r,i=>{di("document.on:"+i.type),t(ee.event.fix(i))},n)})};Pf("pointerdown MSPointerDown",e=>{if(!(vr===aw||vr===Ll||!$S(e))){if(WS(e.originalEvent.pointerId)){di("exit. pointer id already exists: "+e.originalEvent.pointerId);return}bU(e)}}),Pf("pointermove MSPointerMove",e=>{vr===aw||vr===Ll||!$S(e)||(WS(e.originalEvent.pointerId)||(di("pointer id already exists: "+e.originalEvent.pointerId),bU(e)),EG(e.originalEvent.pointerId),Es.push(e.originalEvent),Ha("dcg-tapmove",e,{touches:Es,changedTouches:[e.originalEvent]}))}),ee(document).on("pointercancel MSPointerCancel",e=>{if(di("document.on:"+e.type),vr!==xp||!$S(e)||!WS(e.originalEvent.pointerId))return;gU(e);let t;for(;t=Es.pop();){let r=ee.Event(t,{originalEvent:t});gU(r)}}),ee(document).on("pointerup MSPointerUp",e=>{if(di("document.on:"+e.type),vr!==xp||!$S(e)||!WS(e.originalEvent.pointerId))return;mU(e);let t;for(;t=Es.pop();){let r=ee.Event(t,{originalEvent:t});mU(r)}});var yZ=function(){let e=!1;try{let t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",()=>{},t),window.removeEventListener("test",()=>{},t)}catch(t){}return e}();Pf("touchstart",e=>{vr===aw||vr===xp||(TG(),vr===Mf&&HS(Ll,e),KS(null),Ha("dcg-tapstart",e,{touches:e.originalEvent.touches,changedTouches:e.originalEvent.changedTouches}))}),Pf("touchmove",e=>{vr===Ll&&Ha("dcg-tapmove",e,{touches:e.originalEvent.touches,changedTouches:e.originalEvent.changedTouches})}),Pf("touchcancel",e=>{if(vr!==Ll)return;let t={touches:e.originalEvent.touches,changedTouches:e.originalEvent.changedTouches};Ha("dcg-tapcancel",e,t),e.originalEvent.touches.length===0&&Lf(e,t)}),Pf("touchend",e=>{if(vr!==Ll)return;let t={touches:e.originalEvent.touches,changedTouches:e.originalEvent.changedTouches};Ha("dcg-tapend",e,t),e.originalEvent.touches.length===0&&Lf(e,t)});function yU(){return!!(vr===Ll||vr===xp||Af())}ee(document).on("mousedown",e=>{if(di("document.on:"+e.type),!(e.button===1||e.button===2)){if(yU()){!e.target.matches("input, textarea, select")&&Gf(e.target)&&e.preventDefault(),di("abort mousedown: "+vr+":"+Af());return}HS(aw,e),Ha("dcg-tapstart",e,{touches:[e],changedTouches:[e]})}});var xU=function(e){return!(e instanceof Element)||!Gf(e)||e.closest(".dcg-do-blur")||e.closest(".dcg-text-selectable")?!1:!!e.closest(".dcg-do-not-blur")},TG=function(){try{let e=window.getSelection();if((e==null?void 0:e.rangeCount)===1){let t=e.getRangeAt(0).commonAncestorContainer;t.nodeType===Node.TEXT_NODE&&(t=t.parentNode),t&&t.closest(".dcg-text-selectable")&&e.removeAllRanges()}}catch(e){}};ee(document).on("mousedown",e=>{di("document.on:"+e.type),xU(e.target)&&e.preventDefault(),TG()}),ee(document).on("mouseleave",e=>{if(di("document.on:"+e.type),vr===Mf){if(Af()){di("abort mouseleave: "+vr+":"+Af());return}KS(null)}}),ee(document).on("mousemove",e=>{if(di("document.on:"+e.type),!(e.button===1||e.button===2)&&!(vr===Ll||vr===xp)){if(Af()){di("abort mousemove: "+vr+":"+Af());return}KS(e.target),Ha("dcg-tapmove",e,{touches:[e],changedTouches:[e]})}}),ee(document).on("mouseup",e=>{if(di("document.on:"+e.type),e.button===1||e.button===2||vr!==aw)return;let t={touches:[],changedTouches:[e]};Ha("dcg-tapend",e,t),Lf(e,t)}),ee(document).on("keydown",e=>{if(di("document.on:"+e.type),!(!kf(e)||!Gf(e.target))&&vr!==If){if(e.target.matches('a:not([ontap]), button:not([ontap]), input, textarea, select, [role="textbox"], [contenteditable="true"], summary'))return;e.preventDefault(),HS(If,e),Ha("dcg-tapstart",e,{touches:[e],changedTouches:[e]})}}),ee(document).on("keyup",e=>{if(di("document.on:"+e.type),!kf(e)||!Gf(e.target)||vr!==If)return;let t={touches:[],changedTouches:[e]};Ha("dcg-tapend",e,t),Lf(e,t)});function DG(){return vr!==Mf}function wU(){return Gu}var vU={monitor:nw,isTapActive:DG,elIsTypeable:wp,shouldIgnoreMouseDown:yU};__dcg_shared_module_exports__.e(CU()),qt();var SU=["exp|exponent ln|natural-log log","total length count mean median quantile quartile nCr nPr stats","stdev|standard-deviation stddev|standard-deviation","stdDev|standard-deviation stdevp|standard-deviation-population","stddevp|standard-deviation-population stdDevP|standard-deviation-population mad var|variance","varp|variance-population variance cov|co-variance covp|co-variance-population corr|correlation spearman","lcm mcm gcd mcd gcf mod ceil|ceiling floor round abs|absolute-value min max sign|signum signum sgn","sin|sine cos|cosine tan|tangent csc|co-secant sec|secant cot|co-tangent","sinh|hyperbolic-sine cosh|hyperbolic-cosine tanh|hyperbolic-tangent csch|hyperbolic-co-secant","sech|hyperbolic-secant coth|hyperbolic-co-tangent","arcsin|arc-sine arccos|arc-cosine arctan|arc-tangent arccsc|arc-co-secant arcsec|arc-secant","arccot|arc-co-tangent","arcsinh|hyperbolic-arc-sine arccosh|hyperbolic-arc-cosine arctanh|hyperbolic-arc-co-tangent","arccsch|hyperbolic-arc-co-secant arcsech|hyperbolic-arc-secant","arccoth|hyperbolic-arc-co-tangent","arsinh|hyperbolic-ar-sine arcosh|hyperbolic-ar-cosine artanh|hyperbolic-ar-co-tangent","arcsch|hyperbolic-ar-co-secant arsech|hyperbolic-ar-secant","arcoth|hyperbolic-ar-co-tangent","polygon","distance midpoint","sort shuffle join unique","erf|error-function","TTest|t-test ttest|t-test TScore|t-score tscore|t-score","iTTest|independent-t-test ittest|independent-t-test IndependentTTest","TScore|t-score Tscore|t-score tscore|t-score","normaldist|normal-distribution tdist|t-distribution poissondist|poisson-distribution","binomialdist|binomial-distribution","uniformdist|uniform-distribution","pdf cdf random inverseCdf inversecdf","histogram dotplot boxplot","pdf cdf","rgb hsv","for","width height","with",...__dcg_shared_module_exports__.Hb].join(" "),xZ=["det|determinant","inv|inverse","transpose","rref|reduced-row-echelon-form","trace"].join(" ");SU+=" "+xZ;var wZ="alpha beta sqrt theta phi rho pi tau nthroot cbrt sum prod integral percent infinity infty cross";function Pu(e){e||(e={});let t=[wZ];return e.disallowAns||t.push("ans"),e.disallowFrac||t.push("frac"),e.additionalCommands&&(t=t.concat(e.additionalCommands)),t.join(" ")}function kG(e){e||(e={});let t=SU;return e.additionalOperators&&e.additionalOperators.length&&(t=`${t} ${e.additionalOperators.join(" ")}`),e.includeGeometryFunctions&&(t+=" "+Object.keys(__dcg_shared_module_exports__.ge).join(" ")),e.include3DFunctions&&(t+=" "+Object.keys(__dcg_shared_module_exports__.he).join(" ")),t}function vZ(){return"for with"}function CZ(){let e="ln log";for(let[t,r]of Object.entries(__dcg_shared_module_exports__.Lc))r=="Trig"&&(e+=" "+t.replace(/^\\/,""));return e}function Vf(e){return{autoOperatorNames:kG(e),infixOperatorNames:vZ(),prefixOperatorNames:CZ()}}var EU=window.MathQuill.noConflict().getInterface(3);EU.config(ie(R({leftRightIntoCmdGoes:"up",sumStartsWithNEquals:!0,supSubsRequireOperand:!0,charsThatBreakOutOfSupSub:"+-=<>*",autoCommands:Pu(),autoSubscriptNumerals:!0,restrictMismatchedBrackets:!0,typingPercentWritesPercentOf:!0,substituteTextarea:function(e){if(!BS&&(Ml||Qx)){let r=document.createElement("span");return r.classList.add("dcg-mathquill-input-span"),r.setAttribute("tabindex",e?"0":"-1"),r.setAttribute("role","textbox"),Wn(r,{display:"inline-block",height:"1px",width:"1px"}),r}if(X5&&J5){let r=document.createElement("textarea");return r.setAttribute("readonly",""),r.setAttribute("inputmode","none"),r.setAttribute("autocorrect","off"),r.setAttribute("autocapitalize","none"),r.setAttribute("spellcheck","false"),r.setAttribute("autocomplete","off"),r.setAttribute("tabindex",e?"0":"-1"),ee(r).on("keydown",function(){this.readOnly=!1,this.select()}).on("blur",function(){this.readOnly=!0}),r}let t=document.createElement("textarea");return t.setAttribute("inputmode","none"),t.setAttribute("autocorrect","off"),t.setAttribute("autocapitalize","none"),t.setAttribute("tabindex",e?"0":"-1"),t.setAttribute("spellcheck","false"),t.setAttribute("autocomplete","off"),t}},Vf()),{quietEmptyDelimiters:"( [",resetCursorOnBlur:!0,enableDigitGrouping:!0,tripleDotsAreEllipsis:!0,disableAutoSubstitutionInSubscripts:{except:"log"},interpretTildeAsSim:!0}));var gc=EU;function Of(e){let t=__dcg_shared_module_exports__.Sc(e),r=0;for(;!__dcg_shared_module_exports__.Uc(t);)r+=1,t=__dcg_shared_module_exports__.Tc(t);return r}var Rf=class{constructor(e,t,r){this.mathField=e,this.$mathField=t,this.props=r,this.wasFocusedLastUpdate=!1,this.$mathField.on("focusin.view focusout.view",n=>this.onFocusEvent(n))}willUnmount(){this.$mathField.off(".view")}updateMathquillFocused(){var e,t,r,n;if(!this.mathField)return;let i=this.isFocused(),o=this.shouldBeFocused();o&&o!==this.wasFocusedLastUpdate&&(t=(e=this.props).selectOnFocus)!=null&&t.call(e)&&((n=(r=this.mathField).select)==null||n.call(r)),this.wasFocusedLastUpdate=o,i!==o&&(o?this.mathField.focus():this.mathField.blur())}isFocused(){var e;return!!(document.activeElement&&(e=this.mathField)!=null&&e.el().contains(document.activeElement))}shouldBeFocused(){return this.props.isFocused()}onFocusEvent(e){let t=this.isFocused();t!==this.shouldBeFocused()&&this.props.onFocusedChanged(t,e)}},N8=__dcg_shared_module_exports__.e(ne()),$i=__dcg_shared_module_exports__.e(ne());__dcg_shared_module_exports__.e(ne());var XS={IS_HOVERED:1.25,IS_PRESSED:1.125,IS_GHOSTED:.4},lw={IS_HOVERED:.5,IS_DEPRESSED:.3},_G={IS_GHOSTED:.4},JS={IS_HOVERED:.3,IS_DEPRESSED:.5},QS={IS_GHOSTED:.4},cw=1;Ss();function dw(e){let t=__dcg_shared_module_exports__.Wc(e);if(t.type!=="Assignment")return NaN;if(t._expression.type!=="Constant")return NaN;if(!new __dcg_shared_module_exports__.ae({enableGeometry:!1,enable3d:!1,scales:void 0,includeFunctionParametersInRandomSeed:!0,isComplexEnabled:!1,customRegressions:!0}).validLHS(t._symbol))return NaN;if(__dcg_shared_module_exports__.qc[t._symbol])return NaN;let r=t._expression.asValue();return typeof r=="number"?r:NaN}function EZ(e){return __dcg_shared_module_exports__.ca(e)!==null}var Ff=EZ;function ho(e,t){if(!isFinite(e))return e;if(!isFinite(t))return t;let r=__dcg_shared_module_exports__.T(e,t);if(e>0!=t>0||e===0||t===0)return 0;let n=e>0?1:-1,i=Math.abs(e).toExponential().split("e"),o=Math.abs(t).toExponential().split("e"),a=i[0],s=o[0],l=i[1],c=o[1];if(c!==l)return n*Math.pow(10,Math.max(parseFloat(l),parseFloat(c)));if(a[0]!==s[0])return parseFloat(r.toPrecision(1));let d=1;for(let u=2;u<Math.min(a.length,s.length)&&(d++,a[u]===s[u]);u++);return parseFloat(r.toPrecision(d))}var AG=1e6;function ZS(e){let t=Sg(e);if(!t)return!1;switch(t){case"anonymous-function":case"function-reference":case"point-list-reference":case"recursive-function":return!0;case"point-list":return!1}}function Sg(e){if(!e||e.type!=="expression")return;let t=e.formula,r=e.formula.recursion,n=e.formula.function_definition,i=IU(e,n);if(r&&r.type==="iterative"&&r.signature.argTypes.length===1&&r.returnType===__dcg_shared_module_exports__.wa&&e.formula.function_definition&&i!==void 0&&isFinite(i)&&Math.abs(i)<AG)return"recursive-function";if(t.is_tableable&&t.table_info)return mc(e)?t.table_info.by_reference?"point-list-reference":"point-list":t.table_info.by_reference?"function-reference":"anonymous-function"}function DU(e){let t=e.formula.table_info;if(!t)return;let r=[],n=[];if(t.values)for(let i=0;i<t.values.length;i++){let o=t.values[i][0];r.push(isNaN(o)?"":__dcg_shared_module_exports__.be(o));let a=t.values[i][1];n.push(isNaN(a)?"":__dcg_shared_module_exports__.be(a))}return{headers:[t.independent_variable,t.dependent_column],values:[r,n]}}function kU(e){let t=e.formula.table_info;if(t)return{headers:[t.dependent_column+".x",t.dependent_column+".y"],values:[[],[]]}}var IG=["-2","-1","0","1","2"];function _U(e){let t=e.formula.table_info;if(t)return t.dependent_column===t.independent_variable?{headers:["x","1x"],values:[IG,[]]}:{headers:[t.independent_variable,t.dependent_column],values:[IG,[]]}}function IU(e,t){var r,n,i;if(t)return(i=(n=(r=e.formula.recursion)==null?void 0:r.recursiveStructure)==null?void 0:n.baseCaseInfo[t])==null?void 0:i.min}function AU(e){let t=e.formula.function_definition,r=e.formula.recursion;if(!t||!r)return;let n=IU(e,t);if(n===void 0)return;let i=[];for(let o=n;o<=n+4;o++)i.push(`${o}`);return{headers:["x",`${__dcg_shared_module_exports__.ma(t)}\\left(x\\right)`],values:[i,[]]}}function MU(e){let t=e.formula.function_definition;return t?{headers:["x",`${__dcg_shared_module_exports__.ma(t)}\\left(x\\right)`],values:[IG,[]]}:void 0}var eE=class{constructor(e,t){this.cb=e,this.document=t,this.observedAriaLiveElements=new WeakMap,this.destroyed=!1,this.onAriaLabelFocus=r=>{let n=r.target;if(this.isElement(n)){let i=n.getAttribute("aria-label");i&&this.cb(i,"label")}},this.document.documentElement.addEventListener("focus",this.onAriaLabelFocus,!0),this.ariaLiveContentObserver=new MutationObserver(r=>this.handleAriaLiveContentMutations(r)),t.documentElement.querySelectorAll('[aria-live="assertive"]').forEach(r=>this.startObservingAriaLiveElement(r)),this.treeObserver=new MutationObserver(r=>this.handleDocumentTreeMutations(r)),this.treeObserver.observe(t.documentElement,{childList:!0,subtree:!0,attributeFilter:["aria-live"]})}destroy(){this.destroyed=!0,this.document.documentElement.removeEventListener("focus",this.onAriaLabelFocus,!0),this.ariaLiveContentObserver.disconnect()}isObservingElement(e){return!!this.observedAriaLiveElements.get(e)}handleAriaLiveContentMutations(e){var t;let r=new Map;for(let n of e){if(!this.observedAriaLiveElements.get(n.target))continue;let i=r.get(n.target);i||(i=[],r.set(n.target,i)),i.push(n)}for(let[n,i]of r){let o=n.cloneNode(!0),a=[o.textContent||""];for(let s=i.length-1;s>=0;s--){let l=i[s];switch(l.type){case"attributes":{l.attributeName!==null&&o.setAttribute(l.attributeName,l.oldValue||""),a.push(o.textContent||"");break}case"characterData":{l.oldValue!==null&&(o.textContent=l.oldValue),o.textContent&&o.textContent!==a[a.length-1]&&a.push(o.textContent);break}case"childList":{if(l.addedNodes.length>1||l.removedNodes.length>1)throw new Error(`Expected at most one removed node and one added node, but got ${l.removedNodes.length} removed nodes and ${l.addedNodes.length} added nodes`);l.addedNodes.length===1&&((t=o.firstChild)==null||t.remove()),l.removedNodes.length===1&&l.removedNodes.forEach(c=>o.appendChild(c.cloneNode(!0))),o.textContent&&o.textContent!==a[a.length-1]&&a.push(o.textContent);break}}}for(let s of a.reverse())this.cb(s,"alert")}}startObservingAriaLiveElement(e){this.destroyed||e.getAttribute("aria-live")==="assertive"&&(this.observedAriaLiveElements.get(e)||(this.observedAriaLiveElements.set(e,!0),e.textContent&&this.cb(e.textContent,"alert"),this.ariaLiveContentObserver.observe(e,{attributes:!0,characterData:!0,childList:!0,attributeOldValue:!0,characterDataOldValue:!0})))}stopObservingAriaLiveElement(e){this.observedAriaLiveElements.set(e,!1)}handleDocumentTreeMutations(e){for(let t of e)t.addedNodes.forEach(r=>{this.isElement(r)&&r.getAttribute("aria-live")==="assertive"&&this.startObservingAriaLiveElement(r)}),this.isElement(t.target)&&t.attributeName==="aria-live"&&(t.target.getAttribute("aria-live")==="assertive"?this.startObservingAriaLiveElement(t.target):this.stopObservingAriaLiveElement(t.target)),t.removedNodes.forEach(r=>{this.isElement(r)&&(this.stopObservingAriaLiveElement(r),r.querySelectorAll('[aria-live="assertive"]').forEach(n=>this.stopObservingAriaLiveElement(n)))})}isElement(e){var t;let r=(t=this.document.defaultView)==null?void 0:t.Element;return r?e instanceof r:!1}},dd,tE=[],GU="";function Si(){dd&&(dd.textContent="")}function yt(e){tE.push(e)}function xe(e){if(e!==void 0&&yt(e),dd&&tE.length>0){let t=tE.join(" ").replace(/ +(?= )/g,"");dd.setAttribute("aria-relevant",GU===t&&Zo?"all":"additions text"),dd.textContent=t,GU=t}tE.length=0}function DZ(){dd=document.createElement("p"),dd.setAttribute("aria-live","assertive"),dd.setAttribute("aria-atomic","true"),dd.classList.add("dcg-aria-alert"),document.body.appendChild(dd),ku("logAria")&&new eE((e,t)=>__dcg_shared_module_exports__.qe.log(`[aria ${t}] ${e}`),document)}dU(DZ);function kZ(e){return e.replace(new RegExp("(?<!\\\\left|\\\\sqrt)(\\[|\\(|\\\\\\{)","g"),"\\left$1").replace(new RegExp("(?<!\\\\right)(\\]|\\)|\\\\\\})(?!{)","g"),"\\right$1")}function _Z(e){return e.replace(/\\ |\\space(?![a-zA-Z])/g," ")}function rE(e){if(!e||e.args.length===0)return;let t=e.args[e.args.length-1];switch(t.isTrailing=!0,t.type){case"Sqrt":case"LeftRight":rE(t.arg);break;case"Frac":rE(t.num),rE(t.den);break}}function MG(e){return{type:"Other",originalType:e.type,val:e.val}}function IZ(e){switch(e.type){case"Cmd":{if(!__dcg_shared_module_exports__.Kc(e.val))return MG(e);let t=e.val.match(/^\\([a-zA-Z]+)/);if(!t)return MG(e);let r=t[1],n=[];for(let i of r)n.push({type:"Other",originalType:"Letter",val:i});return n}case"OperatorName":return pd(e.arg).args;case"EscapedSymbol":case"Letter":case"Digit":case"Symbol":return MG(e);case"Sqrt":return{type:"Sqrt",optArg:e.optArg&&pd(e.optArg),arg:pd(e.arg)};case"Frac":return{type:"Frac",num:pd(e.num),den:pd(e.den)};case"TokenNode":return{type:"TokenNode",arg:pd(e.arg)};case"SupSub":return{type:"SupSub",sup:e.sup&&pd(e.sup),sub:e.sub&&pd(e.sub),nprimes:e.nprimes};case"LeftRight":return{type:"LeftRight",left:e.left,right:e.right,arg:pd(e.arg)};default:throw new Error(`Programming Error: Invalid atom type ${e.type}`)}}function pd(e){let t=[];for(let r of e.args){let n=IZ(r);Array.isArray(n)?t.push(...n):t.push(n)}return{type:"Group",args:t}}function LU(e){try{let t=kZ(_Z(e)),r=__dcg_shared_module_exports__.Vc(t);return pd(r)}catch(t){return}}function VU(e){let t=LU(e);if(t===void 0)return()=>!1;let r=t;rE(r);function n(i){let o=LU(i);return o===void 0?!1:Ou(r,o)}return n}function Ou(e,t){if(!t)return!1;for(let r=0;r<t.args.length;r++)if(OU(e,t,r)||AZ(e,t.args[r]))return!0;return!1}function AZ(e,t){switch(t.type){case"Sqrt":return Ou(e,t.arg)||Ou(e,t.optArg);case"Frac":return Ou(e,t.num)||Ou(e,t.den);case"SupSub":return Ou(e,t.sup)||Ou(e,t.sub);case"LeftRight":return Ou(e,t.arg);case"TokenNode":return!1;case"Other":return!1;default:throw new Error(`Programming Error: Invalid atom type ${t.type}`)}}function OU(e,t,r){if(e.args.length>t.args.length-r)return!1;for(let n=0;n<e.args.length;n++)if(!MZ(e.args[n],t.args[n+r]))return!1;return!0}function Vu(e,t,r){return!e&&!t?!0:!e||!t?!1:e.args.length===0?!0:e.args.length>t.args.length||!(r!=null&&r.allowPrefix)&&e.args.length<t.args.length?!1:OU(e,t,0)}function MZ(e,t){let r=!!e.isTrailing;switch(e.type){case"Sqrt":return t.type==="Sqrt"&&Vu(e.optArg,t.optArg)&&Vu(e.arg,t.arg);case"Frac":return t.type==="Frac"&&Vu(e.num,t.num)&&Vu(e.den,t.den);case"SupSub":return t.type==="SupSub"&&e.nprimes<=t.nprimes&&(!e.sup||Vu(e.sup,t.sup))&&Vu(e.sub,t.sub,{allowPrefix:r});case"LeftRight":return t.type==="LeftRight"&&PU(e.left,t.left)&&PU(e.right,t.right)&&Vu(e.arg,t.arg,{allowPrefix:r});case"TokenNode":return t.type==="TokenNode"&&Vu(e.arg,t.arg);case"Other":return e.type===t.type&&e.val===t.val}}function PU(e,t){return e.type===t.type&&e.val===t.val}function GZ(e){return e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&")}function RU(e){let t=GZ(e);return t=t.replace(/\\\\ /g,"\\\\? "),t=t.replace(/\\\\([A-Za-z]+) ?/g,"\\\\?$1 ?"),new RegExp(t)}var FU={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function LG(e){let t=[],r=e.toLowerCase();if(r.slice(0,3)==="rgb")try{t=r.replace(/[^\d,]/g,"").split(",").slice(0,3).map(n=>parseInt(n,10))}catch(n){GG(e)}else if(r[0]==="#"){let n=/^#?([a-f\d])([a-f\d])([a-f\d])$/;r=r.replace(n,(i,o,a,s)=>o+o+a+a+s+s);try{t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/.exec(r).slice(1).map(i=>parseInt(i,16))}catch(i){GG(e)}}else t=FU[r];return LZ(t)||GG(e),{R:t[0],G:t[1],B:t[2]}}function LZ(e){return!__dcg_shared_module_exports__.G(e)||e.length!==3?!1:__dcg_shared_module_exports__.j(e,t=>Number.isInteger(t)&&t>=0&&t<=255)}function GG(e){throw new Error("Invalid color string: "+e)}function NU(e){let t=e.R/255,r=e.G/255,n=e.B/255,i=[];return i[0]=.49*t+.31*r+.2*n,i[1]=.17697*t+.8124*r+.01063*n,i[2]=.01*r+.99*n,i=__dcg_shared_module_exports__.h(i,o=>o/.17697),{X:i[0],Y:i[1],Z:i[2]}}function BU(e){let t=e.X,r=e.Y,n=e.Z,i=[];return i[0]=116*pw(r/100)-16,i[1]=500*(pw(t/95.047)-pw(r/100)),i[2]=200*(pw(r/100)-pw(n/108.883)),{L:i[0],a:i[1],b:i[2]}}function pw(e){let t=.20689655172413793;return e>Math.pow(t,3)?Math.pow(e,1/3):e/(3*t*t)+4/29}function PZ(e,t){let r=e.L,n=e.a,i=e.b,o=t.L,a=t.a,s=t.b,l=r-o,c=Math.sqrt(n*n+i*i),d=Math.sqrt(a*a+s*s),u=c-d,p=n-a,g=i-s,f=Math.sqrt(p*p+g*g-u*u),y=1+.045*c,E=1+.015*c,_=l/(1*1),w=u/(1*y),v=f/(1*E);return Math.sqrt(_*_+w*w+v*v)}function VZ(e,t){let r=BU(NU(LG(e))),n=BU(NU(LG(t)));return PZ(r,n)}function UU(e,t){let r=__dcg_shared_module_exports__.h(t,i=>VZ(e,i)),n=__dcg_shared_module_exports__.o(r);return t[r.indexOf(n)]}function OZ({R:e,G:t,B:r}){return .2126729*wr(e/255,2.4)+.7151522*wr(t/255,2.4)+.072175*wr(r/255,2.4)}var PG=.342;function VG(e,t=!1,r=PG){if(typeof e!="string"||!e)return!1;try{let n=LG(e);return OZ(n)>r?!t:t}catch(n){return!1}}function qU(e,t){let r=__dcg_shared_module_exports__.Rb(e),n=__dcg_shared_module_exports__.Rb(t);if(!__dcg_shared_module_exports__.Y(r.n/r.d,e)||!__dcg_shared_module_exports__.Y(n.n/n.d,t))return;let i=__dcg_shared_module_exports__.Tb(r.d,n.d),o=r.n*(i/r.d),a=n.n*(i/n.d)-o;return{nstart:o,nstep:a,lcm:i}}function FZ(e){return isFinite(e)?__dcg_shared_module_exports__.la(e,{digits:8,bigCutoff:1e6,smallCutoff:.001}):"\\mathrm{undefined}"}function NZ(e){return!isFinite(e[0])||!isFinite(e[1])?"\\mathrm{undefined}":__dcg_shared_module_exports__.pa(e,{digits:5,bigCutoff:1e6,smallCutoff:.001})}function BZ(e){return Array.isArray(e)?e[1]!==0:!1}function KU(e){return e.length>=1&&e.every(BZ)}function UZ(e,t,r,n){let i=e.columnModels[t];i.error=r.error,i.computed=r.computed&&!!i.latex,i.draggable=!r.error&&!r.computed,i.dependsOnRegression=!!r.depends_on_regression,i.dependsOnRecursion=!!r.depends_on_recursive_function,i.packedErrors=[],i.computedValues=[],i.hasNanOrErrorValue=!1,i.hasComplexValue=!1;for(let o=r.values.length-1;o>=0;o--){let a=r.values[o];typeof a=="number"?(i.computedValues[o]=FZ(a),isNaN(a)&&(i.hasNanOrErrorValue=!0)):Array.isArray(a)?(i.computedValues[o]=NZ(a),(isNaN(a[0])||isNaN(a[1]))&&(i.hasNanOrErrorValue=!0),a[1]!==0&&(i.hasComplexValue=!0)):(i.computedValues[o]="",i.packedErrors[o]=a,i.hasNanOrErrorValue=!0)}if(i.suppressIcon=n||t>0&&KU(r.values),r.plotted&&!i.suppressIcon)for(let o=0;o<r.values.length;o++){if(i.packedErrors[o])continue;let a=r.values[o];Array.isArray(a)&&a[1]!==0&&!isNaN(a[1])&&(i.packedErrors[o]=__dcg_shared_module_exports__.Lb().getError())}}function WU(e){let t=wa(e);if(!t)return;let r=Eg(e);if(!r){e.isExpanded||Nf(e,!0);return}t.row>=r.min&&t.row<r.max&&Nf(e,!0)}function Eg(e){if(e.isExpanded)return;let t=Pl(e);if(!(t<30))return{min:8,max:t-4}}function $U(e,t){let r=e.columnModels[t];return{values:r.values.slice(),dragMode:r.dragMode,hidden:r.hidden,id:r.id,color:r.color,points:r.points,lines:r.lines,pointStyle:r.pointStyle,lineStyle:r.lineStyle,latex:r.latex,colorLatex:r.colorLatex,lineOpacity:r.lineOpacity,lineWidth:r.lineWidth,pointSize:r.pointSize,pointOpacity:r.pointOpacity,disableGraphInteractions:r.disableGraphInteractions}}var zZ=0;function qZ(){return"table_guid_"+zZ++}function HZ(e,t,r){e.columnModels[t].values.splice(r,0,"")}function KZ(e,t,r){e.columnModels[t].values.splice(r,1)}function jU(e,t,r){let{color:n}=r;(!n||!Ff(n))&&(n=e.controller.getNextColor());let i=ie(R({},r),{type:"table-column",guid:qZ(),index:t,error:void 0,table:e,color:n,packedErrors:[],computedValues:[],shouldGraph:void 0,computed:void 0,draggable:void 0,hasNanOrErrorValue:!1,dependsOnRegression:!1,dependsOnRecursion:!1,hasComplexValue:!1,suppressIcon:!1});return t===0&&(i.hidden=!0),i}function hw(e,t){let r=e.table.formula;if(!r)return!1;let n=r.column_data[e.index];return n?!!n[t]:!1}function YU(e){return hw(e,"color_latex_valid")}function XU(e){return hw(e,"line_opacity_valid")}function JU(e){return hw(e,"line_width_valid")}function QU(e){return hw(e,"point_size_valid")}function ZU(e){return hw(e,"point_opacity_valid")}function ez(e){let t=e.table.formula;if(!t)return;let r=t.column_data[e.index];if(r)return r.color_latex_value}function tz(e){e.draggingOnGraphpaper?e.preTransientState||(e.preTransientState={columns:Bf(e,{stripDefaults:!1}).columns}):delete e.preTransientState,hd(e);let t=Ca(e),r=t&&t.hidden;__dcg_shared_module_exports__.g(e.columnModels,n=>{n.shouldGraph=!r&&!n.hidden&&!e.controller.is3dProduct()}),$Z(e),jZ(e),WZ(e)}function Pl(e){let t=2,r,n=wa(e);return n&&n.row>t&&(t=n.row),e.columnModels.forEach(i=>{r=i.computed?i.computedValues.length:i.values.length+1,r>t&&(t=r)}),t}function gw(e){return e.columnModels.length}function rz(e,t){var r;e.formula=t;let n=e.controller.is3dProduct()||KU(t.column_data[0].values);for(let i=0;i<t.column_data.length&&i<gw(e);i++){let o=t.column_data[i];UZ(e,i,o,n)}((r=t.table_regression)==null?void 0:r.status)==="success"&&e.regression&&(e.regression.residualVariable=t.table_regression.result.residualVariable)}function OG(e,t){for(let r=0;r<e.columnModels.length;r++)HZ(e,r,t)}function oz(e,t){let r=Eg(e);r&&t===r.max-1&&Nf(e,!0);for(let n=0;n<e.columnModels.length;n++)KZ(e,n,t),n>0&&vz(e.columnModels[n])}function oE(e,t){let r={id:e.controller.generateId(),latex:t?t.latex:"",color:e.controller.getNextColor()},n=t?t.columnIndex:e.columnModels.length,i=ie(R(R({},dg),r),{values:[]}),o=jU(e,n,i);e.columnModels.splice(n,0,o);for(let a=n+1;a<e.columnModels.length;a++)e.columnModels[a].index=a}function mw(e,t){var r;let[n]=e.columnModels.splice(t,1);for(let i=t;i<e.columnModels.length;i++)e.columnModels[i].index=i;n&&((r=e.regression)==null?void 0:r.columnIds.y)===n.id&&bw(e,void 0)}function iz(e,t){let r,n=e.columnModels.length,i=[];for(r=0;r<n;r++)i.push("");let o=e.columnModels[0].values;if(t>1){let a=e.controller.getDegreeMode(),s=io(o[0],a),l=io(o[1],a);if(isFinite(s)&&isFinite(l)){let c=qU(s,l);if(c){let d=c.nstart,u=d/c.lcm;for(r=0;r<t;r++){let p=io(o[r],a);if(!__dcg_shared_module_exports__.Y(p,u))return i;d+=c.nstep,u=d/c.lcm}(""+s).length<8&&(""+l).length<8?i[0]=""+u:i[0]="\\frac{"+d+"}{"+c.lcm+"}"}}}return i}function fw(e,t,r){for(let n=0;n<e.columnModels.length;n++){let i=e.columnModels[n],o={cellLocation:{column:n,row:0}};if(t(i.latex,"tableHeader",o),r!=null&&r.headersOnly)continue;t(i.colorLatex,"tableColumnColorLatex",o),t(i.pointSize,"tableColumnPointSize",o),t(i.pointOpacity,"tableColumnPointOpacity",o),t(i.lineWidth,"tableColumnLineWidth",o),t(i.lineOpacity,"tableColumnLineOpacity",o);let a=e.columnModels[n];for(let s=0;s<a.values.length;s++)a.values[s]&&t(a.values[s],"tableCellValue",{cellLocation:{column:n,row:s+1}})}}function WZ(e){let t=$C({type:"table",id:e.id,secret:e.secret,readonly:e.readonly,folderId:e.folderId,columns:e.columnModels.map(n=>$U(e,n.index)),regression:__dcg_shared_module_exports__.Jc(e.regression)});for(let n=0;n<t.columns.length;n++)t.columns[n].hidden=!e.columnModels[n].shouldGraph;e.cachedParsableState=t;let r=e.regression;if(t.regression&&r){let n=Ca(e);n&&n.hidden&&(t.regression=ie(R({},t.regression),{hidden:!0}))}}function nz(e){return e.slice(0,e.length-1)}function Bf(e,t){let r=ie(R({},e.cachedViewState),{columns:nz(e.cachedViewState.columns)});return t.stripDefaults?uN(r):(r.regression===void 0&&delete r.regression,r)}function $Z(e){let t=e.columnModels.map((r,n)=>$U(e,n));e.cachedViewState={id:e.id,type:e.type,folderId:e.folderId,columns:t,secret:e.secret,readonly:e.readonly,regression:__dcg_shared_module_exports__.Jc(e.regression)}}function RG(e,t){e.draggingOnGraphpaper=t}function jZ(e){let t=ie(R({},e.cachedViewState),{columns:nz(e.cachedViewState.columns),regression:__dcg_shared_module_exports__.Jc(e.regression)});e.cachedUndoRedoFullState=t,e.preTransientState&&(t=R(R({},t),e.preTransientState)),e.cachedUndoRedoDiffState=t}var YZ={id:!1,type:!1,columns:!1,regression:!0,folderId:!0,secret:!0,readonly:!0,disableGraphInteractions:!0};function az(e,t){__dcg_shared_module_exports__.rd({from:t,to:e,props:YZ}),lz(e,t.columns)}function sz(e,t){let r=__dcg_shared_module_exports__.Jc(WC(e)),n=ie(R(R({},r),ud(t)),{columnModels:void 0,formula:void 0,draggingOnGraphpaper:!1,cachedViewState:{},cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},isExpanded:!1});return lz(n,r.columns),n}function lz(e,t){e.columnModels=t.map((r,n)=>jU(e,n,r)),oE(e)}var HU=["x","y","z","u","v","w"];function FG(e,t,r){let n=[],i=Math.min(t.length,HU.length);for(let o=0;o<i;o++)n.push({id:r.generateId(),latex:__dcg_shared_module_exports__.ma(HU[o]+"_"+e),values:t[o],color:r.getNextColor(),hidden:!1,points:!0,lines:!1,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineWidth:"",lineOpacity:"",pointOpacity:"",pointSize:"",disableGraphInteractions:!1});return{id:r.generateId(),type:"table",folderId:"",secret:!1,readonly:!1,columns:n}}function cz(e,t){let r=Bf(e,{stripDefaults:!1});if(!r.columns||!t.columns)return t;for(let n=0;n<t.columns.length;n++){let i=r.columns[n],o=t.columns[n];if(i)for(let a in i)i.hasOwnProperty(a)&&(o.hasOwnProperty(a)||(o[a]=i[a]))}return t}function wa(e){if(!e)return;let t=e.controller.getFocusLocation();if(t&&t.type==="table"&&t.id===e.id)return t.location}function Eo(e,t){for(let r=0;r<e.columnModels.length;r++){let n=e.columnModels[r];if(n.id===t)return n}}function NG(e,t,r){let n=Eo(e,t);n&&(n.points=r,r||(n.dragMode="NONE"))}function dz(e,t,r){let n=Eo(e,t);n&&(n.pointStyle=r)}function pz(e,t,r){let n=Eo(e,t);n&&(n.lines=r)}function uz(e,t,r){let n=Eo(e,t);n&&(n.lineStyle=r)}function iE(e,t,r){let n=Eo(e,t);n&&(n.lineWidth=r)}function nE(e,t,r){let n=Eo(e,t);n&&(n.lineOpacity=r)}function aE(e,t,r){let n=Eo(e,t);n&&(n.pointSize=r)}function sE(e,t,r){let n=Eo(e,t);n&&(n.pointOpacity=r)}function hz(e,t,r){let n=Eo(e,t);if(n)if(r.type==="inert")n.disableGraphInteractions=r.disableGraphInteractions,r.disableGraphInteractions&&(n.dragMode="NONE");else{let i=r.dragMode;n.dragMode=i,i!=="NONE"&&!n.points&&(n.points=!0),i!=="NONE"&&(n.disableGraphInteractions=!1)}}function gz(e,t,r){hz(e,t,{type:"draggable",dragMode:r})}function mz(e,t,r){let n=Eo(e,t);!n||!Ff(r)||(n.color=r,n.colorLatex="")}function fz(e,t){e.regression&&(e.regression.color=t)}function bz(e,t){e.regression&&(e.regression.isLogMode=t)}function lE(e,t,r){let n=Eo(e,t);n&&(n.colorLatex=r)}function Nf(e,t){e.isExpanded=t}function yz(e,t,r){let n=Eo(e,t);n&&(n.hidden=r,r&&wz(e))}function xz(e,t,r){let n=Eo(e,t);n&&(n.boundingBoxes=r,wz(e))}function wz(e){let t=[];e.columnModels.forEach(r=>{r.boundingBoxes&&!r.hidden&&(t=t.concat(r.boundingBoxes))}),e.boundingBoxes=t}function cE(e,t){let r=Eo(e,t);return r?!r.points&&!r.lines:!0}function vp(e,t,r){if(t.row===0){let i=e.columnModels[t.column].id,o=Eo(e,i);if(!o)return;o.latex=r,t.column>=e.columnModels.length-1&&oE(e);return}let n=e.columnModels[t.column];for(let i=n.values.length;i<t.row-1;i++)n.values[i]="";e.columnModels[n.index].values[t.row-1]=r,t.column>0&&vz(e.columnModels[n.index])}function vz(e){for(;e.values.length>0&&!e.values[e.values.length-1];)e.values.pop()}function Cz(e,t){return!!e.columnModels[t.column]&&t.row>=0}function Sz(e){let t;if(e.values){for(t of e.values)if(t!=="")return!1}if(e.computedValues){for(t of e.computedValues)if(t!=="")return!1}return!0}function Ez(e){return e.computed}function Uf(e){return e.computed||e.index===e.table.columnModels.length-1}function Tz(e,t){hz(e.table,e.id,{type:"inert",disableGraphInteractions:t})}function dE(e,t,r){let n=e.columnModels[r];return n.computed?n.computedValues[t]||"":n.values[t]||""}function Dz(e){let t=Pl(e),r=gw(e);for(let n=0;n<r;n++)if(dE(e,t-1,n)!=="")return!1;return!0}function bw(e,t){var r,n;let i=!__dcg_shared_module_exports__.E((r=e.regression)==null?void 0:r.columnIds,t==null?void 0:t.columnIds)||((n=e.regression)==null?void 0:n.type)!==(t==null?void 0:t.type);e.regression=t,e.regression&&i&&(e.regression.residualVariable=void 0)}function Cp(e){return!!e.latex&&!e.error&&!e.dependsOnRegression&&!e.dependsOnRecursion}function Ru(e){return e.computedValues.length>=2&&!e.hasNanOrErrorValue&&!e.hasComplexValue}function kz(e){var t,r;let n=e.regression;if(!n)return;let i=(t=e.columnModels.find(a=>a.id===n.columnIds.x))==null?void 0:t.latex,o=(r=e.columnModels.find(a=>a.id===n.columnIds.y))==null?void 0:r.latex;return i&&o?[i,o]:void 0}var XZ=30,JZ=10,pE=__dcg_shared_module_exports__.Rd.RED,uE=__dcg_shared_module_exports__.Rd.BLUE,hE=__dcg_shared_module_exports__.Rd.GREEN,gE=__dcg_shared_module_exports__.Rd.PURPLE,mE=__dcg_shared_module_exports__.Rd.ORANGE,zf=__dcg_shared_module_exports__.Rd.BLACK;function md(e,t){switch(t){case __dcg_shared_module_exports__.Rd.RED:return e.s("graphing-calculator-text-color-red");case __dcg_shared_module_exports__.Rd.BLUE:return e.s("graphing-calculator-text-color-blue");case __dcg_shared_module_exports__.Rd.GREEN:return e.s("graphing-calculator-text-color-green");case __dcg_shared_module_exports__.Rd.PURPLE:return e.s("graphing-calculator-text-color-purple");case __dcg_shared_module_exports__.Rd.ORANGE:return e.s("graphing-calculator-text-color-orange");case __dcg_shared_module_exports__.Rd.BLACK:return e.s("graphing-calculator-text-color-black");case __dcg_shared_module_exports__.Rd.GRAY:return e.s("graphing-calculator-text-color-gray");default:let{r,g:n,b:i}=__dcg_shared_module_exports__.Nd(t),o=Math.max(r,n,i),a=Math.min(r,n,i),s=o/255,l=o===0?0:(o-a)/o,c=0;o!==a&&(o===r?c=(n-i)/(o-a)+(n<i?6:0):o===n?c=(i-r)/(o-a)+2:c=(r-n)/(o-a)+4,c/=6),c*=360,l*=100;let d=s*100;return d<10?e.s("graphing-calculator-text-color-black"):l<10?d>90?e.s("graphing-calculator-text-color-white"):d>75?e.s("graphing-calculator-text-color-light-gray"):d>50?e.s("graphing-calculator-text-color-gray"):e.s("graphing-calculator-text-color-dark-gray"):c>=0&&c<15?d<50?e.s("graphing-calculator-text-color-dark-red"):d<75?e.s("graphing-calculator-text-color-red"):e.s("graphing-calculator-text-color-light-red"):c>=15&&c<45?d<50?e.s("graphing-calculator-text-color-dark-orange"):d<75?e.s("graphing-calculator-text-color-orange"):e.s("graphing-calculator-text-color-light-orange"):c>=45&&c<75?d<50?e.s("graphing-calculator-text-color-dark-yellow"):d<75?e.s("graphing-calculator-text-color-yellow"):e.s("graphing-calculator-text-color-light-yellow"):c>=75&&c<105?d<50?e.s("graphing-calculator-text-color-dark-lime"):d<75?e.s("graphing-calculator-text-color-lime"):e.s("graphing-calculator-text-color-light-lime"):c>=105&&c<135?d<50?e.s("graphing-calculator-text-color-dark-green"):d<75?e.s("graphing-calculator-text-color-green"):e.s("graphing-calculator-text-color-light-green"):c>=135&&c<165?d<50?e.s("graphing-calculator-text-color-dark-cyan"):d<75?e.s("graphing-calculator-text-color-cyan"):e.s("graphing-calculator-text-color-light-cyan"):c>=165&&c<195?d<50?e.s("graphing-calculator-text-color-dark-teal"):d<75?e.s("graphing-calculator-text-color-teal"):e.s("graphing-calculator-text-color-light-teal"):c>=195&&c<225?d<50?e.s("graphing-calculator-text-color-dark-blue"):d<75?e.s("graphing-calculator-text-color-blue"):e.s("graphing-calculator-text-color-light-blue"):c>=225&&c<255?d<50?e.s("graphing-calculator-text-color-dark-indigo"):d<75?e.s("graphing-calculator-text-color-indigo"):e.s("graphing-calculator-text-color-light-indigo"):c>=255&&c<285?d<50?e.s("graphing-calculator-text-color-dark-violet"):d<75?e.s("graphing-calculator-text-color-violet"):e.s("graphing-calculator-text-color-light-violet"):c>=285&&c<315?d<50?e.s("graphing-calculator-text-color-dark-magenta"):d<75?e.s("graphing-calculator-text-color-magenta"):e.s("graphing-calculator-text-color-light-magenta"):c>=315&&c<345?d<50?e.s("graphing-calculator-text-color-dark-pink"):d<75?e.s("graphing-calculator-text-color-pink"):e.s("graphing-calculator-text-color-light-pink"):c>=345&&c<=360?d<50?e.s("graphing-calculator-text-color-dark-red"):d<75?e.s("graphing-calculator-text-color-red"):e.s("graphing-calculator-text-color-light-red"):e.s("graphing-calculator-text-color-unknown")}}var BG=e=>{if(!Array.isArray(e))return[e];let t=Array(Math.min(e.length,JZ));for(let r=0;r<t.length;r++)t[r]=e[Math.round(r*e.length/t.length)];return t};function _z(e,t){switch(e.type){case"single-color":case"color-array":return BG(e.value).every(n=>VG(n,t));case"shader":case"image":return!1;default:let r=e;throw new Error("Unexpected ColorSwatchSpec type: "+r.type)}}function qf(e,t,r=PG){switch(e.type){case"single-color":case"color-array":return BG(e.value).some(i=>VG(i,t,r));case"shader":case"image":return!0;default:let n=e;throw new Error("Unexpected ColorSwatchSpec type: "+n.type)}}var Hf=e=>{switch(e.type){case"single-color":return e.value;case"color-array":let t=BG(e.value);if(t.length===0)return __dcg_shared_module_exports__.Rd.BLACK;if(t.length===1)return e.value[0];let r=XZ/t.length;return`linear-gradient(to right${t.reduce((i,o,a)=>`${i}, ${o} ${a*r}px, ${o} ${(a+1)*r}px`,"")})`;case"shader":return"#808080";case"image":return'url("'+e.value+'")';default:let n=e;throw new Error("Unexpected ColorSwatchSpec type: "+n.type)}},QZ=0;function ZZ(){return"abstract_item_"+QZ++}function ud(e){return{guid:ZZ(),controller:e,index:-1,displayIndex:"-1",secretIndex:"-1",isHiddenFromUI:!0,renderShell:!0}}function fE(e,t){e.secret=t}function yw(e,t){e.readonly=t}function _n(e,t){e.type!=="folder"&&(e.folderId=t)}function hd(e){e.isHiddenFromUI=UG(e)}function Az(e){return e.isHiddenFromUI||e.filteredBySearch?"none":e.renderShell?"shell":"render"}function Fu(e){let t=xw(e),r=t.type==="color-array"?{type:"single-color",value:t.value[0]}:t;return Hf(r)}function xw(e){if(!e.colorLatex)return{type:"single-color",value:e.color};if(/^data:image/.test(e.colorLatex))return{type:"image",value:e.colorLatex};let t,r,n=!1;return e.type==="expression"?(t=yE(e),r=bE(e),n=e.formula.color_latex_valid===void 0):e.type==="table-column"&&(t=ez(e),r=YU(e)),r&&t?Array.isArray(t)?{type:"color-array",value:t}:{type:"single-color",value:t}:n?{type:"single-color",value:"#999"}:{type:"single-color",value:e.color}}function Ds(e){return e.type==="expression"||e.type==="image"||e.type==="table-column"?!!e.disableGraphInteractions:!1}var ww=class{constructor(e,t){if(this.exports=new Map,!t)return;let r=eee(e);for(let n of __dcg_shared_module_exports__.Mb(t.definitionLevel))this.exports.set(n,{name:n,isTableColumnAssignment:t.definitionLevel[n]===1,isRegressionExport:r.has(n),isMultiplyDefined:!!t.multiplyDefined[n]})}optimisticallyRegisterColumnName(e){this.cachedLastSubscripts=void 0,!this.exports.get(e)&&this.exports.set(e,{name:e,isMultiplyDefined:!1,isRegressionExport:!1,isTableColumnAssignment:!0})}isDefined(e,t){let r=this.exports.get(e);return t.includeRegressionExports?!!r:r&&!r.isRegressionExport}isMultiplyDefined(e,t){var r;return this.isDefined(e,t)&&!!((r=this.exports.get(e))!=null&&r.isMultiplyDefined)}getLastSubscriptForName(e,t){var r,n;if(e.includes("_"))throw new Error(`Programming error: ${e} already has a subscript`);this.cachedLastSubscripts===void 0&&(this.cachedLastSubscripts={});for(let i of this.exports.values()){if(!t.includeRegressionExports&&i.isRegressionExport)continue;let[o,a]=i.name.split("_"),s=parseInt(a,10);isNaN(s)||o===e&&(this.cachedLastSubscripts[e]=Math.max((r=this.cachedLastSubscripts[e])!=null?r:0,s))}return(n=this.cachedLastSubscripts[e])!=null?n:-1}};function eee(e){var t,r,n,i,o;let a=new Set;for(let s of e)if(s.type==="table"&&((r=(t=s.formula)==null?void 0:t.table_regression)==null?void 0:r.status)==="success"){let l=s.formula.table_regression.result.residualVariable,c=__dcg_shared_module_exports__.na(l);a.add(c)}else if(s.type==="expression"&&s.formula.is_regression){let l=(n=s.formula.regression)==null?void 0:n.residualVariable,c=l?__dcg_shared_module_exports__.na(l):void 0;c&&a.add(c);for(let d of(o=(i=s.formula)==null?void 0:i.exported_variables)!=null?o:[])d!==c&&a.add(d)}return a}function xE(e,t){let r=e.cachedViewState;return t.stripDefaults?__dcg_shared_module_exports__.wd(r):r}function tee(e){e.cachedViewState={type:e.type,id:e.id,title:e.title,hidden:e.hidden,inFrontOfEverything:e.inFrontOfEverything,readonly:e.readonly,collapsed:e.collapsed,secret:e.secret}}function ree(e){e.cachedUndoRedoDiffState=e.cachedViewState,e.cachedUndoRedoFullState=e.cachedViewState}function Mz(e,t){return ie(R(R({},__dcg_shared_module_exports__.Jc(__dcg_shared_module_exports__.vd(e))),ud(t)),{cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},cachedViewState:{}})}function Gz(e){oee(e),hd(e),tee(e),ree(e)}function oee(e){let t=e.controller.getAllSelectedItems();e.collapsedChildIsSelected=e.collapsed&&__dcg_shared_module_exports__.k(t,r=>r.type!=="folder"&&r.folderId===e.id)}var iee={id:!1,type:!1,hidden:!0,secret:!0,inFrontOfEverything:!0,collapsed:!0,title:!0,readonly:!0,disableGraphInteractions:!0};function Lz(e,t){__dcg_shared_module_exports__.rd({from:t,to:e,props:iee})}function Kf(e,t){e.collapsed=t}function Pz(e,t){e.title=t}function Vz(e,t){e.hidden=t}function Oz(e){return e.hidden}function Rz(e,t){e.inFrontOfEverything=t}var Wf="dcg_geometry_toolbar_",Nz={selection:{visible:!0},"box-selection":{visible:!0},"expression-edit":{visible:!0},point:{visible:!1},line:{visible:!1},segment:{visible:!1},ray:{visible:!1},vector:{visible:!1},circle:{visible:!1},arc:{visible:!1},parallel:{visible:!1},perpendicular:{visible:!1},anglebisector:{visible:!1},midpoint:{visible:!1},polygon:{visible:!1},compass:{visible:!1},angle:{visible:!1},directedangle:{visible:!1},reflect:{visible:!1},translate:{visible:!1},rotate:{visible:!1},dilate:{visible:!1}};function Bz(e){if(e.toolbar!=="all"){if(e.toolbar==="custom"){let t=__dcg_shared_module_exports__.nd(Nz,e.toolbarState),r={toolbar:"custom"};return t!==void 0&&(r.toolbarState=t),r}return e}}function Uz(e){return e===void 0?{toolbar:"all"}:e.toolbar==="custom"?{toolbar:"custom",toolbarState:__dcg_shared_module_exports__.od(Nz,e.toolbarState)}:e}function zz(e,t){return t.stripDefaults?Bz(e.cachedViewState):e.cachedViewState}function zG(e){return e.cachedUndoRedoDiffState}function nee(e){e.toolbar==="custom"?e.cachedViewState={toolbar:"custom",toolbarState:__dcg_shared_module_exports__.Jc(e.toolbarState)}:e.cachedViewState={toolbar:e.toolbar}}function qz(e){nee(e),aee(e),e.__cachedToolbarState=void 0}function Hz(e){let t=[];for(let r in e.toolbarState){let n=r,i=e.toolbarState[n];i.visible&&i.disabledLatex&&t.push({type:"geometry-toolbar-predicate",id:`${Wf}${n}`,latex:i.disabledLatex})}return t}function Kz(e,t){if(!e.toolbarState[t].disabledLatex)return;let r=e.formulas[t];if(r!=null&&r.error)return{key:"shared-calculator-error-custom-toolbar-not-condition",vars:{}}}function Wz(e,t,r){let n=t.replace(Wf,"");n in e.toolbarState&&(e.formulas[n]=r)}function aee(e){let t=e.cachedViewState;e.cachedUndoRedoDiffState=t,e.cachedUndoRedoFullState=t}function wE(e){let t=Uz(e);return{toolbar:t.toolbar,toolbarState:t.toolbar==="custom"?t.toolbarState:see(),formulas:{},selectedToolForGroup:{},__cachedToolbarState:void 0,cachedViewState:t,cachedUndoRedoDiffState:t,cachedUndoRedoFullState:t}}function $z(){return wE(void 0)}function see(){return{selection:{visible:!0},"box-selection":{visible:!0},"expression-edit":{visible:!0},point:{visible:!0},line:{visible:!0},segment:{visible:!0},ray:{visible:!0},vector:{visible:!1},circle:{visible:!0},arc:{visible:!1},parallel:{visible:!1},perpendicular:{visible:!1},anglebisector:{visible:!1},midpoint:{visible:!1},polygon:{visible:!1},compass:{visible:!1},angle:{visible:!1},directedangle:{visible:!1},reflect:{visible:!1},translate:{visible:!1},rotate:{visible:!1},dilate:{visible:!1}}}function jz(e,t){e.toolbar=t,e.__cachedToolbarState=void 0}function Yz(e,t,r){let{groups:n,items:i}=vw(e,r);for(let o of n){let a=i[o];a!=null&&a.dropdown&&a.dropdown.indexOf(t)!==-1&&(e.selectedToolForGroup[a.group]=t),t!=="box-selection"&&(a==null?void 0:a.group)==="selection"&&a!=null&&a.dropdown&&(e.selectedToolForGroup.selection=a.dropdown[0])}e.__cachedToolbarState=void 0}function vE(e,t,r){e.toolbarState[t]={visible:r.visible,disabledLatex:r.disabledLatex},e.__cachedToolbarState=void 0}function Tg(e,t){return e.toolbar==="all"?!0:e.toolbar==="none"?!1:e.toolbarState[t].visible}function $f(e,t){var r;if(e.toolbar==="all")return!0;let n=Tg(e,t);if(n&&e.formulas[t]){let i=e.formulas[t],o=(r=i==null?void 0:i.typed_constant_value)==null?void 0:r.value;return typeof o=="number"?!o:!0}return n||t==="selection"}function vw(e,t){var r;if(((r=e.__cachedToolbarState)==null?void 0:r.authorMode)===t)return e.__cachedToolbarState.state;let n={};for(let o of qG())if(o.dropdown){let a=o.dropdown.filter(s=>t||Tg(e,s));if(a.sort((s,l)=>{let c=$f(e,s),d=$f(e,l),u=Tg(e,s),p=Tg(e,l);return(c?0:u?1:2)-(d?0:p?1:2)}),a.length>0){let s=e.selectedToolForGroup[o.group];(!s||a.indexOf(s)===-1)&&(s=a[0]),!t&&!$f(e,s)&&(s=a.find(l=>$f(e,l))||a[0]),n[o.group]={group:o.group,current:s,dropdown:a.length>1?a:void 0}}}else(t||Tg(e,o.current))&&(n[o.group]=o);let i=Object.keys(n);e.__cachedToolbarState={authorMode:t,state:{groups:i,items:n}};for(let o of i){let a=n[o];e.selectedToolForGroup[o]=a==null?void 0:a.current}return{groups:i,items:n}}function qG(){return[{group:"selection",current:"selection",dropdown:["selection","box-selection"]},{group:"point",current:"point",dropdown:["point","midpoint"]},{group:"line",current:"segment",dropdown:["segment","line","ray","vector","parallel","perpendicular","anglebisector"]},{group:"circle",current:"circle",dropdown:["circle","compass","arc"]},{group:"angle",current:"angle",dropdown:["angle","directedangle"]},{group:"polygon",current:"polygon"}]}var lee=0;function cee(){return"helper_item_"+lee++}function Xz(e){return ie(R({},e),{formula:__dcg_shared_module_exports__.ee(),guid:cee(),cachedParsableState:{type:"statement",id:e.id,latex:e.latex,shouldGraph:!1}})}function Jz(e,t,r){var n;t.formula=r;let{proxy:i}=t,o=(n=r.typed_constant_value)==null?void 0:n.value,a=__dcg_shared_module_exports__.I(o)?o:NaN,s=__dcg_shared_module_exports__.G(o)&&__dcg_shared_module_exports__.j(o,__dcg_shared_module_exports__.I)?o.slice(0):void 0,l=i.listValue,c=i.numericValue;i.setPropertyWithoutNotifying("numericValue",a),i.setPropertyWithoutNotifying("listValue",s),__dcg_shared_module_exports__.E(a,c)||e.runAfterDispatch(()=>{i.notifyPropertyChange("numericValue")}),__dcg_shared_module_exports__.E(s,l)||e.runAfterDispatch(()=>{i.notifyPropertyChange("listValue")})}qt();function Qz(e,t){e.hidden=t}function ks(e,t,r){e[t]=r}function Zz(e,t){return e[t]}function e4(e,t){e.description=t}function t4(e,t){e.name=t}function SE(e,t){t.type==="inert"?(e.disableGraphInteractions=t.disableGraphInteractions,t.disableGraphInteractions&&(e.draggable=!1,e.clickableInfo=ie(R({},e.clickableInfo),{enabled:!1}))):t.type==="draggable"?(e.draggable=t.draggable,t.draggable&&(e.disableGraphInteractions=!1)):t.type==="clickable"&&(e.clickableInfo=t.clickableInfo,t.clickableInfo.enabled&&(e.disableGraphInteractions=!1))}function KG(e,t){SE(e,{type:"draggable",draggable:t})}function jf(e){if(!e.formula)return;let t=e.formula.center_reference_id,r=e.formula.center_reference_symbol;if(!t||!r)return;let n=e.controller.getItemModel(t);if(!(!n||n.type!=="expression")&&n.formula.assignment===r&&Ea(n))return n}function pee(e){let t=jf(e);if(!t)return!1;let r=Ro(t);return!(!r||r==="NONE")}function fc(e){return!e.draggable||Ds(e)?!1:pee(e)}function r4(e){if(!e.formula||!e.formula.center_is_point_literal)return!1;let t=e.formula.move_strategy;if(!t)return!1;let r=t[2],n=t[3],i=r&&r.type!=="none",o=n&&n.type!=="none";return!!(i||o)}function o4(e,t){e.opacity=t}function WG(e,t){e.foreground=t}function i4(e,t){e.image_url=t}function EE(e,t){t(e.opacity,"imageOpacity"),t(e.center,"imageCenter"),t(e.height,"imageHeight"),t(e.width,"imageWidth"),t(e.angle,"imageAngle")}function uee(e){let t=KC(e);t.color=e.color,t.index=e.index,t.guid=e.guid,t.shouldGraph=e.shouldGraph,t.showPoints=e.showPoints,e.cachedParsableState=t}function n4(e){e.draggingOnGraphpaper?e.preTransientState||(e.preTransientState={center:e.center,width:e.width,height:e.height}):delete e.preTransientState,hd(e);let t=Ca(e);e.shouldGraph=t&&t.hidden?!1:!e.hidden,e.showPoints=e.shouldGraph&&Sa(e)&&e.loadStatus==="loaded"&&!fc(e)&&e.controller.isTraceEnabled(),gee(e),mee(e),uee(e)}function a4(e,t){e.formula=t,e.error=hee(e)}function TE(e){return e.formula?e.formula.variables.map(t=>__dcg_shared_module_exports__.ma(t))||[]:[]}function hee(e){let t={scale:e.controller.s("graphing-calculator-error-log-axes-image"),center:e.controller.s("graphing-calculator-error-image-invalid-center"),angle:e.controller.s("graphing-calculator-error-image-invalid-angle"),width:e.controller.s("graphing-calculator-error-image-invalid-width"),height:e.controller.s("graphing-calculator-error-image-invalid-height"),opacity:e.controller.s("graphing-calculator-error-image-invalid-opacity")};for(let r in e.formula.errorMap)if(e.formula.errorMap[r])return t[r]}function s4(e,t){return!e.formula||!e.formula.errorMap?!1:!!e.formula.errorMap[t]}function DE(e,t){let r=e.cachedViewState;return t.stripDefaults?dN(r):r}function gee(e){let t=e.cachedViewState.clickableInfo,r=!0,n=!0;if(t&&(t.depressedImage===e.clickableInfo.depressedImage&&(n=!1),t.hoveredImage===e.clickableInfo.hoveredImage&&(r=!1)),r&&(e.hoveredImageObj&&(ee(e.hoveredImageObj).off("load"),delete e.hoveredImageObj),e.clickableInfo.hoveredImage)){e.hoveredImageObj=new Image;let i=function(){e.controller.requestRedrawGraph()},o=function(){};CE(e.hoveredImageObj,e.clickableInfo.hoveredImage,i,o)}if(n&&(e.depressedImageObj&&(ee(e.depressedImageObj).off("load"),delete e.depressedImageObj),e.clickableInfo.depressedImage)){e.depressedImageObj=new Image;let i=function(){e.controller.requestRedrawGraph()},o=function(){};CE(e.depressedImageObj,e.clickableInfo.depressedImage,i,o)}if(e.cachedViewState.image_url!==e.image_url){ee(e.imageObj).off("load"),e.imageObj=new Image;let i=function(){e.controller.dispatch({type:"image-load-success",id:e.id})},o=function(){e.controller.dispatch({type:"image-load-error",id:e.id})},a=e.controller.getGraphSettings().config.cacheRenderedSvgs?{fetchMimeType:{imageModel:e}}:void 0;CE(e.imageObj,e.image_url,i,o,a)}e.cachedViewState=R({type:e.type,id:e.id,folderId:e.folderId,image_url:e.image_url,name:e.name,hidden:e.hidden,foreground:e.foreground,secret:e.secret,readonly:e.readonly,disableGraphInteractions:e.disableGraphInteractions},vM(e))}function $G(e,t){e.draggingOnGraphpaper=t}function mee(e){let t=e.cachedViewState;e.cachedUndoRedoFullState=e.cachedViewState,e.preTransientState&&(t=R(R({},t),e.preTransientState)),e.cachedUndoRedoDiffState=t}function fee(e){let t=document.createElement("canvas");return t.width=2,t.height=2,t.getContext("2d").drawImage(e,0,0,2,2),t.toDataURL()}function CE(e,t,r,n,i={}){ee(e).on("load.initial-image-load",()=>{let s=e.width,l=e.height;s===1&&l===1?(ee(e).off(".initial-image-load"),ee(e).on("load",r),e.src=fee(e)):r()}).on("error",n);let o=/^data:/.test(t);o||(e.crossOrigin="anonymous");let{fetchMimeType:a}=i;a?o?(e.src=t,a.imageModel.mimeType=t.substring(5,t.indexOf(";"))):fetch(t).then(s=>{let l=s.headers.get("Content-type");return l&&(a.imageModel.mimeType=l),s.blob()}).then(s=>{let l=URL.createObjectURL(s);e.src=l}):e.src=t}function l4(e,t){return ie(R(R({},__dcg_shared_module_exports__.Jc(HC(e))),ud(t)),{color:__dcg_shared_module_exports__.Rd.BLUE,loadStatus:"loading",failures:0,imageObj:new Image,hoveredImageObj:void 0,depressedImageObj:void 0,mimeType:void 0,shouldGraph:void 0,showPoints:void 0,error:void 0,formula:void 0,draggingOnGraphpaper:!1,cachedViewState:{},cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{}})}var bee=R({id:!1,type:!1,image_url:!0,name:!0,folderId:!0,hidden:!0,secret:!0,readonly:!0,disableGraphInteractions:!0,foreground:!0},__dcg_shared_module_exports__.ud(qC));function c4(e,t){__dcg_shared_module_exports__.rd({from:t,to:e,props:bee})}function d4(e){let{controller:t,files:r,id:n}=e,i={errors:[],tokens:[]};for(let o=0;o<r.length;o++){let a=r[o];if(!a.type.match("image/*")){i.errors.push(t.s("graphing-calculator-error-image-invalid-file",{file:a.name}));continue}i.tokens.push(xee({controller:t,file:a,id:n}))}return i}var yee=0;function xee(e){let{controller:t,file:r,id:n}=e,i=""+yee++;return t.getGraphSettings().config.imageUploadCallback(r,(o,a)=>{setTimeout(()=>{if(o)t.dispatch({type:"image-upload-error",token:i,error:o});else{let s=new Image;CE(s,a,function(){let l=s.width,c=s.height,d=Math.max(l,c)/Math.min(l,c);l<c?(c=10,l=Math.round(10*c/d)/10):(l=10,c=Math.round(10*l/d)/10),t.dispatch({type:"image-upload-success",token:i,url:a,width:l+"",height:c+"",name:r.name,id:n})},function(){t.dispatch({type:"image-upload-error",token:i,error:!0})})}})}),i}function kE(e,t){e.loadStatus=t,t==="loaded"&&(e.failures=0),t==="failed"&&(e.failures+=1)}function jG(e){e.imageObj.src=e.imageObj.src,kE(e,"loading")}function _E(e,t,r){SE(e,{type:"clickable",clickableInfo:ie(R({},e.clickableInfo),{[t]:r})})}function p4(e,t){SE(e,{type:"clickable",clickableInfo:ie(R({},e.clickableInfo),{latex:t})})}function Dg(e){var t;return!!(e.clickableInfo.enabled&&e.formula&&((t=e.formula.click_handler)==null?void 0:t.status)==="maybe-valid")}function YG(e,t){SE(e,{type:"inert",disableGraphInteractions:t})}var IE=class{invalidate(){this.suggestedIdentifierRename=void 0}suggestionForId(e){if(this.suggestedIdentifierRename&&this.suggestedIdentifierRename.id===e)return this.suggestedIdentifierRename}updateForSelectedItem(e,t){function r(l){return Nu(e,l).length}function n(l,c){return Nu(e,l).filter(d=>d.folderId===c).length}if(!t||t.type!=="expression"){this.invalidate();return}this.suggestedIdentifierRename&&this.suggestedIdentifierRename.id!==t.id&&(this.suggestedIdentifierRename=void 0),this.suggestedIdentifierRename&&Cw(e,this.suggestedIdentifierRename.from)===0&&(this.suggestedIdentifierRename=void 0);let i=t.formula.defined_name||"",o=i?__dcg_shared_module_exports__.ma(i):"";if(!this.suggestedIdentifierRename){o&&(this.suggestedIdentifierRename={id:t.id,from:o,to:o,countOfChanges:0,folderId:void 0});return}if(o===this.suggestedIdentifierRename.to)return;if(this.suggestedIdentifierRename.to=o,this.suggestedIdentifierRename.from===this.suggestedIdentifierRename.to||!this.suggestedIdentifierRename.from||!this.suggestedIdentifierRename.to){this.suggestedIdentifierRename.countOfChanges=0;return}if(r(i)>1){this.suggestedIdentifierRename.countOfChanges=0;return}let a=__dcg_shared_module_exports__.na(this.suggestedIdentifierRename.from);if(this.suggestedIdentifierRename.folderId=void 0,r(a)>0){let l;if(t.folderId&&(l=n(a,t.folderId))===0)this.suggestedIdentifierRename.folderId=t.folderId,this.suggestedIdentifierRename.countOfChanges=l;else{this.suggestedIdentifierRename.countOfChanges=0;return}}let s=Cw(e,this.suggestedIdentifierRename.from,this.suggestedIdentifierRename.folderId);this.suggestedIdentifierRename.countOfChanges=s}},u4={folderId:"",text:"",secret:!1,readonly:!1};function h4(e){return R(R({},u4),e)}function g4(e){return __dcg_shared_module_exports__.md(u4,e)}function XG(e,t){e.text=t}function m4(e,t){return ie(R(R({},__dcg_shared_module_exports__.Jc(h4(e))),ud(t)),{cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},cachedViewState:{}})}function f4(e){hd(e),vee(e),Cee(e)}var wee={id:!1,type:!1,folderId:!0,text:!0,secret:!0,readonly:!0};function b4(e,t){__dcg_shared_module_exports__.rd({from:t,to:e,props:wee})}function AE(e,t){let r=e.cachedViewState;return t.stripDefaults?g4(r):r}function vee(e){e.cachedViewState={type:e.type,id:e.id,folderId:e.folderId,text:e.text,secret:e.secret,readonly:e.readonly}}function Cee(e){e.cachedUndoRedoDiffState=e.cachedViewState,e.cachedUndoRedoFullState=e.cachedViewState}var x4="dcg_ticker_guid_internal",See=x4;function w4(){return JG(of)}function Eee(e){e.cachedParsableState=jC(e)}function v4(e,t){return t.stripDefaults?hN(e.cachedViewState):e.cachedViewState}function C4(e){return e.cachedUndoRedoDiffState}function S4(e){return e.cachedUndoRedoFullState}function Tee(e){e.cachedViewState={handlerLatex:e.handlerLatex,minStepLatex:e.minStepLatex,playing:e.playing,open:e.open}}function Dee(e){let t=e.cachedViewState;e.cachedUndoRedoDiffState=t,e.cachedUndoRedoFullState=t}function JG(e){return ie(R({},YC(e)),{type:"ticker",guid:x4,id:See,avgDelta:0,lastTickTime:void 0,cachedViewState:{},cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},filteredBySearch:!1})}function E4(e,t){__dcg_shared_module_exports__.sd(t,e)}function T4(e,t){e.formula=t}function D4(e){Tee(e),Dee(e),Eee(e)}function k4(e,{currentFrameTime:t,previousFrameTime:r}){var n,i;if(!e.playing||((n=e.formula)==null?void 0:n.handler.status)!=="maybe-valid")return!1;if(e.lastTickTime==null||r==null)return!0;if(((i=e.formula)==null?void 0:i.minStep.status)!=="valid")return!1;let o=e.formula.minStep.value,a=e.lastTickTime+o;if(t>=a)return!0;let s=t-r;return a-t<s/2}function _4(e,t){e.lastTickTime=t}function I4(e){if(e.formula)return e.formula.handler.status==="error"?e.formula.handler.error:void 0}function A4(e){if(e.formula)return e.formula.minStep.status==="error"?e.formula.minStep.error:void 0}function Sw(e){var t;return(((t=e.formula)==null?void 0:t.variables)||[]).map(r=>__dcg_shared_module_exports__.ma(r))}function ME(e,t){t(e.handlerLatex,"tickerHandler"),t(e.minStepLatex,"tickerMinStep")}var Zf="**dcg_geo_expression_edit_tool_preview**";function M4(e){return{controller:e,__itemModelArray:[],__itemIdToModel:{},__helperIdToModel:{},__toolPreviewIdToModel:{},__anyDependsOnRandomSeed:!1,__anyFunctionDefinitionsDependOnRandomSeed:!1,__anyUnmutedTones:!1,__anyTones:!1,__anyIsAction:!1,selectedItemMap:{},tabOrder:[],drawLayers:[],colorIdx:0,expressionAnalysis:{},nextDisplayIndex:"1",ticker:w4(),renamePrompt:new IE,__exportedVariables:new ww([],void 0)}}function G4(e){for(let t=0;t<e.__itemModelArray.length;t++){let r=e.__itemModelArray[t];if(r.type==="image"&&r.loadStatus==="loading")return!0}return!1}function L4(e){let t=__dcg_shared_module_exports__.i(__dcg_shared_module_exports__.C(e.controller.getColors()),n=>n!=__dcg_shared_module_exports__.Rd.ORANGE),r=t[e.colorIdx];return e.colorIdx=(e.colorIdx+1)%t.length,r}function kg(e,t){return e.__itemModelArray[t]}function eb(e){for(let t=0;t<e.__itemModelArray.length;t++){let r=e.__itemModelArray[t];if(tb(r))return r}}function PE(e){for(let t=e.__itemModelArray.length-1;t>=0;t--){let r=e.__itemModelArray[t];if(tb(r))return r}}function Ew(e,t){let r;do{if(t--,t===-1)return;r=kg(e,t)}while(r&&!tb(r));return r}function Tw(e,t){let r,n=kw(e);do{if(t++,t===n)return;r=kg(e,t)}while(r&&!tb(r));return r}function Ca(e){if(e.type!=="folder"&&e.folderId){let t=e.controller.getListModel(),r=bd(t,e.folderId);if(r&&r.type==="folder")return r}}function P4(e,t){let r=bd(e,t);if(!r||r.type!=="folder")return 0;let n=0,i=e.__itemModelArray.length;for(let o=r.index+1;o<i;o++){let a=e.__itemModelArray[o];if(a.type==="folder"||a.folderId!==t)break;n+=1}return n}function V4(e,t){let r=bd(e,t);if(!r||r.type!=="folder")return[];let n=[],i=e.__itemModelArray.length;for(let o=r.index+1;o<i;o++){let a=e.__itemModelArray[o];if(a.type==="folder"||a.folderId!==t)break;n.push(a.id)}return n}function O4(e,t){let r=[],n=bd(e,t);if(!n||n.type!=="folder")return r;let i=e.__itemModelArray.length;for(let o=n.index+1;o<i;o++){let a=e.__itemModelArray[o];if(a.type==="folder"||a.folderId!==t)break;r.push(a)}return r}function R4(e){return!!(e&&e.readonly)}function Xf(e){if(!e)return!1;if(e.secret)return!0;let t=Ca(e);return!!(t&&t.secret&&t.id!==__dcg_shared_module_exports__.xd)}function tb(e){return!UG(e)}function F4(e){return e.id===__dcg_shared_module_exports__.xd||e.type!=="folder"&&e.folderId===__dcg_shared_module_exports__.xd}function UG(e){if(!e||e.filteredBySearch||F4(e))return!0;if(e.controller.isItemBeingDragged(e.id))return!!e.controller.shouldRenderDraggedItemAsToken();if(!e.controller.shouldShowAuthorFeatures()&&Xf(e))return!0;let t=Ca(e);return!!(t&&t.collapsed&&!e.controller.getExpressionSearchStr())}function VE(e){return e.__itemModelArray}function N4(e){return __dcg_shared_module_exports__.C(e.__helperIdToModel)}function rb(e){return __dcg_shared_module_exports__.C(e.__toolPreviewIdToModel)}function ob(e,t){for(let r=0;r<e.__itemModelArray.length;r++){let n=e.__itemModelArray[r];Jf(n,t)}for(let r in e.__toolPreviewIdToModel)Jf(e.__toolPreviewIdToModel[r],t);if(e.ticker.open&&(t(e.ticker.handlerLatex,{type:"item",location:"tickerHandler",item:e.ticker}),t(e.ticker.minStepLatex,{type:"item",location:"tickerMinStep",item:e.ticker})),e.controller.isGeometry()){let r=e.controller.getGeometryToolbarModel().toolbarState;for(let n in r){let i=n,o=r[i];o.visible&&o.disabledLatex&&t(o.disabledLatex,{type:"geometry-toolbar",tool:i})}}}function Jf(e,t){switch(e.type){case"expression":qE(e,(r,n)=>t(r,{type:"item",location:n,item:e}));break;case"table":fw(e,(r,n,i)=>t(r,R({type:"item",location:n,item:e},i)));break;case"image":EE(e,(r,n)=>t(r,{type:"item",location:n,item:e}));break;case"ticker":ME(e,(r,n)=>t(r,{type:"item",location:n,item:e}));break;case"folder":case"text":break;default:return e}}function B4(e,t){if(!ya(t))return!1;let r=!1;return ob(e,n=>{Il(n,t)&&(r=!0)}),r}function U4(e,t){let r=!1;for(let n of e.__itemModelArray)if(n.type==="table"&&(fw(n,i=>{Il(i,t)&&(r=!0)},{headersOnly:!0}),r))return!0;return!1}function z4(e,t){let r=0,n=ya(t);e.ticker.filteredBySearch=e.ticker.open&&!Il(e.ticker.handlerLatex,t)&&!Il(e.ticker.minStepLatex,t);for(let i of e.__itemModelArray){if(!n){i.filteredBySearch=!1,r++;continue}switch(i.filteredBySearch=!0,i.type){case"expression":qE(i,a=>{Il(a,t)&&(i.filteredBySearch=!1,r++)});let o=ja(i);i.label&&o&&i.label.match(LE(t))&&(i.filteredBySearch=!1,r++);break;case"table":fw(i,a=>{Il(a,t)&&(i.filteredBySearch=!1,r++)});break;case"image":EE(i,a=>{Il(a,t)&&(i.filteredBySearch=!1,r++)});break;case"folder":case"text":break;default:return i}!i.filteredBySearch&&i.type!=="folder"&&i.folderId&&(e.__itemIdToModel[i.folderId].filteredBySearch=!1,r++)}return r}function q4(e,t){let r=0,n=VU(t),i=RU(t);e.ticker.filteredBySearch=!!t&&e.ticker.open&&!n(e.ticker.handlerLatex)&&!n(e.ticker.minStepLatex);for(let o=0;o<e.__itemModelArray.length;o++){if(!t){e.__itemModelArray[o].filteredBySearch=!1;continue}let a=e.__itemModelArray[o];switch(a.filteredBySearch=!0,a.type){case"expression":qE(a,l=>{n(l)&&(a.filteredBySearch=!1,r++)});let s=ja(a);ub(a)&&(a.label||s)&&(t==="\\operatorname{label}"||t.length>1&&"label".indexOf(t)===0||n(a.label))&&(a.filteredBySearch=!1,r++);break;case"table":fw(a,l=>{n(l)&&(a.filteredBySearch=!1,r++)});break;case"image":t==="\\operatorname{image}"||t.length>1&&"image".indexOf(t)===0?(a.filteredBySearch=!1,r++):EE(a,l=>{n(l)&&(a.filteredBySearch=!1,r++)});break;case"folder":a.title&&a.title.indexOf(t)>=0&&(a.filteredBySearch=!1,r++);break;case"text":i.test(a.text)&&(a.filteredBySearch=!1,r++);break;default:return a}!a.filteredBySearch&&a.type!=="folder"&&a.folderId&&(e.__itemIdToModel[a.folderId].filteredBySearch=!1,r++)}return r}function LE(e,t){return new RegExp("\\$\\{"+e.replace("{","\\{?").replace("}","\\}?").replace("_","\\_?")+"\\}",t)}function Cw(e,t,r){let n=0;for(let i=0;i<e.__itemModelArray.length;i++){let o=e.__itemModelArray[i];if(!(o.type!=="expression"||r&&o.folderId!==r)&&ja(o)&&o.label){let a=o.label.match(LE(t,"g"));a&&(n+=a.length)}}return ob(e,(i,o)=>{r&&(o.type!=="item"||o.item.type==="ticker"||o.item.type==="folder"||o.item.folderId!==r)||(n+=ZC(i,t).length)}),n}function fd(e,t,r,n){e.renamePrompt.invalidate(),r=r.trim().replace(/_\{([a-zA-Z0-9])\}/g,"_$1");for(let i=0;i<e.__itemModelArray.length;i++){let o=e.__itemModelArray[i];if(o.type==="expression"){if((n==null?void 0:n.limitToFolder)!==void 0&&n.limitToFolder!==o.folderId)continue;let a=ja(o);o.label&&a&&o.label.match(LE(t))&&yd(o,o.label.replace(LE(t,"g"),"${"+r.trim()+"}"))}}ob(e,(i,o)=>{if(n&&n.limitToItem!==void 0&&(o.type!=="item"||n.limitToItem!==o.item.id)||n&&n.limitToFolder!==void 0&&(o.type!=="item"||o.item.type==="ticker"||o.item.type==="folder"||n.limitToFolder!==o.item.folderId))return;let a=eS(i,t,r);if(o.type==="geometry-toolbar"){let l=e.controller.getGeometryToolbarModel();vE(l,o.tool,{visible:!0,disabledLatex:a});return}let s=o.item;if(a!==i){let l;switch(o.cellLocation!==void 0&&s.columnModels&&(l=s.columnModels[o.cellLocation.column].id),o.location){case"latex":{$a(s,a);break}case"cdfMin":{WE(s,a);break}case"cdfMax":{$E(s,a);break}case"colorLatex":{Rw(s,a);break}case"lineWidth":{db(s,a);break}case"resolution":{HE(s,a);break}case"clickableInfoLatex":{UE(s,a);break}case"fillOpacity":{Lw(s,a);break}case"surfaceOpacity":{Pw(s,a);break}case"lineOpacity":{cb(s,a);break}case"pointOpacity":{Vw(s,a);break}case"pointSize":case"movablePointSize":Ow(s,a);break;case"labelAngle":{KE(s,a);break}case"labelSize":{Fw(s,a);break}case"polarDomainMin":{Ka(s,a,"theta");break}case"polarDomainMax":{Wa(s,a,"theta");break}case"parametricDomainMin":{Ka(s,a,"t");break}case"parametricDomainMax":{Wa(s,a,"t");break}case"parametricDomain3DuMin":{Ka(s,a,"u");break}case"parametricDomain3DuMax":{Wa(s,a,"u");break}case"parametricDomain3DvMin":{Ka(s,a,"v");break}case"parametricDomain3DvMax":{Wa(s,a,"v");break}case"parametricDomain3DrMin":{Ka(s,a,"r");break}case"parametricDomain3DrMax":{Wa(s,a,"r");break}case"parametricDomain3DphiMin":{Ka(s,a,"phi");break}case"parametricDomain3DphiMax":{Wa(s,a,"phi");break}case"sliderMin":{sb(s,a);break}case"sliderMax":{lb(s,a);break}case"sliderStep":{Gw(s,a);break}case"imageOpacity":{ks(s,"opacity",a);break}case"imageCenter":{ks(s,"center",a);break}case"imageHeight":{ks(s,"height",a);break}case"imageWidth":{ks(s,"width",a);break}case"imageAngle":{ks(s,"angle",a);break}case"tickerHandler":{s.handlerLatex=a;break}case"tickerMinStep":{s.minStepLatex=a;break}case"tableHeader":case"tableCellValue":if(!o.cellLocation||s.type!=="table")break;vp(s,o.cellLocation,a);break;case"tableColumnColorLatex":{l&&lE(s,l,a);break}case"tableColumnPointSize":{l&&aE(s,l,a);break}case"tableColumnPointOpacity":{l&&sE(s,l,a);break}case"tableColumnLineWidth":{l&&iE(s,l,a);break}case"tableColumnLineOpacity":{l&&nE(s,l,a);break}case"residualVariable":break;default:{let c=o.location;throw new Error(`Unexpected latex location ${c}`)}}}})}function OE(e){let t=[];ob(e,n=>{if(n.indexOf("~")!==-1||n.indexOf("\\sim")!==-1)return;let i=/_(\d)|_\{(?:\s|\\space)*(\d+)(?:\s|\\space)*\}/g;for(;;){let o=i.exec(n);if(!o)break;t.push(parseInt(o[1]||o[2],10))}}),t.sort((n,i)=>n-i);let r=1;for(let n=0;n<t.length;n++)t[n]===r&&r++;return r}function H4(e){let t=0;return ob(e,r=>{let n=/\\token\{(\d+)\}/g;for(;;){let i=n.exec(r);if(!i)break;let o=parseInt(i[1],10);o>t&&(t=o)}}),t}function K4(e){let t={};return ob(e,r=>{if(r.indexOf("~")!==-1||r.indexOf("\\sim")!==-1)return;let n=/(\\?[a-zA-Z]+)_(\d)|(\\?[a-zA-Z]+)_\{(?:\s|\\space)*(\d+)(?:\s|\\space)*\}/g;for(;;){let i=n.exec(r);if(!i)break;let o=i[1]||i[3],a=i[2]||i[4];o[0]!=="\\"&&(o=o[o.length-1]);let s=parseInt(a,10);t[o]||(t[o]=0),s>t[o]&&(t[o]=s)}}),t}function W4(e,t){let r=[],n=[],i=[],o=[],a={points:[],angles:[],polygons:[],other:[]};function s(c){if(Mee(e,c.id)&&t!=="actual"||c.id===Zf&&t!=="preview")return;if(c.type==="expression"&&c.folderId===__dcg_shared_module_exports__.xd){mc(c)?a.points.push(c.id):zu(c)?a.angles.push(c.id):pb(c)?a.polygons.push(c.id):a.other.push(c.id);return}let d=!1;if(c.type!=="folder"&&c.folderId){let p=e.__itemIdToModel[c.folderId];p&&p.type==="folder"&&p.inFrontOfEverything&&(d=!0)}let u=i;d?u=o:c.type==="image"&&!c.foreground&&(u=n),c.type==="table"?(c.regression&&(r.push(c.regression.id),u.push(c.regression.id)),__dcg_shared_module_exports__.g(c.columnModels,p=>{r.push(p.id),u.push(p.id)})):(r.push(c.id),u.push(c.id))}e.__itemModelArray.forEach(s),rb(e).forEach(s);let l=[...a.polygons,...a.other,...a.angles,...a.points];r.push(...l),i.push(...l),e.tabOrder=r,e.drawLayers=[],n.length&&e.drawLayers.push({layer:-1,drawOrder:n,drawSet:new Set(n)}),e.drawLayers.push({layer:0,drawOrder:i,drawSet:new Set(i)}),o.length&&e.drawLayers.push({layer:1,drawOrder:o,drawSet:new Set(o)})}function bd(e,t,r){let n=e.__itemIdToModel[t];if(n)return n;if(r&&r.includePreviewItems)return e.__toolPreviewIdToModel[t]}function $4(e,t){return!!e.__toolPreviewIdToModel[t]}function Nu(e,t){var r;let n=[];for(let i=0;i<e.__itemModelArray.length;i++){let o=e.__itemModelArray[i];o.type==="expression"&&((r=pi(o))==null?void 0:r.identifier)===t&&n.push(o)}return n}function kee(e,t){return e.__helperIdToModel[t]}function j4(e){return __dcg_shared_module_exports__.C(e.__helperIdToModel)}function Y4(e,t){let r=Xz(t);e.__helperIdToModel[r.id]=r,Object.defineProperty(t.proxy,"isActive",{get:()=>{var n;return((n=e.__helperIdToModel[r.id])==null?void 0:n.proxy)===r.proxy}})}function Dw(e){e.__anyUnmutedTones=e.__itemModelArray.some(t=>Aw(t)),e.__anyTones=e.__anyUnmutedTones||e.__itemModelArray.some(t=>Is(t))}function X4(e,t){e.__exportedVariables=new ww(VE(e),t)}function ZG(e){e.__anyDependsOnRandomSeed=!1,e.__anyFunctionDefinitionsDependOnRandomSeed=!1;for(let t=0;t<e.__itemModelArray.length;t++){let r=e.__itemModelArray[t];r&&"formula"in r&&r.formula&&r.formula.depends_on_random_seed&&(e.__anyDependsOnRandomSeed=!0,r.type==="expression"&&r.formula.function_definition&&(e.__anyFunctionDefinitionsDependOnRandomSeed=!0))}}function J4(e){e.__anyIsAction=!1}function RE(e){if(!e.__anyIsAction){if(e.ticker.open){e.__anyIsAction=!0;return}for(let t=0;t<e.__itemModelArray.length;t++){let r=e.__itemModelArray[t];if(r&&"formula"in r&&r.formula){if(r.type!=="expression"&&r.type!=="image")continue;let{formula:n}=r;if(n.hasOwnProperty("action_value")||n.hasOwnProperty("click_handler")){e.__anyIsAction=!0;return}}}}}function _g(e){ku("showIDs")?Iee(e):_ee(e);for(let t in e.selectedItemMap)e.__itemIdToModel[t]||delete e.selectedItemMap[t]}function _ee(e){let t=!e.controller.shouldShowAuthorFeatures(),r=1,n=1;for(let i=0;i<e.__itemModelArray.length;i++){let o=e.__itemModelArray[i];o.index=i,o.displayIndex=""+r,Xf(o)&&(o.secretIndex=""+n,n+=1),!F4(o)&&(!t||!Xf(o))&&(r+=1)}e.nextDisplayIndex=""+r}function Iee(e){for(let t=0;t<e.__itemModelArray.length;t++){let r=e.__itemModelArray[t];r.index=t;let n=r.id.length<=6?r.id:r.id.substring(0,4)+"…";r.displayIndex=n,Xf(r)&&(r.secretIndex=n)}e.nextDisplayIndex=""}function Aee(e){e.renamePrompt.invalidate(),e.__itemModelArray=[],e.__itemIdToModel={},e.__helperIdToModel={},e.__toolPreviewIdToModel={},e.__anyDependsOnRandomSeed=!1,e.__anyFunctionDefinitionsDependOnRandomSeed=!1,e.__anyUnmutedTones=!1,e.__anyTones=!1}function kw(e){return e.__itemModelArray.length}function Q4(e){return e.__itemModelArray.filter(t=>t.type==="expression"&&t.folderId===__dcg_shared_module_exports__.xd&&!!Hi(t)).length}function Z4(e){return e.nextDisplayIndex==="1"}function eq(e){let t=[];for(let r=0;r<e.__itemModelArray.length;r++){let n=e.__itemModelArray[r];n.type==="expression"&&n.sliderExists&&t.push(n)}return t}function Ig(e){let t;for(let r in e.selectedItemMap){if(t!==void 0)return;t=r}if(t!==void 0)return e.__itemIdToModel[t]}function Mee(e,t){return!!e.selectedItemMap[t]}function tq(e){return Object.keys(e.selectedItemMap)}function FE(e){let t=[];for(let r in e.selectedItemMap)t.push(e.__itemIdToModel[r]);return t}function rq(e){return{list:e.__itemModelArray.map(t=>t.cachedUndoRedoDiffState),ticker:C4(e.ticker)}}function eL(e){return{list:e.__itemModelArray.map(t=>t.cachedUndoRedoFullState),ticker:S4(e.ticker)}}function oq(e,t){let r={list:e.__itemModelArray.map(i=>{switch(i.type){case"expression":return Mw(i,t);case"image":return DE(i,t);case"table":return Bf(i,t);case"folder":return xE(i,t);case"text":return AE(i,t);default:return i}})},n=v4(e.ticker,t);return n&&(r.ticker=n),r}function*Gee(e){for(let t=e.list.length-1;t>=0;t--){let r=e.list[t];if(yield r.id,r.type==="table"&&r.columns)for(let n=r.columns.length-1;n>=0;n--)yield r.columns[n].id;r.type==="table"&&r.regression&&(yield r.regression.id)}}function iq(e){let t=0,r=/^[0-9]+$/;for(let n of Gee(e))if(r.test(n)){let i=parseInt(n,10);i>t&&(t=i)}return t}function nq(e,t,r){r||(r={});let n,i;for(e.colorIdx=0,Aee(e),e.expressionAnalysis={},n=0;n<t.list.length;n++){if(i=Qf(e,t.list[n]),r.remapColors&&"color"in i&&i.color){let o=__dcg_shared_module_exports__.C(e.controller.getColors());__dcg_shared_module_exports__.l(o,i.color)||(i.color=UU(i.color,o))}e.__itemModelArray.push(i),e.__itemIdToModel[i.id]=i}if(e.ticker=JG(t.ticker),_g(e),e.nextDisplayIndex==="1"){let o=Qf(e,{type:"expression",id:e.controller.generateId(),color:e.controller.getNextColor()});_s(e,o,e.__itemModelArray.length)}}function Qf(e,t){switch(t.type){case"expression":return zE(t,e.controller);case"table":return sz(t,e.controller);case"image":return l4(t,e.controller);case"folder":return Mz(t,e.controller);case"text":return m4(t,e.controller);default:return t}}function aq(e,t){let r,n,i=e.__itemIdToModel;for(e.__itemModelArray=[],e.__itemIdToModel={},e.renamePrompt.invalidate(),r=0;r<t.list.length;r++){let o=t.list[r];if(n=i[o.id],n&&n.type===o.type)switch(n.type){case"expression":if(o.type!==n.type)throw new Error("invalid restoration");wq(n,o);break;case"table":if(o.type!==n.type)throw new Error("invalid restoration");az(n,o);break;case"image":if(o.type!==n.type)throw new Error("invalid restoration");c4(n,o);break;case"folder":{if(o.type!==n.type)throw new Error("invalid restoration");Lz(n,o)}break;case"text":if(o.type!==n.type)throw new Error("invalid restoration");b4(n,o);break;default:return n}else n=Qf(e,o);e.__itemModelArray.push(n),e.__itemIdToModel[n.id]=n}t.ticker&&E4(e.ticker,t.ticker),ZG(e),RE(e),Dw(e),X4(e,void 0),_g(e)}function sq(e,t,r){let n=r[0]&&r[0].tableId,i=bd(e,n||t);if(!i)return;let o;switch(i.type){case"expression":let a=!1,s=!1,l;i.__workerNeedsDotplotXMode=!1;for(let u=0;u<r.length;u++){let p=r[u];if("recursionTerminationStatus"in p&&p.recursionTerminationStatus===1&&(s=!0),"nanBlame"in p&&p.nanBlame!==void 0&&(l=p.nanBlame),p.graphMode===15){i.error=p.error;continue}"resolved"in p&&!p.resolved&&(a=!0),"boundingBox"in p&&p.boundingBox&&(o||(o=[]),o.push(p.boundingBox)),p.needsDotplotXMode&&(i.__workerNeedsDotplotXMode=!0)}i.unresolved=a,i.boundingBoxes=o,i.recursiveDepthPlottingError=s,i.nanBlame=l;let c=1/0,d=-1/0;for(let u of r){if(u.graphMode!==6)continue;let p=u.sampledDomain;p&&(c=Math.min(c,p.min),d=Math.max(d,p.max))}isFinite(c)&&(i.__workerSampledDomainMin=c),isFinite(d)&&(i.__workerSampledDomainMax=d);return;case"table":for(let u=0;u<r.length;u++){let p=r[u];"boundingBox"in p&&p.boundingBox&&(o||(o=[]),o.push(p.boundingBox))}o&&xz(i,t,o);return;default:return}}function lq(e,t,r){var n;let i,o,a,s=__dcg_shared_module_exports__.Jc(e.expressionAnalysis);for(i in t){if(!t.hasOwnProperty(i))continue;a=t[i],o=bd(e,i);let l={isGraphable:!!a.is_graphable,isError:!!a.error,errorMessage:a.error?e.controller.unpack(a.error):void 0};if(o)switch(o.type){case"expression":QG(o,a);let{value:d,valueType:u}=(n=a.typed_constant_value)!=null?n:{};d!==void 0&&(u===__dcg_shared_module_exports__.Ba?l.evaluation={type:"ListOfNumber",value:d.slice()}:__dcg_shared_module_exports__.ua(u,__dcg_shared_module_exports__.wa)&&(l.evaluation={type:"Number",value:d}),l.evaluationDisplayed=!!a.is_evaluable);break;case"image":a4(o,a);break;case"table":rz(o,a);break;case"folder":case"text":break;default:return o}else i===e.ticker.id&&T4(e.ticker,a);let c=kee(e,i);if(c)Jz(e.controller,c,a);else{let d=e.__toolPreviewIdToModel[i];d&&QG(d,a)}i.startsWith(Wf)&&Wz(e.controller.getGeometryToolbarModel(),i,a),i!==e.ticker.id&&!i.startsWith(Wf)&&(s[i]=l)}ZG(e),Dw(e),RE(e),X4(e,r),e.expressionAnalysis=s}function Nr(e,t){e.selectedItemMap={},t&&(e.selectedItemMap[t.id]="selected")}function cq(e){return Object.values(e.selectedItemMap).some(t=>t==="tentatively-selected")}function dq(e,t){e.selectedItemMap={},t&&(e.selectedItemMap[t.id]="tentatively-selected")}function pq(e){for(let t in e.selectedItemMap)e.selectedItemMap[t]==="tentatively-selected"&&(e.selectedItemMap[t]="selected")}function uq(e){for(let t in e.selectedItemMap)e.selectedItemMap[t]==="tentatively-selected"&&delete e.selectedItemMap[t]}function tL(e,t,r){e.selectedItemMap[t]?delete e.selectedItemMap[t]:e.selectedItemMap[t]=r}function rL(e,t){e.selectedItemMap={};for(let r in t)e.selectedItemMap[r]="selected"}function Uu(e,t,r,n){if(t===r)return;let i=e.__itemModelArray.splice(t,n);t<r&&(r=r-n+1),e.__itemModelArray.splice.apply(e.__itemModelArray,[r,0,...i]),_g(e)}function _s(e,t,r){let n=String(t.id);if(e.__itemIdToModel.hasOwnProperty(n))throw Error("Item with id '"+n+"' is already in list");e.__itemIdToModel[n]=t,e.__itemModelArray.splice(r,0,t),_g(e)}function ol(e,t){_s(e,t,kw(e))}function ib(e,t){let r=[],n=e.__itemModelArray[t];if(n.type==="folder"){let i=0,o=t+1;for(let a=o;a<e.__itemModelArray.length;a++){let s=e.__itemModelArray[a];if(s.type==="folder"||s.folderId!==n.id)break;Sa(s)&&Nr(e,void 0),s.readonly?(a>o&&(e.__itemModelArray[a]=e.__itemModelArray[o],e.__itemModelArray[o]=s),_n(s,""),o+=1):(delete e.__itemIdToModel[s.id],delete e.expressionAnalysis[n.id],i+=1)}i>0&&r.push(...e.__itemModelArray.splice(o,i))}return Sa(n)&&Nr(e,void 0),r.push(...e.__itemModelArray.splice(t,1)),delete e.__itemIdToModel[n.id],delete e.expressionAnalysis[n.id],ZG(e),r.some(i=>Is(i))&&Dw(e),_g(e),r}function hq(e){return e.__anyDependsOnRandomSeed}function gq(e){return e.__anyFunctionDefinitionsDependOnRandomSeed}function mq(e){return e.__anyIsAction}function fq(e){return e.__anyUnmutedTones}function Ag(e,t){let r=bd(e,t);return r?ib(e,r.index):[]}function NE(e){let t=Ig(e);if(!t)return!1;let r=Ew(e,t.index);return r?(Nr(e,r),r.index===kw(e)-1&&t.type==="expression"&&Vl(t)&&ib(e,r.index),!0):!1}function BE(e){let t=Ig(e);if(!t)return!1;let r=Tw(e,t.index);return r?(Nr(e,r),!0):!1}function bq(e,t){let r=e.selectedItemMap;return t in r?r[t]:void 0}function Sa(e){return!!e.controller.getListModel().selectedItemMap[e.id]}function yq(e){if(!e.controller.shouldShowAuthorFeatures()){e.renamePrompt.invalidate();return}let t=Ig(e);e.renamePrompt.updateForSelectedItem(e,t)}function _w(e,t){e.dragState=t}function Iw(e){switch(e.type){case"expression":return ab(e);case"image":return TE(e);case"table":return[];case"text":return[];case"folder":return[];default:return e}}function xq(e,t){for(let r of VE(e))r.type==="folder"&&Kf(r,t)}function nb(e){return e?e.type==="image"&&Dg(e)||e.type==="expression"&&$n(e):!1}function oL(e){return e.__exportedVariables}Ss();var hb=class{suspend(){return new Promise((e,t)=>{if(this.audioContext)this.audioContext.suspend().then(()=>{e()}).catch(r=>{t(r)});else{e();return}})}getResumedAudioContext(){return new Promise((e,t)=>{if(!this.audioContext){let r=window.AudioContext||window.webkitAudioContext;if(!r){t();return}try{this.audioContext=new r({latencyHint:"interactive",sampleRate:44100})}catch(n){t(n)}}this.audioContext&&(this.audioContext.state!=="running"?this.audioContext.resume().then(()=>{e({audioContext:this.audioContext,poiBuffer:this.poiBuffer})}).catch(r=>{t(r)}):this.audioContext.resume().then(()=>{e({audioContext:this.audioContext,poiBuffer:this.poiBuffer})}).catch(r=>{t(r)}))})}},Lee=.25;function vq(e,t){return Lee*__dcg_shared_module_exports__.$(e,0,Pee(t))}function Pee(e){return e<=0||!isFinite(e)?0:__dcg_shared_module_exports__.$(660/e,0,10)}var jn,Vee="data:audio/mpeg;base64,//uQx"+"A".repeat(23)+"WGluZwAAAA8AAAACAAACcQCA"+"gICA".repeat(16)+"/".repeat(66)+"8AAABhTEFNRTMuMTAwA8MAAAAAAAAAABQgJAUHQQAB9AAAAnGMHkkI"+"A".repeat(320)+"//sQxAADgnABGiAAQBCqgCRMAAgEAH"+"/".repeat(15)+"7+n/9FTuQsQH//////2NG0jWUGlio5gLQTOtIoeR2WX////X4s9Atb/JRVCbBUpeRUq"+"/".repeat(18)+"9RUi0f2jn/+xDECgPCjAEQAABN4AAANIAAAAQVTEFNRTMuMTAw"+"V".repeat(97)+"Q==";function Oee(){jn&&(jn.src="about:blank",jn.load(),jn=void 0)}function jE(){if(!(!tl&&!Ml)){if(!jn){let e=document.createElement("div");jn=document.createElement("audio"),e.appendChild(jn),jn.setAttribute("x-webkit-airplay","deny"),jn.controls=!1,jn.disableRemotePlayback=!0,jn.preload="auto",jn.loop=!0,jn.src=Vee,jn.load()}jn.paused&&jn.play().catch(Oee)}}function YE(){jn&&jn.pause()}var Cq=44100,xd=FS?.02:0,Nw=class{constructor(e){this.expressionSynthMap=new Map,this.useOfflineContext=!1,this.globalUnmuteState=!1,this.hasEverInteractedWithMute=!1,this.maxGain=.5,this.handleVisibilityChange=()=>{!this.audioContext||this.isGlobalMuted()||document.visibilityState==="hidden"&&this.controller.dispatch({type:"mute-global"})},this.handleBeforeUnload=()=>{if(!this.audioContext||this.isGlobalMuted())return;let t=this.audioContext;t instanceof AudioContext&&setTimeout(()=>{if(t.state!=="closed")try{t.close()}catch(r){}},100),this.controller.dispatch({type:"mute-global"}),this.controller.runAfterDispatch(()=>this.clearAudioContext())},this.audioContextManager=new hb,this.controller=e,document.addEventListener("visibilitychange",this.handleVisibilityChange),window.addEventListener("beforeunload",this.handleBeforeUnload)}unload(){this.handleBeforeUnload()}setOfflineAudio(){this.useOfflineContext=!0}prepareToRenderAudio(e){this.useOfflineContext&&(this.offlineBuffer=void 0,this.audioContext=new OfflineAudioContext(1,e*Cq,Cq),this.audioContext.addEventListener("complete",t=>Fr(this,null,function*(){this.offlineBuffer=t.renderedBuffer,this.clearAudioContext()})),this.createMainNodes(),this.recomputeAudio())}getHasEverInteractedWithMute(){return this.hasEverInteractedWithMute}registerMuteInteraction(){this.hasEverInteractedWithMute=!0}startRendering(){return Fr(this,null,function*(){return this.audioContext.startRendering()})}getRenderedBuffer(){return this.offlineBuffer}clearAudioContext(){for(let e of this.expressionSynthMap.values())e.tearDown();this.audioContext=void 0,this.expressionSynthMap=new Map}spinUpAudioContext(){return Fr(this,null,function*(){if(!this.useOfflineContext){if(this.audioContext)this.audioContext.state==="suspended"&&!this.useOfflineContext&&(yield this.audioContext.resume());else{let e=yield this.audioContextManager.getResumedAudioContext();this.audioContext=e.audioContext}this.gainNode||this.createMainNodes()}})}createMainNodes(){this.audioContext&&(this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=0,this.compressor=this.audioContext.createDynamicsCompressor(),this.compressor.threshold.value=-10,this.compressor.knee.value=4,this.compressor.ratio.value=20,this.compressor.attack.value=.01,this.compressor.release.value=.01,this.gainNode.connect(this.compressor),this.compressor.connect(this.audioContext.destination))}_recomputeAudio(e){return Fr(this,null,function*(){var t,r,n,i,o,a,s;if(e.length!==0&&!(this.nothingShouldSound()&&((t=this.audioContext)==null?void 0:t.state)!=="running")){if(this.useOfflineContext){if(!this.audioContext)return}else yield this.spinUpAudioContext();if(this.nothingShouldSound()){if(this.expressionSynthMap.size>0){for(let l of this.expressionSynthMap.values())l.tearDown();this.expressionSynthMap.clear()}}else for(let l of e){let c=l.type==="expression"?l.formula.typed_constant_value:void 0,d=l.id;c&&!this.expressionSynthMap.has(d)&&this.expressionSynthMap.set(d,new XE(this,this.gainNode)),(r=this.expressionSynthMap.get(d))==null||r.updateFromValues(c),l.type==="remove"&&this.expressionSynthMap.has(d)?((n=this.expressionSynthMap.get(d))==null||n.tearDown(),this.expressionSynthMap.delete(d)):l.type==="expression"&&(Bw(l)?(o=this.expressionSynthMap.get(d))==null||o.setGain(0):(i=this.expressionSynthMap.get(d))==null||i.setGain(this.maxGain))}this.audioContext&&(this.expressionSynthMap.size>0&&!this.isGlobalMuted()?(a=this.gainNode)==null||a.gain.setTargetAtTime(1,this.audioContext.currentTime+xd,Sp):(s=this.gainNode)==null||s.gain.setTargetAtTime(0,this.audioContext.currentTime+xd,Sp))}})}nothingShouldSound(){return!this.globalUnmuteState||!this.hasAnyUnmutedTones()}recomputeAudio(){Dw(this.controller.getListModel());let e=this.controller.getAllItemModels().filter(n=>Aw(n)),t=[],r=new Set(e.map(n=>n.id));for(let n of this.expressionSynthMap.keys())r.has(n)||t.push({id:n,type:"remove"});this._recomputeAudio([...e,...t])}isGlobalMuted(){return!this.globalUnmuteState}someExpressionsShouldPlayTones(){var e,t;return(t=(e=this.controller)==null?void 0:e.getAllItemModels())==null?void 0:t.some(r=>Aw(r))}hasAnyUnmutedTones(){return fq(this.controller.getListModel())}handleAction(e){var t,r,n,i;switch(e.type){case"mute-global":{YE(),this.globalUnmuteState=!1,(r=(t=this.controller).logEvent)==null||r.call(t,{category:"tone",action:"mute-global"});break}case"unmute-global":{jE(),this.globalUnmuteState=!0,this.hasEverInteractedWithMute=!0,(i=(n=this.controller).logEvent)==null||i.call(n,{category:"tone",action:"unmute-global"});break}default:return e}this.recomputeAudio()}handleMuteKeyShortcut(){this.controller.toneItemsExist()?this.isGlobalMuted()?(this.controller.dispatch({type:"unmute-global"}),yt(this.controller.s("graphing-calculator-narration-unmuted")),this.someExpressionsShouldPlayTones()||yt(this.controller.s("graphing-calculator-narration-no-playing-tones"))):(this.controller.dispatch({type:"mute-global"}),yt(this.controller.s("graphing-calculator-narration-muted"))):yt(this.controller.s("graphing-calculator-narration-no-tone-expressions")),xe()}},Sp=.005,Ree=15e-5,gb=20,mb=2e4,iL=class{constructor(e,t){e.audioContext&&(this.audioContext=e.audioContext,this.oscillator=this.audioContext.createOscillator(),this.oscillator.type="sine",this.gain=this.audioContext.createGain(),this.gain.gain.value=0,this.oscillator.connect(this.gain),this.gain.connect(t),this.oscillator.start())}stop(e=0){this.gain.gain.setTargetAtTime(0,this.audioContext.currentTime+e+xd,Sp),setTimeout(()=>{this.oscillator.stop()},1e3*(2*Sp+e+xd)+1)}setFrequencyAndGain(e,t){(!isFinite(e)||!isFinite(t)||e>mb||e<gb)&&(t=0);let r=vq(t,e);r>0&&this.oscillator.frequency.setTargetAtTime(__dcg_shared_module_exports__.$(e,gb,mb),this.audioContext.currentTime+xd,Ree),this.gain.gain.setTargetAtTime(r,this.audioContext.currentTime+xd,Sp)}},XE=class{constructor(e,t){e.audioContext&&(this.audioContext=e.audioContext,this.gain=this.audioContext.createGain(),this.gain.gain.value=0,this.gain.connect(t),this.synthesizers=[])}updateFromValues(e){var t,r,n;if(e&&e.valueType===__dcg_shared_module_exports__.fb)this.synthesizers.length>1?(this.tearDownSynthesizers(this.synthesizers.slice(1)),this.synthesizers.length=1):this.synthesizers.length===0&&(this.synthesizers=[this.makeSynth()]),(t=this.synthesizers[0])==null||t.setFrequencyAndGain(e.value[0],e.value[1]);else if(e&&e.valueType===__dcg_shared_module_exports__.gb){if(this.synthesizers.length>e.value.length&&(this.tearDownSynthesizers(this.synthesizers.slice(e.value.length)),this.synthesizers.length=e.value.length),e.value.length>this.synthesizers.length)for(let i=this.synthesizers.length;i<e.value.length;i++)this.synthesizers.push(this.makeSynth());for(let i=0;i<e.value.length;i++)this.synthesizers[i].setFrequencyAndGain(e.value[i][0],e.value[i][1])}else this.tearDownSynthesizers(this.synthesizers),this.synthesizers=[];this.synthesizers.length>0?(r=this.gain)==null||r.gain.setTargetAtTime(1,this.audioContext.currentTime+xd,Sp):(n=this.gain)==null||n.gain.setTargetAtTime(0,this.audioContext.currentTime+xd,Sp)}makeSynth(){return new iL(this,this.gain)}tearDownSynthesizers(e){if(e)for(let t of e)t.stop()}setGain(e){this.gain.gain.setTargetAtTime(e,this.audioContext.currentTime+xd,Sp)}tearDown(){this.tearDownSynthesizers(this.synthesizers),this.synthesizers=[]}},zw=4;function sL(e){return e===void 0?NaN:+e}function il(e){return!!e&&e.type==="expression"&&!!e.formula&&!!e.formula.typed_constant_value&&!!e.formula.geometry}function Eq(e){var t,r;let n=e.formula;return n?e.controller.isDecimalToFractionEnabled()&&((t=n.typed_constant_value)==null?void 0:t.valueType)===__dcg_shared_module_exports__.wa&&__dcg_shared_module_exports__.ia(sL((r=n.typed_constant_value)==null?void 0:r.value)):!1}function qw(e){return!!(e.formula&&e.formula.is_graphable)}function JE(e){return!(!vd(e)||!fT(e)||!mT(e))}function lL(e){var t,r;let n=e.formula;if(!n)return!1;if(n.warning){let s=(t=e.formula.typed_constant_value)==null?void 0:t.value;if(s===void 0||Number.isNaN(s))return!1}let i=!(n.operator==="="&&e.controller.isThreeDMode()&&(n.assignment==="x"||n.assignment==="y"||n.assignment==="z"||n.assignment==="r"))&&n.is_evaluable&&((r=n.typed_constant_value)==null?void 0:r.value)!==void 0&&n.typed_constant_value.valueType!==__dcg_shared_module_exports__.xa&&!(__dcg_shared_module_exports__.Wc(e.latex)instanceof __dcg_shared_module_exports__.sc),o=Eq(e)&&Hu(e),a=!!n.rgb_value&&e.formula.assignment;return!!(i||o||a)}function Ep(e){var t,r,n;let i=(t=e.formula)==null?void 0:t.recursion;if(!i||i.type==="iterative"||!i.recursiveStructure)return[];if(i.recursionGroup.length>1)return[];let{maxRecursiveCallOffsets:o,parameterSymbols:a,baseCaseInfo:s}=i.recursiveStructure,l=[];for(let c in o){if(((r=a[c])==null?void 0:r.length)!==1)continue;let d=s[c];if(d&&Math.abs(d.min)>AG)continue;let u=o[c],p,g;d?(p=d.min+u-1,g=d.min+d.consecutiveCount):(p=u,g=1);for(let f=g;f<=p;f++)if(!((n=d==null?void 0:d.additional)!=null&&n.includes(f))&&(l.push(`${__dcg_shared_module_exports__.ma(c)}\\left(${f}\\right)`),l.length>zw))return[]}return l}function cL(e){var t;let r=(t=e.formula.typed_constant_value)==null?void 0:t.value;return e.formula.rgb_value?e.formula.rgb_value:lL(e)||Eq(e)?r:NaN}function Hw(e){let t=e.formula.ttest_results;if(!(!t||!isFinite(t.lessThan)))return{lessThan:t.lessThan,greaterThan:t.greaterThan,notEqual:t.notEqual}}function Tq(e){let t=e.formula.stats_results;if(!(!t||!isFinite(t.min)))return{min:t.min,q1:t.q1,median:t.median,q3:t.q3,max:t.max}}function qu(e,t){if(!isFinite(t))return e;let r=e.indexOf("=")+1;return io(e.slice(r),!1)===t?e:e.slice(0,r)+__dcg_shared_module_exports__.ce(t)}function Vl(e){let t=e.latex||"",r=e.label||"";return(t+r).split(" ").join("")===""}function Ro(e,t={isReverseDrag:!1}){let r=e.dragMode==="AUTO"&&e.formula.default_drag_mode!==void 0?e.formula.default_drag_mode:e.dragMode;return e.controller.isThreeDMode()&&(r="NONE"),e.dragMode==="AUTO"&&!t.isReverseDrag&&Hi(e)&&(r="NONE"),__dcg_shared_module_exports__.Gb(r,e.formula.move_strategy)}function Bee(e){let t=Ro(e);e.interactiveLabel&&t!=="NONE"&&$w(e,!1)}function Ol(e,t,r){if(!e.sliderExists)return NaN;let n=nl(e),i=bc(e),o=Rl(e);if(r&&r.overwriteStep!==void 0&&(o=r.overwriteStep),t=__dcg_shared_module_exports__.zc({target:t,hardMin:e.slider.hardMin?n:void 0,hardMax:e.slider.hardMax?i:void 0,step:o}),!r||!r.ignoreSoftLimits){if(!e.slider.hardMin&&t<n)return n;if(!e.slider.hardMax&&t>i)return i}return t}function dL(e,t,r={}){if(!e.sliderExists)return NaN;let n=al(e),i=nl(e),o=bc(e),a=Rl(e);r.overwriteStep===void 0&&(r.overwriteStep=a||(o-i)/20);let s=0;switch(t){case"min":return Ol(e,i);case"max":return Ol(e,o);case"up":s=1;break;case"down":s=-1;break;case"bigup":s=5;break;case"bigdown":s=-5;break;default:return t}let l=n;for(let c=0;c<20;c++){let d=c/3*r.overwriteStep,u=n;if(s>0)n=Ol(e,l+d,r),n>u&&(s-=1);else if(s<0)n=Ol(e,l-d,r),n<u&&(s+=1);else break}return n}function QE(e,t){if(!e.sliderExists)return;e.slider.isPlaying&&As(e,!1);let r=Ol(e,t,{ignoreSoftLimits:!0});e.latex=qu(e.latex,r)}function Dq(e,t,r){if(!e.sliderExists)return;e.slider.isPlaying&&As(e,!1),yb(e);let n=dL(e,t,r);e.latex=qu(e.latex,n)}function kq(e,t){if(!e.sliderExists)return;e.slider.isPlaying&&As(e,!1);let r=Ol(e,t);e.latex=qu(e.latex,r)}function _q(e,t){if(!e.sliderExists||e.resetSliderAnimationTargetValue)return;let r=e.sliderLastTickTime;if(e.sliderLastTickTime=t,r===void 0)return;let n=t-r,i=nl(e),o=bc(e),a=Rl(e),s=e.slider.animationPeriod,l=e.slider.loopMode;if(isNaN(e.sliderAnimationTargetValue)){let p=al(e);isNaN(p)||(e.sliderAnimationTargetValue=p)}let c=a?a/2:0;if(l==="LOOP_FORWARD_REVERSE")e.sliderAnimationTargetValue>=o?In(e,{playDirection:-1}):e.sliderAnimationTargetValue<=i&&In(e,{playDirection:1});else if(l==="LOOP_FORWARD")In(e,{playDirection:1}),e.sliderAnimationTargetValue>=o+c&&(e.sliderAnimationTargetValue=i-c);else if(l==="PLAY_ONCE")In(e,{playDirection:1});else if(l==="PLAY_INDEFINITELY")In(e,{playDirection:1});else throw new Error("Unexpected slider loop mode: "+l);isFinite(n)||(n=0);let d,u;if(l==="PLAY_INDEFINITELY")d=n/(s/4),a&&(d*=a),e.sliderAnimationTargetValue+=d,u=e.sliderAnimationTargetValue,a||(u=ho(u-d*.1,u+d*.1)),u=Ol(e,u,{ignoreSoftLimits:!0}),e.latex=qu(e.latex,u);else{if(n=Math.min(n,s/10),d=(o-i)*n/s,e.sliderAnimationTargetValue+=d*e.slider.playDirection,e.sliderAnimationTargetValue=Math.max(i-c,Math.min(o+c,e.sliderAnimationTargetValue)),u=e.sliderAnimationTargetValue,!a){let p=d/n*16.666666666666668;u=ho(u-p*.1,u+p*.1)}u=Ol(e,u),e.latex=qu(e.latex,u)}}function ab(e){let t=e.formula;return t?t.is_single_identifier?[]:t.variables.map(r=>__dcg_shared_module_exports__.ma(r))||[]:[]}function QG(e,t){e.formula=t,e.error=t.error,e.unresolved=!1,e.expressionTooComplex=!1,e.recursiveDepthPlottingError=!1,e.nanBlame=__dcg_shared_module_exports__.Zd.None,t.is_slider?(!e.sliderExists||e.resetSliderAnimationTargetValue)&&(e.sliderAnimationTargetValue=al(e),e.sliderDragging=!1,e.sliderExists=!0):e.sliderExists=!1,e.resetSliderAnimationTargetValue=!1;let r={};t.is_regression&&(r=t.regression.parameters,e.residualVariable=t.regression.residualVariable,e.controller.areLogModeRegressionsForced()&&(e.isLogModeRegression=!0)),__dcg_shared_module_exports__.E(e.regressionParameters,r)||(e.regressionParameters=r)}function Is(e){var t,r;return e.type==="expression"&&(((t=e.formula.typed_constant_value)==null?void 0:t.valueType)===__dcg_shared_module_exports__.fb||((r=e.formula.typed_constant_value)==null?void 0:r.valueType)===__dcg_shared_module_exports__.gb)}function Iq(e){var t,r,n,i;if(!Is(e)||((t=e.formula.typed_constant_value)==null?void 0:t.valueType)===__dcg_shared_module_exports__.gb||((r=e.formula.typed_constant_value)==null?void 0:r.valueType)===__dcg_shared_module_exports__.fb&&((n=e.formula.typed_constant_value)==null?void 0:n.value[0])>=gb&&((i=e.formula.typed_constant_value)==null?void 0:i.value[0])<=mb)return!1;let o=__dcg_shared_module_exports__.Wc(e.latex);return!!(o&&o._dependencies&&o._dependencies.length===1)}function Bw(e){var t;return!!e.hidden||!!((t=Ca(e))!=null&&t.hidden)}function Aw(e){return!Is(e)||Bw(e)?!1:e.formula.typed_constant_value.valueType===__dcg_shared_module_exports__.fb?e.formula.typed_constant_value.value[1]>0:e.formula.typed_constant_value.valueType===__dcg_shared_module_exports__.gb?e.formula.typed_constant_value.value.some(t=>t[1]>0):!1}function Uee(e){if(e.shouldGraph=!Hi(e),e.folderId===__dcg_shared_module_exports__.xd){let t=e.controller.getExpressionIdForIdentifier(e.controller.getHoveredOrFocusedTokenIdentifier())===e.id,r=e.controller.isItemSelected(e.id);(t||r||e.controller.getGhostMode())&&(e.shouldGraph=!0)}}function Hi(e){var t;if(!e)return!1;if(e.hidden||(t=e==null?void 0:e.formula)!=null&&t.expression_type&&wb(e))return!0;let r=Ca(e);return!!(r&&r.hidden)}function zee(e){let t=e.formula&&e.formula.raw_slider_latex;if(!e.sliderExists||e.latex!==t){e.cachedDisplayLatex={storedLatex:e.latex,valueLatex:e.latex};return}let{latex:r}=e;if(e.cachedDisplayLatex.storedLatex!==r){e.cachedDisplayLatex={storedLatex:e.latex,valueLatex:e.latex};return}let n=Mq(e);if(isFinite(n)){let i=e.controller.getFocusLocation();i&&i.type==="expression"&&i.id===e.id||(e.cachedDisplayLatex.valueLatex=qu(e.latex,n))}}function Kw(e){return e.cachedDisplayLatex.valueLatex}function Aq(e){return __dcg_shared_module_exports__.ea(e).latex}function pL(e){return e.slider.hardMin?e.slider.min:Aq(nl(e))}function uL(e){return e.slider.hardMax?e.slider.max:Aq(bc(e))}function nl(e){if(e.slider.hardMin){let t=e.formula.slider_min_number;return isFinite(t)?t:NaN}else{let t=e.controller.getDegreeMode(),r=io(e.slider.min,t),n=al(e),i=Rl(e),o=e.slider.hardMax?e.formula.slider_max_number:void 0,a=e.controller.is3dProduct()?__dcg_shared_module_exports__.xc.xmin:-10;if(r<a&&(a=r),n<a&&(a=n),o<a&&(a=o),i){let s=__dcg_shared_module_exports__.zc({target:a,hardMin:void 0,hardMax:o,step:i});s<=a?a=s:a=s-i}return a}}function bc(e){if(e.slider.hardMax){let t=e.formula.slider_max_number;return isFinite(t)?t:NaN}else{let t=e.controller.getDegreeMode(),r=io(e.slider.max,t),n=al(e),i=Rl(e),o=e.slider.hardMin?e.formula.slider_min_number:void 0;return __dcg_shared_module_exports__.Ac({storedMax:r,sliderValue:n,step:i,hardMin:o,is3d:e.controller.is3dProduct()})}}function Rl(e){return e.formula.slider_step_number}function Mq(e){var t;if(!e.formula||!e.formula.is_slider)return;let r=(t=e.formula.typed_constant_value)==null?void 0:t.value;if(r!==void 0)return+r}function al(e){let t=e.formula&&e.formula.raw_slider_latex;if(e.latex!==t)return dw(e.latex);let r=Mq(e);return isFinite(r)?r:NaN}function hL(e){return e.slider.loopMode!=="PLAY_ONCE"?!1:al(e)>=bc(e)}function Gq(e,t){return e.formula.viz_valids?!!e.formula.viz_valids[t]:!1}function Tp(e,t){return e.vizProps[t]}function Lq(e,t,r){e.vizProps=ie(R({},e.vizProps),{[t]:r})}function fb(e,t){if(t.type==="inert")e.disableGraphInteractions=t.disableGraphInteractions,t.disableGraphInteractions&&(e.dragMode="NONE",e.clickableInfo=ie(R({},e.clickableInfo),{enabled:!1}),e.editableLabelMode="NONE",e.interactiveLabel=!1);else if(t.type==="drag-mode"){let r=t.dragMode;e.dragMode=r,r!=="NONE"&&(e.disableGraphInteractions=!1),e.movablePointSize!==e.pointSize&&(r==="NONE"?e.pointSize=e.movablePointSize:e.movablePointSize=e.pointSize)}else t.type==="clickable"?(e.clickableInfo=t.clickableInfo,t.clickableInfo.enabled&&(e.disableGraphInteractions=!1)):t.type==="editable-label"?(e.editableLabelMode=t.editable,t.editable!=="NONE"&&(e.disableGraphInteractions=!1)):t.type==="interactive-label"&&(e.interactiveLabel=t.interactive,t.interactive&&(e.disableGraphInteractions=!1))}function Pq(e,t,r){fb(e,{type:"clickable",clickableInfo:ie(R({},e.clickableInfo),{[t]:r})})}function UE(e,t){fb(e,{type:"clickable",clickableInfo:ie(R({},e.clickableInfo),{latex:t})})}function $n(e){var t;return!!(e.clickableInfo.enabled&&OL(e)&&((t=e.formula.click_handler)==null?void 0:t.status)==="maybe-valid")}function bb(e){return!!(e&&e.type==="expression"&&$n(e))}function Vq(e){return!!e.__workerNeedsDotplotXMode}function ZE(e){return!!(e.formula&&e.formula.slider_min_valid)}function eT(e){return!!(e.formula&&e.formula.slider_max_valid)}function tT(e){return!!(e.formula&&e.formula.slider_step_valid)}function rT(e,t){var r;if(!t)throw new Error("Programming Error in test. Pass domain variable");return(r=e.formula.domains)==null?void 0:r.find(n=>n.variable===t)}function Oq(e,t){if(!e.formula)return NaN;if(Sb(e)&&isFinite(e.__workerSampledDomainMin))return e.__workerSampledDomainMin;let r=rT(e,t),n=r==null?void 0:r.minNumber;return n!==void 0&&isFinite(n)?n:NaN}function Rq(e,t){if(!e.formula)return NaN;if(Sb(e)&&isFinite(e.__workerSampledDomainMax))return e.__workerSampledDomainMax;let r=rT(e,t),n=r==null?void 0:r.maxNumber;return n!==void 0&&isFinite(n)?n:NaN}function Fq(e,t){let r=rT(e,t);return r?r.minValid:!1}function Nq(e,t){let r=rT(e,t);return r?r.maxValid:!1}function Mw(e,t){let r=e.cachedViewState;if((!t.stripDefaults||e.parametricDomain.min!==""||e.parametricDomain.max!=="")&&(r=ie(R({},r),{domain:{min:e.parametricDomain.min===""?"0":e.parametricDomain.min,max:e.parametricDomain.max===""?"1":e.parametricDomain.max}})),t.stripDefaults)return __dcg_shared_module_exports__.Ed(r,{is3d:e.controller.is3dProduct()});if(r.points===void 0||r.lines===void 0||r.fill===void 0){let n=__dcg_shared_module_exports__.Jc(r);return n.points===void 0&&delete n.points,n.lines===void 0&&delete n.lines,n.fill===void 0&&delete n.fill,n}return r}function qee(e){let t=e.cachedViewState;t&&__dcg_shared_module_exports__.Gd(t,e)&&t.folderId===e.folderId&&t.color===e.color&&t.latex===e.latex&&t.showLabel===e.showLabel&&t.showAngleLabel===e.showAngleLabel&&t.label===e.label&&t.hidden===e.hidden&&t.secret===e.secret&&t.readonly===e.readonly&&t.disableGraphInteractions===e.disableGraphInteractions&&t.fill===e.fill&&t.points===e.points&&t.lines===e.lines&&t.extendTo3D===e.extendTo3D&&t.lineStyle===e.lineStyle&&t.arrowMode===e.arrowMode&&t.pointStyle===e.pointStyle&&t.dragMode===e.dragMode&&t.labelSize===e.labelSize&&t.labelOrientation===e.labelOrientation&&t.suppressTextOutline===e.suppressTextOutline&&t.interactiveLabel===e.interactiveLabel&&t.editableLabelMode===e.editableLabelMode&&t.residualVariable===e.residualVariable&&t.regressionParameters===e.regressionParameters&&t.isLogModeRegression===e.isLogModeRegression&&t.displayEvaluationAsFraction===e.displayEvaluationAsFraction&&t.slider===e.slider&&t.strictIntersection===e.strictIntersection||(e.cachedViewState=R({type:e.type,id:e.id,folderId:e.folderId,color:e.color,latex:e.latex,showLabel:e.showLabel,showAngleLabel:e.showAngleLabel,label:e.label,hidden:e.hidden,secret:e.secret,readonly:e.readonly,disableGraphInteractions:e.disableGraphInteractions,points:e.points,lines:e.lines,extendTo3D:e.extendTo3D,lineStyle:e.lineStyle,arrowMode:e.arrowMode,pointStyle:e.pointStyle,fill:e.fill,dragMode:e.dragMode,labelSize:e.labelSize,labelOrientation:e.labelOrientation,suppressTextOutline:e.suppressTextOutline,interactiveLabel:e.interactiveLabel,editableLabelMode:e.editableLabelMode,residualVariable:e.residualVariable,regressionParameters:e.regressionParameters,isLogModeRegression:e.isLogModeRegression,displayEvaluationAsFraction:e.displayEvaluationAsFraction,slider:e.slider,strictIntersection:e.strictIntersection},__dcg_shared_module_exports__.Fd(e)))}function gL(e,t){t&&yb(e),e.draggingOnGraphpaper=t}function Hee(e){let t=e.memoizedUndoRedoStateParams,r=e.cachedViewState,n=e.preTransientState;if(e.cachedUndoRedoFullState=r,t&&t.viewState===r&&t.preTransientState===n)return;e.memoizedUndoRedoStateParams={viewState:r,preTransientState:n};let i;n?i=ie(R({},r),{latex:n.latex,slider:R(R({},r.slider),n.slider)}):i=R({},r),delete i.regressionParameters,delete i.residualVariable,e.cachedUndoRedoDiffState=i}function zE(e,t){let r=__dcg_shared_module_exports__.Jc(__dcg_shared_module_exports__.Dd(e,{is3d:t.is3dProduct(),defaultLogModeRegressions:t.areLogModeRegressionsDefault()})),{color:n}=r;return(!n||!Ff(n))&&(n=t.getNextColor()),ie(R(R({},r),ud(t)),{labelDropdownOpen:!1,formula:{error:void 0,operator:"=",variables:[]},error:void 0,unresolved:!1,expressionTooComplex:!1,color:n,pointStyle:r.pointStyle,lineStyle:r.lineStyle,arrowMode:r.arrowMode,displayEvaluationAsFraction:r.displayEvaluationAsFraction,shouldGraph:void 0,sliderDragging:void 0,sliderAnimationTargetValue:void 0,resetSliderAnimationTargetValue:!1,sliderLastTickTime:void 0,draggingOnGraphpaper:!1,cachedUndoRedoDiffState:void 0,cachedUndoRedoFullState:void 0,cachedParsableState:void 0,cachedViewState:void 0,cachedDisplayLatex:{storedLatex:"",valueLatex:""}})}function Kee(e){let t=Ca(e),r=!!(t&&t.hidden),n=e.cachedViewState,i=e.index,o=e.showLabel&&!r,a=e.showAngleLabel,s=e.shouldGraph,l=e.memoizedParsableStateParams;if(l&&l.viewState===n&&l.index===i&&l.showLabel===o&&l.showAngleLabel===a&&l.shouldGraph===s)return;e.memoizedParsableStateParams={viewState:n,index:i,showLabel:o,showAngleLabel:a,shouldGraph:s};let c=__dcg_shared_module_exports__.Hd(n);c.index=i,c.showLabel=o,c.showAngleLabel=a,c.shouldGraph=s,c.isInConstructionsFolder=e.folderId===__dcg_shared_module_exports__.xd,e.cachedParsableState=c}function qE(e,t){t(e.latex,"latex"),t(e.clickableInfo.latex,"clickableInfoLatex"),t(e.lineWidth,"lineWidth"),t(e.fillOpacity,"fillOpacity"),t(e.surfaceOpacity,"surfaceOpacity"),t(e.lineOpacity,"lineOpacity"),t(e.pointOpacity,"pointOpacity"),t(e.pointSize,"pointSize"),t(e.movablePointSize,"movablePointSize"),t(e.labelSize,"labelSize"),t(e.labelAngle,"labelAngle"),t(e.colorLatex,"colorLatex"),Gg(e)&&(t(e.parametricDomain.min,"parametricDomainMin"),t(e.parametricDomain.max,"parametricDomainMax")),(pH(e)||dH(e))&&(t(e.parametricDomain3Du.min,"parametricDomain3DuMin"),t(e.parametricDomain3Du.max,"parametricDomain3DuMax"),t(e.parametricDomain3Dv.min,"parametricDomain3DvMin"),t(e.parametricDomain3Dv.max,"parametricDomain3DvMax")),(Sb(e)||dT(e))&&(t(e.polarDomain.min,"polarDomainMin"),t(e.polarDomain.max,"polarDomainMax")),(TL(e)||EL(e))&&t(e.resolution,"resolution"),vd(e)&&(t(e.cdf.min,"cdfMin"),t(e.cdf.max,"cdfMax")),e.sliderExists&&(t(e.slider.min,"sliderMin"),t(e.slider.max,"sliderMax"),t(e.slider.step,"sliderStep")),e.residualVariable&&t(e.residualVariable,"residualVariable")}function Ya(e){return e.formula&&e.formula.assignment}function mL(e){return e.formula&&e.formula.shader}function pi(e){let t=e.cachedAssignmentOrFunctionName;if(t&&t.latex===e.latex)return t.result;let r=Nx(e.latex),n=r?{latex:r,identifier:__dcg_shared_module_exports__.na(r)}:void 0;return e.cachedAssignmentOrFunctionName={latex:e.latex,result:n},n}function Bq(e){var t,r;let n=(r=(t=e.formula)==null?void 0:t.typed_constant_value)==null?void 0:r.valueType;return n==null?!1:__dcg_shared_module_exports__.wb(n)}function oT(e){var t;let r=(t=pi(e))==null?void 0:t.latex,n=r==null?void 0:r.match(/^(\\token\{\d+\})$/);if(n)return n[1]}function Uq(e){var t,r;let n=(r=(t=e.formula)==null?void 0:t.typed_constant_value)==null?void 0:r.valueType,i=!1;if(n&&__dcg_shared_module_exports__.wb(n)&&(i=!0,n=__dcg_shared_module_exports__.xb(n)),n==null||!__dcg_shared_module_exports__.yb(n))return"U";switch(n){case __dcg_shared_module_exports__.ya:return i?"P":"p";case __dcg_shared_module_exports__.La:case __dcg_shared_module_exports__.Ta:case __dcg_shared_module_exports__.Ra:return i?"L":"l";case __dcg_shared_module_exports__.$a:return i?"V":"v";case __dcg_shared_module_exports__.Pa:case __dcg_shared_module_exports__.Na:return i?"C":"c";case __dcg_shared_module_exports__.Va:case __dcg_shared_module_exports__.Xa:return i?"A":"a";case __dcg_shared_module_exports__.Ja:return"P";case __dcg_shared_module_exports__.Za:return"T";default:return n}}function Wee(e){var t,r;let n=(r=(t=e.formula)==null?void 0:t.typed_constant_value)==null?void 0:r.valueType;if(n==null||(__dcg_shared_module_exports__.wb(n)&&(n=__dcg_shared_module_exports__.xb(n)),!__dcg_shared_module_exports__.yb(n)))return"unknown";switch(n){case __dcg_shared_module_exports__.ya:return"point";case __dcg_shared_module_exports__.La:return"segment";case __dcg_shared_module_exports__.Ta:return"ray";case __dcg_shared_module_exports__.Ra:return"line";case __dcg_shared_module_exports__.$a:return"vector";case __dcg_shared_module_exports__.Pa:return"arc";case __dcg_shared_module_exports__.Na:return"circle";case __dcg_shared_module_exports__.Va:return"angle";case __dcg_shared_module_exports__.Xa:return"directedangle";case __dcg_shared_module_exports__.Ja:return"polygon";case __dcg_shared_module_exports__.Za:return"transformation";default:return n}}function fL(e){var t,r;let n=(r=(t=e.formula)==null?void 0:t.typed_constant_value)==null?void 0:r.valueType;if(n==null||(__dcg_shared_module_exports__.wb(n)&&(n=__dcg_shared_module_exports__.xb(n)),!__dcg_shared_module_exports__.yb(n)))return"unknown";switch(n){case __dcg_shared_module_exports__.ya:return"point";case __dcg_shared_module_exports__.La:case __dcg_shared_module_exports__.Ta:case __dcg_shared_module_exports__.Ra:case __dcg_shared_module_exports__.$a:return"line";case __dcg_shared_module_exports__.Pa:return"arc";case __dcg_shared_module_exports__.Na:return"circle";case __dcg_shared_module_exports__.Va:return"angle";case __dcg_shared_module_exports__.Xa:return"directedangle";case __dcg_shared_module_exports__.Ja:return"polygon";case __dcg_shared_module_exports__.Za:return"transformation";default:return n}}function zq(e){return e.indexOf("\\token{")!==-1}function qq(e){var t,r,n,i;let o=(r=(t=e.formula.geometry)==null?void 0:t.call)==null?void 0:r.symbol,a=(i=(n=e.formula)==null?void 0:n.typed_constant_value)==null?void 0:i.valueType;return!o||o==="apply"||__dcg_shared_module_exports__.Dc(o)&&a!==void 0&&!__dcg_shared_module_exports__.Ab(a,__dcg_shared_module_exports__.Za)?Wee(e):o==="segments"?"segment":o}function $ee(e){return!!(e.sliderExists&&(e.slider.isPlaying||e.sliderDragging)||e.draggingOnGraphpaper)}function Hq(e){return!!(e.sliderExists&&e.sliderDragging||e.draggingOnGraphpaper)}function bL(e){$ee(e)?e.preTransientState||(e.preTransientState={latex:e.latex,slider:{min:e.slider.min,max:e.slider.max,playDirection:e.slider.playDirection}}):delete e.preTransientState,(!e.sliderExists||!e.slider.isPlaying)&&(e.sliderLastTickTime=void 0),hd(e),Uee(e),Bee(e),qee(e),Hee(e),Kee(e),zee(e)}var jee=R({id:!1,type:!1,color:!0,folderId:!0,latex:!0,showLabel:!0,showAngleLabel:!0,label:!0,hidden:!0,secret:!0,readonly:!0,disableGraphInteractions:!0,points:!0,lines:!0,lineStyle:!0,arrowMode:!0,pointStyle:!0,fill:!0,dragMode:!0,labelSize:!0,labelOrientation:!0,suppressTextOutline:!0,interactiveLabel:!0,editableLabelMode:!0,residualVariable:!0,regressionParameters:!0,isLogModeRegression:!0,displayEvaluationAsFraction:!0,slider:!0,strictIntersection:!0,angleType:!0,showAngleDirection:!0,extendTo3D:!1},__dcg_shared_module_exports__.ud(__dcg_shared_module_exports__.zd));function wq(e,t){__dcg_shared_module_exports__.rd({from:t,to:e,props:jee}),e.resetSliderAnimationTargetValue=!0,e.sliderAnimationTargetValue=void 0}function sb(e,t){t?In(e,{hardMin:!0,min:t}):In(e,{hardMin:!1,min:e.controller.is3dProduct()?`${__dcg_shared_module_exports__.xc.xmin}`:"-10"})}function lb(e,t){t?In(e,{hardMax:!0,max:t}):In(e,{hardMax:!1,max:e.controller.is3dProduct()?`${__dcg_shared_module_exports__.xc.xmax}`:"10"})}function In(e,t){e.slider=R(R({},e.slider),t)}function As(e,t){!e||e.slider.isPlaying===t||(In(e,{isPlaying:t}),t&&(yb(e),e.sliderAnimationTargetValue=al(e)))}function yb(e){if(!e.slider.hardMin){let t=__dcg_shared_module_exports__.be(nl(e));t!==e.slider.min&&In(e,{min:t})}if(!e.slider.hardMax){let t=__dcg_shared_module_exports__.be(bc(e));t!==e.slider.max&&In(e,{max:t})}}function $a(e,t){let r=dw(t);if(isFinite(r)){let n=__dcg_shared_module_exports__.yc({target:r,step:Rl(e),hardMin:e.slider.hardMin?nl(e):void 0,hardMax:e.slider.hardMax?bc(e):void 0});n.min||In(e,{hardMin:!1,min:"-10"}),n.max||In(e,{hardMax:!1,max:"10"}),n.step||In(e,{step:""})}e.latex=t}function Kq(e,t){In(e,{loopMode:t,playDirection:1}),t==="PLAY_INDEFINITELY"&&In(e,{hardMin:!1,hardMax:!1,min:"",max:""}),e.sliderAnimationTargetValue=nl(e)}function Ww(e,t){t&&yb(e),e.sliderDragging=t}function Gw(e,t){In(e,{step:t})}function Wq(e,t){In(e,{animationPeriod:t})}function Hu(e){var t;return((t=e.formula.typed_constant_value)==null?void 0:t.valueType)===__dcg_shared_module_exports__.db?!1:e.displayEvaluationAsFraction}function $q(e,t){e.displayEvaluationAsFraction=t}function yd(e,t){e.label=t}function Ku(e,t){zu(e)?e.showAngleLabel=t:e.showLabel=t}function jq(e,t){e.description=t}function Ka(e,t,r){switch(r){case"theta":e.polarDomain=ie(R({},e.polarDomain),{min:t});break;case"t":e.parametricDomain=ie(R({},e.parametricDomain),{min:t});break;case"u":e.parametricDomain3Du=ie(R({},e.parametricDomain3Du),{min:t});break;case"v":e.parametricDomain3Dv=ie(R({},e.parametricDomain3Dv),{min:t});break;case"r":e.parametricDomain3Dr=ie(R({},e.parametricDomain3Dr),{min:t});break;case"phi":e.parametricDomain3Dphi=ie(R({},e.parametricDomain3Dphi),{min:t});break;default:return r}}function Wa(e,t,r){switch(r){case"theta":e.polarDomain=ie(R({},e.polarDomain),{max:t});break;case"t":e.parametricDomain=ie(R({},e.parametricDomain),{max:t});break;case"u":e.parametricDomain3Du=ie(R({},e.parametricDomain3Du),{max:t});break;case"v":e.parametricDomain3Dv=ie(R({},e.parametricDomain3Dv),{max:t});break;case"r":e.parametricDomain3Dr=ie(R({},e.parametricDomain3Dr),{max:t});break;case"phi":e.parametricDomain3Dphi=ie(R({},e.parametricDomain3Dphi),{max:t});break;default:return r}}function yL(e,t){e.isLogModeRegression=t}function iT(e,t){Ff(t)&&(e.color=t,e.colorLatex="")}function xL(e,t){e.fill=t}function Lw(e,t){e.fillOpacity!==t&&(e.fillOpacity=t)}function Pw(e,t){e.surfaceOpacity!==t&&(e.surfaceOpacity=t)}function cb(e,t){e.lineOpacity!==t&&(e.lineOpacity=t)}function Vw(e,t){e.pointOpacity!==t&&(e.pointOpacity=t)}function Ow(e,t){e.pointSize===t&&e.movablePointSize===t||(e.pointSize=t,e.movablePointSize=t)}function db(e,t){e.lineWidth!==t&&(e.lineWidth=t)}function HE(e,t){e.resolution!==t&&(e.resolution=t)}function Rw(e,t){e.colorLatex!==t&&(e.colorLatex=t)}function Yq(e,t){e.labelDropdownOpen=t}function Mg(e,t){fb(e,{type:"drag-mode",dragMode:t})}function wL(e,t){e.points=t}function vL(e,t){e.pointStyle!==t&&(e.pointStyle=t,t!=="POINT"&&(e.dragMode="NONE"))}function CL(e,t){e.lines=t}function Xq(e,t){e.extendTo3D=t}function nT(e,t){e.lineStyle!==t&&(e.lineStyle=t)}function Jq(e,t){e.arrowMode=t===Yee()?"DEFAULT":t}function Yee(e){return"NONE"}function Fw(e,t){e.labelSize=t}function KE(e,t){e.labelAngle=t}function SL(e,t){e.labelOrientation=t}function Qq(e,t){e.suppressTextOutline=t}function $w(e,t){fb(e,{type:"interactive-label",interactive:t})}function aT(e,t){fb(e,{type:"editable-label",editable:t})}function Zq(e){return e.editableLabelMode}function xb(e){let{editableLabelMode:t}=e;return t==="MATH"||t==="TEXT"}function eH(e,t){e.strictIntersection=t}function tH(e){return!!(Ro(e)!=="NONE"&&Hi(e))}function rH(e,t){e.hidden=t,!t&&wb(e)&&(e.lines=e.points=e.fill=void 0)}function wb(e){if(wd(e)&&!e.controller.isThreeDMode())return!1;let{points:t,lines:r,fill:n}=e,i=__dcg_shared_module_exports__.Zc(e.formula.expression_type,{points:t,lines:r,fill:n},o=>{});return!i.points&&!i.lines&&!i.fill}function Wu(e){return e.formula.map_type!==void 0?!1:Gg(e)||Sb(e)||dT(e)}function Dp(e){return e.formula.map_type!==void 0?!1:pH(e)||dH(e)||DL(e)}function oH(e,t){switch(t){case"theta":return e.polarDomain.min;case"t":return e.parametricDomain.min;case"u":return e.parametricDomain3Du.min;case"v":return e.parametricDomain3Dv.min;case"r":return e.parametricDomain3Dr.min;case"phi":return e.parametricDomain3Dphi.min;default:return t}}function iH(e,t){switch(t){case"theta":return e.polarDomain.max;case"t":return e.parametricDomain.max;case"u":return e.parametricDomain3Du.max;case"v":return e.parametricDomain3Dv.max;case"r":return e.parametricDomain3Dr.max;case"phi":return e.parametricDomain3Dphi.max;default:return t}}function vb(e){return!!e.formula.action_value&&Object.keys(e.formula.action_value).length>0}function nH(e){return!!e.sliderExists}function pb(e){return e.formula.expression_type==="POLYGON"}function wd(e){return!!e.formula.is_inequality}function sT(e){return!!e.formula.is_regression}function Gg(e){return e.formula.expression_type==="PARAMETRIC"||e.formula.expression_type==="CURVE3D_xyz_t"&&!kL(e)&&!_L(e)}function Cb(e){return e.formula.expression_type==="POINT3D"}function EL(e){return e.formula.expression_type==="CURVE3D_xyz_t"||e.formula.expression_type==="SLICE"||e.formula.expression_type==="SLICE_rθz_at_z"||e.formula.expression_type==="SLICE_zrθ_at_r"||e.formula.expression_type==="SLICE_zrθ_at_θ"||e.formula.expression_type==="SLICE_zrθ_at_xyz"||e.formula.expression_type==="SLICE_rθφ_at_θ"||e.formula.expression_type==="SLICE_rθφ_at_φ"||e.formula.expression_type==="SLICE_rθφ_at_xyz"||e.formula.expression_type==="SLICE_xyz_uv"}function aH(e){return e.formula.expression_type==="SLICE_zrθ_at_r"||e.formula.expression_type==="SLICE_rθφ_at_θ"}function sH(e){return e.formula.expression_type==="SLICE_zrθ_at_θ"||e.formula.expression_type==="SLICE_rθφ_at_φ"}function TL(e){switch(e.formula.expression_type){case"SURFACE_xyz_uv":case"SURFACE_z_rθ":case"SURFACE_r_θz":case"SURFACE_r_θz_AMBIGUOUS":case"SURFACE_r_θφ":case"SURFACE":case"SURFACE_AMBIGUOUS":case"SURFACE_CONSTANT_AMBIGUOUS":case"IMPLICIT_SURFACE":case"IMPLICIT_SURFACE_AMBIGUOUS":case"TRIANGLE3D":case"SPHERE3D":return!0;default:return!1}}function lT(e){return e.formula.expression_type==="TRIANGLE3D"}function lH(e){return e.formula.expression_type==="SPHERE3D"}function cH(e){return e.formula.expression_type==="IMPLICIT_SURFACE"||e.formula.expression_type==="IMPLICIT_SURFACE_AMBIGUOUS"}function cT(e){return Xee(e)||Jee(e)}function Xee(e){return e.formula.expression_type==="X_OR_Y"||e.formula.expression_type==="IMPLICIT"||e.formula.expression_type==="SURFACE_AMBIGUOUS"||e.formula.expression_type==="SURFACE_CONSTANT_AMBIGUOUS"||e.formula.expression_type==="IMPLICIT_SURFACE_AMBIGUOUS"}function Jee(e){return!e.formula.is_inequality&&(e.formula.expression_type==="POLAR"||e.formula.expression_type==="SURFACE_r_θz_AMBIGUOUS")}function Sb(e){return e.formula.expression_type==="POLAR"}function dT(e){return __dcg_shared_module_exports__.bd(e.formula.expression_type)}function DL(e){return __dcg_shared_module_exports__.ad(e.formula.expression_type)}function dH(e){return __dcg_shared_module_exports__.$c(e.formula.expression_type)}function pH(e){return e.formula.expression_type==="SURFACE_xyz_uv"||e.formula.expression_type==="SLICE_xyz_uv"}function zu(e){let t=e.formula.typed_constant_value;if(!t)return!1;let r=t.valueType;return r===__dcg_shared_module_exports__.Va||r===__dcg_shared_module_exports__.Wa||r===__dcg_shared_module_exports__.Xa||r===__dcg_shared_module_exports__.Ya}function ja(e){let t=zu(e);return t&&e.showAngleLabel||!t&&e.showLabel}function ub(e){if(mc(e))return!0;let t=e.formula.typed_constant_value;if(!t)return!1;let r=t.valueType;return r===__dcg_shared_module_exports__.La||r===__dcg_shared_module_exports__.Ma||r===__dcg_shared_module_exports__.Va||r===__dcg_shared_module_exports__.Wa||r===__dcg_shared_module_exports__.Xa||r===__dcg_shared_module_exports__.Ya}function kL(e){return e.formula.expression_type==="SEGMENT3D"}function _L(e){return e.formula.expression_type==="VECTOR3D"}function Ea(e){return e.formula.expression_type==="SINGLE_POINT"}function Lg(e){return e.formula.expression_type==="POINT_LIST"}function mc(e){return e.formula.expression_type==="POINT_LIST"||e.formula.expression_type==="SINGLE_POINT"}function $u(e){return e.formula.expression_type==="POINT3D_LIST"}function ju(e){let t=sl(e);return!!(t&&t.type==="visualization"&&t.symbol==="boxplot")}function kp(e){let t=sl(e);return!!(t&&t.type==="visualization"&&t.symbol==="dotplot")}function Pg(e){let t=sl(e);return!!(t&&t.type==="visualization"&&t.symbol==="histogram")}function pT(e){return ju(e)||kp(e)||Pg(e)}function jw(e){return e.formula.expression_type==="TTEST"}function uT(e){return e.formula.expression_type==="STATS"}function _p(e){let t=sl(e);return!!(t&&t.type==="distribution")}function uH(e){let{formula:t}=e;return t?!!t.is_discrete_distribution:!1}function hH(e){var t,r;let n=(r=(t=e.formula)==null?void 0:t.geometry)==null?void 0:r.valueType;if(n!==void 0)return __dcg_shared_module_exports__.Ab(n,__dcg_shared_module_exports__.La)}function sl(e){if(e.controller.areDistributionsEnabled()&&e.latex)return(!e.cachedParseToplevelFunction||e.cachedParseToplevelFunction.latex!==e.latex)&&(e.cachedParseToplevelFunction={latex:e.latex,spec:__dcg_shared_module_exports__.Yc(e.latex)}),e.cachedParseToplevelFunction.spec}function IL(e){return Yw(e)&&_p(e)}function Yw(e){return!!e.formula.expression_type}function AL(e){return!!e.formula.is_concrete_list}function vd(e){return!IL(e)||AL(e)?!1:e.cdf.show}function hT(e){return e.cdf.min}function gT(e){return e.cdf.max}function gH(e){let t=sL(e.formula.cdf_min_default);return t===-1/0?"-\\infty":isFinite(t)?t+"":"-\\infty"}function mH(e){let t=sL(e.formula.cdf_max_default);return t===1/0?"\\infty":isFinite(t)?t+"":"\\infty"}function fH(e,t){e.cdf=ie(R({},e.cdf),{show:t})}function WE(e,t){e.cdf=ie(R({},e.cdf),{min:t})}function $E(e,t){e.cdf=ie(R({},e.cdf),{max:t})}function mT(e){return!!e.formula&&e.formula.cdf_min_valid!==!1}function fT(e){return!!e.formula&&e.formula.cdf_max_valid!==!1}function ML(e){return!!e.formula&&e.formula.fill_opacity_valid!==!1}function GL(e){return!!e.formula&&e.formula.surface_opacity_valid!==!1}function bH(e){return!!e.formula&&e.formula.line_opacity_valid!==!1}function yH(e){return!!e.formula&&e.formula.point_opacity_valid!==!1}function LL(e){return!!e.formula&&e.formula.label_size_valid!==!1}function PL(e){return!!e.formula&&e.formula.label_angle_valid!==!1}function xH(e){return!!e.formula&&e.formula.movable_point_size_valid!==!1}function bT(e){return!!e.formula&&e.formula.point_size_valid!==!1}function yT(e){return!!e.formula&&e.formula.line_width_valid!==!1}function wH(e){return!!e.formula&&e.formula.resolution_valid!==!1}function bE(e){return!!e.formula&&e.formula.color_latex_valid!==!1}function yE(e){return e.formula&&e.formula.color_latex_value}function vH(e){return e.formula&&e.formula.label_angle_value}function VL(e){let t=e.formula&&e.formula.cdf_evaluation;return isFinite(t)?t:0}function OL(e){if(!e||!__dcg_shared_module_exports__._c(e.formula.expression_type))return!1;let t=Ro(e);return!(t&&t!=="NONE")}function CH(e){e.showLabel=__dcg_shared_module_exports__.Ad.showLabel,e.showAngleLabel=__dcg_shared_module_exports__.Ad.showAngleLabel,e.label=__dcg_shared_module_exports__.Ad.label,e.hidden=__dcg_shared_module_exports__.Ad.hidden,e.dragMode=__dcg_shared_module_exports__.Ad.dragMode,e.fill=__dcg_shared_module_exports__.Ad.fill,e.points=__dcg_shared_module_exports__.Ad.points,e.pointStyle=__dcg_shared_module_exports__.Ad.pointStyle,e.lines=__dcg_shared_module_exports__.Ad.lines,e.lineStyle=__dcg_shared_module_exports__.Ad.lineStyle,e.slider=e.controller.is3dProduct()?__dcg_shared_module_exports__.Cd:__dcg_shared_module_exports__.Bd,e.latex="",e.labelSize="",e.labelOrientation="default",e.displayEvaluationAsFraction=__dcg_shared_module_exports__.Ad.displayEvaluationAsFraction,e.strictIntersection=__dcg_shared_module_exports__.Ad.strictIntersection,e.suppressTextOutline=!1,e.interactiveLabel=!1,e.editableLabelMode=__dcg_shared_module_exports__.Ad.editableLabelMode,__dcg_shared_module_exports__.sd(__dcg_shared_module_exports__.zd,e)}function xT(e){return!!e.formula.move_strategy}function RL(e,t){fb(e,{type:"inert",disableGraphInteractions:t})}function SH(e){if((e==null?void 0:e.type)!=="expression"||!e.formula.typed_constant_value)return;let{value:t,valueType:r}=e.formula.typed_constant_value;switch(r){case __dcg_shared_module_exports__.ya:case __dcg_shared_module_exports__.db:return{x:t[0],y:t[1]}}}function FL(e,t){var r;if(!(e.type!=="expression"&&e.type!=="image"))return(r=e.formula.computed_description)==null?void 0:r[t||0]}function Cd(e,t,r){let n=Intl.ListFormat;if(typeof n=="function")try{return new n(e,r).format(t)}catch(i){}return t.join(", ")}var wT={cb20221031:"1"};qt();var Qee="",Zee=[];function ete(e){if(e.status===401)for(let t of Zee)t()}function tte(e){return Fr(this,null,function*(){if(e&&e.routeDeprecated)throw e.js&&new Function(e.js)(),e})}function rte(e){let t=new URLSearchParams;return Object.entries(e).forEach(([r,n])=>{Array.isArray(n)?n.forEach(i=>t.append(r,String(i))):t.set(r,String(n))}),t}function ote(){throw{status:0,responseJSON:{errors:[{key:"connection_failed",message:"Connection failed. Check your internet connection?"}]}}}function ite(e){return Fr(this,null,function*(){let t=yield e.catch(ote);if(ete(t),!t.ok){let n;try{n=yield t.json()}catch(i){}throw{status:t.status,statusText:t.statusText,responseJSON:n}}let r=yield t.json();return yield tte(r),r})}function EH(e,t){return Fr(this,null,function*(){let r={method:"GET",credentials:"include",headers:{Accept:"application/json, text/javascript, */*; q=0.01"}},n=/\?/.test(String(e))?"&":"?";return yield ite(fetch(`${Qee}${e}${n}${rte(R(R({},t),wT))}`,r))})}function Xw(e){let t=[];for(let r of e){if(!r||typeof r!="string")continue;let n=r.split("-")[0];t.push(r),t.push(n);for(let i in Vg){let o=Vg[i];i.split("-")[0]===n&&o.useAsRoot&&t.push(i)}}return t}var Vg={en:{displayName:"English (US)",userGuideURL:"https://docs.google.com/document/d/1gV-WgDjgR9hKKb32ffeUpjwggNAgfqxl0Gsg6xocbok/preview",useAsRoot:!1},es:{displayName:"Español (LATAM)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ES-ES.pdf",useAsRoot:!0},et:{displayName:"Eesti",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ru:{displayName:"Русский",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_RU.pdf",useAsRoot:!1},da:{displayName:"Dansk",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},de:{displayName:"Deutsch",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_DE.pdf",useAsRoot:!1},"pt-BR":{displayName:"Português (Brasil)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!0},"pt-PT":{displayName:"Português (Portugal)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ca:{displayName:"Català",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},fr:{displayName:"Français",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_FR.pdf",useAsRoot:!0},"fr-CA":{displayName:"Français (Canada)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_FR.pdf",useAsRoot:!0},it:{displayName:"Italiano",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_IT.pdf",useAsRoot:!1},is:{displayName:"Íslenska",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},nl:{displayName:"Nederlands",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},no:{displayName:"Norsk",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},"sv-SE":{displayName:"Svenska",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!0},hu:{displayName:"Magyar",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},cs:{displayName:"Čeština",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},pl:{displayName:"Polski",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_PL.pdf",useAsRoot:!1},id:{displayName:"Bahasa Indonesia",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},vi:{displayName:"Tiếng Việt",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_VI.pdf",useAsRoot:!1},el:{displayName:"Ελληνικά",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_EL.pdf",useAsRoot:!1},uk:{displayName:"Українська",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ka:{displayName:"ქართული",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},th:{displayName:"ภาษาไทย",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},tr:{displayName:"Türkçe",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_TR.pdf",useAsRoot:!1},"zh-CN":{displayName:"简体中文",useAsRoot:!0,userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ZH-CN.pdf"},"zh-TW":{displayName:"繁體中文",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ZH-TW.pdf",useAsRoot:!1},ko:{displayName:"한국어",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ja:{displayName:"日本語",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_JA.pdf",useAsRoot:!1}},TH=`account-shell-button-cancel = Cancel
account-shell-button-mygraphs-cancel = Cancel
account-shell-link-help = Help
shared-button-back = Back
shared-button-close-dialog = Close Dialog
shared-button-learn-more-capitalized = Learn More
shared-calculator-button-braille-mode-nemeth = Nemeth
shared-calculator-button-braille-mode-ueb = UEB
shared-calculator-button-go = Go
shared-calculator-button-hide-options = Hide Options
shared-calculator-button-show-options = Show Options
shared-calculator-error-3d-bad-equality-slice = We don't support this type of equality restriction.
shared-calculator-error-3d-length-type-error = Function '{ $fn }' cannot be applied to { $arg } in the 3d calculator. Use '{ $alternativeFn }' to find the number of elements in a list.
shared-calculator-error-3d-mixed-restriction-equation = Cannot apply both an inequality restriction and an equality restriction to this expression.
shared-calculator-error-3d-multiple-equality-restrictions = Cannot apply more than one equality restriction.
shared-calculator-error-action-merge-free-variable = Cannot combine an action that depends on free variable '{ $symbol }'.
shared-calculator-error-add-arguments-to-definition-many = Try including '{ $symbols }' and '{ $lastSymbol }' as arguments by defining the function as '{ $newSignature }'.
shared-calculator-error-add-arguments-to-definition-one = Try including '{ $lastSymbol }' as an argument by defining the function as '{ $newSignature }'.
shared-calculator-error-add-type-error = Cannot add { $symbol1 } and { $symbol2 }.
shared-calculator-error-adjacent-mixed-number = Sorry, I don't know what to do with mixed number '{ $mixedNumber }'. Try using a '*' symbol around it.
shared-calculator-error-adjacent-numbers = Sorry, I don't know what to do with adjacent numbers '{ $left }' and '{ $right }'. Try using parentheses or a '*' symbol.
shared-calculator-error-ans-undefined = The previous expression didn't define any value for ans.
shared-calculator-error-assignments-unsupported = This calculator does not support defining variables.
shared-calculator-error-bad-for-input-list-dependency = A definition on the right-hand side of 'for' can't depend on input variable '{ $symbol }'.
shared-calculator-error-bad-for-interval-dependency = Parameter bounds on the right-hand side of 'for' can't depend on input variable '{ $symbol }'.
shared-calculator-error-bad-implicit-call = Use parentheses around the argument of '{ $symbol }'.
shared-calculator-error-bad-integral-bound-dependency = Integration bounds can't depend on integration variable '{ $symbol }'.
shared-calculator-error-bad-interval-comprehension-arity =
    { $count ->
        [one] You can't use 'for' to parameterize { $type } using 1 parameter.
       *[other] You can't use 'for' to parameterize { $type } using { $count } parameters.
    }
shared-calculator-error-bad-log-exponent = Only { $form } is supported. Otherwise, use parens.
shared-calculator-error-bad-product-bound-dependency = Product bounds can't depend on product index '{ $symbol }'.
shared-calculator-error-bad-sample-size = Sample size must be a finite, non-negative number.
shared-calculator-error-bad-sum-bound-dependency = Summation bounds can't depend on summation index '{ $symbol }'.
shared-calculator-error-bad-symbol-context = You can't use '{ $symbol }' in this context.
shared-calculator-error-bad-trig-exponent = Only { $form1 } and { $form2 } are supported. Otherwise, use parens.
shared-calculator-error-bad-tuple-dimensions = Points may only have { $symbol } coordinates.
shared-calculator-error-binary-operator-missing-operand = You need something on both sides of the '{ $symbol }' symbol.
shared-calculator-error-blank-expression = You haven't written anything yet.
shared-calculator-error-boxplot-breadth-invalid = Invalid height. Try using any number.
shared-calculator-error-boxplot-offset-invalid = Invalid offset. Try using any number.
shared-calculator-error-cannot-assign-color = Cannot assign a color to '{ $variable }'.
shared-calculator-error-cannot-redefine = You can't redefine '{ $symbol }' because it's already defined.
shared-calculator-error-cannot-redefine-root = You can't define '{ $symbol }' because '{ $symbolRoot }' is already defined.
shared-calculator-error-cannot-restrict = Cannot create a restriction based on '{ $variable }' in this type of expression.
shared-calculator-error-cannot-restrict-with-equality = Cannot create an equality restriction based on '{ $variable }' in this type of expression.
shared-calculator-error-cannot-subscript = '{ $symbol }' cannot have a subscript.
shared-calculator-error-cant-combine-spherical-and-cylindrical = Can't combine spherical and cylindrical coordinates.
shared-calculator-error-cdf-max-invalid = Invalid cdf max. Try using any number.
shared-calculator-error-cdf-max-less-than-min = Invalid cdf limits. Min should be less than max.
shared-calculator-error-cdf-min-invalid = Invalid cdf min. Try using any number.
shared-calculator-error-cdf-too-many-arguments = 'cdf' should be called on a distribution with at most two numbers. { $recommendation }
shared-calculator-error-cdf-too-many-arguments-recommendation = For example, try typing: D.cdf(-1,1) where D=normaldist().
shared-calculator-error-cdf-wrong-arity = 'cdf' should be called on a distribution with at least one number. { $recommendation }
shared-calculator-error-cdf-wrong-arity-recommendation = For example, try typing: D.cdf(x) where D=normaldist().
shared-calculator-error-clickable-object-assignment-not-defined = "{ $symbol }" is not defined. Try using a different variable or adding a slider.
shared-calculator-error-clickable-object-assignment-not-identifier = Invalid symbol. Try using a single letter.
shared-calculator-error-clickable-object-invalid-expression = Can't evaluate this. Try a number or simple expression.
shared-calculator-error-colon-missing-condition = The left side of a ':' must be a condition, like 'x>1'.
shared-calculator-error-color-arity = '{ $symbol }' should be called with 3 arguments. { $recommendation }
shared-calculator-error-color-arity-recommendation = For example, try typing: { $recommendation }.
shared-calculator-error-color-not-assigned = To use a color, you must assign it to a variable.
shared-calculator-error-combine-type-error = Cannot combine { $symbol1 } and { $symbol2 }.
shared-calculator-error-comparator-type-error = Cannot compare { $symbol1 } to { $symbol2 }.
shared-calculator-error-complex-list-access = Indexing a list with a complex number is not well-defined.
shared-calculator-error-complex-operation-undefined = Note: '{ $symbol }' isn't well-defined for complex numbers.
shared-calculator-error-complex-operation-unimplemented = Note: '{ $symbol }' is not yet implemented for complex numbers.
shared-calculator-error-complex-point-coordinate = Points with complex coordinates are not supported.
shared-calculator-error-complex-round = Note: '{ $symbol }' with complex precision is not well-defined.
shared-calculator-error-complex-sort = Note: '{ $symbol }' uses lexicographic ordering for complex numbers.
shared-calculator-error-complex-table-point-coordinate = Only real-valued coordinate pairs can be plotted.
shared-calculator-error-complicated-double-inequality = We only support solved double inequalities. Try deleting one side of the inequality.
shared-calculator-error-complicated-polar-implicit = Polar equations must be linear in r.
shared-calculator-error-constant-unsupported = This calculator does not support the constant '{ $symbol }'.
shared-calculator-error-coordinate-access-type-error = Cannot access coordinate '{ $coordinate }' of { $symbol }.
shared-calculator-error-custom-regressions-unsupported = This calculator does not support custom regressions.
shared-calculator-error-custom-toolbar-not-condition = Please write a valid condition and make sure every referenced variable is defined.
shared-calculator-error-deeply-nested = Definitions are nested too deeply.
shared-calculator-error-dependency-cycle = '{ $symbols }' and '{ $lastSymbol }' can't be defined in terms of each other.
shared-calculator-error-depends-on-deleted-geo-object = This depends on a geometric object that's no longer defined.
shared-calculator-error-derivative-missing-body = What do you want to take the derivative of?
shared-calculator-error-derivative-type-error = Cannot take the derivative of { $symbol }.
shared-calculator-error-derivative-type-error-respect = Cannot take the derivative of { $symbol1 } with respect to { $symbol2 }.
shared-calculator-error-derivative-variable-type-error = Cannot take derivative with respect to '{ $symbol1 }' because it is { $symbol2 }.
shared-calculator-error-differential-with-superscript = Integration variable cannot have a superscript.
shared-calculator-error-distribution-as-function = Cannot call distribution '{ $symbol }' as a function. Try '{ $symbol }.pdf(x)'.
shared-calculator-error-divide-type-error = Cannot divide { $symbol1 } by { $symbol2 }.
shared-calculator-error-domain-max-invalid = Invalid domain max. Try using any number.
shared-calculator-error-domain-max-less-than-min = Invalid domain limits. Min should be less than max.
shared-calculator-error-domain-min-invalid = Invalid domain min. Try using any number.
shared-calculator-error-dot-lhs-constant-number = Sorry, I don't understand this use of '.' after a constant number.
shared-calculator-error-dot-lhs-type-error = Cannot call '.{ $symbol }' on { $type }.
shared-calculator-error-dot-rhs-property-error = '.{ $symbol }' cannot be followed by parentheses.
shared-calculator-error-duplicate-function-parameter = Cannot use '{ $dependency }' for multiple parameters of this function.
shared-calculator-error-duplicate-update-rules = An action cannot specify multiple update rules for '{ $symbol }'.
shared-calculator-error-empty-paren = Parentheses cannot be empty.
shared-calculator-error-empty-pipe = Absolute value symbol cannot be empty.
shared-calculator-error-empty-radical = Radical cannot be empty.
shared-calculator-error-empty-radical-index = Radical index cannot be empty.
shared-calculator-error-empty-square-bracket = Square brackets cannot be empty.
shared-calculator-error-empty-subscript = Subscripts cannot be empty.
shared-calculator-error-empty-superscript = Superscripts cannot be empty.
shared-calculator-error-equation-required = Try adding an equals sign to turn this into an equation.
shared-calculator-error-equation-required-symbol = Try adding '{ $lhs }' to the beginning of this equation.
shared-calculator-error-equations-unsupported = This calculator does not support this type of equation.
shared-calculator-error-event-handler-type-error = This should be an action. Try '{ $example }'.
shared-calculator-error-exponent-type-error = Cannot raise { $symbol1 } to { $symbol2 }.
shared-calculator-error-feature-unavailable = This feature is not available in the current calculator.
shared-calculator-error-fraction-empty = You need a numerator and denominator for your fraction.
shared-calculator-error-fraction-missing-denominator = You need a denominator for the bottom of your fraction.
shared-calculator-error-fraction-missing-numerator = You need a numerator for the top of your fraction.
shared-calculator-error-function-definition-unsupported = This calculator does not support function definitions.
shared-calculator-error-function-name-as-parameter = Cannot use function name '{ $dependency }' as a function parameter.
shared-calculator-error-function-not-defined = Function '{ $dependency }' is not defined.
shared-calculator-error-function-only-works-in-complex = The '{ $symbol }' function is only available in complex mode.
shared-calculator-error-function-type-error-1 = Function '{ $fn }' cannot be applied to { $arg }.
shared-calculator-error-function-type-error-2 = Function '{ $fn }' cannot be applied to { $arg1 } and { $arg2 }.
shared-calculator-error-function-type-error-many = Function '{ $fn }' cannot be applied to these arguments.
shared-calculator-error-function-unsupported = This calculator does not support the '{ $symbol }' function.
shared-calculator-error-geometry-length-type-error = Function '{ $fn }' cannot be applied to { $arg } in the geometry calculator. Use '{ $alternativeFn }' to find the number of elements in a list.
shared-calculator-error-gpu-expression-too-complex = We encountered a GPU error while plotting this expression.
shared-calculator-error-gpu-function-unsupported = Cannot use the '{ $symbol }' function here.
shared-calculator-error-gpu-integral-unsupported = Cannot use integrals here.
shared-calculator-error-gpu-long-product = Products may not have more than { $maxTermCount } terms here.
shared-calculator-error-gpu-long-sum = Sums may not have more than { $maxTermCount } terms here.
shared-calculator-error-gpu-max-list-size = Lists may not have more than { $maxListSize } elements here.
shared-calculator-error-gpu-variable-list-length = List length cannot depend on variable '{ $symbol }' here.
shared-calculator-error-gpu-variable-product = Product bound cannot depend on variable '{ $symbol }' here.
shared-calculator-error-gpu-variable-sum = Sum bound cannot depend on variable '{ $symbol }' here.
shared-calculator-error-heterogeneous-list = All elements of a list must have the same type.
shared-calculator-error-identifier-as-function = '{ $symbol }' is a function. Try using parentheses.
shared-calculator-error-identifier-is-not-function = '{ $symbol }' is not a function. Try defining it as '{ $symbol }(x) = x^2' instead.
shared-calculator-error-illegal-bin-width = The second argument to '{ $symbol }' must be a positive number.
shared-calculator-error-illegal-dot-call = Function '{ $symbol }' cannot be called with dot notation.
shared-calculator-error-implicits-disabled = Plotting implicit equations and inequalities is disabled.
shared-calculator-error-incorrect-list-comprehension-input = Definitions on the right-hand side of 'for' must set a variable equal to a list. Try i=[1...10].
shared-calculator-error-incorrect-product-lower-bound = Lower bound of a product must set a variable equal to a number. Try n=1.
shared-calculator-error-incorrect-sum-lower-bound = Lower bound of a sum must set a variable equal to a number. Try n=1.
shared-calculator-error-index-type-error = Cannot index { $symbol1 } with { $symbol2 }.
shared-calculator-error-inequalities-disabled = Plotting inequalities is disabled.
shared-calculator-error-inequalities-unsupported = This calculator does not support inequalities.
shared-calculator-error-integral-argument-type-error = Cannot take the integral of { $symbol }.
shared-calculator-error-integral-lower-bound-type-error = Lower bound of an integral cannot be { $symbol }.
shared-calculator-error-integral-missing-body = What do you want to take the integral of?
shared-calculator-error-integral-missing-bound = Integrals must have upper and lower bounds.
shared-calculator-error-integral-missing-differential = Integrand must end with an integration variable, like dx.
shared-calculator-error-integral-upper-bound-type-error = Upper bound of an integral cannot be { $symbol }.
shared-calculator-error-internal-error = [internal] { $msg }
shared-calculator-error-invalid-dependent-first-table-column = This column header can't be defined elsewhere in the calculator.
shared-calculator-error-invalid-double-equality-3d = Sorry, we only plot double equalities that contain z. Try adding 0*z to one side.
shared-calculator-error-invalid-double-inequality-3d = We only plot double inequalities of x, y, and z.
shared-calculator-error-invalid-double-inequality-variables = We only plot double inequalities of x and y.
shared-calculator-error-invalid-first-table-column = First column may not be { $most } or { $last }.
shared-calculator-error-invalid-half-empty-range = Range must have an upper and lower bound.
shared-calculator-error-invalid-implicit-variables = We only support implicit equations of x and y.
shared-calculator-error-invalid-implicit-variables-3d = We only support implicit equations of x, y, and z.
shared-calculator-error-invalid-inequality-variables = We only plot inequalities of x and y, or r and θ.
shared-calculator-error-invalid-interval-comprehension-invalid-bound = Parameter bounds on the right-hand side of 'for' must be of the form '0<{ $identifier }<1'.
shared-calculator-error-invalid-interval-comprehension-return-type = You can't use 'for' to parameterize { $type }.
shared-calculator-error-invalid-lhs = Sorry, you can't graph { $symbol } as a function of anything yet.
shared-calculator-error-invalid-operator-name = Operator names may only contain letters.
shared-calculator-error-invalid-regression-parameter = '{ $symbol }' may not be used as a regression parameter. Try using a different variable name.
shared-calculator-error-invalid-subscript = Subscripts may only contain letters and digits. '{ $symbol }' is not allowed.
shared-calculator-error-invalid-table-entry = Table entries must be simple expressions. { $supplement }
shared-calculator-error-invalid-table-header = Table headers must be simple expressions. { $supplement }
shared-calculator-error-list-comprehension-input-type-error = A definition on the right-hand side of 'for' must be a list, but { $identifier } is { $actual }. Try { $identifier }={ $example }.
shared-calculator-error-list-type-error = Cannot store { $symbol1 } in a list.
shared-calculator-error-log-scale-box-plot = Cannot plot a box plot on a log scale.
shared-calculator-error-log-scale-dot-plot = Cannot plot a dot plot on a log scale.
shared-calculator-error-log-scale-histogram = Cannot plot a histogram on a log scale.
shared-calculator-error-log-scale-type-error = Cannot plot { $symbol } on a log scale.
shared-calculator-error-logbase-unsupported = This calculator does not support specifying the base of a logarithm. Try 'log' or 'ln'.
shared-calculator-error-malformed-list = Lists are written like this: [1, 2, 3].
shared-calculator-error-malformed-point = Points are written like this: (1, 2).
shared-calculator-error-matrix-add-dimensions = Cannot add matrices with different dimensions.
shared-calculator-error-matrix-assignment = This calculator does not support this type of variable definition. Try using 'New Matrix'.
shared-calculator-error-matrix-element-type-error = Cannot use { $arg } as an element of a matrix.
shared-calculator-error-matrix-fractional-power = A matrix can only be raised to integer powers.
shared-calculator-error-matrix-invalid-variable = Cannot use '{ $symbol }' as a variable.
shared-calculator-error-matrix-multiply-dimensions = Cannot multiply matrices with incompatible dimensions.
shared-calculator-error-matrix-power-dimensions = Only square matrices can be raised to a power.
shared-calculator-error-matrix-subtract-dimensions = Cannot subtract matrices with different dimensions.
shared-calculator-error-max-list-size = Lists may not have more than { $maxListSize } elements.
shared-calculator-error-method-requires-list = '{ $symbol }' requires a list. For example, try typing: { $recommendation }.
shared-calculator-error-mismatched-braces = Expected '{ $symbol1 }' to match '{ $symbol2 }'.
shared-calculator-error-mismatched-double-inequality = Double inequalities must both go the same way, e.g. { $example }.
shared-calculator-error-mixed-comparator-chain = Cannot mix inequalities and equations in a chain of comparisons.
shared-calculator-error-multiply-defined = You've defined '{ $dependency }' in more than one place. Try deleting some of the definitions of '{ $dependency }'.
shared-calculator-error-multiply-type-error = Cannot multiply { $symbol1 } by { $symbol2 }.
shared-calculator-error-multiply-type-error-2d = Ambiguous multiplication of { $symbol1 } by { $symbol2 }. Try typing: (1, 2) * (2, 1).
shared-calculator-error-multiply-type-error-3d = Ambiguous multiplication of { $symbol1 } by { $symbol2 }. Try typing: (1, 2, 3) cross (2, 1, 0).
shared-calculator-error-multiply-type-error-cross = Cannot take the cross product of { $symbol1 } and { $symbol2 }.
shared-calculator-error-negative-type-error = Cannot negate { $symbol }.
shared-calculator-error-nested-interval-comprehension = You can't yet use 'for' to introduce a new parameter to an already parameterized point.
shared-calculator-error-non-arithmetic-range = Ranges must be arithmetic sequences.
shared-calculator-error-non-list-double-reducer = Both arguments of '{ $symbol }' must be lists. For example, try typing: { $recommendation }.
shared-calculator-error-non-list-parameterized-reducer = The first argument of '{ $symbol }' must be a list. For example, try typing: { $recommendation }.
shared-calculator-error-non-singular-inverse = Singular matrices do not have an inverse.
shared-calculator-error-non-square-determinant = Only square matrices have a determinant.
shared-calculator-error-non-square-inverse = Only square matrices have an inverse.
shared-calculator-error-non-square-trace = Only square matrices have a trace.
shared-calculator-error-operator-type-error = Cannot apply { $symbol } to { $symbol1 } and { $symbol2 }.
shared-calculator-error-optimization-error = We couldn't find any region where this model is defined.
shared-calculator-error-parameter-already-defined = You can't use '{ $dependency }' as a parameter of this function because '{ $dependency }' is already defined.
shared-calculator-error-parse-error = Sorry, I don't understand this.
shared-calculator-error-pdf-wrong-arity = 'pdf' should be called on a distribution with a number. { $recommendation }
shared-calculator-error-pdf-wrong-arity-recommendation = For example, try typing: D.pdf(x) where D=normaldist().
shared-calculator-error-percent-missing-of = '%' must be used with 'of'. Try '25% of 12'.
shared-calculator-error-piecewise-branch-type-error = Cannot use { $symbol1 } and { $symbol2 } as the branches in a piecewise. Every branch must have the same type.
shared-calculator-error-piecewise-condition-type-error = The condition in a piecewise expression must be { $symbol1 } but was { $symbol2 }.
shared-calculator-error-piecewise-missing-condition = A piecewise expression must have at least one condition.
shared-calculator-error-piecewise-part-missing-condition = Every part of a piecewise expression must have a condition except the last.
shared-calculator-error-point-type-error = Cannot use { $symbol1 } as a coordinate of { $symbol2 }.
shared-calculator-error-points-unsupported = This calculator does not support points.
shared-calculator-error-polygon-unsupported-in-3d = This calculator does not support the 'polygon' function. Try 'triangle' instead.
shared-calculator-error-prime-variable-type-error = Cannot take derivative of '{ $symbol1 }' with respect to { $symbol2 }.
shared-calculator-error-prime-without-paren = Primed function calls must use parentheses.
shared-calculator-error-primed-function-arity = Prime notation can only be used for functions of a single argument.
shared-calculator-error-product-argument-type-error = Cannot take the product of { $symbol }.
shared-calculator-error-product-infinite-bound-type-error = Product bounds must be finite numbers.
shared-calculator-error-product-lower-bound-type-error = Lower bound of a product cannot be { $symbol }.
shared-calculator-error-product-missing-body = What do you want to take the product of?
shared-calculator-error-product-missing-bound = Products must have upper and lower bounds.
shared-calculator-error-product-upper-bound-type-error = Upper bound of a product cannot be { $symbol }.
shared-calculator-error-random-arity = 'random' should be called with no arguments, or an optional number of samples. For example, try random() or random(10).
shared-calculator-error-random-from-broadcast-distribution = Cannot sample from a list of distributions
shared-calculator-error-recursion-argument-type = Expected argument { $index } to be { $expectedType } but found { $foundType }.
shared-calculator-error-recursion-base-case-argument-non-number = Base case arguments must be simple numbers. Try using piecewise syntax.
shared-calculator-error-recursion-base-case-free-variable = This recursion's base case can't depend on variable '{ $freeVariable }'.
shared-calculator-error-recursion-base-case-same-type = Base cases must all have the same return type.
shared-calculator-error-recursion-base-case-too-complicated = For a recursion with multiple parameters, try using piecewise syntax.
shared-calculator-error-recursion-depth-limit-exceeded = Recursive depth limit exceeded without reaching a base case.
shared-calculator-error-recursion-does-not-terminate = This recursion doesn't reach a base case.
shared-calculator-error-recursion-missing-base-case =
    { $count ->
        [one] The definition of function '{ $lastSymbol }' depends on itself. If '{ $lastSymbol }' is meant to be a recursive function, try adding a valid base case.
       *[other] The definitions of functions '{ $symbols }' and '{ $lastSymbol }' depend on each other. If they are meant to be mutually recursive functions, try adding a valid base case.
    }
shared-calculator-error-recursion-wrong-arity =
    { $count ->
        [one] Function '{ $fnSymbol }' requires 1 argument.
       *[other] Function '{ $fnSymbol }' requires { $count } arguments.
    }
shared-calculator-error-regression-recursion = Recursive functions may not be used inside regressions.
shared-calculator-error-regression-type-error = Cannot regress { $symbol1 } against { $symbol2 }.
shared-calculator-error-regressions-unsupported = This calculator does not support regressions.
shared-calculator-error-required-arguments-area = Function '{ $symbol }' requires a polygon.
shared-calculator-error-required-arguments-circle = Function 'circle' requires a center point and another point, segment, or radius value.
shared-calculator-error-required-arguments-coterminal = Function '{ $symbol }' requires an angle.
shared-calculator-error-required-arguments-dilate = Function '{ $symbol }' requires an object, then a point and a number.
shared-calculator-error-required-arguments-glider = Function 'glider' requires an object, then a number.
shared-calculator-error-required-arguments-intersection = Function 'intersection' requires 2 objects (lines, circles, or arcs).
shared-calculator-error-required-arguments-length = Function 'length' requires a segment.
shared-calculator-error-required-arguments-midpoint = Function 'midpoint' requires a segment or 2 points.
shared-calculator-error-required-arguments-perpendicular = Function '{ $symbol }' requires a line and a point.
shared-calculator-error-required-arguments-points = Function '{ $symbol }' requires { $count } points.
shared-calculator-error-required-arguments-polygon = Function 'polygon' requires several points.
shared-calculator-error-required-arguments-radius = Function '{ $symbol }' requires a circle or arc.
shared-calculator-error-required-arguments-reflect = Function 'reflect' requires an object, then a line, segment, ray, or vector.
shared-calculator-error-required-arguments-sphere = Function 'sphere' requires a center point and a radius value.
shared-calculator-error-required-arguments-start = Function '{ $symbol }' requires a vector.
shared-calculator-error-required-arguments-supplement = Function 'supplement' requires a directed angle.
shared-calculator-error-required-arguments-translate = Function 'translate' requires an object, then 2 points or a vector.
shared-calculator-error-required-arguments-triangle = Function 'triangle' requires three 3d points.
shared-calculator-error-required-arguments-vector = Function 'vector' requires a start point and end point.
shared-calculator-error-self-referential-base-case = A base case for recursive function '{ $symbol }' cannot depend on '{ $symbol }'.
shared-calculator-error-self-referential-functions =
    { $count ->
        [one] The definition of function '{ $lastSymbol }' depends on itself.
       *[other] The definitions of functions '{ $symbols }' and '{ $lastSymbol }' depend on each other.
    }
shared-calculator-error-self-referential-suggest-alternative = '{ $symbol }' cannot be defined recursively. Try renaming this function.
shared-calculator-error-shadowed-index = You can't use '{ $symbol }' as an index because it's already defined.
shared-calculator-error-shadowed-integration-variable = You can't use '{ $symbol }' as an integration variable because it's already defined.
shared-calculator-error-shadowed-list-comprehension-input = You can't define '{ $symbol }' more than once on the right-hand side of 'for'.
shared-calculator-error-single-variable-implicit-equations-disabled = Plotting single-variable implicit equations is disabled.
shared-calculator-error-slider-limit-references-export = Slider limits cannot depend on the slider variable '{ $symbol }'.
shared-calculator-error-slider-max-invalid = Invalid slider max. Try using any number.
shared-calculator-error-slider-max-less-than-min = Invalid slider limits. Min should be less than max.
shared-calculator-error-slider-min-invalid = Invalid slider min. Try using any number.
shared-calculator-error-slider-step-invalid = Invalid slider step. Try using any number.
shared-calculator-error-slow-evaluation = This is taking a long time to evaluate. Try editing or deleting this expression.
shared-calculator-error-substitution-ambiguous-comma = Ambiguous use of ',' and '{ $operation }'. Add parentheses around the '{ $operation }' expression.
shared-calculator-error-substitution-body-action = The left hand side of a 'with' substitution cannot be an action.
shared-calculator-error-substitution-body-regression-parameter-dependency = Can't use '{ $operator }' to substitute for the existing variable '{ $globalVariable }' because the expression on the left-hand side depends on '{ $regressionParameter }', which is a regression parameter.
shared-calculator-error-substitution-duplicate-assignment = A 'with' expression cannot make multiple substitutions for '{ $symbol }'.
shared-calculator-error-substitution-function-lhs = Substituting for '{ $symbol }' is not allowed because it is a function.
shared-calculator-error-substitution-illegal-lhs = Substituting for '{ $symbol }' is not allowed.
shared-calculator-error-substitution-invalid-assignments = 'with' must be followed by one or more variable definitions.
shared-calculator-error-substitution-local-lhs = Substituting for variable '{ $symbol }' is not allowed because it is locally defined.
shared-calculator-error-substitution-nested = Using one 'with' expression inside another 'with' expression is not allowed.
shared-calculator-error-substitution-recursive-call-lhs = Can't use '{ $operator }' to substitute for the existing variable '{ $globalVariable }' because the expression on the left-hand side depends on a recursive function call to '{ $fnSymbol }'.
shared-calculator-error-substitution-type-error = Cannot substitute { $actual } for { $expected }.
shared-calculator-error-substitution-unsupported-interval = Intervals are not allowed on the right-hand side of 'with'. You might want to try using 'for' instead.
shared-calculator-error-subtract-type-error = Cannot subtract { $symbol2 } from { $symbol1 }.
shared-calculator-error-sum-argument-type-error = Cannot take the sum of { $symbol }.
shared-calculator-error-sum-infinite-bound-type-error = Summation bounds must be finite numbers.
shared-calculator-error-sum-lower-bound-type-error = Lower bound of a sum cannot be { $symbol }.
shared-calculator-error-sum-missing-body = What do you want to take the sum of?
shared-calculator-error-sum-missing-bound = Sums must have upper and lower bounds.
shared-calculator-error-sum-upper-bound-type-error = Upper bound of a sum cannot be { $symbol }.
shared-calculator-error-superscript-with-prime = Superscripts and primes cannot be combined.
shared-calculator-error-table-entry-type-error = Table entry cannot be { $symbol }.
shared-calculator-error-table-equation-supplement = Equations are not allowed.
shared-calculator-error-table-function-definition-supplement = Function definitions are not allowed.
shared-calculator-error-table-generic-supplement = This type of expression is not allowed.
shared-calculator-error-table-header-type-error = Table header cannot be { $symbol }.
shared-calculator-error-table-inequality-supplement = Inequalities are not allowed.
shared-calculator-error-table-list-supplement = Lists are not allowed.
shared-calculator-error-table-regression-invalid-data = There's an error in the provided data.
shared-calculator-error-table-regression-invalid-export-identifier = The headers need to be simple identifiers to export. Try assigning { $latex } to a variable and then referencing it in the table header.
shared-calculator-error-table-regression-log-with-negative = Logarithmic regressions only work if the first column is all positive numbers.
shared-calculator-error-table-regression-supplement = Regressions are not allowed.
shared-calculator-error-table-regression-type-error = The data contains { $symbol }.
shared-calculator-error-tdist-wrong-arity = 'tdist' requires 1 argument. For example, try typing: tdist(1).
shared-calculator-error-ticker-min-step-nonnegative = Min step must evaluate to a non-negative number.
shared-calculator-error-token-with-subscript = Tokens may not have subscripts.
shared-calculator-error-too-many-arguments = '{ $symbol }' accepts at most { $max } arguments.
shared-calculator-error-too-many-variables-many-symbols = Too many variables. Try defining '{ $variables }' or '{ $lastVariable }'.
shared-calculator-error-too-many-variables-no-symbols = Too many variables, I don't know what to do with this.
shared-calculator-error-too-many-variables-one-symbol = Too many variables. Try defining '{ $variable }'.
shared-calculator-error-transformation-definition-expected-types-1 = Try using { $arg }.
shared-calculator-error-transformation-definition-expected-types-2 = Try using { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-definition-expected-types-use-fewer-1 = Try using just { $arg }.
shared-calculator-error-transformation-definition-expected-types-use-fewer-2 = Try using just { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-definition-type-error-1 = A { $fn } cannot be defined using { $arg }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-2 = A { $fn } cannot be defined using { $arg1 } and { $arg2 }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-many = A '{ $fn }' cannot be defined with these arguments.
shared-calculator-error-transformation-definition-type-error-use-more-1 = A { $fn } cannot be defined using just { $arg }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-use-more-2 = A { $fn } cannot be defined using just { $arg1 } and { $arg2 }. { $expectedTypeMessage }
shared-calculator-error-transformation-type-error-1 = Transformation '{ $fn }' cannot be applied to { $arg }.
shared-calculator-error-transformation-type-error-2 = Transformation '{ $fn }' cannot be applied to { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-type-error-many = Transformation '{ $fn }' cannot be applied to these arguments.
shared-calculator-error-ttest-list-too-short = Lists for '{ $symbol }' must have at least 2 elements.
shared-calculator-error-two-numbers-error = Cannot make a polygon from two numbers.
shared-calculator-error-unary-operator-missing-left = You need something before the '{ $symbol }' symbol.
shared-calculator-error-unary-operator-missing-right = You need something after the '{ $symbol }' symbol.
shared-calculator-error-unexpected-equality = Cannot use an equality here.
shared-calculator-error-unexpected-inequality = Cannot use an inequality here.
shared-calculator-error-unexpected-prime = Sorry, I don't understand this use of prime notation.
shared-calculator-error-unexpected-subscript = Only functions and variables may have subscripts.
shared-calculator-error-unexpected-symbol = Sorry, I don't understand the way that '{ $symbol }' is used here.
shared-calculator-error-unplottable-chained-equality = This calculator cannot plot chained equations.
shared-calculator-error-unplottable-long-inequality-chain = This calculator cannot plot chains of more than 2 inequalities.
shared-calculator-error-unplottable-polar-function = We can't plot θ as a function of r. Try plotting r(θ) instead.
shared-calculator-error-unrecognized-symbol = Sorry, I don't understand the '{ $symbol }' symbol.
shared-calculator-error-update-rule-function-lhs = '{ $symbol }' cannot be updated because it is a function.
shared-calculator-error-update-rule-illegal-lhs = Variable '{ $symbol }' cannot be updated.
shared-calculator-error-update-rule-local-lhs = Variable '{ $symbol }' cannot be updated because it is locally defined.
shared-calculator-error-update-rule-non-identifier-lhs = The left hand side of '{ $arrow }' should be a variable name like '{ $example }'.
shared-calculator-error-update-rule-type-error = Cannot update a variable to { $symbol }.
shared-calculator-error-update-rule-undefined-lhs = Variable '{ $symbol }' must be defined to be updated.
shared-calculator-error-use-r-for-cylindrical-coordinates = Can't combine 'ρ' and 'z'. Try 'r' for cylindrical coordinates.
shared-calculator-error-use-rho-for-spherical-coordinates = Can't combine 'r' and 'φ'. Try 'ρ' (rho) for spherical coordinates.
shared-calculator-error-variable-as-function = Variable '{ $dependency }' can't be used as a function.
shared-calculator-error-variable-invalid-function-name = This calculator can not use '{ $symbol }' as a function name.
shared-calculator-error-variable-length-distribution-list = The length of a list of distributions can't depend on free variable '{ $symbol }'.
shared-calculator-error-variable-length-integral-depends-on-integration-var = Can't integrate a list whose length depends on integration variable '{ $symbol }'.
shared-calculator-error-variable-length-product-body-depends-on-index = Can't take the product of a list whose length depends on product index '{ $symbol }'.
shared-calculator-error-variable-length-sum-body-depends-on-index = Can't sum a list whose length depends on summation index '{ $symbol }'.
shared-calculator-error-variable-length-top-level-list = Can't plot a list whose length depends on free variable '{ $symbol }'.
shared-calculator-error-variable-seed = Random seed cannot depend on free variable '{ $symbol }'.
shared-calculator-error-variable-unsupported = This calculator does not support the '{ $symbol }' variable.
shared-calculator-error-variables-unsupported = This calculator does not support variables like '{ $variable }'.
shared-calculator-error-write-integral = Type '{ $command }' for { $symbol }.
shared-calculator-error-wrong-arity-many-arg = Function '{ $dependency }' requires { $assignment_arity } arguments. { $supplement }
shared-calculator-error-wrong-arity-single-arg-too-few = Function '{ $dependency }' requires an argument. { $supplement }
shared-calculator-error-wrong-arity-single-arg-too-many = Function '{ $dependency }' requires only 1 argument. { $supplement }
shared-calculator-error-wrong-arity-supplement = For example, try typing: { $recommendation }.
shared-calculator-error-wrong-two-arg-arity = Function '{ $symbol }' requires 2 arguments. For example, try typing: { $recommendation }.
shared-calculator-error-zero-arg-reducer = Function '{ $symbol }' requires at least one argument. For example, try typing: { $symbol }(1, 2).
shared-calculator-label-for = for
shared-calculator-label-hide-custom-colors = Hide custom colors from geo toolbar
shared-calculator-label-list-of-count-items-suffix =
    { $count ->
        [0] empty
        [one] 1 item
       *[other] { $count } items
    }
shared-calculator-label-slow-plotting = This expression is currently being plotted and may take a long time
shared-calculator-label-toast-learn-more = Learn more
shared-calculator-label-toast-undo = Undo
shared-calculator-label-value-type-action = an action
shared-calculator-label-value-type-angle = an angle
shared-calculator-label-value-type-any = an unknown object
shared-calculator-label-value-type-arc = an arc
shared-calculator-label-value-type-bool = a true/false value
shared-calculator-label-value-type-circle = a circle
shared-calculator-label-value-type-color = a color
shared-calculator-label-value-type-complex = a complex number
shared-calculator-label-value-type-directed-angle = a directed angle
shared-calculator-label-value-type-distribution = a distribution
shared-calculator-label-value-type-empty-list = an empty list
shared-calculator-label-value-type-error = an error object
shared-calculator-label-value-type-lambda-complex = a parameterized complex number
shared-calculator-label-value-type-lambda-point = a parameterized point
shared-calculator-label-value-type-lambda-point3d = a parameterized 3d point
shared-calculator-label-value-type-line = a line
shared-calculator-label-value-type-list-of-2d-points = a list of 2d points
shared-calculator-label-value-type-list-of-3d-points = a list of 3d points
shared-calculator-label-value-type-list-of-angles = a list of angles
shared-calculator-label-value-type-list-of-any = a list of unknown objects
shared-calculator-label-value-type-list-of-arcs = a list of arcs
shared-calculator-label-value-type-list-of-bool = a list of true/false values
shared-calculator-label-value-type-list-of-circles = a list of circles
shared-calculator-label-value-type-list-of-colors = a list of colors
shared-calculator-label-value-type-list-of-complex = a list of complex numbers
shared-calculator-label-value-type-list-of-directed-angles = a list of directed angles
shared-calculator-label-value-type-list-of-distributions = a list of distributions
shared-calculator-label-value-type-list-of-lambda-complex = a list of parameterized complex numbers
shared-calculator-label-value-type-list-of-lambda-point = a list of parameterized points
shared-calculator-label-value-type-list-of-lambda-point3d = a list of parameterized 3d points
shared-calculator-label-value-type-list-of-lines = a list of lines
shared-calculator-label-value-type-list-of-numbers = a list of numbers
shared-calculator-label-value-type-list-of-points = a list of points
shared-calculator-label-value-type-list-of-polygons = a list of polygons
shared-calculator-label-value-type-list-of-rays = a list of rays
shared-calculator-label-value-type-list-of-restrictions = a list of restrictions
shared-calculator-label-value-type-list-of-segment3d = a list of 3d segments
shared-calculator-label-value-type-list-of-segments = a list of segments
shared-calculator-label-value-type-list-of-sphere3d = a list of 3d sphere
shared-calculator-label-value-type-list-of-tone = a list of tones
shared-calculator-label-value-type-list-of-transformations = a list of transformations
shared-calculator-label-value-type-list-of-triangle3d = a list of 3d triangles
shared-calculator-label-value-type-list-of-vector3d = a list of 3d vectors
shared-calculator-label-value-type-list-of-vectors = a list of vectors
shared-calculator-label-value-type-number = a number
shared-calculator-label-value-type-point = a point
shared-calculator-label-value-type-point2d = a 2d point
shared-calculator-label-value-type-point3d = a 3d point
shared-calculator-label-value-type-polygon = a polygon
shared-calculator-label-value-type-ray = a ray
shared-calculator-label-value-type-restriction = a restriction
shared-calculator-label-value-type-seed = a string
shared-calculator-label-value-type-segment = a segment
shared-calculator-label-value-type-segment3d = a 3d segment
shared-calculator-label-value-type-sphere3d = a 3d sphere
shared-calculator-label-value-type-tone = a tone
shared-calculator-label-value-type-transformation = a transformation
shared-calculator-label-value-type-triangle3d = a 3d triangle
shared-calculator-label-value-type-vector = a vector
shared-calculator-label-value-type-vector3d = a 3d vector
shared-calculator-narration-author-mode = Author Mode
shared-calculator-narration-author-mode-off = Author mode off
shared-calculator-narration-author-mode-on = Author mode on
shared-calculator-narration-braille-mode = Braille Mode
shared-calculator-narration-disable-tool = Disable { $tool } when this condition is true
shared-calculator-narration-display-as-decimal = Displaying as fraction. Press Enter to display as Decimal
shared-calculator-narration-display-as-fraction = Displaying as decimal. Press Enter to display as Fraction
shared-calculator-narration-expression-index = Expression { $index }
shared-calculator-narration-expression-list = Expression List
shared-calculator-narration-hotkey-braille-mode-nemeth = Braille mode Nemeth
shared-calculator-narration-hotkey-braille-mode-off = Braille mode off
shared-calculator-narration-hotkey-braille-mode-ueb = Braille mode UEB
shared-calculator-narration-input-error = input has an error
shared-calculator-narration-item-clickable = { $item } clickable
shared-calculator-narration-item-selected = { $item } selected
shared-calculator-narration-item-unknown = Unknown
shared-calculator-narration-item-unselected = { $item } unselected
shared-calculator-narration-keypad = keypad
shared-calculator-narration-keypad-controlbar = Control Bar
shared-calculator-narration-keypad-key-10-n = Times ten to the power of
shared-calculator-narration-keypad-key-abs = Absolute Value
shared-calculator-narration-keypad-key-action-to = Set Value To
shared-calculator-narration-keypad-key-action-with = Substitute With
shared-calculator-narration-keypad-key-alpha = Alpha
shared-calculator-narration-keypad-key-angle = Angle
shared-calculator-narration-keypad-key-angles = Angles
shared-calculator-narration-keypad-key-ans = Answer
shared-calculator-narration-keypad-key-arc = Arc
shared-calculator-narration-keypad-key-arccos = Inverse Cosine
shared-calculator-narration-keypad-key-arccot = Inverse Cotangent
shared-calculator-narration-keypad-key-arccsc = Inverse Cosecant
shared-calculator-narration-keypad-key-arcsec = Inverse Secant
shared-calculator-narration-keypad-key-arcsin = Inverse Sine
shared-calculator-narration-keypad-key-arctan = Inverse Tangent
shared-calculator-narration-keypad-key-area = Area
shared-calculator-narration-keypad-key-arg = Argument
shared-calculator-narration-keypad-key-backspace = Backspace
shared-calculator-narration-keypad-key-beta = Beta
shared-calculator-narration-keypad-key-binomialdist = Binomial Distribution
shared-calculator-narration-keypad-key-boxplot = Box Plot
shared-calculator-narration-keypad-key-ceil = Ceiling
shared-calculator-narration-keypad-key-center = Center
shared-calculator-narration-keypad-key-circle = Circle
shared-calculator-narration-keypad-key-conj = Complex conjugate
shared-calculator-narration-keypad-key-corr = Correlation
shared-calculator-narration-keypad-key-cos = Cosine
shared-calculator-narration-keypad-key-cosh = Hyperbolic Cosine
shared-calculator-narration-keypad-key-cot = Cotangent
shared-calculator-narration-keypad-key-coterminal = Coterminal
shared-calculator-narration-keypad-key-coth = Hyperbolic Cotangent
shared-calculator-narration-keypad-key-cov = Co Variance
shared-calculator-narration-keypad-key-covp = Population Co Variance
shared-calculator-narration-keypad-key-csc = Cosecant
shared-calculator-narration-keypad-key-csch = Hyperbolic Cosecant
shared-calculator-narration-keypad-key-cubed = Cubed
shared-calculator-narration-keypad-key-decimal = Decimal
shared-calculator-narration-keypad-key-dilate = Dilate
shared-calculator-narration-keypad-key-directed-angle = Directed Angle
shared-calculator-narration-keypad-key-directed-angles = Directed Angles
shared-calculator-narration-keypad-key-distance = Distance
shared-calculator-narration-keypad-key-divide = Divide
shared-calculator-narration-keypad-key-dotplot = Dot Plot
shared-calculator-narration-keypad-key-enter = Enter
shared-calculator-narration-keypad-key-erf = Error Function
shared-calculator-narration-keypad-key-exp = Exponent
shared-calculator-narration-keypad-key-factorial = Factorial
shared-calculator-narration-keypad-key-floor = Floor
shared-calculator-narration-keypad-key-fraction = A over B
shared-calculator-narration-keypad-key-glider = Glider
shared-calculator-narration-keypad-key-histogram = Histogram
shared-calculator-narration-keypad-key-imag = Imaginary
shared-calculator-narration-keypad-key-int = Integral
shared-calculator-narration-keypad-key-intersection = Intersection
shared-calculator-narration-keypad-key-inversecdf = Inverse CDF function
shared-calculator-narration-keypad-key-ittest = Independent T Test
shared-calculator-narration-keypad-key-left-arrow = Left Arrow
shared-calculator-narration-keypad-key-left-bracket = Left Bracket
shared-calculator-narration-keypad-key-left-paren = Left Parenthesis
shared-calculator-narration-keypad-key-line = Line
shared-calculator-narration-keypad-key-ln = Natural Log
shared-calculator-narration-keypad-key-log = Log
shared-calculator-narration-keypad-key-loga = Log A
shared-calculator-narration-keypad-key-mean = Mean
shared-calculator-narration-keypad-key-median = Median
shared-calculator-narration-keypad-key-midpoint = Midpoint
shared-calculator-narration-keypad-key-minus = Minus
shared-calculator-narration-keypad-key-normaldist = Normal Distribution
shared-calculator-narration-keypad-key-nthroot = Nth Root
shared-calculator-narration-keypad-key-parallel = Parallel
shared-calculator-narration-keypad-key-pdf = Probability Density Function
shared-calculator-narration-keypad-key-percent-of = Percent Of
shared-calculator-narration-keypad-key-perimeter = Perimeter
shared-calculator-narration-keypad-key-perpendicular = Perpendicular
shared-calculator-narration-keypad-key-phi = Phi
shared-calculator-narration-keypad-key-pi = Pi
shared-calculator-narration-keypad-key-plus = Plus
shared-calculator-narration-keypad-key-poissondist = Poisson Distribution
shared-calculator-narration-keypad-key-polygon = Polygon
shared-calculator-narration-keypad-key-prime = Function derivative
shared-calculator-narration-keypad-key-product = Product
shared-calculator-narration-keypad-key-quantile = Quantile
shared-calculator-narration-keypad-key-quartile = Quartile
shared-calculator-narration-keypad-key-radius = Radius
shared-calculator-narration-keypad-key-random = Random Number
shared-calculator-narration-keypad-key-ray = Ray
shared-calculator-narration-keypad-key-real = Real
shared-calculator-narration-keypad-key-reciprocal = Reciprocal
shared-calculator-narration-keypad-key-reflect = Reflect
shared-calculator-narration-keypad-key-rho = Rho
shared-calculator-narration-keypad-key-right-arrow = Right Arrow
shared-calculator-narration-keypad-key-right-bracket = Right Bracket
shared-calculator-narration-keypad-key-right-paren = Right Parenthesis
shared-calculator-narration-keypad-key-rotate = Rotate
shared-calculator-narration-keypad-key-round = Round
shared-calculator-narration-keypad-key-sec = Secant
shared-calculator-narration-keypad-key-segment = Segment
shared-calculator-narration-keypad-key-segments = Segments
shared-calculator-narration-keypad-key-shift = Shift
shared-calculator-narration-keypad-key-sin = Sine
shared-calculator-narration-keypad-key-sinh = Hyperbolic Sine
shared-calculator-narration-keypad-key-spearman = Spearman Rank Correlation
shared-calculator-narration-keypad-key-sphere = Sphere
shared-calculator-narration-keypad-key-sqrt = Square Root
shared-calculator-narration-keypad-key-squared = Squared
shared-calculator-narration-keypad-key-stats = Summary statistics
shared-calculator-narration-keypad-key-stdev = Standard Deviation
shared-calculator-narration-keypad-key-stdevp = Standard Deviation of Population
shared-calculator-narration-keypad-key-subscript = Subscript
shared-calculator-narration-keypad-key-sum = Sum
shared-calculator-narration-keypad-key-superscript = Superscript
shared-calculator-narration-keypad-key-supplement = Supplement
shared-calculator-narration-keypad-key-tan = Tangent
shared-calculator-narration-keypad-key-tanh = Hyperbolic Tangent
shared-calculator-narration-keypad-key-tau = Tau
shared-calculator-narration-keypad-key-tdist = Student-t Distribution
shared-calculator-narration-keypad-key-theta = Theta
shared-calculator-narration-keypad-key-times = Times
shared-calculator-narration-keypad-key-toggle-audio-trace = Toggle Audio Trace
shared-calculator-narration-keypad-key-toggle-letters = Toggle Letters
shared-calculator-narration-keypad-key-toggle-numbers = Toggle Numbers
shared-calculator-narration-keypad-key-tone = Tone
shared-calculator-narration-keypad-key-translate = Translate
shared-calculator-narration-keypad-key-triangle = Triangle
shared-calculator-narration-keypad-key-tscore = T Score
shared-calculator-narration-keypad-key-ttest = T Test
shared-calculator-narration-keypad-key-uniformdist = Uniform Distribution
shared-calculator-narration-keypad-key-vector = Vector
shared-calculator-narration-keypad-key-vertices = Vertices
shared-calculator-narration-keypad-key-ythroot = Yth Root
shared-calculator-narration-keypad-plus-minus = Plus-Minus
shared-calculator-narration-math-input-error-message = expression has error
shared-calculator-narration-settings-display-size = Display Size
shared-calculator-narration-settings-display-size-default = Display size: default
shared-calculator-narration-settings-display-size-large = Display size: large
shared-calculator-narration-show-as-decimal = Show as Decimal
shared-calculator-narration-show-as-fraction = Show as Fraction
shared-calculator-narration-six-key-mode-off = Six Key Braille Input off
shared-calculator-narration-six-key-mode-on = Six Key Braille Input on
shared-calculator-text-complex-enabled-note = Hint: try writing { $eq1 } or { $eq2 }.
shared-calculator-text-complex-radian-mode = Complex mode uses radians
shared-calculator-text-customize-toolbar = Customize the Toolbar
shared-calculator-text-search-results =
    { $count ->
        [0] No results.
        [one] 1 result.
       *[other] { $count } results.
    }
shared-label-to = to
basic-calculator-button-controlbar-abc = abc
basic-calculator-button-controlbar-clear = clear
basic-calculator-button-controlbar-clear-all = clear all
basic-calculator-button-controlbar-func = func
basic-calculator-button-controlbar-main = main
basic-calculator-button-turn-braille-mode-off = Turn { $mode } off
basic-calculator-error-fractions-unavailable = Fractions are not available in the current calculator.
basic-calculator-error-parentheses-unavailable = Parentheses are not available in this calculator.
basic-calculator-heading-braille-table-type-this = Type this
basic-calculator-heading-braille-table-typeset = Typeset
basic-calculator-label-answer-hint = Your answers show up on this side.
basic-calculator-label-controlbar-deg = deg
basic-calculator-label-controlbar-rad = rad
basic-calculator-label-convert-to-decimal = Convert to decimal.
basic-calculator-label-convert-to-fraction = Convert to fraction.
basic-calculator-label-reverse-contrast = Reverse Contrast
basic-calculator-link-download-braille-equations = Download Braille Equations
basic-calculator-link-view-braille-examples = View more examples
basic-calculator-narration-calc-description-fourfunction = Desmos Four-Function Calculator
basic-calculator-narration-calc-description-scientific = Desmos Scientific Calculator
basic-calculator-narration-controlbar-abc = A B C
basic-calculator-narration-controlbar-backspace = backspace
basic-calculator-narration-controlbar-clear = clear
basic-calculator-narration-controlbar-clear-all = clear all
basic-calculator-narration-controlbar-degrees = Degrees
basic-calculator-narration-controlbar-functions = Functions
basic-calculator-narration-controlbar-main = main
basic-calculator-narration-controlbar-radians = Radians
basic-calculator-narration-controlbar-redo = Redo
basic-calculator-narration-controlbar-settings = settings
basic-calculator-narration-controlbar-undo = Undo
basic-calculator-narration-convert-to-decimal = Displaying as fraction. Press Enter to display as Decimal
basic-calculator-narration-convert-to-fraction = Displaying as decimal. Press Enter to display as Fraction
basic-calculator-narration-hotkey-six-key-input-off = Six Key Braille Input off
basic-calculator-narration-hotkey-six-key-input-on = Six Key Braille Input on
basic-calculator-text-braille-mode-is-on = { $mode } is on!
basic-calculator-text-how-to-type-braille = Use a Refreshable Braille display, or just type Braille with a keyboard.
geometry-label-construct-instruction = Click down here to construct
geometry-label-pick-tool-instruction = Pick a tool to get started
graphing-calculator-button-add-table-regression = Add Regression
graphing-calculator-button-audio-trace-hear-graph = Hear Graph
graphing-calculator-button-audio-trace-stop-graph = Stop Graph
graphing-calculator-button-change-image = Change Image
graphing-calculator-button-clear-graph = Delete All
graphing-calculator-button-copy-poi-coordinates = Export point to expression list
graphing-calculator-button-copy-table-regression-model-to-expression-list = Export as custom regression
graphing-calculator-button-delete-table-regression = Delete regression
graphing-calculator-button-done = Done
graphing-calculator-button-draggable = Draggable
graphing-calculator-button-draggable-points = Draggable Points
graphing-calculator-button-edit-graph-on-desmos-logo = edit graph on
graphing-calculator-button-editable-math = Editable Math
graphing-calculator-button-editable-text = Editable Text
graphing-calculator-button-find-cdf = Find Cumulative Probability (CDF)
graphing-calculator-button-funcs = funcs
graphing-calculator-button-functions = functions
graphing-calculator-button-functions-menu-custom-colors = Custom Colors
graphing-calculator-button-functions-menu-number-theory = Number Theory
graphing-calculator-button-geometry-label-points = Label Points
graphing-calculator-button-hide-folder-from-students-2 = Hide this folder from students.
graphing-calculator-button-in-front-of-everything = In front of everything
graphing-calculator-button-keypad-audio-trace-off = Audio Trace Off
graphing-calculator-button-keypad-describe-axes = Describe Axes
graphing-calculator-button-keypad-describe-curve = Describe Curve
graphing-calculator-button-keypad-describe-curve-short = Curve
graphing-calculator-button-keypad-describe-point = Describe Point
graphing-calculator-button-keypad-describe-point-short = Point
graphing-calculator-button-label = Label
graphing-calculator-button-label-editable = Editable
graphing-calculator-button-label-show-on-hover = Show on hover
graphing-calculator-button-label-text-outline = Text outline
graphing-calculator-button-load-image-retry = Retry.
graphing-calculator-button-move-to-expression-list-action = Move
graphing-calculator-button-place-image-behind-graphs = Place behind graphs
graphing-calculator-button-regression-log-mode = Log Mode
graphing-calculator-button-regression-plot-residuals = plot
graphing-calculator-button-replace = Replace
graphing-calculator-button-reset-graph = Reset
graphing-calculator-button-settings-degrees = Degrees
graphing-calculator-button-settings-radians = Radians
graphing-calculator-button-settings-zoom-square = Zoom Square
graphing-calculator-button-show-all-table-rows = Show all
graphing-calculator-button-slider-add-all-variables = all
graphing-calculator-button-visual-parameters-binned = Binned
graphing-calculator-button-visual-parameters-center = Center
graphing-calculator-button-visual-parameters-count = Count
graphing-calculator-button-visual-parameters-density = Density
graphing-calculator-button-visual-parameters-exact = Exact
graphing-calculator-button-visual-parameters-exclude-outliers = Exclude Outliers
graphing-calculator-button-visual-parameters-left = Left
graphing-calculator-button-visual-parameters-relative = Relative
graphing-calculator-error-equation-contains-unresolved-details = This plot contains fine detail that has not been fully resolved.
graphing-calculator-error-expression-replacement = Replacement must be a valid function or variable name.
graphing-calculator-error-expression-search = Can only rename a valid function or variable name.
graphing-calculator-error-failed-to-load-image = Failed to load image.
graphing-calculator-error-image-invalid-angle = Invalid angle. Try using any number.
graphing-calculator-error-image-invalid-center = Invalid center. Try, for example, (0,0).
graphing-calculator-error-image-invalid-file = The file "{ $file }" is not an image
graphing-calculator-error-image-invalid-height = Invalid height. Try using any number.
graphing-calculator-error-image-invalid-opacity = Invalid opacity. Try using any number.
graphing-calculator-error-image-invalid-width = Invalid width. Try using any number.
graphing-calculator-error-legacy-random-seed-behavior = This graph uses legacy randomization behavior.
graphing-calculator-error-log-axes-image = Cannot plot images on a log scale.
graphing-calculator-error-nan-blame-complex-coercion = Plotted values are non-real at all input points. Try using absolute value to convert complex numbers to real.
graphing-calculator-error-reached-maximum-recursion-depth = Reached maximum recursion depth while plotting this expression.
graphing-calculator-error-table-regression-unexportable-reserved-variable-single = Column { $variable } can't be referenced outside of the table. To create a standalone regression, first try renaming that column.
graphing-calculator-error-table-regression-unexportable-reserved-variables-many = These columns can't be referenced outside of the table. To export the regression model, first try renaming the columns.
graphing-calculator-error-tone-frequency-out-of-range = Tones can only play for frequencies between { $min }Hz and { $max }Hz.
graphing-calculator-heading-advanced = Advanced
graphing-calculator-heading-audio-trace-describe = Describe
graphing-calculator-heading-audio-trace-navigation = Navigation
graphing-calculator-heading-audio-trace-screen-reader = Screen Reader
graphing-calculator-heading-calculus = Calculus
graphing-calculator-heading-clickable = Clickable
graphing-calculator-heading-dist-tab-distributions = Distributions
graphing-calculator-heading-dist-tab-visualizations = Visualizations
graphing-calculator-heading-drag = Drag
graphing-calculator-heading-fill = Fill
graphing-calculator-heading-functions-menu-advanced = Advanced
graphing-calculator-heading-functions-menu-complex = Complex
graphing-calculator-heading-functions-menu-polar = Polar Coordinates
graphing-calculator-heading-functions-menu-sound = Sound
graphing-calculator-heading-geometry = Geometry
graphing-calculator-heading-geometry-measurements = Properties & Measurements
graphing-calculator-heading-geometry-tools = Geometry Tools
graphing-calculator-heading-geometry-transformations = Transformations
graphing-calculator-heading-hyperbolic-trig = Hyperbolic Trig Functions
graphing-calculator-heading-image-opacity = Opacity
graphing-calculator-heading-inverse-trig = Inverse Trig Functions
graphing-calculator-heading-keypad-audio-trace-point-of-interest = <1>Point</1><2>of Interest</2>
graphing-calculator-heading-label = Label
graphing-calculator-heading-label-orientation = Orientation
graphing-calculator-heading-lines = Lines
graphing-calculator-heading-lists = List Operations
graphing-calculator-heading-points = Points
graphing-calculator-heading-regression-equation = Equation
graphing-calculator-heading-regression-parameters = Regression Parameters
graphing-calculator-heading-regression-residuals = Residuals
graphing-calculator-heading-regression-statistics = Statistics
graphing-calculator-heading-slider-animation-mode = Animation Mode
graphing-calculator-heading-slider-speed = Speed
graphing-calculator-heading-stat-tests = Statistical Tests
graphing-calculator-heading-stats = Statistics
graphing-calculator-heading-style = Style
graphing-calculator-heading-surfaces = Surfaces
graphing-calculator-heading-table-regression-model-structure = Regression model structure
graphing-calculator-heading-trig = Trig Functions
graphing-calculator-heading-visual-parameters-bar-heights = Bar Heights
graphing-calculator-heading-visual-parameters-bin-alignment = Bin Alignment
graphing-calculator-heading-visual-parameters-display-properties = Display Properties
graphing-calculator-heading-visual-parameters-x-values = X Values
graphing-calculator-label-adaptive-peel-warning = This graph has many transparent layers, which may result in degraded performance or visual innacuracies.
graphing-calculator-label-add-base-case = add base case:
graphing-calculator-label-add-depressed-image-tooltip = Add Depressed Image
graphing-calculator-label-add-hovered-image-tooltip = Add Hovered Image
graphing-calculator-label-add-item-tooltip = Add Item
graphing-calculator-label-add-slider = add slider:
graphing-calculator-label-angle-tooltip = Angle
graphing-calculator-label-animation-properties-tooltip = Animation Properties
graphing-calculator-label-audio-trace-curve = Curve
graphing-calculator-label-audio-trace-need-screen-reader = Your Screen Reader needs to be on to hear these.
graphing-calculator-label-audio-trace-point = Point
graphing-calculator-label-audio-trace-speed = Speed
graphing-calculator-label-audio-trace-volume = Volume
graphing-calculator-label-axes = Axes
graphing-calculator-label-cdf-maximum = Max:
graphing-calculator-label-cdf-minimum = Min:
graphing-calculator-label-change-depressed-image-tooltip = Change Depressed Image
graphing-calculator-label-change-hovered-image-tooltip = Change Hovered Image
graphing-calculator-label-convert-to-table-tooltip = Convert to Table
graphing-calculator-label-create-table = Create Table
graphing-calculator-label-depressed = Depressed
graphing-calculator-label-disable-graph-interactions = Disable Graph Interactions
graphing-calculator-label-disable-zoom = Disable zooming
graphing-calculator-label-display-properties = Local Display Preferences
graphing-calculator-label-drop-image-here = Drop Image Here
graphing-calculator-label-duplicate-expression-tooltip = Duplicate
graphing-calculator-label-edit-graph-bounds = Graph Bounds
graphing-calculator-label-edit-list-tooltip = Edit List
graphing-calculator-label-evaluation-list = { $count } element list
graphing-calculator-label-expression-delete-tooltip = Delete
graphing-calculator-label-expression-lowercase = expression
graphing-calculator-label-extend-to-3d = Extend to 3D
graphing-calculator-label-folder-lowercase = folder
graphing-calculator-label-geometry-dilation-by-point = Dilate at <parent1/> by <parent2/>
graphing-calculator-label-geometry-move-to-folder-placeholder = Folder name
graphing-calculator-label-geometry-reflection-over-point = Reflect over <parent1/>
graphing-calculator-label-geometry-rotation-around-point-by-angle = Rotate around <parent1/> by <parent2/>
graphing-calculator-label-geometry-tools = Geometry Tools
graphing-calculator-label-geometry-tools-dropdown-menu-angle = Angle tools
graphing-calculator-label-geometry-tools-dropdown-menu-circle = Circle tools
graphing-calculator-label-geometry-tools-dropdown-menu-line = Line tools
graphing-calculator-label-geometry-tools-dropdown-menu-point = Point tools
graphing-calculator-label-geometry-tools-dropdown-menu-polygon = Polygon tools
graphing-calculator-label-geometry-tools-dropdown-menu-selection = Selection tools
graphing-calculator-label-geometry-tools-dropdown-menu-transformation = Transformation tools
graphing-calculator-label-geometry-tools-open-dropdown-menu-transformation = Open { $item } menu
graphing-calculator-label-geometry-translation-by-two-points = Translate from <parent1/> to <parent2/>
graphing-calculator-label-geometry-translation-by-vector = Translate by <parent1/>
graphing-calculator-label-hide-expression-list-tooltip = Hide Expression List
graphing-calculator-label-hide-keypad = Hide Keypad
graphing-calculator-label-hovered = Hovered
graphing-calculator-label-image-angle = Angle:
graphing-calculator-label-image-center = Center:
graphing-calculator-label-image-height = Height:
graphing-calculator-label-image-lowercase = image
graphing-calculator-label-image-opacity = Opacity:
graphing-calculator-label-image-width = Width:
graphing-calculator-label-label-size-tooltip = Label Scale Factor
graphing-calculator-label-line-thickness-3d-tooltip = Line Thickness
graphing-calculator-label-line-thickness-tooltip = Line Thickness (px)
graphing-calculator-label-list-index = Use <1>index</1> to reference the clicked index in the list.
graphing-calculator-label-lock-expression-tooltip = Prevent Editing
graphing-calculator-label-more-viewport-options = More Options
graphing-calculator-label-note-lowercase = note
graphing-calculator-label-opacity-tooltip = Opacity (0 to 1)
graphing-calculator-label-open-graph-tooltip = Open Graph
graphing-calculator-label-open-graph-with-shortcut-tooltip = Open Graph (CTRL+O)
graphing-calculator-label-poi-unknown-coordinates = unknown coordinates
graphing-calculator-label-point-size-3d-tooltip = Point Size
graphing-calculator-label-point-size-tooltip = Point Size (px)
graphing-calculator-label-powered-by = powered by
graphing-calculator-label-randomize-tooltip = Randomize
graphing-calculator-label-recent-transformations = Recent Transformations
graphing-calculator-label-recenter = Center Origin
graphing-calculator-label-redo-tooltip = Redo
graphing-calculator-label-redo-with-shortcut-tooltip = Redo (CTRL+Y)
graphing-calculator-label-reference-count =
    { $count ->
        [one] (1 reference)
       *[other] ({ $count } references)
    }
graphing-calculator-label-reference-count-in-folder =
    { $count ->
        [one] (1 reference in folder)
       *[other] ({ $count } references in folder)
    }
graphing-calculator-label-regression-log-mode-help-tooltip = Log mode help
graphing-calculator-label-regression-parameters-not-exact = Parameters might not be exact. Click to learn more.
graphing-calculator-label-regression-what-is-rmse-tooltip = What is RMSE? Click to learn more.
graphing-calculator-label-regression-why-is-negative-tooltip = Why is this negative? Click to learn more.
graphing-calculator-label-remove-depressed-image = Remove depressed image
graphing-calculator-label-remove-hovered-image = Remove hovered image
graphing-calculator-label-rename = rename
graphing-calculator-label-resolution-tooltip = 3D Grid Sample Resolution
graphing-calculator-label-search-expressions = Search this graph
graphing-calculator-label-settings-3d-perspective-distortion-ratio = Perspective Distortion Ratio
graphing-calculator-label-settings-3d-perspective-max = Most distortion (Perspective view)
graphing-calculator-label-settings-3d-perspective-min = No distortion (Orthographic view)
graphing-calculator-label-settings-all-axes = All axes:
graphing-calculator-label-settings-arrows = Arrows
graphing-calculator-label-settings-axis-labels-3d = Labels
graphing-calculator-label-settings-axis-numbers = Axis Numbers
graphing-calculator-label-settings-complex-mode = Complex Mode
graphing-calculator-label-settings-domain-plane = XY plane
graphing-calculator-label-settings-grid = Grid
graphing-calculator-label-settings-hidden-objects = Reveal { $count } hidden objects
graphing-calculator-label-settings-lock-viewport = Lock Viewport
graphing-calculator-label-settings-minor-gridlines = Minor Gridlines
graphing-calculator-label-settings-numbers-3d = Numbers
graphing-calculator-label-settings-one-quadrant = One Quadrant
graphing-calculator-label-settings-reverse-contrast = Reverse contrast
graphing-calculator-label-settings-six-key-braille = Six Key Braille Input
graphing-calculator-label-settings-step = Step:
graphing-calculator-label-settings-translucent-surfaces = Translucent surfaces
graphing-calculator-label-settings-x-axis = X-Axis
graphing-calculator-label-settings-y-axis = Y-Axis
graphing-calculator-label-show-keypad = Show Keypad
graphing-calculator-label-slider-disabled-while-ticker-playing = Sliders are disabled while the ticker is running.
graphing-calculator-label-slider-step = Step:
graphing-calculator-label-stats-first-quartile = Q1
graphing-calculator-label-stats-maximum = Max
graphing-calculator-label-stats-median = Median
graphing-calculator-label-stats-minimum = Min
graphing-calculator-label-stats-third-quartile = Q3
graphing-calculator-label-table-lowercase = table
graphing-calculator-label-table-regression-type-cubic = Cubic Regression
graphing-calculator-label-table-regression-type-exponential = Exponential Regression
graphing-calculator-label-table-regression-type-linear = Linear Regression
graphing-calculator-label-table-regression-type-logarithmic = Logarithmic Regression
graphing-calculator-label-table-regression-type-logistic = Logistic Regression
graphing-calculator-label-table-regression-type-power = Power Regression
graphing-calculator-label-table-regression-type-quadratic = Quadratic Regression
graphing-calculator-label-table-regression-type-quartic = Quartic Regression
graphing-calculator-label-table-regression-type-sinusoidal = Sinusoidal Regression
graphing-calculator-label-ticker-close = cancel
graphing-calculator-label-ticker-help-tooltip = On slow computers, this might run slower. Use local variable "dt" to capture the actual update speed.
graphing-calculator-label-ticker-lowercase = ticker
graphing-calculator-label-ticker-min-step = Min Step Time
graphing-calculator-label-ticker-pause = pause
graphing-calculator-label-ticker-play = play
graphing-calculator-label-tooltip-geometry-settings = Geometry Settings
graphing-calculator-label-tooltip-graph-settings = Graph Settings
graphing-calculator-label-tooltip-open-graph = Open Graph
graphing-calculator-label-tooltip-reset = Reset
graphing-calculator-label-tooltip-show-list = Show List
graphing-calculator-label-tooltip-viewport-default = Default Viewport
graphing-calculator-label-tooltip-zoom-default-orientation = Default Orientation
graphing-calculator-label-tooltip-zoom-in = Zoom In
graphing-calculator-label-tooltip-zoom-out = Zoom Out
graphing-calculator-label-tooltip-zoom-xy-orientation = XY Orientation
graphing-calculator-label-undo-tooltip = Undo
graphing-calculator-label-undo-with-shortcut-tooltip = Undo (CTRL+Z)
graphing-calculator-label-unlock-expression-tooltip = Allow Editing
graphing-calculator-label-update-on-click = On click:
graphing-calculator-label-update-to-new-behavior = Update to new behavior
graphing-calculator-link-edit-on-desmos = edit graph on
graphing-calculator-link-learn-more = Learn more.
graphing-calculator-link-view-braille-examples = View examples
graphing-calculator-narration-3d-graphpaper-label = three-dimensional graph paper
graphing-calculator-narration-3d-orientation-options-label = Orientation
graphing-calculator-narration-3d-rotate-down = Tilt forward.
graphing-calculator-narration-3d-rotate-left = Rotate left.
graphing-calculator-narration-3d-rotate-right = Rotate right.
graphing-calculator-narration-3d-rotate-up = Tilt backward.
graphing-calculator-narration-3d-rotation-speed = Speed { $speed } ° per second
graphing-calculator-narration-3d-rotation-stopped = Stopped.
graphing-calculator-narration-add-base-case-prompt =
    { $count ->
        [one] Add 1 base case
       *[other] Add { $count } base cases
    }
graphing-calculator-narration-add-expression = Add expression
graphing-calculator-narration-add-folder = Add folder
graphing-calculator-narration-add-image = Add image
graphing-calculator-narration-add-item-menu = Add Item Menu
graphing-calculator-narration-add-note = Add note
graphing-calculator-narration-add-slider-prompt = Add slider for { $vars }
graphing-calculator-narration-add-table = Add table
graphing-calculator-narration-add-ticker = Add Ticker
graphing-calculator-narration-all-folders-collapsed = all folders collapsed
graphing-calculator-narration-all-folders-expanded = all folders expanded
graphing-calculator-narration-audio-instructions-enter-audio-trace-mac = Press OPTION+T for audio trace.
graphing-calculator-narration-audio-instructions-enter-audio-trace-windows = Press ALT+T for audio trace.
graphing-calculator-narration-audio-trace-branch-not-found = Branch { $branch } does not exist.
graphing-calculator-narration-audio-trace-cannot-change-slider-value = Unable to adjust slider
graphing-calculator-narration-audio-trace-description-branch-count = Branches: { $branches }.
graphing-calculator-narration-audio-trace-description-color = Color: { $color }.
graphing-calculator-narration-audio-trace-description-multiple-extrema = { $count } extrema.
graphing-calculator-narration-audio-trace-description-multiple-intercepts = { $count } intercepts.
graphing-calculator-narration-audio-trace-description-multiple-intersections = { $count } intersections.
graphing-calculator-narration-audio-trace-description-multiple-labels = { $count } point labels.
graphing-calculator-narration-audio-trace-description-multiple-roots = { $count } zero crossings.
graphing-calculator-narration-audio-trace-description-no-curve-selected = No curve selected.
graphing-calculator-narration-audio-trace-description-one-extremum = 1 extremum.
graphing-calculator-narration-audio-trace-description-one-intercept = 1 intercept.
graphing-calculator-narration-audio-trace-description-one-intersection = 1 intersection.
graphing-calculator-narration-audio-trace-description-one-label = 1 point label.
graphing-calculator-narration-audio-trace-description-one-root = 1 zero crossing.
graphing-calculator-narration-audio-trace-description-shading-above = Shading above.
graphing-calculator-narration-audio-trace-description-shading-below = Shading below.
graphing-calculator-narration-audio-trace-description-shading-in-regions = Shading in regions.
graphing-calculator-narration-audio-trace-description-shading-left = Shading on the left.
graphing-calculator-narration-audio-trace-description-shading-right = Shading on the right.
graphing-calculator-narration-audio-trace-description-visible-grid = Grid lines are visible.
graphing-calculator-narration-audio-trace-description-visible-x-axis = X axis visible.
graphing-calculator-narration-audio-trace-description-visible-x-axis-and-label = X axis visible and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-x-axis-range = X axis visible from { $xmin } to { $xmax }.
graphing-calculator-narration-audio-trace-description-visible-x-axis-range-and-label = X axis visible from { $xmin } to { $xmax } and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-xyz-axis-range = X Y and Z axes visible from { $xmin } to { $xmax }.
graphing-calculator-narration-audio-trace-description-visible-y-axis = Y axis visible.
graphing-calculator-narration-audio-trace-description-visible-y-axis-and-label = Y axis visible and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-y-axis-range = Y axis visible from { $ymin } to { $ymax }.
graphing-calculator-narration-audio-trace-description-visible-y-axis-range-and-label = Y axis visible from { $ymin } to { $ymax } and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-z-axis = Z axis visible.
graphing-calculator-narration-audio-trace-description-visible-z-axis-and-label = Z axis visible and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-z-axis-range = Z axis visible from { $zmin } to { $zmax }.
graphing-calculator-narration-audio-trace-description-visible-z-axis-range-and-label = Z axis visible from { $zmin } to { $zmax } and is labeled { $label }.
graphing-calculator-narration-audio-trace-expression-with-column = Expression { $index } column { $column }
graphing-calculator-narration-audio-trace-first-point = First point
graphing-calculator-narration-audio-trace-first-slider = First slider.
graphing-calculator-narration-audio-trace-instructions-disable-mac = To disable audio trace, press OPTION+T.
graphing-calculator-narration-audio-trace-instructions-disable-windows = To disable audio trace, press ALT+T.
graphing-calculator-narration-audio-trace-instructions-expression-navigation-mac = To move between expressions, press COMMAND+Up-Arrow or COMMAND+Down-Arrow.
graphing-calculator-narration-audio-trace-instructions-expression-navigation-windows = To move between expressions, press ALT+Up-Arrow or ALT+Down-Arrow.
graphing-calculator-narration-audio-trace-instructions-hear-graph = To hear the graph, press H.
graphing-calculator-narration-audio-trace-instructions-use-arrow-keys = Use Arrow keys to navigate.
graphing-calculator-narration-audio-trace-last-point = Last point
graphing-calculator-narration-audio-trace-last-slider = Last slider.
graphing-calculator-narration-audio-trace-multiple-sliders-paused = { $sliders } animating sliders were paused.
graphing-calculator-narration-audio-trace-no-more-pois = No more points of interest
graphing-calculator-narration-audio-trace-no-sliders-paused = No animating sliders were paused.
graphing-calculator-narration-audio-trace-one-slider-paused = One animating slider was paused.
graphing-calculator-narration-audio-trace-playback-speed = Graph playback speed { $speed }
graphing-calculator-narration-audio-trace-poi-count = Points of interest, { $x }.
graphing-calculator-narration-audio-trace-point-type-definition = Definition
graphing-calculator-narration-audio-trace-point-type-extremum = Extremum
graphing-calculator-narration-audio-trace-point-type-intercept = Intercept
graphing-calculator-narration-audio-trace-point-type-intersection = Intersection
graphing-calculator-narration-audio-trace-point-type-intersection-with-curves = Intersection with { $curves }
graphing-calculator-narration-audio-trace-point-type-label = Label
graphing-calculator-narration-audio-trace-point-type-not-a-poi = Not a P O I
graphing-calculator-narration-audio-trace-point-type-root = Zero
graphing-calculator-narration-audio-trace-point-type-trace = Trace
graphing-calculator-narration-audio-trace-property-branch-number = Branch { $branch }.
graphing-calculator-narration-audio-trace-property-type-before-coordinates = { $type } at
graphing-calculator-narration-audio-trace-property-x = X: { $x }.
graphing-calculator-narration-audio-trace-property-y = Y: { $y }.
graphing-calculator-narration-audio-trace-slider-value-unknown = Unable to determine slider value
graphing-calculator-narration-audio-trace-sound-effects-disabled = Sound effects have been disabled.
graphing-calculator-narration-audio-trace-traceable-curves =
    { $sketchCount ->
        [one] 1 audio traceable curve.
       *[other] { $sketchCount } audio traceable curves.
    }
graphing-calculator-narration-audio-trace-tracing-different-expression = Tracing { $expression }.
graphing-calculator-narration-audio-trace-unable-to-play = Unable to play audio.
graphing-calculator-narration-audio-trace-unable-to-trace-this-expression = Unable to audio trace this expression.
graphing-calculator-narration-audio-trace-unsupported-expression = { $expression } cannot be audio traced.
graphing-calculator-narration-audio-trace-volume = Volume { $volume } percent
graphing-calculator-narration-cdf-maximum = Max
graphing-calculator-narration-cdf-minimum = Min
graphing-calculator-narration-click-action = Click Action
graphing-calculator-narration-clickable-image-options = Clickable Image Options
graphing-calculator-narration-collapse = Collapse
graphing-calculator-narration-collapse-folder-index = Collapse Folder { $index }
graphing-calculator-narration-collapse-folder-title = Collapse { $folder } folder
graphing-calculator-narration-color-picker-custom-colors-label = Custom
graphing-calculator-narration-color-picker-label = Color Picker
graphing-calculator-narration-color-picker-standard-colors-label = Standard
graphing-calculator-narration-color-unknown = unknown
graphing-calculator-narration-computed-cell-role-description = computed cell
graphing-calculator-narration-configure-toolbar = Geometry Toolbar Configuration
graphing-calculator-narration-create-table = Create Table
graphing-calculator-narration-create-table-expression = Create Table from Expression { $index }
graphing-calculator-narration-create-table-secret-expression = Create Table from Secret Expression { $index }
graphing-calculator-narration-delete = Delete
graphing-calculator-narration-delete-expression = Delete Expression { $index }
graphing-calculator-narration-delete-folder-index = Delete Folder { $index }
graphing-calculator-narration-delete-folder-title = Delete { $folder } folder
graphing-calculator-narration-delete-image = Delete Image { $index }
graphing-calculator-narration-delete-secret-expression = Delete Secret Expression { $index }
graphing-calculator-narration-delete-table = Delete Table { $index }
graphing-calculator-narration-delete-text = Delete Note { $index }
graphing-calculator-narration-describe = Unknown object
graphing-calculator-narration-describe-expression = Expression { $index }
graphing-calculator-narration-describe-folder-index = Folder { $index }
graphing-calculator-narration-describe-folder-title = { $folder } folder
graphing-calculator-narration-describe-image = Image { $index }
graphing-calculator-narration-describe-secret-expression = Secret expression { $index }
graphing-calculator-narration-describe-table = Table { $index }
graphing-calculator-narration-describe-text = Note { $index }
graphing-calculator-narration-description-collapsed-folder = Collapsed Folder
graphing-calculator-narration-description-collapsed-readonly-folder = Collapsed Locked Folder
graphing-calculator-narration-description-collapsed-secret-folder = Collapsed Secret Folder
graphing-calculator-narration-description-collapsed-secret-readonly-folder = Collapsed Secret Locked Folder
graphing-calculator-narration-description-folder = Folder
graphing-calculator-narration-description-hidden-collapsed-folder = Hidden Collapsed Folder
graphing-calculator-narration-description-hidden-collapsed-readonly-folder = Hidden Collapsed Locked Folder
graphing-calculator-narration-description-hidden-collapsed-secret-folder = Hidden Collapsed Secret Folder
graphing-calculator-narration-description-hidden-collapsed-secret-readonly-folder = Hidden Collapsed Secret Locked Folder
graphing-calculator-narration-description-hidden-folder = Hidden Folder
graphing-calculator-narration-description-hidden-readonly-folder = Hidden Locked Folder
graphing-calculator-narration-description-hidden-secret-folder = Hidden Secret Folder
graphing-calculator-narration-description-hidden-secret-readonly-folder = Hidden Secret Locked Folder
graphing-calculator-narration-description-readonly-folder = Locked Folder
graphing-calculator-narration-description-secret-folder = Secret Folder
graphing-calculator-narration-description-secret-readonly-folder = Secret Locked Folder
graphing-calculator-narration-dist-tab-distributions = Distributions
graphing-calculator-narration-dist-tab-visualizations = Visualizations
graphing-calculator-narration-domain3d-maximum = domain { $term } Maximum:
graphing-calculator-narration-domain3d-minimum = domain { $term } Minimum:
graphing-calculator-narration-drag-mode-x = X
graphing-calculator-narration-drag-mode-xy = X and Y
graphing-calculator-narration-drag-mode-y = Y
graphing-calculator-narration-draggable-image-off-screen-prompt = { " " }not completely visible on screen
graphing-calculator-narration-duplicate = Duplicate
graphing-calculator-narration-duplicate-expression = Duplicate Expression { $index }
graphing-calculator-narration-duplicate-folder-index = Duplicate Folder { $index }
graphing-calculator-narration-duplicate-folder-title = Duplicate { $folder } folder
graphing-calculator-narration-duplicate-image = Duplicate Image { $index }
graphing-calculator-narration-duplicate-secret-expression = Duplicate Secret Expression { $index }
graphing-calculator-narration-duplicate-table = Duplicate Table { $index }
graphing-calculator-narration-duplicate-text = Duplicate Note { $index }
graphing-calculator-narration-edit-action = Edit Action
graphing-calculator-narration-edit-expression-list = Edit Expression List
graphing-calculator-narration-edit-folder-title = Edit Folder { $index } Title
graphing-calculator-narration-edit-graph-on-desmos = Edit graph on Desmos
graphing-calculator-narration-edit-image-title = Edit Image { $index } Title
graphing-calculator-narration-edit-list-mode-off = Edit list mode off.
graphing-calculator-narration-edit-list-mode-on = Edit list mode on.
graphing-calculator-narration-edit-on-desmos = Edit graph on Desmos
graphing-calculator-narration-edit-slider-variable-limits = Edit { $variable } Limits
graphing-calculator-narration-edit-text-title = Note { $index }
graphing-calculator-narration-edit-title = Edit Title
graphing-calculator-narration-editable-label-mode = Editable label mode
graphing-calculator-narration-editable-point-label = Editable point label
graphing-calculator-narration-expand = Expand
graphing-calculator-narration-expand-folder-index = Expand Folder { $index }
graphing-calculator-narration-expand-folder-title = Expand { $folder } folder
graphing-calculator-narration-expression-audio-trace-mac = To audio trace, press OPTION+T.
graphing-calculator-narration-expression-audio-trace-windows = To audio trace, press ALT+T.
graphing-calculator-narration-expression-bar = Expression Bar
graphing-calculator-narration-expression-evaluation-has-graph = Has graph.
graphing-calculator-narration-expression-evaluation-has-graph-and-regression = Has graph and regression. To access statistics, press Tab.
graphing-calculator-narration-expression-evaluation-has-regression = Has regression. To access statistics, press Tab.
graphing-calculator-narration-expression-evaluation-is-distribution = is distribution.
graphing-calculator-narration-expression-evaluation-is-t-test = is T test. To access statistics, press Tab.
graphing-calculator-narration-expression-hidden-label = Hidden { $label }
graphing-calculator-narration-expression-index-table = Expression { $index } table
graphing-calculator-narration-expression-label = Label
graphing-calculator-narration-expression-tone-muted = Muted tone.
graphing-calculator-narration-expression-tone-unmuted = Unmuted tone.
graphing-calculator-narration-fill-opacity = Fill Opacity:
graphing-calculator-narration-fill-visible = Fill visible
graphing-calculator-narration-folder-collapsed = folder collapsed
graphing-calculator-narration-folder-expanded = folder expanded
graphing-calculator-narration-folder-has-items = { $folder } has { $count } items
graphing-calculator-narration-functions = Functions
graphing-calculator-narration-geometry-added-object-type = Added { $type }.
graphing-calculator-narration-geometry-added-object-type-and-point = Added { $type } and 1 point.
graphing-calculator-narration-geometry-added-object-type-and-points = Added { $type } and { $points } points.
graphing-calculator-narration-geometry-added-points = Added { $points } points.
graphing-calculator-narration-geometry-angle-of-polygon = { $itemDescription } of { $parent }
graphing-calculator-narration-geometry-angle-through-points = { $itemDescription } through { $parent1 }, { $parent2 }, and { $parent3 }
graphing-calculator-narration-geometry-anglebisector-of-item = { $bisectorDescription }, bisector of { $item }
graphing-calculator-narration-geometry-arc-through-points = Arc { $index } starting at { $start }. Middle at { $middle }. End at { $end }.
graphing-calculator-narration-geometry-circle-with-center-and-radius = Circle { $index } with center at { $center } and radius { $radius }.
graphing-calculator-narration-geometry-construct-menu = Construct
graphing-calculator-narration-geometry-construction-icon-label = Token Count
graphing-calculator-narration-geometry-construction-role-description = construction
graphing-calculator-narration-geometry-dilated-item = dilated { $item }
graphing-calculator-narration-geometry-edge-of-polygon = Edge { $polygonEdge } of { $item }
graphing-calculator-narration-geometry-glider-on-item = { $gliderDescription } on { $item }
graphing-calculator-narration-geometry-glider-with-assignment = Glider { $assignment }
graphing-calculator-narration-geometry-hidden-construction-description = Hidden { $description }
graphing-calculator-narration-geometry-hidden-line = Hidden line
graphing-calculator-narration-geometry-hidden-parallel = Hidden parrallel
graphing-calculator-narration-geometry-hidden-perpendicular = Hidden perpendicular
graphing-calculator-narration-geometry-hidden-ray = Hidden ray
graphing-calculator-narration-geometry-hidden-segment = Hidden segment
graphing-calculator-narration-geometry-hidden-vector = Hidden vector
graphing-calculator-narration-geometry-intersection-of-items = { $intersectionDescription } of { $item1 } and { $item2 }
graphing-calculator-narration-geometry-intersection-with-assignment = Intersection { $assignment }
graphing-calculator-narration-geometry-item-at-coordinates-to-coordinates = { $itemDescription } from { $x1 } { $y1 } to { $x2 } { $y2 }
graphing-calculator-narration-geometry-label-options = Label Options
graphing-calculator-narration-geometry-labeled-angle = Angle { $label }
graphing-calculator-narration-geometry-labeled-directed-angle = Directed Angle { $label }
graphing-calculator-narration-geometry-list-of-angles = List of { $count } angles
graphing-calculator-narration-geometry-list-of-any = List of { $count } unknown objects
graphing-calculator-narration-geometry-list-of-arcs = List of { $count } arcs
graphing-calculator-narration-geometry-list-of-circles = List of { $count } circles
graphing-calculator-narration-geometry-list-of-directed-angles = List of { $count } directed angles
graphing-calculator-narration-geometry-list-of-lines = List of { $count } lines
graphing-calculator-narration-geometry-list-of-points = List of { $count } points
graphing-calculator-narration-geometry-list-of-polygons = List of { $count } polygons
graphing-calculator-narration-geometry-list-of-rays = List of { $count } rays
graphing-calculator-narration-geometry-list-of-segments = List of { $count } segments
graphing-calculator-narration-geometry-midpoint-of-item = { $midpointDescription } of { $item }
graphing-calculator-narration-geometry-midpoint-with-assignment = Midpoint { $assignment }
graphing-calculator-narration-geometry-moved-to-coordinates = Moved to x: { $x }, y: { $y }.
graphing-calculator-narration-geometry-near-item = Near { $item }.
graphing-calculator-narration-geometry-no-tool-inputs = No inputs exist
graphing-calculator-narration-geometry-nothing-selected = Nothing selected.
graphing-calculator-narration-geometry-parallel-to-line-through-point = Parallel line { $index } to { $line }, passing through { $point }
graphing-calculator-narration-geometry-perpendicular-to-line-through-point = Perpedicular line { $index } to { $line }, passing through { $point }
graphing-calculator-narration-geometry-point-with-assignment = Point { $assignment }
graphing-calculator-narration-geometry-polygon-through-vertices = { $itemDescription } through vertices { $vertices }
graphing-calculator-narration-geometry-reflected-item = reflected { $item }
graphing-calculator-narration-geometry-rotated-item = rotated { $item }
graphing-calculator-narration-geometry-segment-length = { $segmentDescription } with length { $length }
graphing-calculator-narration-geometry-segment-with-assignment = Segment { $assignment }
graphing-calculator-narration-geometry-straight-from-item-to-item = { $straightType } from { $start } to { $end }
graphing-calculator-narration-geometry-straight-index-of-item = { $straightType } { $index } of { $item }
graphing-calculator-narration-geometry-style-menu = Style
graphing-calculator-narration-geometry-token-navigator-depth = Depth: { $depth }
graphing-calculator-narration-geometry-token-navigator-label = Token Navigator
graphing-calculator-narration-geometry-tool-cancelled = Cancelled.
graphing-calculator-narration-geometry-tool-disabled = The { $tool } tool is disabled.
graphing-calculator-narration-geometry-transformed-item = transformed { $item }
graphing-calculator-narration-geometry-translated-item = translated { $item }
graphing-calculator-narration-geometry-unable-to-move = Unable to move.
graphing-calculator-narration-geometry-unlabeled-angle = Angle { $index }
graphing-calculator-narration-geometry-unlabeled-angle-with-measurement = { $measurementText } Angle { $index }
graphing-calculator-narration-geometry-unlabeled-arc = Arc { $index }
graphing-calculator-narration-geometry-unlabeled-circle = Circle { $index }
graphing-calculator-narration-geometry-unlabeled-decagon = Decagon { $index }
graphing-calculator-narration-geometry-unlabeled-directed-angle = Directed Angle { $index }
graphing-calculator-narration-geometry-unlabeled-directed-angle-with-measurement = { $measurementText } Directed Angle { $index }
graphing-calculator-narration-geometry-unlabeled-glider = Glider { $index }
graphing-calculator-narration-geometry-unlabeled-heptagon = Heptagon { $index }
graphing-calculator-narration-geometry-unlabeled-hexagon = Hexagon { $index }
graphing-calculator-narration-geometry-unlabeled-intersection = Intersection { $index }
graphing-calculator-narration-geometry-unlabeled-line = Line
graphing-calculator-narration-geometry-unlabeled-line-with-index = Line { $index }
graphing-calculator-narration-geometry-unlabeled-midpoint = Midpoint { $index }
graphing-calculator-narration-geometry-unlabeled-nonagon = Nonagon { $index }
graphing-calculator-narration-geometry-unlabeled-octagon = Octagon { $index }
graphing-calculator-narration-geometry-unlabeled-parallel = Parallel line
graphing-calculator-narration-geometry-unlabeled-parallel-with-index = Parallel line { $index }
graphing-calculator-narration-geometry-unlabeled-pentagon = Pentagon { $index }
graphing-calculator-narration-geometry-unlabeled-perpendicular = Perpendicular line
graphing-calculator-narration-geometry-unlabeled-perpendicular-with-index = Perpendicular line { $index }
graphing-calculator-narration-geometry-unlabeled-point = Point { $index }
graphing-calculator-narration-geometry-unlabeled-polygon = Polygon { $index } with { $sideCount } sides
graphing-calculator-narration-geometry-unlabeled-quadrilateral = Quadrilateral { $index }
graphing-calculator-narration-geometry-unlabeled-ray = Ray
graphing-calculator-narration-geometry-unlabeled-ray-with-index = Ray { $index }
graphing-calculator-narration-geometry-unlabeled-segment = Segment
graphing-calculator-narration-geometry-unlabeled-segment-with-index = Segment { $index }
graphing-calculator-narration-geometry-unlabeled-triangle = Triangle { $index }
graphing-calculator-narration-geometry-unlabeled-vector = Vector
graphing-calculator-narration-geometry-unlabeled-vector-with-index = Vector { $index }
graphing-calculator-narration-graph-settings-controls = Graph Settings Controls
graphing-calculator-narration-graphpaper-label = graph paper
graphing-calculator-narration-hide = Hide
graphing-calculator-narration-hide-animation-properties = Hide Animation Properties
graphing-calculator-narration-hide-expression = Hide Expression { $index }
graphing-calculator-narration-hide-expression-list = Hide expression list
graphing-calculator-narration-hide-folder-index = Hide Folder { $index }
graphing-calculator-narration-hide-folder-title = Hide { $folder } folder
graphing-calculator-narration-hide-image = Hide Image { $index }
graphing-calculator-narration-hide-options = Hide Options
graphing-calculator-narration-hide-options-expression = Hide Options for Expression { $index }
graphing-calculator-narration-hide-options-image = Hide Options for Image { $index }
graphing-calculator-narration-hide-options-secret-expression = Hide Options for Secret Expression { $index }
graphing-calculator-narration-hide-secret-expression = Hide Secret Expression { $index }
graphing-calculator-narration-hide-table = Hide Table { $index }
graphing-calculator-narration-hide-table-column = Hide Column
graphing-calculator-narration-hide-table-regression = Hide Regression
graphing-calculator-narration-hide-text = Hide Note { $index }
graphing-calculator-narration-image-styles = Styles
graphing-calculator-narration-item-at-coordinates = { $itemDescription } at { $coordinates }
graphing-calculator-narration-item-hidden = Item hidden.
graphing-calculator-narration-item-visible = Item visible.
graphing-calculator-narration-item-with-list-index = index { $listIndex } of { $item }
graphing-calculator-narration-items-deleted =
    { $count ->
        [one] { $count } item deleted.
       *[other] { $count } items deleted.
    }
graphing-calculator-narration-keypad-hidden = Keypad hidden
graphing-calculator-narration-keypad-key-next-curve = Next Curve
graphing-calculator-narration-keypad-key-next-poi = Next Point of Interest
graphing-calculator-narration-keypad-key-next-point = Next Point
graphing-calculator-narration-keypad-key-previous-curve = Previous Curve
graphing-calculator-narration-keypad-key-previous-poi = Previous Point of Interest
graphing-calculator-narration-keypad-key-previous-point = Previous Point
graphing-calculator-narration-keypad-key-speed-down = Speed Down
graphing-calculator-narration-keypad-key-speed-up = Speed Up
graphing-calculator-narration-keypad-key-volume-down = Volume Down
graphing-calculator-narration-keypad-key-volume-up = Volume Up
graphing-calculator-narration-keypad-visible = Keypad visible
graphing-calculator-narration-label-angle = Label Angle:
graphing-calculator-narration-label-menu = Label
graphing-calculator-narration-label-size = Label Size:
graphing-calculator-narration-label-text = Label Text
graphing-calculator-narration-label-visible = Label visible
graphing-calculator-narration-line-opacity = Line Opacity:
graphing-calculator-narration-line-style-dashed = Dashed
graphing-calculator-narration-line-style-dotted = Dotted
graphing-calculator-narration-line-style-solid = Solid
graphing-calculator-narration-lines-visible = Lines visible
graphing-calculator-narration-locked-items-not-deleted =
    { $count ->
        [one] { $count } locked item could not be deleted.
       *[other] { $count } locked items could not be deleted.
    }
graphing-calculator-narration-main-desmos-geometry = Desmos Geometry
graphing-calculator-narration-main-desmos-graphing-calculator = Desmos Graphing Calculator
graphing-calculator-narration-make-clickable = make clickable
graphing-calculator-narration-menu-drag-enabled = Drag Enabled
graphing-calculator-narration-movable-point-off-screen-prompt = { " " }not visible on screen
graphing-calculator-narration-movable-point-prefix = Point
graphing-calculator-narration-movable-point-suffix-usage-instructions = { " " }is movable. Press Arrows or Shift+Arrows to adjust.
graphing-calculator-narration-mute = Mute
graphing-calculator-narration-mute-all = Mute all
graphing-calculator-narration-mute-expression = Mute Expression { $index }
graphing-calculator-narration-mute-secret-expression = Mute Secret Expression { $index }
graphing-calculator-narration-muted = Muted
graphing-calculator-narration-no-geometry-tools-available = No geometry tools available.
graphing-calculator-narration-no-playing-tones = No currently playing tones
graphing-calculator-narration-no-tone-expressions = No tones in this graph
graphing-calculator-narration-options-menu = Options Menu
graphing-calculator-narration-options-menu-closed = Options menu closed.
graphing-calculator-narration-options-menu-open = Options menu open.
graphing-calculator-narration-pause-variable-animation = Pause { $variable } Animation
graphing-calculator-narration-play-variable-animation = Play { $variable } Animation
graphing-calculator-narration-poi-graph-point = Point
graphing-calculator-narration-point-size = Point Size:
graphing-calculator-narration-point-style-cross = Cross
graphing-calculator-narration-point-style-open = Open
graphing-calculator-narration-point-style-point = Point
graphing-calculator-narration-points-visible = Points visible
graphing-calculator-narration-powered-by-desmos = Powered by Desmos
graphing-calculator-narration-redo = Redo
graphing-calculator-narration-rename = Rename
graphing-calculator-narration-rename-expression = Rename in Expression { $index }
graphing-calculator-narration-rename-secret-expression = Rename in Secret Expression { $index }
graphing-calculator-narration-rename-table = Rename in Table { $index }
graphing-calculator-narration-run-action-icon = Run Action
graphing-calculator-narration-settings-all-axes-max = Max for x, y, and z
graphing-calculator-narration-settings-all-axes-min = Min for x, y, and z
graphing-calculator-narration-settings-angle = Angle Settings
graphing-calculator-narration-settings-cartesian-grid = Cartesian Grid
graphing-calculator-narration-settings-polar-grid = Polar Grid
graphing-calculator-narration-settings-show-both = Show Both
graphing-calculator-narration-settings-show-positive = Show Positive
graphing-calculator-narration-settings-x-axis-label-placeholder = e.g. “x”
graphing-calculator-narration-settings-x-axis-max = X Axis Maximum:{ " " }
graphing-calculator-narration-settings-x-axis-min = X Axis Minimum:{ " " }
graphing-calculator-narration-settings-x-axis-step = X Axis Step Size:{ " " }
graphing-calculator-narration-settings-y-axis-label-placeholder = e.g. “y”
graphing-calculator-narration-settings-y-axis-max = Y Axis Maximum:{ " " }
graphing-calculator-narration-settings-y-axis-min = Y Axis Minimum:{ " " }
graphing-calculator-narration-settings-y-axis-step = Y Axis Step Size:{ " " }
graphing-calculator-narration-settings-z-axis-max = Z Axis Maximum:{ " " }
graphing-calculator-narration-settings-z-axis-min = Z Axis Minimum:{ " " }
graphing-calculator-narration-show = Show
graphing-calculator-narration-show-animation-properties = Show Animation Properties
graphing-calculator-narration-show-expression = Show Expression { $index }
graphing-calculator-narration-show-folder-index = Show Folder { $index }
graphing-calculator-narration-show-folder-title = Show { $folder } folder
graphing-calculator-narration-show-image = Show Image { $index }
graphing-calculator-narration-show-options = Show Options
graphing-calculator-narration-show-options-expression = Show Options for Expression { $index }
graphing-calculator-narration-show-options-image = Show Options for Image { $index }
graphing-calculator-narration-show-options-secret-expression = Show Options for Secret Expression { $index }
graphing-calculator-narration-show-secret-expression = Show Secret Expression { $index }
graphing-calculator-narration-show-table = Show Table { $index }
graphing-calculator-narration-show-table-column = Show Column
graphing-calculator-narration-show-table-regression = Show Regression
graphing-calculator-narration-show-text = Show Note { $index }
graphing-calculator-narration-slider-animate-faster = Animate Faster
graphing-calculator-narration-slider-animate-slower = Animate Slower
graphing-calculator-narration-slider-animating-at-speed = Animating at { $speed }x
graphing-calculator-narration-slider-loop-forwards-and-backwards = Loop forwards and backwards
graphing-calculator-narration-slider-maximum = Slider Maximum:
graphing-calculator-narration-slider-minimum = Slider Minimum:
graphing-calculator-narration-slider-play-indefinitely = Play indefinitely
graphing-calculator-narration-slider-play-once = Play once
graphing-calculator-narration-slider-repeat-one-direction = Repeat in one direction
graphing-calculator-narration-slider-step = Slider Step Size:
graphing-calculator-narration-slider-trace-no-sliders = No sliders to trace.
graphing-calculator-narration-slider-trace-off = Slider trace off.
graphing-calculator-narration-slider-trace-on = Slider trace on.
graphing-calculator-narration-slider-variable-paused = { $variable } paused
graphing-calculator-narration-slider-variable-playing = { $variable } playing
graphing-calculator-narration-slider-variable-restarted = { $variable } restarted
graphing-calculator-narration-slow-compute = Is taking a long time to compute.
graphing-calculator-narration-slow-evaluation = Is taking a long time to evaluate.
graphing-calculator-narration-style-menu = Style Menu
graphing-calculator-narration-surface-opacity = Surface Opacity:
graphing-calculator-narration-surfaces-visible = Surfaces visible
graphing-calculator-narration-table-no-column-header = No column header
graphing-calculator-narration-table-regression-equation = Regression Equation
graphing-calculator-narration-tick-action = Tick Action
graphing-calculator-narration-toggle-audio-trace = Toggle Audio Trace
graphing-calculator-narration-toggle-letters = Toggle Letters
graphing-calculator-narration-unable-to-add-expression = Unable to add expression
graphing-calculator-narration-unable-to-add-note = Unable to add note
graphing-calculator-narration-unable-to-add-table = Unable to add table
graphing-calculator-narration-unable-to-add-table-regression = Unable to add regression
graphing-calculator-narration-undo = Undo
graphing-calculator-narration-unmute = Unmute
graphing-calculator-narration-unmute-all = Unmute all
graphing-calculator-narration-unmute-expression = Unmute Expression { $index }
graphing-calculator-narration-unmute-secret-expression = Unmute Secret Expression { $index }
graphing-calculator-narration-unmuted = Unmuted
graphing-calculator-narration-viewport-default = Graph viewport default
graphing-calculator-narration-viewport-pan-down = Graph pan down
graphing-calculator-narration-viewport-pan-left = Graph pan left
graphing-calculator-narration-viewport-pan-right = Graph pan right
graphing-calculator-narration-viewport-pan-up = Graph pan up
graphing-calculator-narration-viewport-updated = Graph viewport updated.
graphing-calculator-narration-viewport-zoom-3d-default = Graph set to default orientation
graphing-calculator-narration-viewport-zoom-3d-xy = Graph set to X Y orientation
graphing-calculator-narration-viewport-zoom-in = Graph zoom in
graphing-calculator-narration-viewport-zoom-out = Graph zoom out
graphing-calculator-narration-viewport-zoom-recenter = Graph recenter
graphing-calculator-narration-viewport-zoom-square = Graph zoom square
graphing-calculator-narration-visual-parameters-height = Height
graphing-calculator-narration-visual-parameters-offset = Offset
graphing-calculator-narration-visual-parameters-width = Width
graphing-calculator-narration-x-percentage-coordinate = { $x } percent from left.
graphing-calculator-narration-y-percentage-coordinate = { $y } percent from top.
graphing-calculator-narration-zoom-options-label = Zoom
graphing-calculator-text-add-screen-reader-label-placeholder = Add screen reader label
graphing-calculator-text-arrow-mode-both = Both
graphing-calculator-text-arrow-mode-default = Default
graphing-calculator-text-arrow-mode-none = None
graphing-calculator-text-arrow-mode-positive = Positive
graphing-calculator-text-audio-trace-no-implicit-support = Sorry, but I can't trace implicit curves yet.
graphing-calculator-text-audio-trace-no-parametric-support = Sorry, but I can't trace parametric curves yet.
graphing-calculator-text-audio-trace-no-polar-support = Sorry, but I can't trace polar curves yet.
graphing-calculator-text-audio-trace-off = Audio trace off.
graphing-calculator-text-audio-trace-on = Audio trace on.
graphing-calculator-text-color-black = black
graphing-calculator-text-color-blue = blue
graphing-calculator-text-color-cyan = cyan
graphing-calculator-text-color-dark-blue = dark blue
graphing-calculator-text-color-dark-cyan = dark cyan
graphing-calculator-text-color-dark-gray = dark gray
graphing-calculator-text-color-dark-green = dark green
graphing-calculator-text-color-dark-indigo = dark indigo
graphing-calculator-text-color-dark-lime = dark lime
graphing-calculator-text-color-dark-magenta = dark magenta
graphing-calculator-text-color-dark-orange = dark orange
graphing-calculator-text-color-dark-pink = dark pink
graphing-calculator-text-color-dark-red = dark red
graphing-calculator-text-color-dark-teal = dark teal
graphing-calculator-text-color-dark-violet = dark violet
graphing-calculator-text-color-dark-yellow = dark yellow
graphing-calculator-text-color-gray = gray
graphing-calculator-text-color-green = green
graphing-calculator-text-color-indigo = indigo
graphing-calculator-text-color-light-blue = light blue
graphing-calculator-text-color-light-cyan = light cyan
graphing-calculator-text-color-light-gray = light gray
graphing-calculator-text-color-light-green = light green
graphing-calculator-text-color-light-indigo = light indigo
graphing-calculator-text-color-light-lime = light lime
graphing-calculator-text-color-light-magenta = light magenta
graphing-calculator-text-color-light-orange = light orange
graphing-calculator-text-color-light-pink = light pink
graphing-calculator-text-color-light-red = light red
graphing-calculator-text-color-light-teal = light teal
graphing-calculator-text-color-light-violet = light violet
graphing-calculator-text-color-light-yellow = light yellow
graphing-calculator-text-color-lime = lime
graphing-calculator-text-color-magenta = magenta
graphing-calculator-text-color-orange = orange
graphing-calculator-text-color-pink = pink
graphing-calculator-text-color-purple = purple
graphing-calculator-text-color-red = red
graphing-calculator-text-color-teal = teal
graphing-calculator-text-color-unknown = color unknown
graphing-calculator-text-color-violet = violet
graphing-calculator-text-color-white = white
graphing-calculator-text-color-yellow = yellow
graphing-calculator-text-complex-plotting-note = Note: complex values will be plotted as (real, imag)
graphing-calculator-text-enter-pareneter = Enter the { $param }.
graphing-calculator-text-export-snapshot = Export a snapshot to the expression list
graphing-calculator-text-folder-placeholder = Untitled folder
graphing-calculator-text-geometry-arrow-mode = Arrow Mode: { $mode }
graphing-calculator-text-geometry-delete-selected-objects =
    { $count ->
        [one] Delete 1 object
       *[other] Delete { $count } objects
    }
graphing-calculator-text-geometry-delete-selected-unlocked-objects =
    { $count ->
        [one] Delete 1 unlocked object
       *[other] Delete { $count } unlocked objects
    }
graphing-calculator-text-geometry-glider = glider
graphing-calculator-text-geometry-hide-objects = Hide
graphing-calculator-text-geometry-intersection = intersection
graphing-calculator-text-geometry-move-to-expression-list-message = Move to expression list
graphing-calculator-text-geometry-multi-select-more-dropdown = More
graphing-calculator-text-geometry-no-constructed-objects = No constructed objects yet.
graphing-calculator-text-geometry-select-hint = Select a { $type }
graphing-calculator-text-geometry-selected-objects =
    { $count ->
        [one] 1 object selected
       *[other] { $count } objects selected
    }
graphing-calculator-text-geometry-show-objects = Show
graphing-calculator-text-geometry-tool-angle-bisector-display-name = Angle bisector
graphing-calculator-text-geometry-tool-angle-bisector-hint-angle = Choose an angle to bisect
graphing-calculator-text-geometry-tool-angle-display-name = Angle
graphing-calculator-text-geometry-tool-angle-hint-1 = Choose a starting point
graphing-calculator-text-geometry-tool-angle-hint-2 = Choose a vertex point
graphing-calculator-text-geometry-tool-angle-hint-3 = Choose an endpoint
graphing-calculator-text-geometry-tool-angles-hint-1 = Choose a starting point or a polygon
graphing-calculator-text-geometry-tool-arc-display-name = Arc
graphing-calculator-text-geometry-tool-arc-hint-1 = Choose a point (start)
graphing-calculator-text-geometry-tool-arc-hint-2 = Choose a point (middle)
graphing-calculator-text-geometry-tool-arc-hint-3 = Choose a point (end)
graphing-calculator-text-geometry-tool-box-selection-display-name = Box Select
graphing-calculator-text-geometry-tool-circle-by-length-display-name = Circle by length
graphing-calculator-text-geometry-tool-circle-display-name = Circle
graphing-calculator-text-geometry-tool-circle-hint-center = Choose a point (center)
graphing-calculator-text-geometry-tool-circle-hint-radius = Choose a point (radius)
graphing-calculator-text-geometry-tool-compass-hint-center = Choose a center point
graphing-calculator-text-geometry-tool-compass-hint-segment = Choose a segment to set the radius
graphing-calculator-text-geometry-tool-dilate-display-name = Dilate
graphing-calculator-text-geometry-tool-dilation-hint-center = Choose point (center)
graphing-calculator-text-geometry-tool-dilation-hint-scale-factor = Scale factor
graphing-calculator-text-geometry-tool-directed-angle-display-name = Directed Angle
graphing-calculator-text-geometry-tool-directedangle-display-name = Directed angle
graphing-calculator-text-geometry-tool-expression-edit-display-name = Insert into current expression.
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-0 = No valid inputs
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-1 = Choose { $type }
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-2 = Choose { $type1 } or { $type2 }
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-any-object = Choose any object
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-many = Choose one of the following: { $types }
graphing-calculator-text-geometry-tool-expression-edit-starting-transformation-hint = Choose an object to transform
graphing-calculator-text-geometry-tool-line-display-name = Line
graphing-calculator-text-geometry-tool-line-hint-end = Choose a 2nd point
graphing-calculator-text-geometry-tool-line-hint-start = Choose a 1st point
graphing-calculator-text-geometry-tool-midpoint-display-name = Midpoint
graphing-calculator-text-geometry-tool-midpoint-hint = Choose a segment
graphing-calculator-text-geometry-tool-parallel-display-name = Parallel
graphing-calculator-text-geometry-tool-parallel-hint-point = Choose a point to pass through
graphing-calculator-text-geometry-tool-parallel-hint-straight-line = Choose a line to be parallel to
graphing-calculator-text-geometry-tool-perpendicular-display-name = Perpendicular
graphing-calculator-text-geometry-tool-perpendicular-hint-point = Choose a point to pass through
graphing-calculator-text-geometry-tool-perpendicular-hint-straight-line = Choose a line to be perpendicular to
graphing-calculator-text-geometry-tool-point-display-name = Point
graphing-calculator-text-geometry-tool-point-hint = Select or create a point
graphing-calculator-text-geometry-tool-polygon-display-name = Polygon
graphing-calculator-text-geometry-tool-polygon-hint-finish-point = Choose another point, or click an existing point to finish
graphing-calculator-text-geometry-tool-polygon-hint-first-point = Choose a point
graphing-calculator-text-geometry-tool-polygon-hint-next-point = Choose another point
graphing-calculator-text-geometry-tool-ray-display-name = Ray
graphing-calculator-text-geometry-tool-ray-hint-end = Choose a point (direction)
graphing-calculator-text-geometry-tool-ray-hint-start = Choose a point (vertex)
graphing-calculator-text-geometry-tool-reflect-display-name = Reflect
graphing-calculator-text-geometry-tool-reflection-hint-choose-line = Choose line of reflection
graphing-calculator-text-geometry-tool-rotate-display-name = Rotate
graphing-calculator-text-geometry-tool-rotation-hint-angle = Choose angle
graphing-calculator-text-geometry-tool-rotation-hint-angle-end = Choose angle end point
graphing-calculator-text-geometry-tool-rotation-hint-angle-start = Construct or choose angle
graphing-calculator-text-geometry-tool-rotation-hint-center = Choose point (center)
graphing-calculator-text-geometry-tool-segment-display-name = Segment
graphing-calculator-text-geometry-tool-segment-hint-end = Choose another point
graphing-calculator-text-geometry-tool-segment-hint-start = Choose a point
graphing-calculator-text-geometry-tool-selection-display-name = Select
graphing-calculator-text-geometry-tool-translate-display-name = Translate
graphing-calculator-text-geometry-tool-translation-hint-from-with-vector = Choose start point or a vector
graphing-calculator-text-geometry-tool-translation-hint-to = Choose end point
graphing-calculator-text-geometry-tool-vector-copy-display-name = Copy of Vector
graphing-calculator-text-geometry-tool-vector-copy-hint-end = Choose new start point for copy
graphing-calculator-text-geometry-tool-vector-display-name = Vector
graphing-calculator-text-geometry-tool-vector-end-point-display-name = Vector End Point
graphing-calculator-text-geometry-tool-vector-hint-end = Choose end point
graphing-calculator-text-geometry-tool-vector-hint-start = Choose start point or a vector to copy
graphing-calculator-text-geometry-tool-vector-start-point-display-name = Vector Start Point
graphing-calculator-text-image-placeholder = Unnamed image
graphing-calculator-text-label-orientation-above = Above
graphing-calculator-text-label-orientation-above-left = Above Left
graphing-calculator-text-label-orientation-above-right = Above Right
graphing-calculator-text-label-orientation-below = Below
graphing-calculator-text-label-orientation-below-left = Below Left
graphing-calculator-text-label-orientation-below-right = Below Right
graphing-calculator-text-label-orientation-default = Default
graphing-calculator-text-label-orientation-left = Left
graphing-calculator-text-label-orientation-right = Right
graphing-calculator-text-loading-image = Loading image...
graphing-calculator-text-make-custom-regression = Make a custom regression model in a new line using <1>~</1>. <2>Learn how</2>.
graphing-calculator-text-note-placeholder = Empty note
graphing-calculator-text-parameter-name-binwidth = Bin Width
graphing-calculator-text-parameter-name-data = Data Set
graphing-calculator-text-parameter-name-dof = Degrees of Freedom
graphing-calculator-text-parameter-name-height = Height
graphing-calculator-text-parameter-name-max = Maximum
graphing-calculator-text-parameter-name-mean = Mean
graphing-calculator-text-parameter-name-min = Minimum
graphing-calculator-text-parameter-name-offset = Offset
graphing-calculator-text-parameter-name-probsuccess = Success Probability
graphing-calculator-text-parameter-name-stddev = Standard Deviation
graphing-calculator-text-parameter-name-trials = Trials
graphing-calculator-text-refreshable-braille-display-note = Use a refreshable Braille display, or just type Braille with a keyboard.
graphing-calculator-text-regression-potentially-inaccurate-parameters = Some parameters may be too large or small to represent accurately.
graphing-calculator-text-table-created = Table created.
graphing-calculator-text-table-creation-error = Error creating table.
graphing-calculator-text-table-more-rows = { $rowCount } more rows
graphing-calculator-text-toast-choose-one-file = You can only choose one file as a replacement
graphing-calculator-text-toast-error-importing-graph = Error importing graph. Check the URL?
graphing-calculator-text-toast-error-no-folders = Only graphs without folders can be inserted into a folder.
graphing-calculator-text-toast-expression-size-limit = Maximum expression size reached.
graphing-calculator-text-toast-graph-cleared = Graph cleared.
graphing-calculator-text-toast-graph-reset = Graph reset.
graphing-calculator-text-toast-image-upload-failed = Image upload failed.
graphing-calculator-text-toast-imported-graph = Graph imported!
graphing-calculator-text-toast-importing-graph = Importing graph...
graphing-calculator-text-toast-no-file-selected = You did not select a file
graphing-calculator-text-toast-uploading-images = Uploading images...
graphing-calculator-text-toast-zoom-to-fit = We zoomed to fit your data.
graphing-calculator-text-undefined-parameter = { $parameter } is undefined
graphing-calculator-text-view-regression-options = Regression options
graphing-calculator-text-zoom-fit = Zoom Fit
matrix-calculator-narration-keypad-key-det = Determinant
matrix-calculator-narration-keypad-key-inverse = Inverse
matrix-calculator-narration-keypad-key-rref = Reduced row echelon form
matrix-calculator-narration-keypad-key-trace = Trace
matrix-calculator-narration-keypad-key-transpose = Transpose










































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































`,Yu=class{constructor(e){this.value=e}valueOf(){return this.value}},Wo=class extends Yu{constructor(e="???"){super(e)}toString(e){return`{${this.value}}`}},Ms=class extends Yu{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),this.value.toString(10)}}},Sd=class extends Yu{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),new Date(this.value).toISOString()}}},DH=100,ate="⁨",ste="⁩";function lte(e,t,r){if(r===t||r instanceof Ms&&t instanceof Ms&&r.value===t.value)return!0;if(t instanceof Ms&&typeof r=="string"){let n=e.memoizeIntlObject(Intl.PluralRules,t.opts).select(t.value);if(r===n)return!0}return!1}function kH(e,t,r){return t[r]?Eb(e,t[r].value):(e.reportError(new RangeError("No default")),new Wo)}function NL(e,t){let r=[],n=Object.create(null);for(let i of t)i.type==="narg"?n[i.name]=Jw(e,i.value):r.push(Jw(e,i));return{positional:r,named:n}}function Jw(e,t){switch(t.type){case"str":return t.value;case"num":return new Ms(t.value,{minimumFractionDigits:t.precision});case"var":return cte(e,t);case"mesg":return dte(e,t);case"term":return pte(e,t);case"func":return ute(e,t);case"select":return hte(e,t);default:return new Wo}}function cte(e,{name:t}){let r;if(e.params)if(Object.prototype.hasOwnProperty.call(e.params,t))r=e.params[t];else return new Wo(`$${t}`);else if(e.args&&Object.prototype.hasOwnProperty.call(e.args,t))r=e.args[t];else return e.reportError(new ReferenceError(`Unknown variable: $${t}`)),new Wo(`$${t}`);if(r instanceof Yu)return r;switch(typeof r){case"string":return r;case"number":return new Ms(r);case"object":if(r instanceof Date)return new Sd(r.getTime());default:return e.reportError(new TypeError(`Variable type not supported: $${t}, ${typeof r}`)),new Wo(`$${t}`)}}function dte(e,{name:t,attr:r}){let n=e.bundle._messages.get(t);if(!n)return e.reportError(new ReferenceError(`Unknown message: ${t}`)),new Wo(t);if(r){let i=n.attributes[r];return i?Eb(e,i):(e.reportError(new ReferenceError(`Unknown attribute: ${r}`)),new Wo(`${t}.${r}`))}return n.value?Eb(e,n.value):(e.reportError(new ReferenceError(`No value: ${t}`)),new Wo(t))}function pte(e,{name:t,attr:r,args:n}){let i=`-${t}`,o=e.bundle._terms.get(i);if(!o)return e.reportError(new ReferenceError(`Unknown term: ${i}`)),new Wo(i);if(r){let s=o.attributes[r];if(s){e.params=NL(e,n).named;let l=Eb(e,s);return e.params=null,l}return e.reportError(new ReferenceError(`Unknown attribute: ${r}`)),new Wo(`${i}.${r}`)}e.params=NL(e,n).named;let a=Eb(e,o.value);return e.params=null,a}function ute(e,{name:t,args:r}){let n=e.bundle._functions[t];if(!n)return e.reportError(new ReferenceError(`Unknown function: ${t}()`)),new Wo(`${t}()`);if(typeof n!="function")return e.reportError(new TypeError(`Function ${t}() is not callable`)),new Wo(`${t}()`);try{let i=NL(e,r);return n(i.positional,i.named)}catch(i){return e.reportError(i),new Wo(`${t}()`)}}function hte(e,{selector:t,variants:r,star:n}){let i=Jw(e,t);if(i instanceof Wo)return kH(e,r,n);for(let o of r){let a=Jw(e,o.key);if(lte(e,i,a))return Eb(e,o.value)}return kH(e,r,n)}function BL(e,t){if(e.dirty.has(t))return e.reportError(new RangeError("Cyclic reference")),new Wo;e.dirty.add(t);let r=[],n=e.bundle._useIsolating&&t.length>1;for(let i of t){if(typeof i=="string"){r.push(e.bundle._transform(i));continue}if(e.placeables++,e.placeables>DH)throw e.dirty.delete(t),new RangeError(`Too many placeables expanded: ${e.placeables}, max allowed is ${DH}`);n&&r.push(ate),r.push(Jw(e,i).toString(e)),n&&r.push(ste)}return e.dirty.delete(t),r.join("")}function Eb(e,t){return typeof t=="string"?e.bundle._transform(t):BL(e,t)}var vT=class{constructor(e,t,r){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=e,this.errors=t,this.args=r}reportError(e){if(!this.errors||!(e instanceof Error))throw e;this.errors.push(e)}memoizeIntlObject(e,t){let r=this.bundle._intls.get(e);r||(r={},this.bundle._intls.set(e,r));let n=JSON.stringify(t);return r[n]||(r[n]=new e(this.bundle.locales,t)),r[n]}};function CT(e,t){let r=Object.create(null);for(let[n,i]of Object.entries(e))t.includes(n)&&(r[n]=i.valueOf());return r}var _H=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function AH(e,t){let r=e[0];if(r instanceof Wo)return new Wo(`NUMBER(${r.valueOf()})`);if(r instanceof Ms)return new Ms(r.valueOf(),R(R({},r.opts),CT(t,_H)));if(r instanceof Sd)return new Ms(r.valueOf(),R({},CT(t,_H)));throw new TypeError("Invalid argument to NUMBER")}var IH=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function MH(e,t){let r=e[0];if(r instanceof Wo)return new Wo(`DATETIME(${r.valueOf()})`);if(r instanceof Sd)return new Sd(r.valueOf(),R(R({},r.opts),CT(t,IH)));if(r instanceof Ms)return new Sd(r.valueOf(),R({},CT(t,IH)));throw new TypeError("Invalid argument to DATETIME")}var GH=new Map;function LH(e){let t=Array.isArray(e)?e.join(" "):e,r=GH.get(t);return r===void 0&&(r=new Map,GH.set(t,r)),r}var Qw=class{constructor(e,{functions:t,useIsolating:r=!0,transform:n=i=>i}={}){this._terms=new Map,this._messages=new Map,this.locales=Array.isArray(e)?e:[e],this._functions=R({NUMBER:AH,DATETIME:MH},t),this._useIsolating=r,this._transform=n,this._intls=LH(e)}hasMessage(e){return this._messages.has(e)}getMessage(e){return this._messages.get(e)}addResource(e,{allowOverrides:t=!1}={}){let r=[];for(let n=0;n<e.body.length;n++){let i=e.body[n];if(i.id.startsWith("-")){if(t===!1&&this._terms.has(i.id)){r.push(new Error(`Attempt to override an existing term: "${i.id}"`));continue}this._terms.set(i.id,i)}else{if(t===!1&&this._messages.has(i.id)){r.push(new Error(`Attempt to override an existing message: "${i.id}"`));continue}this._messages.set(i.id,i)}}return r}formatPattern(e,t=null,r=null){if(typeof e=="string")return this._transform(e);let n=new vT(this,r,t);try{return BL(n,e).toString(n)}catch(i){if(n.errors&&i instanceof Error)return n.errors.push(i),new Wo().toString(n);throw i}}},UL=/^(-?[a-zA-Z][\w-]*) *= */gm,PH=/\.([a-zA-Z][\w-]*) *= */y,gte=/\*?\[/y,zL=/(-?[0-9]+(?:\.([0-9]+))?)/y,mte=/([a-zA-Z][\w-]*)/y,VH=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,fte=/^[A-Z][A-Z0-9_-]*$/,ST=/([^{}\n\r]+)/y,bte=/([^\\"\n\r]*)/y,OH=/\\([\\"])/y,RH=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,yte=/^\n+/,FH=/ +$/,xte=/ *\r?\n/g,wte=/( *)$/,vte=/{\s*/y,NH=/\s*}/y,Cte=/\[\s*/y,Ste=/\s*] */y,Ete=/\s*\(\s*/y,Tte=/\s*->\s*/y,Dte=/\s*:\s*/y,kte=/\s*,?\s*/y,_te=/\s+/y,Tb=class{constructor(e){this.body=[],UL.lastIndex=0;let t=0;for(;;){let F=UL.exec(e);if(F===null)break;t=UL.lastIndex;try{this.body.push(s(F[1]))}catch(B){if(B instanceof SyntaxError)continue;throw B}}function r(F){return F.lastIndex=t,F.test(e)}function n(F,B){if(e[t]===F)return t++,!0;if(B)throw new B(`Expected ${F}`);return!1}function i(F,B){if(r(F))return t=F.lastIndex,!0;if(B)throw new B(`Expected ${F.toString()}`);return!1}function o(F){F.lastIndex=t;let B=F.exec(e);if(B===null)throw new SyntaxError(`Expected ${F.toString()}`);return t=F.lastIndex,B}function a(F){return o(F)[1]}function s(F){let B=c(),x=l();if(B===null&&Object.keys(x).length===0)throw new SyntaxError("Expected message value or attributes");return{id:F,value:B,attributes:x}}function l(){let F=Object.create(null);for(;r(PH);){let B=a(PH),x=c();if(x===null)throw new SyntaxError("Expected attribute value");F[B]=x}return F}function c(){let F;if(r(ST)&&(F=a(ST)),e[t]==="{"||e[t]==="}")return d(F?[F]:[],1/0);let B=M();return B?F?d([F,B],B.length):(B.value=C(B.value,yte),d([B],B.length)):F?C(F,FH):null}function d(F=[],B){for(;;){if(r(ST)){F.push(a(ST));continue}if(e[t]==="{"){F.push(u());continue}if(e[t]==="}")throw new SyntaxError("Unbalanced closing brace");let O=M();if(O){F.push(O),B=Math.min(B,O.length);continue}break}let x=F.length-1,L=F[x];typeof L=="string"&&(F[x]=C(L,FH));let N=[];for(let O of F)O instanceof ET&&(O=O.value.slice(0,O.value.length-B)),O&&N.push(O);return N}function u(){i(vte,SyntaxError);let F=p();if(i(NH))return F;if(i(Tte)){let B=y();return i(NH,SyntaxError),R({type:"select",selector:F},B)}throw new SyntaxError("Unclosed placeable")}function p(){if(e[t]==="{")return u();if(r(VH)){let[,F,B,x=null]=o(VH);if(F==="$")return{type:"var",name:B};if(i(Ete)){let L=g();if(F==="-")return{type:"term",name:B,attr:x,args:L};if(fte.test(B))return{type:"func",name:B,args:L};throw new SyntaxError("Function names must be all upper-case")}return F==="-"?{type:"term",name:B,attr:x,args:[]}:{type:"mesg",name:B,attr:x}}return _()}function g(){let F=[];for(;;){switch(e[t]){case")":return t++,F;case void 0:throw new SyntaxError("Unclosed argument list")}F.push(f()),i(kte)}}function f(){let F=p();return F.type!=="mesg"?F:i(Dte)?{type:"narg",name:F.name,value:_()}:F}function y(){let F=[],B=0,x;for(;r(gte);){n("*")&&(x=B);let L=E(),N=c();if(N===null)throw new SyntaxError("Expected variant value");F[B++]={key:L,value:N}}if(B===0)return null;if(x===void 0)throw new SyntaxError("Expected default variant");return{variants:F,star:x}}function E(){i(Cte,SyntaxError);let F;return r(zL)?F=w():F={type:"str",value:a(mte)},i(Ste,SyntaxError),F}function _(){if(r(zL))return w();if(e[t]==='"')return v();throw new SyntaxError("Invalid expression")}function w(){let[,F,B=""]=o(zL),x=B.length;return{type:"num",value:parseFloat(F),precision:x}}function v(){n('"',SyntaxError);let F="";for(;;){if(F+=a(bte),e[t]==="\\"){F+=T();continue}if(n('"'))return{type:"str",value:F};throw new SyntaxError("Unclosed string literal")}}function T(){if(r(OH))return a(OH);if(r(RH)){let[,F,B]=o(RH),x=parseInt(F||B,16);return x<=55295||57344<=x?String.fromCodePoint(x):"�"}throw new SyntaxError("Unknown escape sequence")}function M(){let F=t;switch(i(_te),e[t]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return P(e.slice(F,t))}return e[t-1]===" "?P(e.slice(F,t)):!1}function C(F,B){return F.replace(B,"")}function P(F){let B=F.replace(xte,`
`),x=wte.exec(F)[1].length;return new ET(B,x)}}},ET=class{constructor(e,t){this.value=e,this.length=t}},Ate=["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"],TT=class Ys{constructor(t,r){this.bundles=t,this.onError=r}static fromSources(t,r,n){let i=[];for(let{lang:o,source:a}of t){let s=o.split("-")[0],l=new Qw(o,ie(R({},n),{useIsolating:Ate.indexOf(s)>=0}));l.addResource(new Tb(a),{allowOverrides:!1}),l.addResource(new Tb(`
l10n-internal-date-day-month-year = {DATETIME($d, month: "short", day: "numeric", year: "numeric")}
l10n-internal-date-day-month = {DATETIME($d, month: "short", day: "numeric")}
l10n-internal-time = {DATETIME($d, minute: "numeric", hour: "numeric")}
      `),{allowOverrides:!1}),i.push(l)}return new Ys(i,r)}format(t,r){for(let n of this.bundles){if(!n.hasMessage(t))continue;let i=n.getMessage(t);if(!(i!=null&&i.value))return;let o=[],a=n.formatPattern(i.value,this.coerceNumericVariables(r),o);for(let s of o)this.onError(`Error formatting ${t} for locale ${n.locales.join(",")}: ${s}`);return a}this.onError(`Couldn't find message for key ${t} for locales ${this.getLocales().join(",")}`)}formatDate(t,r){return r.showYear?this.format("l10n-internal-date-day-month-year",{d:t}):this.format("l10n-internal-date-day-month",{d:t})}formatTime(t){let r=this.format("l10n-internal-time",{d:t});return this.getLocales()[0]==="en"?r==null?void 0:r.toLowerCase():r}hasTranslation(t,r){for(let n of this.bundles)if(n.locales.indexOf(r)>=0)return n.hasMessage(t);return!1}coerceNumericVariables(t){let r={};for(let n in t){let i=t[n];__dcg_shared_module_exports__.sa(i)?r[n]=i.value:typeof i=="number"?r[n]=`${i}`:r[n]=i}return r}getLocales(){return this.bundles.reduce((t,r)=>t.concat(r.locales),[])}},DT="",qL={},BH={},HL={},Mte=["ar","hy-AM","hi","tr","xx-XX"];function kT(e){DT=e||""}function KL(e){for(let t in e)delete HL[t],BH[t]=e[t]}function WL(e,t){let r=t!=null?t:DT;return zH(r).hasTranslation(e,r)}function Gs(e,t){if(t)for(let r in t)t.hasOwnProperty(r)&&(e=e.split("__"+r+"__").join(t[r]));return e}function Ls(e,t,r){return UH(e,t!=null?t:{},r!=null?r:DT)}function Ip(e){return function(t,r){return UH(t,r!=null?r:{},e())}}function Gte(e){let t={};for(let r in e){let n=e[r];n!==void 0&&(t[r]=n)}return t}function UH(e,t,r){let n=zH(r).format(e,Gte(t));return n==null?(__dcg_shared_module_exports__.qe.warn(`Could not format string ${e}`),""):n}function zH(e){let t=HL[e];if(!t){qL[e]||(qL[e]=Xw([e]));let r=[];for(let i of qL[e]){let o=BH[i];o&&r.push({lang:i,source:o})}let n={};e==="xx-XX"&&(n.transform=i=>i.replace(/[a-z]/gi,"♦")),t=HL[e]=TT.fromSources([...r,{lang:"en",source:TH}],i=>{__dcg_shared_module_exports__.qe.warn(i)},n)}return t}function Zw(){return DT}function $L(e){return Vg.hasOwnProperty(e)||__dcg_shared_module_exports__.l(Mte,e)}function Fl(e,t){if(e==null)return"";if(typeof e=="string")return e;if(typeof e=="number")return""+e;let r=e.vars,n;if(r){n={};for(let i in r){if(!r.hasOwnProperty(i))continue;let o=r[i];__dcg_shared_module_exports__.sa(o)?n[i]=o:n[i]=Fl(o,t)}}return Ls(e.key,n,t)}var Db=typeof desmosLocaleData=="object"?desmosLocaleData:{};function jL(){let e=Xw([Du("lang"),navigator.userLanguage,navigator.language]);for(let t=0;t<e.length;t++){let r=e[t];if($L(r))return r}return"en"}function qH(e){return Fr(this,null,function*(){if(Db[e]||e==="en"||e==="xx-XX")return kT(e),!0;if(!$L(e)){let t=e.indexOf("-")!==-1?e.split("-")[0]:e;for(let r in Vg)if(t===r.split("-")[0]&&Vg[r].useAsRoot){e=r;break}}try{let t=yield EH(`/api/v1/calculator/language/${e}.ftl`);return Db[e]=t[e],KL(Db),kT(e),!0}catch(t){throw t.status===404&&__dcg_shared_module_exports__.qe.warn(e+" is not an available language."),t}})}function _T(e){if(Db[e])return!0;let t=Xw([e]);for(let r of t)if(Db[r])return!0;return!1}KL(Db),kT(jL());var Lte=/`[^`]*`/g,Pte=/^[\+\-]?[\d]*(\.\d+)?$/,Vte=e=>{if(e!=null){let t=e.match(/`/g);return(t!=null&&t.length||0)%2==0}return!0},Ote=e=>{let t=[];if(e==null||e.length==0)return t;let r=0,n;for(;n=Lte.exec(e);){let o=e.slice(r,n.index);o.length>0&&t.push({from:r,to:n.index,type:"text",text:o}),r=n.index+n[0].length,t.push({from:n.index,to:r,type:"math",text:n[0].slice(1,-1)})}let i=e.slice(r);return i.length>0&&t.push({from:r,to:e.length,type:"text",text:i}),t},HH=gc.StaticMath(document.createElement("span"));function ei(e){let t="",r=[];Vte(e)?r=Ote(e):r=[{from:0,to:e.length,type:"text",text:e}];for(let n of r)t+=n.type==="text"?n.text:Ao(n.text);return t}function Ao(e){let t="";return Pte.test(e)?(/^\+/.test(e)?(t="positive ",e=e.slice(1)):/^\-/.test(e)&&(t="negative ",e=e.slice(1)),t+=e.replace(/(\.)([0-9]+)/g,(r,n,i)=>n+i.split("").join(" ").trim())):(HH.latex(e),t=HH.mathspeak().trim()),t}function IT(e,t,r){let n=e.formula.typed_constant_value;if(n!=null&&n.value){if(__dcg_shared_module_exports__.Ob(n))return`${Fl(__dcg_shared_module_exports__.vb(n.valueType),t.getLanguage())}. ${t.s("shared-calculator-label-list-of-count-items-suffix",{count:n.value.length})}`;if(__dcg_shared_module_exports__.yb(n.valueType))return Fl(__dcg_shared_module_exports__.vb(n.valueType),t.getLanguage());switch(n.valueType){case __dcg_shared_module_exports__.wa:return Ao(__dcg_shared_module_exports__.la(+n.value,r));case __dcg_shared_module_exports__.db:return Ao(__dcg_shared_module_exports__.pa(n.value,r));case __dcg_shared_module_exports__.Ha:return md(t,e.formula.rgb_value);case __dcg_shared_module_exports__.xa:case __dcg_shared_module_exports__.bb:case __dcg_shared_module_exports__.Ga:case __dcg_shared_module_exports__.hb:case __dcg_shared_module_exports__.jb:case __dcg_shared_module_exports__.lb:case __dcg_shared_module_exports__.nb:case __dcg_shared_module_exports__.pb:case __dcg_shared_module_exports__.fb:case __dcg_shared_module_exports__.za:case __dcg_shared_module_exports__.Fa:case __dcg_shared_module_exports__.Ea:return Fl(__dcg_shared_module_exports__.vb(n.valueType),t.getLanguage());default:let i=n.valueType;throw new Error(`Unexpected valueType ${i}`)}}}var an=1;function kb(e,t){let r=[],n=e.formula.geometry&&e.formula.geometry.call;if(!n||!n.parents)return[];for(let i of n.parents)if(i.type==="arbitrary-expression")r.push(void 0);else{let o=__dcg_shared_module_exports__.Cc(i),a=t.getGeoTokenInfoFromIdentifier(o);r.push(a?t.getItemModel(a.calcId):void 0)}return r}function Ap(e,t={}){let r=e.formula.typed_constant_value.value,n=e.formula.typed_constant_value.valueType;return t.listIndex!==void 0&&__dcg_shared_module_exports__.wb(n)&&(n=__dcg_shared_module_exports__.xb(n),r=r[t.listIndex]),{value:r,valueType:n}}function AT(e,t,r){var n,i;let o=r.depth?r.depth:0,a,s=[],l=(n=e.formula.geometry.call)==null?void 0:n.symbol,c=kb(e,t),[d,u]=c,{value:p}=Ap(e,r),[g,f]=p,y=(i=r.poi)==null?void 0:i.ariaLabel,E=y!==void 0&&y!==""?y:e.label;if(e.hidden&&o>=an&&typeof g=="number"&&typeof f=="number")return[ll(t,g,f)];switch(l){case"intersection":E?a=t.s("graphing-calculator-narration-geometry-intersection-with-assignment",{assignment:ei(E)}):a=t.s("graphing-calculator-narration-geometry-unlabeled-intersection",{index:e.id}),o<an&&d!==void 0&&u!==void 0?s.push(t.s("graphing-calculator-narration-geometry-intersection-of-items",{intersectionDescription:a,item1:Fo(d,t,{includeDetails:!1,depth:o+1}),item2:Fo(u,t,{includeDetails:!1,depth:o+1})})):s.push(a);break;case"midpoint":E?a=t.s("graphing-calculator-narration-geometry-midpoint-with-assignment",{assignment:ei(E)}):a=t.s("graphing-calculator-narration-geometry-unlabeled-midpoint",{index:e.id}),o<an&&d!==void 0?s.push(t.s("graphing-calculator-narration-geometry-midpoint-of-item",{midpointDescription:a,item:Fo(d,t,{includeDetails:!1,depth:o+1})})):s.push(a);break;case"glider":E?a=t.s("graphing-calculator-narration-geometry-glider-with-assignment",{assignment:ei(E)}):a=t.s("graphing-calculator-narration-geometry-unlabeled-glider",{index:e.id}),o<an&&d!==void 0?s.push(t.s("graphing-calculator-narration-geometry-glider-on-item",{gliderDescription:a,item:Fo(d,t,{includeDetails:!1,depth:o+1})})):s.push(a);break;default:E?a=t.s("graphing-calculator-narration-geometry-point-with-assignment",{assignment:ei(E)}):a=t.s("graphing-calculator-narration-geometry-unlabeled-point",{index:e.id}),r.includeDetails&&typeof g=="number"&&typeof f=="number"?s.push(t.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:a,coordinates:ll(t,g,f)})):s.push(a)}return s}function KH(e,t,r){var n,i;let o=r.depth?r.depth:0,a=[],s=kb(e,t),[l]=s,{value:c}=Ap(e,r),d=c[1],u=t.get2dProjection(),p=u&&u.viewport;return o<an&&l!==void 0&&il(l)&&!__dcg_shared_module_exports__.Dc((i=(n=l.formula.geometry)==null?void 0:n.call)==null?void 0:i.symbol)&&typeof d=="number"&&p!==void 0?a.push(t.s("graphing-calculator-narration-geometry-circle-with-center-and-radius",{index:e.id,center:Fo(l,t,{includeDetails:!1,depth:o+1}),radius:Ao(__dcg_shared_module_exports__.ea(d,p.xmax-p.xmin).latex)})):a.push(t.s("graphing-calculator-narration-geometry-unlabeled-circle",{index:e.id})),a}function WH(e,t,r){let n=r.depth?r.depth:0,i=[],o=kb(e,t),[a,s,l]=o;return n<an&&a!==void 0&&s!==void 0&&l!==void 0?i.push(t.s("graphing-calculator-narration-geometry-arc-through-points",{index:e.id,start:Fo(a,t,{includeDetails:!1,depth:n+1}),middle:Fo(s,t,{includeDetails:!1,depth:n+1}),end:Fo(l,t,{includeDetails:!1,depth:n+1})})):i.push(t.s("graphing-calculator-narration-geometry-unlabeled-arc",{index:e.id})),i}function $H(e,t,r){let n=r.depth?r.depth:0,{value:i}=Ap(e,r),o=i.length;if(r.polygonEdge!==void 0)if(r.polygonEdge>=0&&r.polygonEdge<i.length){let l=i[r.polygonEdge],c=i[(r.polygonEdge+1)%i.length];i=[l,c]}else return[t.s("shared-calculator-narration-item-unknown")];let a,s=[];if(o===3?a=t.s("graphing-calculator-narration-geometry-unlabeled-triangle",{index:e.id}):o===4?a=t.s("graphing-calculator-narration-geometry-unlabeled-quadrilateral",{index:e.id}):o===5?a=t.s("graphing-calculator-narration-geometry-unlabeled-pentagon",{index:e.id}):o===6?a=t.s("graphing-calculator-narration-geometry-unlabeled-hexagon",{index:e.id}):o===7?a=t.s("graphing-calculator-narration-geometry-unlabeled-heptagon",{index:e.id}):o===8?a=t.s("graphing-calculator-narration-geometry-unlabeled-octagon",{index:e.id}):o===9?a=t.s("graphing-calculator-narration-geometry-unlabeled-nonagon",{index:e.id}):o===10?a=t.s("graphing-calculator-narration-geometry-unlabeled-decagon",{index:e.id}):a=t.s("graphing-calculator-narration-geometry-unlabeled-polygon",{index:e.id,sideCount:o}),r.polygonEdge!==void 0){let l=i.length>0?i[0][0]:void 0,c=i.length>0?i[0][1]:void 0,d=i.length>1?i[1][0]:void 0,u=i.length>1?i[1][1]:void 0;r.includeDetails&&n<an&&typeof l=="number"&&typeof c=="number"&&typeof d=="number"&&typeof u=="number"?s.push(t.s("graphing-calculator-narration-geometry-item-at-coordinates-to-coordinates",{itemDescription:a,x1:Bl(t,l),y1:Ul(t,c),x2:Bl(t,d),y2:Ul(t,u)})):s.push(a)}else if(r.includeDetails&&n<an){let l=[];if(o<=10){let c=kb(e,t).filter(d=>il(d)&&d.type==="expression"&&!d.hidden&&Ap(d,r).valueType===__dcg_shared_module_exports__.ya);c.length===o&&c.forEach(d=>{l.push(Fo(d,t,{includeDetails:!1,depth:n+1}))})}l.length?s.push(t.s("graphing-calculator-narration-geometry-polygon-through-vertices",{itemDescription:a,vertices:Cd(t.getLanguage(),l)})):s.push(a)}else s.push(a);return s}function jH(e,t,r){var n,i,o;let a=r.depth?r.depth:0,s="",l=[],c=(n=e.formula.geometry.call)==null?void 0:n.symbol,d=e.formula.geometry.listAccess,{value:u,valueType:p}=Ap(e,r),[g,f]=u[0],[y,E]=u[1],_=kb(e,t),w=r.listIndex||0,v=FL(e,w)||e.label,[T,M]=_,C=t.get2dProjection(),P=C&&C.viewport,F=T!==void 0&&M===void 0&&d!==void 0;if(c==="parallel")a<an&&T!==void 0&&M!==void 0?l.push(t.s("graphing-calculator-narration-geometry-parallel-to-line-through-point",{index:e.id,line:Fo(T,t,{includeDetails:!1,depth:a+1}),point:Fo(M,t,{includeDetails:!1,depth:a+1})})):e.hidden&&a>=an?l.push(t.s("graphing-calculator-narration-geometry-hidden-parallel")):F?s=t.s("graphing-calculator-narration-geometry-unlabeled-parallel"):l.push(t.s("graphing-calculator-narration-geometry-unlabeled-parallel-with-index",{index:e.id}));else if(c==="perpendicular")a<an&&T!==void 0&&M!==void 0?l.push(t.s("graphing-calculator-narration-geometry-perpendicular-to-line-through-point",{index:e.id,line:Fo(T,t,{includeDetails:!1,depth:a+1}),point:Fo(M,t,{includeDetails:!1,depth:a+1})})):e.hidden&&a>=an?l.push(t.s("graphing-calculator-narration-geometry-hidden-perpendicular")):F?s=t.s("graphing-calculator-narration-geometry-unlabeled-perpendicular"):l.push(t.s("graphing-calculator-narration-geometry-unlabeled-perpendicular-with-index",{index:e.id}));else if(p===__dcg_shared_module_exports__.Ra)e.hidden&&a>=an?l.push(t.s("graphing-calculator-narration-geometry-hidden-line")):F?s=t.s("graphing-calculator-narration-geometry-unlabeled-line"):s=t.s("graphing-calculator-narration-geometry-unlabeled-line-with-index",{index:e.id});else if(p===__dcg_shared_module_exports__.Ta){if(e.hidden&&a>=an?l.push(t.s("graphing-calculator-narration-geometry-hidden-ray")):F?s=t.s("graphing-calculator-narration-geometry-unlabeled-ray"):s=t.s("graphing-calculator-narration-geometry-unlabeled-ray-with-index",{index:e.id}),_.length===1&&(T==null?void 0:T.type)==="expression"&&(((i=T==null?void 0:T.formula.geometry)==null?void 0:i.valueType)===__dcg_shared_module_exports__.Va||((o=T==null?void 0:T.formula.geometry)==null?void 0:o.valueType)===__dcg_shared_module_exports__.Xa)){let B=Fo(T,t,{includeDetails:!1,depth:a+1});s=t.s("graphing-calculator-narration-geometry-anglebisector-of-item",{bisectorDescription:s,item:B})}}else if(p===__dcg_shared_module_exports__.La){if(e.hidden&&a>=an?l.push(t.s("graphing-calculator-narration-geometry-hidden-segment")):v?s=t.s("graphing-calculator-narration-geometry-segment-with-assignment",{assignment:ei(v)}):F?s=t.s("graphing-calculator-narration-geometry-unlabeled-segment"):s=t.s("graphing-calculator-narration-geometry-unlabeled-segment-with-index",{index:e.id}),r.includeDetails&&a<an&&v===""&&d===void 0&&P!==void 0&&typeof g=="number"&&typeof f=="number"&&typeof y=="number"&&typeof E=="number"){let B=y-g,x=E-f,L=Math.sqrt(B*B+x*x);isNaN(L)||(s=t.s("graphing-calculator-narration-geometry-segment-length",{segmentDescription:s,length:Ao(__dcg_shared_module_exports__.ea(L,P.xmax-P.xmin).latex)}))}}else p===__dcg_shared_module_exports__.$a&&(e.hidden&&a>=an?l.push(t.s("graphing-calculator-narration-geometry-hidden-vector")):F?s=t.s("graphing-calculator-narration-geometry-unlabeled-vector"):s=t.s("graphing-calculator-narration-geometry-unlabeled-vector-with-index",{index:e.id}));return s!==""&&a<an&&(T!==void 0&&M!==void 0?l.push(t.s("graphing-calculator-narration-geometry-straight-from-item-to-item",{straightType:s,start:Fo(T,t,{includeDetails:!1,depth:a+1}),end:Fo(M,t,{includeDetails:!1,depth:a+1})})):F&&l.push(t.s("graphing-calculator-narration-geometry-straight-index-of-item",{straightType:s,index:d,item:Fo(T,t,{includeDetails:!1,depth:a+1})}))),!l.length&&s&&l.push(s),l}function YH(e,t,r){var n;let i=r.depth?r.depth:0,o=r.listIndex?r.listIndex:0,a="",s=[],{valueType:l}=Ap(e,r),c=FL(e,o)||e.label,d="",u=(n=t.getGrapher())==null?void 0:n.getGraphSketch(e.id);if(u&&"labels"in u){let E=u.labels[o];E&&"text"in E&&(d=ei(E.text))}l===__dcg_shared_module_exports__.Va?c?a=t.s("graphing-calculator-narration-geometry-labeled-angle",{label:ei(c)}):d?a=t.s("graphing-calculator-narration-geometry-unlabeled-angle-with-measurement",{index:e.id,measurementText:d}):a=t.s("graphing-calculator-narration-geometry-unlabeled-angle",{index:e.id}):l===__dcg_shared_module_exports__.Xa&&(c?a=t.s("graphing-calculator-narration-geometry-labeled-directed-angle",{label:ei(c)}):d?a=t.s("graphing-calculator-narration-geometry-unlabeled-directed-angle-with-measurement",{index:e.id,measurementText:d}):a=t.s("graphing-calculator-narration-geometry-unlabeled-directed-angle",{index:e.id}));let p=kb(e,t),[g,f,y]=p;return i<an&&g!==void 0&&"hidden"in g&&!g.hidden&&f!==void 0&&"hidden"in f&&!f.hidden&&y!==void 0&&"hidden"in y&&!y.hidden?s.push(t.s("graphing-calculator-narration-geometry-angle-through-points",{itemDescription:a,parent1:Fo(g,t,{includeDetails:!1,depth:i+1}),parent2:Fo(f,t,{includeDetails:!1,depth:i+1}),parent3:Fo(y,t,{includeDetails:!1,depth:i+1})})):i<an&&g!==void 0&&"hidden"in g&&!g.hidden&&f===void 0&&y===void 0?s.push(t.s("graphing-calculator-narration-geometry-angle-of-polygon",{itemDescription:a,parent:Fo(g,t,{includeDetails:!1,depth:i+1})})):s.push(a),s}function XH(e,t,r){let{value:n,valueType:i}=Ap(e,r),o=[],a=n.length;switch(__dcg_shared_module_exports__.xb(i)){case __dcg_shared_module_exports__.ya:o.push(t.s("graphing-calculator-narration-geometry-list-of-points",{count:a}));break;case __dcg_shared_module_exports__.Na:o.push(t.s("graphing-calculator-narration-geometry-list-of-circles",{count:a}));break;case __dcg_shared_module_exports__.Pa:o.push(t.s("graphing-calculator-narration-geometry-list-of-arcs",{count:a}));break;case __dcg_shared_module_exports__.Ja:o.push(t.s("graphing-calculator-narration-geometry-list-of-polygons",{count:a}));break;case __dcg_shared_module_exports__.Ra:o.push(t.s("graphing-calculator-narration-geometry-list-of-lines",{count:a}));break;case __dcg_shared_module_exports__.Ta:o.push(t.s("graphing-calculator-narration-geometry-list-of-rays",{count:a}));break;case __dcg_shared_module_exports__.La:o.push(t.s("graphing-calculator-narration-geometry-list-of-segments",{count:a}));break;case __dcg_shared_module_exports__.Va:o.push(t.s("graphing-calculator-narration-geometry-list-of-angles",{count:a}));break;case __dcg_shared_module_exports__.Xa:o.push(t.s("graphing-calculator-narration-geometry-list-of-directed-angles",{count:a}));break;default:o.push(t.s("graphing-calculator-narration-geometry-list-of-any",{count:a}));break}return o[0]=`${o[0]}.`,o}function Rg(e,t,r,n=3){let[i,o,a,s]=e,{x:l,y:c}=t.mathToPixels.mapPoint({x:i,y:o}),{x:d,y:u}=t.mathToPixels.mapPoint({x:a,y:s}),p=Math.min(n,Math.max(t.screen.width,t.screen.height)),g={xmin:-p,ymin:-p,xmax:t.screen.width+p,ymax:t.screen.height+p},f=l-d,y=c-u,E=-f,_=-y,w=l-g.xmin,v=g.xmax-l,T=c-g.ymin,M=g.ymax-c,C=[],P=[];if(f!==0){let z=w/f,V=v/E;f<0?(C.push(z),P.push(V)):(C.push(V),P.push(z))}if(y!==0){let z=T/y,V=M/_;y<0?(C.push(z),P.push(V)):(C.push(V),P.push(z))}(r===17||r===24)&&(C.push(0),P.push(1)),r===19&&C.push(0);let F=Math.max(...C),B=Math.min(...P);if(F>B)return{mapped:[l,c,d,u],clipped:[]};let x=l+E*F,L=c+_*F,N=l+E*B,O=c+_*B;return x<g.xmin&&N<g.xmin||x>g.xmax&&N>g.xmax||L<g.ymin&&O<g.ymin||L>g.ymax&&O>g.ymax?{mapped:[l,c,d,u],clipped:[]}:{mapped:[l,c,d,u],clipped:[x,L,N,O]}}var ca=class{constructor(e,t,r){this.pattern=r,this.replen=this.pattern[0]+this.pattern[1],t/this.replen>1e3&&(this.pattern[0]=t*this.pattern[0]/this.replen/1e3,this.pattern[1]=t*this.pattern[1]/this.replen/1e3),this.pstate=0,this.dstaccum=0,this.px=null,this.py=null,this.ctx=e}static getDashedPattern(e,t){let r=e.lineWidth*11/(t?3.5:2.5),n=r*7/11;return[r,n]}static getDottedPattern(e,t,r){let n=.5*e.lineWidth*.1/(r?3.5:2.5),i=n*8/.1;return t&&(i*=2),[n,i]}static getTotalSegmentLength(e){if(e.length<4)return 0;let t=0,r=0,n=e[0],i=e[1];for(;isNaN(n)||isNaN(i);){if(r+=2,r>=e.length)return 0;n=e[r],i=e[r+1]}let o,a;for(r+=2;r<e.length;r+=2)o=e[r],a=e[r+1],!(isNaN(o)||isNaN(a))&&(t+=__dcg_shared_module_exports__.S(o-n,a-i),n=o,i=a);return t}start(e,t){this.px=e,this.py=t}next(e,t){if(this.px===null||this.py===null)throw new Error("Must call start before calling next");let r=this.pattern[this.pstate],n=Math.sqrt(Math.pow(e-this.px,2)+Math.pow(t-this.py,2));if(n>1e-5){for(;n+this.dstaccum>=r;){let i=e-this.px,o=t-this.py,a=r-this.dstaccum;i*=a/n,o*=a/n,this.pstate===0&&(this.ctx.moveTo(this.px,this.py),this.ctx.lineTo(this.px+i,this.py+o)),this.dstaccum=0,this.px+=i,this.py+=o,this.pstate=this.pstate===0?1:0,r=this.pattern[this.pstate],n-=a}this.pstate===0&&(this.ctx.moveTo(this.px,this.py),this.ctx.lineTo(e,t))}this.px=e,this.py=t,this.dstaccum+=n}close(){this.pstate=0,this.dstaccum=0,this.px=null,this.py=null}drawSegment(e){let t=0,r=e[0],n=e[1];for(;isNaN(r)||isNaN(n);){if(t+=2,t>=e.length)return;r=e[t],n=e[t+1]}this.start(r,n);let i,o;for(t+=2;t<e.length;t+=2)i=e[t],o=e[t+1],!(isNaN(i)||isNaN(o))&&this.next(i,o);this.close()}};function No(e,t){let r=e;r._dcgSaveClassName&&r._dcgSaveClassName(t)}function To(e){let t=e;t._dcgRestoreClassName&&t._dcgRestoreClassName()}var Mp,Fg=new Map,MT=0;function JH(e,t,r){let n=e.imageObj;if(Mp&&Mp.color===t&&Mp.img===n)return Mp.canvas;Mp?(Mp.color=t,Mp.img=n):Mp={color:t,img:n,canvas:document.createElement("canvas")};let i=Mp.canvas,o=e.mimeType==="image/svg+xml";i.width=0,i.width=o?r.width:n.width,i.height=o?r.height:n.height;let a=i.getContext("2d");return a.drawImage(n,0,0,i.width,i.height),a.fillStyle=t,a.globalCompositeOperation="source-atop",a.fillRect(0,0,i.width,i.height),i}function Rte(e,t){if(t.width*t.height>1e3*1e3*window.devicePixelRatio*window.devicePixelRatio)return e.imageObj;let r=e.image_url,n=Fg.get(r),i;if(!n||t.width!==n.size.width||t.height!==n.size.height){n&&(Fg.delete(r),MT-=n.canvas.width*n.canvas.height);let o=e.imageObj,a=document.createElement("canvas");a.width=t.width,a.height=t.height,a.getContext("2d").drawImage(o,0,0,a.width,a.height);let s=20*1e3*1e3;if(a.width*a.height>s)return e.imageObj;for(MT+=a.width*a.height;MT>s;){let[l,c]=Array.from(Fg)[0];Fg.delete(l),MT-=c.canvas.width*c.canvas.height}Fg.set(r,{canvas:a,size:t}),i=a}else Fg.delete(r),Fg.set(r,n),i=n.canvas;return i}function QH(e,t,r,n={cacheRenderedSvgs:!1}){let{ctx:i,projection:o}=e,a=t.formula;if(!a||!a.dimensions.x)return;let s=a.dimensions;for(let l=0;l<s.x.length;l++){let c=s.x[l],d=s.y[l],u=s.width[l],p=s.height[l],g=s.radianAngle[l];if(!isFinite(c)||!isFinite(d)||!isFinite(u)||!isFinite(p)||!isFinite(g))continue;No(i,"dcg-svg-image"),i.save(),To(i),i.globalAlpha=s.opacity[l];let f=o.mapy(p)-o.mapy(0),y=o.mapx(u)-o.mapx(0),E=g===0?1:Math.abs(y/u*(p/f)),_=o.mapx(c),w=o.mapy(d),v=_-y/2,T=w+f*E/2,M=p<0?-1:1,C=u<0?-1:1,P=v*C,F=T*M,B=Math.abs(y),x=Math.abs(f);g!==0&&(i.translate(_,w),i.scale(1,1/E),i.rotate(g),i.translate(-_,-w)),i.scale(C,M);let L=r.shouldDrawHovered(e,t.id,l),N=r.shouldDrawPressed(t.id,l),O=n.currentKeyboardAttention&&n.currentKeyboardAttention.calcId===t.id&&(n.currentKeyboardAttention.listIndex===void 0||n.currentKeyboardAttention.listIndex===l),z=t.imageObj,V=window.devicePixelRatio*(o.screen.width/o.screen.height),$={width:Math.floor(B*V),height:Math.floor(x*V)};N?t.depressedImageObj?z=t.depressedImageObj:z=JH(t,"rgba(50,50,50,0.2)",$):L?t.hoveredImageObj?z=t.hoveredImageObj:z=JH(t,"rgba(200,200,200,0.2)",$):n.cacheRenderedSvgs&&t.mimeType==="image/svg+xml"&&$.width>0&&$.height>0&&(z=Rte(t,$)),i.drawImage(z,P,F,B,x*E);let G=0,W=3;if(Sa(t)&&t.controller.isTraceEnabled()&&(i.beginPath(),i.rect(P-G,F-G,B+2*G,x*E+2*G),i.restore(),i.save(),i.strokeStyle="#6993C7",i.lineWidth=W,i.stroke()),O){let U=i.globalAlpha;G=5,i.beginPath(),i.roundRect?i.roundRect(P-G,F-G,B+2*G,x*E+2*G,G):i.rect(P-G,F-G,B+2*G,x*E+2*G),i.restore(),i.save(),i.strokeStyle=__dcg_shared_module_exports__.Rd.FOCUS_OUTLINE,i.globalAlpha=1,i.lineWidth=W,i.stroke(),i.globalAlpha=U}i.restore()}}function ZH(e){return e.uncommitted?"#ccc":!e.selected&&!e.hovered&&e8(e)===1?__dcg_shared_module_exports__.Kd(e.color,.2):e.color}function e8(e){let t=.6;return e.hidden?e.selected?t=.4:t=.25:e.selected||e.isPoint?t=1:e.hovered&&(t=.8),e.isTransparentObject&&(t*=.3),t}function Fte(e){return e.hidden?e.isPoint?0:e.selected?.3:.2:e.selected||e.isPoint||e.hovered?1:.7}function t8(e,t){e=e.replace(/#/,"");let r,n,i;return e.length===3?(r=parseInt(e.slice(0,1)+e.slice(0,1),16),n=parseInt(e.slice(1,2)+e.slice(1,2),16),i=parseInt(e.slice(2,3)+e.slice(2,3),16)):e.length===6?(r=parseInt(e.slice(0,2),16),n=parseInt(e.slice(2,4),16),i=parseInt(e.slice(4,6),16)):(r=0,n=0,i=0),`rgba(${r}, ${n}, ${i}, ${t})`}function tv(e){return t8(ZH(e),Fte(e))}function GT(e){return t8(ZH(e),e8(e))}function LT(e){return Math.abs(Math.abs(e)-Math.PI/2)<1e-6}function Ja(e,t){let r=e;r._dcgStartNamedGroup&&r._dcgStartNamedGroup(t)}function rv(e,t){let r=e;r._dcgSetTitle&&r._dcgSetTitle(t)}function Qa(e){let t=e;t._dcgEndNamedGroup&&t._dcgEndNamedGroup()}var Xu=10,Ju=3;function VT(e,t){return e+1e-8*(t-e)>e&&t-e>1e-300&&t-e<1e300}function r8(e,t){return e>1e-300&&VT(e,t)}var Br=class Ci{constructor(t=-10,r=10,n=-10,i=10,o=-2,a=2){this.xmin=t,this.xmax=r,this.ymin=n,this.ymax=i,this.zmin=o,this.zmax=a}static fromObject({xmin:t,xmax:r,ymin:n,ymax:i,zmin:o,zmax:a}){return new Ci(t,r,n,i,o,a)}toObject(){return{xmin:this.xmin,ymin:this.ymin,zmin:this.zmin,xmax:this.xmax,ymax:this.ymax,zmax:this.zmax}}equals(t){return!(this.xmin!==t.xmin||this.ymin!==t.ymin||this.zmin!==t.zmin||this.xmax!==t.xmax||this.ymax!==t.ymax||this.zmax!==t.zmax)}isXValid(t){return t==="linear"?VT(this.xmin,this.xmax):r8(this.xmin,this.xmax)}isYValid(t){return t==="linear"?VT(this.ymin,this.ymax):r8(this.ymin,this.ymax)}isZValid(){return this.zmin===void 0||this.zmax===void 0?!1:VT(this.zmin,this.zmax)}isValid(t){return this.isXValid(t.xAxisScale)&&this.isYValid(t.yAxisScale)}isSquare(t,r){return Math.abs(t.height-t.width*this.aspectRatio(r))<1}isSquare3D(){let{xmin:t,xmax:r,ymin:n,ymax:i,zmin:o,zmax:a}=this;if(o===void 0||a===void 0)return!1;let s=[r-t,i-n,a-o];return Math.min(...s)/Math.max(...s)>.99999}aspectRatio(t){let r=Xu/Ju,n=t.yAxisScale==="linear"?this.ymax-this.ymin:Math.log10(this.ymax/this.ymin)*r,i=t.xAxisScale==="linear"?this.xmax-this.xmin:Math.log10(this.xmax/this.xmin)*r;return n/i}getSquaredAxisLimits({axis:t,screen:r,settings:n}){let[i,o,a,s,l]=t==="y"?[{min:this.ymin,max:this.ymax},{min:this.xmin,max:this.xmax},r.height/r.width,n.yAxisScale,n.xAxisScale]:[{min:this.xmin,max:this.xmax},{min:this.ymin,max:this.ymax},r.width/r.height,n.xAxisScale,n.yAxisScale];if(s==="logarithmic"){let d=l==="logarithmic"?Math.log(o.max)-Math.log(o.min):(o.max-o.min)*Ju/(Xu*Math.LOG10E),{min:u,max:p}=o8({min:Math.log(i.min),max:Math.log(i.max)},a*d);return{min:Math.exp(u),max:Math.exp(p)}}let c=l==="logarithmic"?(Math.log10(o.max)-Math.log10(o.min))*Xu/Ju:o.max-o.min;return o8(i,c*a)}squareXAxis(t,r){let{min:n,max:i}=this.getSquaredAxisLimits({axis:"x",screen:t,settings:r}),o=new Ci(n,i,this.ymin,this.ymax);return o.isXValid(r.xAxisScale)?o:this}squareYAxis(t,r){let{min:n,max:i}=this.getSquaredAxisLimits({axis:"y",screen:t,settings:r}),o=new Ci(this.xmin,this.xmax,n,i);return o.isYValid(r.yAxisScale)?o:this}squareCrop(t,r){return this.aspectRatio({xAxisScale:r.xAxisScale,yAxisScale:r.yAxisScale})>t.height/t.width?this.squareYAxis(t,r):this.squareXAxis(t,r)}polarDiameter(){let t=Math.abs(this.xmax),r=Math.abs(this.xmin),n=Math.abs(this.ymax),i=Math.abs(this.ymin);return 1.5*Math.max(t,r,n,i)}largestR(){return Math.sqrt(Math.pow(Math.max(-this.xmin,this.xmax),2)+Math.pow(Math.max(-this.ymin,this.ymax),2))}smallestR(){return this.xmin<=0&&this.xmax>=0&&this.ymin<=0&&this.ymax>=0?0:this.xmin<=0&&this.xmax>=0?Math.min(Math.abs(this.ymin),Math.abs(this.ymax)):this.ymin<=0&&this.ymax>=0?Math.min(Math.abs(this.xmin),Math.abs(this.xmax)):Math.sqrt(Math.pow(Math.max(this.xmin,-this.xmax),2)+Math.pow(Math.max(this.ymin,-this.ymax),2))}};function o8(e,t){let r=.5*(e.min+e.max),[n,i]=[r-.5*t,r+.5*t];return Math.abs((i-n)/t-1)>.1?{min:-.5*t,max:.5*t}:{min:n,max:i}}var OT=1.4,n8=1.5,FT={};function d8(e={}){return Object.keys(e).length}function RT(e,t={}){return d8(t)===0?e:e.filter((r,n)=>!t[n])}function a8(e,t){let r=[];for(let n=0;n<e;n++)r.push(t);return r}function zte(){return!!Object.keys(FT).length}var p8=function(e,t){let r=3;return t&&(r+=t),new Br(-r,e.width+r,-r,e.height+r)};function s8(e,t){let{displayAsRightAngle:r,rx:n,ry:i,startAngle:o,deltaAngle:a,yscreen:s,xscreen:l}=e;if(r){let c=n*Math.cos(-o),d=n*Math.cos(-o-a),u=i*Math.sin(-o),p=i*Math.sin(-o-a);t.moveTo(l+c,s+u),t.lineTo(l+c+d,s+u+p),t.lineTo(l+d,s+p)}else t.ellipse(l,s,n,i,0,-o,-o-a,a>0)}var Td=class Rr{constructor(t,r,n){if(this.controller=t,this.getExpressionAriaLabel=n,r.config.plaidMode){let i=["RED","BLUE","GREEN","PURPLE","ORANGE","BLACK"];for(let o of i)FT[__dcg_shared_module_exports__.Rd[o]]=document.createElement("img"),FT[__dcg_shared_module_exports__.Rd[o]].setAttribute("src","/assets/img/april-fools/"+o.toLowerCase()+".png")}}redrawToCtx(t,r,n,i,o,a){let{ctx:s,projection:l}=t;Ja(s,"expressions");let c=l.settings.highlight,d=this.controller.isGeometry();i.forEach(u=>{let p=r[u],g=n[u];p!==void 0&&(d&&l.settings.setProperty("highlight",p.showHighlight),Ja(s,"sketch"),l.settings.takingScreenshot&&rv(s,this.getExpressionAriaLabel(u)),Rr.drawSketchToCtx({sketch:r[u],drawContext:t,poiLabelsLayer:o,clickableObjectsLayer:a,geometryContext:this.controller.getGeoModel()}),Qa(s)),g&&g.shouldGraph&&QH(t,g,a,{currentKeyboardAttention:this.controller.get2dPOIController().keyboardAttentionManager.getKeyboardAttention(),cacheRenderedSvgs:this.controller.getGraphSettings().config.cacheRenderedSvgs})}),Qa(s),l.settings.setProperty("highlight",c)}static eachSegment(t,r){for(let n of t.branches)if(n.graphMode!==15)for(let i of n.segments)r(n,i)}static drawSketchToCtx({sketch:t,drawContext:r,poiLabelsLayer:n,clickableObjectsLayer:i,geometryContext:o}){var a,s,l,c,d;if(!t.branches||!t.branches.length)return;let{ctx:u,projection:p}=r,g=u.lineWidth,f=u.globalAlpha,y=p.settings.globalCurveColor?p.settings.globalCurveColor:t.color,E=FT[y],_;E&&E.complete&&E.naturalWidth>0?_=u.createPattern(E,"repeat"):_=y,u.lineJoin="round",u.lineCap="round";for(let w of t.branches){if(__dcg_shared_module_exports__._d(w)||w.graphMode===15||w.graphMode===22)continue;let v=1;i.shouldDrawHovered(r,t.id,w.listIndex)&&(v=XS.IS_HOVERED),i.shouldDrawPressed(t.id,w.listIndex)&&(v=XS.IS_PRESSED),i.shouldDrawGhosted(t.id)&&(v=XS.IS_GHOSTED),v*=(a=o==null?void 0:o.getToolFadeOpacity(t.id))!=null?a:1,v*=p.settings.getFillOpacityMultiplier(),u.strokeStyle=y,u.fillStyle=w.color&&!p.settings.globalCurveColor&&!zte()?w.color:_,w.graphMode!==6&&(u.desmos_batching=!0,u.beginPath());let T=w.graphMode===6?.2:(s=w.fillOpacity)!=null?s:NaN;u.globalAlpha=Rr._clampedOpacity(T*v,.4);let M=JL(p,w);for(let C of M)Rr.fillPolygonFillToCtx(u,C);w.graphMode!==6&&(u.fill(),u.desmos_batching=!1),u.globalAlpha=1;for(let C of w.segments){let P=2;w.graphMode&&(P=w.graphMode);let F=C,B=w.lineWidth!==void 0,x=w.lineWidth,L=2.5,N=(l=w.arrowMode)!=null?l:"DEFAULT";if(u.strokeStyle=w.color,u.fillStyle=w.color,B&&(x<=0||!isFinite(x)))continue;u.lineWidth=B?x:L;let O=p.settings.graphLineWidth/L,z=1.3;p.settings.highlight&&(z*=5/7),t.tokenSelected?(O*=n8,z/=n8):t.tokenHovered&&(O*=OT,z/=OT),u.lineWidth*=O,u.globalAlpha*=p.settings.curveOpacity,u.globalAlpha=Rr._clampedOpacity(p.settings.curveOpacity===1?1:w.lineOpacity,1);let V=w.operator,$="default";V==="<"||V===">"||V==="!="?$="DASHED":V==="<="||V===">="?$="SOLID":t.style==="DASHED"||w.style==="DASHED"?$="DASHED":(t.style==="DOTTED"||w.style==="DOTTED")&&($="DOTTED",B&&(u.lineWidth*=2)),u.globalAlpha*=(c=o==null?void 0:o.getToolFadeOpacity(t.id))!=null?c:1;let G=!w.isIntersectionExtension&&i.shouldDrawHovered(r,t.id,w.listIndex),W=!w.isIntersectionExtension&&i.shouldDrawPressed(t.id,w.listIndex),U=i.shouldDrawGhosted(t.id);U?u.globalAlpha*=_G.IS_GHOSTED:(W||G)&&(u.save(),u.lineWidth+=4.5,u.globalAlpha*=W?lw.IS_DEPRESSED:lw.IS_HOVERED,Rr.drawGraphStrokeToCtx(u,p,F,{type:$,graphMode:P,op:V,arrowMode:N,arrowHeadBaseWidth:(u.lineWidth-4.5)*z,opacityMultiplier:W?lw.IS_DEPRESSED:lw.IS_HOVERED}),u.restore()),Rr.drawGraphStrokeToCtx(u,p,F,{type:$,graphMode:P,op:V,arrowMode:N,arrowHeadBaseWidth:u.lineWidth*z,opacityMultiplier:((d=o==null?void 0:o.getToolFadeOpacity(t.id))!=null?d:1)*(U?_G.IS_GHOSTED:cw)})}}u.lineWidth=g,u.globalAlpha=f,u.strokeStyle=y,Rr.eachSegment(t,(w,v)=>{var T;if((w.graphMode===3||w.graphMode===25)&&w.showPoint){let M=v,C=[],P;if(w.interactiveLabel&&t.labels)for(let $=0,G=t.labels.length;$<G;$++){let W=t.labels[$];if(W.type==="poi"){let U=n.isOpenPOI(W.poi),D=n.getHoveredPOI()===W.poi;C.push(U||D),!U&&D&&(P=$)}}let F=1;typeof w.pointSize=="number"?F=w.pointSize/8:Array.isArray(w.pointSize)&&(F=w.pointSize.map($=>$/8));let B;Array.isArray(w.color)&&(B=w.color);let x=i.getHoveredObjectById(t.id),L=i.shouldDrawHovered(r,t.id,void 0),N=i.getPressedObject(),O=i.shouldDrawPressed(t.id,N==null?void 0:N.listIndex),z=i.shouldDrawGhosted(t.id),V=w.droppedIndices;if((L||O)&&!z){let $=M.length;V&&($+=d8(V));let G=a8($,0),W=Array.isArray(F)?F.slice():a8($,F);O&&N?N.listIndex===void 0?(G=G.map(()=>JS.IS_DEPRESSED),W=W.map(U=>U*1.5)):(G[N.listIndex]=JS.IS_DEPRESSED,W[N.listIndex]*=1.5):L&&x&&(G=G.map((U,D)=>x.listIndexes===void 0||x.listIndexes[D]?JS.IS_HOVERED:U),W=W.map((U,D)=>x.listIndexes===void 0||x.listIndexes[D]?U*1.5:U)),Rr.drawPointsToCtx({ctx:u,projection:p,segment:M,style:w.style,sizeOverrideIdxs:C,opacityOverrideIdx:P,sizeFactor:W,opacityFactor:G,colorOverrides:B,baseOpacity:w.pointOpacity,droppedIndices:V,sketch:t,isKeyboardFocused:i.isKeyboardFocused(t.id,void 0)}),u.restore()}Rr.drawPointsToCtx({ctx:u,projection:p,segment:M,style:w.style,sizeOverrideIdxs:C,opacityOverrideIdx:P,sizeFactor:F,opacityFactor:((T=o==null?void 0:o.getToolFadeOpacity(t.id))!=null?T:1)*(z?QS.IS_GHOSTED:cw),colorOverrides:B,baseOpacity:w.pointOpacity,droppedIndices:V,sketch:t})}})}static drawGraphStrokeToCtx(t,r,n,i){let o={arrowHeadBaseWidth:t.lineWidth},{type:a,graphMode:s,op:l,arrowMode:c,arrowHeadBaseWidth:d}=Object.assign({},o,i);if(s===20||s===21){let[y,E,_]=n,w=r.mathToPixels.mapX(y),v=r.mathToPixels.mapY(E),T=r.mathToPixels.dangerouslyGetXScaleFactor(),M=r.mathToPixels.dangerouslyGetYScaleFactor(),C=Math.abs(_*T),P=Math.abs(_*M),F,B;if(s===21?(F=-n[3],B=-n[4]):(F=0,B=2*Math.PI),t.save(),No(t,"dcg-svg-curve"),t.desmos_batching||t.beginPath(),a==="DASHED"){let x=ca.getDashedPattern(t,!!r.settings.highlight);t.setLineDash(x)}else if(a==="DOTTED"){let x=ca.getDottedPattern(t,!!r.settings.config.projectorMode,!!r.settings.highlight);t.setLineDash(x)}t.ellipse(w,v,C,P,0,F,B,F>B),t.desmos_batching||t.stroke(),To(t),t.restore();return}else if(s===23){let[y,E,_,w,v]=n,T=!v&&LT(w),M=Zu(w,r),C=r.mathToPixels.mapX(y),P=r.mathToPixels.mapY(E),F=r.mathToPixels.dangerouslyGetXScaleFactor(),B=r.mathToPixels.dangerouslyGetYScaleFactor(),x=F>B?F/B:1,L=F>B?1:B/F,N=Math.abs(x*M),O=Math.abs(L*M);if(t.save(),No(t,"dcg-svg-curve"),t.globalAlpha=.4*i.opacityMultiplier,t.desmos_batching||t.beginPath(),t.moveTo(C,P),t.lineTo(C+N*Math.cos(-_),P+O*Math.sin(-_)),s8({displayAsRightAngle:T,rx:N,ry:O,startAngle:_,deltaAngle:w,yscreen:P,xscreen:C},t),t.lineTo(C,P),!t.desmos_batching&&!v&&t.fill(),t.globalAlpha=i.opacityMultiplier,t.desmos_batching||t.beginPath(),s8({displayAsRightAngle:T,rx:N,ry:O,startAngle:_,deltaAngle:w,yscreen:P,xscreen:C},t),v){let z=-_-w,V=C+N*Math.cos(z),$=P+O*Math.sin(z);QL(t,V,$,-_,-w,10,N)}t.globalAlpha=i.opacityMultiplier,t.desmos_batching||t.stroke(),t.lineWidth=1.5,t.globalAlpha=.2*i.opacityMultiplier,t.moveTo(C+1.5*N*Math.cos(-_),P+1.5*O*Math.sin(-_)),t.lineTo(C,P),t.lineTo(C+1.5*N*Math.cos(-_-w),P+1.5*O*Math.sin(-_-w)),t.stroke(),To(t),t.restore()}else if(s===17||s===18||s===19||s===24){let{clipped:y,mapped:E}=Rg(n,r,s,t.lineWidth);if(y.length===0)return;let[_,w,v,T]=y,[M,C,P,F]=E;t.save(),No(t,"dcg-svg-curve");let B;if(t.desmos_batching||t.beginPath(),a=="DASHED"?(B=new ca(t,ca.getTotalSegmentLength(y),ca.getDashedPattern(t,!!r.settings.highlight)),B.drawSegment(y)):a=="DOTTED"?(B=new ca(t,ca.getTotalSegmentLength(y),ca.getDottedPattern(t,!!r.settings.config.projectorMode,!!r.settings.highlight)),B.drawSegment(y)):(t.moveTo(_,w),t.lineTo(v,T)),s===17){let x=l8(a)*d,{startArrow:L,endArrow:N}=Wte(Kte(s,c));L&&xc(t,P,F,M,C,x),N&&xc(t,M,C,P,F,x)}else if(s===24&&(M!==P||C!==F)){let x=l8(a)*d;xc(t,M,C,P,F,x)}t.desmos_batching||t.stroke(),To(t),t.restore();return}let u=Rx(s,l!=="=",r.settings),p=vu(n,r.mathToPixels,u),g=Q3(p,p8(r.screen,t.lineWidth));if(g.length===0)return;t.save(),No(t,"dcg-svg-curve");let f;if(t.desmos_batching||t.beginPath(),a=="DASHED")f=new ca(t,ca.getTotalSegmentLength(g),ca.getDashedPattern(t,!!r.settings.highlight)),f.drawSegment(g);else if(a=="DOTTED")f=new ca(t,ca.getTotalSegmentLength(g),ca.getDottedPattern(t,!!r.settings.config.projectorMode,!!r.settings.highlight)),f.drawSegment(g);else if((a==="SOLID"||a==="default")&&t.lineWidth===1)if(g.length>4||g[0]!==g[2]&&g[1]!==g[3]){t.moveTo(g[0],g[1]);for(let y=0;y<g.length;y+=2)t.lineTo(g[y],g[y+1])}else{t.moveTo(__dcg_shared_module_exports__.Z(g[0]),__dcg_shared_module_exports__.Z(g[1]));for(let y=0;y<g.length;y+=2)t.lineTo(__dcg_shared_module_exports__.Z(g[y]),__dcg_shared_module_exports__.Z(g[y+1]))}else{t.moveTo(g[0],g[1]);for(let y=0;y<g.length;y+=2)t.lineTo(g[y],g[y+1])}t.desmos_batching||t.stroke(),To(t),t.restore()}static mapPointToScreen(t,r,n){let i=t.mapx(r);if(i<-20||i>t.screen.width+20)return null;let o=t.mapy(n);return o<-20||o>t.screen.height+20?null:{x:i,y:o}}static drawPointToCtx(t){let{ctx:r,projection:n,sketch:i,x:o,y:a}=t,{sizeFactor:s}=t,l=r.lineWidth,c=r.fillStyle,d=r.strokeStyle,u=Rr.mapPointToScreen(n,o,a);if(!u||t.sizeFactor!==void 0&&(t.sizeFactor<=0||!isFinite(t.sizeFactor)))return!1;No(r,"dcg-svg-point"),t.alpha!==void 0?r.globalAlpha=t.alpha:r.globalAlpha=.9,t.opacityFactor!==void 0&&(r.globalAlpha*=t.opacityFactor),r.desmos_batching||r.beginPath();let p=n.settings.pointLineWidth;if(t.overrideSize&&(p=n.settings.config.projectorMode?17:11,r.lineWidth=p),i.tokenSelected?s?s*=1.5:s=1.5:i.tokenHovered&&(s?s*=OT:s=OT),s!==void 0&&(p*=s,r.lineWidth=p),t.colorOverride&&(r.fillStyle=t.colorOverride,r.strokeStyle=t.colorOverride),t.finalHardcodedSize!==void 0&&(p=t.finalHardcodedSize,r.lineWidth=p),t.style==="CROSS"){let g=p*.4;r.moveTo(u.x-g,u.y-g),r.lineTo(u.x+g,u.y+g),r.moveTo(u.x+g,u.y-g),r.lineTo(u.x-g,u.y+g),r.lineWidth=p*.3}else if(t.style==="OPEN"){let g=p*.42;r.moveTo(u.x+g,u.y),r.arc(u.x,u.y,g,0,Math.PI*2,!0),r.closePath(),r.fillStyle="white",r.lineWidth=p*.25,r.fill()}else r.moveTo(u.x-.1,u.y-.1),r.lineTo(u.x-.1,u.y+.1),r.lineTo(u.x+.1,u.y+.1),r.lineTo(u.x+.1,u.y-.1);if(r.desmos_batching||r.stroke(),r.globalAlpha=1,t.isKeyboardFocused){let g=p/2+6;r.lineWidth=2,r.strokeStyle="#6A93D2",r.beginPath(),r.moveTo(u.x+g,u.y),r.arc(u.x,u.y,g,0,Math.PI*2,!0),r.stroke(),r.closePath()}return r.lineWidth=l,r.fillStyle=c,r.strokeStyle=d,To(r),!0}static drawPointsToCtx(t){let{ctx:r,projection:n,segment:i,style:o,sizeOverrideIdxs:a,opacityOverrideIdx:s,sizeFactor:l,opacityFactor:c,colorOverrides:d,baseOpacity:u,droppedIndices:p}=t,g=r.lineWidth;r.lineWidth=n.settings.pointLineWidth;let f;Array.isArray(u)?(f=u.map(y=>Rr._clampedOpacity(y,.9)),f=RT(f,p)):f=Rr._clampedOpacity(u,.9),Array.isArray(l)&&(l=RT(l,p)),Array.isArray(c)&&(c=RT(c,p)),d&&(d=RT(d,p));for(let y=0;y<i.length;y++)Rr.drawPointToCtx({ctx:r,projection:n,sketch:t.sketch,x:i[y][0],y:i[y][1],alpha:s===y?.6:Array.isArray(f)?f[y]:f,style:o,overrideSize:a[y],sizeFactor:Array.isArray(l)?l[y]:l,opacityFactor:Array.isArray(c)?c[y]:c,colorOverride:d&&d[y],isKeyboardFocused:t.isKeyboardFocused});r.lineWidth=g}static fillPolygonFillToCtx(t,r){if(r.length>=6){No(t,"dcg-svg-region"),t.desmos_batching||t.beginPath(),t.moveTo(r[0],r[1]);for(let n=2;n<r.length;n+=2)t.lineTo(r[n],r[n+1]);t.lineTo(r[0],r[1]),t.desmos_batching||t.fill(),To(t)}}static _clampedOpacity(t,r){return typeof t!="number"?r:t<0?0:t>1?1:isFinite(t)?t:r}};function*qte(e,t){let r=t.graphMode,n=t.operator,i=n=="<"||n==">"||n=="<="||n==">=",o=!e.settings.disableFill&&(r===7||i),a=n=="<="||n=="<";if(o)for(let s of t.segments)switch(r){case 6:{let l=a?0:e.viewport.polarDiameter(),c=e.settings.degreeMode?180:2*Math.PI;yield*wn(lN(s,l,c));break}case 2:{let l=a?e.viewport.ymin:e.viewport.ymax;yield*wn(xM(s,l));break}case 1:{let l=a?e.viewport.xmin:e.viewport.xmax;yield*wn(xM(s,l));break}case 7:yield s}}function Hte(e){switch(e){case 2:return $3;case 1:return W3;case 6:case 7:default:return zC}}function*JL(e,t){let r=t.graphMode;if(r!==1&&r!==2&&r!==6&&r!==7)return;let n=p8(e.screen);for(let i of qte(e,t)){let o=r===7?lg:Rx(r,!0,e.settings),a=vu(i,e.mathToPixels,o);yield yM(a,n,Hte(t.graphMode),!1)}}function Kte(e,t){return e===17?t==="DEFAULT"?"NONE":t:"NONE"}function Wte(e){switch(e){case"NONE":return{startArrow:!1,endArrow:!1};case"POSITIVE":return{startArrow:!1,endArrow:!0};case"BOTH":return{startArrow:!0,endArrow:!0};default:let t=e;throw new Error("Unexpected arrowMode: "+t)}}function l8(e){switch(e){case"default":case"SOLID":case"DASHED":return 4;case"DOTTED":return 2;default:let t=e;throw new Error("Unexpected line style "+t)}}function xc(e,t,r,n,i,o){let a=Math.atan2(i-r,n-t),s=n-o*Math.cos(a-Math.PI/9),l=i-o*Math.sin(a-Math.PI/9),c=n-o*Math.cos(a+Math.PI/9),d=i-o*Math.sin(a+Math.PI/9),u=n-(o-2)*Math.cos(a-Math.PI/18),p=i-(o-2)*Math.sin(a-Math.PI/18),g=n-(o-2)*Math.cos(a+Math.PI/18),f=i-(o-2)*Math.sin(a+Math.PI/18);e.moveTo(n,i),e.lineTo(s,l),e.lineTo(c,d),e.lineTo(n,i),e.lineTo(u,p),e.lineTo(g,f),e.lineTo(n,i)}function QL(e,t,r,n,i,o,a){let s=n+i,l=o*Math.min(1,Math.max(.5,Math.abs(i)/.8)),c=i<=0,d=Math.PI/2;a<25?d+=.25:d+=.1,c||(d*=-1);let u=t+Math.cos(s+d),p=r+Math.sin(s+d);xc(e,u,p,t,r,l)}function Zu(e,t){let r=20;return t.settings.config.projectorMode&&(r*=1.4),r}var Pr=__dcg_shared_module_exports__.e(ne());function $te(e,t){let r=document.createRange();r.selectNode(e);let n=r.getBoundingClientRect();if(!(n.width>0&&n.height>0))return;let i=window.getComputedStyle(e.parentElement),o=e.nodeValue||"";if(!o)return;let a=-.228*parseFloat(i.fontSize),s=i.fontStyle+" "+i.fontWeight+" "+i.fontSize+" "+i.fontFamily,l=n.left-t.originX,c=n.top-t.originY,d;if(i.transform!=="none"){let u=i.transform.match(/^matrix\(([\d.-]+), *([\d.-]+), *([\d.-]+), *([\d.-]+), *([\d.-]+), *([\d.-]+)\)$/);if(u){let p=i.transformOrigin.match(/^([\d.-]+)px ([\d.-]+)px$/);p&&(d={matrix:[parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]),parseFloat(u[4]),parseFloat(u[5]),parseFloat(u[6])],origin:{x:parseFloat(p[1]),y:parseFloat(p[2])}})}}return{type:"text",text:o,color:i.color||"#000",font:s,x:l,y:c+n.height+a,hasOutline:t.hasOutline,transform:d}}function h8(e,t){e.beginPath();for(let r of t.instructions)switch(r.type){case"moveTo":e.moveTo(r.x,r.y);break;case"lineTo":e.lineTo(r.x,r.y);break;case"arcTo":e.arcTo(r.cx,r.cy,r.x,r.y,r.radius);break;case"ellipse":e.ellipse(r.centerX,r.centerY,r.radiusX,r.radiusY,r.rotation,r.startAngle,r.endAngle,r.anticlockwise);break}e.closePath()}function jte(e,t){let r=e.getBoundingClientRect();if(!(r.width>0&&r.height>0))return;let n=5,i=3,o=r.left-t.originX,a=r.top-t.originY,s=-n+o,l=r.width+n+o,c=-n+a,d=r.height+n+a;return{type:"path",hasOutline:!1,instructions:[{type:"moveTo",x:s+i,y:c},{type:"lineTo",x:l-i,y:c},{type:"arcTo",cx:l,cy:c,x:l,y:c+i,radius:i},{type:"lineTo",x:l,y:d-i},{type:"arcTo",cx:l,cy:d,x:l-i,y:d,radius:i},{type:"lineTo",x:s+i,y:d},{type:"arcTo",cx:s,cy:d,x:s,y:d-i,radius:i},{type:"lineTo",x:s,y:c+i},{type:"arcTo",cx:s,cy:c,x:s+i,y:c,radius:i}],strokeColor:"#C2C2C2",fillColor:"rgba(255,255,255,.75)"}}function Yte(e,t){let r=e.getBoundingClientRect();if(!(r.width>0&&r.height>0))return;let n=15,i=5,o=2,a="#5a87cd",s=3,l=r.left-t.originX-n,c=r.top-t.originY-i,d=l+r.width+2*n,u=c+r.height+2*i,p=l+s,g=d-s,f=c+s,y=u-s,E=[{type:"moveTo",x:p,y:c},{type:"lineTo",x:g,y:c},{type:"arcTo",x:d,y:f,radius:s,cx:d,cy:c},{type:"lineTo",x:d,y},{type:"arcTo",x:g,y:u,radius:s,cx:d,cy:u},{type:"lineTo",x:p,y:u},{type:"arcTo",x:l,y,radius:s,cx:l,cy:u},{type:"lineTo",x:l,y:f},{type:"arcTo",x:p,y:c,radius:s,cx:l,cy:c}];s-=o,l+=o,c+=o,d-=o,u-=o,p=l+s,g=d-s,f=c+s,y=u-s;let _=[{type:"moveTo",x:p,y:c},{type:"arcTo",x:l,y:f,radius:s,cx:l,cy:c},{type:"lineTo",x:l,y},{type:"arcTo",x:p,y:u,radius:s,cx:l,cy:u},{type:"lineTo",x:g,y:u},{type:"arcTo",x:d,y,radius:s,cx:d,cy:u},{type:"lineTo",x:d,y:f},{type:"arcTo",x:g,y:c,radius:s,cx:d,cy:c},{type:"lineTo",x:p,y:c}];return{type:"path",instructions:E.concat(_),fillColor:a,hasOutline:!1}}function g8(e,t){if(e==="0px 0px")return;let r=e.match(/^([^ ]+) +(.+)$/);if(!r)return;let n=r[1],i=r[2],o=parseFloat(n),a=parseFloat(i);if(n.endsWith("%")&&(o*=t.width/100),n.endsWith("%")&&(a*=t.height/100),!(o===0||a===0))return[o,a]}function Xte(e,t,r){if(t.borderTopWidth==="0px")return;let n=e.getBoundingClientRect();if(!(n.width>0&&n.height>0))return;let i=n.left-r.originX,o=n.top-r.originY,a=n.width,s=parseFloat(t.borderTopWidth||"1px"),l=t.borderTopColor||"#000",c,d=g8(t.borderTopLeftRadius,n),u=g8(t.borderTopRightRadius,n);return d&&u?c=[{type:"ellipse",centerX:i+d[0],centerY:o+d[1],radiusX:d[0],radiusY:d[1],rotation:0,startAngle:Math.PI,endAngle:3*Math.PI/2,anticlockwise:!1},{type:"lineTo",x:i+n.width-u[0],y:o},{type:"ellipse",centerX:i+n.width-u[0],centerY:o+u[1],radiusX:u[0],radiusY:u[1],rotation:0,startAngle:3*Math.PI/2,endAngle:0,anticlockwise:!1},{type:"lineTo",x:i+n.width,y:o+u[1]+s},{type:"ellipse",centerX:i+u[0],centerY:o+u[1]+s,radiusX:u[0],radiusY:u[1],rotation:0,startAngle:0,endAngle:3*Math.PI/2,anticlockwise:!0},{type:"lineTo",x:i+d[0],y:o+s},{type:"ellipse",centerX:i+d[0],centerY:o+d[1]+s,radiusX:d[0],radiusY:d[1],rotation:0,startAngle:3*Math.PI/2,endAngle:Math.PI,anticlockwise:!0}]:c=[{type:"moveTo",x:i,y:o},{type:"lineTo",x:a+i,y:o},{type:"lineTo",x:a+i,y:s+o},{type:"lineTo",x:i,y:s+o}],{type:"path",instructions:c,fillColor:l,hasOutline:r.hasOutline}}function m8(e,t){let r=Math.sqrt(e[0]*e[0]+e[1]*e[1]),n=Math.sqrt(t[0]*t[0]+t[1]*t[1]),i=e[0]*t[0]+e[1]*t[1],o=Math.acos(i/(r*n));return e[0]*t[1]-e[1]*t[0]<0&&(o*=-1),o}function Jte(e,t,r,n,i,o,a,s,l){let c=Math.cos(i),d=Math.sin(i),u=(e-s)/2,p=(t-l)/2,g=c*u+d*p,f=-d*u+c*p,y=r*r,E=n*n,_=g*g,w=f*f,v=Math.sqrt((y*E-y*w-E*_)/(y*w+E*_));o===a&&(v*=-1);let T=v*r*f/n,M=-v*n*g/r,C=(e+s)/2,P=(t+l)/2,F=c*T-d*M+C,B=d*T+c*M+P,x=[1,0],L=[(g-T)/r,(f-M)/n],N=[(-g-T)/r,(-f-M)/n],O=m8(x,L),z=m8(x,N);return{centerX:F,centerY:B,radiusX:r,radiusY:n,startAngle:O,endAngle:z,rotation:i,anticlockwise:a===0}}var f8={};function Qte(e,t){let r=e+"-"+t,n=f8[r];if(n)return n;n=[],f8[r]=n;let i=t.split(" ");if(i.length!==4)return n;let o=parseFloat(i[0]),a=parseFloat(i[2]),s=parseFloat(i[1]),l=parseFloat(i[3]),c=a-o,d=l-s;function u(M){return(M-o)/c}function p(M){return(M-s)/d}let g="[0-9-.]+",f="(M"+g+" "+g+")",y="(L"+g+" "+g+")",E="(A"+g+" "+g+" "+g+" "+g+" "+g+" "+g+" "+g+")",_=new RegExp(f+"|"+y+"|"+E,"g"),w=e.match(_);if(!w||!w.length)return n;let v=NaN,T=NaN;for(let M of w){let C=M.substr(1).split(" ").map(parseFloat);switch(M[0]){case"M":v=u(C[0]),T=p(C[1]),n.push({type:"moveTo",x:v,y:T});break;case"L":v=u(C[0]),T=p(C[1]),n.push({type:"lineTo",x:v,y:T});break;case"A":let P=C[0]/c,F=C[1]/d,B=C[2],x=C[3],L=C[4],N=u(C[5]),O=p(C[6]),z=Jte(v,T,P,F,B,x,L,N,O);v=N,T=O,n.push(R({type:"ellipse"},z));break}}return n}function Zte(e,t){let r=e.childNodes[0];if(!r||r.nodeName!=="path")return;let n=e.getBoundingClientRect();if(!(n.width>0&&n.height>0))return;let i=r.getAttribute("d")||"",o=e.getAttribute("viewBox")||"",a=Qte(i,o),s=window.getComputedStyle(e),l=n.width,c=n.height,d=n.left-t.originX,u=n.top-t.originY;a=__dcg_shared_module_exports__.Jc(a);for(let p of a)switch(p.type){case"moveTo":case"lineTo":p.x=p.x*l+d,p.y=p.y*c+u;break;case"arcTo":p.x=p.x*l+d,p.y=p.y*c+u,p.cx=p.x*l+d,p.cy=p.y*c+u,p.radius*=l;break;case"ellipse":p.centerX=p.centerX*l+d,p.centerY=p.centerY*c+u,p.radiusX*=l,p.radiusY*=c;break;default:return p}return{type:"path",fillColor:s.color||"#000",instructions:a,hasOutline:t.hasOutline}}function y8(e,t,r){if(e.classList.contains("dcg-mq-mathspeak"))return;let n=window.getComputedStyle(e),i=Xte(e,n,t);i&&r.push(i);let o=e.childNodes;for(let a=0;a<o.length;a++){let s=o[a];if(s.nodeType===3){let l=$te(s,t);l&&r.push(l)}else if(s.nodeName==="svg"){let l=Zte(s,t);l&&r.push(l)}else s.nodeType===1&&y8(s,t,r)}}function UT(e,t){let r=[];if(t.hasBorder){let n=jte(e,t);n&&r.push(n)}if(t.hasFocus){let n=Yte(e,t);n&&r.push(n)}return y8(e,t,r),r}function zT(e,t){No(t,"dcg-svg-label"),t.save(),To(t);for(let r of e)switch(r.type){case"path":r.hasOutline&&(t.strokeStyle="#FFF",t.lineWidth=3,t.miterLimit=10,h8(t,r),t.stroke());break;case"text":r.hasOutline&&(t.font=r.font,t.strokeStyle="#FFF",t.lineWidth=3,t.miterLimit=2,r.transform?(t.save(),b8(t,r),t.strokeText(r.text,0,0),t.restore()):t.strokeText(r.text,r.x,r.y));break;default:return r}for(let r of e)switch(r.type){case"path":h8(t,r),r.strokeColor&&(t.strokeStyle=r.strokeColor,t.lineWidth=1,t.miterLimit=10,t.stroke()),r.fillColor&&(t.fillStyle=r.fillColor,t.fill());break;case"text":t.font=r.font,t.fillStyle=r.color,r.transform?(t.save(),b8(t,r),t.fillText(r.text,0,0),t.restore()):t.fillText(r.text,r.x,r.y);break;default:return r}t.restore()}function b8(e,t){if(!t.transform)return;let r=Math.abs(t.transform.matrix[0]),n=Math.abs(t.transform.matrix[3]);e.translate(t.x+t.transform.origin.x,t.y+t.transform.origin.y),e.transform.apply(e,t.transform.matrix),e.translate(-t.transform.origin.x/r,-t.transform.origin.y/n)}var zl=__dcg_shared_module_exports__.e(ne()),qT=__dcg_shared_module_exports__.e(ne()),nt=class extends qT.Class{template(){return this.props.children?this.props.children:qT.createElement("div",{onMount:e=>this.onMountMathquill(e)})}onMount(){if(this.props.children){let e=this.findAllRootDOMNodes();if(e.length!==1)throw new Error(`StaticMathquillView expects exactly 1 child DOM Node. Got: ${e.length}`);let t=e[0];if(t instanceof HTMLElement)this.onMountMathquill(t);else throw new Error("StaticMathquillView expects an HTMLElement as child DOM node")}}onMountMathquill(e){var t,r;this.props.tokenController&&(this.mathquillTokenHelper=new Mb(this.props.tokenController(),e,!0)),this.staticMath=gc.StaticMath(e,ie(R({},this.props.config()),{overrideKeystroke:(n,i)=>{var o,a;(a=(o=this.props).onUserPressedKey)!=null&&a.call(o,n,i)&&i.stopPropagation()}})),(r=(t=this.props).didMountMathquill)==null||r.call(t,this.staticMath),e.classList.add("dcg-static-mathquill-view"),this.updateMathquill()}didUpdate(){this.updateMathquill()}updateMathquill(){var e;this.updateMathquillAria(),this.updateMathquillLatex(),(e=this.mathquillTokenHelper)==null||e.updateTokens(this.props.latex())}updateMathquillLatex(){if(!this.staticMath)return;let e=this.props.latex();this.lastLatex!==e&&(this.staticMath.latex(e),this.lastLatex=e,this.props.onReflow&&this.props.onReflow())}updateMathquillAria(){if(!this.staticMath||!this.props.getAriaLabel)return;let e=this.props.getAriaLabel();e!==this.staticMath.getAriaLabel()&&this.staticMath.setAriaLabel(e)}},{For:ere,IfElse:tre}=zl.Components,es=class extends zl.Class{template(){return zl.createElement("span",{class:zl.const("dcg-mixed-text-math")},zl.createElement(ere,{each:()=>__dcg_shared_module_exports__.je(this.props.content()),key:(e,t)=>`${e}|${t}`},e=>tre(()=>__dcg_shared_module_exports__.ie(e)==="latex",{true:()=>zl.createElement(nt,{latex:()=>e.substring(1,e.length-1),config:this.props.mqConfig}),false:()=>zl.createElement("span",{class:zl.const("dcg-label-raw-text")},()=>e)})))}},sn=__dcg_shared_module_exports__.e(ne());qt(),qt();function HT(e){return Array.from(e.querySelectorAll('input:enabled, button:enabled, select:enabled, textarea:enabled, [tabindex="0"], a[href]')).filter(t=>!t.matches('[aria-hidden="true"], [aria-hidden="true"] *, [aria-disabled="true"], [aria-disabled="true"] *')&&bp(t))}function x8(e){return function(t){if(ke(t)==rl&&e){let r=HT(e);if(r.length===0)return;let n=r[0],i=r[r.length-1];t.shiftKey&&document.activeElement===n?(t.preventDefault(),ee(i).trigger("focus")):(!t.shiftKey&&document.activeElement===i||document.activeElement&&!e.contains(document.activeElement))&&(t.preventDefault(),ee(n).trigger("focus"))}}}function Dd(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}var{IfElse:rre}=sn.Components,ore=500,kd=5,iv=2,ZL=class extends sn.Class{constructor(){super(...arguments),this.offsetLeft=0}init(){this.uuid=this.props.uuid()}gravity(){var e,t;return((t=(e=this.props).gravity)==null?void 0:t.call(e))||"s"}template(){return sn.createElement("div",{class:()=>{var e,t,r,n;return{"dcg-tooltip-positioning-container":!0,"dcg-tooltip-gravity-n-s":this.gravity()==="n"||this.gravity()==="s","dcg-tooltip-gravity-e-w":this.gravity()==="e"||this.gravity()==="w","dcg-tooltip-theme-light":((t=(e=this.props).theme)==null?void 0:t.call(e))==="light","dcg-tooltip-theme-dark":((n=(r=this.props).theme)==null?void 0:n.call(r))!=="light"}},style:()=>{var e,t,r,n;return{top:`${this.props.hitAreaRect().top+(((t=(e=this.props).offset)==null?void 0:t.call(e).top)||0)}px`,left:`${this.props.hitAreaRect().left+(((n=(r=this.props).offset)==null?void 0:n.call(r).left)||0)}px`,width:`${this.props.hitAreaRect().width}px`,height:`${this.props.hitAreaRect().height}px`}}},sn.createElement("div",{class:sn.const("dcg-tooltip-message-container"),style:this.bindFn(this.getMessageStyle)},sn.createElement("div",{role:sn.const("tooltip"),id:this.const(this.uuid),class:()=>{var e,t;return{"dcg-tooltip-message":!0,"dcg-text-selectable":(t=(e=this.props).sticky)==null?void 0:t.call(e),"dcg-sticky-not-stuck":this.props.isStickyAndNotStuck()}},onMount:e=>this.tooltipMessage=e,style:()=>({left:`${Math.round(this.offsetLeft)}px`})},rre(()=>!!this.props.customTooltipView,{true:()=>this.props.customTooltipView(),false:()=>sn.createElement("span",null,this.props.tooltip)}))),sn.createElement("div",{class:()=>({"dcg-tooltip-arrow":!0,[this.getTooltipGravityClass()]:!0}),style:()=>{var e,t;return((t=(e=this.props).theme)==null?void 0:t.call(e))==="light"?this.getArrowWithBorderStyle():this.getSolidArrowStyle()}}))}updatePositionIfNecessary(){if(this.gravity()!=="s"&&this.gravity()!=="n")return;let e=this.tooltipMessage.getBoundingClientRect(),t=this.tooltipMessage.closest(".dcg-tap-container");if(!t)return;let r=t.getBoundingClientRect();e.right+iv>r.right?this.offsetLeft=r.right-e.right-iv:e.left-iv<r.left&&(this.offsetLeft=r.left-e.left+iv),this.offsetLeft!==0&&this.update()}didMount(){this.updatePositionIfNecessary()}getTooltipGravityClass(){switch(this.gravity()){case"n":return"dcg-tooltip-gravity-n";case"s":return"dcg-tooltip-gravity-s";case"e":return"dcg-tooltip-gravity-e";case"w":return"dcg-tooltip-gravity-w"}}getArrowWithBorderStyle(){let e=this.gravity(),t=this.getBackgroundColor(),r="#bbb",n="8px",i={width:n,height:n,border:`1px solid ${r}`,background:t};switch(e){case"s":return ie(R({},i),{top:"100%",left:"50%","margin-top":"1px","border-right":"0","border-bottom":"0"});case"n":return ie(R({},i),{bottom:"100%",left:"50%","margin-bottom":"1px","border-left":"0","border-top":"0"});case"e":return ie(R({},i),{top:"50%",left:"100%","margin-left":"1px","border-right":"0","border-top":"0"});case"w":return ie(R({},i),{top:"50%",right:"100%","margin-right":"1px","border-left":"0","border-bottom":"0"});default:return e}}getSolidArrowStyle(){let e=this.gravity(),t=this.getBackgroundColor(),r=`transparent transparent ${t} transparent`,n=`${t} transparent transparent transparent`,i=`transparent ${t} transparent transparent`,o=`transparent transparent transparent ${t}`,a=`-${kd}px`;switch(e){case"s":return{top:"100%",left:"50%",border:`${kd}px solid transparent`,"border-color":r,"margin-top":a,"margin-left":a};case"n":return{bottom:"100%",left:"50%",border:`${kd}px solid transparent`,"border-color":n,"margin-bottom":a,"margin-left":a};case"e":return{top:"50%",left:"100%",border:`${kd}px solid transparent`,"border-color":i,"margin-left":`-${kd}px`,"margin-top":a};case"w":return{top:"50%",right:"100%",border:`${kd}px solid transparent`,"border-color":o,"margin-right":a,"margin-top":a};default:return e}}getBackgroundColor(){var e,t;return((t=(e=this.props).theme)==null?void 0:t.call(e))==="light"?"#fff":this.props.isStickyAndNotStuck()?"#666":"#000"}getMessageStyle(){let e=this.props.hitAreaRect(),t=this.gravity(),r=this.props.maxWidth();switch(t){case"s":return{top:"100%",width:`${r}px`,transform:"translate(-50%, 0)",left:`${.5*e.width}px`,"margin-top":`${kd}px`,"text-align":"center"};case"n":return{bottom:"100%",width:`${r}px`,transform:"translate(-50%, 0)",left:`${.5*e.width}px`,"margin-bottom":`${kd}px`,"text-align":"center"};case"e":return{transform:"translate(0, -50%)",left:"100%",width:`${r}px`,top:`${.5*e.height}px`,"margin-left":`${kd}px`,"text-align":"left"};case"w":return{transform:"translate(0, -50%)",right:"100%",width:`${r}px`,top:`${.5*e.height}px`,"margin-right":`${kd}px`,"text-align":"right"};default:return t}}};function ire(){return document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}var Le=class extends sn.Class{init(){this.uuid=`dcg-tooltip-${Dd()}`}template(){return sn.createElement("div",{class:()=>{var e,t,r,n;return{"dcg-tooltip-hit-area-container":!0,"dcg-display-block":(t=(e=this.props).displayBlock)==null?void 0:t.call(e),"dcg-do-not-blur":!0,"dcg-sticky-tooltip":this.isSticky(),"dcg-tooltip-disabled":this.props.disabled&&this.props.disabled(),"dcg-cursor-default":!this.isSticky(),[((n=(r=this.props).additionalClass)==null?void 0:n.call(r))||""]:!!this.props.additionalClass}},handleEvent:sn.const("true"),didMount:e=>{this.isMounted=!0,this.hitAreaNode=e,this.setupEventListeners(this.hitAreaNode)},tabIndex:()=>this.isSticky()?"0":"-1","aria-label":()=>this.isSticky()?this.props.tooltip():void 0,role:()=>this.isSticky()?"note":void 0,onFocus:()=>{this.isSticky()&&(this.showTooltip(),this.stickTooltip())},onTap:e=>{var t,r,n,i,o;if(this.isSticky())if(e.stopPropagation(),this.isStuck)this.hideTooltipImmediately();else{if((r=(t=this.props).disabled)!=null&&r.call(t))return;this.showTooltip(),this.stickTooltip(),(n=this.hitAreaNode)==null||n.focus()}else if(this.shouldShowOnTapstart()){if((o=(i=this.props).disabled)!=null&&o.call(i))return;this.showTooltip(),this.setUpHideOnExternalMousedown()}else this.hideTooltipImmediately()}},this.props.children)}isSticky(){var e,t,r,n;return!!((t=(e=this.props).sticky)!=null&&t.call(e))&&!((n=(r=this.props).disabled)!=null&&n.call(r))}shouldShowOnTapstart(){var e,t;return!!((t=(e=this.props).showOnTapstart)!=null&&t.call(e))}didUpdate(){this.updateTooltip()}updateTooltip(){if(!this.wrapperRef)return;if(!this.props.tooltip()){this.hideTooltip();return}let e=this.hitAreaNode.getBoundingClientRect(),t=this.wrapperRef.elt.getBoundingClientRect(),{originalTop:r,originalLeft:n}=this.wrapperRef,i=e.top-t.top,o=e.left-t.left;Math.abs(i-r)>3||Math.abs(o-n)>3?this.hideTooltip():this.wrapperRef.view.update()}handleShowEvent(e){var t,r;if((r=(t=this.props).disabled)!=null&&r.call(t))return;let n=this.props.delay?this.props.delay():ore;this.clearTimeouts(),this.showTooltipTimeout=setTimeout(e,n)}hideTooltipImmediately(){this.clearTimeouts(),this.hideTooltip()}handleHideEvent(){this.clearTimeouts(),this.hideTooltipTimeout=setTimeout(this.bindFn(this.hideTooltip),150)}setupEventListeners(e){ee(e).on("tipsyshow",t=>{t.target===e&&this.handleShowEvent(()=>{this.showTooltip()})}).on("tipsyhide",t=>{t.target!==e||this.isStuck||this.handleHideEvent()}).on("keydown",t=>{!rw(t)&&!kf(t)&&this.isStuck&&this.hideTooltipImmediately()})}willUnmount(){this.clearTimeouts(),this.isMounted=!1,this.hideTooltip()}setUpHideOnExternalMousedown(){ee(document).on(`mousedown.dcg-tooltip-${this.uuid} touchstart.dcg-tooltip-${this.uuid} pointerdown.dcg-tooltip-${this.uuid}`,e=>{this.wrapperRef&&(this.hitAreaNode.contains(e.target)||this.wrapperRef.elt.contains(e.target)||this.hideTooltip())})}stickTooltip(){this.isMounted&&this.wrapperRef&&(this.isStuck||(this.setUpHideOnExternalMousedown(),this.isStuck=!0,this.updateTooltip()))}clearTimeouts(){clearTimeout(this.showTooltipTimeout),clearTimeout(this.hideTooltipTimeout)}showTooltip(){var e,t,r;if(!this.isMounted||this.wrapperRef||!this.props.tooltip())return;let n=this.hitAreaNode.getBoundingClientRect(),i=document.createElement("div");i.className="dcg-tooltip-mount-pt";let o=this.hitAreaNode.closest(".dcg-tap-container"),a=ire();(a&&a.contains(this.hitAreaNode)&&a.closest(".dcg-tap-container")?a:o).appendChild(i);let s=i.getBoundingClientRect(),l=n.left-s.left,c=n.top-s.top,d=200;if((t=(e=this.props).noWrap)!=null&&t.call(e)){let f=(r=i.closest(".dcg-tap-container"))==null?void 0:r.getBoundingClientRect();f&&(d=f.width-2*iv)}let u=ie(R({},this.props),{isStickyAndNotStuck:()=>this.isSticky()&&!this.isStuck,maxWidth:()=>d,hitAreaRect:()=>({top:c||0,left:l||0,width:n.width||0,height:n.height||0}),uuid:()=>this.uuid});this.setupEventListeners(i),ee(i).on("dcg-tap",()=>{this.isSticky()&&this.stickTooltip()});let p=sn.mountToNode(ZL,i,u);ee(document).on(`keydown.dcg-tooltip-${this.uuid}`,f=>{ke(f)===kn&&this.hideTooltip()});let g=()=>this.updateTooltip();window.addEventListener("scroll",g,!0),this.wrapperRef={elt:i,view:p,originalLeft:l,originalTop:c,onScroll:g},this.assignAriaDescribedBy()}hideTooltip(){this.clearTimeouts(),this.wrapperRef&&(this.isStuck=!1,ee(document).off(`.dcg-tooltip-${this.uuid}`),window.removeEventListener("scroll",this.wrapperRef.onScroll,!0),this.restoreAriaDescribedBy(),sn.unmountFromNode(this.wrapperRef.elt),this.wrapperRef.elt.parentNode&&this.wrapperRef.elt.parentNode.removeChild(this.wrapperRef.elt),this.wrapperRef=void 0)}assignAriaDescribedBy(){var e,t;if((t=(e=this.props).sticky)!=null&&t.call(e))return;let r=HT(this.hitAreaNode)[0]||this.hitAreaNode;this.originalDescribedBy=r.getAttribute("aria-describedby"),r.setAttribute("aria-describedby",this.uuid)}restoreAriaDescribedBy(){var e,t;if((t=(e=this.props).sticky)!=null&&t.call(e))return;let r=HT(this.hitAreaNode)[0]||this.hitAreaNode;this.originalDescribedBy?r.setAttribute("aria-describedby",this.originalDescribedBy):r.removeAttribute("aria-describedby")}};function KT(e,t,r){return Math.max(t,Math.min(r,e))}var Gb=class{constructor(e){let t=e.data,r=e.width,n=e.height;this.imageData=e;for(let a=1;a<r;a++)t[a]+=t[a-1];for(let a=1;a<n;a++)t[a*r]+=t[a*r-r];let i=r*n-r-n+1,o=r-1;for(let a=0;a<i;a++){let s=1+a%o,l=(1+Math.floor(a/o))*r,c=s-1+l,d=s+l-r,u=s-1+l-r;t[l+s]+=t[c]+t[d]-t[u]}}getSumForValidRect(e){let t=e.left-1,r=e.right-1,n=e.top-1,i=e.bottom-1,o=this.imageData.width,a=this.imageData.data,s=a[t+n*o],l=a[r+n*o],c=a[t+i*o],d=a[r+i*o];return t>=0&&n>=0?d-l-c+s:t>=0?d-c:n>=0?d-l:d}getSum(e){let t={left:KT(Math.floor(e.left),0,this.imageData.width),right:KT(Math.ceil(e.right),0,this.imageData.width),top:KT(Math.floor(e.top),0,this.imageData.height),bottom:KT(Math.ceil(e.bottom),0,this.imageData.height)};return t.left>=t.right||t.top>=t.bottom?0:this.getSumForValidRect(t)}},th=1/2,eh=document.createElement("canvas"),eP=[];function nre(e,t){if(!(t.width*t.height>0))return new Gb({width:0,height:0,data:[]});eh.width=0,eh.width=Math.round(t.width*th),eh.height=Math.round(t.height*th);let r=eh.getContext("2d");r.save(),r.scale(eh.width/e.canvas.width,eh.height/e.canvas.height),r.drawImage(e.canvas,0,0),r.restore();let n=r.getImageData(0,0,eh.width,eh.height),i=n.data;i.length/4,eP.length,eP=new Array(i.length/4);let o=eP;for(let a=0;a<o.length;a++)o[a]=i[a*4+3];return new Gb({width:n.width,height:n.height,data:o})}function w8(e){for(let t=0;t<e.length;t++){let r=are(t,e);e[t]=[r]}return e.map(t=>t[0])}function are(e,t){let r=1/0,n=-1,i=t[e];if(i.length===1)return i[0];for(let o=0;o<i.length;o++){let a=t[e][o].staticScore,s=sre(e,o,t),l=a+s;(n===-1||l<r)&&(r=l,n=o)}return i[n]}function sre(e,t,r){let n=0,i=r[e][t];for(let o=0;o<r.length;o++){if(o===e)continue;let a=0,s=r[o];for(let l=s.length-1;l>=0;l--){let c=s[l],d=Math.max(0,Math.min(i.right,c.right)-Math.max(i.left,c.left)),u=Math.max(0,Math.min(i.bottom,c.bottom)-Math.max(i.top,c.top));a+=d*u}n+=a/s.length}return n}function lre(e,t){let r=t.getSum({left:e.left*th,right:e.right*th,top:e.top*th,bottom:e.bottom*th});return r/=200,r/=th*th,r}function cre(e,t){let r=dre(e,t);return 10*(e.width*e.height-r)}function dre(e,t){let r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),n=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top));return r*n}function v8(e,t){let r;return()=>(r||(r={viewport:{left:0,right:t.width,top:0,bottom:t.height},integralImage:nre(e(),t)}),r)}function WT(e,t){if(t.length<=1)return;let r=e();for(let n of t)n.staticScore+=cre(n,r.viewport),n.staticScore+=lre(n,r.integralImage)}function C8(e,t){let r=t.nakedLabel?0:t.pt_radius,n=Math.round(r/Math.sqrt(2)),i=[],o=t.pt_x,a=t.pt_y,s=t.width,l=t.height,c=400;i.push({cx_s:0,cy_s:0,cx_a:0,cy_a:0,staticScore:c,orientation:"center",matches:{default:1,center:1,center_auto:1,auto_center:1}}),i.push({cx_s:.5,cx_a:r+3,cy_s:0,cy_a:0,staticScore:c,orientation:"right",matches:{default:1,right:1,center_auto:1,auto_right:1}}),i.push({cx_s:-.5,cx_a:-r-3,cy_s:0,cy_a:0,staticScore:c,orientation:"left",matches:{default:1,left:1,center_auto:1,auto_left:1}}),i.push({cx_s:0,cx_a:0,cy_s:-.5,cy_a:-r,staticScore:c,orientation:"above",matches:{default:1,above:1,auto_center:1,above_auto:1}}),i.push({cx_s:-.5,cx_a:-n,cy_s:-.5,cy_a:-n,staticScore:c,orientation:"tl",matches:{default:1,above_left:1,above_auto:1,auto_left:1}}),i.push({cx_s:.5,cx_a:n,cy_s:-.5,cy_a:-n,staticScore:c,orientation:"tr",matches:{default:1,above_right:1,above_auto:1,auto_right:1}}),i.push({cx_s:0,cx_a:0,cy_s:.5,cy_a:r,staticScore:c,orientation:"below",matches:{default:1,below:1,auto_center:1,below_auto:1}}),i.push({cx_s:-.5,cx_a:-n,cy_s:.5,cy_a:n,staticScore:c,orientation:"bl",matches:{default:1,below_left:1,below_auto:1,auto_left:1}}),i.push({cx_s:.5,cx_a:n,cy_s:.5,cy_a:n,staticScore:c,orientation:"br",matches:{default:1,below_right:1,below_auto:1,auto_right:1}});let d=Math.cos(t.rotation),u=Math.sin(t.rotation),p=i.map(g=>{let f=g.cx_s*s+g.cx_a,y=g.cy_s*l+g.cy_a,E=f*d-y*u,_=y*d+f*u,w={multiplyWidth:g.cx_s-.5,multiplyHeight:g.cy_s-.5,addX:g.cx_a,addY:g.cy_a},v=-s/2,T=s/2,M=-l/2,C=l/2;if(t.rotation){let P=pre([{x:v*d-M*u,y:M*d+v*u},{x:v*d-C*u,y:C*d+v*u},{x:T*d-M*u,y:M*d+T*u},{x:T*d-C*u,y:C*d+T*u}]);v=P.left,T=P.right,M=P.top,C=P.bottom}return v=Math.round(o+E+v),T=Math.round(o+E+T),M=Math.round(a+_+M),C=Math.round(a+_+C),{pt_x:Math.round(o),pt_y:Math.round(a),left:v,right:T,top:M,bottom:C,width:T-v,height:C-M,translate:w,staticScore:t.priorOrientation===g.orientation?g.staticScore-20:g.staticScore,orientation:g.orientation,matches:g.matches}});return t.enforceOrientation&&t.enforceOrientation!=="default"?p=__dcg_shared_module_exports__.i(p,g=>!!g.matches[t.enforceOrientation]):t.nakedLabel?p=__dcg_shared_module_exports__.i(p,g=>g.orientation==="center"):t.keepOrientation&&t.priorOrientation?p=__dcg_shared_module_exports__.i(p,g=>g.orientation===t.priorOrientation):p=__dcg_shared_module_exports__.i(p,g=>g.orientation!=="center"),WT(e,p),p}function S8(e,t){let r=[],n=t.width,i=t.height,o=n/2,a=i/2,s=t.pt_x1,l=t.pt_y1,c=t.pt_x2,d=t.pt_y2,u=5,p=(d-l)/(c-s),g=Math.atan2(d-l,c-s)+Math.PI/2,f=u*Math.cos(g),y=u*Math.sin(g),E=Math.min(l,d)-Math.abs(y)-i,_=Math.max(l,d)+Math.abs(y),w=[.5,.4,.6,.2,.8],v=[0,20,20,40,40],T=[];for(let C of w)T.push({x:s*(1-C)+c*C,y:l*(1-C)+d*C});for(let C=0;C<T.length;C++){let P=T[C],F,B,x,L;if(p>=2||p<=-2){x=L=P.y-a;let V=Math.abs((c-s)/(d-l)*a)+Math.abs(f);F=P.x+V,B=P.x-V-n}else if(p<=.05&&p>=-.05){F=B=P.x-o;let V=Math.abs(p*o)+Math.abs(y);x=P.y-V-i,L=P.y+V}else f>0?(F=P.x+f,B=P.x-f-n):(F=P.x+f-n,B=P.x-f),y>0?(x=P.y+y,L=P.y-y-i):(x=P.y+y-i,L=P.y-y);x<E?x=E:x>_&&(x=_),L<E?L=E:L>_&&(L=_);let N=(c-s)*(x-l)-(d-l)*(F-s)>0,O=C.toString()+(N?"-a":"-b");r.push({pt_x:P.x,pt_y:P.y,left:F,top:x,staticScore:v[C],orientation:O,matches:{[O]:1}});let z=C.toString()+(N?"-b":"-a");r.push({pt_x:P.x,pt_y:P.y,left:B,top:L,staticScore:v[C],orientation:z,matches:{[z]:1}})}let M=r.map(C=>{let P=Math.round(C.left),F=Math.round(C.left+n),B=Math.round(C.top),x=Math.round(C.top+i);return{pt_x:Math.round(C.pt_x),pt_y:Math.round(C.pt_y),translate:{multiplyWidth:0,multiplyHeight:0,addX:C.left-C.pt_x,addY:C.top-C.pt_y},left:P,right:F,top:B,bottom:x,width:F-P,height:x-B,staticScore:t.priorOrientation===C.orientation?C.staticScore-20:C.staticScore,orientation:C.orientation,matches:C.matches}});return t.keepOrientation&&t.priorOrientation&&(M=__dcg_shared_module_exports__.i(M,C=>C.orientation===t.priorOrientation)),WT(e,M),M}function E8(e,t){let r=[],n=t.pt_x,i=t.pt_y,o=t.width,a=t.height,s=-(t.startAngle+t.deltaAngle/2),l=t.isRightAngle?t.radius*Math.sqrt(2)-1:t.radius+4,c=l+Math.sqrt(t.width*t.width/4+t.height*t.height/4),d=[],u=c*Math.sin(s);u>l+1/2*a&&(u=l+1/2*a),u<-l-1/2*a&&(u=-l-1/2*a),d.push({x:n+c*Math.cos(s)-o/2,y:i+u-a/2});for(let g=0;g<d.length;g++){let f=d[g],y=g.toString()+"-a";r.push({pt_x:f.x,pt_y:f.y,left:f.x,top:f.y,staticScore:0,orientation:y,matches:{[y]:1}})}let p=r.map(g=>{let f=Math.round(g.left),y=Math.round(g.left+o),E=Math.round(g.top),_=Math.round(g.top+a);return{pt_x:Math.round(g.pt_x),pt_y:Math.round(g.pt_y),translate:{multiplyWidth:0,multiplyHeight:0,addX:g.left-g.pt_x,addY:g.top-g.pt_y},left:f,right:y,top:E,bottom:_,width:y-f,height:_-E,staticScore:t.priorOrientation===g.orientation?g.staticScore-20:g.staticScore,orientation:g.orientation,matches:g.matches}});return t.keepOrientation&&t.priorOrientation&&(p=__dcg_shared_module_exports__.i(p,g=>g.orientation===t.priorOrientation)),WT(e,p),p}function T8(e,t){let r=[],n=t.width,i=t.height,o=10,a=Math.round(o/Math.sqrt(2)),s=0,l=50,c=0,d=0,u=0;for(let y=0;y<t.path.length-2;y+=2)u+=1,c+=t.path[y],d+=t.path[y+1];let p=c/u,g=d/u;r.push({left:p-n/2,top:g-i/2,staticScore:s,orientation:"center",matches:{center:1}}),r.push({left:p+o+3,top:g-i/2,staticScore:l,orientation:"right",matches:{right:1}}),r.push({left:p-(o+n)-3,top:g-i/2,staticScore:l,orientation:"left",matches:{left:1}}),r.push({left:p-n/2,top:g-(i+o),staticScore:l,orientation:"top",matches:{top:1}}),r.push({left:p-(n+a),top:g-(i+a),staticScore:l,orientation:"tl",matches:{tl:1}}),r.push({left:p+a,top:g-(i+a),staticScore:l,orientation:"tr",matches:{tr:1}}),r.push({left:p-n/2,top:g+o,staticScore:l,orientation:"bottom",matches:{bottom:1}}),r.push({left:p-(n+a),top:g+a,staticScore:l,orientation:"bl",matches:{bl:1}}),r.push({left:p+a,top:g+a,staticScore:l,orientation:"br",matches:{br:1}});let f=r.map(y=>{let E=Math.round(y.left),_=Math.round(y.left+n),w=Math.round(y.top),v=Math.round(y.top+i);return{pt_x:Math.round(p),pt_y:Math.round(g),translate:{multiplyWidth:0,multiplyHeight:0,addX:y.left-p,addY:y.top-g},left:E,right:_,top:w,bottom:v,width:_-E,height:v-w,staticScore:t.priorOrientation===y.orientation?y.staticScore-20:y.staticScore,orientation:y.orientation,matches:y.matches}});return t.keepOrientation&&t.priorOrientation&&(f=__dcg_shared_module_exports__.i(f,y=>y.orientation===t.priorOrientation)),WT(e,f),f}function pre(e){let t=e[0].x,r=e[0].x,n=e[0].y,i=e[0].y;for(let o=e.length-1;o>=1;o--){let{x:a,y:s}=e[o];a<t&&(t=a),a>r&&(r=a),s<n&&(n=s),s>i&&(i=s)}return{left:t,right:r,top:n,bottom:i}}var hre=1,Lp=class{constructor(e,t,r,n,i,o,a){this.x=e,this.y=t,this.type=r,this.sketch=n,this.branch=i,this.pointIdxOnBranch=o,this.bareLabel=a===void 0?!1:a,this.id=hre++}getLabel(){let e=this.sketch&&this.sketch.branches[this.branch];return e&&"labels"in e&&e.labels&&e.labels[this.pointIdxOnBranch]||""}getGraphMode(){return this.sketch.branches[this.branch].graphMode}getCompiledFunction(){let e=this.sketch.branches[this.branch];if(!(!("compiled"in e)||!e.compiled))return e.compiled.fn}isAttachedToPlottedPoint(){return this.type===1006||this.type===1008}isMovable(){return __dcg_shared_module_exports__.M(this.getGraphMode())}isPersistent(){return this.type===1008}getLabelSize(){let e=this.sketch&&this.sketch.branches[this.branch];return this.type===1008&&e&&"labelSize"in e?e.labelSize===void 0?1:e.labelSize:1}getLabelRotation(){let e=this.sketch&&this.sketch.branches[this.branch];return this.type===1008&&e&&"labelAngle"in e?e.labelAngle===void 0?0:e.labelAngle:0}getPointOpacity(){let e=this.sketch&&this.sketch.branches[this.branch];if(e&&"pointOpacity"in e){let t=e.pointOpacity;if(t!==void 0){let r;return Array.isArray(t)?r=t[this.pointIdxOnBranch]:r=t,isFinite(r)?Math.max(0,Math.min(1,r)):1}}return 1}getPointSize(){let e=this.sketch&&this.sketch.branches[this.branch];if(e&&"pointSize"in e){let t=e.pointSize;if(t!==void 0){let r;Array.isArray(t)?r=t[this.pointIdxOnBranch]:r=t;let n=isFinite(r)?Math.max(0,r):8;return this.isMovable()?__dcg_shared_module_exports__.Ud(n):n}}return this.isMovable()?__dcg_shared_module_exports__.Vd(8):8}getTextOutline(){if(this.hasEditableLabel())return!1;let e=this.sketch&&this.sketch.branches[this.branch];return this.type===1008&&e&&"suppressTextOutline"in e?!e.suppressTextOutline:!0}hasInteractiveLabel(){let e=this.sketch&&this.sketch.branches[this.branch];return e&&"interactiveLabel"in e?!!e.interactiveLabel:!1}hasEditableLabel(){let e=this.sketch&&this.sketch.branches[this.branch];return e&&"editableLabel"in e?!!e.editableLabel:!1}isBareLabel(){return this.bareLabel}getMovablePoint(){return this.sketch.getMovablePointByIndex(this.pointIdxOnBranch)}isSelected(){return this.sketch.showHighlight}},{If:D8,Input:gre,For:mre,Switch:fre}=Pr.Components,bre=300,k8={id:!0,sketchId:!0,rotatedWidth:!0,rotatedHeight:!0,alignedWidth:!0,alignedHeight:!0,content:!0,focused:!0,isNakedLabel:!0,isClickable:!0,hasOutline:!0,hasBorder:!0,classes:!0,styles:!0,dotStyles:!0,poi:!1,objectSpec:!1,x:!1,y:!1,screenX:!1,screenY:!1,left:!1,top:!1,rotation:!1,opacity:!1,forcedOrientation:!1,orientation:!1,labelDOM:!1,containerDOM:!1,willCopyToCanvas:!1,layerFilter:!1,cachedDrawingCommands:!1,animation:!1,layerNumber:!1,isComplex:!1};function _8(e,t){return t?t.getPOIById(e):null}function Ng(e,t){return 1e3*(e.pixelsToMath.mapX(e.mathToPixels.mapX(t)+.5)-e.pixelsToMath.mapX(e.mathToPixels.mapX(t)-.5))}function jT(e,t){return 1e3*(e.pixelsToMath.mapY(e.mathToPixels.mapY(t)+.5)-e.pixelsToMath.mapY(e.mathToPixels.mapY(t)-.5))}function yre(e,{x:t,y:r}){let n=Ng(e,t),i=jT(e,r);return{xscale:n,yscale:i}}function I8(e,t){return t?[e[1],e[0]]:e}function iP(e,t){let r,n=!1,i="",o="",{poi:a}=e,s=a.getGraphMode();if(e.type==="poi"){let{xscale:c,yscale:d}=yre(t,a);r=a.getLabel();let u,p=a.type===1007&&a.getCompiledFunction();if(p){let g=s===1,f=g?a.y:a.x,[y,E]=I8([c,d],g);u=__dcg_shared_module_exports__.fa(f,y,E,p),u=I8(u,g)}else u=[__dcg_shared_module_exports__.ea(a.x,c),__dcg_shared_module_exports__.ea(a.y,d)];n=!isFinite(u[1].value),i=u[0].latex,o=u[1].latex,i==="undefined"&&(i="\\mathrm{undefined}"),o==="undefined"&&(o="\\mathrm{undefined}")}else r=e.text;let l=r&&__dcg_shared_module_exports__.ie(r);return r?l==="latex"?{is_hole:n,type:"latex",text:r.substring(1,r.length-1)}:l==="text"?{is_hole:n,type:"text",text:r}:{is_hole:n,type:"mixed",text:r}:e.type==="poi"?e.poi.hasEditableLabel()?{is_hole:n,type:"text",text:""}:s===25||s===26?{is_hole:n,type:"latex",text:__dcg_shared_module_exports__.pa([a.x,a.y],__dcg_shared_module_exports__.ha)}:{is_hole:n,type:"latex",text:"\\left("+i+",\\ "+o+"\\right)"}:{is_hole:n,type:"text",text:"?"}}var A8=4,rP=class extends Pr.Class{getClassName(){var e;return((e=this.props.point())==null?void 0:e.y)!==void 0?"dcg-audio-trace-line dcg-audio-trace-line--horizontal":"dcg-audio-trace-line"}getTraceCoord(){var e,t;let r=(e=this.props.point())==null?void 0:e.x,n=(t=this.props.point())==null?void 0:t.y,i=this.props.projection();if(r!==void 0)return`${Math.round(10*i.mapx(r))/10-A8/2}px`;if(n!==void 0)return`${Math.round(10*i.mapy(n))/10-A8/2}px`}getStyle(){var e;let t=this.getTraceCoord(),r=(e=this.props.point())==null?void 0:e.color;return{"--dcg-trace-coord":t,"--dcg-trace-color":r}}template(){return Pr.createElement("div",{class:this.bindFn(this.getClassName),style:this.bindFn(this.getStyle)})}},Pb=class extends Pr.Class{constructor(){super(...arguments),this.labelsDirty=!1,this.traceLinePt=void 0}init(){this.grapher=this.props.grapher(),this.controller=this.grapher.controller,this.cachedLabelDict={},this.cachedLabelOrder=[],this.hoveredPOI=void 0,this.openedPOI2Sketch={}}template(){return Pr.createElement("div",{class:Pr.const("dcg-graph-outer"),style:this.const({"z-index":"0"}),didMount:this.bindFn(this.didMountRoot)},Pr.createElement("div",null,Pr.createElement(mre,{each:()=>this.cachedLabelOrder},e=>Pr.createElement("div",{class:()=>this.getLabelClasses(e),style:()=>this.getLabelStyles(e),didMount:t=>this.linkLabelContainerNode(e,t)},Pr.createElement("div",{class:Pr.const("dcg-pt"),style:()=>this.getDotStyles(e)}),Pr.createElement("div",{class:Pr.const("dcg-label"),didMount:t=>this.linkLabelDOMNode(e,t)},this.renderLabelContent(e),Pr.createElement(D8,{predicate:()=>this.showPOIbutton(e)},()=>Pr.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-button-copy-poi-coordinates"),offset:this.const({top:4})},Pr.createElement("button",{class:Pr.const("dcg-unstyled-button dcg-poi-copy-button"),onTap:()=>this.copyPOI(e),"aria-label":()=>this.controller.s("graphing-calculator-button-copy-poi-coordinates")},Pr.createElement("i",{class:Pr.const("dcg-icon-insert")})))))))),Pr.createElement(D8,{predicate:()=>!0},()=>Pr.createElement(rP,{point:()=>this.traceLinePt,projection:()=>this.grapher.getProjection()})))}copyPOI(e){delete this.openedPOI2Sketch[e],this.setHoveredPOI(void 0),this.controller.dispatch({type:"add-poi-expression",latex:this.getLabelContent(e).text})}showPOIbutton(e){if(!this.controller.isListEnabled()||!this.controller.isListVisible())return!1;let t=this.getHoveredPOI();(t==null?void 0:t.id)!==parseInt(e)&&(t=void 0);let r=_8(e,this.grapher.graphSketches[this.openedPOI2Sketch[e]])||t;switch(r==null?void 0:r.type){case 1001:case 1002:case 1003:case 1004:return!0;default:return!1}}setTraceLine(e){__dcg_shared_module_exports__.E(e,this.traceLinePt)||(this.traceLinePt=e,this.update())}getAriaLabelForId(e){let t=this.cachedLabelDict[e],r;t?t.isComplex?r=Ao(__dcg_shared_module_exports__.pa([t.x,t.y])):r=ll(this.controller,t.x,t.y):r=this.controller.s("graphing-calculator-label-poi-unknown-coordinates");let n=this.controller.s("graphing-calculator-narration-editable-point-label");return this.controller.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:n,coordinates:r})}renderLabelContent(e){return Pr.createElement(fre,{key:()=>this.getLabelContent(e).type},t=>t==="text"?Pr.createElement("span",{class:Pr.const("dcg-label-raw-text")},()=>this.getLabelContent(e).text):t==="latex"?Pr.createElement(nt,{latex:()=>this.getLabelContent(e).text,config:this.bindFn(this.getMQConfig)}):t==="mixed"?Pr.createElement(es,{content:()=>this.getLabelContent(e).text,mqConfig:()=>this.controller.getMathquillConfig({})}):t==="MATH"?Pr.createElement("div",{class:()=>({"dcg-editable-label-border":!0,"dcg-do-not-blur":!0,"dcg-focus":this.shouldEditableLabelBeFocused(e),"dcg-empty-label":this.getEditableLabelText(e).trim().length===0}),style:()=>({"border-color":__dcg_shared_module_exports__.Kd(this.getEditableLabelTextColor(e),.3)})},Pr.createElement(Fe,{latex:()=>this.getEditableLabelText(e),placeholder:()=>"",isFocused:()=>this.shouldEditableLabelBeFocused(e),capExpressionSize:()=>this.controller.getGraphSettings().config.capExpressionSize,selectOnFocus:Pr.const(!1),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabelForId(e),getAriaPostLabel:this.const(""),onUserChangedLatex:r=>this.onLabelInput(r,e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:r=>this.onEditableLabelFocusChange(r,e),hasError:this.const(!1),noFadeout:this.const(!0),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()})):Pr.createElement("div",{class:()=>({"dcg-resizing-text-input-container":!0,"dcg-editable-label-border":!0,"dcg-focus":this.shouldEditableLabelBeFocused(e),"dcg-empty-label":this.getEditableLabelText(e).trim().length===0}),style:()=>({"border-color":__dcg_shared_module_exports__.Kd(this.getEditableLabelTextColor(e),.3)}),onScroll:r=>{r.target&&(r.target.scrollLeft=0)}},Pr.createElement(gre,{"aria-label":()=>this.getAriaLabelForId(e),onInput:r=>this.onLabelInput(r,e),value:()=>this.getEditableLabelText(e),onFocus:()=>this.onEditableLabelFocusChange(!0,e),onBlur:()=>this.onEditableLabelFocusChange(!1,e)}),Pr.createElement("span",{class:Pr.const("dcg-text-input-content")},()=>this.getEditableLabelText(e)||" ")))}getSketchIdFromLabelId(e){let t=this.cachedLabelDict[e];if(t)return t.sketchId}getEditableLabelTextColor(e){let t=this.getSketchIdFromLabelId(e);if(!t)return"#000";let r=this.controller.getItemModel(t);return!r||r.type!=="expression"?"#000":Fu(r)}onEditableLabelFocusChange(e,t){let r=this.getSketchIdFromLabelId(t);r&&(e?this.controller.dispatch({type:"set-focus-location",location:{type:"editable-label",id:r}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"editable-label",id:r}}),this.update())}shouldEditableLabelBeFocused(e){let t=this.getSketchIdFromLabelId(e),r=this.controller.getFocusLocation();return!(!r||r.type!=="editable-label"||!t||r.id!==t)}onLabelInput(e,t){let r=this.getSketchIdFromLabelId(t);if(!r)return;let n=this.controller.getItemModel(r);if(!n||n.type!=="expression")return;let i=e;this.controller.getItemEditableLabelMode(r)==="MATH"&&i.length>0&&(i="`"+i+"`"),this.controller.dispatch({type:"set-item-label",id:r,label:i})}getEditableLabelText(e){let t=this.getSketchIdFromLabelId(e);if(!t)return"";let r=this.controller.getItemModel(t);return!r||r.type!=="expression"?"":this.controller.getItemEditableLabelMode(t)==="MATH"?r.label.substring(1,r.label.length-1):r.label}linkLabelDOMNode(e,t){let r=this.cachedLabelDict[e];r&&(r.labelDOM=t)}linkLabelContainerNode(e,t){let r=this.cachedLabelDict[e];r&&(r.containerDOM=t)}getLabelClasses(e){let t=this.cachedLabelDict[e];return t?t.classes:{}}getLabelStyles(e){let t=this.cachedLabelDict[e];return t?t.styles:{}}getDotStyles(e){let t=this.cachedLabelDict[e];return t?t.dotStyles:{}}getLabelContent(e){let t=this.cachedLabelDict[e];if(t){let r=this.getSketchIdFromLabelId(e);if(!r)return{is_hole:!1,type:"text",text:""};let n=this.controller.getItemEditableLabelMode(r);return t.classes["dcg-editable-label"]&&n!==void 0&&n!=="NONE"?{is_hole:!1,type:n,text:""}:t.content}return{is_hole:!1,type:"text",text:""}}didMountRoot(e){this.node=e}computeHoveredLabel(e,t){let r;this.hoveredPOI?this.isOpenPOI(this.hoveredPOI)?this.grapher.setLayerClass("hoveredPOI","dcg-mouse-over-opened-poi"):(r=this.computeLabel(e,{poi:this.hoveredPOI,type:"poi"},t,"hovered",1/0),this.grapher.setLayerClass("hoveredPOI","dcg-mouse-over-closed-poi")):this.grapher.setLayerClass("hoveredPOI",void 0);let n=this.getHoveredInteractiveLabel();n&&!n.bareLabel?this.grapher.setLayerClass("interactiveLabel","dcg-mouse-over-opened-poi"):this.grapher.setLayerClass("interactiveLabel",void 0),r&&this.saveLabelToCache(r)}computeTraceLabel(e,t){if(!this.traceInfo)return;let r=this.traceInfo.pt;if(!r)return;let n=new Lp(r.x,r.y,1007,this.traceInfo.branchInfo.sketch,this.traceInfo.branchInfo.branch,0),i=this.computeLabel(e,{poi:n,type:"poi"},t,"trace",1/0);i&&this.saveLabelToCache(i)}computeLabel(e,t,r,n,i){var o,a;let{projection:s}=e,l=t.type==="poi"?t.poi.id+"":t.id;n==="trace"&&(l="*trace*");let c=t.poi,d=s.mapx(c.x),u=s.mapy(c.y),p=d,g=u;if(t.type!=="poi"&&(d=0,u=0),!s.coordsAreOnscreen(d,u,20)||this.isHiddenInteractiveLabel(c))return;let f=!1,y,E=c.sketch,_=E&&E.branches[0];_&&(f=!!("nakedLabel"in _&&_.nakedLabel),y="labelOrientation"in _?_.labelOrientation:void 0);let w=E.id,v=this.controller.getItemModel(w);if(c.hasEditableLabel()&&v&&v.type==="expression"&&!Ea(v))return;let T=(v==null?void 0:v.type)==="expression"&&__dcg_shared_module_exports__.Ab((a=(o=v.formula)==null?void 0:o.typed_constant_value)==null?void 0:a.valueType,__dcg_shared_module_exports__.db),M=iP(t,s),C=c.pointIdxOnBranch,P=c.getLabelSize();this.grapher.settings.config.projectorMode&&(P*=1.2),Array.isArray(P)&&(P=P[C]);let F=c.getLabelRotation();Array.isArray(F)&&(F=F[C]);let B=c.getPointOpacity()*this.controller.getGeoModel().getToolFadeOpacity(w),x=c.getTextOutline(),L=c.isPersistent(),N=c.isAttachedToPlottedPoint(),O=c.hasInteractiveLabel(),z=c.hasEditableLabel(),V=(v==null?void 0:v.type)==="expression"&&$n(v),$=this.grapher.clickableObjectsLayer.shouldDrawPressed(w,c.pointIdxOnBranch),G=this.grapher.clickableObjectsLayer.shouldDrawHovered(e,w,c.pointIdxOnBranch),W=this.grapher.clickableObjectsLayer.isKeyboardFocused(w,c.pointIdxOnBranch),U=E.color;if($){let he=__dcg_shared_module_exports__.da(U);he.l>.2?he.l-=.2:he.l+=.1,U=he.toString()}else if(G){let he=__dcg_shared_module_exports__.da(U);he.l>.2?he.l-=.1:he.l+=.2,U=he.toString()}let D=!L,de=N;O&&(de=!0,D=!0),n==="trace"&&(de=!1,D=!0);let ge=r[l],K=ge&&ge.orientation,se={"dcg-poi-label":!0,"dcg-tracept":n==="trace","dcg-opened":n==="opened","dcg-hole":M.is_hole,"dcg-show-border":D,"dcg-hide-dot":de,"dcg-naked-label":f,"dcg-editable-label":z&&!this.takingScreenshot,"dcg-has-outline":x&&!D,"dcg-focus":W};isFinite(P)||(P=1);let H={"font-size":Math.round(P*1100)/10+"%"},Z=!se["dcg-editable-label"]&&!se["dcg-tracept"]&&!se["dcg-show-border"]&&!O,ce=z?"above-canvas":Z?"canvas-labels":"not-drawn";Z?H.visibility="hidden":(H.left=d+"px",H.top=u+"px",F&&(H.transform=`rotate(${F}rad)`),delete H.opacity),L&&U&&(H.color=U);let Re={};return n==="trace"&&(Re["background-color"]=U,Re["border-color"]=U),{id:l,sketchId:w,poi:c,x:c.x,y:c.y,screenX:d,screenY:u,top:g,left:p,rotatedWidth:ge==null?void 0:ge.rotatedWidth,rotatedHeight:ge==null?void 0:ge.rotatedHeight,alignedWidth:ge==null?void 0:ge.alignedWidth,alignedHeight:ge==null?void 0:ge.alignedHeight,labelDOM:ge==null?void 0:ge.labelDOM,containerDOM:ge==null?void 0:ge.containerDOM,cachedDrawingCommands:ge==null?void 0:ge.cachedDrawingCommands,animation:ge==null?void 0:ge.animation,forcedOrientation:y,focused:W,isNakedLabel:f,isClickable:V,orientation:K,rotation:F,classes:se,styles:H,dotStyles:Re,content:M,hasBorder:c.hasEditableLabel(),willCopyToCanvas:Z,layerFilter:ce,opacity:B,layerNumber:i,isComplex:T,hasOutline:x||c.hasEditableLabel(),objectSpec:t.type!=="poi"?t.type==="angle"?{type:t.type,segments:[s.mapx(t.segments[0]),s.mapy(t.segments[1]),t.segments[2],t.segments[3]]}:{type:t.type,segments:s.map_xy_pairs(t.segments)}:void 0}}computeAllLabels(e,t){let r={},n,i,o=this.grapher.graphSketches;for(let s of this.grapher.getDrawLayers())for(let l of s.drawOrder){let c=o[l];if(!c)continue;let d=c.labels;if(d.length)for(let u=0;u<d.length;u++){let p=d[u],g=this.computeLabel(e,p,t,"opened",s.layer);g&&(Array.isArray(c.color)&&(g.styles.color=c.color[u]),this.saveLabelToCache(g))}}let a={};for(n in this.openedPOI2Sketch){let s=_8(n,o[this.openedPOI2Sketch[n]]);s&&(a[n]=s.sketch.id,i=this.computeLabel(e,{poi:s,type:"poi"},t,"opened",1/0),i&&this.saveLabelToCache(i))}return this.openedPOI2Sketch=a,r}saveLabelToCache(e){let t=e.id;this.cachedLabelDict[t]||this.cachedLabelOrder.push(t),this.cachedLabelDict[t]=e}markLabelsDirty(){this.labelsDirty=!0}getInteractiveLabelUnderPoint(e){let t;for(let r=this.cachedLabelOrder.length-1;r>=0;r--){let n=this.cachedLabelOrder[r],i=this.cachedLabelDict[n];if(!i||!i.rotatedWidth||!i.rotatedHeight)continue;let o=i.screenX,a=i.screenY,{left:s,top:l,rotatedWidth:c,rotatedHeight:d}=i;if(c>0&&d>0&&e.x>o+s&&e.x<o+s+c&&e.y>a+l&&e.y<a+l+d){let u=this.getSketchIdFromLabelId(n);if(u===void 0)continue;let p=this.controller.getItemModel(u);if(!p||p.type!=="expression")continue;if(xb(p))return{type:"editable",model:p,layerNumber:i.layerNumber};!t&&tH(p)?t={type:"draggable",model:p,layerNumber:i.layerNumber,label:{x:i.x,y:i.y}}:!t&&i.isClickable&&(t={type:"clickable",model:p,layerNumber:i.layerNumber,poi:i.poi})}}return t}positionLabels(e,t,r,n){let i=!this.labelsDirty;this.labelsDirty=!1;let o=[];e.forEach(l=>{let c=t[l];if(!c||!c.labelDOM)return;let d,u,p=this.getSketchIdFromLabelId(l);if(p!==void 0){let M=this.grapher.getGraphSketch(p);M&&M.branches&&(d=M.branches[0].pointSize,u=__dcg_shared_module_exports__.M(M.branches[0].graphMode))}(d===void 0||typeof d!="number"||d<0)&&(d=8);let g=this.grapher.settings.config.projectorMode?1.3:1;u&&(d=__dcg_shared_module_exports__.Ud(d));let f=.5*d*g+3,y=c.screenX,E=c.screenY,_=c.classes["dcg-show-border"]?2:0,w=c.labelDOM.clientWidth+_,v=c.labelDOM.clientHeight+_;if(!(w>0&&v>0))return;let T=0;this.takingScreenshot&&c.hasBorder&&(T=5),o.push({renderedLabel:c,pt_x:y,pt_y:E,pt_radius:f+T,rotation:c.rotation,nakedLabel:c.isNakedLabel,width:w,height:v,keepOrientation:i,priorOrientation:c.orientation,enforceOrientation:c.forcedOrientation})});let a=v8(n,r),s=o.map(l=>{if(l.renderedLabel.objectSpec){if(l.renderedLabel.objectSpec.type==="segment")return S8(a,{pt_x1:l.renderedLabel.objectSpec.segments[0],pt_y1:l.renderedLabel.objectSpec.segments[1],pt_x2:l.renderedLabel.objectSpec.segments[2],pt_y2:l.renderedLabel.objectSpec.segments[3],pt_radius:10,width:l.width,height:l.height,keepOrientation:l.keepOrientation,priorOrientation:l.priorOrientation||""});if(l.renderedLabel.objectSpec.type==="polygon")return T8(a,{path:l.renderedLabel.objectSpec.segments,pt_radius:10,width:l.width,height:l.height,keepOrientation:l.keepOrientation,priorOrientation:l.priorOrientation||""});if(l.renderedLabel.objectSpec.type==="angle"){let c=l.renderedLabel.objectSpec.segments,d=this.grapher.settings.config.projectorMode?30:20;return E8(a,{pt_x:c[0],pt_y:c[1],startAngle:c[2],deltaAngle:c[3],isRightAngle:LT(c[3]),radius:d,pt_radius:10,width:l.width,height:l.height,keepOrientation:l.keepOrientation,priorOrientation:l.priorOrientation||""})}}else return C8(a,l);return[]});w8(s).forEach((l,c)=>{let d=o[c].renderedLabel;d.orientation=l.orientation;let u=l.left-l.pt_x,p=l.top-l.pt_y;d.left=u,d.top=p,d.rotatedWidth=l.width,d.rotatedHeight=l.height,d.alignedWidth=o[c].width,d.alignedHeight=o[c].height;let g=l.translate.multiplyWidth*d.alignedWidth+l.translate.addX,f=l.translate.multiplyHeight*d.alignedHeight+l.translate.addY;d.screenX=l.pt_x,d.screenY=l.pt_y;let y=d.animation;y||(y={from_dx:g,from_dy:f,to_dx:g,to_dy:f,now_dx:g,now_dy:f,positionChangeTime:0,orientation:l.orientation},d.animation=y),y.orientation===l.orientation&&(y.to_dx=g,y.to_dy=f);let E,_,w=(Date.now()-y.positionChangeTime)/bre;if(w<1){let T=.3*w+2.4*w*w-1.7*w*w*w;E=y.from_dx*(1-T)+y.to_dx*T,_=y.from_dy*(1-T)+y.to_dy*T}else E=y.to_dx,_=y.to_dy;y.now_dx=E,y.now_dy=_,y.to_dx=g,y.to_dy=f,y.orientation!==l.orientation&&(y.positionChangeTime=Date.now(),y.from_dx=E,y.from_dy=_,y.orientation=l.orientation);let v=d.labelDOM;if(v&&!d.willCopyToCanvas){v.style.transform=`translate(${y.now_dx}px,${y.now_dy}px)`;let T=d.containerDOM;T&&(T.style.left=l.pt_x+"px",T.style.top=l.pt_y+"px")}})}copyToCtx(e,t){Ja(e,"labels");let r=this.node.getBoundingClientRect();this.cachedLabelOrder.forEach(n=>{var i,o;let a=this.cachedLabelDict[n];if(!a||!a.willCopyToCanvas)return;let s=a.labelDOM;if(!s||t.filter!==a.layerFilter||!t.allowedSketches.has(a.sketchId))return;let l=(i=a.cachedDrawingCommands)==null?void 0:i.commands,c={};for(let p in k8)if(k8[p]===!0){let g=a[p],f=(o=a.cachedDrawingCommands)==null?void 0:o.cacheKeys[p];c[p]=g,__dcg_shared_module_exports__.E(f,g)||(l=void 0)}if(!l){let p={originX:r.x,originY:r.y,hasOutline:!!a.hasOutline,hasBorder:!!a.hasBorder,hasFocus:!!a.focused&&a.isNakedLabel};l=UT(s,p),a.cachedDrawingCommands={cacheKeys:c,commands:l}}let d=this.computeRotatedCenter(a.screenX,a.screenY,a.rotation),u={x:0,y:0};a.animation&&(u.x=a.animation.now_dx,u.y=a.animation.now_dy),e.save(),e.globalAlpha=a.opacity,e.rotate(a.rotation),e.translate(d.x+u.x,d.y+u.y),zT(l,e),e.restore()}),Qa(e)}areAnyLabelsAnimating(){var e;for(let t in this.cachedLabelDict){let r=(e=this.cachedLabelDict[t])==null?void 0:e.animation;if(r&&(r.now_dx!==r.to_dx||r.now_dy!==r.to_dy))return!0}return!1}computeRotatedCenter(e,t,r){let n=Math.cos(-r),i=Math.sin(-r),o=e*n-t*i,a=t*n+e*i;return{x:o,y:a}}recomputeLabels(e,t,r){let n=this.cachedLabelDict;this.cachedLabelDict={},this.cachedLabelOrder=[],this.computeAllLabels(e,n),this.computeHoveredLabel(e,n),this.computeTraceLabel(e,n),this.update(),this.positionLabels(this.cachedLabelOrder,this.cachedLabelDict,t,r)}clearOpenedPOI(){this.openedPOI2Sketch={}}closePOI(e){delete this.openedPOI2Sketch[e.id]}openPOI(e){this.openedPOI2Sketch[e.id]=e.sketch.id}isOpenPOI(e){return this.openedPOI2Sketch.hasOwnProperty(e.id)}isHiddenInteractiveLabel(e){return!e||!e.hasInteractiveLabel()?!1:!this.isOpenPOI(e)&&this.getHoveredPOI()!==e}setHoveredPOI(e){this.hoveredPOI=e}getHoveredPOI(){return this.hoveredPOI}getHoveredInteractiveLabel(){let e=this.getHoveredPOI();if(e&&e.hasInteractiveLabel())return e}setTraceInfo(e){this.traceInfo=e}isTracing(){return!!this.traceInfo}getTraceInfo(){return this.traceInfo}getMQConfig(){return this.controller.getMathquillConfig({})}};function Nb(e,t){let r=e[t];return Array.isArray(r)&&e.tableInfo?r[e.tableInfo.rowIndex]:r}var nv=class{constructor(e){this.geoHoveredObjects={},this.grapher=e,this.renderedPointsIdOrder=[],this.renderedPoints={},this.speakThrottledAlert=__dcg_shared_module_exports__.z(()=>{let t=this.getPOIUnderAttention();if(!t){this.lastAriaAlert=void 0;return}let r=this.getAriaAlert({id:t.id,lastAriaAlert:this.lastAriaAlert,includeUsageInstructions:!1});r!=null&&r.updated&&(xe(r.completeMessage),this.lastAriaAlert=r)},1e3,{leading:!1,trailing:!0})}recomputeMovablePoints(e){let{projection:t}=e,r=this.grapher.graphSketches,n=this.renderedPoints;this.renderedPoints={},this.renderedPointsIdOrder=[];let i=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention(),o=i==null?void 0:i.calcId,a=(i==null?void 0:i.listIndex)||0,s=y=>{let E=!!i&&o===y.sketch.id&&a===y.listIndex,_=this.processPOI(t,y,n[y.id],E);_&&(this.renderedPoints[y.id]=_,this.renderedPoints[y.id].poi=y,this.renderedPointsIdOrder.push(y.id))};for(let y of this.grapher.generateMergeDrawOrder()){let E=r[y];E&&(E.getMovablePoints().forEach(s),E.getStaticLabeledPoints().forEach(s))}let l=this.renderedPoints[this.hoveredPointId],c=this.renderedPoints[this.pressedPointId],d=l&&l.poi,u=c&&c.poi;d||this.setHoveredPointId(void 0),u||this.setPressedPointId(void 0);let p=u||d,g,f;if(p?(g=p.type==="movable-point"&&p.tableInfo&&p.tableInfo.dragX,f=p.type==="movable-point"&&p.tableInfo&&p.tableInfo.dragY,g&&f||!g&&!f?this.grapher.setLayerClass("movablePoints","dcg-mouse-over-movable-point"):g?this.grapher.setLayerClass("movablePoints","dcg-mouse-over-movable-point-ew"):this.grapher.setLayerClass("movablePoints","dcg-mouse-over-movable-point-ns")):this.grapher.setLayerClass("movablePoints",void 0),!this.getPOIUnderAttention()){this.lastAriaAlert=void 0;return}this.speakThrottledAlert()}_clampedOpacity(e){return e<0?0:e>1?1:__dcg_shared_module_exports__.J(e)?e:1}getAllRenderedObjects(e){return this.renderedPointsIdOrder.filter(t=>e?this.renderedPoints[t].type===e:!0).map(t=>this.renderedPoints[t])}getOrderedTabTargets(e){let t=[];return this.renderedPointsIdOrder.forEach(r=>{let n=this.renderedPoints[r];if(e&&n.type!==e||this.getTabIndex(r)===-1)return;let i=n.poi;t.push({calcId:i.sketch.id,listIndex:i.listIndex,polygonEdge:void 0,description:this.getAriaLabel(r)})}),t}redrawToCtx(e,t,r,n){let i=this.grapher.graphSketches;for(let o of r){let a=i[o];if(!a)continue;let s=a.branches[0],l,c;__dcg_shared_module_exports__.$d(s)&&(l=s.pointOpacity,c=s.pointSize!==void 0?s.pointSize:8),a.getMovablePoints().forEach(d=>{let u;if(n.renderForScreenshot)u={screenX:t.mapx(d.x),screenY:t.mapy(d.y),color:d.color,pointOpacity:l,pointSize:c,animationPercent:0};else if(u=this.renderedPoints[d.id],!u||u.type!=="movable")return;n.showMovablePoints?this.drawMovablePointOnCtx(e,d.sketch,u):Td.drawPointToCtx({ctx:e,projection:t,x:d.x,y:d.y,alpha:l,sketch:d.sketch,sizeFactor:1,opacityFactor:1,colorOverride:d.color,finalHardcodedSize:c})})}}processPOI(e,t,r,n){let i=t.id,o=t.x,a=t.y,s=e.mapx(o),l=e.mapy(a),c=e.coordsAreOnscreen(s,l,20);if(!c&&!n)return;let d=t.sketch?this.grapher.controller.getItemModel(t.sketch.id):void 0,u=!!(d&&Sa(d));if(!(d&&this.grapher.controller.shouldIgnoreGraphInteractions(d)))return r||(t.type==="movable-point"?r={type:"movable",id:i,pointOnScreen:c,poi:t,projection:e,screenX,screenY,color:Nb(t,"color"),pointOpacity:Nb(t,"pointOpacity"),pointSize:Nb(t,"pointSize"),pointIsHovered:!1,pointIsPressed:!1,selected:u,lastHoverActionTime:0,animationPercent:0}:d&&d.type==="expression"&&d.label!==void 0&&d.showLabel&&Ro(d)!=="NONE"?r={type:"draggable-label",id:i,pointOnScreen:c,selected:u,poi:t,projection:e,screenX,screenY}:r={type:"static",id:i,pointOnScreen:c,poi:t,projection:e,screenX,screenY,selected:u}),r.pointOnScreen=c,r.poi=t,r.projection=e,r.screenX=s,r.screenY=l,r.type==="movable"&&(r.color=Nb(r.poi,"color"),r.pointOpacity=Nb(r.poi,"pointOpacity"),r.pointSize=Nb(r.poi,"pointSize"),r.selected=u,this.updateMovablePointAnimation(r,n)),r}drawMovablePointOnCtx(e,t,r){var n;let i=r.pointSize/2*(this.grapher.settings.config.projectorMode?1.3:1);i<0&&(i=0),t.showHighlight&&(i*=1.15);let o=Array.isArray(r.color)?r.color[0]:r.color,a=r.screenX,s=r.screenY,l=r.animationPercent||0;e.save();let c=e.globalAlpha,d=this.shouldDrawGhosted(t.id)?QS.IS_GHOSTED:cw,u=this._clampedOpacity(d*r.pointOpacity);u*=(n=this.grapher.controller.getGeoModel().getToolFadeOpacity(t.id))!=null?n:1;let p=__dcg_shared_module_exports__.Vd(i);e.fillStyle=o,e.globalAlpha=.35*u,e.beginPath(),e.moveTo(a+p,s),e.arc(a,s,p,0,Math.PI*2,!0),e.closePath(),e.fill(),e.globalAlpha=u,(t.tokenHovered||this.geoHoveredObjects[t.id])&&(i=.7*i+.3*p),i=i+(p-i)*l,e.beginPath(),e.moveTo(a+i,s),e.arc(a,s,i,0,Math.PI*2,!0),e.closePath(),e.fill(),e.globalAlpha=c,e.restore()}updateMovablePointAnimation(e,t){let r=Date.now(),n=e.id,i=this.hoveredPointId===n||t,o=this.pressedPointId===n;e.pointIsPressed=o,i!==e.pointIsHovered&&(e.pointIsHovered=i,e.lastHoverActionTime=r);let a=e.animationPercent||0,s=.004*(r-e.lastHoverActionTime);o?a=1:i?(a+=s,a>=1?a=1:this.requestRedrawNextFrame()):(a-=s,a<=0?a=0:this.requestRedrawNextFrame()),e.animationPercent=a}shouldDrawGhosted(e){if(!e)return!1;let t=this.grapher.controller.getItemModel(e);return!t||t.type!=="expression"?!1:Hi(t)}getTabIndex(e){if(this.grapher.controller.getActiveTool()!=="selection")return-1;let t=this.renderedPoints[e];if(!t)return-1;let r=t.poi,n=this.grapher.controller.getItemEditableLabelMode(r.sketch.id),i=this.grapher.controller.getItemModel(r.sketch.id),o=i&&i.type==="expression"&&!$n(i)&&(t.type==="movable"||n===void 0||n==="NONE"),a=this.grapher.settings,s=a.config.graphpaper&&a.config.enableTabindex;return o&&s?0:-1}getAriaHidden(){return!this.grapher.settings.config.graphpaper}getAriaLabel(e){let t=this.getAriaAlert({id:e,includeUsageInstructions:!1});return t&&t.completeMessage}speakAriaAlert(){var e;let t=(e=this.getPOIUnderAttention())==null?void 0:e.id;if(t){let i=this.renderedPoints[t];if(!i||i.type==="static")return this.lastAriaAlert=void 0,!1}let r=this.getAriaAlert({id:t,lastAriaAlert:this.lastAriaAlert,includeUsageInstructions:!0}),n=!this.lastAriaAlert||this.lastAriaAlert.id!==t||!!(r!=null&&r.updated);return this.lastAriaAlert=r,r!=null&&r.completeMessage?(n&&xe(r.completeMessage),!0):!1}getAriaAlert(e){var t,r;let{id:n,lastAriaAlert:i,includeUsageInstructions:o}=e;if(!n)return;let a=this.renderedPoints[n];if(!a)return;let{controller:s}=this.grapher,l=a.poi.sketch?s.getItemModel(a.poi.sketch.id):void 0;if(!l||l.type!=="expression")return;i&&i.id!==n&&(i=void 0);let c=a.poi,d=a.pointOnScreen,u=a.projection,p=((t=l==null?void 0:l.formula.typed_constant_value)==null?void 0:t.valueType)===__dcg_shared_module_exports__.db?(r=l==null?void 0:l.formula.typed_constant_value)==null?void 0:r.value:void 0;if(!c||!u||!u.viewport)return;let g=i==null?void 0:i.label,f=c.ariaLabel;s.isGeometry()&&il(l)&&(f=AT(l,s,{poi:c,includeDetails:!1}).join(" "));let y=g!==f,E=a.selected,_=!!(i!=null&&i.selected)!==E,w=c.x,v=c.y,T=w!==(i==null?void 0:i.coordX)||v!==(i==null?void 0:i.coordY),M=i&&(y||_||T),C=f||s.s("graphing-calculator-narration-movable-point-prefix"),P=!s.isGeometry()&&(a.type==="movable"||a.type==="draggable-label")&&o?s.s("graphing-calculator-narration-movable-point-suffix-usage-instructions"):"",F=d?"":s.s("graphing-calculator-narration-movable-point-off-screen-prompt"),B;if(i?y||!T&&_?B=C+F:T?p?B=`${Ao(__dcg_shared_module_exports__.pa(p))}${F}`:B=`${Bl(s,w)} ${Ul(s,v)}${F}`:_?B=C:B=i.completeMessage:B=`${s.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:C,coordinates:p?Ao(__dcg_shared_module_exports__.pa(p)):ll(s,w,v)})}${P}${F}`,(!i||M)&&s.isGeometry()&&(a.type==="movable"||a.type==="draggable-label")){let x=s.getActiveTool();(x==="selection"||x==="box-selection")&&(B=nP(B||f||"",l,s))}return{id:n,coordX:w,coordY:v,label:f,selected:E,completeMessage:B,updated:M}}setHoveredPointId(e){e!==this.hoveredPointId&&(this.hoveredPointId=e,this.requestRedrawNextFrame())}isMovingPoint(){return!!this.pressedPointId}setPressedPointId(e){e!==this.pressedPointId&&(this.pressedPointId=e,this.requestRedrawNextFrame())}getPOIUnderAttention(){let e=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention();if(!e)return;let t=e.listIndex||0;for(let r in this.renderedPoints){let n=this.renderedPoints[r].poi;if(n.sketch.id===e.calcId&&n.listIndex===t)return n}}setGeoHoveredObjects(e){__dcg_shared_module_exports__.E(e,this.geoHoveredObjects)||(this.geoHoveredObjects=e,this.requestRedrawNextFrame())}requestRedrawNextFrame(){this.grapher.controller.requestRedrawGraph()}};function ll(e,t,r){return Bl(e,t)+" "+Ul(e,r)}function Bl(e,t){let r=e.getGraphSettings().showXAxis,n=e.get2dProjection();if(!n)return"";let{width:i}=n.screen;return r?e.s("graphing-calculator-narration-audio-trace-property-x",{x:Ao(__dcg_shared_module_exports__.ea(t,Ng(n,t)).latex)}):e.s("graphing-calculator-narration-x-percentage-coordinate",{x:Math.round(n.mathToPixels.mapX(t)/i*1e3)/10})}function Ul(e,t){let r=e.getGraphSettings().showYAxis,n=e.get2dProjection();if(!n)return"";let{height:i}=n.screen;return r?e.s("graphing-calculator-narration-audio-trace-property-y",{y:Ao(__dcg_shared_module_exports__.ea(t,Ng(n,t)).latex)}):e.s("graphing-calculator-narration-y-percentage-coordinate",{y:Math.round(n.mathToPixels.mapY(t)/i*1e3)/10})}function Xr(e,t){if(!e)return"";let{controller:r}=e;if(e.type==="expression"){let n=r.isItemSecret(e.id);switch(t){case"describe":return n?r.s("graphing-calculator-narration-describe-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-describe-expression",{index:e.displayIndex});case"delete":return n?r.s("graphing-calculator-narration-delete-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-delete-expression",{index:e.displayIndex});case"duplicate":return n?r.s("graphing-calculator-narration-duplicate-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-duplicate-expression",{index:e.displayIndex});case"show":return n?r.s("graphing-calculator-narration-show-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-show-expression",{index:e.displayIndex});case"hide":return n?r.s("graphing-calculator-narration-hide-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-hide-expression",{index:e.displayIndex});case"show-options":return n?r.s("graphing-calculator-narration-show-options-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-show-options-expression",{index:e.displayIndex});case"hide-options":return n?r.s("graphing-calculator-narration-hide-options-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-hide-options-expression",{index:e.displayIndex});case"create_table":return n?r.s("graphing-calculator-narration-create-table-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-create-table-expression",{index:e.displayIndex});case"rename":return n?r.s("graphing-calculator-narration-rename-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-rename-expression",{index:e.displayIndex});case"mute":return n?r.s("graphing-calculator-narration-mute-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-mute-expression",{index:e.displayIndex});case"unmute":return n?r.s("graphing-calculator-narration-unmute-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-unmute-expression",{index:e.displayIndex})}}if(e.type==="image")switch(t){case"describe":return r.s("graphing-calculator-narration-describe-image",{index:e.displayIndex});case"delete":return r.s("graphing-calculator-narration-delete-image",{index:e.displayIndex});case"duplicate":return r.s("graphing-calculator-narration-duplicate-image",{index:e.displayIndex});case"show":return r.s("graphing-calculator-narration-show-image",{index:e.displayIndex});case"hide":return r.s("graphing-calculator-narration-hide-image",{index:e.displayIndex});case"show-options":return r.s("graphing-calculator-narration-show-options-image",{index:e.displayIndex});case"hide-options":return r.s("graphing-calculator-narration-hide-options-image",{index:e.displayIndex});case"edit_title":return r.s("graphing-calculator-narration-edit-image-title",{index:e.displayIndex})}if(e.type==="text")switch(t){case"describe":return r.s("graphing-calculator-narration-describe-text",{index:e.displayIndex});case"delete":return r.s("graphing-calculator-narration-delete-text",{index:e.displayIndex});case"duplicate":return r.s("graphing-calculator-narration-duplicate-text",{index:e.displayIndex});case"show":return r.s("graphing-calculator-narration-show-text",{index:e.displayIndex});case"hide":return r.s("graphing-calculator-narration-hide-text",{index:e.displayIndex});case"edit_title":return r.s("graphing-calculator-narration-edit-text-title",{index:e.displayIndex})}if(e.type==="table")switch(t){case"describe":return r.s("graphing-calculator-narration-describe-table",{index:e.displayIndex});case"delete":return r.s("graphing-calculator-narration-delete-table",{index:e.displayIndex});case"duplicate":return r.s("graphing-calculator-narration-duplicate-table",{index:e.displayIndex});case"show":return r.s("graphing-calculator-narration-show-table",{index:e.displayIndex});case"hide":return r.s("graphing-calculator-narration-hide-table",{index:e.displayIndex});case"rename":return r.s("graphing-calculator-narration-rename-table",{index:e.displayIndex})}if(e.type==="folder"){let n=!!e.title;switch(t){case"describe":return n?r.s("graphing-calculator-narration-describe-folder-title",{folder:e.title}):r.s("graphing-calculator-narration-describe-folder-index",{index:e.displayIndex});case"collapse":return n?r.s("graphing-calculator-narration-collapse-folder-title",{folder:e.title}):r.s("graphing-calculator-narration-collapse-folder-index",{index:e.displayIndex});case"expand":return n?r.s("graphing-calculator-narration-expand-folder-title",{folder:e.title}):r.s("graphing-calculator-narration-expand-folder-index",{index:e.displayIndex});case"show":return n?r.s("graphing-calculator-narration-show-folder-title",{folder:e.title}):r.s("graphing-calculator-narration-show-folder-index",{index:e.displayIndex});case"hide":return n?r.s("graphing-calculator-narration-hide-folder-title",{folder:e.title}):r.s("graphing-calculator-narration-hide-folder-index",{index:e.displayIndex});case"duplicate":return n?r.s("graphing-calculator-narration-duplicate-folder-title",{folder:e.title}):r.s("graphing-calculator-narration-duplicate-folder-index",{index:e.displayIndex});case"delete":return n?r.s("graphing-calculator-narration-delete-folder-title",{folder:e.title}):r.s("graphing-calculator-narration-delete-folder-index",{index:e.displayIndex});case"edit_title":return r.s("graphing-calculator-narration-edit-folder-title",{index:e.displayIndex})}}switch(t){case"describe":return r.s("graphing-calculator-narration-describe");case"delete":return r.s("graphing-calculator-narration-delete");case"duplicate":return r.s("graphing-calculator-narration-duplicate");case"expand":return r.s("graphing-calculator-narration-expand");case"collapse":return r.s("graphing-calculator-narration-collapse");case"show":return r.s("graphing-calculator-narration-show");case"hide":return r.s("graphing-calculator-narration-hide");case"show-options":return r.s("graphing-calculator-narration-show-options");case"hide-options":return r.s("graphing-calculator-narration-hide-options");case"create_table":return r.s("graphing-calculator-narration-create-table");case"rename":return r.s("graphing-calculator-narration-rename");case"edit_title":return r.s("graphing-calculator-narration-edit-title");case"mute":return r.s("graphing-calculator-narration-mute");case"unmute":return r.s("graphing-calculator-narration-unmute");default:return t}}function Fo(e,t,r={includeDetails:!0}){var n,i,o;if(!e)return t.s("graphing-calculator-narration-geometry-nothing-selected");let a=r.description?r.description:"";if(e.type!=="expression"){if(e.type==="image"){let d=a!==""?a:Xr(e,"describe"),u=r.listIndex||0,{x:p,y:g}=e.formula.dimensions;p&&g&&typeof p[u]=="number"&&typeof g[u]=="number"?a=t.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:d,coordinates:ll(t,p[u],g[u])}):a=d}}else(!e.latex||!((n=e.formula)!=null&&n.typed_constant_value))&&(a=a!==""?a:Xr(e,"describe"));let s=r.poi&&r.poi.sketch.showPOI&&r.poi.type==="static-labeled-point",l=e.type==="expression"&&((i=e.formula.typed_constant_value)==null?void 0:i.valueType)===__dcg_shared_module_exports__.db?(o=e.formula.typed_constant_value)==null?void 0:o.value:void 0;!a&&il(e)?(a=xre(e,t,r),a=vre(a,e,t,r)):r.includeDetails&&r.poi&&!s&&(a=l?a:t.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:a,coordinates:ll(t,r.poi.x,r.poi.y)}));let c=a;return r.includeSelectionState&&!nb(e)&&!s&&(c=nP(c,e,t)),nb(e)&&(c=t.s("shared-calculator-narration-item-clickable",{item:c})),c}function xre(e,t,r={includeDetails:!0}){var n;let{value:i,valueType:o}=Ap(e,r);if(!i)return t.s("shared-calculator-narration-item-unknown");let a=[];if(__dcg_shared_module_exports__.wb(o))a=XH(e,t,r);else switch(o){case __dcg_shared_module_exports__.ya:a=AT(e,t,r);break;case __dcg_shared_module_exports__.Na:a=KH(e,t,r);break;case __dcg_shared_module_exports__.Pa:a=WH(e,t,r);break;case __dcg_shared_module_exports__.Ja:a=$H(e,t,r);break;case __dcg_shared_module_exports__.Ra:case __dcg_shared_module_exports__.Ta:case __dcg_shared_module_exports__.La:case __dcg_shared_module_exports__.$a:a=jH(e,t,r);break;case __dcg_shared_module_exports__.Va:case __dcg_shared_module_exports__.Xa:a=YH(e,t,r);break;default:a.push(t.s("shared-calculator-narration-item-unknown"))}let s=a.join(" "),l=(n=e.formula.geometry)==null?void 0:n.call;return l&&(s=wre(s,l,t)),s}function wre(e,t,r){let n,i=t.parents;if(t.symbol==="apply"){let o=i[0].type!=="arbitrary-expression"?__dcg_shared_module_exports__.Cc(i[0]):void 0,a=o?r.getItemsByIdentifier(o):[];if(o&&a.length===0)n=o;else for(let s of a){if(s.type!=="expression")continue;let l=s.formula.geometry;if(!(!l||!l.call)){n=l.call.symbol;break}}}else if(__dcg_shared_module_exports__.Dc(t.symbol))n=t.symbol;else return e;switch(n){case"coterminal":case"supplement":return e;case"dilate":return r.s("graphing-calculator-narration-geometry-dilated-item",{item:e});case"rotate":return r.s("graphing-calculator-narration-geometry-rotated-item",{item:e});case"translate":return r.s("graphing-calculator-narration-geometry-translated-item",{item:e});case"reflect":return r.s("graphing-calculator-narration-geometry-reflected-item",{item:e});default:return r.s("graphing-calculator-narration-geometry-transformed-item",{item:e})}}function vre(e,t,r,n){var i,o;return n.listIndex!==void 0&&(o=(i=t.formula)==null?void 0:i.geometry)!=null&&o.valueType&&__dcg_shared_module_exports__.wb(t.formula.geometry.valueType)?r.s("graphing-calculator-narration-item-with-list-index",{listIndex:n.listIndex+1,item:e}):n.polygonEdge!==void 0?r.s("graphing-calculator-narration-geometry-edge-of-polygon",{polygonEdge:n.polygonEdge+1,item:e}):e}function nP(e,t,r){return(t&&Sa(t)?r.s("shared-calculator-narration-item-selected",{item:e}):r.s("shared-calculator-narration-item-unselected",{item:e})).trim()}function rt(e){return{shouldBeFocused:()=>Bg(e),onFocusedChanged:t=>{aP(e,t)}}}function Bg(e){let t=e.predicate;if(t&&!t())return!1;let r=e.controller.getFocusLocation();return r&&__dcg_shared_module_exports__.E(r,e.location)}function aP(e,t){let r=e.predicate;r&&!r()||(t?e.controller.dispatch({type:"set-focus-location",location:e.location}):e.controller.dispatch({type:"blur-focus-location",location:e.location}))}var{cos:An,sin:Yn,max:rh,min:Bb,abs:ql,sign:M8,hypot:G8,PI:da}=Math,av=22,Ki=av/2,Wi=av/2,Ze=e=>e.toFixed(1),lP={type:"arc",center:[0,0],radius:1,startAngle:da/4,endAngle:da/4+da},L8=[[-1,0],[0,1],[1,-1]],cP={start:0,delta:da/4},sP=da/4,dP={angle:da/8,side:1},Cre=["dcg-token-perpendicular","dcg-token-parallel","dcg-token-translate","dcg-token-vector","dcg-token-segment","dcg-token-line","dcg-token-ray","dcg-token-angle","dcg-token-angles","dcg-token-directedangle","dcg-token-directedangles","dcg-token-arc","dcg-token-polygon"];function P8(e){return Cre.includes(e)}function V8(e){switch(e.type){case"angle":case"angles":return Ire(e.start,e.delta);case"directedangle":case"directedangles":return Are(e.start,e.delta);case"arc":return Mre(e.arcDetails);case"polygon":return Gre(e.points);case"segment":return Lre(e.angle);case"line":return Pre(e.angle);case"anglebisector":case"ray":return Vre(e.angle);case"vector":case"translate":return Ore(e.angle);case"parallel":return Rre(e.angle,e.side);case"perpendicular":return Fre(e.angle)}}function O8(e,t,r){var n,i,o,a,s,l,c;switch(e){case"angle":case"angles":case"directedangle":case"directedangles":{let d=(n=Sre(e,t))!=null?n:cP,{start:u,delta:p}=d;return{type:e,start:u,delta:p}}case"arc":{let d=(i=Ere(t))!=null?i:lP;return{type:e,arcDetails:d}}case"polygon":{let d=(o=Tre(t))!=null?o:L8;return{type:e,points:d}}case"perpendicular":case"anglebisector":case"ray":case"line":case"segment":{let d=(a=R8(t))!=null?a:sP;return{type:e,angle:d}}case"translate":{let d=(s=kre(t))!=null?s:sP;return{type:e,angle:d}}case"vector":{let d=(l=Dre(t))!=null?l:sP;return{type:e,angle:d}}case"parallel":{let{angle:d,side:u}=(c=_re(t,r))!=null?c:dP;return{type:e,angle:d,side:u}}}}function Sre(e,t){if((t==null?void 0:t.valueType)!==__dcg_shared_module_exports__.Va&&(t==null?void 0:t.valueType)!==__dcg_shared_module_exports__.Xa)return;let[r,n,i]=t.value;return{type:e,start:n,delta:i}}function Ere(e){return(e==null?void 0:e.valueType)===__dcg_shared_module_exports__.Pa?__dcg_shared_module_exports__.bc(e.value):void 0}function Tre(e){return(e==null?void 0:e.valueType)===__dcg_shared_module_exports__.Ja?e.value:void 0}function R8(e){let t=e==null?void 0:e.valueType;if(t!==__dcg_shared_module_exports__.La&&t!==__dcg_shared_module_exports__.Ra&&t!==__dcg_shared_module_exports__.Ta)return;let[[r,n],[i,o]]=e.value;return __dcg_shared_module_exports__.R(i-r,o-n)}function Dre(e){if((e==null?void 0:e.valueType)!==__dcg_shared_module_exports__.$a)return;let[t,r]=e.value[0];return __dcg_shared_module_exports__.R(t,r)}function kre(e){if((e==null?void 0:e.valueType)!==__dcg_shared_module_exports__.Za)return;let[t,r]=e.value[1];return __dcg_shared_module_exports__.R(t,r)}function _re(e,t){var r;if((e==null?void 0:e.valueType)!==__dcg_shared_module_exports__.Ra)return dP;let n=(r=R8(e))!=null?r:dP.angle,i=1;if(t.length===2){let o=t[0],a=t[1],s=o==null?void 0:o.valueType;if((s===__dcg_shared_module_exports__.La||s===__dcg_shared_module_exports__.Ra||s===__dcg_shared_module_exports__.Ta)&&(a==null?void 0:a.valueType)===__dcg_shared_module_exports__.ya){let[l,c]=o.value[0],[d,u]=o.value[1],[p,g]=a.value,f=d-l,y=-(u-c),E=f,_=d-p,w=u-g;i=y*_+E*w>0?1:-1}}return{angle:n,side:i}}function F8(e,t){(!isFinite(e)||!isFinite(t))&&(e=cP.start,t=cP.delta);let r=An(e),n=-Yn(e),i=An(e+t),o=-Yn(e+t),a=rh(0,r,i)-Bb(0,r,i),s=rh(0,n,o)-Bb(0,n,o),l=ql(t)>da,c=l?2:rh(a,s),d=.73*av/c,u=d*r,p=d*n,g=d*i,f=d*o,y=l?0:(Bb(0,u,g)+rh(0,u,g))/2,E=l?0:(Bb(0,p,f)+rh(0,p,f))/2,_=Ki-y,w=Wi-E;return{x1:u,y1:p,x2:g,y2:f,tx:_,ty:w,r:d}}function Ire(e,t){let{x1:r,y1:n,x2:i,y2:o,tx:a,ty:s,r:l}=F8(e,t),c=.6,d=c*r,u=c*n,p=c*i,g=c*o,f=ql(t)>da?1:0,y=t>0?0:1,E=`M ${Ze(d)} ${Ze(u)} A ${Ze(c*l)} ${Ze(c*l)} 0 ${f} ${y} ${Ze(p)} ${Ze(g)}`;return`<g transform="translate(${a} ${s})"><polyline points="${Ze(r)},${Ze(n)},0,0,${Ze(i)},${Ze(o)}" /><path d = "${E}" class="dcg-token-angle-arc"/><path d = "${E} L 0 0" class="dcg-token-angle-fill"/></g>`}function Are(e,t){let{x1:r,y1:n,x2:i,y2:o,tx:a,ty:s,r:l}=F8(e,t),c=.8,d=c*r,u=c*n,p=__dcg_shared_module_exports__.Sb(1/(c*l),0,2),g=(ql(t)-p)*M8(t),f=(t+g)/2,y=c*l*An(e+g),E=-c*l*Yn(e+g),_=M8(t),w=_*3.5,v=_*(60*da)/180,T=.7,M=e+f,C=y+w*Yn(M+v*(1-T)),P=E+w*An(M+v*(1-T)),F=y+w*Yn(M-v*T),B=E+w*An(M-v*T),x=ql(t)>da?1:0,L=t>0?0:1,N=`M ${Ze(d)} ${Ze(u)} A ${Ze(c*l)} ${Ze(c*l)} 0 ${x} ${L} ${Ze(y)} ${Ze(E)}`,O=`M ${Ze(C)} ${Ze(P)} L ${Ze(y)} ${Ze(E)} L ${Ze(F)} ${Ze(B)}`;return`<g transform="translate(${a} ${s})"><polyline points="${Ze(r)},${Ze(n)},0,0,${Ze(i)},${Ze(o)}" />`+(ql(t)<.05?"":`<path d = "${N}" class="dcg-token-directedangle-arc"/>`)+(ql(t)<.29?"":`<path d = "${O}" class="dcg-token-directedangle-arrowhead"/>`)+"</g>"}function Mre(e){if(e===void 0)return"";switch(e.type){case"arc":{let{startAngle:t,endAngle:r}=e;(!isFinite(t)||!isFinite(r))&&(t=lP.startAngle,r=lP.endAngle);let n=r-t,i=.386*av;if(ql(n)>6.16)return`<circle cx="${Ze(Ki)}" cy="${Ze(Wi)}" r="${Ze(i)}">`;if(ql(n)<da/6){let _=(t+r)/2,w=i*Yn(_),v=i*An(_);return`<path d = "M ${Ze(Ki-w)} ${Ze(Wi-v)} l ${Ze(2*w)} ${Ze(2*v)}" />`}let o=.66*da;ql(n)<o&&(i/=ql(n)/2);let a=i*An(t),s=-i*Yn(t),l=i*An(r),c=-i*Yn(r),d=i*An((t+r)/2),u=-i*Yn((t+r)/2),p=__dcg_shared_module_exports__.Sb(2*(da-ql(n)),0,1),g=p*(Bb(a,l,d)+rh(a,l,d))/2,f=p*(Bb(s,c,u)+rh(s,c,u))/2,y=Ki-g,E=Wi-f;return`<path d = "${`M ${Ze(a+y)} ${Ze(s+E)} A ${Ze(i)} ${Ze(i)} 0 ${ql(n)>da?1:0} ${n>0?0:1} ${Ze(l+y)} ${Ze(c+E)}`}" />`}case"rays":{let{start1:t,end1:r}=e,n=r[0]-t[0],i=r[1]-t[1];(!isFinite(n)||!isFinite(n))&&(n=1,i=1);let o=G8(n,i),a=3,s=a*n/o,l=-a*i/o;return`<path d = "M ${Ze(Ki-s)} ${Ze(Wi-l)} l ${Ze(-5*s)} ${Ze(-5*l)}" /><path d = "M ${Ze(Ki+s)} ${Ze(Wi+l)} l ${Ze(5*s)} ${Ze(5*l)}" />`}case"segment":{let{start:t,end:r}=e,n=r[0]-t[0],i=r[1]-t[1];(!isFinite(n)||!isFinite(n))&&(n=1,i=1);let o=G8(n,i),a=7,s=a*n/o,l=a*i/o;return`<path d = "M ${Ze(Ki-s)} ${Ze(Wi-l)} l ${Ze(2*s)} ${Ze(2*l)}" />`}}}function Gre(e){if(e.length<2)return"";e.some(E=>!isFinite(E[0])||!isFinite(E[1]))&&(e=L8);let t=e[0];e=e.slice(1);let r=t[0],n=r,i=t[1],o=i;for(let E=0;E<e.length;E++){let _=e[E][0],w=e[E][1];_<r&&(r=_),_>n&&(n=_),w<i&&(i=w),w>o&&(o=w)}let a=(r+n)/2,s=(i+o)/2,l=rh(n-r,o-i),c=.8*av,d=E=>Ki+c*(E-a)/l,u=E=>Wi-c*(E-s)/l,p=E=>`${E[0].toFixed(1)} ${E[1].toFixed(1)}`,g=d(t[0]),f=u(t[1]);if(!isFinite(g)||!isFinite(f))return"";let y=[];for(let E of e){let _=d(E[0]),w=u(E[1]);if(!isFinite(_)||!isFinite(w))return"";y.push(p([_,w]))}return`<path d = ${`"M ${p([g,f])} ${y.map(E=>`L ${E} `).join(" ")} Z"`} />`}function pP(e,t,r){let n=7*An(e),i=7*Yn(-e);return`<path d = "M ${Ze(Ki-t*n)} ${Ze(Wi-t*i)} L ${Ze(Ki+r*n)} ${Ze(Wi+r*i)}" />`}function Lre(e){return pP(e,1,1)}function Pre(e){return pP(e,2,2)}function Vre(e){return pP(e,1,2)}function Ore(e){let t=48*(da/180),r=8.5-1,n=8.5-7*An(t),i=Ki-r*An(e),o=Wi+r*Yn(e),a=Ki+n*An(e),s=Wi-n*Yn(e),l=`M ${Ze(i)} ${Ze(o)} L ${Ze(a)} ${Ze(s)}`,c=Ki+8.5*An(e),d=Wi+8.5*Yn(-e),u=c-7*An(e+t/2),p=d+7*Yn(e+t/2),g=c-7*An(e-t/2),f=d+7*Yn(e-t/2),y=`M ${Ze(u)} ${Ze(p)} L ${Ze(c)} ${Ze(d)} L ${Ze(g)} ${Ze(f)}`;return`<path d = "${l}"/><path d = "${y}" class="dcg-token-vector-arrowhead"/>`}function Rre(e,t){let r=14*An(e),n=14*-Yn(e),i=4*An(e+t*da/2),o=4*-Yn(e+t*da/2);return`<path d = "M ${Ze(Ki-r)} ${Ze(Wi-n)} L ${Ze(Ki+r)} ${Ze(Wi+n)}" /><path d = "M ${Ze(Ki+i-r)} ${Ze(Wi+o-n)} L ${Ze(Ki+i+r)} ${Ze(Wi+o+n)}" class="dcg-token-parallel-parent"/>`}function Fre(e){let t=14*An(e),r=14*-Yn(e);return`<path d = "M ${Ze(Ki-t)} ${Ze(Wi-r)} L ${Ze(Ki+t)} ${Ze(Wi+r)}" /><path d = "M ${Ze(Ki+r)} ${Ze(Wi-t)} L ${Ze(Ki-r)} ${Ze(Wi+t)}" class="dcg-token-parallel-parent"/>`}var{If:sv}=$i.Components,Nre=.8,Ad=class extends $i.Class{init(){this.controller=this.props.controller()}template(){return $i.createElement("span",{class:()=>{var e,t;let r=this.parentOrChildHovered();return{"dcg-geo-token-view":!0,"dcg-static-token":(t=(e=this.props).isStatic)==null?void 0:t.call(e),"dcg-selected-token":this.isTokenSelected(),"dcg-hidden-token":this.isHidden(),"dcg-token-has-label":this.showLabel(),"dcg-child-of-hovered-token":r==="child","dcg-parent-of-hovered-token":r==="parent","dcg-assignment-token":!!this.getAssignment(),"dcg-graph-interactions-disabled":this.isGraphInteractionDisabled(),"dcg-light-color":this.isLightColor()}},style:()=>({color:this.getColor()}),role:this.bindFn(this.getAriaRole),"dcg-token-type":()=>this.getTokenInfo().iconType,"aria-roledescription":()=>this.props.insideGroup()?void 0:this.controller.s("graphing-calculator-narration-geometry-construction-role-description"),"aria-label":this.bindFn(this.getAriaLabel),"aria-selected":this.bindFn(this.isTokenSelected),tabIndex:()=>this.props.putInTabOrder()?0:-1,manageFocus:()=>this.props.focusLocation?rt({controller:this.controller,location:this.props.focusLocation()}):void 0,onTapStart:this.bindFn(this.onTapStart),onTap:this.bindFn(this.onTap),onPointerOver:this.bindFn(this.onPointerOver),onPointerOut:this.bindFn(this.onPointerOut)},$i.createElement("span",{class:$i.const("dcg-token-background")}),$i.createElement("span",{class:()=>({"dcg-token-icon":!0,[this.getAdditionalTokenClass()]:!!this.getAdditionalTokenClass(),"dcg-token-is-list":this.getIsList()&&!this.getAssignment()})},$i.createElement(sv,{predicate:()=>!!this.getIcon()},()=>$i.createElement("i",{class:this.bindFn(this.getIcon)})),$i.createElement(sv,{predicate:()=>P8(this.getAdditionalTokenClass())},()=>$i.createElement("div",{willUnmount:()=>this.willUnmountSVG(),didMount:e=>this.didMountSVG(e)}))),$i.createElement(sv,{predicate:()=>!!this.getAssignment()},()=>$i.createElement(nt,{latex:this.bindFn(this.getAssignment),config:this.const({})})),$i.createElement(sv,{predicate:()=>this.showLabel()},()=>$i.createElement("span",{class:()=>({"dcg-token-label":!0})},()=>this.getLabel())),$i.createElement(sv,{predicate:this.bindFn(this.isGraphInteractionDisabled)},()=>$i.createElement("i",{class:$i.const("dcg-icon-lock")})))}isLightColor(){let e=this.getColor();return!e||this.isTransformation()||this.isHidden()?!1:qf({type:"single-color",value:e},this.controller.invertSwatches(),Nre)}didMountSVG(e){this.svgElement=e,this.renderSVGElement()}willUnmountSVG(){this.svgElement=void 0,this.lastSVGInputs=void 0}getTypedValue(e){var t;if(e===void 0)return;let r=this.controller.getItemsByIdentifier(e);if(!r||r.length!==1)return;let n=r[0];return(t=n==null?void 0:n.formula)==null?void 0:t.typed_constant_value}getParentValues(e){var t,r,n;let i=this.controller.getItemsByIdentifier(e);if(!i||i.length!==1)return[];let o=i[0],a=(n=(r=(t=o==null?void 0:o.formula)==null?void 0:t.geometry)==null?void 0:r.call)==null?void 0:n.parents;return a===void 0?[]:a.map(s=>{if(s.type==="arbitrary-expression")return;let l=__dcg_shared_module_exports__.Cc(s);return this.getTypedValue(l)})}renderSVGElement(){if(!this.svgElement)return;let e=this.props.identifier(),t=this.getIconType(),r=this.getTypedValue(e),n=this.getParentValues(e),i=O8(t,r,n);i!==void 0&&(__dcg_shared_module_exports__.E(i,this.lastSVGInputs)||(this.lastSVGInputs=i,this.svgElement.innerHTML=`<svg>${V8(i)}</svg>`))}getAdditionalTokenClass(){if(this.getAssignment()||this.hasError())return"";switch(this.getIconType()){case"glider":return"dcg-token-glider";case"line":return"dcg-token-line";case"segment":return"dcg-token-segment";case"ray":return"dcg-token-ray";case"intersection":return"dcg-token-intersection";case"midpoint":return"dcg-token-midpoint";case"parallel":return"dcg-token-parallel";case"perpendicular":return"dcg-token-perpendicular";case"anglebisector":return"dcg-token-ray";case"rotate":return"dcg-token-rotate";case"circle":return"dcg-token-circle";case"arc":return"dcg-token-arc";case"vector":return"dcg-token-vector";case"dilate":return"dcg-token-dilate";case"reflect":return"dcg-token-reflect";case"translate":return"dcg-token-translate";case"transformation":return"dcg-token-transformation";case"point":case"start":case"end":return"dcg-token-point";case"polygon":return"dcg-token-polygon";case"angle":return"dcg-token-angle";case"angles":return"dcg-token-angles";case"directedangle":case"directedangles":return"dcg-token-directedangle"}return""}getIdFromParentRef(e){if(e.type==="arbitrary-expression")return;let t=__dcg_shared_module_exports__.Cc(e);return this.controller.getExpressionIdForIdentifier(t)}isGraphInteractionDisabled(){let e=this.props.controller().getExpressionIdForIdentifier(this.props.identifier())||"",t=this.controller.getItemModel(e);return!!t&&(t.type==="expression"||t.type==="image")&&!!t.disableGraphInteractions}parentOrChildHovered(){var e,t,r,n,i,o;if(!this.props.showParentChildrenHover||!this.props.showParentChildrenHover())return!1;let a=this.controller.getHoveredOrFocusedTokenIdentifier(),s=this.controller.getExpressionIdForIdentifier(a),l=this.props.identifier(),c=this.props.controller().getExpressionIdForIdentifier(l)||"";if(!s)return!1;let d=this.controller.getItemModel(s),u=this.controller.getItemModel(c);if(!d||d.type!=="expression"||!u||u.type!=="expression")return!1;let p=((r=(t=(e=d.formula)==null?void 0:e.geometry)==null?void 0:t.call)==null?void 0:r.parents)||[],g=((o=(i=(n=u.formula)==null?void 0:n.geometry)==null?void 0:i.call)==null?void 0:o.parents)||[];for(let f=0;f<p.length;f++)if(this.getIdFromParentRef(p[f])===c)return"parent";for(let f=0;f<g.length;f++)if(this.getIdFromParentRef(g[f])===s)return"child";return!1}willUnmount(){this.implicitMouseOut()}didUpdate(){this.renderSVGElement();let e=this.props.identifier();this.currentlyActiveIdentifier&&e!==this.currentlyActiveIdentifier&&this.implicitMouseOut()}implicitMouseOut(){this.currentlyActiveIdentifier&&this.controller.runAfterDispatch(()=>{let e=this.currentlyActiveIdentifier;e&&(this.currentlyActiveIdentifier=void 0,this.controller.dispatch({type:"unset-active-token",identifier:e,style:"hovered"}))})}isHidden(){return this.getTokenInfo().isHidden}hasError(){let e=this.getTokenInfo();return!e||e.hasError}getIcon(){if(this.getAssignment())return;let e=this.getTokenInfo();if(this.hasError())return"dcg-icon-error";switch(e.iconType){case"point":case"glider":case"intersection":case"strictintersection":case"midpoint":case"start":case"end":return"dcg-icon-point";case"dilate":return"dcg-icon-dilation";case"rotate":return"dcg-icon-rotation";case"reflect":return"dcg-icon-reflection";case"transformation":return"dcg-icon-title";case"angle":case"angles":case"directedangle":case"directedangles":case"polygon":case"vector":case"translate":case"apply":case"arc":case"circle":case"clockwise":case"counterclockwise":case"error":case"line":case"parallel":case"perpendicular":case"anglebisector":case"ray":case"reflex":case"segment":case"segments":case"unknown":case"vertices":return;default:return e.iconType}}showLabel(){return!!this.getLabel()}getLabel(){if(this.getAssignment())return"";if(this.getIconType()!=="point"&&this.getIconType()!=="midpoint")return!1;let e=this.getTokenInfo().label.trim();return e.length<=2?e:""}getAssignment(){let e=this.props.identifier();return e[0]!=="$"?__dcg_shared_module_exports__.ma(e):""}getAriaLabel(){let e=this.getTokenInfo(),t=Fo(this.controller.getItemModel(e==null?void 0:e.calcId),this.controller,{includeDetails:!1,depth:1});return this.isHidden()?this.controller.s("graphing-calculator-narration-geometry-hidden-construction-description",{description:t}):t}isTransformation(){var e;return((e=this.getTokenInfo())==null?void 0:e.groupType)==="transformation"}getColor(){if(this.getAssignment())return;let e=this.getTokenInfo();if(this.hasError())return"#fa824c";if(!(this.getIconType()==="translate"&&!this.isHidden()))return this.isTransformation()||this.isHidden()?"#aaa":e.color}getIconType(){return this.getTokenInfo().iconType}getIsList(){return this.getTokenInfo().isList}getTokenInfo(){let e=this.props.identifier();return this.controller.getTokenRenderInfoByIdentifier(e)}onPointerOver(e){var t,r;(r=(t=this.props).isStatic)!=null&&r.call(t)||e.pointerType==="mouse"&&(this.currentlyActiveIdentifier=this.props.identifier(),this.controller.dispatch({type:"set-active-token",identifier:this.currentlyActiveIdentifier,style:"hovered"}))}onPointerOut(e){var t,r;(r=(t=this.props).isStatic)!=null&&r.call(t)||e.pointerType==="mouse"&&this.currentlyActiveIdentifier&&(this.controller.dispatch({type:"unset-active-token",identifier:this.currentlyActiveIdentifier,style:"hovered"}),this.currentlyActiveIdentifier=void 0)}onTapStart(e){var t,r;(r=(t=this.props).isStatic)!=null&&r.call(t)||e.handle()}onTap(e){var t,r;(r=(t=this.props).isStatic)!=null&&r.call(t)||(e.handle(),this.props.focusLocation&&this.controller.dispatch({type:"set-focus-location",location:this.props.focusLocation()}),this.controller.dispatch({type:"select-expression-that-defines-token",identifier:this.props.identifier(),toggle:this.isTokenSelected(),multiSelectMode:this.controller.isMultiSelectEnabled()&&!!e.shiftKey}))}isTokenSelected(){let e=this.getTokenInfo();return!!(e&&e.isSelected)}getAriaRole(){var e,t;if(!((t=(e=this.props).isStatic)!=null&&t.call(e)))return this.props.insideGroup()?"option":"button"}},Ub=e=>{let t=function(){return e};return t.isDcgViewConst=!0,t},Mb=class{constructor(e,t,r){this.tokenController=e,this.mathNode=t,this.isStatic=r}updateTokens(e){if(!this.mathNode)return;if(!this.lastTokenInfo||this.lastTokenInfo.latex!==e)if(!this.tokenController.doesLatexContainToken(e))this.lastTokenInfo={latex:e,tokens:[]};else{let r=[];this.mathNode.querySelectorAll(".dcg-mq-token").forEach(n=>{r.push(n)}),this.lastTokenInfo={latex:e,tokens:r}}let t=this.lastTokenInfo.tokens;for(let r of t){let n=r.dcgTokenView;if(n)n.update();else{let i=r.getAttribute("data-dcg-mq-token")||"",o=N8.mountToNode(Ad,r,{controller:Ub(this.tokenController),identifier:Ub("$"+i),insideMQ:Ub(!0),insideGroup:Ub(!1),putInTabOrder:Ub(!1),isStatic:Ub(this.isStatic)});r.dcgTokenView=o}}}},{If:Bre}=cl.Components,zb=500,Ure=30,Fe=class qn extends cl.Class{constructor(){super(...arguments),this.lastLatexProp=""}template(){return cl.createElement("div",{class:cl.const("dcg-mq-container")},cl.createElement(Bre,{predicate:()=>this.getPlaceholder().trim().length>0},()=>cl.createElement("span",{class:cl.const("dcg-mq-placeholder")},cl.createElement(nt,{config:()=>this.props.config(),latex:()=>this.getPlaceholder()}))),cl.createElement("div",{class:()=>({"dcg-math-field":!0,"dcg-no-fadeout":this.props.noFadeout&&this.props.noFadeout(),"dcg-invalid":this.props.hasError(),"dcg-focus":this.props.isFocused()}),didMount:t=>this.didMountMathquill(t),"data-dcg-label":()=>this.props.dataLabelAttributeValue?this.props.dataLabelAttributeValue():void 0}))}willUnmount(){var t;(t=this.mathquillFocus)==null||t.willUnmount(),this.mathField=void 0}getPlaceholder(){return!this.props.placeholder||this.props.isFocused()||this.props.latex()?"":this.props.placeholder()}didMountMathquill(t){this.cachedConfig=this.getCacheableMQConfig();let r=ie(R({},this.cachedConfig),{restrictMismatchedBrackets:"none",handlers:{reflow:i=>{this.props.onReflow&&this.mathField&&this.props.onReflow(i)}},onCut:()=>{this.mathField&&this.props.onUserChangedLatex(this.mathField.latex())},onPaste:()=>{this.mathField&&this.props.onUserChangedLatex(this.mathField.latex())},overrideTypedText:i=>{this.mathField&&this.viewCanAcceptText(i)&&(this.props.onUserTypedText?this.props.onUserTypedText(i):(this.mathField.typedText(i),this.props.onUserChangedLatex(this.mathField.latex())))},overrideKeystroke:(i,o)=>{if(i==="Backspace"&&o.preventDefault(),!this.mathField)return;if(i==="Spacebar"&&this.props.disableSpace&&this.props.disableSpace())return o.preventDefault();let a=ke(o);if(a==="Up"||a==="Down"||a==="Left"||a==="Right"||a==="Esc"){let s=[];o.ctrlKey&&s.push("Ctrl"),o.metaKey&&s.push("Meta"),o.altKey&&s.push("Alt"),o.shiftKey&&s.push("Shift"),s.length?(s.push(a),i=s.join("-")):i=a}this.props.onUserPressedKey?this.props.onUserPressedKey(i,o):(this.mathField.keystroke(i,o),this.props.onUserChangedLatex(this.mathField.latex())),this.maybeTriggerOnSelectionChange()}});this.props.needsSystemKeypad&&this.props.needsSystemKeypad()&&(r.substituteTextarea=()=>{let i=document.createElement("textarea");return i.setAttribute("autocorrect","off"),i.setAttribute("autocapitalize","none"),i.setAttribute("spellcheck","false"),i.setAttribute("autocomplete","off"),i}),this.props.tokenController&&(this.mathquillTokenHelper=new Mb(this.props.tokenController(),t,!1)),this.$mathField=ee(t);let n=gc.MathField(t,r);this.mathField=n,t._mqMathFieldInstance=this.mathField,t._mqViewInstance=this,this.mathquillFocus=new Rf(n,this.$mathField,this.props),this.$mathField.on("paste.view",i=>this.onPasteEvent(i)),!BS&&(Ml||Qx)&&this.$mathField.on("keypress.view",i=>this.onKeypressEvent(i)),this.hookupMQTapTouch(n),this.updateMathquill()}getCacheableMQConfig(){let t=R({},this.props.config());return this.props.capExpressionSize()&&(t.maxDepth=Ure),t}didUpdate(){this.updateMathquill()}updateMathquill(){var t,r;this.updateMathquillConfig(),this.updateMathquillAria(),this.updateMathquillLatex(),(t=this.mathquillFocus)==null||t.updateMathquillFocused(),this.updateMathquillPostLabel(),(r=this.mathquillTokenHelper)==null||r.updateTokens(this.props.latex())}onPasteEvent(t){let r="",n=window.clipboardData,i=t.originalEvent;n&&n.getData?r=n.getData("Text"):i&&i.clipboardData&&i.clipboardData.getData&&(r=i.clipboardData.getData("text/plain"));let o=this.viewCanAcceptText(r);return!o&&this.props.onExpressionSizeExceeded&&this.props.onExpressionSizeExceeded(),o}viewCanAcceptText(t){return qn.canAcceptText(this.mathField,this.props.capExpressionSize(),t)}static canAcceptText(t,r,n){if(!t)return!1;if(!r)return!0;let i=t.latex();return Of(i)+Of(n)<=zb}onKeypressEvent(t){if(t.stopPropagation(),t.preventDefault(),!this.mathField)return;let r=t.key&&t.key.length===1?t.key:void 0;r&&this.viewCanAcceptText(r)&&(this.props.onUserTypedText?this.props.onUserTypedText(r):(this.mathField.typedText(r),this.props.onUserChangedLatex(this.mathField.latex())))}hookupMQTapTouch(t){this.$mathField.on("dcg-tapstart.view",()=>{let r="dcg-tapend.mathquill-selection-change";ee(document).on(r,()=>{this.maybeTriggerOnSelectionChange(),ee(document).off(r)})}),t.ignoreNextMousedown(()=>vU.shouldIgnoreMouseDown()),this.$mathField.on("dcg-tap.view",r=>{var n;let i=r;if(i.device!=="touch"||i.target.closest(".dcg-mq-ignore-mousedown"))return;let o=i.changedTouches[0];t.clickAt(o.clientX,o.clientY,o.target),(n=this.mathquillFocus)!=null&&n.isFocused()||t.focus()})}updateMathquillConfig(t={}){if(!this.mathField)return;let r=R(R({},this.getCacheableMQConfig()),t);__dcg_shared_module_exports__.E(r,this.cachedConfig)||(this.cachedConfig=r,this.mathField.config(r))}updateMathquillAria(){if(!this.mathField)return;let t=this.props.getAriaLabel();t!==this.mathField.getAriaLabel()&&this.mathField.setAriaLabel(t)}updateMathquillPostLabel(){this.mathField&&this.mathField.setAriaPostLabel(this.props.getAriaPostLabel(),this.props.hasError()?5e3:1e3)}updateMathquillLatex(){let t=this.props.latex();this.mathField&&this.lastLatexProp!==t&&(this.props.capExpressionSize()&&Of(t)>zb||(this.lastLatexProp=t,this.mathField.latex()!==t&&this.mathField.latex(t)))}maybeTriggerOnSelectionChange(){let t=this.props.onSelectionChanged;if(!t||!this.mathField)return;let r=this.mathField.selection();__dcg_shared_module_exports__.E(r,this.lastSelection)||(this.lastSelection=r,t(r))}static getFocusedMathquill(){if(!document.activeElement)return;let t=document.activeElement.closest(".dcg-mq-editable-field");if(t)return t._mqMathFieldInstance}static getMQViewInstance(t){let r=t.el();if(r)return r._mqViewInstance}static applyArrowKeyAndReturnIfWasAtBounds(t,r,n){let i=t.selection(),o=i.startIndex===0&&i.endIndex===i.latex.length;if((r==="Up"||r==="Down")&&o)return t.keystroke(r,n),!0;t.keystroke(r,n);let a=t.selection();return!(a.latex!==i.latex||a.startIndex!==i.startIndex||a.endIndex!==i.endIndex)}static temporarilyOverrideLeftRightIntoCommandGoes(t,r){var n;let i=qn.getMQViewInstance(t);if(!i)return()=>{};let o=(n=i.getCacheableMQConfig().leftRightIntoCmdGoes)!=null?n:"up";return i.updateMathquillConfig({leftRightIntoCmdGoes:r}),()=>i.updateMathquillConfig({leftRightIntoCmdGoes:o})}static simulateKeypressFromKeypad(t,r){var n;let i=qn.getMQViewInstance(t);if(!i)return;let o=(n=i.getCacheableMQConfig().leftRightIntoCmdGoes)!=null?n:"up";if((r==="Left"||r==="Right")&&i.updateMathquillConfig({leftRightIntoCmdGoes:void 0}),i.props.onUserPressedKey)i.props.onUserPressedKey(r);else{t.keystroke(r);let a=t.latex();i.props.onUserChangedLatex(a)}i.maybeTriggerOnSelectionChange(),(r==="Left"||r==="Right")&&i.updateMathquillConfig({leftRightIntoCmdGoes:o})}static simulateUserChangedLatex(t){let r=qn.getMQViewInstance(t);if(r&&r.mathField){let n=r.mathField.latex();r.props.onUserChangedLatex(n)}}static handleKeystrokeAndDecideIfSpecialEvent(t,r,n){return r==="Enter"||r==="Delete"&&t.latex()===""||r==="Backspace"&&t.latex()===""?!0:r==="Up"||r==="Down"||r==="Left"||r==="Right"?qn.applyArrowKeyAndReturnIfWasAtBounds(t,r,n):(t.keystroke(r,n),!1)}static normalizeLatex(t,r){let n=document.createElement("div"),i=gc.MathField(n,r);return i.latex(t),i.latex()}},rs=__dcg_shared_module_exports__.e(ne()),{For:zre,If:qre}=rs.Components,vo=class extends rs.Class{constructor(){super(...arguments),this.btnViews={}}init(){this.config=this.props.staticConfig()}template(){return rs.createElement("div",{class:rs.const("dcg-segmented-control-container"),role:()=>{var e,t;return(t=(e=this.props).treatAsMultiSelect)!=null&&t.call(e)?"listbox":"radiogroup"},"aria-multiselectable":()=>{var e,t;return(t=(e=this.props).treatAsMultiSelect)!=null&&t.call(e)?!0:void 0},onKeyDown:this.bindFn(this.handleRadioKeydown),"aria-label":this.props.ariaGroupLabel},rs.createElement(zre,{each:()=>this.config,key:e=>e.key},(e,t)=>rs.createElement("div",{class:()=>({"dcg-segmented-control-btn":!0,"dcg-selected":e.selected(),"dcg-theme-mini":this.getTheme()==="mini","dcg-theme-default":this.getTheme()==="default","dcg-disabled":this.isDisabled(),[e.class?e.class():""]:!!e.class}),role:()=>{var r,n;return(n=(r=this.props).treatAsMultiSelect)!=null&&n.call(r)?"option":"radio"},tabIndex:()=>this.getTabIndexForOption(e),"aria-label":()=>this.getAriaLabel(e),style:()=>({"min-width":this.props.minButtonWidth?this.props.minButtonWidth()+"px":void 0}),"aria-checked":()=>{var r,n;return(n=(r=this.props).treatAsMultiSelect)!=null&&n.call(r)?void 0:e.selected()},"aria-selected":()=>{var r,n;return(n=(r=this.props).treatAsMultiSelect)!=null&&n.call(r)?e.selected():void 0},onTap:r=>{this.isDisabled()||e.onSelect(r.device)},didMount:r=>this.btnViews[t]=r,manageFocus:()=>{if(e.focusHelperOptions)return rt(e.focusHelperOptions)}},rs.createElement(Le,{tooltip:()=>{var r;return((r=e.tooltip)==null?void 0:r.call(e))||""},gravity:()=>{var r;return((r=e.tooltipGravity)==null?void 0:r.call(e))||"s"},disabled:()=>!(e.tooltip&&e.tooltip())},rs.createElement("div",{class:rs.const("dcg-segmented-control-interior")},()=>e.label?e.label():"",rs.createElement(qre,{predicate:()=>!!e.icon},()=>rs.createElement("i",{class:()=>e.icon?e.icon():""})))))))}getAriaLabel(e){return e.ariaLabel?e.ariaLabel():e.label?e.label():e.tooltip?e.tooltip():""}isDisabled(){var e,t;return!!((t=(e=this.props).disabled)!=null&&t.call(e))}getTheme(){return this.props.theme?this.props.theme():"default"}handleRadioKeydown(e){var t,r,n;let i=ke(e);if(i!=="Up"&&i!=="Down"&&i!=="Left"&&i!=="Right"&&i!=="Home"&&i!=="End"||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;e.preventDefault(),e.stopPropagation();let o=__dcg_shared_module_exports__.w(this.config,c=>this.btnViews[c.key]===document.activeElement),a=this.config.length,s=o;i==="Home"&&(s=0),i==="End"&&(s=this.config.length-1),(i==="Up"||i==="Left")&&(s=(o-1+a)%a),(i==="Down"||i==="Right")&&(s=(o+1)%a);let l=this.config[s];l&&((t=this.btnViews[l.key])==null||t.focus(),!((n=(r=this.props).treatAsMultiSelect)!=null&&n.call(r))&&l.onSelect("keyboard"))}getTabIndexForOption(e){if(this.isDisabled())return-1;let t=e.key===this.config[0].key,r=this.config.find(n=>n.selected());return e.key===(r==null?void 0:r.key)||t&&!r?0:-1}},Ur=__dcg_shared_module_exports__.e(ne());qt();function Jr(){document.activeElement&&wp(document.activeElement)&&ee(document.activeElement).trigger("blur")}var Xn=__dcg_shared_module_exports__.e(ne());function B8(e){if(!e)return;let t=[];for(let r of e.split(" ")){let n=r.indexOf("|"),i=n!==-1?r.slice(0,n):r;t.push(i)}return t}function qb(e,t,r){let n=B8(r);return t==="nemeth"?lp(e,{operatorNames:n}):t==="ueb"?cp(e,{operatorNames:n}):{isError:!0,error:"Braille mode should be 'nemeth' or 'ueb'"}}function YT(e,t,r){let n=B8(r);return t==="nemeth"?fM(e,{operatorNames:n}):t==="ueb"?bM(e,{operatorNames:n}):{isError:!0,error:"Braille mode should be 'nemeth' or 'ueb'"}}var Hb=__dcg_shared_module_exports__.e(ne());qt();var{Input:Hre}=Hb.Components,Ug=class extends Hb.Class{init(){this.ASCIICharacters=` A1B'K2L@CIF/MSP"E3H9O6R^DJG>NTQ,*5<-U8V.%[$+X!&;:4\\0Z7(_?W]#Y)=`,this.ASCIITable=[],this.HomeRowCharacters="FDSJKL",this.charCodes=[],this.sixKeyModel={keysDown:0,stickyKeysDown:0};let e;for(e=0;e<this.ASCIICharacters.length;e++)this.ASCIITable.push(this.ASCIICharacters.charCodeAt(e));for(e=0;e<this.HomeRowCharacters.length;e++)this.charCodes.push(this.HomeRowCharacters.charCodeAt(e))}template(){return Hb.createElement(Hre,{class:this.const("dcg-braille-input dcg-do-blur"),tabIndex:()=>this.props.tabIndex?this.props.tabIndex():0,readOnly:()=>this.props.isStatic()?!0:void 0,autocomplete:this.const("off"),autocorrect:this.const("off"),autocapitalize:this.const("off"),spellcheck:this.const("false"),onKeyDown:this.bindFn(this.onKeydown),onKeyUp:this.bindFn(this.onKeyUp),onInput:this.bindFn(this.props.onInput),value:()=>this.props.value(),"aria-label":()=>this.props.ariaLabel()||Gs(""),didMount:this.bindFn(this.didMount),didUnmount:this.bindFn(this.props.didUnmount),placeholder:()=>this.props.placeholder?this.props.placeholder():"",size:()=>this.props.size&&this.props.size()})}didMount(e){this.rootNode=e,ee(this.rootNode).on("focus",t=>{this.props.shouldFocus()||this.props.onFocusedChanged(!0,t.originalEvent||t)}).on("blur",t=>{this.props.shouldFocus()&&this.props.onFocusedChanged(!1,t.originalEvent||t)}),this.props.didMount(e),this.updateFocus()}didUpdate(){this.updateFocus()}updateFocus(){this.rootNode&&(this.props.shouldFocus()&&document.activeElement!==this.rootNode&&this.rootNode.focus(),!this.props.shouldFocus()&&document.activeElement===this.rootNode&&this.rootNode.blur())}onKeydown(e){let t=this.charCodes.indexOf(e.which);!this.props.isStatic()&&this.isSixKeyInput()&&!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&t!==-1?(this.sixKeyModel=ie(R({},this.sixKeyModel),{keysDown:this.addKey(this.sixKeyModel.keysDown,t),stickyKeysDown:this.addKey(this.sixKeyModel.stickyKeysDown,t)}),e.preventDefault()):this.props.onKeyDown&&this.props.onKeyDown(e)}onKeyUp(e){let t=this.charCodes.indexOf(e.which),r=!1;return!this.props.isStatic()&&this.isSixKeyInput()&&!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&t!==-1?(this.sixKeyModel=ie(R({},this.sixKeyModel),{keysDown:this.removeKey(this.sixKeyModel.keysDown,t)}),this.sixKeyModel.keysDown===0&&(this.addCharacter(this.bitsToASCII(this.sixKeyModel.stickyKeysDown)),this.sixKeyModel=ie(R({},this.sixKeyModel),{stickyKeysDown:0}))):r=!0,r||e.preventDefault(),r}addKey(e,t){return e|1<<t}removeKey(e,t){return e&~(1<<t)}bitsToASCII(e){return String.fromCharCode(this.ASCIITable[e])}addCharacter(e){this.rootNode&&!this.props.isStatic()&&(this.rootNode.setRangeText(e,this.rootNode.selectionStart,this.rootNode.selectionEnd,"end"),this.props.onInput(this.rootNode.value))}isSixKeyInput(){return typeof this.props.sixKeyInput=="function"&&this.props.sixKeyInput()}},lv=__dcg_shared_module_exports__.e(ne()),Kb=class extends lv.Class{template(){return lv.createElement(Le,ie(R({},this.props),{customTooltipView:()=>lv.createElement(nt,{latex:this.props.tooltip,config:this.const({})}),theme:this.const("light"),noWrap:this.const(!0)}),this.props.children)}},{If:uP}=Xn.Components,Mo=class extends Xn.Class{init(){this.currentBrailleValue=this.getBrailleFromLatex(this.props.latex()),this.currentBrailleMode=this.props.mode(),this.hasTranslationError=!1,this.currentLatex=this.props.latex()}isFocused(){return this.brailleInput!==void 0&&document.activeElement==this.brailleInput}getBrailleShouldFocus(){return this.props.mode()!=="none"&&this.props.brailleShouldFocus&&this.props.brailleShouldFocus()}isStatic(){return!!this.props.isStatic&&this.props.isStatic()}isInline(){return!!this.props.isInline&&this.props.isInline()}hasError(){return!!this.props.hasError&&this.props.hasError()}willUpdate(){let e=this.currentLatex!==this.props.latex(),t=this.props.mode(),r=t!==this.currentBrailleMode&&t!=="none";this.isFocused()&&!e&&!r||(this.currentLatex=this.props.latex(),(r||!this.hasTranslationError||e||this.isStatic())&&(this.currentBrailleValue=this.getBrailleFromLatex(this.props.latex()),this.hasTranslationError=!1),this.currentBrailleMode=t)}onBrailleInput(e){if(!this.props.onBrailleInput)return;let t=this.getLatexFromBraille(e);this.hasTranslationError=t.isError;let r=this.props.capExpressionSize&&this.props.capExpressionSize();if(!t.isError&&r&&r.exceedsLimit(t.value)){r.onExpressionSizeExceeded();return}this.currentBrailleValue=e,t.isError||(this.currentLatex=t.value,this.props.onBrailleInput(t.value))}getBrailleFromLatex(e,t=!1){let r=qb(e,this.props.mode(),this.props.operatorNames&&this.props.operatorNames());return r.isError?"":t?r.value:sa.toExpandedBrailleAscii(r.value)}getLatexFromBraille(e){return YT(sa.coerceToSixDotCells(e),this.props.mode(),this.props.operatorNames&&this.props.operatorNames())}getBrailleLabel(e){return this.getBrailleFromLatex(e.replace(/\s/,"\\ "))}shouldShowBraille(){let e=this.props.mode();return e==="nemeth"||e==="ueb"}isOverflowingLeft(){return this.brailleInput?this.brailleInput.scrollLeft>0:!1}isOverflowingRight(){if(!this.brailleInput)return!1;let e=this.brailleInput.getBoundingClientRect().width,t=this.brailleInput.scrollWidth,r=this.brailleInput.scrollLeft;return t>e+r+2}didMountBrailleInput(e){this.brailleInput=e}didUnmountBrailleInput(){this.brailleInput=void 0}handleBrailleFocusChanged(e,t){this.props.onBrailleFocusedChanged&&this.props.onBrailleFocusedChanged(e,t),this.brailleInput&&(e&&this.props.selectOnFocus&&this.props.selectOnFocus()&&this.brailleInput.select(),this.isStatic()&&this.brailleInput.scrollTo(0,0))}getTooltipText(){let e=this.props.placeholder&&!this.isFocused()?this.props.placeholder():"";return Gs(this.props.latex()||e)}template(){return Xn.createElement("div",{class:Xn.const("dcg-mathquill-wrapper")},Xn.createElement(uP,{predicate:()=>this.shouldShowBraille()},()=>Xn.createElement("div",{class:()=>({"dcg-mathquill-braille":!0,"dcg-text-selectable":this.isStatic(),"dcg-focus":this.getBrailleShouldFocus(),"dcg-invalid":this.hasError(),"dcg-mathquill-static-braille":this.isStatic(),"dcg-mathquill-braille-overflow-left":this.isOverflowingLeft(),"dcg-mathquill-braille-overflow-right":this.isOverflowingRight()}),"data-dcg-label":()=>this.props.dataLabelAttributeValue?this.props.dataLabelAttributeValue():void 0},Xn.createElement(Kb,{tooltip:()=>this.getTooltipText(),gravity:this.const("s"),delay:this.const(0),showOnTapstart:this.const(!0)},Xn.createElement(uP,{predicate:()=>this.isInline()},()=>Xn.createElement("span",{class:Xn.const("dcg-inline-braille")},()=>Gs(this.getBrailleFromLatex(this.props.latex(),!0)))),Xn.createElement(uP,{predicate:()=>!this.isInline()},()=>Xn.createElement(Ug,{ariaLabel:()=>Gs(this.props.ariaLabel?this.getBrailleLabel(this.props.ariaLabel()):""),didMount:this.bindFn(this.didMountBrailleInput),didUnmount:this.bindFn(this.didUnmountBrailleInput),onFocusedChanged:this.bindFn(this.handleBrailleFocusChanged),shouldFocus:this.bindFn(this.getBrailleShouldFocus),onKeyDown:this.props.onBrailleKeydown,onInput:this.bindFn(this.onBrailleInput),sixKeyInput:this.props.sixKeyInput,value:()=>this.currentBrailleValue,placeholder:()=>Gs(this.props.placeholder?this.getBrailleFromLatex(this.props.placeholder()):""),tabIndex:()=>this.props.tabIndex?this.props.tabIndex():0,isStatic:this.bindFn(this.isStatic),size:()=>this.currentBrailleValue&&this.currentBrailleValue.length||1}))))),Xn.createElement("div",{class:Xn.const("dcg-typeset-math"),style:()=>({display:this.shouldShowBraille()&&!this.isInline()?"none":void 0}),"aria-hidden":()=>this.shouldShowBraille()},this.props.children))}};function os(){if(!(!document.activeElement||!document.activeElement.classList.contains("dcg-braille-input")))return document.activeElement}function Wb(e){return!e||e.value===""}var U8=__dcg_shared_module_exports__.e(ne());function Kre(e){let t=e.target;return t.classList.contains("dcg-exp-action-button")||t.classList.contains("dcg-icon-duplicate")||t.classList.contains("dcg-icon-remove")||t.classList.contains("dcg-icon-lock")||t.classList.contains("dcg-icon-pencil")}var is=class extends U8.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,this._isFirstRender=!0,this._isDragCopy=this.props.isDragCopy()}onItemViewMounted(e){this._isDragCopy||(this.model.rootViewNode=e),this._isFirstRender=!1}onItemViewUnmounted(){this._isDragCopy||(this.model.rootViewNode=void 0)}isFirstRender(){return this._isFirstRender}onMouseSelect(e){if(this.controller.isInEditListMode()&&!Kre(e)){this.exitEditListMode();return}this.controller.isItemReadonly(this.id)||e.type==="dcg-tap"&&e.device==="mouse"||e.type==="dcg-tapstart"&&e.device==="touch"||e.wasHandled()||(e.handle(),this.controller.dispatch({type:"set-selected-id",id:this.id,state:"selected"}))}onDragPending(e){this.controller.isItemReadonly(this.model.id)||this.props.onDragPending(e)}exitEditListMode(){this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!0})}},Ht=__dcg_shared_module_exports__.e(ne()),{If:hP}=Ht.Components,Hl=class extends Ht.Class{init(){this.controller=this.props.controller()}template(){return Ht.createElement(hP,{predicate:this.bindFn(this.shouldShowOptions)},()=>Ht.createElement("span",{class:()=>({"dcg-expression-edit-actions":!0,"dcg-limited-height":this.limitedHeight()}),didMount:()=>{this.controller.isInEditListMode()&&xe(this.controller.s("graphing-calculator-narration-edit-list-mode-on"))},didUnmount:()=>{this.controller.isInEditListMode()||xe(this.controller.s("graphing-calculator-narration-edit-list-mode-off"))}},Ht.createElement("span",{class:Ht.const("dcg-graphic"),handleEvent:Ht.const("true")}),Ht.createElement(hP,{predicate:()=>Sg(this.model())!==void 0},()=>Ht.createElement(Le,{tooltip:this.bindFn(this.getConvertTooltip),gravity:this.const("s")},Ht.createElement("span",{class:Ht.const("dcg-action-createtable dcg-exp-action-button"),handleEvent:Ht.const("true"),role:Ht.const("button"),tabIndex:Ht.const("0"),"aria-label":()=>Xr(this.model(),"create_table"),onTap:this.bindFn(this.onCreateTable)},Ht.createElement("i",{class:Ht.const("dcg-icon-table"),"aria-hidden":Ht.const("true")})))),Ht.createElement(hP,{predicate:()=>this.controller.shouldShowAuthorFeatures()},()=>Ht.createElement(Le,{tooltip:this.bindFn(this.getReadonlyToggleLabel),gravity:this.const("s")},Ht.createElement("span",{class:()=>({"dcg-action-lock":!0,"dcg-exp-action-button":!0,"dcg-selected":this.isReadonly()}),handleEvent:Ht.const("true"),role:Ht.const("button"),tabIndex:Ht.const("0"),"aria-label":this.bindFn(this.getReadonlyToggleLabel),onTap:this.bindFn(this.onToggleReadonly)},Ht.createElement("i",{class:Ht.const("dcg-icon-lock"),"aria-hidden":Ht.const("true")})))),Ht.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-duplicate-expression-tooltip"),gravity:this.const("s")},Ht.createElement("span",{class:Ht.const("dcg-duplicate-btn dcg-exp-action-button"),handleEvent:Ht.const("true"),role:Ht.const("button"),tabIndex:Ht.const("0"),"aria-label":()=>Xr(this.model(),"duplicate"),onTap:this.bindFn(this.onDuplicateWithoutFocus)},Ht.createElement("i",{class:Ht.const("dcg-icon-duplicate"),"aria-hidden":Ht.const("true")}))),Ht.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-expression-delete-tooltip"),gravity:this.const("s")},Ht.createElement("span",{class:Ht.const("dcg-delete-btn dcg-exp-action-button"),handleEvent:Ht.const("true"),role:Ht.const("button"),tabIndex:Ht.const("0"),"aria-label":()=>Xr(this.model(),"delete"),onTap:this.bindFn(this.onDelete)},Ht.createElement("i",{class:Ht.const("dcg-icon-remove"),"aria-hidden":Ht.const("true")})))))}shouldShowOptions(){return this.controller.isInEditListMode()&&(this.controller.shouldShowAuthorFeatures()||!this.controller.isItemReadonly(this.props.id()))}model(){return this.controller.getItemModel(this.props.id())}getConvertTooltip(){return ZS(this.model())?this.controller.s("graphing-calculator-label-create-table"):this.controller.s("graphing-calculator-label-convert-to-table-tooltip")}limitedHeight(){let e=this.model();return e&&(e.type==="image"||this.isSlider())}isSlider(){let e=this.model();return e&&e.type==="expression"&&e.sliderExists}onCreateTable(){let e=this.model();e&&this.controller.dispatch({type:"convert-or-create-table",index:e.index})}onDelete(e){this.controller.dispatch({type:"delete-item-and-animate-out",id:this.props.id(),setFocusAfterDelete:e.device==="keyboard"})}onDuplicateWithoutFocus(){let e=this.model();e&&(e.type==="folder"?this.controller.dispatch({type:"duplicate-folder",id:this.props.id()}):this.controller.dispatch({type:"duplicate-expression",id:this.props.id()}))}isReadonly(){return this.controller.isItemMarkedReadonly(this.props.id())}onToggleReadonly(){let e=this.model();e&&this.controller.dispatch({type:"set-item-readonly",id:this.props.id(),readonly:!e.readonly})}getReadonlyIcon(){return this.isReadonly()?"dcg-icon-lock":"dcg-icon-pencil"}getReadonlyToggleLabel(){return this.isReadonly()?this.controller.s("graphing-calculator-label-unlock-expression-tooltip"):this.controller.s("graphing-calculator-label-lock-expression-tooltip")}},no=__dcg_shared_module_exports__.e(ne()),ti=__dcg_shared_module_exports__.e(ne()),{If:Wre}=ti.Components,zg=class extends ti.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return ti.createElement("div",{class:ti.const("dcg-action-info"),handleEvent:ti.const("true")},ti.createElement("span",{class:ti.const("dcg-action-label")},ti.const("Run ")),ti.createElement(Mo,R({isStatic:this.const(!0),latex:()=>this.model.clickableInfo.latex,operatorNames:()=>this.getMQConfig().autoOperatorNames,ariaLabel:()=>this.controller.s("graphing-calculator-label-ticker-min-step"),brailleShouldFocus:this.const(!1)},ui(this.controller)),ti.createElement(nt,{latex:()=>this.model.clickableInfo.latex,config:this.bindFn(this.getMQConfig),tokenController:this.props.controller})),ti.createElement("span",{class:ti.const("dcg-action-label")},ti.const(" on click")),ti.createElement(Wre,{predicate:()=>!this.controller.isItemReadonly(this.model.id)},()=>ti.createElement("span",{class:ti.const("dcg-click-edit"),role:ti.const("button"),tabIndex:ti.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-action"),onTap:this.bindFn(this.editAction)},ti.createElement("i",{class:ti.const("dcg-icon-pencil"),"aria-hidden":ti.const("true")}))))}editAction(){this.model.type==="expression"?this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"expression",model:this.model,guid:this.getMenuGUID(),focusFirstOption:!1}}):this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"image",model:this.model,guid:this.getMenuGUID(),focusFirstOption:!1}}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:this.model.id,location:"updaterule"}})}getMenuGUID(){return this.model.guid}getMQConfig(){return this.controller.getMathquillConfig({additionalOperators:["index"]})}},dl=__dcg_shared_module_exports__.e(ne()),Ti=__dcg_shared_module_exports__.e(ne()),Do=__dcg_shared_module_exports__.e(ne()),XT=__dcg_shared_module_exports__.e(ne());qt();var $b=class extends XT.Class{template(){return XT.createElement(nt,{latex:this.props.latex,config:this.props.config,getAriaLabel:this.props.getAriaLabel,tokenController:this.props.tokenController,onUserPressedKey:this.props.onUserPressedKey,didMountMathquill:e=>this.didMountMathquill(e)})}didMountMathquill(e){var t,r;this.mathquillFocus=new Rf(e,ee(e.el()),this.props),this.didUpdate(),(r=(t=this.props).didMountMathquill)==null||r.call(t,e)}willUnmount(){var e;(e=this.mathquillFocus)==null||e.willUnmount()}didUpdate(){var e;(e=this.mathquillFocus)==null||e.updateMathquillFocused()}},JT=__dcg_shared_module_exports__.e(ne()),$re=.9,Pp=class extends JT.Class{template(){return JT.createElement("div",{class:()=>{var e,t;return{"dcg-color-swatch":!0,"dcg-forced-color-none":!0,"dcg-color-evaluation":(t=(e=this.props).isEvaluation)==null?void 0:t.call(e),"dcg-light-color":qf(this.props.color(),this.props.invertSwatches(),$re)}},style:()=>({background:Hf(this.props.color())}),"aria-label":()=>{var e,t;return(t=(e=this.props).ariaLabel)==null?void 0:t.call(e)}})}},{If:z8,SwitchUnion:jre}=Do.Components,qg=class extends Do.Class{init(){this.controller=this.props.controller()}template(){return Do.createElement("div",{class:Do.const("dcg-evaluation-container")},Do.createElement(z8,{predicate:this.bindFn(this.displaySlowEvaluation)},()=>Do.createElement(Le,{tooltip:()=>this.controller.s("shared-calculator-error-slow-evaluation"),sticky:this.const(!0),gravity:this.const("n")},Do.createElement("span",{class:Do.const("dcg-spinner"),"aria-hidden":Do.const("true")}))),Do.createElement("div",{class:()=>({"dcg-evaluation":!0,"dcg-do-blur":!0,"dcg-hidden":this.props.controller().isInEditListMode(),"dcg-slow-evaluation":this.displaySlowEvaluation()}),handleEvent:Do.const("true"),onTap:this.bindFn(this.selectMQIfNothingSelected),tabIndex:()=>this.controller.getBrailleMode()==="none"&&this.getEvaluationRHS().type!=="number"?"0":"-1"},Do.createElement(Mo,R({latex:this.bindFn(this.getBrailleEvaluation),ariaLabel:this.const(""),brailleShouldFocus:()=>this.isFocused(),onBrailleInput:()=>{},onBrailleKeydown:e=>{e.stopPropagation();let t=ke(e);t&&this.handlePressedKey(t)},isStatic:this.const(!0),onBrailleFocusedChanged:e=>this.handleMQFocusedChanged(e)},ui(this.controller)),Do.createElement("div",{class:Do.const("dcg-evaluation-label-container")},Do.createElement(z8,{predicate:this.bindFn(this.shouldShowEquals)},()=>Do.createElement("span",{class:Do.const("dcg-equals")},Do.createElement(nt,{latex:this.const("="),config:this.const({})})))),Do.createElement("span",{class:()=>({"dcg-evaluation-html":!0,"dcg-color-evaluation":this.getEvaluationRHS().type==="rgbcolor"}),didMount:e=>{this.firstLineEvalNode=e}},jre("type",()=>this.getEvaluationRHS())({list:e=>Do.createElement("span",{class:Do.const("dcg-evaluation-list")},()=>this.controller.s("graphing-calculator-label-evaluation-list",{count:e().count})),number:e=>Do.createElement($b,{latex:()=>e().valueLatex,config:this.const({tabbable:!0}),didMountMathquill:t=>this.staticMQ=t,isFocused:()=>this.isFocused(),onFocusedChanged:t=>this.handleMQFocusedChanged(t),onUserPressedKey:this.bindFn(this.handlePressedKey)}),undefined:()=>Do.createElement("span",null,Do.const("undefined")),rgbcolor:e=>Do.createElement(Pp,{color:()=>e().colorValue,isEvaluation:this.const(!0),invertSwatches:()=>this.controller.invertSwatches(),ariaLabel:()=>e().ariaLabel})})))))}selectMQIfNothingSelected(){var e,t;if(this.getEvaluationRHS().type!=="number"||!this.staticMQ)return;let r=this.staticMQ.selection();r.startIndex===r.endIndex&&((e=this.staticMQ)==null||e.blur(),(t=this.staticMQ)==null||t.focus())}handlePressedKey(e){switch(e){case"Up":return this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.props.id()}}),!0;case"PageUp":case"PageDown":case"Down":case"Enter":return this.controller.dispatch({type:"on-special-key-pressed",key:e}),!0;case"Esc":return Jr(),!0}return!1}shouldShowEquals(){return this.getEvaluationRHS().type==="number"}getColorLabel(){let e=this.controller.getItemModel(this.props.id());if(!(!e||e.type!=="expression"))return IT(e,this.controller)}getEvaluationRHS(){var e,t,r;let n=(t=(e=this.props).val)==null?void 0:t.call(e),i=this.props.valueType();if(n===void 0||i===void 0)return{type:"undefined"};let o={valueType:i,value:n};switch(o.valueType){case __dcg_shared_module_exports__.db:let a=__dcg_shared_module_exports__.pa(o.value,ie(R({},__dcg_shared_module_exports__.ha),{displayAsFraction:this.shouldDisplayAsFraction()}));return a==="undefined"?{type:"undefined"}:{type:"number",valueLatex:a};case __dcg_shared_module_exports__.Ha:case __dcg_shared_module_exports__.Ia:return{type:"rgbcolor",colorValue:Array.isArray(o.value)?{type:"color-array",value:o.value}:{type:"single-color",value:o.value},val:o.value,ariaLabel:this.getColorLabel()};case __dcg_shared_module_exports__.wa:return __dcg_shared_module_exports__.ja(o.value,ie(R({},__dcg_shared_module_exports__.ga),{displayAsFraction:this.shouldDisplayAsFraction()})).type==="undefined"?{type:"undefined"}:{type:"number",valueLatex:(r=__dcg_shared_module_exports__.la(o.value,ie(R({},__dcg_shared_module_exports__.ga),{displayAsFraction:this.shouldDisplayAsFraction()})))!=null?r:""};default:return Array.isArray(o.value)?{type:"list",count:o.value.length}:{type:"undefined"}}}shouldDisplayAsFraction(){return this.props.controller().shouldEvaluationForItemDisplayAsFraction(this.props.id())}getBrailleEvaluation(){let e="";this.shouldShowEquals()&&(e+="=");let t=this.getEvaluationRHS();switch(t.type){case"list":e+=this.controller.s("graphing-calculator-label-evaluation-list",{count:t.count});break;case"number":e+=t.valueLatex;break;case"undefined":e="undefined";break;case"rgbcolor":e+=t.val;break;default:return t}return e}displaySlowEvaluation(){return this.controller.shouldShowProgressUpdateIcons()&&this.controller.isItemSlowInEvaluator(this.props.id())}isFocused(){let e=this.controller.getFocusLocation();return(e==null?void 0:e.type)==="expression-evaluation"&&e.id===this.props.id()}handleMQFocusedChanged(e){let t={type:"expression-evaluation",id:this.props.id()};e?this.controller.dispatch({type:"set-focus-location",location:t}):this.controller.dispatch({type:"blur-focus-location",location:t})}},Ps=__dcg_shared_module_exports__.e(ne()),{SwitchUnion:Yre}=Ps.Components,lr=class extends Ps.Class{init(){this.controller=this.props.controller()}template(){return Ps.createElement("div",{class:this.bindFn(this.getContainerClass)},Yre(()=>String(this.props.readonly()),{true:()=>Ps.createElement(Mo,R({latex:this.bindFn(this.getStaticLatex),operatorNames:()=>this.getMQConfig().autoOperatorNames,brailleShouldFocus:this.props.isFocused,isStatic:this.const(!0),onBrailleFocusedChanged:this.props.handleFocusChanged,ariaLabel:this.bindFn(this.getBrailleLabel),dataLabelAttributeValue:this.props.dataLabelAttributeValue},ui(this.props.controller())),Ps.createElement(nt,{latex:this.bindFn(this.getStaticLatex),config:this.bindFn(this.getMQConfig),getAriaLabel:this.props.ariaLabel,tokenController:this.props.controller},Ps.createElement("span",{class:Ps.const("dcg-math-field"),"data-dcg-label":()=>this.props.dataLabelAttributeValue?this.props.dataLabelAttributeValue():void 0,manageFocus:this.const({shouldBeFocused:()=>this.props.isFocused()&&this.controller.getBrailleMode()==="none",onFocusedChanged:(e,t)=>this.props.handleFocusChanged(e,t)}),tabIndex:Ps.const("0")}))),false:()=>Ps.createElement(Mo,R({latex:this.props.latex,operatorNames:()=>this.getMQConfig().autoOperatorNames||"",brailleShouldFocus:this.props.isFocused,selectOnFocus:this.const(!0),onBrailleInput:this.props.handleLatexChanged,onBrailleFocusedChanged:this.props.handleFocusChanged,onBrailleKeydown:this.bindFn(this.onBrailleKeydown),hasError:this.props.hasError,placeholder:this.props.placeholder,ariaLabel:this.bindFn(this.getBrailleLabel),dataLabelAttributeValue:this.props.dataLabelAttributeValue},ui(this.props.controller())),Ps.createElement(Fe,{latex:this.props.latex,getAriaPostLabel:()=>{var e,t;let r=((t=(e=this.props).ariaPostLabel)==null?void 0:t.call(e))||"";return this.props.hasError()&&r===""&&(r=this.controller.s("shared-calculator-narration-math-input-error-message")),r},tokenController:this.props.controller,isFocused:()=>this.props.isFocused()&&this.controller.getBrailleMode()==="none",placeholder:this.props.placeholder,capExpressionSize:()=>this.controller.getCapExpressionSize(),selectOnFocus:this.const(!0),config:this.bindFn(this.getMQConfig),getAriaLabel:this.props.ariaLabel,hasError:this.props.hasError,dataLabelAttributeValue:this.props.dataLabelAttributeValue,onUserPressedKey:this.props.handlePressedKey,onUserChangedLatex:this.props.handleLatexChanged,onSelectionChanged:this.props.handleSelectionChanged,onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:this.props.handleFocusChanged,needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))}))}getStaticLatex(){return this.props.latex()?this.props.latex():this.props.placeholder?this.props.placeholder():""}getContainerClass(){let e=this.props.containerClass?this.props.containerClass():{};return e["dcg-inline-math-input-view"]=!0,this.props.fullWidth&&this.props.fullWidth()&&(e["dcg-full-width-inline-math-input"]=!0),this.props.fontSize&&this.props.fontSize()==="large"&&(e["dcg-large-font-inline-math-input"]=!0),this.props.noBorder&&this.props.noBorder()&&(e["dcg-no-border-inline-math-input"]=!0),e}onBrailleKeydown(e){if(!this.props.handlePressedKey)return;let t=ke(e);t&&this.props.handlePressedKey(t,e)}getMQConfig(){return this.controller.getMathquillConfig({})}getBrailleLabel(){return this.props.brailleLabel?this.props.brailleLabel():this.props.ariaLabel()}},{If:q8}=Ti.Components,cv=class extends Ti.Class{constructor(){super(...arguments),this.focusedValues={}}template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,Ti.createElement("div",{class:Ti.const("dcg-cdf-footer-container dcg-do-blur"),tapboundary:Ti.const("true"),handleEvent:Ti.const("true")},Ti.createElement(mt,{checked:()=>vd(this.model),disabled:()=>AL(this.model)||this.controller.isItemReadonly(this.model.id),onChange:e=>{this.controller.dispatch({type:"set-show-cdf",id:this.model.id,showCDF:e})}},()=>this.controller.s("graphing-calculator-button-find-cdf")),Ti.createElement(q8,{predicate:()=>vd(this.model)},()=>Ti.createElement("div",null,Ti.createElement("span",{class:Ti.const("dcg-cdf-limit-name")},()=>this.controller.s("graphing-calculator-label-cdf-minimum")),Ti.createElement(lr,{handleFocusChanged:e=>this.handleFocusedChanged("min",e),latex:()=>hT(this.model),hasError:()=>!mT(this.model),isFocused:()=>this.isInputFocused("min"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-cdf-minimum"),placeholder:()=>gH(this.model),handlePressedKey:(e,t)=>this.handlePressedKey(e,t,"min"),controller:this.props.controller,handleLatexChanged:this.bindFn(this.updateCDFMin),readonly:()=>this.controller.isItemReadonly(this.model.id)}),Ti.createElement("span",{class:Ti.const("dcg-cdf-limit-name")},()=>this.controller.s("graphing-calculator-label-cdf-maximum")),Ti.createElement(lr,{handleFocusChanged:e=>this.handleFocusedChanged("max",e),latex:()=>gT(this.model),hasError:()=>!fT(this.model),isFocused:()=>this.isInputFocused("max"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-cdf-maximum"),placeholder:()=>mH(this.model),handlePressedKey:(e,t)=>this.handlePressedKey(e,t,"max"),controller:this.props.controller,handleLatexChanged:this.bindFn(this.updateCDFMax),readonly:()=>this.controller.isItemReadonly(this.model.id)}),Ti.createElement(q8,{predicate:this.bindFn(this.showEvaluation)},()=>Ti.createElement("div",{class:Ti.const("dcg-cdf-evaluation-container")},Ti.createElement(qg,{val:()=>VL(this.model),controller:this.props.controller,id:()=>this.model.id,valueType:this.const(__dcg_shared_module_exports__.wa)}))))))}handlePressedKey(e,t,r){if(e==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(e==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});let n=Fe.getFocusedMathquill();n&&(n.keystroke(e,t),r==="min"&&hT(this.model)!==n.latex()&&this.updateCDFMin(n.latex()),r==="max"&&gT(this.model)!==n.latex()&&this.updateCDFMax(n.latex()))}updateCDFMax(e){this.controller.dispatch({type:"set-cdf-max",id:this.model.id,latex:e})}updateCDFMin(e){this.controller.dispatch({type:"set-cdf-min",id:this.model.id,latex:e})}showEvaluation(){return JE(this.model)}isInputFocused(e){let t=this.controller.getFocusLocation();return!t||t.type!=="cdf-limit"||t.id!==this.id?!1:t.location===e}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"cdf-limit",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"cdf-limit",id:this.id,location:e}})}},Mn=__dcg_shared_module_exports__.e(ne()),{If:Xre,For:H8,SwitchUnion:Jre}=Mn.Components,jb=class extends Mn.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Jre(this.bindFn(this.getSuggestionType),{list:()=>Mn.createElement("div",{class:()=>({"dcg-parameter-suggestion-container":!0,"dcg-parameter-suggestion-braille":this.controller.getBrailleMode()!=="none"})},Mn.createElement(H8,{each:this.bindFn(this.getListOfParameters)},e=>Mn.createElement("span",{class:Mn.const("dcg-parameter-name")},()=>this.getParamName(e)))),listWithDefault:()=>Mn.createElement("div",{class:()=>({"dcg-parameter-suggestion-container":!0,"dcg-parameter-suggestion-braille":this.controller.getBrailleMode()!=="none"}),onTap:this.bindFn(this.fillInDefaults)},Mn.createElement(H8,{each:this.bindFn(this.getListOfParameters)},e=>Mn.createElement("span",{class:Mn.const("dcg-parameter-name")},()=>this.getParamName(e),Mn.createElement(Xre,{predicate:()=>this.shouldShowDefaultValue(e)},()=>Mn.createElement("span",{class:Mn.const("dcg-default-marker")},Mn.const("= "),()=>this.getDefaultValue(e)))))),individual:()=>Mn.createElement("div",{class:()=>({"dcg-parameter-suggestion-container":!0,"dcg-parameter-suggestion-braille":this.controller.getBrailleMode()!=="none"})},this.bindFn(this.getMissingRequiredParamText)),none:()=>{}})}getExtractedAndDefaultArgString(e){let{params:t,values:r,defaults:n}=e;return t.map((i,o)=>{let a=r[i],s=n[o];return a||s||""}).join(",")}fillInDefaults(){let e=sl(this.model);if(!e)return;let{symbol:t,span:r}=e,{input:n,start:i,end:o}=r,a=this.getExtractedAndDefaultArgString(e),s=`\\operatorname{${t}}\\left(${a}\\right)`,l=`${n.slice(0,i)}${s}${n.slice(o)}`;this.controller.dispatch({type:"set-item-latex",id:this.id,latex:l}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}),this.controller.dispatch({type:"keypad/press-key",key:"Left"})}isMissingDefault(){if(!Yw(this.model))return!1;let e=sl(this.model);if(!e)return!1;for(let t=0;t<e.params.length;t++)if(this.shouldShowDefaultValue(e.params[t]))return!0;return!1}getSuggestionType(){return this.getListOfParameters().length>1?this.isMissingDefault()?"listWithDefault":"list":this.missingRequiredParam()?"individual":"none"}missingRequiredParam(){let e=sl(this.model);if(!e||e.params.length!==1)return;let t=e.params[0];if(!this.getDefaultValue(t)&&!this.getParameterExtractedValue(t))return t}getMissingRequiredParamText(){let e=this.missingRequiredParam();return e?this.controller.s("graphing-calculator-text-enter-pareneter",{param:this.getParamName(e)}):""}getDefaultValue(e){let t=sl(this.model);if(!t||!t.params)return"";for(let r=0;r<t.params.length;r++)if(t.params[r]===e)return t.defaults[r]||"";return""}getParameterExtractedValue(e){let t=sl(this.model);return t&&t.values[e]||""}shouldShowDefaultValue(e){return!this.getParameterExtractedValue(e)&&!!this.getDefaultValue(e)}getListOfParameters(){let e=sl(this.model);return e?e.params:[]}getParamName(e){switch(e){case"mean":return this.controller.s("graphing-calculator-text-parameter-name-mean");case"stdev":return this.controller.s("graphing-calculator-text-parameter-name-stddev");case"dof":return this.controller.s("graphing-calculator-text-parameter-name-dof");case"probsuccess":return this.controller.s("graphing-calculator-text-parameter-name-probsuccess");case"trials":return this.controller.s("graphing-calculator-text-parameter-name-trials");case"data":return this.controller.s("graphing-calculator-text-parameter-name-data");case"binwidth":return this.controller.s("graphing-calculator-text-parameter-name-binwidth");case"min":return this.controller.s("graphing-calculator-text-parameter-name-min");case"max":return this.controller.s("graphing-calculator-text-parameter-name-max");case"height":return this.controller.s("graphing-calculator-text-parameter-name-height");case"offset":return this.controller.s("graphing-calculator-text-parameter-name-offset");default:return e}}},{If:Qre}=dl.Components,dv=class extends dl.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,dl.createElement("div",{class:dl.const("dcg-distribution-parameters-container dcg-do-blur"),tapboundary:dl.const("true"),handleEvent:dl.const("true")},dl.createElement(jb,{model:this.props.model,controller:this.props.controller}),dl.createElement(Qre,{predicate:()=>IL(this.model)},()=>dl.createElement(cv,{model:this.props.model,controller:this.props.controller})))}},ri=__dcg_shared_module_exports__.e(ne()),Sc=__dcg_shared_module_exports__.e(ne()),Md=class extends Sc.Class{template(){return Sc.createElement(Le,{tooltip:()=>this.props.controller().s("shared-calculator-label-toast-learn-more")},Sc.createElement("a",{"aria-label":()=>this.props.controller().s("shared-calculator-label-toast-learn-more"),class:Sc.const("dcg-learn-more-link"),href:this.props.href,target:Sc.const("_blank")},Sc.createElement("i",{class:Sc.const("dcg-icon-question-sign"),"aria-hidden":Sc.const("true")})))}},{If:gP}=ri.Components,QT=class extends ri.Class{constructor(){super(...arguments),this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}handlePressedKey(e,t,r){if(!this.controller.isInEditListMode()){if(t==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(t==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"})}let n=Fe.getFocusedMathquill(),i=os();if(t==="Left"||t==="Right"||t==="Down"||t==="Up"){let o;n?o=Fe.applyArrowKeyAndReturnIfWasAtBounds(n,t,r):i&&(i.selectionStart===0&&t==="Left"||i.selectionStart===i.value.length&&t==="Right"||t==="Up"||t==="Down")?o=!0:o=!1,o&&(r&&r.preventDefault(),t==="Left"?e==="max"+this.getDomainVariableString()&&this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.model.id,location:"min"+this.getDomainVariableString()}}):t==="Right"?e==="min"+this.getDomainVariableString()&&this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.model.id,location:"max"+this.getDomainVariableString()}}):t==="Down"?this.controller.dispatch({type:"on-special-key-pressed",key:"Down"}):t==="Up"&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.model.id}}));return}n&&(n.keystroke(t,r),e==="min"+this.getDomainVariableString()?this.dispatchMinLatexIfChanged(n.latex()):e==="max"+this.getDomainVariableString()&&this.dispatchMaxLatexIfChanged(n.latex()))}getDomainVariable(){var e,t;let r=this.props.domainIndex(),n=(t=(e=this.model.formula.domains)==null?void 0:e[r])==null?void 0:t.variable;if(!n)throw new Error("Programming Error: could not find domain variable in index "+r);return n}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"domain-limit",id:this.id,location:e}})}dispatchMinLatexIfChanged(e){this.getMinLatex()!==e&&this.controller.dispatch({type:"set-domain-minlatex",variable:this.getDomainVariable(),id:this.id,latex:e})}dispatchMaxLatexIfChanged(e){this.getMaxLatex()!==e&&this.controller.dispatch({type:"set-domain-maxlatex",variable:this.getDomainVariable(),id:this.id,latex:e})}getFocusedInput(){let e=this.controller.getFocusLocation();if(!(!e||e.type!=="domain-limit"||e.id!==this.id))return e.location}getMinLatex(){return oH(this.model,this.getDomainVariable())}getMaxLatex(){return iH(this.model,this.getDomainVariable())}getDomainVariableString(){let e=this.getDomainVariable();return e==="theta"?e="\\theta":e==="phi"&&(e="\\phi"),e}getDomainVariableDisplayLatex(){return"\\le "+this.getDomainVariableString()+" \\le"}getPlaceholder(e){return __dcg_shared_module_exports__.ea(e).string.replace("π","\\pi")}template(){return ri.createElement("div",{class:ri.const("dcg-domain dcg-do-blur"),handleEvent:ri.const("true")},ri.createElement("div",{class:ri.const("dcg-display-domain dcg-do-blur"),handleEvent:ri.const("true")},ri.createElement(lr,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.getMinLatex(),isFocused:()=>this.getFocusedInput()==="min"+this.getDomainVariableString(),placeholder:()=>this.getPlaceholder(Oq(this.model,this.getDomainVariable())),ariaLabel:()=>this.controller.s("graphing-calculator-narration-domain3d-minimum",{term:this.getDomainVariableString()}),brailleLabel:()=>this.controller.raw("dmin"),handleFocusChanged:e=>this.handleFocusedChanged("min"+this.getDomainVariableString(),e),hasError:()=>!Fq(this.model,this.getDomainVariable()),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("min"+this.getDomainVariableString(),e,t),handleLatexChanged:e=>this.dispatchMinLatexIfChanged(e),dataLabelAttributeValue:this.const("domain-min")}),ri.createElement("span",{class:ri.const("dcg-interval-interior")},ri.createElement(nt,{latex:()=>this.getDomainVariableDisplayLatex(),config:this.const({})})),ri.createElement(lr,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.getMaxLatex(),isFocused:()=>this.getFocusedInput()==="max"+this.getDomainVariableString(),placeholder:()=>this.getPlaceholder(Rq(this.model,this.getDomainVariable())),ariaLabel:()=>this.controller.s("graphing-calculator-narration-domain3d-maximum",{term:this.getDomainVariableString()}),brailleLabel:()=>this.controller.raw("dmax"),handleFocusChanged:e=>this.handleFocusedChanged("max"+this.getDomainVariableString(),e),hasError:()=>!Nq(this.model,this.getDomainVariable()),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("max"+this.getDomainVariableString(),e,t),handleLatexChanged:e=>this.dispatchMaxLatexIfChanged(e),dataLabelAttributeValue:this.const("domain-max")}),ri.createElement(gP,{predicate:()=>this.getDomainVariableString()==="\\phi"},()=>ri.createElement(Md,{href:this.const("https://help.desmos.com/hc/en-us/articles/15824510769805"),controller:this.props.controller}))))}},pv=class extends ri.Class{constructor(){super(...arguments),this.model=this.props.model()}hasFirstDomainIndex(){return Wu(this.model)||Dp(this.model)&&!aH(this.model)}hasSecondDomainIndex(){return Dp(this.model)?!sH(this.model):!1}template(){return ri.createElement("div",null,ri.createElement(gP,{predicate:this.bindFn(this.hasFirstDomainIndex)},()=>ri.createElement(QT,{controller:this.props.controller,model:this.props.model,domainIndex:this.const(0)})),ri.createElement(gP,{predicate:this.bindFn(this.hasSecondDomainIndex)},()=>ri.createElement(QT,{controller:this.props.controller,model:this.props.model,domainIndex:this.const(1)})))}},eo=__dcg_shared_module_exports__.e(ne()),{Switch:Zre}=eo.Components,uv=class extends eo.Class{init(){this.controller=this.props.controller()}template(){return eo.createElement("div",{class:eo.const("dcg-expression-warning dcg-text-selectable"),handleEvent:eo.const("true"),role:eo.const("note")},eo.createElement("i",{class:eo.const("dcg-icon-error"),"aria-hidden":eo.const("true")}),eo.createElement(Zre,{key:()=>this.props.warning()},e=>{switch(e==null?void 0:e.type){case"unresolved":return eo.createElement("span",null,()=>this.controller.s("graphing-calculator-error-equation-contains-unresolved-details"),eo.createElement("a",{href:eo.const("https://help.desmos.com/hc/en-us/articles/202529079-Unresolved-Detail-In-Plotted-Functions"),target:eo.const("_blank")},()=>this.controller.s("graphing-calculator-link-learn-more")));case"expressionTooComplex":return eo.createElement("span",null,()=>this.controller.s("shared-calculator-error-gpu-expression-too-complex"),eo.createElement("a",{href:eo.const("https://help.desmos.com/hc/en-us/articles/26801641850893-GPU-Error-while-Plotting-an-Expression"),target:eo.const("_blank")},()=>this.controller.s("graphing-calculator-link-learn-more")));case"tone-out-of-range":return eo.createElement("span",null,()=>this.controller.s("graphing-calculator-error-tone-frequency-out-of-range",{min:gb,max:mb}));case"recursive-depth-plotting-error":return eo.createElement("span",null,()=>this.controller.s("graphing-calculator-error-reached-maximum-recursion-depth"));case"nan-blame-complex-coercion":return eo.createElement("span",null,()=>this.controller.s("graphing-calculator-error-nan-blame-complex-coercion"));case"legacy-random-seed-behavior":return eo.createElement("span",null,()=>this.controller.s("graphing-calculator-error-legacy-random-seed-behavior"),eo.createElement("a",{href:eo.const("https://help.desmos.com/hc/en-us/articles/25261997911181-Change-to-Random-Seeds-in-Function-Definitions"),target:eo.const("_blank"),class:eo.const("dcg-warning-footer-learn-more")},()=>this.controller.s("graphing-calculator-link-learn-more")),eo.createElement("button",{onTap:()=>{this.controller.dispatch({type:"update-legacy-random-seed-behavior"})},class:eo.const("dcg-btn-light-gray dcg-update-behavior-btn dcg-unstyled-button")},()=>this.controller.s("graphing-calculator-label-update-to-new-behavior")));case"evaluation":return eo.createElement("span",null,()=>e.message);case void 0:return}}))}},ln=__dcg_shared_module_exports__.e(ne()),{Input:eoe,IfElse:mP,IfDefined:toe,If:K8}=ln.Components,Hg=class extends ln.Class{template(){return this.controller=this.props.controller(),ln.createElement("div",{class:()=>({"dcg-label-visible":this.getShowLabel(),"dcg-label-input-visible":!this.getIsDisabled(),"dcg-label-container":!0,"dcg-do-blur":!0}),tapboundary:ln.const("true"),handleEvent:ln.const("true")},mP(()=>{var e,t;return!!((t=(e=this.props).forceEnabled)!=null&&t.call(e))},{true:()=>ln.createElement("span",null,()=>this.controller.s("graphing-calculator-button-label")+":"),false:()=>ln.createElement(mt,{onChange:this.bindFn(this.onCheckboxInput),checked:this.bindFn(this.getShowLabel)},()=>this.controller.s("graphing-calculator-button-label")+(this.getIsDisabled()?"":":"))}),mP(this.bindFn(this.hasEditableLabel),{true:()=>ln.createElement("div",{class:ln.const("dcg-editable-mode-toggle")},ln.createElement(vo,{theme:this.const("mini"),staticConfig:this.bindFn(this.getEditableLabelOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-editable-label-mode")})),false:()=>mP(()=>{var e,t;return!!((t=(e=this.props).displayComputedValue)!=null&&t.call(e))},{false:()=>ln.createElement(K8,{predicate:()=>{var e,t;return!((t=(e=this.props).suppressInput)!=null&&t.call(e))}},()=>ln.createElement(K8,{predicate:()=>!this.getIsDisabled()},()=>{var e;return ln.createElement(eoe,{class:()=>({"dcg-label-input":!0,"dcg-readonly":this.getIsReadonly(),"dcg-disabled-editable-input":this.hasEditableLabel()}),disabled:this.bindFn(this.getIsReadonly),"aria-label":()=>this.controller.s("graphing-calculator-narration-label-text"),manageFocus:(e=this.props.manageInputFocus)!=null?e:()=>{},didMount:t=>{var r,n;this.inputNode=t,(n=(r=this.props).selectInputOnMount)!=null&&n.call(r)&&t.select()},"aria-disabled":()=>this.getIsDisabled()||this.hasEditableLabel()||this.getIsReadonly(),value:this.bindFn(this.getLabel),onInput:this.bindFn(this.onLabelInput)})})),true:()=>toe(()=>{var e,t;return(t=(e=this.props).displayComputedValue)==null?void 0:t.call(e)},e=>ln.createElement("div",{class:ln.const("dcg-computed-label-value")},ln.createElement(nt,{latex:e,config:()=>this.controller.getMathquillConfig({})})))})}))}getEditableLabelOptions(){return[{key:"math",label:()=>this.controller.s("graphing-calculator-button-editable-math"),selected:()=>this.model().editableLabelMode==="MATH",onSelect:()=>this.setEditableLabelMode("MATH")},{key:"text",label:()=>this.controller.s("graphing-calculator-button-editable-text"),selected:()=>this.model().editableLabelMode==="TEXT",onSelect:()=>this.setEditableLabelMode("TEXT")}]}setEditableLabelMode(e){this.controller.dispatch({type:"set-item-editable-label-mode",id:this.id(),editableLabelMode:e})}getIsReadonly(){return this.controller.isItemReadonly(this.model().id)}model(){return this.props.model()}id(){return this.model().id}getLabel(){return this.model().label||""}hasEditableLabel(){return xb(this.model())}getShowLabel(){var e,t;return ja(this.model())&&!((t=(e=this.props).displayComputedValue)!=null&&t.call(e))}getIsDisabled(){var e,t;return(t=(e=this.props).forceEnabled)!=null&&t.call(e)||document.activeElement===this.inputNode?!1:this.getLabel().length===0&&!this.getShowLabel()}onLabelInput(e){let t=e;this.controller.dispatch({type:"set-item-label",id:this.id(),label:t}),this.controller.dispatch({type:"set-item-showlabel",id:this.id(),showLabel:!!t})}onCheckboxInput(){this.controller.dispatch({type:"set-item-showlabel",id:this.id(),showLabel:!this.getShowLabel()})}},Ta=__dcg_shared_module_exports__.e(ne()),hv=class extends Ta.Class{constructor(){super(...arguments),this.controller=this.props.controller(),this.id=this.props.id()}template(){return Ta.createElement("div",{class:Ta.const("dcg-prompt-rename"),handleEvent:Ta.const("true")},()=>Ls("graphing-calculator-label-rename"),Ta.createElement("span",{class:Ta.const("dcg-btn-light-gray"),onTap:this.bindFn(this.handleRename),tabIndex:Ta.const(0),role:Ta.const("button")},Ta.createElement(nt,{latex:()=>`${this.getRenameIdentifierFrom()} \\to ${this.getRenameIdentifierTo()}`,config:this.const({})},Ta.createElement("span",{style:Ta.const("pointer-events:none")}))),Ta.createElement("span",{class:Ta.const("dcg-reference-count")},()=>Ls(this.getRenameIdentifierFolderId()!==void 0?"graphing-calculator-label-reference-count-in-folder":"graphing-calculator-label-reference-count",{count:__dcg_shared_module_exports__.ra(this.getRenameCountOfChanges())})))}getRenameIdentifierFrom(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e&&e.from||""}getRenameIdentifierTo(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e&&e.to||""}getRenameCountOfChanges(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e&&e.countOfChanges||0}getRenameIdentifierFolderId(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e==null?void 0:e.folderId}handleRename(){let e={search:this.getRenameIdentifierFrom(),replace:this.getRenameIdentifierTo()},t=this.getRenameIdentifierFolderId();t===void 0?this.controller.dispatch(R({type:"rename-identifier-global"},e)):this.controller.dispatch(R({type:"rename-identifier-in-item",id:t},e))}},oi=__dcg_shared_module_exports__.e(ne()),{For:roe,If:ooe}=oi.Components,Ec=class extends oi.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.promptGroupId=`prompt-slider-${Dd()}`}template(){return oi.createElement("div",{class:oi.const("dcg-create-sliders"),handleEvent:oi.const("true"),role:oi.const("group"),"aria-labelledby":this.const(this.promptGroupId)},oi.createElement("span",{class:oi.const("dcg-msg"),id:this.const(this.promptGroupId)},this.bindFn(this.getPromptMsg)),oi.createElement("span",{class:oi.const("btns")},oi.createElement("span",null,oi.createElement(roe,{each:this.bindFn(this.getMissingVariables)},e=>oi.createElement("div",{class:oi.const("dcg-slider-btn-container")},oi.createElement("button",{class:()=>({"dcg-btn-slider":!0,"dcg-btn-blue":this.getMissingVariables().length===1,"dcg-base-case-btn":this.getMissingBaseCases().length>0,"dcg-btn-light-gray":this.getMissingVariables().length!==1}),onTap:t=>this.onCreateSlider(t,[e])},oi.createElement(nt,{config:this.const({}),latex:()=>e}))))),oi.createElement(ooe,{predicate:()=>this.getMissingVariables().length>1},()=>oi.createElement("div",{class:oi.const("dcg-slider-btn-container dcg-all")},oi.createElement("button",{class:oi.const("dcg-btn-slider dcg-btn-blue"),onTap:e=>this.onCreateSlider(e,this.getMissingVariables())},()=>this.controller.s("graphing-calculator-button-slider-add-all-variables"))))))}getPromptMsg(){return this.getMissingBaseCases().length>0?this.controller.s("graphing-calculator-label-add-base-case"):this.controller.s("graphing-calculator-label-add-slider")}onCreateSlider(e,t){this.model.type==="ticker"?this.controller.dispatch({type:"create-sliders-for-ticker",variables:t}):this.controller.dispatch({type:"create-sliders-for-item",id:this.model.id,variables:t}),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.model.id}})}getMissingBaseCases(){return this.model.type!=="expression"?[]:Ep(this.model)}getMissingVariables(){let e=this.getMissingBaseCases();return e.length>0?e:(this.model.type==="ticker"?Sw(this.model):Iw(this.model)).slice(0,zw)}},Ke=__dcg_shared_module_exports__.e(ne()),gv=__dcg_shared_module_exports__.e(ne()),pl=class extends gv.Class{init(){this.controller=this.props.controller()}template(){return gv.createElement(Mo,ie(R({latex:this.props.latex,brailleShouldFocus:this.bindFn(this.shouldFocus),onBrailleFocusedChanged:this.bindFn(this.onFocusChange),isStatic:this.const(!0),ariaLabel:this.props.brailleAriaLabel||this.props.ariaLabel},ui(this.controller)),{onBrailleKeydown:e=>{var t,r;return(r=(t=this.props).onKeypress)==null?void 0:r.call(t,e)},tabIndex:()=>this.props.tabbable()?0:-1}),gv.createElement($b,{latex:this.props.latex,config:this.const({tabbable:this.props.tabbable()}),isFocused:this.bindFn(this.shouldFocus),onFocusedChanged:this.bindFn(this.onFocusChange),getAriaLabel:this.props.ariaLabel,onUserPressedKey:(e,t)=>{t&&this.props.onKeypress&&this.props.onKeypress(t)}}))}shouldFocus(){return __dcg_shared_module_exports__.E(this.props.focusLocation(),this.controller.getFocusLocation())}onFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:this.props.focusLocation()}):this.controller.dispatch({type:"blur-focus-location",location:this.props.focusLocation()})}},W8=1e-6,$8=1e9;function fP(e,t){let r=Math.max(bP(e.parameters[t]),e.displayPrecision);return __dcg_shared_module_exports__.la(e.parameters[t],{digits:r,scientificNotationDigits:r-1,smallCutoff:W8,bigCutoff:$8})}function bP(e){let t=Math.abs(e);if(t>=$8||t<W8||t<=1)return 6;let r=Math.floor(Math.log10(t))+1;return Math.min(9,r+5)}function yP(e){return __dcg_shared_module_exports__.la(e,{zeroCutoff:1e-15,digits:4,smallCutoff:1e-6,bigCutoff:1e9})}var ns=__dcg_shared_module_exports__.e(ne()),{If:ioe}=ns.Components,ZT=class extends ns.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return ns.createElement(ioe,{predicate:()=>this.controller.showResidualsZoomFitButton(this.model)},()=>ns.createElement("div",{class:ns.const("dcg-residuals-zoom-view dcg-do-blur"),handleEvent:ns.const(!0)},ns.createElement(Le,{tooltip:this.bindFn(this.getZoomText),gravity:()=>"e"},ns.createElement("i",{onTap:this.bindFn(this.onZoom),role:ns.const("button"),tabIndex:ns.const("0"),"aria-label":this.bindFn(this.getZoomText),class:ns.const("dcg-icon-zoom-fit"),manageFocus:this.const(rt({controller:this.controller,location:{type:"regression-output",id:this.props.model().id,parameter:"residual-zoom"}}))}))))}getZoomText(){return this.controller.s("graphing-calculator-text-zoom-fit")}onZoom(e){this.controller.dispatch({type:"expression-zoom-fit-residuals",id:this.model.id,focusAfterTap:e.device==="keyboard"})}},{If:oh,For:j8,IfElse:noe}=Ke.Components,eD=class extends Ke.Class{template(){return Ke.createElement("div",{class:Ke.const("dcg-parameter-warning dcg-text-selectable"),role:Ke.const("note")},Ke.createElement("i",{class:Ke.const("dcg-icon-error"),"aria-hidden":Ke.const("true")}),Ke.const(" "),()=>this.props.controller().s("graphing-calculator-text-regression-potentially-inaccurate-parameters"),Ke.const(" "),Ke.createElement("a",{href:Ke.const("https://help.desmos.com/hc/en-us/articles/360042942771"),target:Ke.const("_blank")},()=>this.props.controller().s("graphing-calculator-link-learn-more")))}},Yb=class extends Ke.Class{template(){return Ke.createElement(Le,{tooltip:this.props.tooltip,gravity:this.const("s")},Ke.createElement("a",{class:Ke.const("dcg-expression-footer-title-help"),target:Ke.const("_blank"),href:this.props.helpURL,"aria-label":this.props.tooltip},Ke.createElement("i",{class:Ke.const("dcg-icon-question-sign"),"aria-hidden":Ke.const("true")})))}},Xb=class extends Ke.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,Ke.createElement("div",{class:Ke.const("dcg-regression-footer-view")},Ke.createElement("div",{class:Ke.const("dcg-handle-event"),handleEvent:Ke.const("true")},Ke.createElement(oh,{predicate:()=>{var e,t;return this.hasParameterWarning()&&!!((t=(e=this.props).hideParameters)!=null&&t.call(e))}},()=>Ke.createElement(eD,R({},this.props))),Ke.createElement(oh,{predicate:this.bindFn(this.getShouldSuggestLogMode)},()=>Ke.createElement("div",{class:Ke.const("dcg-log-mode-toggle")},noe(()=>this.areLogModeRegressionsForced(),{true:()=>Ke.createElement("div",{class:Ke.const("dcg-action-log-mode-toggle dcg-no-hover-styling")},()=>this.controller.s("graphing-calculator-button-regression-log-mode")),false:()=>Ke.createElement("div",null,Ke.createElement(mt,{class:this.const("dcg-action-log-mode-toggle dcg-log-mode-checkbox"),onChange:this.bindFn(this.onTapLogMode),checked:()=>this.getIsLogModeRegression()},()=>this.controller.s("graphing-calculator-button-regression-log-mode")),Ke.createElement(Yb,{helpURL:this.const("https://help.desmos.com/hc/en-us/articles/204349605"),tooltip:()=>this.controller.s("graphing-calculator-label-regression-log-mode-help-tooltip")}))}))),Ke.createElement(oh,{predicate:()=>this.shouldShowParameters()&&Object.keys(this.getRegression().parameters).length>0},()=>Ke.createElement(xP,{controller:this.props.controller,id:this.const(this.id),regression:()=>this.getRegression()})),Ke.createElement("div",{class:Ke.const("dcg-statistics"),role:Ke.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-regression-statistics")},Ke.createElement("div",{class:Ke.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-regression-statistics"),Ke.createElement(oh,{predicate:this.bindFn(this.showRMSENotice)},()=>Ke.createElement(Yb,{helpURL:this.const("https://help.desmos.com/hc/en-us/articles/202529129-What-is-RMSE-"),tooltip:()=>this.controller.s("graphing-calculator-label-regression-what-is-rmse-tooltip")})),Ke.createElement(oh,{predicate:this.bindFn(this.showNegativeRSquaredWarning)},()=>Ke.createElement(Yb,{helpURL:this.const("https://help.desmos.com/hc/en-us/articles/202529139-Why-am-I-seeing-a-negative-R-2-value-"),tooltip:()=>this.controller.s("graphing-calculator-label-regression-why-is-negative-tooltip")}))),Ke.createElement("div",{class:Ke.const("dcg-statistics-values")},Ke.createElement(j8,{each:this.bindFn(this.getStatisticsSections),key:e=>e.type+":"+e.value},e=>{let t=e.value;return t===void 0?Ke.createElement("div",null,Ke.createElement(es,{mqConfig:this.const({}),content:()=>this.controller.s("graphing-calculator-text-undefined-parameter",{parameter:"`"+e.type+"`"})})):Ke.createElement("div",{class:()=>({"dcg-indented-r-value":e.type==="r"})},Ke.createElement(pl,{latex:()=>`\\operatorname{${e.type}}=`+yP(t),ariaLabel:this.const(""),tabbable:this.const(!0),focusLocation:this.const({type:"regression-output",id:this.id,parameter:e.type}),controller:this.props.controller}))}))),Ke.createElement("div",{role:Ke.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-regression-residuals"),class:Ke.const("dcg-residuals")},Ke.createElement("div",{class:Ke.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-regression-residuals")),Ke.createElement(pl,{latex:this.bindFn(this.getResidualVariable),ariaLabel:this.const(""),tabbable:this.const(!0),focusLocation:this.const({type:"regression-output",id:this.id,parameter:this.getResidualVariable()}),controller:this.props.controller}),Ke.createElement(oh,{predicate:this.bindFn(this.getResidualSuggestionVisible)},()=>Ke.createElement("div",{class:Ke.const("dcg-residual-suggestion dcg-action-plot-residual dcg-btn dcg-btn-light-gray"),role:Ke.const("button"),tabIndex:Ke.const("0"),onTap:this.bindFn(this.onTapResidualsSuggestion)},()=>this.controller.s("graphing-calculator-button-regression-plot-residuals"))),Ke.createElement(ZT,{model:this.props.model,controller:this.props.controller})),Ke.createElement("div",{class:Ke.const("dcg-clear")}),Ke.createElement(oh,{predicate:()=>{var e,t;return this.hasParameterWarning()&&!((t=(e=this.props).hideParameters)!=null&&t.call(e))}},()=>Ke.createElement(eD,R({},this.props)))))}showNegativeRSquaredWarning(){let e=this.getStatisticsSections();return __dcg_shared_module_exports__.k(e,t=>t.type==="R^2"&&t.value!==void 0&&t.value<0)}showRMSENotice(){let e=this.getStatisticsSections();return __dcg_shared_module_exports__.k(e,t=>t.type==="RMSE")}getStatisticsSections(){var e,t,r,n,i,o;let a=[],s=this.getRegression().statistics;return s.RMSE!==void 0&&((t=(e=this.props).suppressRMSE)!=null&&t.call(e)?a.push({type:"R^2",value:void 0}):a.push({type:"RMSE",value:s.RMSE})),s.Rsquared!==void 0&&a.push({type:"R^2",value:s.Rsquared}),s.rsquared!==void 0&&a.push({type:"R^2",value:s.rsquared}),s.r!==void 0&&((n=(r=this.props).showRValue)==null?void 0:n.call(r))!=="never"?a.push({type:"r",value:s.r}):((o=(i=this.props).showRValue)==null?void 0:o.call(i))==="always"&&a.push({type:"r",value:void 0}),a}shouldShowParameters(){return!this.props.hideParameters||!this.props.hideParameters()}onTapResidualsSuggestion(){this.controller.dispatch({type:"plot-residuals",id:this.id})}onTapLogMode(){this.controller.dispatch({type:"toggle-logmode",id:this.id})}getRegression(){return this.props.regression()}getResidualVariable(){return this.getRegression().residualVariable||""}getResidualSuggestionVisible(){return this.getRegression().residualSuggestionId!==void 0}areLogModeRegressionsForced(){return this.controller.areLogModeRegressionsForced()}getShouldSuggestLogMode(){var e,t;return(t=(e=this.props).suppressLogModeCheckbox)!=null&&t.call(e)?!1:!!this.getRegression().shouldSuggestLogMode}hasParameterWarning(){return!!this.getRegression().parameterWarning}getIsLogModeRegression(){var e;return this.model.type==="expression"?!!this.model.isLogModeRegression:!!((e=this.model.regression)!=null&&e.isLogMode)}},xP=class extends Ke.Class{init(){this.controller=this.props.controller(),this.id=this.props.id()}template(){return Ke.createElement("div",{class:Ke.const("dcg-parameters-container")},Ke.createElement("div",{class:Ke.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-regression-parameters"),Ke.createElement(oh,{predicate:()=>!this.props.regression().isLinear},()=>Ke.createElement(Yb,{helpURL:this.const("https://help.desmos.com/hc/en-us/articles/360042428612"),tooltip:()=>this.controller.s("graphing-calculator-label-regression-parameters-not-exact")}))),Ke.createElement("div",{role:Ke.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-regression-parameters"),class:Ke.const("dcg-parameters")},Ke.createElement(j8,{each:()=>Object.keys(this.props.regression().parameters)},e=>Ke.createElement(pl,{latex:()=>this.getParameterEquationLatex(e),ariaLabel:this.const(""),tabbable:this.const(!0),focusLocation:this.const({type:"regression-output",id:this.id,parameter:e}),controller:this.props.controller}))))}getParameterEquationLatex(e){return e+"="+fP(this.props.regression(),e)}},mi=__dcg_shared_module_exports__.e(ne()),hi=__dcg_shared_module_exports__.e(ne());qt(),qt();var aoe=0,soe=`guid_${Math.round(Math.random()*1e6)}_${new Date().getTime()}_`;function wP(e,t,r){var n;(n=e[t])==null||n.forEach(i=>i.callback(t,r))}function vP(e,t){t.split(" ").forEach(r=>{var n,i;let[o,a]=r.split(".");if(o&&a)e[o]=(n=e[o])==null?void 0:n.filter(s=>s.namespace!==a);else if(o)delete e[o];else if(a)for(let s in e)e[s]=(i=e[s])==null?void 0:i.filter(l=>l.namespace!==a)})}function CP(e,t,r){t.split(" ").forEach(n=>{var i;let[o,a]=n.split("."),s={namespace:a,callback:r};e[o]||(e[o]=[]),(i=e[o])==null||i.push(s)})}var Kl=class{constructor(){this.__eventObservers={},this.guid=soe+ ++aoe}triggerEvent(e,t){wP(this.__eventObservers,e,t)}observeEvent(e,t){CP(this.__eventObservers,e,t)}unobserveEvent(e){vP(this.__eventObservers,e)}},tD=class{constructor(){this._eventBus=new Kl,this.dragging=!1,this.guid=__dcg_shared_module_exports__.K("dragdrop-class")}_evt2pt(e){return{x:e.changedTouches[0].pageX-this._offsetPt.x,y:e.changedTouches[0].pageY-this._offsetPt.y}}_dispatch(e,t){if(this._destroyed)return;let r=this._evt2pt(t);this._eventBus.triggerEvent(e,{x:r.x,y:r.y,dx:r.x-this._startPt.x,dy:r.y-this._startPt.y,evt:t})}destroy(){ee(document).off(`.${this.guid}`),this._destroyed=!0}startDrag(e,t={}){if(!this.dragging)return ee(document).on(`dcg-tapmove.${this.guid}`,r=>{(r.originalEvent||r).preventDefault(),cancelAnimationFrame(this.frameThrottle),this.frameThrottle=requestAnimationFrame(()=>this.doDrag(r))}),ee(document).on(`dcg-tapend.${this.guid} dcg-tapcancel.${this.guid}`,r=>this.endDrag(r)),this._offsetPt={x:0,y:0},t.origin&&(this._offsetPt={x:this._evt2pt(e).x-t.origin.x,y:this._evt2pt(e).y-t.origin.y}),this._startPt=this._evt2pt(e),this.dragging=!0,this._dispatch("onGrab",e)}doDrag(e){this.dragging&&this._dispatch("onDrag",e)}endDrag(e){this.dragging&&(ee(document).off(`.${this.guid}`),this.doDrag(e),this.dragging=!1,this._dispatch("onDrop",e))}observeEvent(e,t){return this._eventBus.observeEvent(e,t)}},{If:loe}=hi.Components,Kg=class extends hi.Class{template(){return hi.createElement("div",{class:()=>({"dcg-slider-interior":!0,"dcg-disable-slider":this.shouldDisableSlider()}),didMount:this.bindFn(this.didMountRoot),onTapStart:this.bindFn(this.onStartDrag)},hi.createElement("div",{class:hi.const("dcg-track")},hi.createElement("div",{class:hi.const("dcg-ticks"),onMount:this.bindFn(this.didMountTickMarks)}),hi.createElement("div",{class:hi.const("dcg-graphic")})),hi.createElement(loe,{predicate:this.bindFn(this.shouldShowZeroMarker)},()=>hi.createElement("div",{class:hi.const("dcg-zeroMarker"),style:()=>({left:this.getZeroMarkerPercent()+"%"})})),hi.createElement("div",{class:()=>({"dcg-thumb":!0,"dcg-down":this.isDragging}),role:hi.const("slider"),tabIndex:hi.const("0"),disablescroll:hi.const("true"),style:()=>({left:this.getThumbPercent()+"%"}),onKeyDown:this.bindFn(this.onKeyDown),"aria-label":this.props.ariaLabel,"aria-valuemin":()=>{var e,t;return(t=(e=this.props).ariaPercent)!=null&&t.call(e)?0:this.props.min()},"aria-valuemax":()=>{var e,t;return(t=(e=this.props).ariaPercent)!=null&&t.call(e)?100:this.props.max()},"aria-valuenow":()=>{var e,t;return(t=(e=this.props).ariaPercent)!=null&&t.call(e)?void 0:this.props.value()},"aria-valuetext":()=>{var e,t;return(t=(e=this.props).ariaPercent)!=null&&t.call(e)?`${Math.floor(this.getThumbPercent())}%`:void 0},manageFocus:this.buildFocusManager()},hi.createElement("div",{class:hi.const("dcg-graphic")}),hi.createElement("div",{class:hi.const("dcg-center")})))}willUnmount(){this.dragDrop.destroy()}didMountRoot(e){this.rootNode=e,this.dragDrop=new tD,this.isMounted=!0,this.dragDrop.observeEvent("onDrop",()=>{this.isDragging=!1,this.update(),this.props.onDrop&&this.props.onDrop()}),this.dragDrop.observeEvent("onGrab",()=>{this.isDragging=!0,this.update(),this.props.onGrab&&this.props.onGrab()}),this.dragDrop.observeEvent("onDrag",(t,r)=>{this.props.onDragUpdate(this.valueFromPixels(r.x))})}didMountTickMarks(e){this.tickMarksNode=e,this.renderTickMarks()}didUpdate(){this.renderTickMarks()}shouldDisableSlider(){return this.props.min()===this.props.max()}renderTickMarks(){if(!this.tickMarksNode)return;let e=this.props.step(),t=this.props.min(),r=this.props.max(),n;if(e===void 0?n=0:n=100*e/(r-t),n<3&&(n=0),n>100&&(n=0),isNaN(n)&&(n=0),this.lastTickMarksPercent===n)return;this.lastTickMarksPercent=n;let i="";if(n>0&&n<100)for(let o=n;o<100;o+=n)i+='<div class="dcg-tick" style="left:'+o+'%"></div>';this.tickMarksNode.innerHTML=i}shouldShowZeroMarker(){return this.props.min()<=0&&this.props.max()>=0}getZeroMarkerPercent(){let e=this.props.min(),t=this.props.max();return 100*(0-e)/(t-e)}getThumbPercent(){return 100*this.percentFromValue(this.props.value())}valueFromPixels(e){if(!this.isMounted)return 0;let t=this.props.min(),r=this.props.max(),n=this.rootNode.getBoundingClientRect().width,i=__dcg_shared_module_exports__.Sb(e/n,0,1),o=t+(r-t)*i,a=(r-t)/n;return ho(o-a,o+a)}percentFromValue(e){let t=this.props.min(),r=this.props.max();return __dcg_shared_module_exports__.Sb((e-t)/(r-t),0,1)}pixelsFromValue(e){if(!this.isMounted)return 0;let t=this.percentFromValue(e);return this.rootNode.getBoundingClientRect().width*t}onKeyDown(e){switch(ke(e)){case xa:this.props.onUpPress&&(this.props.onUpPress(),e.preventDefault(),e.stopPropagation());break;case Kn:this.props.onDownPress&&(this.props.onDownPress(),e.preventDefault(),e.stopPropagation());break;case xg:this.props.onEnterPress&&(this.props.onEnterPress(),e.preventDefault(),e.stopPropagation());break;case kn:document.activeElement&&ee(document.activeElement).trigger("blur");break;case ld:this.props.onKeyboardUpdate("down"),e.preventDefault(),e.stopPropagation();break;case cd:this.props.onKeyboardUpdate("up"),e.preventDefault(),e.stopPropagation();break;case Au:this.props.onKeyboardUpdate("bigdown"),e.preventDefault(),e.stopPropagation();break;case Iu:this.props.onKeyboardUpdate("bigup"),e.preventDefault(),e.stopPropagation();break;case wg:this.props.onKeyboardUpdate("min"),e.preventDefault(),e.stopPropagation();break;case fp:this.props.onKeyboardUpdate("max"),e.preventDefault(),e.stopPropagation();break}}onStartDrag(e){if(e.device==="keyboard"||!e.target)return;e.preventDefault(),Jr();let t={x:0,y:0};e.target.closest(".dcg-thumb")?t.x=this.pixelsFromValue(this.props.value()):t.x=e.changedTouches[0].clientX-this.rootNode.getBoundingClientRect().left,this.dragDrop.startDrag(e,{origin:t})}buildFocusManager(){return!this.props.onFocusedChanged||!this.props.isFocused?this.const(void 0):this.const({shouldBeFocused:this.props.isFocused,onFocusedChanged:this.props.onFocusedChanged})}},gi=__dcg_shared_module_exports__.e(ne()),{If:coe}=gi.Components,mv=class extends gi.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return gi.createElement("div",{class:gi.const("dcg-slider_menu dcg-do-blur"),handleEvent:gi.const("true"),didMount:e=>this.node=e},gi.createElement("div",{class:gi.const("dcg-editable-mathquill-container")},gi.createElement(coe,{predicate:()=>!this.shouldOnlyShowStep()},()=>gi.createElement("span",null,gi.createElement(lr,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.model.slider.hardMin?this.model.slider.min:"",isFocused:()=>this.getFocusedInput()==="min",ariaLabel:()=>this.controller.s("graphing-calculator-narration-slider-minimum"),brailleLabel:()=>this.controller.raw("sldrmin"),handleFocusChanged:(e,t)=>this.handleFocusedChanged("min",e,t),hasError:()=>!ZE(this.model),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("min",e,t),handleLatexChanged:e=>this.handleLatexChanged("min",e),dataLabelAttributeValue:this.const("slidermin")}),gi.createElement("span",{class:gi.const("dcg-interval-interior")},gi.createElement(nt,{latex:this.bindFn(this.getDependentLatex),config:this.const({})},gi.createElement("span",null))),gi.createElement(lr,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.model.slider.hardMax?this.model.slider.max:"",isFocused:()=>this.getFocusedInput()==="max",ariaLabel:()=>this.controller.s("graphing-calculator-narration-slider-maximum"),brailleLabel:()=>this.controller.raw("sldrmax"),handleFocusChanged:(e,t)=>this.handleFocusedChanged("max",e,t),hasError:()=>!eT(this.model),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("max",e,t),handleLatexChanged:e=>this.handleLatexChanged("max",e),dataLabelAttributeValue:this.const("slidermax")}))),gi.createElement("span",{class:()=>({"dcg-slider-step-container":!this.shouldOnlyShowStep()})},gi.createElement("span",{class:gi.const("dcg-slider-step-label"),"aria-hidden":gi.const("true")},()=>this.controller.s("graphing-calculator-label-slider-step")),gi.createElement(lr,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.model.slider.step,isFocused:()=>this.getFocusedInput()==="step",ariaLabel:()=>this.controller.s("graphing-calculator-narration-slider-step"),brailleLabel:()=>this.controller.raw("sldrstep"),handleFocusChanged:(e,t)=>this.handleFocusedChanged("step",e,t),hasError:()=>!tT(this.model),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("step",e,t),handleLatexChanged:e=>this.handleLatexChanged("step",e),dataLabelAttributeValue:this.const("sliderstep")}))))}handlePressedKey(e,t,r){if(!this.controller.isInEditListMode()&&!this.shouldOnlyShowStep()&&(t==="Esc"||t==="Enter")){this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.id}});return}let n=Fe.getFocusedMathquill(),i=os();if(t==="Left"||t==="Right"||t==="Down"||t==="Up"){let o;n?o=Fe.applyArrowKeyAndReturnIfWasAtBounds(n,t,r):i&&(i.selectionStart===0&&t==="Left"||i.selectionStart===i.value.length&&t==="Right"||t==="Up"||t==="Down")?o=!0:o=!1,o&&(r&&r.preventDefault(),t==="Left"&&!this.shouldOnlyShowStep()?e==="max"?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"min"}}):e==="step"&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"max"}}):t==="Right"&&!this.shouldOnlyShowStep()?e==="min"?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"max"}}):e==="max"&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"step"}}):t==="Down"?this.controller.dispatch({type:"on-special-key-pressed",key:"Down"}):t==="Up"&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}));return}n&&(n.keystroke(t,r),this.handleLatexChanged(e,n.latex()))}shouldOnlyShowStep(){return this.model.slider.loopMode==="PLAY_INDEFINITELY"}handleLatexChanged(e,t){e==="min"?this.dispatchMinLatexIfChanged(t):e==="max"?this.dispatchMaxLatexIfChanged(t):e==="step"&&this.dispatchStepLatexIfChanged(t)}handleFocusedChanged(e,t,r){t&&this.getFocusedInput()!==e?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:e}}):this.getFocusedInput()===e&&this.controller.getBrailleMode()==="none"&&(!r.relatedTarget||!this.node.contains(r.relatedTarget))&&this.controller.dispatch({type:"blur-focus-location",location:{type:"slider-limit",id:this.id,location:e}})}dispatchMinLatexIfChanged(e){this.model.slider.min!==e&&this.controller.dispatch({type:"set-slider-minlatex",id:this.id,latex:e})}dispatchMaxLatexIfChanged(e){this.model.slider.max!==e&&this.controller.dispatch({type:"set-slider-maxlatex",id:this.id,latex:e})}dispatchStepLatexIfChanged(e){this.model.slider.step!==e&&this.controller.dispatch({type:"set-slider-steplatex",id:this.id,latex:e})}getDependentLatex(){let e=Ya(this.model)||"";return" \\le "+__dcg_shared_module_exports__.ma(e)+" \\le "}getFocusedInput(){let e=this.controller.getFocusLocation();if(!(!e||e.type!=="slider-limit"||e.id!==this.id))return e.location}},{If:Y8}=mi.Components,fv=class extends mi.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return mi.createElement("div",{class:mi.const("dcg-slider-container"),tapboundary:mi.const("true"),onKeyDown:e=>{if(ke(e)==="Tab"&&!e.altKey&&!e.metaKey&&!e.ctrlKey)if(e.shiftKey)if(this.isSliderMinFocused()&&this.controller.isInEditListMode()){if(e.target){let t=e.target.closest(".dcg-expressionitem");if(t){let r=Array.from(t.querySelectorAll('[tabindex="0"]')).filter(bp)[0];r==null||r.focus()}}e.preventDefault(),e.stopPropagation()}else this.isSliderThumbFocused()&&(this.controller.isItemReadonly(this.model.id)||(this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"step"}}),e.preventDefault(),e.stopPropagation()));else!e.shiftKey&&this.isSliderStepFocused()&&(this.controller.isInEditListMode()?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-icon",id:this.id}}):this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.id}}),e.preventDefault(),e.stopPropagation())}},mi.createElement(Y8,{predicate:this.bindFn(this.shouldShowSlider)},()=>mi.createElement("div",{class:mi.const("dcg-do-blur dcg-slider"),handleEvent:mi.const("true")},mi.createElement("div",{class:mi.const("dcg-minLabel dcg-template-minlabelhtml"),role:mi.const("button"),"aria-label":this.bindFn(this.getMinAriaLabel),onTap:()=>this.onEditLimit("min")},mi.createElement(nt,{latex:()=>pL(this.model),config:this.const({}),tokenController:this.props.controller})),mi.createElement(Kg,{min:()=>nl(this.model),max:()=>bc(this.model),step:()=>Rl(this.model),value:()=>al(this.model),ariaLabel:()=>this.controller.getBrailleMode()==="none"?'"'+Ya(this.model)+'"':""+Ya(this.model),onGrab:this.bindFn(this.onGrab),onDrop:this.bindFn(this.onDrop),onDragUpdate:this.bindFn(this.onDragUpdate),onKeyboardUpdate:this.bindFn(this.onKeyboardUpdate),onUpPress:()=>this.controller.dispatch({type:"on-special-key-pressed",key:"Up"}),onDownPress:()=>this.controller.dispatch({type:"on-special-key-pressed",key:"Down"}),onEnterPress:()=>this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"}),isFocused:this.bindFn(this.isSliderThumbFocused),onFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"slider-thumb",id:this.id}})}}),mi.createElement("div",{class:mi.const("dcg-maxLabel dcg-template-maxlabelhtml"),onTap:()=>this.onEditLimit("max"),role:mi.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-narration-slider-maximum")+" "+ei(uL(this.model))},mi.createElement(nt,{latex:()=>uL(this.model),config:this.const({}),tokenController:this.props.controller})))),mi.createElement(Y8,{predicate:this.bindFn(this.shouldShowLimitInputs)},()=>mi.createElement(mv,{model:this.props.model,controller:this.props.controller})))}getMinAriaLabel(){return this.controller.isItemReadonly(this.model.id)?this.controller.s("graphing-calculator-narration-slider-minimum")+" "+ei(pL(this.model)):this.controller.s("graphing-calculator-narration-edit-slider-variable-limits",{variable:this.controller.getBrailleMode()==="none"?'"'+Ya(this.model)+'"':""+Ya(this.model)})}onGrab(){this.dispatchIsDraggingIfChanged(!0)}onDrop(){this.controller.dispatch({type:"set-none-selected"}),this.dispatchIsPlayingIfChanged(!1),this.dispatchIsDraggingIfChanged(!1)}onKeyboardUpdate(e){this.controller.dispatch({type:"adjust-slider-by-keyboard",id:this.id,adjustment:e})}onDragUpdate(e){this.controller.dispatch({type:"adjust-slider-by-dragging-thumb",id:this.model.id,target:e})}onEditLimit(e){this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:e}})}dispatchIsPlayingIfChanged(e){this.model.slider.isPlaying!==e&&this.controller.dispatch({type:"set-slider-isplaying",id:this.id,isPlaying:e})}dispatchIsDraggingIfChanged(e){this.model.sliderDragging!==e&&this.controller.dispatch({type:"set-slider-dragging",id:this.id,dragging:e})}shouldShowLimitInputs(){if(this.controller.isInEditListMode())return!0;if(this.controller.isItemReadonly(this.model.id))return!1;if(!ZE(this.model)||!eT(this.model)||!tT(this.model)||this.model.slider.loopMode==="PLAY_INDEFINITELY")return!0;let e=this.controller.getFocusLocation();return!!(e&&(e.type==="slider-limit"||e.type==="expression"||e.type==="top-level-icon"||e.type==="readonly-expression")&&e.id===this.id)}shouldShowSlider(){return!this.shouldShowLimitInputs()}isSliderThumbFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="slider-thumb"&&e.id===this.id)}isSliderMinFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="slider-limit"&&e.id===this.id&&e.location==="min")}isSliderStepFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="slider-limit"&&e.id===this.id&&e.location==="step")}},Gn=__dcg_shared_module_exports__.e(ne()),{For:doe}=Gn.Components,bv=class extends Gn.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Gn.createElement("div",{class:Gn.const("dcg-stats-footer-container dcg-do-blur"),handleEvent:Gn.const("true")},Gn.createElement("ul",{class:Gn.const("dcg-unstyled-list")},Gn.createElement(doe,{each:this.bindFn(this.getValues),key:e=>e.parameter+":"+e.label+":"+e.value},e=>{let t=this.controller.s(e.label);return Gn.createElement("li",{class:Gn.const("dcg-value")},Gn.createElement("div",{class:Gn.const("dcg-row-header dcg-text-selectable")},()=>t),Gn.createElement("div",{class:Gn.const("dcg-evaluation")},Gn.createElement(pl,{latex:()=>e.value,ariaLabel:()=>t,tabbable:this.const(!0),focusLocation:this.const({type:"stats-output",id:this.id,parameter:e.parameter}),controller:this.props.controller,onKeypress:this.bindFn(this.handlePressedKey)})))})))}getValues(){let e=Tq(this.model);return e?[{parameter:"min",label:"graphing-calculator-label-stats-minimum",value:this.getStatValue(e.min)},{parameter:"q1",label:"graphing-calculator-label-stats-first-quartile",value:this.getStatValue(e.q1)},{parameter:"median",label:"graphing-calculator-label-stats-median",value:this.getStatValue(e.median)},{parameter:"q3",label:"graphing-calculator-label-stats-third-quartile",value:this.getStatValue(e.q3)},{parameter:"max",label:"graphing-calculator-label-stats-maximum",value:this.getStatValue(e.max)}]:[]}handlePressedKey(e){let t=ke(e);if(t)switch(t){case"Up":this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}),e.preventDefault();break;case"PageUp":case"PageDown":case"Down":case"Enter":this.controller.dispatch({type:"on-special-key-pressed",key:t}),e.preventDefault();break;case"Esc":Jr(),e.preventDefault();break}}getStatValue(e){var t;return(t=__dcg_shared_module_exports__.la(e,R({},__dcg_shared_module_exports__.ga)))!=null?t:""}},hr=__dcg_shared_module_exports__.e(ne()),yv=class extends hr.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return hr.createElement("div",{class:hr.const("dcg-ttest-footer-container dcg-do-blur"),handleEvent:hr.const("true")},hr.createElement("ul",{class:hr.const("dcg-unstyled-list")},hr.createElement("li",{class:hr.const("dcg-value"),role:hr.const("textbox"),"aria-readonly":hr.const("true"),tabIndex:hr.const("0"),"aria-label":()=>"Less than: "+this.getLessThan()},hr.createElement("div",{class:hr.const("dcg-operator")},hr.createElement(nt,{config:this.const({}),latex:this.const("<")})),hr.createElement("div",{class:hr.const("dcg-evaluation")},hr.createElement(nt,{config:this.const({}),latex:()=>this.getLessThan()}))),hr.createElement("li",{class:hr.const("dcg-value"),role:hr.const("textbox"),"aria-readonly":hr.const("true"),tabIndex:hr.const("0"),"aria-label":()=>"Greater than: "+this.getGreaterThan()},hr.createElement("div",{class:hr.const("dcg-operator")},hr.createElement(nt,{config:this.const({}),latex:this.const(">")})),hr.createElement("div",{class:hr.const("dcg-evaluation")},hr.createElement(nt,{config:this.const({}),latex:()=>this.getGreaterThan()}))),hr.createElement("li",{class:hr.const("dcg-value"),role:hr.const("textbox"),"aria-readonly":hr.const("true"),tabIndex:hr.const("0"),"aria-label":()=>"Not equal: "+this.getNotEqual()},hr.createElement("div",{class:hr.const("dcg-operator")},hr.createElement(nt,{config:this.const({}),latex:this.const("≠")})),hr.createElement("div",{class:hr.const("dcg-evaluation")},hr.createElement(nt,{config:this.const({}),latex:()=>this.getNotEqual()})))))}getLessThan(){let e=Hw(this.model);return e?__dcg_shared_module_exports__.de(e.lessThan,5):""}getGreaterThan(){let e=Hw(this.model);return e?__dcg_shared_module_exports__.de(e.greaterThan,5):""}getNotEqual(){let e=Hw(this.model);return e?__dcg_shared_module_exports__.de(e.notEqual,5):""}},jt=__dcg_shared_module_exports__.e(ne()),{SwitchUnion:poe,If:X8}=jt.Components,Jb=class extends jt.Class{template(){return jt.createElement("div",{class:jt.const("dcg-toggle-container")},jt.createElement("div",{class:jt.const("dcg-expression-footer-title")},this.props.title,jt.createElement(X8,{predicate:()=>!!this.props.helpLink},()=>jt.createElement("a",{"aria-label":()=>this.props.controller().s("account-shell-link-help"),class:jt.const("dcg-expression-footer-title-help"),target:jt.const("_blank"),href:this.props.helpLink},jt.createElement("i",{class:jt.const("dcg-icon-question-sign"),"aria-hidden":jt.const("true")})))),jt.createElement(vo,{staticConfig:this.bindFn(this.getSegmentedControlOptions),ariaGroupLabel:this.props.title,disabled:this.bindFn(this.isReadonly),theme:this.const("mini"),minButtonWidth:this.const(65)}))}isReadonly(){return this.props.controller().isItemReadonly(this.props.model().id)}getSegmentedControlOptions(){return this.props.options().map(e=>({key:e.name,label:()=>e.displayName,selected:()=>this.isSelected(e.name),onSelect:()=>{this.props.controller().dispatch({type:"set-visualization-prop",id:this.props.model().id,prop:this.props.vizProp(),value:e.name})}}))}isSelected(e){return Tp(this.props.model(),this.props.vizProp())===e}},xv=class extends jt.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,jt.createElement("div",{class:jt.const("dcg-visualization-parameters-container dcg-do-blur"),tapboundary:jt.const("true"),handleEvent:jt.const("true")},jt.createElement(jb,R({},this.props)),jt.createElement("div",{class:jt.const("dcg-smaller-font")},poe(()=>this.getVisualizationType(),{boxplot:()=>jt.createElement("div",null,jt.createElement("div",{class:jt.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-visual-parameters-display-properties")),this.makeMQInput({prop:"axisOffset",siblingProps:["breadth"],default:"1",name:()=>this.controller.s("graphing-calculator-narration-visual-parameters-offset")}),this.makeMQInput({prop:"breadth",siblingProps:["axisOffset"],default:"1",name:()=>Tp(this.model,"alignedAxis")==="y"?this.controller.s("graphing-calculator-narration-visual-parameters-width"):this.controller.s("graphing-calculator-narration-visual-parameters-height")}),jt.createElement(mt,{checked:()=>!!Tp(this.model,"showBoxplotOutliers"),disabled:()=>this.controller.isItemReadonly(this.model.id),onChange:this.bindFn(this.onToggleOutliers)},jt.createElement("span",{class:jt.const("dcg-parameter-name")},()=>this.controller.s("graphing-calculator-button-visual-parameters-exclude-outliers")))),dotplot:()=>jt.createElement(X8,{predicate:()=>Vq(this.model)},()=>jt.createElement("div",{class:jt.const("dcg-toggles-container")},jt.createElement(Jb,ie(R({},this.props),{vizProp:()=>"dotplotXMode",options:()=>[{name:"exact",displayName:this.controller.s("graphing-calculator-button-visual-parameters-exact")},{name:"bin",displayName:this.controller.s("graphing-calculator-button-visual-parameters-binned")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-x-values")})),jt.createElement(Jb,ie(R({},this.props),{vizProp:()=>"binAlignment",options:()=>[{name:"center",displayName:this.controller.s("graphing-calculator-button-visual-parameters-center")},{name:"left",displayName:this.controller.s("graphing-calculator-button-visual-parameters-left")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-bin-alignment")})))),histogram:()=>jt.createElement("div",{class:jt.const("dcg-toggles-container")},jt.createElement(Jb,ie(R({},this.props),{vizProp:()=>"histogramMode",options:()=>[{name:"",displayName:this.controller.s("graphing-calculator-button-visual-parameters-count")},{name:"relative",displayName:this.controller.s("graphing-calculator-button-visual-parameters-relative")},{name:"density",displayName:this.controller.s("graphing-calculator-button-visual-parameters-density")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-bar-heights"),helpLink:this.const("https://help.desmos.com/hc/en-us/articles/360022405991")})),jt.createElement(Jb,ie(R({},this.props),{vizProp:()=>"binAlignment",options:()=>[{name:"center",displayName:this.controller.s("graphing-calculator-button-visual-parameters-center")},{name:"left",displayName:this.controller.s("graphing-calculator-button-visual-parameters-left")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-bin-alignment")}))),none:()=>jt.createElement("span",null)})))}makeMQInput(e){return jt.createElement("span",null,jt.createElement("span",{class:jt.const("dcg-parameter-name")},e.name,jt.const(":")),jt.createElement(lr,{latex:()=>this.getPropLatex(e),ariaLabel:e.name,placeholder:()=>e.default,isFocused:()=>this.isInputFocused(e.prop),hasError:()=>!Gq(this.model,e.prop),handleFocusChanged:t=>this.handleFocusedChanged(e.prop,t),handlePressedKey:(t,r)=>this.handlePressedKey(t,r,e.prop),handleLatexChanged:t=>this.handleLatexChanged(e.prop,t),readonly:()=>this.controller.isItemReadonly(this.model.id),controller:this.props.controller}))}handlePressedKey(e,t,r){if(e==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(e==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});let n=Fe.getFocusedMathquill();n&&(n.keystroke(e,t),this.handleLatexChanged(r,n.latex()))}isInputFocused(e){let t=this.controller.getFocusLocation();return!t||t.type!=="visualization-prop"||t.id!==this.id?!1:t.location===e}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"visualization-prop",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"visualization-prop",id:this.id,location:e}})}getPropLatex({prop:e}){let t=Tp(this.model,e);return typeof t=="string"?t:""}handleLatexChanged(e,t){Tp(this.model,e)!==t&&this.controller.dispatch({type:"set-visualization-prop",id:this.id,prop:e,value:t})}onToggleOutliers(){let e=Tp(this.model,"showBoxplotOutliers");this.controller.dispatch({type:"set-visualization-prop",id:this.id,prop:"showBoxplotOutliers",value:!e})}getVisualizationType(){return Yw(this.model)?ju(this.model)?"boxplot":kp(this.model)?"dotplot":Pg(this.model)?"histogram":"none":"none"}},{If:uoe,SwitchUnion:hoe,Each:goe}=no.Components,moe=["warning","regression","slider","domain","ttest","stats","action-info","label","distribution","visualization","rename-prompt","extend-to-3d","slider-prompt","evaluation","braille-error"],rD=class extends no.Class{constructor(){super(...arguments),this.model=this.props.model(),this.controller=this.props.controller()}id(){return this.model.id}getFooterComponents(){return moe.filter(e=>this.hasFooterComponent(e))}hasFooterComponent(e){switch(e){case"action-info":return this.shouldShowActionInfo();case"braille-error":return this.shouldShowBrailleError();case"distribution":return _p(this.model);case"domain":return!this.model.sliderExists&&(Wu(this.model)||Dp(this.model));case"evaluation":return this.controller.shouldShowEvaluationForItem(this.model.id);case"extend-to-3d":return this.shouldShowExtendTo3D();case"label":return ub(this.model)&&!this.controller.isThreeDMode();case"regression":return!!this.model.formula.regression;case"rename-prompt":return this.shouldShowRenamePrompt();case"slider":return!!this.model.sliderExists;case"slider-prompt":return this.controller.shouldShowSliderPrompt(this.model);case"stats":return uT(this.model);case"ttest":return jw(this.model);case"visualization":return pT(this.model);case"warning":return!!this.getFooterWarning();default:let t=e;throw new Error(`Unexpected footer type ${t}`)}}template(){return no.createElement(uoe,{predicate:()=>this.getFooterComponents().length>0},()=>no.createElement("div",{class:this.getFooterClass()},goe(()=>this.getFooterComponents(),{item:e=>hoe(()=>e,{regression:()=>no.createElement(Xb,{model:this.props.model,controller:this.props.controller,regression:()=>this.props.model().formula.regression}),label:()=>no.createElement(Hg,{model:this.props.model,controller:this.props.controller}),slider:()=>no.createElement(fv,{model:this.props.model,controller:this.props.controller}),"slider-prompt":()=>no.createElement(Ec,{model:this.props.model,controller:this.props.controller}),"braille-error":()=>no.createElement("div",{tabIndex:no.const(0),class:no.const("dcg-expression-braille-error"),role:no.const("button"),"aria-roledescription":no.const("error"),"aria-label":()=>this.controller.unpack(this.model.error)},no.createElement("i",{class:no.const("dcg-icon-error"),"aria-hidden":no.const("true")}),()=>this.controller.unpack(this.model.error)),domain:()=>no.createElement(pv,{model:this.props.model,controller:this.props.controller}),evaluation:()=>no.createElement(qg,{id:()=>this.props.model().id,val:()=>this.controller.getEvaluationValueForItem(this.id()),controller:this.props.controller,valueType:()=>this.controller.getEvaluationValueTypeForItem(this.id())}),distribution:()=>no.createElement(dv,{model:this.props.model,controller:this.props.controller}),visualization:()=>no.createElement(xv,{model:this.props.model,controller:this.props.controller}),"rename-prompt":()=>no.createElement(hv,{controller:this.props.controller,id:this.bindFn(this.id)}),ttest:()=>no.createElement(yv,{model:this.props.model,controller:this.props.controller}),stats:()=>no.createElement(bv,{model:this.props.model,controller:this.props.controller}),"action-info":()=>no.createElement(zg,{model:this.props.model,controller:this.props.controller}),"extend-to-3d":()=>no.createElement("div",{handleEvent:no.const("true")},no.createElement(mt,{onChange:t=>{this.controller.dispatch({type:"set-item-extend-to-3D",id:this.model.id,extendTo3D:t})},checked:()=>this.model.extendTo3D,class:this.const("dcg-extend-to-3d-checkbox")},()=>this.controller.s("graphing-calculator-label-extend-to-3d"))),warning:()=>no.createElement(uv,{controller:this.props.controller,warning:()=>this.getFooterWarning()})})})))}getFooterClass(){let e=!this.props.isFirstRender()&&!this.model.expressionTooComplex;return this.const({"dcg-expression-bottom":!0,"dcg-indent-in-folder":!0,"dcg-fadein-bottom":e})}shouldShowRenamePrompt(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.model.id);return!!(e&&e.countOfChanges)}shouldShowActionInfo(){return!!(this.controller.areActionsEnabled()&&this.model.clickableInfo&&this.model.clickableInfo.enabled&&this.model.clickableInfo.latex)}shouldShowBrailleError(){return this.controller.getBrailleMode()!=="none"&&this.hasError()}hasError(){return!!this.model.error&&!Vl(this.model)}shouldShowExtendTo3D(){return this.controller.isThreeDMode()?cT(this.model)&&!this.model.expressionTooComplex&&this.model.shouldGraph:!1}getFooterWarning(){let e=this.model.formula;if(e.warning!==void 0)return{type:"evaluation",message:this.controller.unpack(e.warning)};if(!this.controller.getIncludeFunctionParametersInRandomSeed()&&e.depends_on_random_seed&&e.function_definition)return{type:"legacy-random-seed-behavior"};if(this.model.expressionTooComplex)return{type:"expressionTooComplex"};if(this.model.unresolved)return{type:"unresolved"};if(Iq(this.model))return{type:"tone-out-of-range"};if(this.model.nanBlame===__dcg_shared_module_exports__.Zd.ComplexCoercion)return{type:"nan-blame-complex-coercion"};if(this.model.recursiveDepthPlottingError)return{type:"recursive-depth-plotting-error"}}};Ss();var ji=__dcg_shared_module_exports__.e(ne()),Vp=__dcg_shared_module_exports__.e(ne()),Di=class extends Vp.Class{template(){return Vp.createElement(Le,{tooltip:this.props.error,sticky:this.const(!0),gravity:this.props.gravity,additionalClass:this.const("dcg-tooltipped-error-container")},Vp.createElement("div",{class:()=>{var e,t,r,n;return{"dcg-tooltipped-error":!0,"dcg-small":((t=(e=this.props).size)==null?void 0:t.call(e))==="small","dcg-white":this.props.isWhite&&this.props.isWhite(),"dcg-tooltipped-error__instant":(n=(r=this.props).instant)==null?void 0:n.call(r)}}},Vp.createElement("i",{class:Vp.const("dcg-icon-error"),"aria-hidden":Vp.const("true")})))}},Gd=__dcg_shared_module_exports__.e(ne()),Ln=__dcg_shared_module_exports__.e(ne()),Go=__dcg_shared_module_exports__.e(ne()),oD=class extends Go.Class{template(){return Go.createElement("div",{class:Go.const("dcg-slow-plotting-icon")},Go.createElement("div",{class:Go.const("dcg-slow-plotting-icon__dot")}),Go.createElement("div",{class:Go.const("dcg-slow-plotting-icon__dot")}),Go.createElement("div",{class:Go.const("dcg-slow-plotting-icon__dot")}),Go.createElement("div",{class:Go.const("dcg-slow-plotting-icon__dot")}),Go.createElement("div",{class:Go.const("dcg-slow-plotting-icon__dot")}),Go.createElement("div",{class:Go.const("dcg-slow-plotting-icon__dot")}),Go.createElement("div",{class:Go.const("dcg-slow-plotting-icon__dot")}),Go.createElement("div",{class:Go.const("dcg-slow-plotting-icon__dot")}),Go.createElement("div",{class:Go.const("dcg-slow-plotting-icon__dot")}),Go.createElement("div",{class:Go.const("dcg-slow-plotting-icon__dot")}),Go.createElement("div",{class:Go.const("dcg-slow-plotting-icon__dot")}))}},{If:wv}=Ln.Components,$o=class extends Ln.Class{template(){return Ln.createElement("span",{class:()=>({"dcg-do-not-blur":!0,"dcg-forced-color-none":!0,"dcg-circular-icon":!0,"dcg-thick-outline":this.isThickOutline(),"dcg-white-icon":!!this.props.whiteIcon&&this.props.whiteIcon(),"dcg-hidden":this.isHidden(),"dcg-semi-transparent":this.props.semiTransparent&&this.props.semiTransparent(),"dcg-colored-icon":this.isColoredIcon(),"dcg-has-background-image":this.hasBackgroundImage(),[this.iconModifier()]:this.iconModifier().length>0}),style:this.bindFn(this.getIconStyle)},Ln.createElement(wv,{predicate:this.bindFn(this.hasBackgroundImage)},()=>Ln.createElement("span",{class:Ln.const("dcg-background-image"),style:()=>({"background-image":this.props.backgroundImage&&this.props.backgroundImage(),opacity:this.props.backgroundOpacity&&this.props.backgroundOpacity().toString()})})),Ln.createElement(wv,{predicate:()=>!!this.backgroundIcon()},()=>Ln.createElement("i",{class:()=>({[this.backgroundIcon()]:!0,"dcg-layered-icon":!0}),style:()=>({opacity:this.backgroundOpacity().toString()})})),Ln.createElement(wv,{predicate:()=>!!this.primaryIcon()},()=>Ln.createElement("i",{class:()=>({[this.primaryIcon()]:!0,"dcg-layered-icon":!0}),style:()=>({color:this.props.foregroundColor&&this.props.foregroundColor()})})),Ln.createElement(wv,{predicate:()=>this.props.iconType()==="loading"},()=>Ln.createElement("span",{class:Ln.const("dcg-spinner")})),Ln.createElement(wv,{predicate:()=>this.props.iconType()==="slow-plotting"},()=>Ln.createElement(oD,null)))}isColoredIcon(){return!this.isThickOutline()&&!this.isHidden()&&!this.hasBackgroundImage()&&this.props.iconType()!=="loading"}iconModifier(){if(!this.props.iconModifier)return"";switch(this.props.iconModifier()){case"medium":return"dcg-modifier-size-medium";case"large":return"dcg-modifier-size-large";case"small":return"dcg-modifier-size-small";case"rotated":return"dcg-modifier-rotated";case"fade-in":return"dcg-modifier-fade-in";case"none":return""}}getIconStyle(){let e=!this.isHidden()&&this.props.backgroundColor?Hf(this.props.backgroundColor()):void 0;return e?{background:e}:{}}isHidden(){return this.props.iconType()==="hidden"}isThickOutline(){let e=this.props.iconType();return e==="folder"||e==="pause"||e==="play"||e==="fraction"||e==="action"||e==="metronome"||e==="sound"}hasBackgroundImage(){return!!this.props.backgroundImage&&!this.isHidden()&&!!this.props.backgroundImage()}primaryIcon(){let e=this.props.iconType();switch(e){case"sound":return"dcg-icon-sound-wave";case"folder":return"dcg-icon-folder";case"pause":return"dcg-icon-pause";case"play":return"dcg-icon-play";case"polygon-dashed":case"polygon-dashed-filled":return"dcg-icon-polygon-dashed";case"polygon-dotted":case"polygon-dotted-filled":return"dcg-icon-polygon-dotted";case"polygon-default":case"polygon-default-filled":return"dcg-icon-polygon-solid";case"graph-dashed":case"parametric-dashed-filled":return"dcg-icon-parametric-dashed";case"graph-dotted":case"parametric-dotted-filled":return"dcg-icon-parametric-dotted";case"graph-default":case"parametric-default-filled":return"dcg-icon-parametric-solid";case"movable-vertical":return"dcg-icon-move-vertical";case"movable-both":return"dcg-icon-move";case"movable-horizontal":return"dcg-icon-move-horizontal";case"point-open":return"dcg-icon-open";case"point-cross":return"dcg-icon-cross";case"point-default":return"dcg-icon-point";case"table-points":case"table-points-and-lines":return"dcg-icon-points";case"table-lines":return"dcg-icon-lines-solid";case"shaded-inequality":case"inequality":return"dcg-icon-shaded-inequality-dash";case"check":return"dcg-icon-check";case"none":case"background":case"hidden":case"polygon-none-filled":case"parametric-none-filled":case"loading":case"slow-plotting":return"";case"fraction":return"dcg-icon-fraction";case"boxplot":return"dcg-icon-boxplot";case"dotplot-cross":return"dcg-icon-dotplot-cross";case"dotplot-default":return"dcg-icon-dotplot-default";case"dotplot-open":return"dcg-icon-dotplot-open";case"histogram":return"dcg-icon-histogram";case"unfilled-distribution":case"filled-distribution":return"dcg-icon-distribution";case"action":return"dcg-icon-chevron-right";case"metronome":return"dcg-icon-metronome-2";case"arrow-right":return"dcg-icon-arrow-right";default:return e}}backgroundOpacity(){let e=this.backgroundIcon();return e==="dcg-icon-polygon-filled"||e==="dcg-icon-parametric-filled"||e==="dcg-icon-shaded-inequality-shade2"||e==="dcg-icon-distribution-fill"||e==="dcg-icon-histogram-fill"?.5:1}backgroundIcon(){let e=this.props.iconType();return e==="filled-distribution"?"dcg-icon-distribution-fill":e==="histogram"?"dcg-icon-histogram-fill":e==="polygon-dashed-filled"||e==="polygon-dotted-filled"||e==="polygon-default-filled"||e==="polygon-none-filled"?"dcg-icon-polygon-filled":e==="parametric-dashed-filled"||e==="parametric-dotted-filled"||e==="parametric-default-filled"||e==="parametric-none-filled"?"dcg-icon-parametric-filled":e==="table-points-and-lines"?"dcg-icon-lines-solid":e==="shaded-inequality"?"dcg-icon-shaded-inequality-shade2":e==="action"?"dcg-icon-minus":""}},iD=class extends Gd.Class{constructor(){super(...arguments),this.isAnimating=!1}init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Gd.createElement("div",{class:()=>({"dcg-action-icon-view":!0,"dcg-action-icon-view-animating":this.isAnimating})},Gd.createElement("div",{class:Gd.const("dcg-circular-icon-container"),"aria-label":()=>this.controller.s("graphing-calculator-narration-run-action-icon"),role:Gd.const("button"),tabIndex:Gd.const("0"),onTap:e=>{e.wasHandled("dragdrop")||this.runActionOnce()},manageFocus:this.const(rt({controller:this.props.controller(),location:{type:"action-icon",id:this.model.id}}))},Gd.createElement($o,{iconType:this.const("action"),whiteIcon:()=>!this.controller.isInEditListMode()&&this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)})))}runActionOnce(){this.isAnimating=!0,this.controller.dispatch({type:"action-single-step",id:this.model.id}),setTimeout(this.bindIfMounted(()=>{this.isAnimating=!1,this.update()}),150)}},Jn=__dcg_shared_module_exports__.e(ne()),nD=class extends Jn.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Jn.createElement("div",{class:Jn.const("dcg-play-pause-icon-view")},Jn.createElement(Le,{gravity:this.const("s"),tooltip:()=>this.controller.s("graphing-calculator-label-slider-disabled-while-ticker-playing"),disabled:()=>!this.controller.getTickerPlaying(),sticky:this.const(!0)},Jn.createElement("div",{class:()=>({"dcg-circular-icon-container":!0,"dcg-disabled":this.controller.getTickerPlaying()}),"aria-label":this.bindFn(this.getAriaLabel),"aria-disabled":()=>this.controller.getTickerPlaying(),role:Jn.const("button"),tabIndex:()=>this.controller.getTickerPlaying()?"-1":"0",onTap:e=>{this.controller.getTickerPlaying()||e.wasHandled("dragdrop")||this.toggleSliderIsPlaying()},"dcg-open-menu-guid":()=>this.model.guid,manageFocus:this.const(rt({controller:this.controller,location:{type:"slider-icon",id:this.model.id}}))},Jn.createElement($o,{iconType:()=>this.getIconType(),whiteIcon:()=>!this.controller.isInEditListMode()&&this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)}))),Jn.createElement("div",{class:Jn.const("dcg-slider-menu-container")},Jn.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-animation-properties-tooltip"),gravity:this.const("e")},Jn.createElement("div",{class:()=>({"dcg-slider-menu-opener":!0,"dcg-menu-open":this.myOptionsOpen()}),tabIndex:Jn.const(0),"dcg-open-menu-guid":()=>this.getMenuGUID(),role:Jn.const("button"),"aria-label":()=>this.myOptionsOpen()?this.controller.s("graphing-calculator-narration-hide-animation-properties"):this.controller.s("graphing-calculator-narration-show-animation-properties"),onTap:e=>{e.wasHandled("dragdrop")||e.wasLongheld()||this.toggleOptions(e)},manageFocus:this.const(rt({controller:this.controller,location:{type:"slider-animation-properties-icon",id:this.model.id}}))},Jn.createElement("i",{class:this.bindFn(this.getIcon),"aria-hidden":Jn.const("true")})))))}getIcon(){return __dcg_shared_module_exports__.qd(this.model.slider.loopMode)}getIconType(){return!this.model.slider.isPlaying||hL(this.model)?"play":"pause"}getMenuGUID(){return"slider-"+this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"slider",model:this.model,guid:this.getMenuGUID(),focusFirstOption:e.device==="keyboard"}})}getAriaLabel(){if(!this.model.sliderExists)return"";let e=Ya(this.model);return e?this.model.slider.isPlaying?this.controller.s("graphing-calculator-narration-pause-variable-animation",{variable:e}):this.controller.s("graphing-calculator-narration-play-variable-animation",{variable:e}):""}toggleSliderIsPlaying(){if(this.model.sliderExists){let e="",t=Ya(this.model);hL(this.model)?(typeof t=="string"&&(e=this.controller.s("graphing-calculator-narration-slider-variable-restarted",{variable:t})),this.controller.dispatch({type:"play-slider-from-min",id:this.model.id})):this.model.slider.isPlaying?(typeof t=="string"&&(e=this.controller.s("graphing-calculator-narration-slider-variable-paused",{variable:t})),this.controller.dispatch({type:"set-slider-isplaying",id:this.model.id,isPlaying:!1})):(typeof t=="string"&&(e=this.controller.s("graphing-calculator-narration-slider-variable-playing",{variable:t})),this.controller.dispatch({type:"set-slider-isplaying",id:this.model.id,isPlaying:!0})),e!==""&&xe(e)}}},vv=__dcg_shared_module_exports__.e(ne()),aD=class extends vv.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}toggleMuted(){this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id})}showAsTurnedOff(){return Bw(this.model)}template(){return vv.createElement("button",{class:()=>{var e;return{"dcg-unstyled-button":!0,"dcg-circular-icon-container":!0,"dcg-show-globally-muted":((e=this.controller.toneController)==null?void 0:e.isGlobalMuted())&&!this.showAsTurnedOff()}},onTap:e=>{e.wasHandled("dragdrop")||this.toggleMuted()},"aria-label":this.props.ariaLabel},vv.createElement($o,{iconType:()=>this.showAsTurnedOff()?"hidden":"sound",whiteIcon:()=>!this.controller.isInEditListMode()&&this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)}))}},{SwitchUnion:foe,If:boe}=ji.Components,yoe="#6A93D2",J8="#000",Q8="#fff",Cv=class extends ji.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return ji.createElement("div",{class:ji.const("dcg-expression-icon-container")},foe(this.bindFn(this.getIconMode),{error:()=>ji.createElement(Di,{error:this.bindFn(this.getErrorMsg),isWhite:this.bindFn(this.renderAsSelected)}),none:()=>ji.createElement("span",null),slider:()=>ji.createElement(nD,{controller:this.props.controller,model:this.props.model}),action:()=>ji.createElement(iD,{controller:this.props.controller,model:this.props.model}),icon:()=>ji.createElement("div",{class:ji.const("dcg-circular-icon-container"),role:ji.const("button"),tabIndex:ji.const("0"),"dcg-open-menu-guid":()=>this.getMenuGUID(),"aria-label":this.bindFn(this.getIconAriaLabel),onTap:e=>{if(!e.wasHandled("dragdrop")&&!e.wasLongheld()){if(this.myOptionsOpen())return this.toggleOptions(e);if((this.controller.isInEditListMode()||e.shiftKey)&&!this.isFraction())return this.toggleOptions(e);if(this.isFraction())return this.onToggleFractionDisplay();this.toggleGraphShown()}},onLongHold:e=>{e.handle("dcg-longhold"),e.handle("dcg-tap"),!(this.isFraction()||this.displaySlowPlotting()&&!qw(this.model))&&this.toggleOptions(e)},manageFocus:this.const(rt({controller:this.controller,location:{type:"expression-icon",id:this.model.id}}))},ji.createElement($o,{iconType:this.bindFn(this.getIconType),backgroundColor:this.bindFn(this.getBackgroundColor),whiteIcon:this.bindFn(this.renderAsSelected),foregroundColor:this.bindFn(this.getForegroundColor),iconModifier:this.bindFn(this.getIconModifier),backgroundImage:this.bindFn(this.backgroundImage),backgroundOpacity:this.const(1)}),ji.createElement(boe,{predicate:()=>this.model.disableGraphInteractions},()=>ji.createElement("i",{class:ji.const("dcg-graph-interaction-disabled dcg-icon-lock")}))),tone:()=>ji.createElement(aD,{controller:this.props.controller,model:this.props.model,ariaLabel:this.bindFn(this.getIconAriaLabel)})}))}backgroundImage(){let e=this.getBackgroundColor();return e.type==="image"?`url("${e.value}")`:""}getErrorMsg(){return this.colorError()?this.controller.s("shared-calculator-error-color-not-assigned"):this.controller.unpack(this.model.error)}getMenuGUID(){return this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"expression",model:this.model,guid:this.getMenuGUID(),focusFirstOption:e.device==="keyboard"}})}renderAsSelected(){return this.controller.isItemBeingDragged(this.model.id)?!0:this.controller.isItemSelected(this.model.id)&&!this.controller.isInEditListMode()}displaySlowPlotting(){return this.controller.shouldShowProgressUpdateIcons()&&this.controller.isItemGraphing(this.model.id)&&this.controller.isItemSlowInEvaluator(this.model.id)&&!Hi(this.model)}isFraction(){return this.controller.canDisplayEvaluationForItemAsFraction(this.model.id)}getIconMode(){return this.displaySlowPlotting()?"icon":this.hasError()?"error":this.controller.getGraphSettings().config.graphpaper?qw(this.model)?"icon":this.hasSlider()?"slider":this.isFraction()?"icon":this.isNonemptyAction()?"action":this.isToneExpression()&&this.controller.toneEnabled()?"tone":"none":"none"}isToneExpression(){return Is(this.model)}toggleGraphShown(){this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id})}colorError(){return!!this.model.formula.rgb_value&&!this.model.formula.assignment}hasError(){return this.colorError()?!0:!!this.model.error&&!Vl(this.model)&&this.controller.getBrailleMode()==="none"}hasSlider(){return!!this.model.sliderExists}isNonemptyAction(){return vb(this.model)}getDisplayProps(){let{points:e,lines:t,fill:r}=this.model;return __dcg_shared_module_exports__.Zc(this.model.formula.expression_type,{points:e,lines:t,fill:r},n=>{})}getBackgroundColor(){if(!this.isFraction())return xw(this.model);let e=this.renderAsSelected();return this.controller.shouldEvaluationForItemDisplayAsFraction(this.model.id)?{type:"single-color",value:e?Q8:J8}:{type:"single-color",value:""}}getForegroundColor(){if(!this.isFraction())return"";let e=this.renderAsSelected(),t=this.controller.shouldEvaluationForItemDisplayAsFraction(this.model.id);return e!==t?Q8:e?yoe:J8}onToggleFractionDisplay(){this.controller.dispatch({type:"toggle-fraction-evaluation",id:this.model.id})}getIconModifier(){return ju(this.model)&&Tp(this.model,"alignedAxis")==="y"?"rotated":this.displaySlowPlotting()&&this.model.formula.is_graphable===void 0?"fade-in":"none"}getIconType(){if(this.isFraction())return"fraction";if(this.displaySlowPlotting())return"slow-plotting";if(!this.model.shouldGraph)return"hidden";if(this.controller.isInEditListMode())return"none";let e=this.model.pointStyle,t=this.model.lineStyle,r=this.getDisplayProps(),n=this.model.formula;if(ju(this.model))return"boxplot";if(kp(this.model)){if(this.model.pointStyle==="POINT")return"dotplot-default";if(this.model.pointStyle==="CROSS")return"dotplot-cross";if(this.model.pointStyle==="OPEN")return"dotplot-open"}if(Pg(this.model))return"histogram";if(_p(this.model))return vd(this.model)?"filled-distribution":"unfilled-distribution";if(Ro(this.model)==="X")return"movable-horizontal";if(Ro(this.model)==="Y")return"movable-vertical";if(Ro(this.model)==="XY")return"movable-both";if(Ea(this.model))return e==="OPEN"?"point-open":e==="CROSS"?"point-cross":"point-default";if(Cb(this.model))return"point-default";if(Lg(this.model)||$u(this.model))return r.lines&&r.points?"table-points-and-lines":r.lines?"table-lines":"table-points";if(lT(this.model))return"polygon-default-filled";let i=this.getDisplayProps().fill;if(pb(this.model))return i?r.lines?t==="DASHED"?"polygon-dashed-filled":t==="DOTTED"?"polygon-dotted-filled":"polygon-default-filled":"polygon-none-filled":r.lines?t==="DASHED"?"polygon-dashed":t==="DOTTED"?"polygon-dotted":"polygon-default":"none";if(Gg(this.model))return i?r.lines?t==="DASHED"?"parametric-dashed-filled":t==="DOTTED"?"parametric-dotted-filled":"parametric-default-filled":"parametric-none-filled":r.lines?t==="DASHED"?"graph-dashed":t==="DOTTED"?"graph-dotted":"graph-default":"none";let o=n.operator,a=__dcg_shared_module_exports__.rc[o].direction!==0,s=__dcg_shared_module_exports__.rc[o].inclusive===!1;return n.is_shade_between||!s&&a?"shaded-inequality":s&&!a?"inequality":s&&a?"shaded-inequality":t==="DASHED"?"graph-dashed":t==="DOTTED"?"graph-dotted":"graph-default"}getIconAriaLabel(){return this.displaySlowPlotting()?this.controller.s("shared-calculator-label-slow-plotting"):this.isFraction()?Hu(this.model)?this.controller.s("shared-calculator-narration-display-as-decimal"):this.controller.s("shared-calculator-narration-display-as-fraction"):this.myOptionsOpen()?Xr(this.model,"hide-options"):this.controller.isInEditListMode()?Xr(this.model,"show-options"):Is(this.model)?this.model.hidden?Xr(this.model,"unmute"):Xr(this.model,"mute"):this.model.hidden?Xr(this.model,"show"):Xr(this.model,"hide")}},as=__dcg_shared_module_exports__.e(ne()),{If:xoe}=as.Components,sD=class extends as.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return as.createElement(xoe,{predicate:this.bindFn(this.shouldShow)},()=>as.createElement("div",{class:as.const("dcg-generate-table-view dcg-do-blur"),handleEvent:as.const(!0)},as.createElement(Le,{tooltip:this.bindFn(this.getTooltip),gravity:()=>"s"},as.createElement("i",{onTap:()=>this.controller.dispatch({type:"convert-or-create-table",index:this.model.index}),role:as.const("button"),tabIndex:as.const("0"),"aria-label":()=>Xr(this.model,"create_table"),class:as.const("dcg-icon-create-table")}))))}shouldShow(){return Sg(this.model)!=="recursive-function"||!this.model||this.model.type!=="expression"?!1:!this.controller.hasTableHeaderWithIdentifier(this.model.formula.function_definition)}getTooltip(){return this.controller.s("graphing-calculator-label-create-table")}},ss=__dcg_shared_module_exports__.e(ne()),{If:woe}=ss.Components,Qb=class extends ss.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return ss.createElement(woe,{predicate:()=>this.controller.showExpressionZoomFitButton(this.model)},()=>ss.createElement("div",{class:ss.const("dcg-suggested-zoom-view dcg-do-blur"),handleEvent:ss.const(!0)},ss.createElement(Le,{tooltip:this.bindFn(this.getZoomText),gravity:()=>"e"},ss.createElement("i",{onTap:this.bindFn(this.onZoom),role:ss.const("button"),tabIndex:ss.const("0"),"aria-label":this.bindFn(this.getZoomText),class:ss.const("dcg-icon-zoom-fit")}))))}getZoomText(){return this.controller.s("graphing-calculator-text-zoom-fit")}onZoom(e){this.controller.dispatch({type:"expression-zoom-fit",id:this.model.id,focusAfterTap:e.device==="keyboard"})}},cn=__dcg_shared_module_exports__.e(ne()),{If:voe,Switch:Coe}=cn.Components,Wl=class extends cn.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}iconType(){return this.controller.shouldShowReplaceIcon()?"rename":this.controller.isItemMarkedReadonly(this.model.id)?"lock":"delete"}getAriaLabel(){switch(this.iconType()){case"none":case"lock":return;case"rename":return Xr(this.model,"rename");case"delete":return Xr(this.model,"delete")}}onIconTap(){this.iconType()==="delete"?this.controller.dispatch({type:"delete-item-and-animate-out",id:this.model.id,setFocusAfterDelete:!this.controller.isInEditListMode()}):this.iconType()==="rename"&&this.controller.dispatch({type:"rename-identifier-in-item",search:this.controller.getExpressionSearchStr(),replace:this.controller.getExpressionReplaceStr(),id:this.model.id})}isIconTappable(){let e=this.iconType();return e!=="none"&&e!=="lock"}template(){return cn.createElement(voe,{predicate:()=>!this.controller.isInEditListMode()},()=>cn.createElement("div",{class:()=>({"dcg-top-level-icon":!0,"dcg-tappable":this.isIconTappable()}),tabIndex:()=>this.isIconTappable()?0:-1,"aria-label":this.bindFn(this.getAriaLabel),handleEvent:this.bindFn(this.isIconTappable),onTap:this.bindFn(this.onIconTap),role:cn.const("button"),manageFocus:this.const({shouldBeFocused:()=>Bg({controller:this.controller,location:{type:"top-level-icon",id:this.model.id}}),onFocusedChanged:(e,t)=>{var r;e?this.controller.dispatch({type:"set-focus-location",location:{type:"top-level-icon",id:this.model.id}}):t.relatedTarget&&!((r=t.relatedTarget)!=null&&r.closest("[data-dcg-label]"))&&this.controller.dispatch({type:"blur-focus-location",location:{type:"top-level-icon",id:this.model.id}})}})},cn.createElement(Coe,{key:()=>this.iconType()},e=>{switch(e){case"delete":return cn.createElement("i",{class:cn.const("dcg-icon-remove dcg-top-level-delete"),"aria-hidden":cn.const("true")});case"lock":return cn.createElement("i",{class:cn.const("dcg-icon-lock dcg-lock-indicator"),"aria-hidden":cn.const("true")});case"rename":return cn.createElement("i",{class:cn.const("dcg-icon-replace"),"aria-hidden":cn.const("true")});case"none":return cn.createElement("span",null)}})))}},{If:Z8}=Ur.Components,Wg=class extends is{didMountRootNode(e){this.rootNode=e,this.onItemViewMounted(e),this.lastBrailleMode=this.controller.getBrailleMode()}willUnmount(){this.onItemViewUnmounted()}template(){return Ur.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-mathitem":!0,"dcg-inFolder":!!this.model.folderId,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-selected":this.controller.isItemSelected(this.id)&&!this.controller.isInEditListMode(),"dcg-dragging":this.controller.isItemBeingDragged(this.id),"dcg-hasSlider":this.hasSlider(),"dcg-hasEvaluation":!!this.controller.shouldShowEvaluationForItem(this.id),"dcg-hasRegression":this.hasRegression(),"dcg-hasDomain":this.hasDomain()||this.hasDomain3d()}),"expr-id":()=>this.model.id,didMount:this.bindFn(this.didMountRootNode)},Ur.createElement("div",{class:Ur.const("dcg-fade-container"),onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},Ur.createElement("div",{class:Ur.const("dcg-main")},Ur.createElement(Z8,{predicate:()=>!this.controller.isInEditListMode()&&!this.isReadonly()},()=>Ur.createElement(Mo,R({latex:()=>Kw(this.model),operatorNames:()=>this.getMQConfig().autoOperatorNames,ariaLabel:()=>this.getAriaLabel("braille"),brailleShouldFocus:()=>this.isFocused(),onBrailleInput:e=>this.handleLatexChanged(e),onBrailleFocusedChanged:(e,t)=>this.handleMQFocusedChanged(e,t),onBrailleKeydown:this.bindFn(this.handleBraillePressedKey)},ui(this.controller)),Ur.createElement(Fe,{latex:()=>Kw(this.model),getAriaLabel:()=>this.getAriaLabel("speech"),getAriaPostLabel:this.bindFn(this.getFormulaAria),isFocused:()=>this.isFocused(),noFadeout:()=>this.controller.isItemMarkedReadonly(this.model.id),tokenController:this.props.controller,capExpressionSize:()=>this.controller.getCapExpressionSize(),config:this.bindFn(this.getMQConfig),hasError:this.const(!1),onUserPressedKey:(e,t)=>this.handlePressedKey(e,t),onUserChangedLatex:e=>this.handleLatexChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:(e,t)=>this.handleMQFocusedChanged(e,t),onSelectionChanged:()=>{this.controller.runAfterDispatch(()=>{this.controller.dispatch({type:"render"})})},needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))),Ur.createElement(Z8,{predicate:()=>this.controller.isInEditListMode()||this.isReadonly()},()=>Ur.createElement("div",{class:Ur.const("dcg-edit-list-mathquill"),onTap:()=>this.controller.isInEditListMode()?this.exitEditListMode():{},onKeyDown:this.bindFn(this.handleReadonlyPressedKey)},Ur.createElement(Mo,R({latex:()=>Kw(this.model),operatorNames:()=>this.getMQConfig().autoOperatorNames,ariaLabel:()=>this.getAriaLabel("braille"),isStatic:this.const(!0),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="readonly-expression"?!1:e.id===this.id},onBrailleFocusedChanged:(e,t)=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"readonly-expression",id:this.model.id}}):this.doesNodeBelongToSliderLimit(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"readonly-expression",id:this.model.id}})}},ui(this.controller)),Ur.createElement(nt,{latex:()=>Kw(this.model),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech"),tokenController:this.props.controller},Ur.createElement("span",{class:Ur.const("dcg-focusable-readonly-mathquill"),tabIndex:Ur.const("0"),role:Ur.const("textbox"),"aria-readonly":Ur.const("true"),manageFocus:this.const({shouldBeFocused:()=>this.controller.getBrailleMode()!=="none"?!1:Bg({controller:this.controller,location:{type:"readonly-expression",id:this.model.id}}),onFocusedChanged:(e,t)=>{this.controller.getBrailleMode()==="none"&&(e?this.controller.dispatch({type:"set-focus-location",location:{type:"readonly-expression",id:this.model.id}}):this.doesNodeBelongToSliderLimit(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"readonly-expression",id:this.model.id}}))}})})))))),Ur.createElement(Wl,{controller:this.props.controller,model:this.props.model}),Ur.createElement(rD,{controller:this.props.controller,model:this.props.model,isFirstRender:this.bindFn(this.isFirstRender)})),Ur.createElement("span",{class:()=>R({"dcg-tab":!0,"dcg-action-drag":!0,"dcg-action-icon-touch":!0},this.debugProgressClassMap()),handleEvent:Ur.const("true"),tapboundary:Ur.const("true"),disablescroll:Ur.const("true"),onTapStart:this.bindFn(this.onDragPending)},Ur.createElement("span",{class:Ur.const("dcg-num")},()=>this.model.displayIndex),Ur.createElement("div",{class:Ur.const("dcg-tab-interior dcg-action-icon-mouse")},Ur.createElement(Cv,{model:this.props.model,controller:this.props.controller})),Ur.createElement(Qb,{model:this.props.model,controller:this.props.controller}),Ur.createElement(sD,{model:this.props.model,controller:this.props.controller})),Ur.createElement(Hl,{controller:this.props.controller,id:()=>this.model.id}))}debugProgressClassMap(){if(!this.controller.shouldShowProgressUpdateColors())return{};let e=this.controller.getEvaluatorStateForItem(this.model.id);switch(e){case void 0:case"IDLE":case"RESOLVED":return{};case"UNPUBLISHED":return{"dcg-progress-unpublished":!0};case"ANALYZING":return{"dcg-progress-analyzing":!0};case"GRAPHING":return{"dcg-progress-graphing":!0};default:throw new Error(`Unexpected analysis state: ${e}`)}}didUpdate(){this.lastBrailleMode=this.controller.getBrailleMode()}shouldShowLabelView(){return ub(this.model)&&!this.controller.isThreeDMode()}hasRegression(){return!!this.model.formula.is_regression}hasDomain(){return Wu(this.model)}hasDomain3d(){return Dp(this.model)}isTTest(){return jw(this.model)}hasSlider(){return!!this.model.sliderExists}getLabelOptions(){return this.controller.getEvaluationLabelOptionsForItem(this.model.id)}getAriaLabel(e){if(this.shouldShowLabelView()){let t;this.model.label&&this.model.label!==""?t=this.model.label:e==="speech"?t=this.controller.s("graphing-calculator-narration-expression-label"):t=this.controller.raw("lbl");let r;return ja(this.model)?r=t:e==="speech"?r=this.controller.s("graphing-calculator-narration-expression-hidden-label",{label:t}):r=this.controller.raw("h __label__",{label:t}),r}if(e==="speech"){let t=this.controller.s("shared-calculator-narration-expression-index",{index:this.model.displayIndex});if(this.controller.shouldShowProgressUpdateIcons()){let r=this.controller.getEvaluatorStateForItem(this.model.id);if(r)return`${t} - ${r}`}return t}else return this.controller.raw("eq__index__",{index:this.model.displayIndex})}getFormulaAria(){let e=this.model.formula,t="";if(this.controller.isItemSlowInEvaluator(this.model.id))return this.controller.shouldShowEvaluationForItem(this.id)?this.controller.s("graphing-calculator-narration-slow-evaluation"):this.controller.s("graphing-calculator-narration-slow-compute");if(!e||Vl(this.model))return t;if(this.controller.shouldShowEvaluationForItem(this.model.id))t=`equals ${IT(this.model,this.controller,this.getLabelOptions())}`;else if(e.error&&!this.controller.shouldShowSliderPrompt(this.model))t=this.controller.unpack(e.error);else if(this.controller.shouldShowSliderPrompt(this.model)){let r=Ep(this.model).length;if(r>0)t=this.controller.s("graphing-calculator-narration-add-base-case-prompt",{count:__dcg_shared_module_exports__.ra(r)});else{let n=[],i=ab(this.model);for(let o=0;o<i.length;o++)n.push(Ao(i[o]));t=this.controller.s("graphing-calculator-narration-add-slider-prompt",{vars:Cd(this.controller.getLanguage(),n)})}}else _p(this.model)?t=this.controller.s("graphing-calculator-narration-expression-evaluation-is-distribution"):this.isTTest()&&(t=this.controller.s("graphing-calculator-narration-expression-evaluation-is-t-test"));if(this.model.shouldGraph&&(e.is_graphable||e.is_regression)){e.is_graphable&&e.is_regression?t+=" "+this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph-and-regression"):e.is_regression?t+=" "+this.controller.s("graphing-calculator-narration-expression-evaluation-has-regression"):t+=" "+this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph");let r=this.controller.getAudioGraph();r&&r.agNavigator.canTrace(this.model)&&(Zo?t+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-mac"):t+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-windows"))}return this.controller.toneEnabled()&&Is(this.model)&&(this.model.hidden?t+=" "+this.controller.s("graphing-calculator-narration-expression-tone-muted"):t+=" "+this.controller.s("graphing-calculator-narration-expression-tone-unmuted")),t}handleBraillePressedKey(e){let t=ke(e);if(t){if(t==="Esc")Jr(),this.hasSlider()&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.model.id}});else if(t==="Up"||t==="Down"||t==="Enter")this.controller.dispatch({type:"on-special-key-pressed",key:t});else if(t==="Del"||t==="Backspace"){let r=os();Vl(this.model)&&Wb(r)&&(this.controller.dispatch({type:"on-special-key-pressed",key:t==="Del"?"Delete":t}),e.preventDefault(),e.stopPropagation())}}}handleReadonlyPressedKey(e){if(this.controller.isInEditListMode())return;let t=ke(e);!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(t==="Esc"?(e.preventDefault(),e.stopPropagation(),Jr(),this.hasSlider()&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.model.id}})):(t==="Up"||t==="Down"||t==="Enter")&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"on-special-key-pressed",key:t})))}handlePressedKey(e,t){var r;let n=Fe.getFocusedMathquill();if(n){if(t&&this.controller.isGraphPaperFocused()){let i=(r=this.controller.getGrapher2d())==null?void 0:r.poiController;if(!i)return;let o=i.keyboardAttentionManager;if(e==="Tab"||e==="Shift-Tab"){t.stopPropagation(),t.preventDefault(),o.focusNextObjFromKeyboard({direction:t.shiftKey?"prev":"next"});return}else if(e==="Left"||e==="Right"||e==="Up"||e==="Down"||e==="Shift-Left"||e==="Shift-Right"||e==="Shift-Up"||e==="Shift-Down"){t.stopPropagation(),t.preventDefault(),t&&i.moveGeoPointFromKeyboard(t);return}else if(e==="Enter"){t.stopPropagation(),t.preventDefault();let a=o.getKeyboardAttention();i.activateGeoObjectFromKeyboard(a,t),this.controller.getEvaluator().notifyWhenSynced(()=>{let s=this.controller.getValidCursorContext(),l=this.model.formula.cursor_context;if(s&&__dcg_shared_module_exports__.E(s,l)){let c=this.controller.getFocusLocation();if(c&&c.type==="expression"&&c.id===this.model.id&&!c.isFakeGraphFocus&&this.controller.dispatch({type:"set-focus-location",location:ie(R({},c),{isFakeGraphFocus:!0})}),a){let d=o.findTabbableObjectsForCurrentTool(a);d.currentIsTabbable&&o.updateKeyboardAttention(d.targets[d.currentTabIndex],{describe:!1})}}});return}else if(e==="Esc"){t.stopPropagation(),t.preventDefault(),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.model.id}});return}}if(e==="Esc"){Jr(),this.hasSlider()&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.model.id}});return}else{if(e==="Up"||e==="Down")return Fe.applyArrowKeyAndReturnIfWasAtBounds(n,e,t)?this.controller.dispatch({type:"on-special-key-pressed",key:e}):void 0;if(e==="Delete"||e==="Backspace"){if(Vl(this.model))return this.controller.dispatch({type:"on-special-key-pressed",key:e})}else if(e==="Enter")return t&&(t.preventDefault(),t.stopPropagation()),this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"})}n.keystroke(e,t),this.handleLatexChanged(n.latex())}}handleLatexChanged(e){e!==this.model.latex&&this.controller.dispatch({type:"set-item-latex",id:this.id,latex:e,source:"user-edit"})}doesNodeBelongToSliderLimit(e){return!e||!this.rootNode.contains(e)?!1:!!e.closest("[data-dcg-label]")}handleMQFocusedChanged(e,t){e?this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}):!this.doesNodeBelongToSliderLimit(t.relatedTarget)&&this.lastBrailleMode===this.controller.getBrailleMode()&&this.controller.dispatch({type:"blur-focus-location",location:{type:"expression",id:this.id}})}onMouseSelect(e){this.isReadonly()||e.device!=="keyboard"&&(e.type==="dcg-tap"&&e.device==="mouse"||e.type==="dcg-tapstart"&&e.device==="touch"||e.wasHandled()||(e.handle(),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}})))}isReadonly(){return this.controller.isItemReadonly(this.id)}isFocused(){let e=this.controller.getFocusLocation();return!e||e.type!=="expression"?!1:e.id===this.id}hasError(){return!!this.model.error&&!Vl(this.model)}getMQConfig(){return this.controller.getMathquillConfig({})}};function ui(e){return{sixKeyInput:()=>e.getSixKeyInput(),mode:()=>e.getBrailleMode(),capExpressionSize:()=>e.getCapExpressionSize()?{exceedsLimit:t=>t.length>zb,onExpressionSizeExceeded:()=>e.dispatch({type:"expression-size-exceeded"})}:void 0}}var bt=function(e,t,r){var n=document.createElement("img"),i,o;if(n.onerror=t,n.onload=function(){o&&!(r&&r.noRevoke)&&bt.revokeObjectURL(o),t&&t(bt.scale(n,r))},bt.isInstanceOf("Blob",e)||bt.isInstanceOf("File",e))i=o=bt.createObjectURL(e),n._type=e.type;else if(typeof e=="string")i=e,r&&r.crossOrigin&&(n.crossOrigin=r.crossOrigin);else return!1;return i?(n.src=i,n):bt.readFile(e,function(a){var s=a.target;s&&s.result?n.src=s.result:t&&t(a)})},lD=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;bt.isInstanceOf=function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},bt.transformCoordinates=function(){},bt.getTransformedOptions=function(e){return e},bt.renderImageToCanvas=function(e,t,r,n,i,o,a,s,l,c){return e.getContext("2d").drawImage(t,r,n,i,o,a,s,l,c),e},bt.hasCanvasOption=function(e){return e.canvas||e.crop},bt.scale=function(e,t){t=t||{};var r=document.createElement("canvas"),n=e.getContext||bt.hasCanvasOption(t)&&r.getContext,i=e.naturalWidth||e.width,o=e.naturalHeight||e.height,a=i,s=o,l,c,d,u,p,g,f,y,E,_=function(){var v=Math.max((d||a)/a,(u||s)/s);v>1&&(a=Math.ceil(a*v),s=Math.ceil(s*v))},w=function(){var v=Math.min((l||a)/a,(c||s)/s);v<1&&(a=Math.ceil(a*v),s=Math.ceil(s*v))};return n&&(t=bt.getTransformedOptions(t),f=t.left||0,y=t.top||0,t.sourceWidth?(p=t.sourceWidth,t.right!==void 0&&t.left===void 0&&(f=i-p-t.right)):p=i-f-(t.right||0),t.sourceHeight?(g=t.sourceHeight,t.bottom!==void 0&&t.top===void 0&&(y=o-g-t.bottom)):g=o-y-(t.bottom||0),a=p,s=g),l=t.maxWidth,c=t.maxHeight,d=t.minWidth,u=t.minHeight,n&&l&&c&&t.crop?(a=l,s=c,E=p/g-l/c,E<0?(g=c*p/l,t.top===void 0&&t.bottom===void 0&&(y=(o-g)/2)):E>0&&(p=l*g/c,t.left===void 0&&t.right===void 0&&(f=(i-p)/2))):((t.contain||t.cover)&&(d=l=l||d,u=c=c||u),t.cover?(w(),_()):(_(),w())),n?(r.width=a,r.height=s,bt.transformCoordinates(r,t),bt.renderImageToCanvas(r,e,f,y,p,g,0,0,a,s)):(e.width=a,e.height=s,e)},bt.createObjectURL=function(e){return lD?lD.createObjectURL(e):!1},bt.revokeObjectURL=function(e){return lD?lD.revokeObjectURL(e):!1},bt.readFile=function(e,t,r){if(window.FileReader){var n=new FileReader;if(n.onload=n.onerror=t,r=r||"readAsDataURL",n[r])return n[r](e),n}return!1},(!window.navigator||!window.navigator.platform||!/iP(hone|od|ad)/.test(window.navigator.platform))&&(eK=bt.renderImageToCanvas,bt.detectSubsampling=function(e){var t,r;return e.width*e.height>1024*1024?(t=document.createElement("canvas"),t.width=t.height=1,r=t.getContext("2d"),r.drawImage(e,-e.width+1,0),r.getImageData(0,0,1,1).data[3]===0):!1},bt.detectVerticalSquash=function(e,t){var r=e.naturalHeight||e.height,n=document.createElement("canvas"),i=n.getContext("2d"),o,a,s,l,c;for(t&&(r/=2),n.width=1,n.height=r,i.drawImage(e,0,0),o=i.getImageData(0,0,1,r).data,a=0,s=r,l=r;l>a;)c=o[(l-1)*4+3],c===0?s=l:a=l,l=s+a>>1;return l/r||1},bt.renderImageToCanvas=function(e,t,r,n,i,o,a,s,l,c){if(t._type==="image/jpeg"){var d=e.getContext("2d"),u=document.createElement("canvas"),p=1024,g=u.getContext("2d"),f,y,E,_;if(u.width=p,u.height=p,d.save(),f=bt.detectSubsampling(t),f&&(r/=2,n/=2,i/=2,o/=2),y=bt.detectVerticalSquash(t,f),f||y!==1){for(n*=y,l=Math.ceil(p*l/i),c=Math.ceil(p*c/o/y),s=0,_=0;_<o;){for(a=0,E=0;E<i;)g.clearRect(0,0,p,p),g.drawImage(t,r,n,i,o,-E,-_,i,o),d.drawImage(u,0,0,p,p,a,s,l,c),E+=p,a+=l;_+=p,s+=c}return d.restore(),e}}return eK(e,t,r,n,i,o,a,s,l,c)});var eK,Soe=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);bt.blobSlice=Soe&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},bt.metaDataParsers={jpeg:{65505:[]}},bt.parseMetaData=function(e,t,r){r=r||{};var n=this,i=r.maxMetaDataSize||262144,o={},a=!(window.DataView&&e&&e.size>=12&&e.type==="image/jpeg"&&bt.blobSlice);(a||!bt.readFile(bt.blobSlice.call(e,0,i),function(s){var l=s.target.result,c=new DataView(l),d=2,u=c.byteLength-4,p=d,g,f,y,E;if(c.getUint16(0)===65496){for(;d<u&&(g=c.getUint16(d),g>=65504&&g<=65519||g===65534);){if(f=c.getUint16(d+2)+2,d+f>c.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(y=bt.metaDataParsers.jpeg[g],y)for(E=0;E<y.length;E+=1)y[E].call(n,c,d,f,o,r);d+=f,p=d}!r.disableImageHead&&p>6&&(l.slice?o.imageHead=l.slice(0,p):o.imageHead=new Uint8Array(l).subarray(0,p))}else console.log("Invalid JPEG file: Missing JPEG marker.");t(o)},"readAsArrayBuffer"))&&t(o)};var Eoe=bt.hasCanvasOption;bt.hasCanvasOption=function(e){return Eoe(e)||e.orientation},bt.transformCoordinates=function(e,t){var r=e.getContext("2d"),n=e.width,i=e.height,o=t.orientation;if(o)switch(o>4&&(e.width=i,e.height=n),o){case 2:r.translate(n,0),r.scale(-1,1);break;case 3:r.translate(n,i),r.rotate(Math.PI);break;case 4:r.translate(0,i),r.scale(1,-1);break;case 5:r.rotate(.5*Math.PI),r.scale(1,-1);break;case 6:r.rotate(.5*Math.PI),r.translate(0,-i);break;case 7:r.rotate(.5*Math.PI),r.translate(n,-i),r.scale(-1,1);break;case 8:r.rotate(-.5*Math.PI),r.translate(-n,0);break}},bt.getTransformedOptions=function(e){if(!e.orientation||e.orientation===1)return e;var t={},r;for(r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);switch(e.orientation){case 2:t.left=e.right,t.right=e.left;break;case 3:t.left=e.right,t.top=e.bottom,t.right=e.left,t.bottom=e.top;break;case 4:t.top=e.bottom,t.bottom=e.top;break;case 5:t.left=e.top,t.top=e.left,t.right=e.bottom,t.bottom=e.right;break;case 6:t.left=e.top,t.top=e.right,t.right=e.bottom,t.bottom=e.left;break;case 7:t.left=e.bottom,t.top=e.right,t.right=e.top,t.bottom=e.left;break;case 8:t.left=e.bottom,t.top=e.left,t.right=e.top,t.bottom=e.right;break}return e.orientation>4&&(t.maxWidth=e.maxHeight,t.maxHeight=e.maxWidth,t.minWidth=e.minHeight,t.minHeight=e.minWidth,t.sourceWidth=e.sourceHeight,t.sourceHeight=e.sourceWidth),t},bt.ExifMap=function(){return this},bt.ExifMap.prototype.map={Orientation:274},bt.ExifMap.prototype.get=function(e){return this[e]||this[this.map[e]]},bt.getExifThumbnail=function(e,t,r){var n,i,o;if(!r||t+r>e.byteLength){console.log("Invalid Exif data: Invalid thumbnail data.");return}for(n=[],i=0;i<r;i+=1)o=e.getUint8(t+i),n.push((o<16?"0":"")+o.toString(16));return"data:image/jpeg,%"+n.join("%")},bt.exifTagTypes={1:{getValue:function(e,t){return e.getUint8(t)},size:1},2:{getValue:function(e,t){return String.fromCharCode(e.getUint8(t))},size:1,ascii:!0},3:{getValue:function(e,t,r){return e.getUint16(t,r)},size:2},4:{getValue:function(e,t,r){return e.getUint32(t,r)},size:4},5:{getValue:function(e,t,r){return e.getUint32(t,r)/e.getUint32(t+4,r)},size:8},9:{getValue:function(e,t,r){return e.getInt32(t,r)},size:4},10:{getValue:function(e,t,r){return e.getInt32(t,r)/e.getInt32(t+4,r)},size:8}},bt.exifTagTypes[7]=bt.exifTagTypes[1],bt.getExifValue=function(e,t,r,n,i,o){var a=bt.exifTagTypes[n],s,l,c,d,u,p;if(!a){console.log("Invalid Exif data: Invalid tag type.");return}if(s=a.size*i,l=s>4?t+e.getUint32(r+8,o):r+8,l+s>e.byteLength){console.log("Invalid Exif data: Invalid data offset.");return}if(i===1)return a.getValue(e,l,o);for(c=[],d=0;d<i;d+=1)c[d]=a.getValue(e,l+d*a.size,o);if(a.ascii){for(u="",d=0;d<c.length&&(p=c[d],p!=="\0");d+=1)u+=p;return u}return c},bt.parseExifTag=function(e,t,r,n,i){var o=e.getUint16(r,n);i.exif[o]=bt.getExifValue(e,t,r,e.getUint16(r+2,n),e.getUint32(r+4,n),n)},bt.parseExifTags=function(e,t,r,n,i){var o,a,s;if(r+6>e.byteLength){console.log("Invalid Exif data: Invalid directory offset.");return}if(o=e.getUint16(r,n),a=r+2+12*o,a+4>e.byteLength){console.log("Invalid Exif data: Invalid directory size.");return}for(s=0;s<o;s+=1)this.parseExifTag(e,t,r+2+12*s,n,i);return e.getUint32(a,n)},bt.parseExifData=function(e,t,r,n,i){if(!i.disableExif){var o=t+10,a,s,l;if(e.getUint32(t+4)===1165519206){if(o+8>e.byteLength){console.log("Invalid Exif data: Invalid segment size.");return}if(e.getUint16(t+8)!==0){console.log("Invalid Exif data: Missing byte alignment offset.");return}switch(e.getUint16(o)){case 18761:a=!0;break;case 19789:a=!1;break;default:console.log("Invalid Exif data: Invalid byte alignment marker.");return}if(e.getUint16(o+2,a)!==42){console.log("Invalid Exif data: Missing TIFF marker.");return}s=e.getUint32(o+4,a),n.exif=new bt.ExifMap,s=bt.parseExifTags(e,o,o+s,a,n),s&&!i.disableExifThumbnail&&(l={exif:{}},s=bt.parseExifTags(e,o,o+s,a,l),l.exif[513]&&(n.exif.Thumbnail=bt.getExifThumbnail(e,o+l.exif[513],l.exif[514]))),n.exif[34665]&&!i.disableExifSub&&bt.parseExifTags(e,o,o+n.exif[34665],a,n),n.exif[34853]&&!i.disableExifGps&&bt.parseExifTags(e,o,o+n.exif[34853],a,n)}}},bt.metaDataParsers.jpeg[65505].push(bt.parseExifData),bt.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},bt.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}},bt.ExifMap.prototype.getText=function(e){var t=this.get(e);switch(e){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[e][t];case"ExifVersion":case"FlashpixVersion":return String.fromCharCode(t[0],t[1],t[2],t[3]);case"ComponentsConfiguration":return this.stringValues[e][t[0]]+this.stringValues[e][t[1]]+this.stringValues[e][t[2]]+this.stringValues[e][t[3]];case"GPSVersionID":return t[0]+"."+t[1]+"."+t[2]+"."+t[3]}return String(t)},function(e){var t=e.tags,r=e.map,n;for(n in t)t.hasOwnProperty(n)&&(r[t[n]]=n)}(bt.ExifMap.prototype),bt.ExifMap.prototype.getAll=function(){var e={},t,r;for(t in this)this.hasOwnProperty(t)&&(r=this.tags[t],r&&(e[r]=this.getText(r)));return e};function tK(e,t){let r=[.92,.86,.8,.7,.6,.5,.4,.3,.2,.1],n;for(let i=0;i<r.length;i++)if(n=e.toDataURL("image/jpeg",r[i]),n.length<t)return n;return n}function Toe(e,t){let r=e.toDataURL().length,n=e.width,i=e.height,o=document.createElement("canvas"),a;for(let s=0;s<2;s++){let l=Math.sqrt(t/r);if(n=Math.round(l*n),i=Math.round(l*i),o.height=i,o.width=n,o.getContext("2d").drawImage(e,0,0,n,i),a=o.toDataURL(),r=a.length,r<t)return a}return a}function Doe(e){let t=e.getContext("2d").getImageData(0,0,e.width,e.height).data;for(let r=3;r<t.length;r+=4)if(t[r]!==255)return!0;return!1}function cD(e,t){bt(e,r=>{if(!r.toDataURL){t(!0);return}let n=2e5,i;e.type==="image/jpeg"?i=tK(r,n):(i=r.toDataURL(),i.length>n&&(i=i.length>.75*r.width*r.height&&!Doe(r)?tK(r,n):Toe(r,n))),t(null,i)},{orientation:!0,canvas:!0,maxWidth:1600,maxHeight:1600})}var Pn=__dcg_shared_module_exports__.e(ne());function dD(e){let t=document.createElement("a");return t.href=e,t.href}var{SwitchUnion:koe,If:_oe}=Pn.Components,$g=class extends Pn.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return Pn.createElement("div",{class:Pn.const("dcg-expression-icon-container dcg-image-icon-container")},koe(this.bindFn(this.typeOfIcon),{error:()=>Pn.createElement(Di,{error:()=>this.controller.unpack(this.model.error),isWhite:this.bindFn(this.isSelected)}),failed:()=>Pn.createElement("span",null),loading:()=>Pn.createElement($o,{iconType:this.const("loading")}),hidden:()=>this.buildIconView(),image:()=>this.buildIconView()}))}buildIconView(){return Pn.createElement("div",{class:Pn.const("dcg-circular-icon-container"),role:Pn.const("button"),tabIndex:Pn.const("0"),"dcg-open-menu-guid":()=>this.getMenuGUID(),"aria-label":this.bindFn(this.getIconAriaLabel),onTap:e=>{if(!e.wasHandled("dragdrop")&&!e.wasLongheld()){if(this.myOptionsOpen())return this.toggleOptions(e);if(this.controller.isInEditListMode()||e.shiftKey)return this.toggleOptions(e);this.toggleImageShown()}},onLongHold:e=>{e.handle("dcg-longhold"),e.handle("dcg-tap"),this.toggleOptions(e)},manageFocus:this.const(rt({controller:this.controller,location:{type:"image-icon",id:this.model.id}}))},Pn.createElement($o,{iconType:()=>this.typeOfIcon()==="hidden"?"hidden":"background",backgroundImage:this.bindFn(this.getBackgroundImage),backgroundOpacity:this.const(1),whiteIcon:this.bindFn(this.isSelected)}),Pn.createElement(_oe,{predicate:()=>this.model.disableGraphInteractions},()=>Pn.createElement("i",{class:Pn.const("dcg-graph-interaction-disabled dcg-icon-lock")})))}isSelected(){return this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)}typeOfIcon(){return this.model.loadStatus==="loading"?"loading":this.model.loadStatus==="failed"?"failed":this.hasError()?"error":this.model.shouldGraph?"image":"hidden"}getMenuGUID(){return this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"image",model:this.model,guid:this.getMenuGUID(),focusFirstOption:e.device==="keyboard"}})}hasError(){return!!this.model.error&&this.controller.getBrailleMode()==="none"}getBackgroundImage(){return this.model.image_url===this.lastURL?this.lastEncodedURL:(this.lastURL=this.model.image_url,this.lastEncodedURL='url("'+dD(this.model.image_url)+'")',this.lastEncodedURL)}toggleImageShown(){this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id}),this.controller.dispatch({type:"set-focus-location",location:{type:"image-icon",id:this.model.id}})}getIconAriaLabel(){return this.myOptionsOpen()?Xr(this.model,"hide-options"):this.controller.isInEditListMode()?Xr(this.model,"show-options"):this.model.hidden?Xr(this.model,"show"):Xr(this.model,"hide")}};function Ev(e,t){for(let r in t)if(t.hasOwnProperty(r)&&t[r]===e)return!0;return!1}function SP(e){return Ev(e,TP)}function EP(e){return Ev(e,DP)}function oK(e){return Ev(e,kP)}function Ioe(e){return Ev(e,Sv)}function Aoe(e){return Ev(e,_P)}var TP={OPEN:"OPEN",CROSS:"CROSS",POINT:"POINT"},DP={SOLID:"SOLID",DASHED:"DASHED",DOTTED:"DOTTED"},kP={NONE:"NONE",AUTO:"AUTO",X:"X",Y:"Y",XY:"XY"},Sv={POINTS:"POINTS",LINES:"LINES",POINTS_AND_LINES:"POINTS_AND_LINES"},_P={DEFAULT:"default",CENTER:"center",CENTER_AUTO:"center_auto",AUTO_CENTER:"auto_center",ABOVE:"above",ABOVE_LEFT:"above_left",ABOVE_RIGHT:"above_right",ABOVE_AUTO:"above_auto",BELOW:"below",BELOW_LEFT:"below_left",BELOW_RIGHT:"below_right",BELOW_AUTO:"below_auto",LEFT:"left",AUTO_LEFT:"auto_left",RIGHT:"right",AUTO_RIGHT:"auto_right"};function Moe(e){return{id:e.id,type:e.type,columns:e.columns.map(Goe)}}function Goe(e){return{id:e.id,latex:e.latex,color:e.color,hidden:e.hidden,pointStyle:e.pointStyle,pointSize:e.pointSize,pointOpacity:e.pointOpacity,lineStyle:e.lineStyle,lineWidth:e.lineWidth,lineOpacity:e.lineOpacity,points:e.points,lines:e.lines,dragMode:e.dragMode,values:e.values.slice()}}function Loe(e){let t=["latex","color","lineStyle","lineWidth","lineOpacity","pointStyle","pointSize","movablePointSize","pointOpacity","points","lines","fill","fillOpacity","hidden","secret","dragMode","label","showLabel","labelSize","labelOrientation","interactiveLabel","readonly"],r={id:e.id,type:e.type};return t.forEach(n=>{e.hasOwnProperty(n)&&(r[n]=e[n])}),e.hasOwnProperty("parametricDomain")&&(r.parametricDomain={min:e.parametricDomain.min,max:e.parametricDomain.max}),e.hasOwnProperty("parametricDomain3Du")&&(r.parametricDomain3Du={min:e.parametricDomain3Du.min,max:e.parametricDomain3Du.max}),e.hasOwnProperty("parametricDomain3Dv")&&(r.parametricDomain3Dv={min:e.parametricDomain3Dv.min,max:e.parametricDomain3Dv.max}),e.hasOwnProperty("parametricDomain3Dr")&&(r.parametricDomain3Dr={min:e.parametricDomain3Dr.min,max:e.parametricDomain3Dr.max}),e.hasOwnProperty("parametricDomain3Dphi")&&(r.parametricDomain3Dphi={min:e.parametricDomain3Dphi.min,max:e.parametricDomain3Dphi.max}),e.hasOwnProperty("polarDomain")&&(r.polarDomain={min:e.polarDomain.min,max:e.polarDomain.max}),e.hasOwnProperty("domain")&&(r.domain={min:e.domain.min,max:e.domain.max}),e.slider&&(e.slider.hardMin&&(r.sliderBounds=r.sliderBounds||{},r.sliderBounds.min=e.slider.min),e.slider.hardMax&&(r.sliderBounds=r.sliderBounds||{},r.sliderBounds.max=e.slider.max),e.slider.step&&(r.sliderBounds=r.sliderBounds||{},r.sliderBounds.step=e.slider.step),r.playing=!!e.slider.isPlaying),r}function Poe(e){return{id:e.id,type:e.type,hidden:e.hidden,secret:e.secret}}function Voe(e){return{id:e.id,type:e.type,hidden:e.hidden,secret:e.secret}}function Ooe(e){return{id:e.id,type:e.type,secret:e.secret,text:e.text}}function pD(e){switch(e.type){case"expression":return Loe(e);case"table":return Moe(e);case"folder":return Voe(e);case"image":return Poe(e);case"text":return Ooe(e);default:return e}}function jg(e,t){return e.hasOwnProperty("id")?e.id+"":t.generateId()}function Roe(e,t){let r={type:"expression",id:jg(e,t)};if(r.type="expression",r.id=jg(e,t),e.hasOwnProperty("latex")&&(r.latex=e.latex+""),e.hasOwnProperty("color")&&(r.color=e.color+""),e.hasOwnProperty("points")&&(r.points=!!e.points),e.hasOwnProperty("lines")&&(r.lines=!!e.lines),e.hasOwnProperty("style")&&(__dcg_shared_module_exports__.qe.warn("As of API v1.1 the 'style' property is deprecated and has been split into 'pointStyle' and 'lineStyle'."),SP(e.style)?r.pointStyle=e.style:EP(e.style)?r.lineStyle=e.style:__dcg_shared_module_exports__.qe.warn("Invalid style: '"+e.style+"'.")),e.hasOwnProperty("pointStyle")&&(SP(e.pointStyle)?r.pointStyle=e.pointStyle:__dcg_shared_module_exports__.qe.warn("Invalid pointStyle: '"+e.pointStyle+"'.")),e.hasOwnProperty("pointSize")&&(r.pointSize=""+e.pointSize),e.hasOwnProperty("movablePointSize")&&(r.movablePointSize=""+e.movablePointSize),e.hasOwnProperty("pointOpacity")&&(r.pointOpacity=""+e.pointOpacity),e.hasOwnProperty("lineStyle")&&(EP(e.lineStyle)?r.lineStyle=e.lineStyle:__dcg_shared_module_exports__.qe.warn("Invalid lineStyle: '"+e.lineStyle+"'.")),e.hasOwnProperty("lineWidth")&&(r.lineWidth=""+e.lineWidth),e.hasOwnProperty("lineOpacity")&&(r.lineOpacity=""+e.lineOpacity),e.hasOwnProperty("hidden")&&(r.hidden=!!e.hidden),e.hasOwnProperty("readonly")&&(r.readonly=!!e.readonly),e.hasOwnProperty("secret")&&(r.secret=!!e.secret),e.hasOwnProperty("sliderBounds")&&e.sliderBounds&&(r.slider={min:__dcg_shared_module_exports__.be(e.sliderBounds.min),max:__dcg_shared_module_exports__.be(e.sliderBounds.max),step:__dcg_shared_module_exports__.be(e.sliderBounds.step)},r.slider.min&&(r.slider.hardMin=!0),r.slider.max&&(r.slider.hardMax=!0)),e.hasOwnProperty("playing")){let{playing:n}=e;typeof n!="boolean"?__dcg_shared_module_exports__.qe.warn(`Invalid value for 'playing'. Expected a boolean but got '${n}'.`):(r.slider||(r.slider={}),r.slider.isPlaying=n)}return e.hasOwnProperty("parametricDomain3Du")&&e.parametricDomain3Du&&(r.parametricDomain3Du={min:__dcg_shared_module_exports__.be(e.parametricDomain3Du.min),max:__dcg_shared_module_exports__.be(e.parametricDomain3Du.max)}),e.hasOwnProperty("parametricDomain3Dv")&&e.parametricDomain3Dv&&(r.parametricDomain3Dv={min:__dcg_shared_module_exports__.be(e.parametricDomain3Dv.min),max:__dcg_shared_module_exports__.be(e.parametricDomain3Dv.max)}),e.hasOwnProperty("parametricDomain3Dr")&&e.parametricDomain3Dr&&(r.parametricDomain3Dr={min:__dcg_shared_module_exports__.be(e.parametricDomain3Dr.min),max:__dcg_shared_module_exports__.be(e.parametricDomain3Dr.max)}),e.hasOwnProperty("parametricDomain3Dphi")&&e.parametricDomain3Dphi&&(r.parametricDomain3Dphi={min:__dcg_shared_module_exports__.be(e.parametricDomain3Dphi.min),max:__dcg_shared_module_exports__.be(e.parametricDomain3Dphi.max)}),e.hasOwnProperty("parametricDomain")&&e.parametricDomain?(r.parametricDomain={min:__dcg_shared_module_exports__.be(e.parametricDomain.min),max:__dcg_shared_module_exports__.be(e.parametricDomain.max)},e.hasOwnProperty("domain")&&__dcg_shared_module_exports__.qe.warn("Both 'parametricDomain' and the deprecated 'domain' property were specified. Using 'parametricDomain'.")):e.hasOwnProperty("domain")&&(__dcg_shared_module_exports__.qe.warn("The 'domain' property is deprecated.Use 'parametricDomain' to specify the domain for parametric functions"),r.parametricDomain={min:__dcg_shared_module_exports__.be(e.domain.min),max:__dcg_shared_module_exports__.be(e.domain.max)}),e.hasOwnProperty("polarDomain")&&e.polarDomain&&(r.polarDomain={min:__dcg_shared_module_exports__.be(e.polarDomain.min),max:__dcg_shared_module_exports__.be(e.polarDomain.max)}),e.hasOwnProperty("dragMode")&&(oK(e.dragMode)?r.dragMode=e.dragMode:__dcg_shared_module_exports__.qe.warn("Invalid dragMode: '"+e.dragMode+"'.")),e.hasOwnProperty("label")&&(r.label=e.label+""),e.hasOwnProperty("showLabel")&&(r.showLabel=!!e.showLabel),e.hasOwnProperty("showAngleLabel")&&(r.showAngleLabel=!!e.showAngleLabel),e.hasOwnProperty("labelSize")&&(typeof e.labelSize=="string"?r.labelSize=e.labelSize:__dcg_shared_module_exports__.qe.warn("Invalid labelSize: "+e.labelSize)),e.hasOwnProperty("labelOrientation")&&(Aoe(e.labelOrientation)?r.labelOrientation=e.labelOrientation:__dcg_shared_module_exports__.qe.warn("Invalid labelOrientation: "+e.labelOrientation)),e.hasOwnProperty("fill")&&(r.fill=!!e.fill),e.hasOwnProperty("fillOpacity")&&(r.fillOpacity=""+e.fillOpacity),r}function Foe(e,t){let r={id:jg(e,t)};return e.hasOwnProperty("latex")&&(r.latex=e.latex+""),e.hasOwnProperty("color")&&(r.color=e.color+""),e.hasOwnProperty("hidden")&&(r.hidden=!!e.hidden),e.hasOwnProperty("points")&&(r.points=!!e.points),e.hasOwnProperty("lines")&&(r.lines=!!e.lines),e.hasOwnProperty("values")&&e.values&&(r.values=e.values.map(n=>n+"")),e.hasOwnProperty("pointStyle")&&(SP(e.pointStyle)?r.pointStyle=e.pointStyle:__dcg_shared_module_exports__.qe.warn("Invalid pointStyle: '"+e.pointStyle+"'.")),e.hasOwnProperty("pointSize")&&(r.pointSize=""+e.pointSize),e.hasOwnProperty("pointOpacity")&&(r.pointOpacity=""+e.pointOpacity),e.hasOwnProperty("lineStyle")&&(EP(e.lineStyle)?r.lineStyle=e.lineStyle:__dcg_shared_module_exports__.qe.warn("Invalid lineStyle: '"+e.lineStyle+"'.")),e.hasOwnProperty("lineWidth")&&(r.lineWidth=""+e.lineWidth),e.hasOwnProperty("lineOpacity")&&(r.lineOpacity=""+e.lineOpacity),e.hasOwnProperty("columnMode")&&(__dcg_shared_module_exports__.qe.warn("As of API v1.1 the 'columnMode' property is deprecated and has been split into individual 'points' and 'lines' properties."),e.columnMode===Sv.POINTS_AND_LINES?(r.points=!0,r.lines=!0):e.columnMode===Sv.LINES?(r.points=!1,r.lines=!0):(r.points=!0,r.lines=!1),r.lines&&!r.points&&e.hasOwnProperty("dragMode")&&e.dragMode!=="NONE"&&(__dcg_shared_module_exports__.qe.warn("A 'lines' value of true and 'points' value of false is only compatible with a dragMode of 'NONE'. Proceeding by setting 'points' to true."),r.points=!0),Ioe(e.columnMode)&&__dcg_shared_module_exports__.qe.warn("Invalid columnMode: '"+e.columnMode+"'.")),e.hasOwnProperty("dragMode")&&(oK(e.dragMode)?r.dragMode=e.dragMode==="AUTO"?"NONE":e.dragMode:__dcg_shared_module_exports__.qe.warn("Invalid dragMode: '"+e.dragMode+"'.")),r}function Noe(e,t){let r={type:"table",id:jg(e,t)};return e.hasOwnProperty("columns")&&e.columns&&(r.columns=e.columns.map(n=>Foe(n,t))),r}function Boe(e,t){let r={type:"folder",id:jg(e,t)};return e.hasOwnProperty("hidden")&&(r.hidden=!!e.hidden),r}function rK(e,t){let r={type:"text",id:jg(e,t)};return e.hasOwnProperty("text")&&(r.text=e.text),e.hasOwnProperty("secret")&&(r.secret=!!e.secret),e.hasOwnProperty("readonly")&&(r.readonly=!!e.readonly),r}function Uoe(e,t){let r={type:"image",id:jg(e,t)};return e.hasOwnProperty("hidden")&&(r.hidden=!!e.hidden),r}function uD(e,t,r){let n=e.type;if(t&&n&&n!==t){__dcg_shared_module_exports__.qe.warn("Cannot change type of expression from '"+t+"' to '"+n+"'.");return}if(t==="text"&&n===void 0)return rK(e,r);switch(n){case void 0:case"expression":return Roe(e,r);case"image":return Uoe(e,r);case"table":return Noe(e,r);case"folder":return Boe(e,r);case"text":return rK(e,r);default:if(t){__dcg_shared_module_exports__.qe.warn("Cannot modify expressions of type: '"+t+"' through the API.");return}else{__dcg_shared_module_exports__.qe.warn("Invalid expression type: '"+n+"'.");return}}}var hD={};__dcg_shared_module_exports__.d(hD,{LARGE:()=>Hoe,MEDIUM:()=>IP,SMALL:()=>qoe,VERY_LARGE:()=>Koe,VERY_SMALL:()=>zoe});var zoe=9,qoe=12,IP=16,Hoe=20,Koe=24;Ss();var fi=__dcg_shared_module_exports__.e(ne());qt();var Sr=__dcg_shared_module_exports__.e(ne()),Yt=__dcg_shared_module_exports__.e(ne()),$l=__dcg_shared_module_exports__.e(ne());qt();var Op=class extends $l.Class{init(){this.controller=this.props.controller()}template(){return $l.createElement("div",{class:$l.const("dcg-do-not-blur"),onTap:this.bindFn(this.newImage),handleEvent:$l.const("true"),role:$l.const("button"),tabIndex:()=>this.props.readonly()?-1:0,"aria-label":this.props.ariaLabel,"aria-disabled":()=>this.props.readonly(),manageFocus:this.const(this.props.location?rt({controller:this.controller,location:this.props.location()}):void 0)},this.props.children,$l.createElement("input",{type:$l.const("file"),accept:$l.const("image/*"),style:$l.const("display: none"),didMount:this.bindFn(this.didMountFileInput)}))}didMountFileInput(e){this.fileInputNode=e,ee(e).on("change",()=>{this.props.onFileChange(e.files),e.value=""})}newImage(){this.props.readonly()||this.fileInputNode.click()}},{If:iK,Switch:nK}=Yt.Components,gD=class extends Yt.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Yt.createElement("div",{class:Yt.const("dcg-clickable-image-info-view"),role:Yt.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-clickable-image-options")},Yt.createElement("div",{class:Yt.const("dcg-clickable-image-state-container")},Yt.createElement(Le,{tooltip:()=>this.tooltip("hovered"),gravity:this.const("s")},Yt.createElement(Op,{controller:()=>this.controller,ariaLabel:()=>this.tooltip("hovered"),onFileChange:e=>this.updateImage("hovered",e),readonly:()=>this.controller.isItemReadonly(this.id)},Yt.createElement(nK,{key:this.bindFn(this.hoveredStatus)},()=>Yt.createElement("div",{class:Yt.const("dcg-clickable-image-state"),style:()=>this.getStyleForState("hovered")})))),Yt.createElement(iK,{predicate:()=>!!this.model.clickableInfo.hoveredImage},()=>Yt.createElement("div",{class:Yt.const("dcg-clickable-image-state-close"),onTap:()=>this.removeImageState("hovered"),ariaLabel:()=>this.controller.s("graphing-calculator-label-remove-hovered-image"),role:Yt.const("button"),tabIndex:Yt.const(0)},Yt.createElement("i",{class:Yt.const("dcg-icon-remove"),"aria-hidden":Yt.const("true")}))),Yt.createElement("div",{role:Yt.const("heading"),"aria-level":Yt.const("2"),class:Yt.const("dcg-clickable-image-label")},()=>this.controller.s("graphing-calculator-label-hovered"))),Yt.createElement("div",{class:Yt.const("dcg-clickable-image-state-container")},Yt.createElement(Le,{tooltip:()=>this.tooltip("depressed"),gravity:this.const("s")},Yt.createElement(Op,{controller:()=>this.controller,ariaLabel:()=>this.tooltip("depressed"),onFileChange:e=>this.updateImage("depressed",e),readonly:()=>this.controller.isItemReadonly(this.id)},Yt.createElement(nK,{key:this.bindFn(this.depressedStatus)},()=>Yt.createElement("div",{class:Yt.const("dcg-clickable-image-state"),style:()=>this.getStyleForState("depressed")})))),Yt.createElement(iK,{predicate:()=>!!this.model.clickableInfo.depressedImage},()=>Yt.createElement("div",{class:Yt.const("dcg-clickable-image-state-close"),onTap:()=>this.removeImageState("depressed"),ariaLabel:()=>this.controller.s("graphing-calculator-label-remove-depressed-image"),role:Yt.const("button"),tabIndex:Yt.const(0)},Yt.createElement("i",{class:Yt.const("dcg-icon-remove"),"aria-hidden":Yt.const("true")}))),Yt.createElement("div",{role:Yt.const("heading"),"aria-level":Yt.const("2"),class:Yt.const("dcg-clickable-image-label")},()=>this.controller.s("graphing-calculator-label-depressed"))))}hoveredStatus(){return this.hoveredUploading?"loading":"background"}depressedStatus(){return this.depressedUploading?"loading":"background"}tooltip(e){return(e==="hovered"?this.model.clickableInfo.hoveredImage:this.model.clickableInfo.depressedImage)?e==="depressed"?this.controller.s("graphing-calculator-label-change-depressed-image-tooltip"):this.controller.s("graphing-calculator-label-change-hovered-image-tooltip"):e==="depressed"?this.controller.s("graphing-calculator-label-add-depressed-image-tooltip"):this.controller.s("graphing-calculator-label-add-hovered-image-tooltip")}getImageURLForState(e){let t;if(e==="hovered"){if(this.hoveredStatus()!=="background")return"";t="hoveredImage"}else{if(this.depressedStatus()!=="background")return"";t="depressedImage"}let r=this.model.clickableInfo[t];return r?`url(${r})`:`url(${this.model.image_url})`}getStyleForState(e){let t={"background-image":this.getImageURLForState(e),opacity:"1"};return e==="hovered"&&!this.model.clickableInfo.hoveredImage&&(t.opacity="0.5"),t}removeImageState(e){e==="hovered"?this.controller.dispatch({type:"set-hovered-image",id:this.model.id,url:""}):this.controller.dispatch({type:"set-depressed-image",id:this.model.id,url:""})}updateImage(e,t){if(!t||!t[0])return;let r=t[0];e==="hovered"&&(this.hoveredUploading=!0),e==="depressed"&&(this.depressedUploading=!0),this.controller.getGraphSettings().config.imageUploadCallback(r,(n,i)=>{e==="hovered"&&(this.hoveredUploading=!1),e==="depressed"&&(this.depressedUploading=!1),!n&&i&&(e==="hovered"?this.controller.dispatch({type:"set-hovered-image",id:this.model.id,url:i}):this.controller.dispatch({type:"set-depressed-image",id:this.model.id,url:i}))})}},Tc=__dcg_shared_module_exports__.e(ne()),go=class extends Tc.Class{template(){return Tc.createElement("div",{class:()=>({"dcg-toggle-view":!0,"dcg-toggled":this.props.toggled()}),"aria-label":()=>this.props.ariaLabel(),role:Tc.const("checkbox"),tabIndex:Tc.const("0"),"aria-checked":()=>this.props.toggled(),toggled:()=>this.props.toggled(),onTap:this.bindFn(this.props.onChange)},Tc.createElement("div",{class:Tc.const("dcg-toggle-track")},Tc.createElement("div",{class:Tc.const("dcg-toggle-switch")})))}},ls=__dcg_shared_module_exports__.e(ne()),mD=__dcg_shared_module_exports__.e(fK()),MP=/\{\$([a-zA-Z0-9\-]+([a-zA-Z0-9\-]+_)*[a-zA-Z0-9\-]+)\}/;function bK(e,t){let r=0,n=0,i={},o={},a=s(e);if(!/^<0>/.test(a)||!/<\/0>$/.test(a))throw new Error("Expected template string to start and end with <0> and </0>, but found "+JSON.stringify(a));return a.slice(3,-4).trim();function s(c){if(t.isConst(c))return t.getConstValue(c);if(t.isNamedBinding(c)){let d=l(i,t.getBindingName(c)),u=`{$${d}}`;if(!MP.test(u))throw new Error(`Invalid <Localize> variable: ${u}.`);return t.addBinding&&t.addBinding(d,c),i[d]=!0,u}else if(c!==e&&t.isView(c)){let d=l(o,t.getViewName(c));if(!/[a-zA-Z0-9\-_]/.test(d))throw new Error(`Invalid <Localize> subview identifier: ${d}.`);return t.addView&&t.addView(d,c),o[d]=!0,`<${d}/>`}else if(t.isBinding(c)){let d=l(i,`v${r++}`),u=`{$${d}}`;return t.addBinding&&t.addBinding(d,c),i[d]=!0,u}else{let d=`${n++}`;t.addElement&&t.addElement(d,c);let u=[];return t.forEachChild(c,p=>{u.push(s(p))}),o[d]=!0,u.length>0?`<${d}>${u.join("")}</${d}>`:`<${d}/>`}}function l(c,d){let u=0,p=d;for(;c[p];)p=`${d}-${++u}`;return p}}function Zoe(e){return e}function eie(e){return e.__DCGViewLocalizeBindingName}function tie(e){return typeof e=="function"&&e.__DCGViewLocalizeViewName}var Oi=class extends ls.Class{init(){this.viewMap={},this.elementMap={},this.bindingMap={},this.i18n=this.props.i18n(),this.templateString=this.serializeToTemplateString(ls.createElement("div",{style:ls.const("display: contents;")},this.props.children))}template(){return ls.createElement(ls.Components.If,{predicate:()=>this.shouldShow()},()=>ls.createElement(ls.Components.Switch,{key:()=>GP(this.translatedString())},e=>this.renderDeserializedTemplateNode(this.parseAndValidate(e))))}shouldShow(){let e=this.props.options&&this.props.options();return e&&e.hideUntranslatedView&&this.i18n.hasTranslation?this.i18n.hasTranslation(this.props.key()):!0}translatedString(){let e={};for(let t in this.bindingMap)e[t]=Gs(`{$${t}}`);return this.i18n.s(this.props.key(),e)}static variable(e,t){let r=()=>t();return r.__DCGViewLocalizeBindingName=e,r}static subview(e,t){let r=()=>t();return r.__DCGViewLocalizeViewName=e,r}parseAndValidate(e){let t=(0,mD.parse)(e),r={},n={};i(t);for(let o in this.elementMap)if(!n[o])return(0,mD.parse)(GP(this.templateString));for(let o in this.bindingMap)if(!r[o])return(0,mD.parse)(GP(this.templateString));return t;function i(o){if(Array.isArray(o)){for(let a of o)i(a);return}o.name==="token"?r[o.attrs.id]=!0:o.type!=="text"&&(n[o.name]=!0,i(o.children))}}renderDeserializedTemplateNode(e){if(Array.isArray(e))return e.map(t=>this.renderDeserializedTemplateNode(t));if(e.type==="text")return ls.const(e.content||"");if(e.name==="token")return this.bindingMap[e.attrs.id]||(()=>"");if(this.elementMap[e.name]){let t=this.elementMap[e.name],r=e.children.map(n=>this.renderDeserializedTemplateNode(n));return xK(t.type,t.attributes,r)}else return this.viewMap[e.name]?this.viewMap[e.name]():xK("span",{},[])}serializeToTemplateString(e){return bK(e,{isView:tie,isConst:yK,isBinding:t=>typeof t=="function",isNamedBinding:eie,getConstValue:t=>t(),getBindingName:t=>t.__DCGViewLocalizeBindingName,getViewName:t=>t.__DCGViewLocalizeViewName,addBinding:(t,r)=>{this.bindingMap[t]=r},addElement:(t,r)=>{this.elementMap[t]={type:r.tagName,attributes:r.attributes}},addView:(t,r)=>{if(this.viewMap[t])throw new Error(`Unexpected duplicate view ${t}.`);this.viewMap[t]=r},forEachChild:(t,r)=>{for(let n of t.children){if(!yK(n)&&typeof n!="function"&&n instanceof ls.View)throw new Error("Bare DCGViews are not allowed inside <Localize>. Use Localize.subview().");r(n)}}})}};function yK(e){return typeof e=="function"&&e.isDCGViewConst}function xK(e,t,r){return ls.createElement(e,t,r)}function GP(e){return`<0>${e}</0>`.replace(new RegExp(MP.source,"g"),(t,r)=>`<token id="${r}"/>`)}function ki(e,t,r){return rie(e,t)===r}function rie(e,t){let r=e.getFocusLocation();if(!(!r||r.type!=="expression-menu"||r.id!==t))return r.location}function _i(e,t,r,n){let i=t;r?e.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:i,location:n}}):e.dispatch({type:"blur-focus-location",location:{type:"expression-menu",id:i,location:n}})}var{If:fD,IfDefined:oie,Textarea:iie}=Sr.Components,Zb=class extends Sr.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Sr.createElement("div",{class:Sr.const("dcg-options-menu-section dcg-clickable-section")},Sr.createElement("div",{class:Sr.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-clickable"),Sr.createElement(go,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-make-clickable"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleClickable)})),Sr.createElement(fD,{predicate:this.props.isOpen},()=>Sr.createElement("div",{class:Sr.const("dcg-options-menu-content")},Sr.createElement("div",{class:Sr.const("dcg-clickable-menu-row")},Sr.createElement("span",{class:Sr.const("dcg-input-label")},()=>this.controller.s("graphing-calculator-label-update-on-click")),Sr.createElement(Mo,R({latex:()=>this.model.clickableInfo.latex,operatorNames:()=>this.getMQConfig().autoOperatorNames,ariaLabel:()=>this.controller.s("graphing-calculator-narration-click-action"),brailleShouldFocus:()=>ki(this.controller,this.model.id,"updaterule"),onBrailleInput:e=>this.dispatchUpdateRuleLatexIfChanged(e),onBrailleFocusedChanged:e=>_i(this.controller,this.model.id,e,"updaterule")},ui(this.controller)),Sr.createElement(Fe,{latex:()=>this.model.clickableInfo.latex,placeholder:this.const(""),isFocused:()=>ki(this.controller,this.model.id,"updaterule"),capExpressionSize:()=>!!this.controller.getGraphSettings().config.capExpressionSize,tokenController:this.props.controller,selectOnFocus:this.const(!0),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.controller.s("graphing-calculator-narration-click-action"),getAriaPostLabel:this.const(""),hasError:()=>this.hasError(),onUserChangedLatex:e=>this.dispatchUpdateRuleLatexIfChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:e=>_i(this.controller,this.model.id,e,"updaterule"),dataLabelAttributeValue:this.const("click-handler"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()})),oie(()=>this.packedError(),e=>Sr.createElement("span",{class:Sr.const("dcg-clickable-info-error-container")},Sr.createElement(Di,{error:()=>this.controller.unpack(e()),size:this.const("small")})))),Sr.createElement(fD,{predicate:this.bindFn(this.isList)},()=>Sr.createElement("div",{class:Sr.const("dcg-clickable-list-index-notice")},Sr.createElement(Oi,{i18n:this.const(this.controller),key:this.const("graphing-calculator-label-list-index")},Sr.const("Use"),Sr.const(" "),Sr.createElement("span",{class:()=>({"dcg-index-variable-marker":!0,"dcg-btn":!0,"dcg-btn-light-gray":!0,"dcg-mathquill-has-focus":ki(this.controller,this.model.id,"updaterule"),"dcg-do-not-blur":!0}),onTap:this.bindFn(this.insertIndex)},Sr.const("index")),Sr.const(" "),Sr.const("to reference the clicked index in the list.")))),Sr.createElement(fD,{predicate:()=>this.model.type!=="image"},()=>Sr.createElement(iie,{placeholder:()=>this.controller.s("graphing-calculator-text-add-screen-reader-label-placeholder"),value:()=>this.model.description,onInput:e=>this.controller.dispatch({type:"set-item-description",id:this.model.id,description:e})})),Sr.createElement(fD,{predicate:()=>this.model.type==="image"},()=>Sr.createElement("div",{class:Sr.const("dcg-clickable-menu-row")},Sr.createElement(gD,{controller:()=>this.controller,model:()=>this.model}))))))}insertIndex(){this.controller.dispatch({type:"keypad/type-text",text:"index"})}isList(){return this.model.formula?!!this.model.formula.is_concrete_list:!1}hasError(){return this.packedError()!==void 0}packedError(){if(this.model.formula.click_handler&&this.model.formula.click_handler.status==="error")return this.model.formula.click_handler.error}toggleClickable(){this.controller.dispatch({type:"set-clickableinfo-prop",id:this.model.id,prop:"enabled",value:!this.model.clickableInfo.enabled}),this.model.clickableInfo.enabled&&_i(this.controller,this.model.id,!0,"updaterule")}dispatchUpdateRuleLatexIfChanged(e){this.model.clickableInfo.latex!==e&&this.controller.dispatch({type:"set-clickableinfo-rule-latex",id:this.model.id,latex:e})}getMQConfig(){return this.controller.getMathquillConfig({additionalOperators:["index"]})}},Rp=__dcg_shared_module_exports__.e(ne()),Er=__dcg_shared_module_exports__.e(ne()),{For:wK,If:bD}=Er.Components,ey=class extends Er.Class{init(){this.controller=this.props.controller()}template(){return Er.createElement("div",{class:Er.const("dcg-color-picker-container"),role:Er.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-color-picker-label"),onKeyDown:this.bindFn(this.handleKeydown)},Er.createElement("div",{class:Er.const("dcg-color-picker-menu dcg-do-not-blur"),role:Er.const("listbox"),"aria-label":()=>this.controller.s("graphing-calculator-narration-color-picker-standard-colors-label")},Er.createElement(wK,{each:()=>this.getColorValues()},e=>Er.createElement("div",{class:Er.const("dcg-color-tile"),handleEvent:Er.const("true"),role:Er.const("option"),"aria-label":()=>md(this.controller,e),tabIndex:()=>this.isSelected(e)||this.isFirstAndNoneSelected(e)?0:-1,"aria-selected":()=>this.isSelected(e),manageFocus:()=>rt({controller:this.controller,location:{type:"color-picker-option",category:"standard",color:e}}),onTap:()=>this.props.onColorSelected(e)},Er.createElement(Pp,{color:()=>({type:"single-color",value:e}),invertSwatches:()=>this.controller.invertSwatches()}),Er.createElement(bD,{predicate:()=>this.isSelected(e)},()=>Er.createElement("i",{class:Er.const("dcg-icon-check"),"aria-hidden":Er.const("true")}))))),Er.createElement(bD,{predicate:()=>this.getUniqueCustomColors().length>0},()=>Er.createElement("div",{class:Er.const("dcg-color-picker-menu dcg-do-not-blur"),role:Er.const("listbox"),"aria-label":()=>this.controller.s("graphing-calculator-narration-color-picker-custom-colors-label")},Er.createElement(wK,{each:this.bindFn(this.getUniqueCustomColors),key:e=>e.assignmentLatex},e=>Er.createElement(Kb,{tooltip:()=>e.assignmentLatex},Er.createElement("div",{class:Er.const("dcg-color-tile"),handleEvent:Er.const("true"),role:Er.const("option"),"aria-label":()=>{let t=this.getColorValue(e);return t.type==="single-color"?md(this.controller,t.value):Ao(e.assignmentLatex)},tabIndex:()=>this.props.colorLatex()===e.assignmentLatex?0:-1,"aria-selected":()=>this.props.colorLatex()===e.assignmentLatex,manageFocus:()=>rt({controller:this.controller,location:{type:"color-picker-option",category:"custom",color:e.assignmentLatex}}),onTap:()=>this.props.onCustomColorSelected(e.assignmentLatex)},Er.createElement(Pp,{color:()=>this.getColorValue(e),invertSwatches:()=>this.controller.invertSwatches()}),Er.createElement(bD,{predicate:()=>this.props.colorLatex()===e.assignmentLatex},()=>Er.createElement("i",{class:()=>this.getCheckmarkClass(e),"aria-hidden":Er.const("true")})),Er.createElement(bD,{predicate:()=>{var t,r;return((r=(t=this.props).customColorVisibility)==null?void 0:r.call(t))==="suppressed"}},()=>Er.createElement("i",{class:Er.const("dcg-icon-lock")}))))))))}hideColorFunctions(){var e,t,r;return(r=(t=(e=this.props).hideColorFunctions)==null?void 0:t.call(e))!=null?r:!1}isFirstAndNoneSelected(e){return e===this.getColorValues()[0]&&!this.props.selectedColor()}isSelected(e){let t=this.props.colorLatex();return t&&__dcg_shared_module_exports__.m(this.getUniqueCustomColors(),"assignmentLatex").indexOf(t)>=0?!1:this.props.selectedColor()===e}getColorValues(){return __dcg_shared_module_exports__.C(this.controller.getColors())}getUniqueCustomColors(){if(this.props.customColorVisibility&&this.props.customColorVisibility()==="hidden")return[];let e=[];e.push(...this.controller.getAllColorAssignments()),this.hideColorFunctions()||e.push(...this.controller.getAllColorFunctionAssignments());let t=__dcg_shared_module_exports__.r(e,r=>r.assignmentLatex);return e.filter(r=>t[r.assignmentLatex]===1)}getColorValue(e){switch(e.id){case"shader":return{type:e.id};default:let t=this.controller.getColorById(e.id);return Array.isArray(t)?{type:"color-array",value:t}:/^data:image/.test(t)?{type:"image",value:t}:{type:"single-color",value:t}}}getCheckmarkClass(e){return qf(this.getColorValue(e),!1)?`dcg-icon-check ${_z(this.getColorValue(e),!1)?"dcg-light-color":"dcg-mixed-color"}`:"dcg-icon-check"}handleKeydown(e){let t=this.controller.getFocusLocation();if((t==null?void 0:t.type)!=="color-picker-option"||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;let r=ke(e);if(r!=="Up"&&r!=="Down"&&r!=="Left"&&r!=="Right"&&r!=="Home"&&r!=="End")return;e.preventDefault(),e.stopPropagation();let n=this.getColorValues(),i=this.getUniqueCustomColors().map(c=>c.assignmentLatex),o=n.length,a=t.category==="standard"?n.indexOf(t.color):o+i.indexOf(t.color),s=a,l=n.length+i.length-1;r==="Left"&&(s=a-1),r==="Right"&&(s=a+1),r==="Home"&&(s=0),r==="End"&&(s=1/0),r==="Up"&&a-o>=0&&(s=a-o),r==="Down"&&a+o<=l&&(s=a+o),s=__dcg_shared_module_exports__.Sb(s,0,l),s!==a&&(s<o?(this.props.onColorSelected(n[s]),this.controller.dispatch({type:"set-focus-location",location:{type:"color-picker-option",category:"standard",color:n[s]}})):(this.props.onCustomColorSelected(i[s-o]),this.controller.dispatch({type:"set-focus-location",location:{type:"color-picker-option",category:"custom",color:i[s-o]}})))}},ih=class extends Rp.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Rp.createElement("div",{class:Rp.const("dcg-options-menu-section")},Rp.createElement("div",{class:Rp.const("dcg-options-menu-content")},Rp.createElement(ey,{controller:this.props.controller,colorLatex:this.bindFn(this.getColorLatex),selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),hideColorFunctions:this.bindFn(this.hideColorFunctions),customColorVisibility:this.bindFn(this.customColorVisibility)})))}hideColorFunctions(){return this.model.type!=="expression"?!1:Cb(this.model)||$u(this.model)}customColorVisibility(){return this.model.type==="expression"&&sT(this.model)||this.model.type==="table"?"hidden":"visible"}onColorSelected(e){this.model.type!=="image"&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-color",id:this.model.id,color:e}):this.model.type==="table"?this.controller.dispatch({type:"set-tableregression-color",color:e,tableId:this.model.id}):this.controller.dispatch({type:"set-tablecolumn-color",color:e,tableId:this.model.table.id,columnId:this.model.id}))}onCustomColorSelected(e){this.model.type!=="image"&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-colorlatex",id:this.model.id,colorLatex:e}):this.model.type==="table-column"&&this.controller.dispatch({type:"set-tablecolumn-colorlatex",tableId:this.model.table.id,columnId:this.model.id,colorLatex:e}))}getColorLatex(){var e,t;return this.model.type==="image"?"":this.model.type==="table"?(t=(e=this.model.regression)==null?void 0:e.color)!=null?t:"":this.model.colorLatex}getModelColor(){var e,t;return this.model.type==="image"?"":this.model.type==="table"?(t=(e=this.model.regression)==null?void 0:e.color)!=null?t:"":Fu(this.model)}},Yi=__dcg_shared_module_exports__.e(ne()),{If:nie,For:aie}=Yi.Components,ty=class extends Yi.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Yi.createElement("div",{class:Yi.const("dcg-options-menu-section")},Yi.createElement("div",{class:Yi.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-drag"),Yi.createElement(go,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-menu-drag-enabled"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleDragEnabled)})),Yi.createElement(nie,{predicate:this.props.isOpen},()=>Yi.createElement("div",{class:Yi.const("dcg-options-menu-content")},Yi.createElement("div",{class:Yi.const("dcg-style-icons"),role:Yi.const("radiogroup")},Yi.createElement(aie,{each:()=>["X","Y","XY"]},e=>Yi.createElement("div",{class:()=>({"dcg-style-icon-container":!0,"dcg-disabled":this.isDisabled(e)}),onTap:()=>this.onDragModeSelected(e),role:Yi.const("radio"),tabIndex:()=>this.isDisabled(e)?-1:0,"aria-label":()=>e==="X"?this.controller.s("graphing-calculator-narration-drag-mode-x"):e==="Y"?this.controller.s("graphing-calculator-narration-drag-mode-y"):e==="XY"?this.controller.s("graphing-calculator-narration-drag-mode-xy"):this.controller.raw(""),"aria-checked":()=>this.getDragMode()===e},Yi.createElement($o,{backgroundColor:()=>({type:"single-color",value:"#000"}),semiTransparent:()=>this.getDragMode()!==e,iconType:()=>e==="X"?"movable-horizontal":e==="Y"?"movable-vertical":"movable-both"})))))))}isDisabled(e){let t=this.controller.getEnabledDragModesForItem(this.model.id);return!__dcg_shared_module_exports__.l(t,e)}onDragModeSelected(e){if(this.model.type==="expression"){if(this.isDisabled(e))return;this.controller.dispatch({type:"set-item-dragmode",id:this.model.id,dragMode:e})}else{let t=this.model.id,r=this.model.table.id;this.controller.dispatch({type:"set-tablecolumn-dragmode",tableId:r,columnId:t,dragMode:e})}}getDragMode(){return this.model.type==="expression"?Ro(this.model)||this.model.dragMode:this.model.dragMode}toggleDragEnabled(){let e=this.getDragMode()!=="NONE"?"NONE":"XY";this.model.type==="expression"?this.controller.dispatch({type:"set-item-dragmode",id:this.model.id,dragMode:e}):this.onDragModeSelected(e)}},Ri=__dcg_shared_module_exports__.e(ne()),{If:vK}=Ri.Components,yD=class extends Ri.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Ri.createElement("div",{class:Ri.const("dcg-options-menu-section")},Ri.createElement("div",{class:Ri.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-fill"),Ri.createElement(vK,{predicate:()=>!this.isInequality()},()=>Ri.createElement(go,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-fill-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleFillVisible)}))),Ri.createElement(vK,{predicate:this.props.isOpen},()=>Ri.createElement("div",{class:Ri.const("dcg-options-menu-content")},Ri.createElement("div",{class:Ri.const("dcg-iconed-mathquill-row dcg-fill-opacity-row")},Ri.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip")},Ri.createElement("i",{class:Ri.const("dcg-icon-opacity"),"aria-hidden":Ri.const("true")})),Ri.createElement(lr,{latex:()=>this.model.fillOpacity,placeholder:this.bindFn(this.getFillOpacity),isFocused:()=>ki(this.controller,this.model.id,"opacity"),ariaPostLabel:()=>ML(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-fill-opacity"),hasError:()=>!ML(this.model),handleLatexChanged:this.bindFn(this.dispatchOpacityLatexIfChanged),dataLabelAttributeValue:this.const("fill-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>_i(this.controller,this.model.id,e,"opacity")})))))}getFillOpacity(){return""+.4}isInequality(){return wd(this.model)}toggleFillVisible(){this.controller.dispatch({type:"set-item-fill",id:this.model.id,fill:!this.props.isOpen()})}dispatchOpacityLatexIfChanged(e){this.model.fillOpacity!==e&&this.controller.dispatch({type:"set-item-fillopacity",id:this.model.id,fillOpacity:e})}},jl=__dcg_shared_module_exports__.e(ne()),{If:lie}=jl.Components,nh=class extends jl.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return jl.createElement(lie,{predicate:()=>this.isVisible()},()=>jl.createElement("div",{class:jl.const("dcg-options-menu-section dcg-interactivity-section dcg-section-without-title")},jl.createElement("div",{class:jl.const("dcg-options-menu-content")},jl.createElement(mt,{checked:()=>Ds(this.model),onChange:()=>this.toggleGraphInteractionsDisabled(),ariaLabel:()=>this.controller.s("graphing-calculator-label-disable-graph-interactions")},()=>this.controller.s("graphing-calculator-label-disable-graph-interactions")))))}isVisible(){return this.controller.shouldShowAuthorFeatures()}toggleGraphInteractionsDisabled(){this.model.type==="table-column"?this.controller.dispatch({type:"set-tablecolumn-disable-graph-interactions",tableId:this.model.table.id,columnId:this.model.id,disableGraphInteractions:!Ds(this.model)}):this.controller.dispatch({type:"set-item-disable-graph-interactions",id:this.model.id,disableGraphInteractions:!Ds(this.model)})}},Jt=__dcg_shared_module_exports__.e(ne()),Qn=__dcg_shared_module_exports__.e(ne()),{For:cie}=Qn.Components,die=[{orientation:"default",cssClass:"dcg-label-orientation-center",description:"graphing-calculator-text-label-orientation-default"},{orientation:"above",cssClass:"dcg-label-orientation-above",description:"graphing-calculator-text-label-orientation-above"},{orientation:"above_right",cssClass:"dcg-label-orientation-above-right",description:"graphing-calculator-text-label-orientation-above-right"},{orientation:"right",cssClass:"dcg-label-orientation-right",description:"graphing-calculator-text-label-orientation-right"},{orientation:"below_right",cssClass:"dcg-label-orientation-below-right",description:"graphing-calculator-text-label-orientation-below-right"},{orientation:"below",cssClass:"dcg-label-orientation-below",description:"graphing-calculator-text-label-orientation-below"},{orientation:"below_left",cssClass:"dcg-label-orientation-below-left",description:"graphing-calculator-text-label-orientation-below-left"},{orientation:"left",cssClass:"dcg-label-orientation-left",description:"graphing-calculator-text-label-orientation-left"},{orientation:"above_left",cssClass:"dcg-label-orientation-above-left",description:"graphing-calculator-text-label-orientation-above-left"}],xD=class extends Qn.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Qn.createElement("div",{class:Qn.const("dcg-label-orientation-view"),style:()=>`transform: rotate(${this.getCSSRotationValue()});`},Qn.createElement("span",{class:Qn.const("dcg-vertical-orientation-indicator")}),Qn.createElement("div",{class:Qn.const("dcg-label-orientations"),role:Qn.const("radiogroup"),"aria-label":()=>this.controller.s("graphing-calculator-heading-label-orientation")},Qn.createElement(cie,{each:()=>die,key:e=>e.orientation},e=>Qn.createElement("div",{class:()=>({[e.cssClass]:!0,"dcg-orientation-option":!0,"dcg-selected":this.isSelected(e.orientation),"dcg-orientation-disabled":this.isDisabled(e.orientation)}),role:Qn.const("radio"),tabIndex:Qn.const("0"),"aria-label":()=>this.controller.s(e.description),"aria-checked":()=>this.getOrientation()===e.orientation,onTap:()=>this.onTapOrientation(e.orientation)},Qn.createElement("i",{class:()=>({"dcg-icon-chevron-left":e.orientation!=="default"})})))))}isDisabled(e){return e!=="default"?!1:this.isPointVisible()?!0:this.model.labelOrientation==="default"}isSelected(e){return e==="default"&&e===this.model.labelOrientation?!this.isPointVisible():e===this.model.labelOrientation}isPointVisible(){return this.model.hidden?!1:Ea(this.model)?!this.model.hidden:this.model.points}getCSSRotationValue(){let e=vH(this.model);return`${Array.isArray(e)?0:e}rad`}getOrientation(){return this.props.model().labelOrientation}onTapOrientation(e){e===this.getOrientation()&&(e="default"),this.controller.dispatch({type:"set-item-label-orientation",id:this.id,labelOrientation:e})}},Dc=__dcg_shared_module_exports__.e(ne()),ry=class extends Dc.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Dc.createElement("div",{class:Dc.const("dcg-iconed-mathquill-row dcg-point-opacity-row")},Dc.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip")},Dc.createElement("i",{class:Dc.const("dcg-icon-opacity"),"aria-hidden":Dc.const("true")})),Dc.createElement(lr,{latex:()=>this.model.pointOpacity,placeholder:this.bindFn(this.getPointOpacityPlaceholder),isFocused:()=>ki(this.controller,this.model.id,"pointopacity"),ariaPostLabel:()=>this.isPointOpacityValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-line-opacity"),hasError:()=>!this.isPointOpacityValid(),handleLatexChanged:this.bindFn(this.dispatchPointOpacityLatexIfChanged),dataLabelAttributeValue:this.const("point-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>_i(this.controller,this.model.id,e,"pointopacity")}))}isPointOpacityValid(){return this.model.type==="expression"?yH(this.model):this.model.type==="table-column"?ZU(this.model):!1}dispatchPointOpacityLatexIfChanged(e){this.model.pointOpacity!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointopacity",id:this.model.id,pointOpacity:e}):this.controller.dispatch({type:"set-tablecolumn-pointopacity",columnId:this.model.id,tableId:this.model.table.id,pointOpacity:e}))}getPointOpacityPlaceholder(){return"1"}},{If:Tv}=Jt.Components,wD=class extends Jt.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Jt.createElement("div",{class:Jt.const("dcg-options-menu-section")},Jt.createElement("div",{class:Jt.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-label"),Jt.createElement(go,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-label-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleLabelVisible)})),Jt.createElement(Tv,{predicate:this.props.isOpen},()=>Jt.createElement("div",{class:Jt.const("dcg-options-menu-content")},Jt.createElement("div",{class:Jt.const("dcg-options-flex-container")},Jt.createElement("div",{class:Jt.const("dcg-options-left-side")},Jt.createElement(Tv,{predicate:this.props.showPointOpacity},()=>Jt.createElement(ry,R({},this.props))),Jt.createElement("div",{class:Jt.const("dcg-iconed-mathquill-row dcg-label-size-row")},Jt.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-label-size-tooltip")},Jt.createElement("span",{class:Jt.const("dcg-font-size")},Jt.const("A"))),Jt.createElement(lr,{latex:()=>this.model.labelSize,placeholder:()=>"1",isFocused:()=>ki(this.controller,this.model.id,"labelsize"),ariaPostLabel:()=>LL(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-label-size"),hasError:()=>!LL(this.model),handleLatexChanged:this.bindFn(this.dispatchLabelSizeIfChanged),dataLabelAttributeValue:this.const("label-size"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>_i(this.controller,this.model.id,e,"labelsize")})),Jt.createElement("div",{class:()=>({"dcg-iconed-mathquill-row":!0,"dcg-label-angle-row":!0,"dcg-suffix-degree":this.props.controller().getGraphSettings().degreeMode,"dcg-suffix-radian":!this.props.controller().getGraphSettings().degreeMode})},Jt.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-angle-tooltip")},Jt.createElement("i",{class:Jt.const("dcg-icon-angle"),"aria-hidden":Jt.const("true")})),Jt.createElement(lr,{latex:()=>this.model.labelAngle,placeholder:()=>"0",isFocused:()=>ki(this.controller,this.model.id,"labelangle"),ariaPostLabel:()=>PL(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-label-angle"),hasError:()=>!PL(this.model),handleLatexChanged:this.bindFn(this.dispatchLabelAngleIfChanged),dataLabelAttributeValue:this.const("label-angle"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>_i(this.controller,this.model.id,e,"labelangle")}))),Jt.createElement("div",{class:Jt.const("dcg-options-right-side")},Jt.createElement(xD,{controller:()=>this.controller,model:()=>this.model}))),Jt.createElement(Tv,{predicate:()=>this.controller.canUseAdvancedStyling()},()=>Jt.createElement("div",{class:Jt.const("dcg-label-advanced")},Jt.createElement(mt,{checked:this.bindFn(this.getWhiteTextOutline),onChange:this.bindFn(this.setWhiteTextOutline),disabled:()=>this.getEditable()},()=>this.controller.s("graphing-calculator-button-label-text-outline")),Jt.createElement("div",{role:Jt.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-advanced")},Jt.createElement(Tv,{predicate:()=>this.shouldShowHoverLabelCheckbox()},()=>Jt.createElement(mt,{checked:this.bindFn(this.getInteractiveLabel),onChange:this.bindFn(this.setInteractiveLabel)},()=>this.controller.s("graphing-calculator-button-label-show-on-hover"))),Jt.createElement(Tv,{predicate:this.bindFn(this.shouldShowEditableLabelToggle)},()=>Jt.createElement(mt,{checked:this.bindFn(this.getEditable),onChange:this.bindFn(this.setEditable)},()=>this.controller.s("graphing-calculator-button-label-editable")))))))))}getWhiteTextOutline(){return this.getEditable()?!1:!this.model.suppressTextOutline}setWhiteTextOutline(e){this.controller.dispatch({type:"set-suppress-text-outline",id:this.model.id,suppressTextOutline:!e})}setInteractiveLabel(e){this.controller.dispatch({type:"set-item-interactive-label",id:this.model.id,interactiveLabel:e})}getInteractiveLabel(){return!!this.model.interactiveLabel}setEditable(e){if(e){let t=__dcg_shared_module_exports__.ie(this.model.label)==="latex"?"MATH":"TEXT";this.controller.dispatch({type:"set-item-editable-label-mode",id:this.model.id,editableLabelMode:t})}else this.controller.dispatch({type:"set-item-editable-label-mode",id:this.model.id,editableLabelMode:"NONE"})}getEditable(){return this.model.editableLabelMode!=="NONE"}shouldShowEditableLabelToggle(){return Ea(this.model)}shouldShowHoverLabelCheckbox(){return Ro(this.model)==="NONE"}dispatchLabelAngleIfChanged(e){this.model.labelAngle!==e&&this.controller.dispatch({type:"set-item-labelangle",id:this.model.id,labelAngle:e})}dispatchLabelSizeIfChanged(e){this.model.labelSize!==e&&this.controller.dispatch({type:"set-item-labelSize",id:this.model.id,labelSize:e})}toggleLabelVisible(){this.controller.dispatch({type:"set-item-showlabel",id:this.model.id,showLabel:!this.props.isOpen()})}},zr=__dcg_shared_module_exports__.e(ne()),{If:CK}=zr.Components,oy=class extends zr.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return zr.createElement("div",{class:zr.const("dcg-options-menu-section")},zr.createElement("div",{class:zr.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-lines"),zr.createElement(go,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-lines-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleLinesVisible)})),zr.createElement(CK,{predicate:()=>this.props.isOpen()},()=>zr.createElement("div",{class:zr.const("dcg-options-menu-content")},zr.createElement("div",{class:zr.const("dcg-options-flex-container")},zr.createElement("div",{class:zr.const("dcg-options-left-side")},zr.createElement("div",{class:zr.const("dcg-iconed-mathquill-row dcg-line-opacity-row")},zr.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip")},zr.createElement("i",{class:zr.const("dcg-icon-opacity"),"aria-hidden":zr.const("true")})),zr.createElement(lr,{latex:()=>this.model.lineOpacity,placeholder:this.bindFn(this.getLineOpacity),isFocused:()=>ki(this.controller,this.model.id,"lineopacity"),ariaPostLabel:()=>this.isLineOpacityValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-line-opacity"),hasError:()=>!this.isLineOpacityValid(),handleLatexChanged:this.bindFn(this.dispatchLineOpacityLatexIfChanged),dataLabelAttributeValue:this.const("line-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>_i(this.controller,this.model.id,e,"lineopacity")})),zr.createElement("div",{class:zr.const("dcg-iconed-mathquill-row dcg-line-thickness-row")},zr.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-line-thickness-tooltip")},zr.createElement("i",{class:zr.const("dcg-icon-line-thickness"),"aria-hidden":zr.const("true")})),zr.createElement(lr,{latex:()=>this.model.lineWidth,placeholder:this.bindFn(this.getLineWidth),isFocused:()=>ki(this.controller,this.model.id,"linewidth"),ariaPostLabel:()=>this.isLineWidthValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-line-thickness-tooltip"),hasError:()=>!this.isLineWidthValid(),handleLatexChanged:this.bindFn(this.dispatchLineWidthLatexIfChanged),dataLabelAttributeValue:this.const("line-width"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>_i(this.controller,this.model.id,e,"linewidth")}))),zr.createElement("div",{class:zr.const("dcg-options-right-side")},zr.createElement(CK,{predicate:this.bindFn(this.shouldShowLineStyles)},()=>zr.createElement(vo,{staticConfig:this.bindFn(this.getPointStyleOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-heading-style"),theme:this.const("mini")})))))))}getLineWidth(){return""+2.5}getLineOpacity(){return"1"}getPointStyleOptions(){return["SOLID","DASHED","DOTTED"].map(e=>({key:e,icon:()=>this.getStyleIcon(e),ariaLabel:()=>this.getStyleAria(e),selected:()=>this.model.lineStyle===e,class:()=>"dcg-line-segmented-option",onSelect:()=>{this.onLineStyleSelected(e)}}))}getStyleIcon(e){switch(e){case"SOLID":return"dcg-icon-line-solid";case"DASHED":return"dcg-icon-line-dashed";case"DOTTED":return"dcg-icon-line-dotted"}}getStyleAria(e){let t=this.controller.s;switch(e){case"SOLID":return t("graphing-calculator-narration-line-style-solid");case"DASHED":return t("graphing-calculator-narration-line-style-dashed");case"DOTTED":return t("graphing-calculator-narration-line-style-dotted")}}isLineOpacityValid(){return this.model.type==="expression"?bH(this.model):this.model.type==="table-column"?XU(this.model):!1}isLineWidthValid(){return this.model.type==="expression"?yT(this.model):this.model.type==="table-column"?JU(this.model):!1}dispatchLineOpacityLatexIfChanged(e){this.model.lineOpacity!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-lineopacity",id:this.model.id,lineOpacity:e}):this.controller.dispatch({type:"set-tablecolumn-lineopacity",tableId:this.model.table.id,columnId:this.model.id,lineOpacity:e}))}shouldShowLineStyles(){return!(this.model.type==="expression"&&wd(this.model))}onLineStyleSelected(e){this.model.lineStyle!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-linestyle",id:this.model.id,lineStyle:e}):this.controller.dispatch({type:"set-tablecolumn-linestyle",tableId:this.model.table.id,columnId:this.model.id,lineStyle:e}))}dispatchLineWidthLatexIfChanged(e){this.model.lineWidth!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-linewidth",id:this.model.id,lineWidth:e}):this.controller.dispatch({type:"set-tablecolumn-linewidth",tableId:this.model.table.id,columnId:this.model.id,lineWidth:e}))}toggleLinesVisible(){this.model.type==="expression"?this.controller.dispatch({type:"set-item-lines",id:this.model.id,lines:!this.props.isOpen()}):this.controller.dispatch({type:"set-tablecolumn-lines",tableId:this.model.table.id,columnId:this.model.id,bool:!this.props.isOpen()})}},Xi=__dcg_shared_module_exports__.e(ne()),{If:uie}=Xi.Components,CD=class extends Xi.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Xi.createElement("div",{class:Xi.const("dcg-options-menu-section")},Xi.createElement("div",{class:Xi.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-lines"),Xi.createElement(go,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-lines-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleLinesVisible)})),Xi.createElement(uie,{predicate:()=>this.props.isOpen()},()=>Xi.createElement("div",{class:Xi.const("dcg-options-menu-content")},Xi.createElement("div",{class:Xi.const("dcg-iconed-mathquill-row dcg-line-thickness-row-3d")},Xi.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-line-thickness-3d-tooltip")},Xi.createElement("i",{class:Xi.const("dcg-icon-line-thickness"),"aria-hidden":Xi.const("true")})),Xi.createElement(lr,{latex:()=>this.model.lineWidth,placeholder:()=>"1",isFocused:()=>ki(this.controller,this.model.id,"linewidth"),ariaPostLabel:()=>this.isLineWidthValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-line-thickness-3d-tooltip"),hasError:()=>!this.isLineWidthValid(),handleLatexChanged:this.bindFn(this.dispatchLineWidthLatexIfChanged),dataLabelAttributeValue:this.const("line-width"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>_i(this.controller,this.model.id,e,"linewidth")})))))}toggleLinesVisible(){this.controller.dispatch({type:"set-item-lines",id:this.model.id,lines:!this.props.isOpen()})}isLineWidthValid(){return this.model.type==="expression"?yT(this.model):!1}dispatchLineWidthLatexIfChanged(e){this.model.lineWidth!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-linewidth",id:this.model.id,lineWidth:e})}},mo=__dcg_shared_module_exports__.e(ne()),{If:PP}=mo.Components,iy=class extends mo.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return mo.createElement("div",{class:mo.const("dcg-options-menu-section")},mo.createElement("div",{class:mo.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-points"),mo.createElement(go,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-points-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.togglePointsVisible)})),mo.createElement(PP,{predicate:this.props.isOpen},()=>mo.createElement("div",{class:mo.const("dcg-options-menu-content")},mo.createElement("div",{class:mo.const("dcg-options-flex-container")},mo.createElement("div",{class:mo.const("dcg-options-left-side")},mo.createElement(ry,R({},this.props)),mo.createElement(PP,{predicate:()=>this.model.type==="expression"||!this.isDraggable()},()=>mo.createElement("div",{class:mo.const("dcg-iconed-mathquill-row dcg-point-size-row")},mo.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-point-size-tooltip")},mo.createElement("i",{class:mo.const("dcg-icon-line-thickness"),"aria-hidden":mo.const("true")})),mo.createElement(lr,{latex:this.bindFn(this.getPointSize),placeholder:this.bindFn(this.getDefaultPointSize),isFocused:()=>ki(this.controller,this.model.id,"pointsize"),ariaPostLabel:()=>this.isPointSizeValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-point-size"),hasError:()=>!this.isPointSizeValid(),handleLatexChanged:e=>this.dispatchPointSizeLatexIfChanged(e),dataLabelAttributeValue:this.const("point-size"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>_i(this.controller,this.model.id,e,"pointsize")})))),mo.createElement("div",{class:mo.const("dcg-options-right-side")},mo.createElement(PP,{predicate:()=>!this.isDraggable()},()=>mo.createElement(vo,{staticConfig:this.bindFn(this.getPointStyleOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-heading-style"),theme:this.const("mini")})))))))}getPointSize(){return this.isDraggable()&&this.model.type==="expression"?this.model.movablePointSize:this.model.pointSize}getPointStyleOptions(){return["POINT","OPEN","CROSS"].map(e=>({key:e,icon:()=>this.getStyleIcon(e),ariaLabel:()=>this.getStyleAria(e),selected:()=>this.model.pointStyle===e,class:()=>"dcg-point-segmented-option",onSelect:()=>{this.onPointStyleSelected(e)}}))}getStyleIcon(e){switch(e){case"POINT":return"dcg-icon-point";case"OPEN":return"dcg-icon-open";case"CROSS":return"dcg-icon-cross"}}getStyleAria(e){let t=this.controller.s;switch(e){case"POINT":return t("graphing-calculator-narration-point-style-point");case"OPEN":return t("graphing-calculator-narration-point-style-open");case"CROSS":return t("graphing-calculator-narration-point-style-cross")}}isPointSizeValid(){return this.model.type==="expression"?this.isDraggable()?xH(this.model):bT(this.model):this.model.type==="table-column"?QU(this.model):!1}onPointStyleSelected(e){this.model.pointStyle!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointstyle",id:this.model.id,pointStyle:e}):this.controller.dispatch({type:"set-tablecolumn-pointstyle",columnId:this.model.id,tableId:this.model.table.id,pointStyle:e}))}dispatchPointSizeLatexIfChanged(e){this.getPointSize()!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointsize",id:this.model.id,pointSize:e}):this.controller.dispatch({type:"set-tablecolumn-pointsize",columnId:this.model.id,tableId:this.model.table.id,pointSize:e}))}isDraggable(){return this.getDragMode()!=="NONE"}togglePointsVisible(){this.model.type==="expression"&&Ea(this.model)?this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id}):this.model.type==="expression"?this.controller.dispatch({type:"set-item-points",id:this.model.id,points:!this.props.isOpen()}):this.controller.dispatch({type:"set-tablecolumn-points",columnId:this.model.id,tableId:this.model.table.id,bool:!this.props.isOpen()})}getDragMode(){return this.model.type==="expression"?Ro(this.model)||this.model.dragMode:this.model.dragMode}getDefaultPointSize(){return this.model.type==="expression"&&kp(this.model)?"14":"8"}},Ji=__dcg_shared_module_exports__.e(ne()),{If:mie}=Ji.Components,SD=class extends Ji.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Ji.createElement("div",{class:Ji.const("dcg-options-menu-section")},Ji.createElement("div",{class:Ji.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-points"),Ji.createElement(go,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-points-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.togglePointsVisible)})),Ji.createElement(mie,{predicate:()=>this.props.isOpen()},()=>Ji.createElement("div",{class:Ji.const("dcg-options-menu-content")},Ji.createElement("div",{class:Ji.const("dcg-iconed-mathquill-row dcg-line-thickness-row-3d")},Ji.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-point-size-3d-tooltip")},Ji.createElement("i",{class:Ji.const("dcg-icon-line-thickness"),"aria-hidden":Ji.const("true")})),Ji.createElement(lr,{latex:()=>this.model.pointSize,placeholder:this.bindFn(this.getDefaultPointSize),isFocused:()=>ki(this.controller,this.model.id,"pointsize"),ariaPostLabel:()=>this.isPointSizeValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-point-size"),hasError:()=>!this.isPointSizeValid(),handleLatexChanged:e=>this.dispatchPointSizeLatexIfChanged(e),dataLabelAttributeValue:this.const("point-size"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>_i(this.controller,this.model.id,e,"pointsize")})))))}togglePointsVisible(){this.controller.dispatch({type:"set-item-points",id:this.model.id,points:!this.props.isOpen()})}isPointSizeValid(){return this.model.type==="expression"?bT(this.model):!1}dispatchPointSizeLatexIfChanged(e){this.model.pointSize!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-pointsize",id:this.model.id,pointSize:e})}getDefaultPointSize(){return"3"}},jo=__dcg_shared_module_exports__.e(ne()),{If:VP}=jo.Components,ED=class extends jo.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return jo.createElement("div",{class:jo.const("dcg-options-menu-section")},jo.createElement("div",{class:jo.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-surfaces"),jo.createElement(go,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-surfaces-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleSurfacesVisible)})),jo.createElement(VP,{predicate:()=>this.props.isOpen()},()=>jo.createElement("div",{style:jo.const("font-size:85%; margin-top:8px")},jo.createElement(VP,{predicate:()=>this.usesResolution()&&this.controller.getGraphSettings().config.beta3d},()=>jo.createElement("div",null,jo.const("Resolution:"),jo.createElement(lr,{latex:()=>this.model.resolution,placeholder:()=>this.getDefaultResolution(),isFocused:()=>ki(this.controller,this.model.id,"resolution"),ariaPostLabel:()=>this.isResolutionValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-resolution-tooltip"),hasError:()=>!this.isResolutionValid(),handleLatexChanged:this.bindFn(this.dispatchResolutionLatexIfChanged),dataLabelAttributeValue:this.const("resolution"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>_i(this.controller,this.model.id,e,"resolution")}))),jo.createElement(VP,{predicate:this.bindFn(this.shouldShowOpacity)},()=>jo.createElement("div",{class:jo.const("dcg-iconed-mathquill-row dcg-surface-opacity-row")},jo.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip"),sticky:this.const(!0),gravity:this.const("s")},jo.createElement("i",{class:jo.const("dcg-icon-opacity"),"aria-hidden":jo.const("true")})),jo.createElement(lr,{latex:()=>this.model.surfaceOpacity,isFocused:()=>ki(this.controller,this.model.id,"opacity"),placeholder:this.const("1"),ariaPostLabel:()=>GL(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-surface-opacity"),hasError:()=>!GL(this.model),handleLatexChanged:this.bindFn(this.dispatchOpacityLatexIfChanged),dataLabelAttributeValue:this.const("surface-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>_i(this.controller,this.model.id,e,"opacity")}))))))}shouldShowOpacity(){return this.controller.getGraphSettings().config.beta3d?this.model.formula.is_inequality!==!0:!1}toggleSurfacesVisible(){this.controller.dispatch({type:"set-item-lines",id:this.model.id,lines:!this.props.isOpen()})}usesResolution(){return!lT(this.model)&&!lH(this.model)}dispatchResolutionLatexIfChanged(e){this.model.resolution!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-resolution",id:this.model.id,resolution:e})}isResolutionValid(){return this.model.type==="expression"?wH(this.model):!1}getDefaultResolution(){return this.model.type==="expression"&&cH(this.model)?`${__dcg_shared_module_exports__.kd}`:`${__dcg_shared_module_exports__.ld}`}dispatchOpacityLatexIfChanged(e){this.model.surfaceOpacity!==e&&this.controller.dispatch({type:"set-item-surfaceopacity",id:this.model.id,surfaceOpacity:e})}},{For:fie,If:bie}=fi.Components;function Vs(e,t){t.runAfterDispatch(()=>{if(!e)return;let r=e.closest(".dcg-options-menu-container"),n=t.findEl(".dcg-container"),i=t.getOpenMenuIcon(),o=!!e.closest(".dcg-table-column-menu");if(!r||!n||!i)return;let a=t.computeMajorLayout(),s=a.list.top+a.list.height,l=a.keypad.top,c=Math.min(s,l),d=n.getBoundingClientRect(),u=i.getBoundingClientRect(),p=c+d.top-u.top,g=r.offsetHeight,f=0;g>p&&(f=+p-g);let y=o?!f:-f<g-38;r.style.marginTop=`${o&&f<0?f-34:f}px`,e.style.marginTop=`${-f}px`,e.style.display=y?"":"none"})}function Fp(e,t){requestAnimationFrame(()=>{let r=t.getExppanelElt(),n=t.getOpenMenuIcon();e&&r&&n&&r.contains(n)&&ee(r).on(`scroll.${e}`,()=>{ee(r).off(`scroll.${e}`);let i=t.getFocusLocation(),o=t.getOpenItemMenu();i&&o&&i.type==="expression-menu"&&"model"in o&&i.id===o.model.id&&t.dispatch({type:"blur-focus-location",location:i}),t.dispatch({type:"close-item-settings-menu"})})})}function Np(e,t){let r=t.getExppanelElt();r&&e&&ee(r).off(`scroll.${e}`)}var ny=class extends fi.Class{init(){var e;this.controller=this.props.controller(),this.guid=(e=this.controller.getOpenItemMenu())==null?void 0:e.guid}didMount(){Fp(this.guid,this.controller)}willUnmount(){Np(this.guid,this.controller)}didUpdate(){Vs(this.arrowElt,this.controller)}template(){let e=this.props.model();return fi.createElement("div",{class:()=>({"dcg-expressions-options-menu":!0,"dcg-options-menu":!0}),role:fi.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu")},fi.createElement("div",null,fi.createElement(fie,{each:this.bindFn(this.getSectionsWithColorAfterFirstOpen)},t=>{switch(t){case"points":return fi.createElement(iy,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("points")});case"label":return fi.createElement(wD,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("label"),showPointOpacity:()=>this.isFirstOpenSection("label")});case"drag":return fi.createElement(ty,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("drag")});case"lines":return fi.createElement(oy,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("lines")});case"fill":return fi.createElement(yD,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("fill")});case"colors":return fi.createElement(ih,{model:()=>e,controller:this.bindFn(this.props.controller)});case"points3d":return fi.createElement(SD,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("points3d")});case"lines3d":return fi.createElement(CD,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("lines3d")});case"surfaces":return fi.createElement(ED,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("surfaces")})}})),fi.createElement(bie,{predicate:this.bindFn(this.shouldShowClickableSection)},()=>fi.createElement(Zb,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>!!e.clickableInfo.enabled})),fi.createElement(nh,{model:()=>e,controller:()=>this.props.controller()}),fi.createElement("div",{class:fi.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow),didUnmount:()=>this.arrowElt=void 0}))}didMountArrow(e){this.arrowElt=e,Vs(this.arrowElt,this.controller)}shouldShowClickableSection(){let e=this.props.model();return this.controller.areActionsEnabled()&&OL(e)&&!this.controller.isItemReadonly(e.id)&&(this.controller.shouldShowAuthorFeatures()||!Ds(e))}shouldShowDragSection(){let e=this.props.model();return this.controller.shouldShowAuthorFeatures()||!Ds(e)}getSectionsWithColorAfterFirstOpen(){let e=this.getSections(),t=[],r=!1;for(let n of e)t.push(n),n==="colors"&&(r=!0),!r&&this.canColorComeAfterSection(n)&&this.isSectionOpen(n)&&(t.push("colors"),r=!0);return t}getSections(){let e=this.props.model();if(this.controller.isThreeDMode()){if(cT(e))return e.extendTo3D?["surfaces"]:["lines3d"];if(TL(e))return["surfaces"];if(Gg(e)||EL(e)||hH(e)||kL(e)||_L(e))return["lines3d"];if(Ea(e)||Cb(e))return["points3d"];if(Lg(e)||$u(e))return["points3d","lines3d"]}return Pg(e)||ju(e)||sT(e)||uH(e)||zu(e)?["colors"]:_p(e)?["lines"]:kp(e)?["points"]:Lg(e)?["points","label","lines"]:Ea(e)?e.formula.move_strategy&&this.shouldShowDragSection()?["points","label","drag"]:["points","label"]:Gg(e)||pb(e)?["lines","fill"]:wd(e)?Sb(e)||dT(e)||DL(e)?["lines"]:["lines","fill"]:["lines"]}canColorComeAfterSection(e){switch(e){case"colors":case"drag":return!1;case"fill":case"label":case"lines":case"lines3d":case"points":case"points3d":case"surfaces":return!0;default:return e}}isFirstOpenSection(e){return this.getSections().find(t=>this.isSectionOpen(t))===e}isSectionOpen(e){let t=this.props.model(),{points:r,lines:n,fill:i}=t,o=__dcg_shared_module_exports__.Zc(t.formula.expression_type,{points:r,lines:n,fill:i},a=>{});switch(e){case"lines":return t.hidden?!1:o.lines;case"label":return ja(t);case"fill":return t.hidden?!1:wd(t)?!0:o.fill;case"points":return t.hidden?!1:Ea(t)?!t.hidden:o.points;case"drag":return Ro(t)!=="NONE";case"colors":return!0;case"points3d":return t.hidden?!1:o.points;case"lines3d":case"surfaces":return t.hidden?!1:o.lines}}},OP={showGrid:!0,showXAxis:!0,showYAxis:!0,xAxisStep:0,yAxisStep:0,xAxisScale:"linear",yAxisScale:"linear",xAxisMinorSubdivisions:0,yAxisMinorSubdivisions:0,xAxisArrowMode:"NONE",yAxisArrowMode:"NONE",xAxisLabel:"",yAxisLabel:"",xAxisNumbers:!0,yAxisNumbers:!0,polarMode:!1,polarNumbers:!0,degreeMode:!1,randomSeed:"",restrictGridToFirstQuadrant:!1,userLockedViewport:!1,complex:!1},EK={threeDMode:!1,worldRotation3D:[],axis3D:[0,0,1],speed3D:0,showPlane3D:!0,showNumbers3D:!0,plane3dOpacity:"",backgroundColor3d:"#FFF",showAxis3D:!0,showAxisLabels3D:!0,showBox3D:!0},yie={squareAxes:!0},xie=ie(R(R({},EK),yie),{product:"graphing",includeFunctionParametersInRandomSeed:!0,hideCustomColors:!1});function TK(e){return e in EK}var Os=R(R({},OP),xie),DK=Object.keys(OP);function kK(e){return e in OP}var ay=e=>isFinite(e)&&(e>0||e===0),TD=class{constructor(e){this.mq=e,this.id=e.id,this.data=e.data}simulateUserChangedLatex(){Fe.simulateUserChangedLatex(this.mq)}simulateKeypress(e){Fe.simulateKeypressFromKeypad(this.mq,e)}config(e){return this.mq.config(e),this}latex(e){return e===void 0?this.mq.latex():(this.mq.latex(e),this.simulateUserChangedLatex(),this)}reflow(){this.mq.reflow()}el(){return this.mq.el()}getAriaLabel(){return this.mq.getAriaLabel()}setAriaLabel(e){return this.mq.setAriaLabel(e)}html(){return this.mq.html()}mathspeak(){return this.mq.mathspeak()}text(){return this.mq.text()}selection(){return this.mq.selection()}select(){return this.mq.select(),this}moveToRightEnd(){return this.mq.moveToRightEnd(),this}moveToLeftEnd(){return this.mq.moveToLeftEnd(),this}cmd(e){return this.mq.cmd(e),this.simulateUserChangedLatex(),this}write(e){return this.mq.write(e),this.simulateUserChangedLatex(),this}keystroke(e){return this.simulateKeypress(e),this}typedText(e){return this.mq.typedText(e),this.simulateUserChangedLatex(),this}clearSelection(){return this.mq.clearSelection(),this}getAriaPostLabel(){return this.mq.getAriaPostLabel()}setAriaPostLabel(e,t){return this.mq.setAriaPostLabel(e,t),this}blur(){return this.mq.blur(),this}focus(){return this.mq.focus(),this}revert(){return this.mq.revert()}ignoreNextMousedown(e){return this.mq.ignoreNextMousedown(e),this}clickAt(e,t,r){return this.mq.clickAt(e,t,r),this}};function _K(e){let t=e.mode,r=e.width,n=e.height,i=e.currentBounds,o=e.graphpaperAspectRatio,a=e.mathAspectRatio,s=e.mathBounds,l=r/n,c={x:i.left+i.width/2,y:i.bottom+i.height/2};if(s.left===void 0!=(s.right===void 0)||s.bottom===void 0!=(s.top===void 0))return __dcg_shared_module_exports__.qe.warn('asyncScreenshot: cannot specify "left" bound without "right" or "bottom" bound without "top". Got: '+s),i;let d=s.left!==void 0&&s.right!==void 0,u=s.bottom!==void 0&&s.top!==void 0,p=d&&u,g,f,y,E,_,w,v,T,M,C;switch(t){case"stretch":return p?s:d?{left:s.left,right:s.right,bottom:i.bottom,top:i.top}:u?{left:i.left,right:i.right,bottom:s.bottom,top:s.top}:i;case"contain":return p?(E=s.right-s.left,_=s.top-s.bottom,w={x:s.left+E/2,y:s.bottom+_/2},y=E/_,l>y?(f=_/n,g=f*a,{left:w.x-g*r/2,right:w.x+g*r/2,bottom:s.bottom,top:s.top}):(g=E/r,f=g/a,{left:s.left,right:s.right,bottom:w.y-f*n/2,top:w.y+f*n/2})):d?(v=s.right-s.left,T=s.left+v/2,y=v/i.height,l>y?(f=i.height/n,g=f*a,{left:T-g*r/2,right:T+g*r/2,bottom:i.bottom,top:i.top}):(g=v/r,f=g/a,{left:s.left,right:s.right,bottom:c.y-f*n/2,top:c.y+f*n/2})):u?(M=s.top-s.bottom,C=s.bottom+M/2,y=i.width/M,l>y?(f=M/n,g=f*a,{left:c.x-g*r/2,right:c.x+g*r/2,bottom:s.bottom,top:s.top}):(g=i.width/r,f=g/a,{left:i.left,right:i.right,bottom:C-f*n/2,top:C+f*n/2})):l>o?(f=i.height/n,g=f*a,{left:c.x-g*r/2,right:c.x+g*r/2,bottom:i.bottom,top:i.top}):(g=i.width/r,f=g/a,{left:i.left,right:i.right,bottom:c.y-f*n/2,top:c.y+f*n/2});case"preserveX":return p?(E=s.right-s.left,_=s.top-s.bottom,w={x:s.left+E/2,y:s.bottom+_/2},y=E/_,g=E/r,f=g/a,{left:s.left,right:s.right,bottom:w.y-f*n/2,top:w.y+f*n/2}):u?(M=s.top-s.bottom,C=s.bottom+M/2,y=i.width/M,g=i.width/r,f=g/a,{left:i.left,right:i.right,bottom:C-f*n/2,top:C+f*n/2}):d?(v=s.right-s.left,g=v/r,f=g/a,{left:s.left,right:s.right,bottom:c.y-f*n/2,top:c.y+f*n/2}):(v=i.right-i.left,g=v/r,f=g/a,{left:i.left,right:i.right,bottom:c.y-f*n/2,top:c.y+f*n/2});case"preserveY":return p?(E=s.right-s.left,_=s.top-s.bottom,w={x:s.left+E/2,y:s.bottom+_/2},y=E/_,f=_/n,g=f*a,{left:w.x-g*r/2,right:w.x+g*r/2,bottom:s.bottom,top:s.top}):d?(v=s.right-s.left,T=s.left+v/2,y=v/i.height,f=i.height/n,g=f*a,{left:T-g*r/2,right:T+g*r/2,bottom:i.bottom,top:i.top}):u?(M=s.top-s.bottom,f=M/n,g=f*a,{left:c.x-g*r/2,right:c.x+g*r/2,bottom:s.bottom,top:s.top}):(M=i.top-i.bottom,f=M/n,g=f*a,{left:c.x-g*r/2,right:c.x+g*r/2,bottom:i.bottom,top:i.top});default:return i}}function Ld(e){return e==="es-ES"?(__dcg_shared_module_exports__.qe.warn("{language: 'es-ES'} has been deprecated. Proceeding with {language: 'es'}"),"es"):e}var RP={keypad:!0,graphpaper:!0,expressions:!0,settingsMenu:!0,zoomButtons:!0,showResetButtonOnGraphpaper:!1,expressionsTopbar:!0,capExpressionSize:!1,pointsOfInterest:!0,trace:!0,border:!0,lockViewport:!1,expressionsCollapsed:!1,authorFeatures:!1,authorMode:!0,advancedStyling:!1,images:!0,imageUploadCallback:cD,folders:!0,notes:!0,sliders:!0,links:!0,qwertyKeyboard:!0,restrictedFunctions:!1,forceEnableGeometryFunctions:!1,pasteGraphLink:!1,pasteTableData:!0,degreeMode:!1,clearIntoDegreeMode:!1,autosize:!0,plotSingleVariableImplicitEquations:!0,plotImplicits:!0,plotInequalities:!0,colors:{RED:pE,BLUE:uE,GREEN:hE,ORANGE:mE,PURPLE:gE,BLACK:zf},invertedColors:!1,functionDefinition:!0,projectorMode:!1,decimalToFraction:!0,fontSize:16,language:"en",backgroundColor:"#fff",textColor:"#000",distributions:!0,brailleMode:"none",sixKeyInput:!1,brailleControls:!0,graphDescription:void 0,zoomFit:!0,forceLogModeRegressions:!1,defaultLogModeRegressions:!1,actions:"auto",audio:!0,logScales:!0,translucentSurfaces:!1,perspectiveDistortion:1,showKeyboardShortcutsInTooltips:!1,tone:!0,muted:!0,showPerformanceMeter:!1,allowComplex:!0,customRegressions:!0},IK=Object.keys(RP),wie={orientationButtons:!0,debug3dRender:void 0,debugPeelLayers:void 0,adaptivePeeling:!0,debugPixelRatio:void 0,translucentOpacity:"0.8",peelFloatTexture:!1,debugScale:1/10,peelUpsample:void 0},AK=R({product:"graphing",showHamburger:!1,disableScrollFix:!1,branding:!0,onlyTraceSelected:!1,disableMouseInteractions:!1,nativeOnscreenKeypad:!1,plaidMode:!1,wireframe:!1,pasteGraphLinkCallback:void 0,editOnWeb:!1,crossOriginSaveTest:!1,enableTabindex:!0,audioTraceReverseExpressions:!1,audioTraceSimult:!1,transparentBackground:!1,pauseWhenOffscreen:!1,hideGeoUI:!1,substitutions:!0,intervalComprehensions:!0,recursion:!0,beta3d:!1,disableLighting:!1,disableWorkerOnZoom:!1,cacheRenderedSvgs:!1,ghostMode:!1,tableRegressions:!0,reflectionArc:!1,logInternalErrors:!1,debugProgressUpdates:!1,recursionDepthLimit:void 0},wie),vie={solutions:!0,menus:!0,singleVariableSolutions:!0,clickableObjects:!1,administerSecretFolders:!1},sy=R(R({},RP),AK);function FP(e){return!!(RP.hasOwnProperty(e)||AK.hasOwnProperty(e)||vie.hasOwnProperty(e))}function DD(e){let t=__dcg_shared_module_exports__.Jc(sy);for(let r in e)t.hasOwnProperty(r)&&(t[r]=e[r]);return __dcg_shared_module_exports__.Jd(t.backgroundColor)||(t.backgroundColor=sy.backgroundColor,__dcg_shared_module_exports__.qe.warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)")),__dcg_shared_module_exports__.Jd(t.textColor)||(t.textColor=sy.textColor,__dcg_shared_module_exports__.qe.warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)")),t.actions!==!0&&t.actions!==!1&&t.actions!=="auto"&&(t.actions=sy.actions,__dcg_shared_module_exports__.qe.warn("Invalid actions setting. Must be true, false, or 'auto'.")),e.zoomButtons===void 0&&(!t.graphpaper||t.lockViewport)&&(t.zoomButtons=!1),e.images===void 0&&(t.graphpaper||(t.images=!1)),e.hasOwnProperty("menus")&&(__dcg_shared_module_exports__.qe.warn("As of API version 0.4, the 'menus' option is deprecated and has been split into 'settingsMenu' (boolean) and 'expressionsTopbar' (boolean)."),e.hasOwnProperty("settingsMenu")||(t.settingsMenu=!!e.menus),e.hasOwnProperty("expressionsTopbar")||(t.expressionsTopbar=!!e.menus)),e.hasOwnProperty("solutions")&&(__dcg_shared_module_exports__.qe.warn("As of API v1.0, the 'solutions' option is deprecated and has been replaced with 'pointsOfInterest' (boolean)."),e.hasOwnProperty("pointsOfInterest")||(t.pointsOfInterest=!!e.solutions)),e.hasOwnProperty("singleVariableSolutions")&&__dcg_shared_module_exports__.qe.warn("As of API v1.0, the 'singleVariableSolutions' has been removed. The calculator no longer displays solutions to single variable equations."),e.hasOwnProperty("clickableObjects")&&(__dcg_shared_module_exports__.qe.warn("As of API v1.7, the 'clickableObjects' option is deprecated and has been replaced with 'actions'."),e.clickableObjects===!0&&!e.hasOwnProperty("actions")&&(t.actions=!0)),e.hasOwnProperty("administerSecretFolders")&&(__dcg_shared_module_exports__.qe.warn("As of API v1.8, the 'administerSecretFolders' option is deprecated and has been subsumed under 'authorFeatures'."),e.administerSecretFolders===!0&&!e.hasOwnProperty("authorFeatures")&&(t.authorFeatures=!0)),t.graphpaper||(t.expressionsCollapsed&&(t.expressionsCollapsed=!1,__dcg_shared_module_exports__.qe.warn("Desmos API initialized with bad options. graphpaper: false and expressionsCollapsed: true are incompatible. Proceeding with expressionsCollapsed: false.")),t.zoomButtons&&(t.zoomButtons=!1,__dcg_shared_module_exports__.qe.warn("Desmos API initialized with bad options. graphpaper: false and zoomButtons: true are incompatible. Proceeding with zoomButtons: false.")),t.showResetButtonOnGraphpaper&&(t.showResetButtonOnGraphpaper=!1,__dcg_shared_module_exports__.qe.warn("Desmos API initialized with bad options. graphpaper: false and showResetButtonOnGraphpaper: true are incompatible. Proceeding with showResetButtonOnGraphpaper: false."))),t.lockViewport&&t.zoomButtons&&(t.zoomButtons=!1,__dcg_shared_module_exports__.qe.warn("Desmos API initialized with bad options. lockViewport: true and zoomButtons: true are incompatible. Proceeding with zoomButtons: false.")),(t.notes===!1||t.folders===!1||t.images===!1)&&t.pasteGraphLink===!0&&(t.pasteGraphLink=!1,__dcg_shared_module_exports__.qe.warn("Desmos API initialized with bad options. pasteGraphLink: true is incompatible with disabling the creation of note, folder, or image expressions. Proceeding with pasteGraphLink: false.")),t.language&&(t.language=Ld(t.language)),t}function Cie(e){FS?setTimeout(e,25):requestAnimationFrame(e)}var MK=1,ly={},Dv=!1;function LK(){Dv=!0,Cie(Sie)}var GK={};function Sie(){GK.rafSPY&&GK.rafSPY(),Dv=!1;for(let e in ly)ly[e].detectAndEnqueueEvent(),Dv=!0;if(Dv){LK();for(let e in ly)ly[e].dispatchQueuedEvent()}}var Yg=class{constructor(e,t){this.elt=e,this.cb=t,this.destroyed=!1,this.lastOffscreen=!1,this.id=MK.toString(),this.appliedScale={x:1,y:1},MK++}stopWatching(){delete ly[this.id]}startWatching(){this.checkForChanges(),ly[this.id]=this,Dv||LK()}resetAppliedScalingAndGetBoundingClientRect(){let e=this.elt.getBoundingClientRect(),t={x:e.width/this.elt.offsetWidth,y:e.height/this.elt.offsetHeight};if(t.x===this.appliedScale.x&&t.y===this.appliedScale.y)return e;let r=this.elt.querySelector(".dcg-dom-change-wrapper");return r&&(this.appliedScale=t,Wn(r,{transform:"scale("+1/this.appliedScale.x+","+1/this.appliedScale.y+")",width:100*this.appliedScale.x+"%",height:100*this.appliedScale.y+"%",transformOrigin:"0 0"})),e}detectAndEnqueueEvent(){if(this.destroyed)return;let e=!0;if(!(document.body&&document.body.contains(this.elt)))this.lastSize&&(this.lastSize=void 0,this.queuedEvent={type:"removed",target:this.elt,isOffscreen:!0});else{let t=this.resetAppliedScalingAndGetBoundingClientRect();e=t.top>window.innerHeight||t.bottom<0||t.left>window.innerWidth||t.right<0,this.lastSize?(t.width!==this.lastSize.width||t.height!==this.lastSize.height||window.devicePixelRatio!==this.lastSize.pixelRatio)&&(this.lastSize.width=t.width,this.lastSize.height=t.height,this.lastSize.pixelRatio=window.devicePixelRatio,this.queuedEvent={type:"resized",target:this.elt,size:R({},this.lastSize),isOffscreen:e}):(this.lastSize={width:t.width,height:t.height,pixelRatio:window.devicePixelRatio},this.queuedEvent={type:"added",target:this.elt,size:R({},this.lastSize),isOffscreen:e})}e!==this.lastOffscreen&&(this.lastOffscreen=e,this.queuedEvent||(this.queuedEvent={type:"offscreen-noop",target:this.elt,isOffscreen:e}))}dispatchQueuedEvent(){let e=this.queuedEvent;e&&(this.queuedEvent=void 0,this.cb(e))}checkForChanges(){this.detectAndEnqueueEvent(),this.dispatchQueuedEvent()}destroy(){this.stopWatching();for(let e in this)this.hasOwnProperty(e)&&delete this[e];this.destroyed=!0}},Eie=0,Tie="guid_"+Math.round(Math.random()*1e6)+"_"+new Date().getTime()+"_",NP=class{constructor(e){this.__observers={},this.guid=Tie+ ++Eie,e&&this.setProperties(e)}unobserveAll(){this.__observers={}}getProperty(e){return this[e]}setProperty(e,t){let r=this[e];this.setPropertyWithoutNotifying(e,t),!__dcg_shared_module_exports__.E(r,t)&&this.notifyPropertyChange(e)}setPropertyWithoutNotifying(e,t){this[e]=t}setProperties(e){let t=[];for(let r of Object.keys(e)){let n=this[r];this.setPropertyWithoutNotifying(r,e[r]),__dcg_shared_module_exports__.E(n,e[r])||t.push(r)}t.forEach(r=>this.notifyPropertyChange(r))}notifyPropertyChange(e){wP(this.__observers,e,this)}observe(e,t){CP(this.__observers,e,t)}unobserve(e){vP(this.__observers,e)}observeAndSync(e,t){this.observe(e,t);let r=e.split(" ");for(let n=0;n<r.length;n++){let i=r[n].split(".")[0];this.hasOwnProperty(i)&&t(i,this)}}},cs=NP,sx=__dcg_shared_module_exports__.e(ne()),Hv=__dcg_shared_module_exports__.e(ne());qt();var cy,xt,kv,zP,UP;function Da(e,t){var r=Object.keys(t),n;for(n=0;n<r.length;n++)e=e.replace(new RegExp("\\{"+r[n]+"\\}","gi"),t[r[n]]);return e}function kD(e){var t,r,n;if(!e)throw new Error("cannot create a random attribute name for an undefined object");t="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",r="";do for(r="",n=0;n<12;n++)r+=t[Math.floor(Math.random()*t.length)];while(e[r]);return r}function Die(e,t){var r,n,i={},o;for(e=e.split(","),t=t||10,r=0;r<e.length;r+=2)n="&"+e[r+1]+";",o=parseInt(e[r],t),i[n]="&#"+o+";";return i["\\xa0"]="&#160;",i}function kie(e){var t={left:"start",right:"end",center:"middle",start:"start",end:"end"};return t[e]||t.start}UP=Die("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),cy={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"},lineDash:{svgAttr:"stroke-dasharray",canvas:[],svg:null,apply:"stroke"}},kv=function(e,t){this.__root=e,this.__ctx=t},kv.prototype.addColorStop=function(e,t){var r=this.__ctx.__createElement("stop"),n,i;r.setAttribute("offset",e),t.indexOf("rgba")!==-1?(n=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi,i=n.exec(t),r.setAttribute("stop-color",Da("rgb({r},{g},{b})",{r:i[1],g:i[2],b:i[3]})),r.setAttribute("stop-opacity",i[4])):r.setAttribute("stop-color",t),this.__root.appendChild(r)},zP=function(e,t){this.__root=e,this.__ctx=t},xt=function(e){var t={width:500,height:500,enableMirroring:!1},r;if(arguments.length>1?(r=t,r.width=arguments[0],r.height=arguments[1]):e?r=e:r=t,!(this instanceof xt))return new xt(r);this._randomPostfix="-"+function(){return"xxxxxxxx".replace(/x/g,function(n){return(Math.random()*16|0).toString(16)})}(),this._svgClassNames=[],this.width=r.width||t.width,this.height=r.height||t.height,this.enableMirroring=r.enableMirroring!==void 0?r.enableMirroring:t.enableMirroring,this.canvas=this,this.__document=r.document||document,r.ctx?this.__ctx=r.ctx:(this.__canvas=this.__document.createElement("canvas"),this.__ctx=this.__canvas.getContext("2d")),this.__setDefaultStyles(),this.__stack=[this.__getStyleState()],this.__groupStack=[],this.__root=this.__document.createElementNS("http://www.w3.org/2000/svg","svg"),this.__root.setAttribute("version",1.1),this.__root.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.__root.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.__root.setAttribute("width",this.width),this.__root.setAttribute("height",this.height),this.__ids={},this.__defs=this.__document.createElementNS("http://www.w3.org/2000/svg","defs"),this.__root.appendChild(this.__defs),this.__currentElement=this.__document.createElementNS("http://www.w3.org/2000/svg","g"),this.__root.appendChild(this.__currentElement)},xt.prototype.__createElement=function(e,t,r){typeof t=="undefined"&&(t={});var n=this.__document.createElementNS("http://www.w3.org/2000/svg",e),i=Object.keys(t),o,a;for(r&&(n.setAttribute("fill","none"),n.setAttribute("stroke","none")),o=0;o<i.length;o++)a=i[o],n.setAttribute(a,t[a]);var s=this._svgClassNames&&this._svgClassNames[this._svgClassNames.length-1];return s&&n.setAttribute("class",s),n},xt.prototype.__setDefaultStyles=function(){var e=Object.keys(cy),t,r;for(t=0;t<e.length;t++)r=e[t],this[r]=cy[r].canvas},xt.prototype.__applyStyleState=function(e){var t=Object.keys(e),r,n;for(r=0;r<t.length;r++)n=t[r],this[n]=e[n]},xt.prototype.__getStyleState=function(){var e,t={},r=Object.keys(cy),n;for(e=0;e<r.length;e++)n=r[e],t[n]=this[n];return t},xt.prototype.__applyStyleToCurrentElement=function(e){var t=this.__currentElement,r=this.__currentElementsToStyle;r&&(t.setAttribute(e,""),t=r.element,r.children.forEach(function(g){g.setAttribute(e,"")}));var n=Object.keys(cy),i,o,a,s,l,c;for(i=0;i<n.length;i++)if(o=cy[n[i]],a=this[n[i]],o.apply){if(a instanceof zP){if(a.__ctx)for(;a.__ctx.__defs.childNodes.length;)s=a.__ctx.__defs.childNodes[0].getAttribute("id"),this.__ids[s]=s,this.__defs.appendChild(a.__ctx.__defs.childNodes[0]);t.setAttribute(o.apply,Da("url(#{id})",{id:a.__root.getAttribute("id")}))}else if(a instanceof kv)t.setAttribute(o.apply,Da("url(#{id})",{id:a.__root.getAttribute("id")}));else if(o.apply.indexOf(e)!==-1&&o.svg!==a)if((o.svgAttr==="stroke"||o.svgAttr==="fill")&&a.indexOf("rgba")!==-1){l=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi,c=l.exec(a),t.setAttribute(o.svgAttr,Da("rgb({r},{g},{b})",{r:c[1],g:c[2],b:c[3]}));var d=c[4],u=this.globalAlpha;u!=null&&(d*=u),t.setAttribute(o.svgAttr+"-opacity",d)}else{var p=o.svgAttr;if(n[i]==="globalAlpha"&&(p=e+"-"+o.svgAttr,t.getAttribute(p)))continue;t.setAttribute(p,a)}}},xt.prototype.__closestGroupOrSvg=function(e){return e=e||this.__currentElement,e.nodeName==="g"||e.nodeName==="svg"?e:this.__closestGroupOrSvg(e.parentNode)},xt.prototype.getSerializedSvg=function(e){var t=new XMLSerializer().serializeToString(this.__root),r,n,i,o,a,s;if(s=/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi,s.test(t)&&(t=t.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')),e)for(r=Object.keys(UP),n=0;n<r.length;n++)i=r[n],o=UP[i],a=new RegExp(i,"gi"),a.test(t)&&(t=t.replace(a,o));return t},xt.prototype.getSvg=function(){return this.__root},xt.prototype._dcgStartNamedGroup=function(e){var t=this.__createElement("g");t.setAttribute("id",e+this._randomPostfix);var r=this.__closestGroupOrSvg();this.__groupStack.push(r),r.appendChild(t),this.__currentElement=t},xt.prototype._dcgEndNamedGroup=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElement||(this.__currentElement=this.__root.childNodes[1])},xt.prototype._dcgSaveClassName=function(e){this._svgClassNames.push(e),this.__currentElement&&this.__currentElement.tagName==="path"&&!this.__currentDefaultPath&&(this.__currentElement.getAttribute("class")||this.__currentElement.setAttribute("class",e))},xt.prototype._dcgRestoreClassName=function(){this._svgClassNames.pop()},xt.prototype.save=function(){var e=this.__createElement("g"),t=this.__closestGroupOrSvg();this.__groupStack.push(t),t.appendChild(e),this.__currentElement=e,this.__stack.push(this.__getStyleState())},xt.prototype.restore=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElementsToStyle=null,this.__currentElement||(this.__currentElement=this.__root.childNodes[1]);var e=this.__stack.pop();this.__applyStyleState(e)},xt.prototype.__addTransform=function(e){var t=this.__closestGroupOrSvg();if(t.childNodes.length>0){this.__currentElement.nodeName==="path"&&(this.__currentElementsToStyle||(this.__currentElementsToStyle={element:t,children:[]}),this.__currentElementsToStyle.children.push(this.__currentElement),this.__applyCurrentDefaultPath());var r=this.__createElement("g");t.appendChild(r),this.__currentElement=r}var n=this.__currentElement.getAttribute("transform");n?n+=" ":n="",n+=e,this.__currentElement.setAttribute("transform",n)},xt.prototype.scale=function(e,t){t===void 0&&(t=e),this.__addTransform(Da("scale({x},{y})",{x:e,y:t}))},xt.prototype.rotate=function(e){var t=e*180/Math.PI;this.__addTransform(Da("rotate({angle},{cx},{cy})",{angle:t,cx:0,cy:0}))},xt.prototype.translate=function(e,t){this.__addTransform(Da("translate({x},{y})",{x:e,y:t}))},xt.prototype.transform=function(e,t,r,n,i,o){this.__addTransform(Da("matrix({a},{b},{c},{d},{e},{f})",{a:e,b:t,c:r,d:n,e:i,f:o}))},xt.prototype.beginPath=function(){var e,t;this.__currentDefaultPath="",this.__currentPosition={},e=this.__createElement("path",{},!0),t=this.__closestGroupOrSvg(),t.appendChild(e),this.__currentElement=e},xt.prototype.__applyCurrentDefaultPath=function(){var e=this.__currentElement;e.nodeName==="path"?e.setAttribute("d",this.__currentDefaultPath):console.error("Attempted to apply path command to node",e.nodeName)},xt.prototype.__addPathCommand=function(e){this.__currentDefaultPath+=" ",this.__currentDefaultPath+=e},xt.prototype.moveTo=function(e,t){this.__currentElement.nodeName!=="path"&&this.beginPath(),this.__currentPosition={x:e,y:t},this.__addPathCommand(Da("M {x} {y}",{x:e,y:t}))},xt.prototype.closePath=function(){this.__currentDefaultPath&&this.__addPathCommand("Z")},xt.prototype.lineTo=function(e,t){this.__currentPosition={x:e,y:t},this.__currentDefaultPath.indexOf("M")>-1?this.__addPathCommand(Da("L {x} {y}",{x:e,y:t})):this.__addPathCommand(Da("M {x} {y}",{x:e,y:t}))},xt.prototype.bezierCurveTo=function(e,t,r,n,i,o){this.__currentPosition={x:i,y:o},this.__addPathCommand(Da("C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}",{cp1x:e,cp1y:t,cp2x:r,cp2y:n,x:i,y:o}))},xt.prototype.quadraticCurveTo=function(e,t,r,n){this.__currentPosition={x:r,y:n},this.__addPathCommand(Da("Q {cpx} {cpy} {x} {y}",{cpx:e,cpy:t,x:r,y:n}))};var BP=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]);return[e[0]/t,e[1]/t]};xt.prototype.arcTo=function(e,t,r,n,i){var o=this.__currentPosition&&this.__currentPosition.x,a=this.__currentPosition&&this.__currentPosition.y;if(!(typeof o=="undefined"||typeof a=="undefined")){if(i<0)throw new Error("IndexSizeError: The radius provided ("+i+") is negative.");if(o===e&&a===t||e===r&&t===n||i===0){this.lineTo(e,t);return}var s=BP([o-e,a-t]),l=BP([r-e,n-t]);if(s[0]*l[1]===s[1]*l[0]){this.lineTo(e,t);return}var c=s[0]*l[0]+s[1]*l[1],d=Math.acos(Math.abs(c)),u=BP([s[0]+l[0],s[1]+l[1]]),p=i/Math.sin(d/2),g=e+p*u[0],f=t+p*u[1],y=[-s[1],s[0]],E=[l[1],-l[0]],_=function(T){var M=T[0],C=T[1];return C>=0?Math.acos(M):-Math.acos(M)},w=_(y),v=_(E);this.lineTo(g+y[0]*i,f+y[1]*i),this.arc(g,f,i,w,v)}},xt.prototype.stroke=function(){this.__currentElement.nodeName==="path"&&this.__currentElement.setAttribute("paint-order","fill stroke markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("stroke")},xt.prototype.fill=function(){this.__currentElement.nodeName==="path"&&this.__currentElement.setAttribute("paint-order","stroke fill markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("fill")},xt.prototype.rect=function(e,t,r,n){this.__currentElement.nodeName!=="path"&&this.beginPath(),this.moveTo(e,t),this.lineTo(e+r,t),this.lineTo(e+r,t+n),this.lineTo(e,t+n),this.lineTo(e,t),this.closePath()},xt.prototype.fillRect=function(e,t,r,n){var i,o;i=this.__createElement("rect",{x:e,y:t,width:r,height:n},!0),o=this.__closestGroupOrSvg(),o.appendChild(i),this.__currentElement=i,this.__applyStyleToCurrentElement("fill")},xt.prototype.strokeRect=function(e,t,r,n){var i,o;i=this.__createElement("rect",{x:e,y:t,width:r,height:n},!0),o=this.__closestGroupOrSvg(),o.appendChild(i),this.__currentElement=i,this.__applyStyleToCurrentElement("stroke")},xt.prototype.__clearCanvas=function(){for(var e=this.__closestGroupOrSvg(),t=e.getAttribute("transform"),r=this.__root.childNodes[1],n=r.childNodes,i=n.length-1;i>=0;i--)n[i]&&r.removeChild(n[i]);this.__currentElement=r,this.__groupStack=[],t&&this.__addTransform(t)},xt.prototype.clearRect=function(e,t,r,n){if(e===0&&t===0&&r===this.width&&n===this.height){this.__clearCanvas();return}var i,o=this.__closestGroupOrSvg();i=this.__createElement("rect",{x:e,y:t,width:r,height:n,fill:"#FFFFFF"},!0),o.appendChild(i)},xt.prototype.createLinearGradient=function(e,t,r,n){var i=this.__createElement("linearGradient",{id:kD(this.__ids),x1:e+"px",x2:r+"px",y1:t+"px",y2:n+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(i),new kv(i,this)},xt.prototype.createRadialGradient=function(e,t,r,n,i,o){var a=this.__createElement("radialGradient",{id:kD(this.__ids),cx:n+"px",cy:i+"px",r:o+"px",fx:e+"px",fy:t+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(a),new kv(a,this)},xt.prototype.__parseFont=function(){var e=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-,\'\"\sa-z0-9]+?)\s*$/i,t=e.exec(this.font),r={style:t[1]||"normal",size:t[4]||"10px",family:t[6]||"sans-serif",weight:t[3]||"normal",decoration:t[2]||"normal",href:null};return this.__fontUnderline==="underline"&&(r.decoration="underline"),this.__fontHref&&(r.href=this.__fontHref),r},xt.prototype.__wrapTextLink=function(e,t){if(e.href){var r=this.__createElement("a");return r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.href),r.appendChild(t),r}return t},xt.prototype.__applyText=function(e,t,r,n){var i=this.__parseFont(),o=this.__closestGroupOrSvg(),a=this.__createElement("text",{"font-family":i.family,"font-size":i.size,"font-style":i.style,"font-weight":i.weight,"text-decoration":i.decoration,x:t,y:r,"text-anchor":kie(this.textAlign)},!0);a.appendChild(this.__document.createTextNode(e)),this.__currentElement=a,this.__applyStyleToCurrentElement(n),o.appendChild(this.__wrapTextLink(i,a))},xt.prototype.fillText=function(e,t,r){this.__applyText(e,t,r,"fill")},xt.prototype.strokeText=function(e,t,r){this.__applyText(e,t,r,"stroke")},xt.prototype.measureText=function(e){return this.__ctx.font=this.font,this.__ctx.measureText(e)},xt.prototype.arc=function(e,t,r,n,i,o){if(n!==i){n=n%(2*Math.PI),i=i%(2*Math.PI),n===i&&(i=(i+2*Math.PI-.001*(o?-1:1))%(2*Math.PI));var a=e+r*Math.cos(i),s=t+r*Math.sin(i),l=e+r*Math.cos(n),c=t+r*Math.sin(n),d=o?0:1,u=0,p=i-n;p<0&&(p+=2*Math.PI),o?u=p>Math.PI?0:1:u=p>Math.PI?1:0,this.lineTo(l,c),this.__addPathCommand(Da("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:r,ry:r,xAxisRotation:0,largeArcFlag:u,sweepFlag:d,endX:a,endY:s})),this.__currentPosition={x:a,y:s}}},xt.prototype.clip=function(){var e=this.__closestGroupOrSvg(),t=this.__createElement("clipPath"),r=kD(this.__ids),n=this.__createElement("g");this.__applyCurrentDefaultPath(),e.removeChild(this.__currentElement),t.setAttribute("id",r),t.appendChild(this.__currentElement),this.__defs.appendChild(t),e.setAttribute("clip-path",Da("url(#{id})",{id:r})),e.appendChild(n),this.__currentElement=n},xt.prototype.drawImage=function(){var e=Array.prototype.slice.call(arguments),t=e[0],r,n,i,o,a=0,s=0,l,c,d,u,p,g,f,y,E,_;if(e.length===3)r=e[1],n=e[2],l=t.width,c=t.height,i=l,o=c;else if(e.length===5)r=e[1],n=e[2],i=e[3],o=e[4],l=t.width,c=t.height;else if(e.length===9)a=e[1],s=e[2],l=e[3],c=e[4],r=e[5],n=e[6],i=e[7],o=e[8];else throw new Error("Invalid number of arguments passed to drawImage: "+arguments.length);d=this.__closestGroupOrSvg(),this.__currentElement;var w="translate("+r+", "+n+")";if(t instanceof xt){if(u=t.getSvg().cloneNode(!0),u.childNodes&&u.childNodes.length>1){for(p=u.childNodes[0];p.childNodes.length;)_=p.childNodes[0].getAttribute("id"),this.__ids[_]=_,this.__defs.appendChild(p.childNodes[0]);if(g=u.childNodes[1],g){var v=g.getAttribute("transform"),T;v?T=v+" "+w:T=w,g.setAttribute("transform",T),d.appendChild(g)}}}else(t.nodeName==="CANVAS"||t.nodeName==="IMG")&&(f=this.__createElement("image"),f.setAttribute("width",i),f.setAttribute("height",o),f.setAttribute("opacity",this.globalAlpha),f.setAttribute("preserveAspectRatio","none"),(a||s||l!==t.width||c!==t.height)&&(y=this.__document.createElement("canvas"),y.width=i,y.height=o,E=y.getContext("2d"),E.drawImage(t,a,s,l,c,0,0,i,o),t=y),f.setAttribute("transform",w),f.setAttribute("xlink:href",t.nodeName==="CANVAS"?t.toDataURL():t.getAttribute("src")),d.appendChild(f))},xt.prototype.createPattern=function(e,t){var r=this.__document.createElementNS("http://www.w3.org/2000/svg","pattern"),n=kD(this.__ids),i;return r.setAttribute("id",n),r.setAttribute("width",e.width),r.setAttribute("height",e.height),e.nodeName==="CANVAS"||e.nodeName==="IMG"?(i=this.__document.createElementNS("http://www.w3.org/2000/svg","image"),i.setAttribute("width",e.width),i.setAttribute("height",e.height),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.nodeName==="CANVAS"?e.toDataURL():e.getAttribute("src")),r.appendChild(i),this.__defs.appendChild(r)):e instanceof xt&&(r.appendChild(e.__root.childNodes[1]),this.__defs.appendChild(r)),new zP(r,this)},xt.prototype.setLineDash=function(e){e&&e.length>0?this.lineDash=e.join(","):this.lineDash=null},xt.prototype.ellipse=function(e,t,r,n,i,o,a,s){if(o!==a){o=o%(2*Math.PI),a=a%(2*Math.PI),o===a&&(a=(a+2*Math.PI-.001*(s?-1:1))%(2*Math.PI));var l=e+Math.cos(-i)*r*Math.cos(a)+Math.sin(-i)*n*Math.sin(a),c=t-Math.sin(-i)*r*Math.cos(a)+Math.cos(-i)*n*Math.sin(a),d=e+Math.cos(-i)*r*Math.cos(o)+Math.sin(-i)*n*Math.sin(o),u=t-Math.sin(-i)*r*Math.cos(o)+Math.cos(-i)*n*Math.sin(o),p=s?0:1,g=0,f=a-o;f<0&&(f+=2*Math.PI),s?g=f>Math.PI?0:1:g=f>Math.PI?1:0,this.lineTo(d,u),this.__addPathCommand(Da("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:r,ry:n,xAxisRotation:i*(180/Math.PI),largeArcFlag:g,sweepFlag:p,endX:l,endY:c})),this.__currentPosition={x:l,y:c}}},xt.prototype._dcgSetTitle=function(e){var t=this.__currentElement,r=!1,n,i=t.getElementsByTagName("title");i.length>0?n=i[0]:(n=this.__document.createElementNS("http://www.w3.org/2000/svg","title"),r=!0),n.textContent=e,r&&t.appendChild(n)},xt.prototype.drawFocusRing=function(){},xt.prototype.createImageData=function(){},xt.prototype.getImageData=function(){},xt.prototype.putImageData=function(){},xt.prototype.globalCompositeOperation=function(){},xt.prototype.setTransform=function(){};var PK=xt,Bp=class Xs extends cs{constructor(){super(),this.highlightPropertyMultipliers={},this.stateProperties=[],this.cloneProperties=[],this.highlightPropertyMultipliers={},this.config=new cs;for(let t in Os)Os.hasOwnProperty(t)&&this.addStateProperty(t,Os[t]);this.setProperty("labelHangingColor","rgba(150,150,150,1)"),this.setProperty("lastChangedAxis","x"),this.addDynamicProperties()}addDynamicProperties(){let t=this;function r(i,o,a){t.cloneProperties.push(i);function s(){t.setProperty(i,t.config.projectorMode?a:o)}t.config.observe("projectorMode",s),s()}function n(i,o,a,s,l){t.cloneProperties.push(i);function c(){let u;t.config.projectorMode?u=t.highlight?l:s:u=t.highlight?a:o,t.setProperty(i,u)}let d=[o,a,s,l];t.highlightPropertyMultipliers[i]=d.map(u=>u/d[0]),t.observe("highlight",c),t.config.observe("projectorMode",c),c()}r("labelSize",14,19),r("majorAxisOpacity",.4,1),r("minorAxisOpacity",.12,.25),r("axisOpacity",.9,.9),r("axisLineWidth",1.5,2),r("axisLineOffset",.25,0),r("pixelsPerLabel",80,120),n("curveOpacity",.7,1,.7,1),r("globalCurveColor",void 0,void 0),r("disableFill",!1,!1),n("graphLineWidth",2.5,3.5,5,7),n("pointLineWidth",8,8*1.2,8*1.3,8*1.2*1.3)}setController(t){this.controller=t,this.registerCallbacks()}getHighlightPropertyMultiplier(t,r){let n=r?1:0;return this.config.projectorMode?this.highlightPropertyMultipliers[t][2+n]:this.highlightPropertyMultipliers[t][n]}getFillOpacityMultiplier(){return this.highlight&&this.controller&&this.controller.isGeometry()?1.3:1}addStateProperty(t,r){this[t]=r,this.stateProperties.push(t),this.cloneProperties.push(t)}static fromObject(t){let r=new Xs;return r.cloneProperties.forEach(n=>{t.hasOwnProperty(n)&&r.setProperty(n,t[n])}),r}registerCallbacks(){let t=()=>{var r;(r=this.controller)==null||r.requestRedrawGraph()};this.stateProperties.forEach(r=>{this.observe(r,t)}),this.config.observe("backgroundColor",t),this.config.observe("textColor",t),this.config.observe("invertedColors",t),this.observe("backgroundColor",t),this.observe("textColor",t),this.config.observe("enableTabindex",t),this.config.observeAndSync("projectorMode",t)}_validateSetting(t,r){let n;switch(t){case"xAxisMinorSubdivisions":case"yAxisMinorSubdivisions":n=Math.round(Math.min(Math.max(0,r),5)),r!==n&&__dcg_shared_module_exports__.qe.warn("minorSubdivisions must be an integer between 0 and 5. You provided "+r+", which we changed to "+n+".");break;case"degreeMode":case"projectorMode":case"showGrid":case"showXAxis":case"showYAxis":case"xAxisNumbers":case"yAxisNumbers":case"polarNumbers":case"enableTabindex":case"invertedColors":case"complex":n=r==="false"?!1:!!r,r!==n&&__dcg_shared_module_exports__.qe.warn(t+" must be a Boolean. You provided "+r+" ("+typeof r+"), which we changed to "+n+" ("+typeof n+").");break;case"xAxisStep":case"yAxisStep":n=parseFloat(r),isFinite(r)||(n=0,__dcg_shared_module_exports__.qe.warn(t+" must be a number. You provided "+r+", which we changed to "+n+"."));break;case"xAxisScale":case"yAxisScale":n=r,!this.config.logScales&&r==="logarithmic"?(n="linear",__dcg_shared_module_exports__.qe.warn("Must set logScales: true to set "+t+" to 'logarithmic'.")):r!=="linear"&&r!=="logarithmic"&&(n="linear",__dcg_shared_module_exports__.qe.warn(t+' must be "linear" or "logarithmic". You provided '+r+", which we changed to "+n+"."));break;case"xAxisArrowMode":case"yAxisArrowMode":n=__dcg_shared_module_exports__.pd[r],n!==r&&(n="NONE",__dcg_shared_module_exports__.qe.warn(`unknown AxisArrowMode. Allowed values are: 
`+__dcg_shared_module_exports__.B(__dcg_shared_module_exports__.pd).join(`
`)));break;case"xAxisLabel":case"yAxisLabel":n=r,typeof r!="string"&&(n="",__dcg_shared_module_exports__.qe.warn(t+" must be a string. you provided a "+typeof r+"."));break;case"randomSeed":n=r,typeof r!="string"&&(n=""+r,__dcg_shared_module_exports__.qe.warn("randomSeed must be a string. you provided a "+typeof r+"."));break;case"backgroundColor":n=r,typeof r!="string"&&(n="",__dcg_shared_module_exports__.qe.warn(t+" must be a string. you provided a "+typeof r+".")),n||(n="#fff"),n[0]!=="#"&&(n="#"+n);break;case"textColor":n=r,typeof r!="string"&&(n="",__dcg_shared_module_exports__.qe.warn(t+" must be a string. you provided a "+typeof r+".")),n||(n="#000"),n[0]!=="#"&&(n="#"+n);break;case"fontSize":n=r,typeof r!="number"&&(n=parseInt(n,10),__dcg_shared_module_exports__.qe.warn("fontSize must be a number. Attempted to convert "+r+" to "+n+"."));break;case"language":n=r,typeof r!="string"&&(n="",__dcg_shared_module_exports__.qe.warn(t+" must be a string. you provided a "+typeof r+".")),r!=="en"&&!_T(r)&&(n="en",__dcg_shared_module_exports__.qe.warn(r+" is not currently an available language."));break;default:n=r;break}return n}validateSettings(t){let r={},n=!1;for(let i in t)this.stateProperties.indexOf(i)>=0?r[i]=this._validateSetting(i,t[i]):(__dcg_shared_module_exports__.qe.warn('Invalid graph setting "'+i+'".'),n=!0);return n&&__dcg_shared_module_exports__.qe.warn(`Available graph settings are: 
`+this.stateProperties.join(`
`)),this.config.allowComplex||r.complex&&(__dcg_shared_module_exports__.qe.warn("complex: true is not compatible with allowComplex: false. Forcing complex: false"),r.complex=!1),r.complex&&(r.degreeMode&&__dcg_shared_module_exports__.qe.warn("degreeMode: true is not compatible with complex: true. Forcing degreeMode: false"),r.degreeMode=!1),r}getConfiguredBackgroundColor(){return __dcg_shared_module_exports__.Id(this.config.backgroundColor||"#fff")}getBackgroundColor({invertWhite:t}={invertWhite:!1}){let r=this.getConfiguredBackgroundColor();return this.config.invertedColors&&t?__dcg_shared_module_exports__.Md(r):r}getConfiguredTextColor(){return __dcg_shared_module_exports__.Id(this.config.textColor||"#000")}getTextColor({invertBlack:t}={invertBlack:!1}){let r=this.getConfiguredTextColor();return this.config.invertedColors&&t?__dcg_shared_module_exports__.Md(r):r}cloneConfig(){let t={};for(let r of Object.keys(sy))t[r]=__dcg_shared_module_exports__.Jc(this.config[r]);return t}};qt();var _D=class{constructor(e,t){this.is3d=!0,this.color="#000000",this.showHighlight=!1,this.selected=!1,this.hoistToTop=!1,this.id=e,this.branches=t!==void 0?t:[]}updateFrom(e){e&&(this.showHighlight=e.showHighlight,this.hoistToTop=e.hoistToTop,this.selected=e.selected)}};function OK(e){return e.is3d}function ul(e,t){if(OK(t)||e.isGeoUIActive()&&e.getAllToolPreviewItems().filter(r=>r.id===t.id).length>0)return!1;for(let r of t.branches)if(kc(r,e.getGraphSettings().config.audioTraceSimult))return!0;return!1}function kc(e,t){if(e)switch(e.graphMode){case 8:case 5:case 6:return t&&e.segments.length>0;case 1:case 2:case 3:case 4:case 25:case 26:return e.segments.length>0;default:return!1}}function RK(e,t){for(let r=0;r<e.branches.length;r++)if(kc(e.branches[r],t))return r;return 0}function _v(e,t,r){let n=0;for(let i=0;i<=t;i++)kc(e.branches[i],r)&&(n+=1);return n}function FK(e){switch(e.graphMode){case 1:case 2:case 3:case 4:case 25:case 26:return!0;default:return!1}}function NK(e,t){switch(t){case 2:case 8:case 5:case 6:case 3:case 4:case 25:case 26:return{independentMin:e.xmin,independentMax:e.xmax,dependentMin:e.ymin,dependentMax:e.ymax};case 1:return{independentMin:e.ymin,independentMax:e.ymax,dependentMin:e.xmin,dependentMax:e.xmax};default:throw qP(t)}}function qP(e){return`Unexpected graph mode. Received ${e}`}function HP(e){let t=Math.random()*2-1;return(e+.2*t)/1.02}function BK(e,t){if(e===1)return t.y;if(e===2||e===8||e===5||e===6)return t.x;throw qP(e)}function UK(e,t){let r=([n,i])=>{let o=t!=null&&t.degreeMode?n*Math.PI/180:n;return[i*Math.cos(o),i*Math.sin(o)]};return __dcg_shared_module_exports__.t(__dcg_shared_module_exports__.y(e,2).map(n=>r(n)),!0)}function KP(e,t,r){let n=vu(e,t.mathToPixels,r),i=Z3(n,{xmin:0,xmax:t.screen.width,ymin:0,ymax:t.screen.height}),o=t.pixelsToMath;return r===ef&&(o=new __dcg_shared_module_exports__.jd(o.yScale,o.xScale)),i.map(a=>vu(a,o,r))}function zK(e,t){return e[0]-t[0]}function qK(e){switch(e.graphMode){case 2:case 3:case 4:case 25:case 26:return{independent:e.x,dependent:e.y};case 1:return{independent:e.y,dependent:e.x};default:throw qP(e.graphMode)}}var _ie=.1;function WP(e){return e<0?_ie:0}function Iv(e){var t;let r=e.getGrapher();if(!r)return"";let n=r.viewportController.getViewport(),i=r.getProjection(),{showGrid:o,showXAxis:a,xAxisNumbers:s,showYAxis:l,yAxisNumbers:c,xAxisLabel:d,yAxisLabel:u}=r.settings,p=!1,g="",f=!1,y=[],E=Ao(__dcg_shared_module_exports__.qa.value(n.xmin,Ng(i,n.xmin)).latex),_=Ao(__dcg_shared_module_exports__.qa.value(n.xmax,Ng(i,n.xmax)).latex),w=Ao(__dcg_shared_module_exports__.qa.value(n.ymin,jT(i,n.ymin)).latex),v=Ao(__dcg_shared_module_exports__.qa.value(n.ymax,jT(i,n.ymax)).latex),T=n.zmin?Ao(__dcg_shared_module_exports__.qa.value(n.zmin).latex):"",M=n.zmax?Ao(__dcg_shared_module_exports__.qa.value(n.zmax).latex):"";if(e.is3dProduct()){let{xmin:C,xmax:P,ymin:F,ymax:B,zmin:x,zmax:L}=n,{showAxis3D:N,showNumbers3D:O,showPlane3D:z}=r.settings;C===F&&C===x&&P===B&&P===L&&N?(a=l=p=!1,y.push(e.s("graphing-calculator-narration-audio-trace-description-visible-xyz-axis-range",{xmin:E,xmax:_}))):(a=l=p=N,d=u=g="",s=c=f=O,o=a&&z)}if(a&&(s&&d!==""?y.push(e.s("graphing-calculator-narration-audio-trace-description-visible-x-axis-range-and-label",{xmin:E,xmax:_,label:d})):s&&d===""?y.push(e.s("graphing-calculator-narration-audio-trace-description-visible-x-axis-range",{xmin:E,xmax:_})):!s&&d!==""?y.push(e.s("graphing-calculator-narration-audio-trace-description-visible-x-axis-and-label",{label:d})):!s&&d===""&&y.push(e.s("graphing-calculator-narration-audio-trace-description-visible-x-axis"))),l&&(c&&u!==""?y.push(e.s("graphing-calculator-narration-audio-trace-description-visible-y-axis-range-and-label",{ymin:w,ymax:v,label:u})):c&&u===""?y.push(e.s("graphing-calculator-narration-audio-trace-description-visible-y-axis-range",{ymin:w,ymax:v})):!c&&u!==""?y.push(e.s("graphing-calculator-narration-audio-trace-description-visible-y-axis-and-label",{label:u})):!c&&u===""&&y.push(e.s("graphing-calculator-narration-audio-trace-description-visible-y-axis"))),p&&(f&&g!==""?y.push(e.s("graphing-calculator-narration-audio-trace-description-visible-z-axis-range-and-label",{zmin:T,zmax:M,label:g})):f&&g===""?y.push(e.s("graphing-calculator-narration-audio-trace-description-visible-z-axis-range",{zmin:T,zmax:M})):!f&&g!==""?y.push(e.s("graphing-calculator-narration-audio-trace-description-visible-z-axis-and-label",{label:g})):!f&&g===""&&y.push(e.s("graphing-calculator-narration-audio-trace-description-visible-z-axis"))),o&&y.push(e.s("graphing-calculator-narration-audio-trace-description-visible-grid")),e.is3dProduct()&&y.push(Iie()),!e.isGeometry()&&!e.is3dProduct()){let C=(t=e.getGrapher())==null?void 0:t.graphSketches,P=0;for(let F in C)ul(e,C[F])&&(P+=1);y.push(e.s("graphing-calculator-narration-audio-trace-traceable-curves",{sketchCount:__dcg_shared_module_exports__.ra(P)}))}return y.join(" ").trim()}function Iie(e){return""}function Aie(e,t,r){return{x:e.x,y:e.y,branch:e.branch,reportedBranch:r,type:e.type,graphMode:t,intersects:e.intersects}}var py=101,ID=class{constructor(e,t,r){this.grapher=r,this.controller=e,this.audiograph=t,this.reset()}reset(){this.currentPoint=void 0,this.resetToFirstBranch(),this.sampledPoints=[],this.pois=[],this.independent=0}resetToFirstBranch(){let e=this.getCurrentSketch();this.branch=e?RK(e,this.grapher.settings.config.audioTraceSimult):0}resetTracePoint(){this.grapher.traceLayer.setTraceInfo(void 0),this.grapher.traceLayer.setTraceLine(void 0),this.drawTracePoint(this.getCurrentPoint())}drawTracePoint(e){let t=this.getCurrentSketch();if(!e||!t)return;let r=t.branches[this.branch];if(!r)return;let n=r.graphMode;if(__dcg_shared_module_exports__.N(n))return;let i={x:e.x,y:e.y},o={branchInfo:{branch:e.branch,id:t.id,sketch:t},pt:i};__dcg_shared_module_exports__.E(o,this.grapher.traceLayer.getTraceInfo())||(this.grapher.traceLayer.setTraceInfo(o),this.controller.requestRedrawGraph())}drawTraceLine(e,t){if(e===void 0||!t)return;let r=this.getCurrentSketch();t===1?this.grapher.traceLayer.setTraceLine({x:void 0,y:e,color:r==null?void 0:r.color}):this.grapher.traceLayer.setTraceLine({x:e,y:void 0,color:r==null?void 0:r.color})}moveToOrigin(){let e=this.getCurrentSketch();if(!e||!ul(this.controller,e))return;let t=e.branches[this.branch];if(!kc(t,this.grapher.settings.config.audioTraceSimult))return;let r=t.graphMode;if(r===2)this.setIndependent("x",0);else if(r===1)this.setIndependent("y",0);else if(__dcg_shared_module_exports__.N(r)){let n=this.getSortedPOI()[0];this.setIndependent("x",n?n.x:0)}}getCurrentSketch(){let e,t=this.controller.getSelectedItem();if(t)if(t.type==="table"){let r=this.audiograph.getFocusedTableLocation();if(r&&(e=this.getGraphSketchForTableLocation(t,r)),!e){for(let n of t.columnModels)if(e=this.grapher.getGraphSketch(n.id),e!==void 0)break}}else e=this.grapher.getGraphSketch(t.id);return e}getFirstTraceableSketch(e){let[t]=this.getTraceableCurves(void 0,this.controller.shouldAudioTraceReverseExpressions()?"up":"down");if(t){let r=this.controller.getItemModelByIndex(t.expressionIndex);if(!r)return;let n;switch(t.type){case"expression":n=this.grapher.getGraphSketch(r.id);break;case"table":e!=null&&e.selectAssociatedExpression&&this.audiograph.setFocusedTableLocation(t.location),n=this.getGraphSketchForTableLocation(r,t.location);break;default:let i=t;throw new Error(`Unexpected curve type ${i}`)}if(n)return e!=null&&e.selectAssociatedExpression&&this.controller.dispatch({type:"set-selected-index",index:t.expressionIndex}),n}}canTrace(e){if(!e||e.type==="image"||e.type==="text")return!1;let t;if(e.type==="expression"&&e.shouldGraph)t=this.grapher.getGraphSketch(e.id);else if(e.type==="table"){for(let r of e.columnModels)if(r.shouldGraph){t=this.grapher.getGraphSketch(r.id);break}}return t?ul(this.controller,t):!1}getTraceableExpressionCount(){let e=0,t=this.controller.getItemCount();for(let r=0;r<t;r++){let n=this.controller.getItemModelByIndex(r);n&&this.canTrace(n)&&e++}return e}computeStepSizes(){let e=this.grapher.getProjection().viewport;if(!e)return;let t=e.xmin,r=e.xmax,n=e.ymin,i=e.ymax,o=this.getCurrentSketch();if(!o||!ul(this.controller,o))return;let a=o.branches[this.branch];if(!kc(a,this.grapher.settings.config.audioTraceSimult))return;let s=a.graphMode;if(s===2)this.independent<t?this.independent=t:this.independent>r&&(this.independent=r);else if(s===1)this.independent<n?this.independent=n:this.independent>i&&(this.independent=i);else if(__dcg_shared_module_exports__.N(s)){let l,c;this.independent<t?(c=this.getSortedPOI()[0],this.independent=c&&c.x!==void 0?c.x:0):this.independent>r&&(l=this.getSortedPOI(),c=l[l.length-1],this.independent=c&&c.x!==void 0?c.x:0)}}getPoint(e,t){let r,n=this.getCurrentSketch();if(!n||!ul(this.controller,n))return r;let i,o,a=0,s=n.branches[e];if(!s)return;let l=_v(n,e,this.grapher.settings.config.audioTraceSimult);"compiled"in s&&s.compiled&&(o=s.compiled.fn);let c=s.graphMode,d=this.grapher.getProjection(),{mathToPixels:u,pixelsToMath:p,screen:g}=d;if(c===2||c===8){let f=p.mapX(u.mapX(t)+g.width/(py-1));i=this.getInterveningPOIs(t,f,e,c)[0],(!i||i.x!==t||i.branch!==e)&&(i=void 0,a=o?o(t):0),i?r={x:i.x,y:i.y,type:i.type,typeChain:i.typeChain,branch:i.branch,reportedBranch:l,graphMode:c,intersects:i.intersects}:o&&(r={x:t,y:a,branch:e,reportedBranch:l,graphMode:c})}else if(c===1){let f=p.mapY(u.mapY(t)-g.height/(py-1));i=this.getInterveningPOIs(t,f,e,c)[0],(!i||i.y!==t||i.branch!==e)&&(i=void 0,a=o?o(t):0),i?r={x:i.x,y:i.y,type:i.type,typeChain:i.typeChain,branch:i.branch,reportedBranch:l,graphMode:c,intersects:i.intersects}:o&&(r={y:t,x:a,branch:e,reportedBranch:l,graphMode:c})}else if(__dcg_shared_module_exports__.N(c)){let f=p.mapX(u.mapX(t)+g.width/(py-1));i=this.getInterveningPOIs(t,f,e,c)[0],i&&i.x===t&&i.branch===e?r={x:i.x,y:i.y,type:i.type,typeChain:i.typeChain,branch:i.branch,reportedBranch:l,graphMode:c,intersects:i.intersects}:r={x:t,y:NaN,branch:e,reportedBranch:l,graphMode:c}}return r}getSampledPoints(){return this.sampledPoints.length===0&&this.updateSampledPoints(),this.sampledPoints}updateSampledPoints(){let e=this.getCurrentSketch();if(!e||!ul(this.controller,e))return;let t=[],r=this.grapher.getProjection(),n=r.viewport;for(let i=0;i<e.branches.length;i++){let o=e.branches[i];if(!kc(o,this.grapher.settings.config.audioTraceSimult))continue;let a=o.graphMode,s=0,l=0,c=[],d;if(a===2||__dcg_shared_module_exports__.N(a))s=n.xmin,l=n.xmax,d=(u,p,g)=>r.mathToPixels.interpolateX(u,p,g);else if(a===1)s=n.ymin,l=n.ymax,d=(u,p,g)=>r.mathToPixels.interpolateY(u,p,g);else continue;for(let u=0;u<py;u++){let p=d(s,l,u/(py-1)),g=__dcg_shared_module_exports__.ea(p).value,f=d(s,l,(u+1)/(py-1)),y=__dcg_shared_module_exports__.ea(f).value,E=this.getInterveningPOIs(g,y,i,a);if(E.length>0)c.push.apply(c,E);else{let _=this.getPoint(i,g);_&&c.push(_)}}t.push.apply(t,this.removeDuplicates(c,a))}this.sampledPoints=t}getCurrentPoint(){return this.currentPoint||this.updateCurrentPoint(),this.currentPoint}updateCurrentPoint(e){if(e){this.currentPoint=e;let t=e.graphMode;t===2||__dcg_shared_module_exports__.N(t)?this.independent=e.x!==void 0?e.x:0:t===1&&(this.independent=e.y!==void 0?e.y:0),this.branch=e.branch}else this.currentPoint=this.getPoint(this.branch,this.independent)}prevPoint(){this.moveToPoint(-1)}nextPoint(){this.moveToPoint(1)}firstPoint(){let e=this.getSampledPoints();e.length>0&&this.updateCurrentPoint(e[0])}lastPoint(){let e=this.getSampledPoints();e.length>0&&this.updateCurrentPoint(e[e.length-1])}moveToPoint(e){let t=this.getCurrentPoint();if(!t)return;if(__dcg_shared_module_exports__.N(t.graphMode)){this.moveToPOI(e);return}let r=this.getSampledPoints(),n=this.getClosestPointIndexOnSameBranch(r,t);if(n!==-1){let i=n+e;i<=0?(i=0,yt(this.controller.s("graphing-calculator-narration-audio-trace-first-point"))):i>=r.length-1&&(i=r.length-1,yt(this.controller.s("graphing-calculator-narration-audio-trace-last-point")));let o=r[i];this.updateCurrentPoint(o)}}canMoveToPrevPoint(){let e=this.getCurrentPoint();if(!e)return!1;if(__dcg_shared_module_exports__.N(e.graphMode))return this.canMoveToPrevPOI();let t=this.getSampledPoints(),r=this.getClosestPointIndexOnSameBranch(t,e);return r!==-1&&r>0}canMoveToNextPoint(){let e=this.getCurrentPoint();if(!e)return!1;if(__dcg_shared_module_exports__.N(e.graphMode))return this.canMoveToNextPOI();let t=this.getSampledPoints(),r=this.getClosestPointIndexOnSameBranch(t,e);return r!==-1&&r<t.length-1}prevPOI(){this.moveToPOI(-1)}nextPOI(){this.moveToPOI(1)}getSortedPOI(){return(!this.pois||this.pois.length===0)&&this.updatePOI(),this.pois}updatePOI(){let e=[],t,r=[],n=this.getCurrentSketch();if(!(!n||!ul(this.controller,n))){for(let i=0;i<n.branches.length;i++){let o=n.branches[i];if(!o)continue;let a=_v(n,i,this.grapher.settings.config.audioTraceSimult),s=o.graphMode;if(r=[],t=n.getBranchPOI(i),t.length>0){s===2||__dcg_shared_module_exports__.N(s)?r=__dcg_shared_module_exports__.q(t,"x"):s===1&&(r=__dcg_shared_module_exports__.q(t,"y"));let l=[];for(let c of r)l.push(Aie(c,s,a));e.push.apply(e,this.removeDuplicates(l,s))}}this.pois=e}}removeDuplicates(e,t){let r=[];for(let n of e){if(n=R({},n),n.graphMode=t,r.length===0){r.push(n);continue}let i=r[r.length-1];__dcg_shared_module_exports__.ea(i.x).value===__dcg_shared_module_exports__.ea(n.x).value&&__dcg_shared_module_exports__.ea(i.y).value===__dcg_shared_module_exports__.ea(n.y).value&&i.branch===n.branch?(i.typeChain||(i.typeChain=i.type!==void 0?[i.type]:[]),n.type!==void 0&&i.typeChain.indexOf(n.type)===-1&&i.typeChain.push(n.type),n.type===1001&&n.intersects&&i.intersects===void 0&&(i.intersects=n.intersects)):r.push(n)}return r}getInterveningPOIs(e,t,r,n){let i=[],o=this.getSortedPOI(),a=NaN;for(let s of o)s&&((n===2||__dcg_shared_module_exports__.N(n))&&!isNaN(s.x)?a=s.x:n===1&&!isNaN(s.y)&&(a=s.y),s.branch===r&&!isNaN(a)&&(e<=a&&a<t||t<=a&&a<e)&&i.push(s));return e>t?i.reverse():i}setIndependent(e,t){let r=this.getSampledPoints();for(let i of r)if(i&&i.hasOwnProperty(e)&&i[e]===t){if(e==="x"){this.independent=i.x!==void 0?i.x:0,this.updateCurrentPoint();return}else if(e==="y"){this.independent=i.y!==void 0?i.y:0,this.updateCurrentPoint();return}}let n=!0;if(r.length>0){let i=Math.floor((r.length-1)/2),o=r[i];o&&(e==="x"?(this.independent=o.x!==void 0?o.x:0,n=!1):e==="y"&&(this.independent=o.y!==void 0?o.y:0,n=!1))}n&&(this.independent=0),this.resetToFirstBranch(),this.updateCurrentPoint()}moveToPOI(e){if(!this.getCurrentPoint())return;let t=this.getSampledPoints(),r=this.getPOIIndexByDirection(e);r===-1?yt(this.controller.s("graphing-calculator-narration-audio-trace-no-more-pois")):this.updateCurrentPoint(t[r])}getPOIIndexByDirection(e){let t=this.getCurrentPoint();if(!t)return-1;let r=this.getSampledPoints(),n=this.getClosestPointIndexOnSameBranch(r,t),i=-1;if(n!==-1){let o=t.graphMode,a=e===1?r.length-1:0;for(let s=n;s!==a+e;s+=e){let l=r[s];if(((o===2||__dcg_shared_module_exports__.N(o))&&t.x!==l.x||o===1&&t.y!==l.y)&&l.type!==void 0){i=s;break}}}return i}canMoveToPrevPOI(){return this.getPOIIndexByDirection(-1)!==-1}canMoveToNextPOI(){return this.getPOIIndexByDirection(1)!==-1}getClosestPointIndexOnSameBranch(e,t){let r=-1,n=1/0;if(e.length>0&&t){let i=t.graphMode;for(let o=0;o<e.length;o++){let a=e[o];if(t.branch!==a.branch)continue;let s;i===2||__dcg_shared_module_exports__.N(i)?s=Math.abs(a.x-t.x):s=Math.abs(a.y-t.y),s<n&&(r=o,n=s)}}return r}prevCurve(){this.controller.shouldAudioTraceReverseExpressions()?this.switchCurves("down"):this.switchCurves("up")}nextCurve(){this.controller.shouldAudioTraceReverseExpressions()?this.switchCurves("up"):this.switchCurves("down")}switchCurves(e){let t=this.controller.getSelectedItem();if(!t)return;let r=e==="down"?this.findNextTraceableIndex(t.index):this.findPrevTraceableIndex(t.index);if(r){let n=this.controller.getItemModelByIndex(r.expressionIndex);if(!n)return;r.type==="table"&&this.audiograph.setFocusedTableLocation(r.location),this.controller.dispatch({type:"set-selected-id",id:n.id,state:"selected"}),this.controller.runAfterDispatch(()=>this.audiograph.enterAudioTrace())}}canMoveToPrevCurve(){let e=this.controller.getSelectedItem();return e?this.controller.shouldAudioTraceReverseExpressions()?!!this.findNextTraceableIndex(e.index):!!this.findPrevTraceableIndex(e.index):!1}canMoveToNextCurve(){let e=this.controller.getSelectedItem();return e?this.controller.shouldAudioTraceReverseExpressions()?!!this.findPrevTraceableIndex(e.index):!!this.findNextTraceableIndex(e.index):!1}*getTraceableCurves(e,t="down"){let r=t==="down"?1:-1;for(let n=e!=null?e:t==="down"?0:this.controller.getItemCount()-1;t==="down"?n<=this.controller.getItemCount()-1:n>=0;n+=r){let i=this.controller.getItemModelByIndex(n);if(this.canTrace(i))if((i==null?void 0:i.type)==="table"){let o=[];for(let s=1;s<i.columnModels.length;s+=1){let l=i.columnModels[s];l!=null&&l.shouldGraph&&this.grapher.getGraphSketch(l.id)&&o.push({type:"table",expressionIndex:n,location:{tableId:i.id,type:"cell",location:{column:s,row:0}}})}this.controller.areTableRegressionsEnabled()&&i.regression&&!i.regression.hidden&&o.push({type:"table",expressionIndex:n,location:{type:"table-regression",location:void 0,tableId:i.id}}),t==="up"&&o.reverse();let a=this.audiograph.getFocusedTableLocation();if(a){let s=o.findIndex(({location:l})=>__dcg_shared_module_exports__.E(l,a));yield*wn(o.slice(s!==-1?s:0))}else yield*wn(o)}else yield{type:"expression",expressionIndex:n}}}findNextTraceableIndex(e){let[t,r]=this.getTraceableCurves(e,"down");return r}findPrevTraceableIndex(e){let[t,r]=this.getTraceableCurves(e,"up");return r}getGraphSketchForTableLocation(e,t){if(!(!e||e.type!=="table")){if(t.type==="cell"){let r=e.columnModels[t.location.column];if(r)return this.grapher.getGraphSketch(r.id)}else if(t.type==="table-regression"){let r=e.regression;if(r)return this.grapher.getGraphSketch(r.id)}}}};Ss();var HK=__dcg_shared_module_exports__.f("//tQxAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAIAAAHVwAgICAgICAgICAgICBAQEBAQEBAQEBAQEBgYGBgYGBgYGBgYGBggICAgICAgICAgICAoKCgoKCgoKCgoKCgoMDAwMDAwMDAwMDAwODg4ODg4ODg4ODg4OD///////////////8AAAA5TEFNRTMuOThyAaUAAAAALmcAABRAJAiwQgAAQAAAB1cctrbdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/7UMQAAAjsKyK0YYABp52xtx8wAgAgBd34IAhAgnsECEe7QIAAgsPxACDgcBAEHQfD/g+D4PggCAIf///ghLny4Pg+D5+sHz/wf+XPwfB8H3iMHwfwffUCYPvz/Y7Hg/H4/H4/H4HAwADcoDwAP7XfuAFtXrhzjsjOXP8iCYM4IBVoH2DGAhQR2hm5vikA2IVEPX9nQaITi6IiLCKX/fxcg/DdGmS5BP7fIGQ0hw7DQi5Q//8midImXygdJ0tlz/1NAgXIANV6MA2Vy2y27jv/+1LEBIALOHOTvGGAMXWhbnTxGZ+LOa2FNMsDtj9/jUmPqqqARrNvlVjDDoGZqq0T11A0DVqeEnlQk8q4sVEp0FcqdxLoEJ0RPYWvIlQkbGA0Anw6VJJgqRKw1NJaAXkR4ag0/FwCCABbbdbJA0fzVgdvgvu5Px6Rwiv3VllZVDREqmWntLyBDka3sz951iTve+ddHP0/M3P/+ydU4zbqOZOeop5jfu1kwk8VezPeGc1hRMbWrJNv6SO/fH0Mc15KYvKqAAAAdrdsrbBDuBpp4v/7UsQGgguVE2ekjNP5aSBo6YSNgKAQUoCZEBJK8q73G/nhJFFmLY5dNc4b7gjBRyEs5yjJokY9TBoU/pXQBglyNjeiA87V8vkzaw019YTu2fxY0t6gteLMI37f9fYw7UVnWoE4NJOSpQBu3GfVAIVACgw+IikZZAnB7UKlLGnha4PDbIhsBhk4RYmlE2hYZ8NrQ5HnyEUvZxDyVG1hM33ZZH0OlrJV5///3/51qTGtJgxhREVLEfoO1w6686eRAAAAUicksbA1qegZCe2AuEgJ//tSxAkCDF0XSaw8ailyn+l1h4w1BvVY04S56fYY5nGkBZHMGLBjHDUMlORG4wcCT9R6RB+3vM8jVMU1hmlOoXIOMKqotE2HxWYNJq/7EZ2l63NJ+Z2aTA4Yq+7t0PhOxCz9WP1mA3DJZZGDkRfq+qFAGwhwHUAVqBfDiMUlypaMWApR1VoWLChfUpJzkBDMCTf85UZr6jyHa1psZnTS5iKatTVKcX/Ker9zMvM1T0okGyiQcreJbU1tc+Yj/ms3395FBIADkjlkjbAZNdiwgRD/+1LEBwAL8Tdbp6Rh+XmT6XWHjCx5U4sTCtlUidNtS9I7oUx7oxdIZlOghkIQYzB0vxtMs6QgCg4WMVakQMM5HRfrsdIEftM0yfOHnNGkiPRMoWCKSsxsChat8/vYw4c4t+CMMB5AAAAXZrftWiEVdbSgnURZoWvK2KhK9GfCkIGnQKxIqbYJ0JCNFJ3St1wuUNRLW4Kw5VhLVGrmgYKhhRe1qzzC7SqFFyjJlIqXcPD6gw//epZ9bwQFw+s+rdVAFtzl0AAAA3I3JK0QJxtCHv/7UsQGAApAM0WssGFpSCKqNYMMvgZph6CwIhKEt0yEiMwFKpnDBBajVc5jbTM7KayRt3I43h8Ag05kd9AtqO0bItmf/+Aevzf7dx28sK0hvP//3/izNwf1pfEAgANutuOJACSqWvuW+SKNLQSpOQKsrX3XxnZxy2Rus0Q1irPy9Mkg4kZGJFRQUax4R+jsACwavqYd2bmRX/6VnKrLk2Z2VGYwQNCIEasJh7/oBScAAMtBNgBWssKw0uCAgKkVpJirpZyBklUCwqaSIkW6BgIY//tSxBIDSYw3Km0kSoEzi9KAliSw9QNAydBqoFQVEQNBwiJYiBWdDqxiwVBUGqg6JgaBoGj3//////huVcFQsIRoPjBXLBGA8AkCwOhcD4KAmFAtEYcR6E8gD2OAXJ2N//uSJVZVJNRdh0gkLCwuKioqz4sLC3//////4sLC31ioqKpAoqKirOgFqkxBTUUzLjk4LjKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+1LEIwPAAAGkAAAAIAAANIAAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg=="),ah=.075,fo=.0015,KK=.02,WK=125,$K=330,jK=2e3,Gie=27.5,Lie=4186,$P=.04,jP=.2,YK=25;function XK(e){return e<2e3?.002:.005}function Pie(e){return{segments:e.clippedSegments.length,totalPoints:e.clippedSegments.map(t=>t.length).reduce((t,r)=>t+r,0),graphMode:e.graphMode,duration:e.duration,discrete:e.discrete}}var Av=class{constructor(e,t){this.audioContext=e.audioContext,this.audioContext&&(this.oscillator=this.audioContext.createOscillator(),this.oscillator.setPeriodicWave(e.getBaseWaveform()),this.firstHarmonic=this.audioContext.createOscillator(),this.firstHarmonic.setPeriodicWave(e.getFirstHarmonicWaveform()),this.firstHarmonicGain=this.audioContext.createGain(),this.firstHarmonicGain.gain.value=0,this.pan=this.audioContext.createStereoPanner(),this.pan.pan.value=0,this.gain=this.audioContext.createGain(),this.gain.gain.value=0,this.oscillatorGain=this.audioContext.createGain(),this.oscillatorGain.gain.value=.5,this.oscillatorGain.connect(this.gain),this.oscillator.connect(this.oscillatorGain),this.firstHarmonic.connect(this.firstHarmonicGain),this.firstHarmonicGain.connect(this.gain),this.gain.connect(this.pan),this.pan.connect(t),this.oscillator.start(),this.firstHarmonic.start(),this.brownNoiseGain=this.audioContext.createGain(),this.brownNoiseGain.gain.value=0,this.brownNoiseSource=this.audioContext.createBufferSource(),this.brownNoiseSource.buffer=e.brownNoiseSample,this.brownNoiseSource.loop=!0,this.brownNoiseSource.start(),this.brownNoiseSource.connect(this.brownNoiseGain),this.brownNoiseGain.connect(this.pan))}stop(e){let t=Math.max(this.audioContext.currentTime,e);this.gain.gain.setTargetAtTime(0,t,fo),this.brownNoiseGain.gain.setTargetAtTime(0,t,fo),setTimeout(()=>{this.oscillator.stop(),this.firstHarmonic.stop(),this.brownNoiseSource.stop(),this.pan.disconnect()},1e3*(2*fo+Math.max(0,e-this.audioContext.currentTime))+1)}};function Vie(e){if(e.length<=2)return[e];let t=__dcg_shared_module_exports__.y(e,2),r=0,n=[[t[0]]],i=t[0][0]<t[1][0];for(let o=1;o<t.length;o++)n[r].push(t[o]),o<t.length-1&&i!==t[o][0]<t[o+1][0]&&(i=!i,r++,n[r]=[t[o]]);return n.map(o=>__dcg_shared_module_exports__.t(o))}function Oie(e){let t=__dcg_shared_module_exports__.y(e,2);return t.sort((r,n)=>r[0]-n[0]),__dcg_shared_module_exports__.t(t)}var AD=class{constructor({controller:e,agNavigator:t,audioEnabled:r}){this.isPlayingOneBranch=!1,this.FREQ_MIN=WK,this.FREQ_MAX=jK,this.FREQ_BASE=$K,e&&(this.controller=e),this.audioContextManager=new hb,this.audioGraphNavigator=t,this.audioEnabled=r,this.screenDuration=5,this.audioVolume=.5}getBaseWaveform(){var e;let t=new Float32Array([0,1,0,.25]),r=new Float32Array([1,0,.25,0]);return(e=this.audioContext)==null?void 0:e.createPeriodicWave(t,r)}getFirstHarmonicWaveform(){var e;let t=new Float32Array([0,0,0,.25,0,0,0,0]),r=new Float32Array([1,0,1,0,.25,0,.3,0]);return(e=this.audioContext)==null?void 0:e.createPeriodicWave(t,r)}prepareSynthesizer(){return Fr(this,null,function*(){if(!this.audioEnabled()||!this.audioContextManager||!this.audioGraphNavigator)return;try{this.audioContext=(yield this.audioContextManager.getResumedAudioContext()).audioContext,this.playbackSupported=!0}catch(r){this.playbackSupported=!1;return}this.audioContext.destination.disconnect(),this.mainGainNode=this.audioContext.createGain(),this.mainGainNode.gain.value=this.audioVolume,this.mainGainNode.connect(this.audioContext.destination);let e=this.audioContext.sampleRate*this.screenDuration;this.brownNoiseSample=this.audioContext.createBuffer(1,e,this.audioContext.sampleRate);let t=HP(0);for(let r=0;r<e;r++)t=HP(t),this.brownNoiseSample.getChannelData(0)[r]=t;if(!this.poiBufferSample)try{this.poiBufferSample=yield this.audioContext.decodeAudioData(HK.buffer.slice(0))}catch(r){}jE()})}releaseAudio(){var e;this.stop(),(e=this.audioContextManager)==null||e.suspend()}synthesizePoint(e,t,r,n){let{gain:i,brownNoiseGain:o,oscillator:a,firstHarmonic:s,firstHarmonicGain:l,pan:c}=n;r=Math.max(r,this.audioContext.currentTime);let d=this.mapDependentToFrequency(t);if(!(!this.viewportBounds||!d)){if(t<this.viewportBounds.dependentMin||t>this.viewportBounds.dependentMax){o.gain.setTargetAtTime($P,r,fo),o.gain.setTargetAtTime(0,r+ah,fo);return}a.frequency.setValueAtTime(d,r),s.frequency.setValueAtTime(d,r),i.gain.setTargetAtTime(1,r,fo),e>0&&l.gain.setTargetAtTime(.15,r,fo),o.gain.setTargetAtTime(WP(t),r,fo),c.pan.setTargetAtTime(this.getPanValueFromIndependent(e),r,fo),i.gain.setTargetAtTime(0,r+ah,fo),l.gain.setTargetAtTime(0,r+ah,fo),o.gain.setTargetAtTime(0,r+ah,fo)}}playPoint(e){!FK(e)||!this.audioContextManager||(this.setupScales(e.graphMode),this.prepareSynthesizer().then(()=>{let t=new Av(this,this.mainGainNode);this.turnMainGainOn();let r=this.audioContext.currentTime,{independent:n,dependent:i}=qK(e);if(!this.mapDependentToFrequency(i)||!this.viewportBounds){t.stop(r);return}if(this.synthesizePoint(n,i,r,t),e.intersects){let o=this.audioContext.createBufferSource();o.connect(t.gain),o.buffer=this.poiBufferSample;try{o==null||o.start(this.audioContext.currentTime)}catch(a){}}t.stop(r+ah+fo)}))}playCurrentSketch(e="sequential"){this.audioContextManager&&this.prepareSynthesizer().then(()=>{this.isPlaying=!0,this.isPlayingOneBranch=!1,this.controller.runAfterDispatch(()=>this.controller.dispatch({type:"render"})),this.prepareToPlay(e),this.startPlayingTime=this.audioContext.currentTime+fo,this.currentPlayLoopStartTime=this.startPlayingTime,this.lagLoggingData||(this.lagLoggingData={startPlayingTime:this.startPlayingTime,branchCount:this.branches.length,branchInfo:this.branches.map(t=>Pie(t)),branchIteratorStartTimes:[],branchIteratorRunTimes:[],branchIteratorCallCount:0,branchLags:[],screenDuration:this.screenDuration}),e==="sequential"?(this.currentPlayLoopBranchIndex=0,this.playBranchIterators=[this.playBranch(this.currentPlayLoopBranchIndex,this.currentPlayLoopStartTime)],this.lagLoggingData&&(this.lagLoggingData.proposedDuration=this.branches.reduce((t,r)=>{var n;return t+((n=r.duration)!=null?n:0)},0)),this.sequentialPlayLoop()):e==="simultaneous"&&(this.playBranchIterators=this.branches.map((t,r)=>this.playBranch(r,this.currentPlayLoopStartTime)),this.playBranchIterators.push(this.playBlankSpace(this.currentPlayLoopStartTime)),this.simultaneousPlayLoop())})}stop(){var e,t,r,n,i,o;YE(),clearTimeout(this.timeoutId),this.isPlaying=!1,this.startPlayingTime=void 0;let a=(e=this.audioContext)==null?void 0:e.currentTime;if(!a)return;this.lagLoggingData&&(this.lagLoggingData.actualDuration=a-this.lagLoggingData.startPlayingTime,this.lagLoggingData.stopPlayingTime=a,(r=(t=this.controller).logEvent)==null||r.call(t,{category:"audio-trace",action:"stop-graph"}),this.lagLoggingData=void 0);let s=(n=this.playBranchIterators)==null?void 0:n.map(c=>c.next()).filter(c=>!c.done);s==null||s.forEach(c=>{var d,u;return(u=(d=c.value).synthStopCallback)==null?void 0:u.call(d,a)}),this.playBranchIterators=[],(i=this.mainGainNode)==null||i.gain.cancelScheduledValues(a),(o=this.mainGainNode)==null||o.gain.setTargetAtTime(0,a,fo);let l=this.mainGainNode;setTimeout(()=>l.disconnect(),1e3*2*fo+1),this.controller.runAfterDispatch(()=>this.controller.dispatch({type:"render"}))}getGraphMode(){if(this.branches)return this.currentPlayLoopBranchIndex!==void 0?this.branches[this.currentPlayLoopBranchIndex].graphMode:this.branches[0].graphMode}playBranchByIndex(e){this.audioContext&&this.prepareSynthesizer().then(()=>{this.prepareToPlay("simultaneous"),this.isPlayingOneBranch=!0,this.isPlaying=!0,this.startPlayingTime=this.audioContext.currentTime+fo,this.currentPlayLoopStartTime=this.startPlayingTime,this.currentPlayLoopBranchIndex=e,this.branches[0].graphMode===8||this.branches[0].graphMode==5||this.branches[0].graphMode==6?(this.playBranchIterators=this.branches.map((t,r)=>this.playBranch(r,this.currentPlayLoopStartTime)),this.playBranchIterators.push(this.playBlankSpace(this.currentPlayLoopStartTime))):this.playBranchIterators=[this.playBranch(e,this.startPlayingTime)],this.simultaneousPlayLoop()})}getPlaybackSupported(){return this.playbackSupported}getIsPlaying(){return this.isPlaying}getAudioSpeed(){return this.screenDuration*10}setAudioSpeed(e){this.screenDuration=e/10}getAudioVolume(){return this.audioVolume}setAudioVolume(e){var t;this.audioVolume=e,(t=this.mainGainNode)==null||t.gain.setTargetAtTime(this.audioVolume,0,fo)}getCurrentIndependentValue(){var e,t;if(!this.getIsPlaying()||this.startPlayingTime===void 0)return;if(this.isPlayingOneBranch)return(t=(e=this.branches[this.currentPlayLoopBranchIndex]).mapTimeToIndependent)==null?void 0:t.call(e,this.audioContext.currentTime-this.startPlayingTime);let r=this.audioContext.currentTime-this.startPlayingTime,n=0;for(let i of this.branches)if(!(!i.duration||!i.mapIndependentToTime||!i.mapTimeToIndependent)){if(r-n>=i.duration){n+=i.duration;continue}return i.mapTimeToIndependent(r-n)}}getCurrentBranchIndex(){if(!this.getIsPlaying()||this.startPlayingTime===void 0)return;if(this.isPlayingOneBranch)return this.currentPlayLoopBranchIndex;let e=this.audioContext.currentTime-this.startPlayingTime,t=0;for(let r=0;r<this.branches.length;r++){let n=this.branches[r];if(n.duration){if(e-t>=n.duration){t+=n.duration;continue}return r}}}preprocessBranch(e,t){switch(e.graphMode){case 8:case 5:case 6:let r=[],n=e.segments;if(e.graphMode===6){let i=this.controller.getViewState();n=n.map(o=>UK(o,i))}for(let i of n){let o=KP(i,t,lg);r.push(...o.filter(a=>a.length>2))}return r=__dcg_shared_module_exports__.t(r.map(i=>Vie(i).map(o=>Oie(o))),!0),r.sort((i,o)=>i[0]-o[0]),r.map(i=>({graphMode:e.graphMode,discrete:!1,poi:e.poi,clippedSegments:[i]})).filter(i=>i.clippedSegments.length>0);case 2:case 1:{let i=[];for(let o of e.segments){let a=e.graphMode===2?lg:ef,s=KP(o,t,a);i.push(...s.filter(l=>l.length>2))}return i.sort((o,a)=>o[0]-a[0]),{graphMode:e.graphMode,discrete:!1,clippedSegments:i,poi:e.poi}}case 3:case 25:case 26:case 4:{let{viewport:i}=t,o=e.segments[0].slice();o.sort(zK);let a=[],s=[];for(let l of o)a.push(l[0],l[1]),l[0]>=i.xmin&&l[0]<=i.xmax&&l[1]>=i.ymin&&l[1]<=i.ymax&&s.push(l[0],l[1]);return{graphMode:2,discrete:!0,clippedSegments:[s],poi:void 0}}default:throw new Error(`Unimplemented graph mode: ${e.graphMode}`)}}turnMainGainOn(){var e,t;(e=this.mainGainNode)==null||e.gain.cancelScheduledValues(0),(t=this.mainGainNode)==null||t.gain.setTargetAtTime(this.audioVolume,0,fo)}getPanValueFromIndependent(e){if(!this.independentScale)return 0;let t=__dcg_shared_module_exports__.fd(this.independentScale,e)/this.screenDuration;return __dcg_shared_module_exports__.Sb(2*t-1,-1,1)}setupScales(e){this.projection=this.controller.get2dProjection(),this.viewportBounds=NK(this.projection.viewport,e);let t=e===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,r=e===1?this.projection.settings.xAxisScale:this.projection.settings.yAxisScale;this.independentScale=__dcg_shared_module_exports__.ed(t,[this.viewportBounds.independentMin,this.viewportBounds.independentMax],[0,this.screenDuration]),this.dependentScale=__dcg_shared_module_exports__.ed(r,[this.viewportBounds.dependentMin,this.viewportBounds.dependentMax],[0,1]),this.viewportBounds.dependentMax<=Lie&&this.viewportBounds.dependentMin>=Gie&&this.viewportBounds.dependentMax-this.viewportBounds.dependentMin>=1e3?(this.FREQ_MIN=this.viewportBounds.dependentMin,this.FREQ_MAX=this.viewportBounds.dependentMax,this.FREQ_BASE=void 0):(this.FREQ_MIN=WK,this.FREQ_MAX=jK,this.FREQ_BASE=$K)}densifyBranches(){this.branches.map(e=>{if(e.discrete)return e;let t=this.independentScale,r=this.dependentScale;return!t||!r||!e.clippedSegments||(e.clippedSegments=e.clippedSegments.map(n=>{let i=[];for(let o=0;o<n.length;o+=2){let a=this.mapDependentToFrequency(n[o+1]),s=this.mapDependentToFrequency(n[o+3]);if(i.push(n[o]),i.push(n[o+1]),a&&s&&isFinite(a)&&isFinite(s)&&Math.abs((s-a)/a)>=XK(Math.min(s,a))){let l=Math.ceil(Math.abs((s-a)/a)/XK(Math.min(s,a)));for(let c=1;c<l;c++)i.push(__dcg_shared_module_exports__.gd(t.type,n[o],n[o+2],c*1/l)),i.push(__dcg_shared_module_exports__.gd(r.type,n[o+1],n[o+3],c*1/l))}}return i})),e})}setupToPlayBranches(e){if(!this.audioGraphNavigator||!this.audioContext||!this.mainGainNode)return;let t=this.audioGraphNavigator.getCurrentSketch();if(!t)return;let r=this.controller.get2dProjection();if(this.branches=__dcg_shared_module_exports__.t(t.branches.filter(n=>kc(n,this.controller.getGraphSettings().config.audioTraceSimult)).map(n=>this.preprocessBranch(n,r))).filter(n=>n.clippedSegments.length>0),!!this.branches.length)if(this.setupScales(this.branches[0].graphMode),this.densifyBranches(),e==="simultaneous"){let n=Math.min(...this.branches.map(l=>l.clippedSegments[0][0])),i=Math.max(...this.branches.map(l=>l.clippedSegments.slice(-1)[0].slice(-2)[0])),o=this.mapIndependentToTime(i)-this.mapIndependentToTime(n),a=__dcg_shared_module_exports__.ed(this.branches[0].graphMode===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,[n,i],[0,o]),s=__dcg_shared_module_exports__.ed(this.branches[0].graphMode===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,[0,o],[n,i]);this.branches.forEach(l=>{l.duration=l.discrete?o+ah:o,l.mapIndependentToTime=c=>__dcg_shared_module_exports__.fd(a,c),l.mapTimeToIndependent=c=>__dcg_shared_module_exports__.fd(s,c)})}else this.branches.forEach(n=>{let i=n.clippedSegments[0][0],o=n.clippedSegments.slice(-1)[0].slice(-2)[0];n.discrete?n.duration=n.clippedSegments.reduce((l,c)=>l+c.length/2,0)*(ah+KK):n.duration=this.mapIndependentToTime(o)-this.mapIndependentToTime(i);let a=__dcg_shared_module_exports__.ed(this.branches[0].graphMode===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,[i,o],[0,n.duration]),s=__dcg_shared_module_exports__.ed(this.branches[0].graphMode===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,[0,n.duration],[i,o]);n.mapIndependentToTime=l=>__dcg_shared_module_exports__.fd(a,l),n.mapTimeToIndependent=l=>__dcg_shared_module_exports__.fd(s,l)})}prepareToPlay(e){this.setupToPlayBranches(e),this.turnMainGainOn(),clearInterval(this.timeoutId)}sequentialPlayLoop(){var e,t,r,n,i;let o=this.audioContext.currentTime,a=(e=this.playBranchIterators[0])==null?void 0:e.next();if(this.lagLoggingData&&(this.lagLoggingData.branchIteratorCallCount++,this.audioContext.currentTime-o>0&&(this.lagLoggingData.branchIteratorStartTimes.push(o),this.lagLoggingData.branchIteratorRunTimes.push(this.audioContext.currentTime-o))),!!a){if(a.done)if(((t=a.value)==null?void 0:t.duration)!==void 0&&(this.currentPlayLoopStartTime=((r=a.value.startTime)!=null?r:this.currentPlayLoopStartTime)+a.value.duration),this.currentPlayLoopBranchIndex<this.branches.length-1)this.currentPlayLoopBranchIndex++,this.playBranchIterators[0]=this.playBranch(this.currentPlayLoopBranchIndex,this.currentPlayLoopStartTime),this.sequentialPlayLoop();else{(n=this.mainGainNode)==null||n.gain.cancelScheduledValues(this.currentPlayLoopStartTime),(i=this.mainGainNode)==null||i.gain.setTargetAtTime(0,this.currentPlayLoopStartTime,fo),clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>this.stop(),1e3*(Math.max(this.currentPlayLoopStartTime-this.audioContext.currentTime,0)+fo));return}this.timeoutId=setTimeout(()=>this.sequentialPlayLoop(),YK)}}simultaneousPlayLoop(){var e,t;let r=this.playBranchIterators.map(n=>n.next());if(r.every(n=>n.done)){let n=this.currentPlayLoopStartTime+Math.max(...r.map(i=>{var o;return(o=i.value)!=null&&o.duration&&isFinite(i.value.duration)?i.value.duration:0}));(e=this.mainGainNode)==null||e.gain.cancelScheduledValues(n),(t=this.mainGainNode)==null||t.gain.setTargetAtTime(0,n,fo),this.timeoutId=setTimeout(()=>this.stop(),1e3*(Math.max(n-this.audioContext.currentTime,0)+fo))}else this.timeoutId=setTimeout(()=>this.simultaneousPlayLoop(),YK)}*playBlankSpace(e){let t=Math.max(this.audioContext.currentTime,e),r=new Av(this,this.mainGainNode),{oscillator:n,pan:i,brownNoiseGain:o,gain:a}=r;n.stop(),a.gain.setTargetAtTime(1,t,fo);let s=this.branches.map(d=>{if(d.mapIndependentToTime)return[d.clippedSegments[0][0],d.clippedSegments.slice(-1)[0].slice(-2)[0]]}).filter(d=>!!d),l=[];for(s.sort((d,u)=>d[0]-u[0]);s.length>0;){let d=s[0];s=s.filter(u=>u[1]>d[1]),s.filter(u=>u[0]<=d[1]).length===0&&l.push([d[1],Math.min(...s.map(u=>u[0]))])}l=l.filter(d=>isFinite(d[0])&&isFinite(d[1]));let c=d=>{r.stop(d)};for(let d of l){let u=t+this.mapIndependentToTime(d[0]),p=t+this.mapIndependentToTime(d[1]);for(;u>this.audioContext.currentTime+jP;)yield{synthStopCallback:c};o.gain.setTargetAtTime($P,u,fo),o.gain.setTargetAtTime(0,p,fo),i.pan.setValueAtTime(this.getPanValueFromIndependent(d[0]),u),i.pan.linearRampToValueAtTime(this.getPanValueFromIndependent(d[1]),p)}return{duration:0}}mapDiscreteSegmentIndexToTime(e){return e/2*(ah+KK)}*playBranch(e,t){var r,n,i,o;let a=this.branches[e];if(!(a!=null&&a.duration)||!(a!=null&&a.mapIndependentToTime))return{duration:0};let s=new Av(this,this.mainGainNode),l=a.clippedSegments,c=w=>{s.stop(w)},{oscillator:d,gain:u,firstHarmonic:p,firstHarmonicGain:g,pan:f,brownNoiseGain:y}=s,E=Math.max(this.audioContext.currentTime,t);if(a.poi&&a.poi.intersections&&this.poiBufferSample){let w=BK(a.graphMode,a.poi.intersections);for(let v of w){let T=this.audioContext.createBufferSource();T.connect(u),T.buffer=this.poiBufferSample;try{T==null||T.start(E+a.mapIndependentToTime(v))}catch(M){}}}let _=E;for(let w=0;w<l.length;w++){let v=l[w];for(let T=0;T<v.length;T+=2){let M=T===0,C=T+2>=v.length,P=a.discrete?_+this.mapDiscreteSegmentIndexToTime(T):E+a.mapIndependentToTime(v[T]),F=this.mapDependentToFrequency(v[T+1]);for(;P>this.audioContext.currentTime+jP;)yield{synthStopCallback:c,duration:void 0};if(a.discrete){this.synthesizePoint(v[T],v[T+1],_+this.mapDiscreteSegmentIndexToTime(T),s);continue}if(P<this.audioContext.currentTime-jP&&this.lagLoggingData&&this.lagLoggingData.branchLags.push({branchIndex:e,segmentIndex:w,pos:T,nextTime:P,proposedStartTime:t,lagAmount:this.audioContext.currentTime-P,currentTime:this.audioContext.currentTime}),M&&(g.gain.cancelScheduledValues(P),y.gain.cancelScheduledValues(P),u.gain.setTargetAtTime(1,P,fo)),F!==void 0&&isFinite(F)){d.frequency.linearRampToValueAtTime(F,P),p.frequency.linearRampToValueAtTime(F,P);let B=P;if(T>=2&&v[T-2]<=0!=v[T]<=0){let L=v[T-2],N=v[T];B=E+a.mapIndependentToTime(__dcg_shared_module_exports__.gd((n=(r=this.independentScale)==null?void 0:r.type)!=null?n:"linear",L,N,Math.abs(N)/(Math.abs(N)+Math.abs(L))))}g.gain.setTargetAtTime(v[T]>0?.15:0,B,fo);let x=P;if(T>=2&&v[T+1]<=0!=v[T-1]<=0){let L=v[T-2],N=v[T],O=v[T-1],z=v[T+1];x=E+a.mapIndependentToTime(__dcg_shared_module_exports__.gd((o=(i=this.independentScale)==null?void 0:i.type)!=null?o:"linear",L,N,Math.abs(O)/(Math.abs(O)+Math.abs(z))))}y.gain.setTargetAtTime(WP(v[T+1]),x,fo)}C&&(u.gain.setTargetAtTime(0,P,fo),w<a.clippedSegments.length-1&&y.gain.setTargetAtTime($P,P,fo)),T===0?f.pan.setValueAtTime(this.getPanValueFromIndependent(v[T]),P):f.pan.linearRampToValueAtTime(this.getPanValueFromIndependent(v[T]),P)}_+=this.mapDiscreteSegmentIndexToTime(v.length)}return a.duration=Math.max(0,a.duration,this.audioContext.currentTime-t),s.stop(E+a.duration),{duration:a.duration,startTime:E}}mapIndependentToTime(e){return this.independentScale?__dcg_shared_module_exports__.fd(this.independentScale,e):0}mapDependentToFrequency(e){if(!this.dependentScale)return;let t=__dcg_shared_module_exports__.fd(this.dependentScale,e);if(this.FREQ_BASE)return Math.min(Math.max(this.FREQ_BASE*Math.pow(2,t),this.FREQ_MIN),this.FREQ_MAX);{let r=this.FREQ_MAX-this.FREQ_MIN;return Math.min(Math.max(this.FREQ_MIN+r*t,this.FREQ_MIN),this.FREQ_MAX)}}},Mv=[{speed:1600,displayedSpeed:"1/32 x"},{speed:1200,displayedSpeed:"1/24 x"},{speed:800,displayedSpeed:"1/16 x"},{speed:400,displayedSpeed:"1/8 x"},{speed:200,displayedSpeed:"1/4 x"},{speed:100,displayedSpeed:"1/2 x"},{speed:50,displayedSpeed:"1 x"},{speed:25,displayedSpeed:"2 x"},{speed:12.5,displayedSpeed:"4 x"},{speed:6.25,displayedSpeed:"8 x"}],MD=class{constructor(e,t){this.focusedTableLocation=void 0,this.grapher=t,this.controller=e,this.audioTraceActive=!1,this.wasFocusInExpressionsView=!1,this.sliderTraceActive=!1,this.sliderIndex=0,this.sliderArray=[],this.lastSpokenBranch=1,this.agNavigator=new ID(e,this,this.grapher),this.agSynthesizer=new AD({controller:e,agNavigator:this.agNavigator,audioEnabled:()=>this.controller.getAudio()}),this.audioSpeedIndex=6,this.agSynthesizer.releaseAudio()}remove(){}handleKeydown(e){let t=e.altKey&&!e.metaKey&&!e.ctrlKey&&!e.shiftKey;t&&Ko(e)==="S"?this.controller.getSelectedItem()&&(this.audioTraceActive||this.isFocusInExpressionsView())&&(e.preventDefault(),e.stopPropagation(),this.describeCurve()):t&&Ko(e)==="G"?(this.audioTraceActive||this.isFocusInExpressionsView())&&(e.preventDefault(),e.stopPropagation(),this.describeAxes()):t&&Ko(e)==="T"?(e.preventDefault(),e.stopPropagation(),this.toggleAudioTrace()):this.audioTraceActive&&(this.sliderTraceActive?this.sliderTraceKeydown(e):(this.stopAnimations(),this.audioTraceKeydown(e)))}sliderTraceKeydown(e){let t=e.altKey||e.metaKey,r=!t&&!e.ctrlKey&&!e.shiftKey;r&&ke(e)===ld||Ko(e)==="J"?(e.preventDefault(),e.stopPropagation(),this.decrementSliderValue()):r&&ke(e)===cd||Ko(e)==="L"?(e.preventDefault(),e.stopPropagation(),this.incrementSliderValue()):r&&ke(e)===Au?(e.preventDefault(),e.stopPropagation(),this.decrementBigSliderValue()):r&&ke(e)===Iu?(e.preventDefault(),e.stopPropagation(),this.incrementBigSliderValue()):!t&&(ke(e)===Kn||!e.shiftKey&&ke(e)===rl||Ko(e)==="K")?(e.preventDefault(),e.stopPropagation(),this.nextSlider()):!t&&(ke(e)===xa||e.shiftKey&&ke(e)===rl||Ko(e)==="I")?(e.preventDefault(),e.stopPropagation(),this.prevSlider()):r&&ke(e)===wg||Ko(e)==="U"?(e.preventDefault(),e.stopPropagation(),this.sliderMin()):r&&ke(e)===fp||Ko(e)==="N"?(e.preventDefault(),e.stopPropagation(),this.sliderMax()):this.audioTraceKeydown(e)}audioTraceKeydown(e){let t=e.altKey||e.metaKey,r=t&&!e.ctrlKey&&!e.shiftKey,n=!t&&!e.ctrlKey&&!e.shiftKey,i=Ko(e);if(ke(e)===xa&&r)e.preventDefault(),e.stopPropagation(),Si(),this.agNavigator.prevCurve();else if(ke(e)===Kn&&r)e.preventDefault(),e.stopPropagation(),Si(),this.agNavigator.nextCurve();else if(n&&ke(e)===ld||ke(e)===xa||i==="J")e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"keypad/audio-trace",command:"previous-point"});else if(n&&ke(e)===cd||ke(e)===Kn||i==="L")e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"keypad/audio-trace",command:"next-point"});else if(!t&&(ke(e)===Au||!e.shiftKey&&ke(e)===rl||i==="I"))e.preventDefault(),e.stopPropagation(),this.reportAndMoveToNextPOI();else if(!t&&(ke(e)===Iu||e.shiftKey&&ke(e)===rl||i==="K"))e.preventDefault(),e.stopPropagation(),this.reportAndMoveToPrevPOI();else if(n&&ke(e)===wg||i==="U")e.preventDefault(),e.stopPropagation(),this.reportAndMoveToFirstPoint();else if(n&&ke(e)===fp||i==="N")e.preventDefault(),e.stopPropagation(),this.reportAndMoveToLastPoint();else if(n&&i==="X")e.preventDefault(),e.stopPropagation(),this.reportX();else if(n&&i==="P")e.preventDefault(),e.stopPropagation(),this.reportPOICount();else if(n&&i==="Y")e.preventDefault(),e.stopPropagation(),this.reportY();else if(n&&i==="T")e.preventDefault(),e.stopPropagation(),this.reportType();else if(n&&i==="B")e.preventDefault(),e.stopPropagation(),this.reportBranch();else if(n&&i==="O")e.preventDefault(),e.stopPropagation(),this.reportAndMoveToOrigin();else if(n&&i==="H")e.preventDefault(),e.stopPropagation(),this.hearGraph();else if(n&&typeof i=="string"&&i>="0"&&i<="9"){if(e.preventDefault(),e.stopPropagation(),Si(),!this.controller.getAudio()){xe(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}this.agSynthesizer.stop();let o=this.agNavigator.getCurrentSketch();if(o){let a;e.which===48?a=9:a=e.which-49;let s=a,l=-1;for(let c=0;c<o.branches.length;c++)if(kc(o.branches[c],this.grapher.settings.config.audioTraceSimult)&&(s-=1),s<0){l=c;break}l>=0?this.agSynthesizer.getPlaybackSupported()?(this.agSynthesizer.playBranchByIndex(l),this.grapher.traceLayer.setTraceInfo(void 0),this.graphAnimationTimeoutId=requestAnimationFrame(()=>this.animateCurrentSketchLine())):xe(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play")):xe(this.controller.s("graphing-calculator-narration-audio-trace-branch-not-found",{branch:a+1}))}else xe(this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected"))}else t&&typeof i=="string"&&i>="1"&&i<="5"?(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-audio-trace-speed",speed:parseInt(i,10)+3})):!e.altKey&&!e.ctrlKey&&!e.metaKey&&i==="V"?(e.preventDefault(),e.stopPropagation(),this.controller.getAudio()?e.shiftKey?this.controller.dispatch({type:"keypad/audio-trace",command:"volume-down"}):this.controller.dispatch({type:"keypad/audio-trace",command:"volume-up"}):xe(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play"))):n&&i==="A"?(e.preventDefault(),e.stopPropagation(),Si(),this.queueAnimatingPoints(!0),xe()):n&&i==="S"&&this.controller.isListEnabled()?(e.preventDefault(),e.stopPropagation(),this.toggleSliderTrace()):n&&i==="C"?(e.preventDefault(),e.stopPropagation(),this.reportColor()):n&&this.exitAudioTrace();this.controller.dispatch({type:"render"})}describeCurve(){Si();let e=this.agNavigator.getCurrentSketch();if(!e){xe(this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected"));return}yt(this.controller.s("graphing-calculator-narration-audio-trace-description-color",{color:md(this.controller,e.color)}));let t=_v(e,e.branches.length-1,this.grapher.settings.config.audioTraceSimult);t>1&&yt(this.controller.s("graphing-calculator-narration-audio-trace-description-branch-count",{branches:t}));let r=!1,n=!1;for(let o of e.branches)if(t===1&&o.segments.length>0&&o.hasOwnProperty("operator")){if(o.graphMode===2){if(o.operator===">"||o.operator===">="){yt(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-above"));break}else if(o.operator==="<"||o.operator==="<="){yt(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-below"));break}}else if(o.graphMode===1){if(o.operator===">"||o.operator===">="){yt(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-right"));break}else if(o.operator==="<"||o.operator==="<="){yt(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-left"));break}}}else t>1&&(o.graphMode===2||o.graphMode===1?(o.operator==="<"||o.operator==="<="||o.operator===">"||o.operator===">=")&&(r=!0):o.graphMode===7&&(n=!0));r&&n&&yt(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-in-regions"));let i=e.getPOI();if(i.length>0){let o=[];for(let a of i)o[a.type]===void 0?o[a.type]=1:o[a.type]+=1;o.forEach((a,s)=>{s===1001?yt(a===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-intersection"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-intersections",{count:a})):s===1002?yt(a===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-root"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-roots",{count:a})):s===1003?yt(a===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-intercept"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-intercepts",{count:a})):s===1004?yt(a===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-extremum"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-extrema",{count:a})):s===1008&&yt(a===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-label"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-labels",{count:a}))})}xe()}describeAxes(){Si(),xe(Iv(this.controller))}queueCoordinates(e){if(!this.grapher.getProjection().viewport||!e)return;let t=this.agNavigator.getCurrentSketch();e.hasOwnProperty("branch")&&t&&t.branches.length>1&&this.lastSpokenBranch!==e.reportedBranch&&this.queueCoordinateProp(e,"branch"),e.hasOwnProperty("type")&&yt(this.controller.s("graphing-calculator-narration-audio-trace-property-type-before-coordinates",{type:this.describePOI(e)})),e.graphMode===25||e.graphMode===26?yt(Ao(__dcg_shared_module_exports__.pa([e.x,e.y]))):(this.queueCoordinateProp(e,"x"),this.queueCoordinateProp(e,"y"))}queueCoordinateProp(e,t){if(this.grapher.getProjection().viewport&&e)switch(t){case"branch":typeof e.reportedBranch=="number"&&yt(this.controller.s("graphing-calculator-narration-audio-trace-property-branch-number",{branch:e.reportedBranch}));break;case"type":yt(this.describePOI(e));break;case"x":yt(Bl(this.controller,e.x));break;case"y":yt(Ul(this.controller,e.y));break;default:let r=t;throw new Error(`Unexpected prop ${r}`)}}describePOI(e){if(e!=null&&e.typeChain){let t=[];for(let r=0;r<e.typeChain.length;r++)t.push(this.poiTypeToText(e,r));return Cd(this.controller.getLanguage(),t)}else return this.poiTypeToText(e)}poiTypeToText(e,t){switch(t&&e.typeChain?e.typeChain[t]:e.type){case 1001:let r=this.getIntersectingCurves(e);return r!==""?this.controller.s("graphing-calculator-narration-audio-trace-point-type-intersection-with-curves",{curves:r}):this.controller.s("graphing-calculator-narration-audio-trace-point-type-intersection");case 1002:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-root");case 1003:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-intercept");case 1004:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-extremum");case 1006:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-definition");case 1007:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-trace");case 1008:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-label");default:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-not-a-poi")}}getIntersectingCurves(e){return!e||!e.intersects?"":this.getExpressionAriaLabel(e.intersects)}getExpressionAriaLabel(e){var t;let r=this.controller.getItemModel(e);return r?r.type==="expression"&&r.label?ei(r.label):r.type==="table"&&((t=this.focusedTableLocation)==null?void 0:t.type)==="cell"?this.controller.s("graphing-calculator-narration-audio-trace-expression-with-column",{index:r.displayIndex,column:this.focusedTableLocation.location.column+1}):Xr(r,"describe"):""}exitAudioTrace(e){var t;if(this.audioTraceActive){if(this.audioTraceActive=!1,this.controller.isKeypadEnabled()&&this.controller.dispatch({type:"keypad/123"}),e||(e=this.controller.s("graphing-calculator-text-audio-trace-off")),this.controller.dispatch({type:"toast/close"}),this.wasFocusInExpressionsView){let r=this.controller.getSelectedItem();if((!r||!this.controller.isItemSelectable(r.id))&&(r=this.controller.getFirstFullyVisibleItem()),r&&this.controller.isItemSelectable(r.id)){let n={type:"move-focus-to-item",id:r.id,where:"end"};if(r.type==="table")switch((t=this.focusedTableLocation)==null?void 0:t.type){case"cell":n.where=R({location:"cell"},this.focusedTableLocation.location),this.focusedTableLocation.location.column===1&&this.enteredAudioTraceWithFirstTableColumnFocused&&(n.where.column=0);break;case"table-regression":n={type:"set-focus-location",location:{type:"table-regression-type-dropdown",id:r.id}}}this.controller.dispatch(n)}}this.wasFocusInExpressionsView=!1,this.focusedTableLocation=void 0,this.stopAnimations(),this.sliderTraceActive=!1,this.sliderIndex=0,this.agSynthesizer.stop(),this.agSynthesizer.releaseAudio(),this.agNavigator.reset(),this.lastSpokenBranch=1,this.grapher.traceLayer.setTraceInfo(void 0),this.grapher.traceLayer.setTraceLine(void 0),this.controller.requestRedrawGraph(),this.enteredAudioTraceWithFirstTableColumnFocused=!1,xe(e),this.resumeAnimations()}}isFocusInExpressionsView(){var e;return!!((e=document.activeElement)!=null&&e.closest(".dcg-exppanel-container"))}canAudioTraceCurrentExp(){let e=this.controller.getSelectedItem();return e?e.type==="table"?!!this.agNavigator.getCurrentSketch():this.agNavigator.canTrace(e):!1}enterAudioTrace(e){var t,r;let n=this.controller.getSelectedItem(),i=n&&n.type!=="table"&&!this.agNavigator.canTrace(n)?this.getExpressionAriaLabel(n.id):void 0,o=!1;this.audioTraceActive||(this.wasFocusInExpressionsView=this.isFocusInExpressionsView(),n&&i&&yt(this.controller.s("graphing-calculator-narration-audio-trace-unsupported-expression",{expression:i})),o=!!i||!this.wasFocusInExpressionsView);let a;if(o)a=this.agNavigator.getFirstTraceableSketch({selectAssociatedExpression:!0});else if(!i){if(n&&n.type==="expression"&&n.formula&&n.formula.error)return this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected")}});if(n&&n.type==="table"){if(!this.focusedTableLocation){let s=wa(n),l=this.controller.getFocusLocation();l!=null&&l.type.startsWith("table-regression")||(t=document.activeElement)!=null&&t.closest(".dcg-table-regression")?this.setFocusedTableLocation({tableId:n.id,type:"table-regression",location:void 0}):(this.enteredAudioTraceWithFirstTableColumnFocused=(s==null?void 0:s.column)===0,this.setFocusedTableLocation(s?{tableId:n.id,type:"cell",location:{column:s.column||1,row:s.row}}:void 0))}}else this.enteredAudioTraceWithFirstTableColumnFocused=!1,this.setFocusedTableLocation(void 0);a=this.agNavigator.getCurrentSketch()}if(!a){this.agNavigator.reset(),this.lastSpokenBranch=1,this.exitAudioTrace(),a=this.agNavigator.getCurrentSketch();let s=a==null?void 0:a.branches[0].graphMode;return s===8&&!this.grapher.settings.config.audioTraceSimult?(this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-no-implicit-support")}})):s===5&&!this.grapher.settings.config.audioTraceSimult?(this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-no-parametric-support")}})):s===6&&!this.grapher.settings.config.audioTraceSimult?(this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-no-polar-support")}})):this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected")}})}if((r=this.controller.toneController)==null||r.handleAction({type:"mute-global"}),this.agNavigator.reset(),this.agNavigator.computeStepSizes(),this.lastSpokenBranch=1,this.grapher.traceLayer.clearOpenedPOI(),this.controller.requestRedrawGraph(),!this.audioTraceActive&&(this.controller.isKeypadEnabled()||this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-on"),noAria:!0,onHide:()=>this.exitAudioTrace(),hideAfter:0}}),i&&a&&yt(this.controller.s("graphing-calculator-narration-audio-trace-tracing-different-expression",{expression:this.getExpressionAriaLabel(this.focusedTableLocation?this.focusedTableLocation.tableId:a.id)})),yt(this.controller.s("graphing-calculator-text-audio-trace-on")),this.controller.getAudio()||yt(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled")),this.pauseAnimations(),this.queueAnimatingPoints(!1),this.agSynthesizer.prepareSynthesizer(),(!e||!e.fromKeypad)&&(yt(this.controller.s("graphing-calculator-narration-audio-trace-instructions-use-arrow-keys")),this.controller.getAudio()&&yt(this.controller.s("graphing-calculator-narration-audio-trace-instructions-hear-graph")),this.agNavigator.getTraceableExpressionCount()>1&&yt(Zo?this.controller.s("graphing-calculator-narration-audio-trace-instructions-expression-navigation-mac"):this.controller.s("graphing-calculator-narration-audio-trace-instructions-expression-navigation-windows")),yt(Zo?this.controller.s("graphing-calculator-narration-audio-trace-instructions-disable-mac"):this.controller.s("graphing-calculator-narration-audio-trace-instructions-disable-windows"))),this.wasFocusInExpressionsView)){let s=this.controller.findEl(".dcg-graph-outer");s&&(ee(s).one("focusin",()=>{setTimeout(()=>{xe()},0)}),this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}}))}this.agNavigator.moveToOrigin(),yt(this.getExpressionAriaLabel(a.id)),this.reportAudioTrace({playSound:!1}),this.wasFocusInExpressionsView||xe(),this.audioTraceActive=!0,this.controller.isKeypadEnabled()&&this.controller.dispatch({type:"keypad/audio"})}checkIfSelectedItemChanged(e){this.lastSelectedId!==e&&(this.lastSelectedId=e,this.audioTraceActive&&(e?(yt(this.getExpressionAriaLabel(e)),this.exitSliderTrace(),this.agNavigator.updatePOI(),this.agNavigator.moveToOrigin(),this.reportAudioTrace(),xe()):this.exitAudioTrace()))}pauseAnimations(){this.sliderArray.length=0,this.controller.getAllModelsWithSliders().forEach(e=>{e.slider.isPlaying&&(this.controller.dispatch({type:"set-slider-isplaying",id:e.id,isPlaying:!1}),this.sliderArray.push(e))})}resumeAnimations(){if(this.sliderArray.length!==0){for(let e=0;e<this.sliderArray.length;e++){let t=this.sliderArray[e];t.slider.isPlaying!==!0&&this.controller.dispatch({type:"set-slider-isplaying",id:t.id,isPlaying:!0})}this.sliderArray.length=0}}stopAnimations(){this.controller.getAllModelsWithSliders().forEach(e=>{e.slider.isPlaying&&this.controller.dispatch({type:"set-slider-isplaying",id:e.id,isPlaying:!1})})}hasActiveSliders(){let e=this.controller.getAllModelsWithSliders();for(let t=0;t<e.length;t++)if(e[t].slider.isPlaying)return!0;return!1}queueAnimatingPoints(e){this.sliderArray.length===1?yt(this.controller.s("graphing-calculator-narration-audio-trace-one-slider-paused")):this.sliderArray.length>1?yt(this.controller.s("graphing-calculator-narration-audio-trace-multiple-sliders-paused",{sliders:this.sliderArray.length})):e&&yt(this.controller.s("graphing-calculator-narration-audio-trace-no-sliders-paused"))}queueSliderLatex(){this.hasActiveSliders()||this.agSynthesizer.stop();let e=this.getSelectedSlider();yt(e?e.latex:this.controller.s("graphing-calculator-narration-audio-trace-slider-value-unknown"))}getSelectedSlider(){let e=this.controller.getAllModelsWithSliders();return this.sliderIndex<=e.length-1?e[this.sliderIndex]:null}incrementSliderValue(){this.adjustSlider("up")}decrementSliderValue(){this.adjustSlider("down")}incrementBigSliderValue(){this.adjustSlider("bigup")}decrementBigSliderValue(){this.adjustSlider("bigdown")}nextSlider(){this.adjustSlider("next")}prevSlider(){this.adjustSlider("prev")}sliderMin(){this.adjustSlider("min")}sliderMax(){this.adjustSlider("max")}adjustSlider(e){let t=this.getSelectedSlider();if(!t){yt(this.controller.s("graphing-calculator-narration-audio-trace-cannot-change-slider-value"));return}let r=t.latex,n=this.controller.getAllModelsWithSliders().length;switch(e){case"up":case"down":case"bigup":case"bigdown":case"min":case"max":this.controller.dispatch({type:"adjust-slider-by-keyboard",id:t.id,adjustment:e}),this.queueSliderLatex(),xe();break;case"next":this.sliderIndex++,this.sliderIndex>=n&&(yt(this.controller.s("graphing-calculator-narration-audio-trace-last-slider")),this.sliderIndex=n-1),this.queueSliderLatex(),xe();return;case"prev":this.sliderIndex--,this.sliderIndex<0&&(yt(this.controller.s("graphing-calculator-narration-audio-trace-first-slider")),this.sliderIndex=0),this.queueSliderLatex(),xe();return}!t.slider.isPlaying&&r!==t.latex&&(this.queueSliderLatex(),xe())}toggleAudioTrace(){this.audioTraceActive?this.exitAudioTrace():this.enterAudioTrace()}toggleSliderTrace(){this.sliderTraceActive?this.exitSliderTrace():this.enterSliderTrace()}enterSliderTrace(){this.sliderTraceActive||(this.sliderIndex=0,this.controller.getAllModelsWithSliders().length!==0?(yt(this.controller.s("graphing-calculator-narration-slider-trace-on")),this.queueSliderLatex(),this.sliderTraceActive=!0):(yt(this.controller.s("graphing-calculator-narration-slider-trace-no-sliders")),this.sliderTraceActive=!1),xe())}exitSliderTrace(){this.sliderTraceActive&&(yt(this.controller.s("graphing-calculator-narration-slider-trace-off")),this.sliderTraceActive=!1,this.sliderIndex=0,xe())}recomputePoints(){!this.audioTraceActive||this.agSynthesizer.getIsPlaying()||(this.agNavigator.updatePOI(),this.agNavigator.updateSampledPoints(),this.agNavigator.updateCurrentPoint(),this.agNavigator.resetTracePoint(),this.agNavigator.computeStepSizes())}reportAndMoveToPrevPoint(){Si(),this.agNavigator.prevPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToNextPoint(){Si(),this.agNavigator.nextPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToOrigin(){Si(),this.agNavigator.moveToOrigin(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToPrevPOI(){Si(),this.agNavigator.prevPOI(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToNextPOI(){Si(),this.agNavigator.nextPOI(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToFirstPoint(){Si(),this.agNavigator.firstPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToLastPoint(){Si(),this.agNavigator.lastPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportX(){Si(),this.reportAudioTrace({propToSpeak:"x",playSound:!1})}reportY(){Si(),this.reportAudioTrace({propToSpeak:"y",playSound:!1})}reportColor(){Si();let e=this.agNavigator.getCurrentSketch();yt(e?md(this.controller,e.color):this.controller.s("graphing-calculator-narration-color-unknown")),xe()}reportPOICount(){Si();let e=this.agNavigator.getCurrentSketch(),t=e?e.getPOI().length:0;xe(this.controller.s("graphing-calculator-narration-audio-trace-poi-count",{x:t}))}reportType(){Si(),this.reportAudioTrace({propToSpeak:"type",playSound:!1})}reportBranch(){Si(),this.reportAudioTrace({propToSpeak:"branch",playSound:!1})}describePoint(){Si(),this.reportAudioTrace({playSound:!1}),xe()}playCurrentPoint(){let e=this.agNavigator.getCurrentPoint();e&&this.agSynthesizer.playPoint(e)}reportAudioTrace(e){var t,r;let n=this.agNavigator.getCurrentPoint();if(!n)return;let i=e==null?void 0:e.propToSpeak,o=this.controller.getAudio()&&this.agSynthesizer.getPlaybackSupported()&&((t=e==null?void 0:e.playSound)!=null?t:!0),a=(r=e==null?void 0:e.speakCoordinates)!=null?r:!0;this.agSynthesizer.stop(),o&&this.playCurrentPoint(),a&&(i?this.queueCoordinateProp(n,i):this.queueCoordinates(n),this.lastSpokenBranch=n.reportedBranch?n.reportedBranch:n.branch+1,setTimeout(()=>{xe()},i?0:100))}adjustPlaybackSpeed(e){if(!this.controller.getAudio()){xe(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}if(e<0||e>=Mv.length)return;this.audioSpeedIndex=e;let t=Mv[e];return this.agSynthesizer.setAudioSpeed(t.speed),xe(this.controller.s("graphing-calculator-narration-audio-trace-playback-speed",{speed:t.displayedSpeed}))}speedUp(){this.adjustPlaybackSpeed(this.audioSpeedIndex+1)}speedDown(){this.adjustPlaybackSpeed(this.audioSpeedIndex-1)}adjustVolume(e){if(Si(),!this.controller.getAudio()){xe(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}let t=this.agSynthesizer.getAudioVolume(),r=e==="up"?Math.min(100,Math.round((t+.1)*100)):Math.max(0,Math.round((t-.1)*100));this.agSynthesizer.setAudioVolume(r/100),this.playCurrentPoint(),xe(this.controller.s("graphing-calculator-narration-audio-trace-volume",{volume:r}))}getFocusedTableLocation(){return this.focusedTableLocation}setFocusedTableLocation(e){this.focusedTableLocation=e}getAudioTraceActive(){return this.audioTraceActive}isAudioTracing(){return!!this.agSynthesizer&&this.agSynthesizer.getIsPlaying()}handleEvaluatorChange(e){}hearGraph(){var e,t;if(Si(),!this.controller.getAudio()){xe(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}if(this.agSynthesizer.getPlaybackSupported()){this.agSynthesizer.stop();let r=this.agNavigator.getCurrentSketch();if((t=(e=this.controller).logEvent)==null||t.call(e,{category:"audio-trace",action:"hear-graph"}),r&&ul(this.controller,r)){let n=this.grapher.settings.config.audioTraceSimult?"simultaneous":"sequential";this.agSynthesizer.playCurrentSketch(n),n==="simultaneous"?(this.grapher.traceLayer.setTraceInfo(void 0),requestAnimationFrame(()=>this.animateCurrentSketchLine())):(this.grapher.traceLayer.setTraceLine(void 0),requestAnimationFrame(()=>this.animateCurrentSketchPoint()))}else xe(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-trace-this-expression"))}else xe(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play"))}animateCurrentSketchPoint(){if(this.graphAnimationTimeoutId&&cancelAnimationFrame(this.graphAnimationTimeoutId),this.graphAnimationTimeoutId=requestAnimationFrame(()=>this.animateCurrentSketchPoint()),!this.agSynthesizer.getIsPlaying())return;let e=this.agSynthesizer.getCurrentIndependentValue(),t=this.agSynthesizer.getCurrentBranchIndex();e!==void 0&&t!==void 0&&this.agNavigator.drawTracePoint(this.agNavigator.getPoint(t,e))}animateCurrentSketchLine(){if(this.graphAnimationTimeoutId&&cancelAnimationFrame(this.graphAnimationTimeoutId),this.graphAnimationTimeoutId=requestAnimationFrame(()=>this.animateCurrentSketchLine()),!this.agSynthesizer.getIsPlaying())return;let e=this.agSynthesizer.getCurrentIndependentValue();e!==void 0&&this.agNavigator.drawTraceLine(e,this.agSynthesizer.getGraphMode())}stopGraph(){this.agSynthesizer.stop(),this.graphAnimationTimeoutId&&cancelAnimationFrame(this.graphAnimationTimeoutId)}getAudioSpeedIndex(){return this.audioSpeedIndex}getAudioVolume(){var e;return(e=this.agSynthesizer.getAudioVolume())!=null?e:.5}},GD=class{redrawToCtx(e,t){let{ctx:r,projection:n}=e;if(!t)return;r.save(),r.lineWidth=2,r.fillStyle="rgba(0,0,0,.15)",r.strokeStyle="rgba(0,0,0,.4)";let i=n.mapx(t.left),o=n.mapy(t.top),a=n.mapx(t.right),s=n.mapy(t.bottom),l=a-i,c=s-o;r.fillRect(i,o,l,c),r.strokeRect(i,o,l,c),r.restore()}},uy={};uy.vpmax8={width:170,height:220,margins:{left:5,top:15,right:5,bottom:50}},uy.vpmax11={width:230,height:220,margins:{left:15,top:15,right:5,bottom:5}},uy.etc8={width:96,height:96,margins:{left:5,top:15,right:0,bottom:0}},uy.etc11={width:132,height:134,margins:{left:10,top:15,right:5,bottom:5}};var Rs=class{constructor(e,t,r){this.screen=e,this.viewport=t,this.settings=r,this.mathCoordinates=__dcg_shared_module_exports__.id(t),this.pixelCoordinates=__dcg_shared_module_exports__.hd(e),this.updateScalePairs()}updateScalePairs(){let{xAxisScale:e,yAxisScale:t}=this.settings;this.mathToPixels=__dcg_shared_module_exports__.jd.fromRects(this.mathCoordinates,this.pixelCoordinates,{xAxisScale:e,yAxisScale:t}),this.pixelsToMath=this.mathToPixels.inverse()}mapx(e){return this.mathToPixels.mapX(e)}mapy(e){return this.mathToPixels.mapY(e)}reverse_mapx(e){return this.pixelsToMath.mapX(e)}reverse_mapy(e){return this.pixelsToMath.mapY(e)}mapAlongAxis(e,t){switch(t){case"x":return this.mapx(e);case"y":return this.mapy(e);default:{let r=t;throw new Error(`Unknown axis: ${r}`)}}}reverseMapAlongAxis(e,t){switch(t){case"x":return this.reverse_mapx(e);case"y":return this.reverse_mapy(e);default:{let r=t;throw new Error(`Unknown axis: ${r}`)}}}map_pt(e){return this.mathToPixels.mapPoint(e)}map_xy_pairs(e){let t=[];for(let r=0;r<e.length;r+=2)t.push(this.mapx(e[r])),t.push(this.mapy(e[r+1]));return t}reverse_map_pt(e){return this.pixelsToMath.mapPoint(e)}coordsAreOnscreen(e,t,r=0){return e>-r&&t>-r&&e<this.screen.width+r&&t<this.screen.height+r}closestPointOnScreen(e){let t=this.pixelCoordinates;return{x:Math.min(Math.max(e.x,t.left),t.right),y:Math.min(Math.max(e.y,t.top),t.bottom)}}},hl=class{constructor(e,t){this.width=e,this.height=t}},Rie=10240;function Fie(e,t,r,n,i){let{dotSpacing:o}=e,a=1+o,s=i.charCodeAt(0)-Rie;s&1&&t.fillRect(r,n,1,1),s&2&&t.fillRect(r,n+a,1,1),s&4&&t.fillRect(r,n+2*a,1,1),s&8&&t.fillRect(r+a,n,1,1),s&16&&t.fillRect(r+a,n+a,1,1),s&32&&t.fillRect(r+a,n+2*a,1,1)}function VD(e,t){let{x:r,y:n,width:i,height:o}=t,a=e.getImageData(r,n,i,o).data;for(let s=3;s<a.length;s+=4)if(a[s]!==0)return!1;return!0}function Nie(e,t){let{x:r,y:n,width:i,height:o}=t,a=e.getImageData(r,n,i,o).data;for(let s=3;s<a.length;s+=4)if(a[s]===0)return!1;return!0}function YP(e,t,r,n,i){return VD(t,RD(e,r,n,i))}function Bie(e,t,r,n,i){let{dotSpacing:o}=e,a=3+2*o;for(let s=0;s<i.length;s++)Fie(e,t,r+a*s,n,i[s])}function zp(e,t){let{dotSpacing:r}=e;return(2+r)*t.length+(1+r)*(t.length-1)}function OD(e,t){let{dotSpacing:r}=e;return 3+2*r}function RD(e,t,r,n){let{cellPadding:i}=e;return{x:t-i,y:r-i,width:zp(e,n)+2*i,height:OD(e)+2*i}}function LD(e,t){if(!e)return t;let r=Math.min(e.x,t.x),n=Math.min(e.y,t.y),i=Math.max(e.x+e.width,t.x+t.width)-r,o=Math.max(e.y+e.height,t.y+t.height)-n;return{x:r,y:n,width:i,height:o}}function JK(e,t,r){return Math.min(Math.max(e,t),r)}function Gv(e,t,r,n,i){return{x:JK(r,0,t.canvas.width-zp(e,i)),y:JK(n,0,t.canvas.height-OD(e))}}function Lv(e,t,r,n,i){let o=t.fillStyle;t.fillStyle="white";let a=RD(e,r,n,i);t.fillRect(a.x,a.y,a.width,a.height),t.fillStyle="black",Bie(e,t,r,n,i),t.fillStyle=o}function XP(e,t,r,n){let{cellPadding:i}=e;return{x:Math.round(t-(zp(e,n)+i)),y:r}}function Uie(e){return e.replace(/\u283C(?!$)/g,"")}function Up(e,t){let r=t==="nemeth"?lp(e):cp(e);return r.isError?"":Uie(r.value)}function gy(e,t){return t>=0?e*Math.pow(10,t):e/Math.pow(10,-t)}function ZK(e,t,r,n){let[i,o]=r,a=Math.ceil(Math.log(o-i)/Math.LN10)-1,s=a,l=5,c=15;e:for(let d=a;a-d<4;d--)for(let u of[5,2,1]){let p=gy(u,d),g=Math.floor(i/p)+1,f=Math.ceil(o/p)-1,y=Math.abs(n(p)-n(0)),E=Up(String(gy(g*u,d)),t),_=Up(String(gy(f*u,d)),t);if(y<zp(e,E)+zp(e," ")||y<zp(e,_)+zp(e," ")||f-g>=c)break e;s=d,l=u}return{int:l,exp:s}}function e6(e,t,r){return ZK(e,t,[r.viewport.xmin,r.viewport.xmax],n=>r.mapx(n))}function zie(e,t,r){return r.viewport.isSquare(r.screen,{xAxisScale:r.settings.xAxisScale,yAxisScale:r.settings.yAxisScale})?e6(e,t,r):ZK(e,t,[r.viewport.ymin,r.viewport.ymax],n=>r.mapy(n))}function QK(e,t){let{int:r,exp:n}=e,[i,o]=t,a=Math.ceil(i/gy(r,n)),s=Math.floor(o/gy(r,n)),l=[];for(let c=a;c<=s;c++)l.push(gy(c*r,n));return l}function qie(e,t,r){return{x:QK(e6(e,t,r),[r.viewport.xmin,r.viewport.xmax]),y:QK(zie(e,t,r),[r.viewport.ymin,r.viewport.ymax])}}function t6(e,t,r,n,i,o){if(r.margins===void 0||t===void 0)return;let a=Hie(n),s=r.margins,l=R({},t.settings),c=l.showGrid&&Kie(n),d=!!l.showXAxis,u=!!l.showYAxis,p=!!l.xAxisNumbers,g=l.xAxisArrowMode,f=!!l.yAxisNumbers,y=l.yAxisArrowMode,E=a.graphLineWidth,_={showGrid:!1,xAxisNumbers:!1,xAxisArrowMode:"NONE",yAxisNumbers:!1,yAxisArrowMode:"NONE",showXAxis:!1,showYAxis:!1,graphLineWidth:E,pointLineWidth:2.5,curveOpacity:1,globalCurveColor:"#000",disableFill:!0};for(let W in _)t.settings[W]=_[W];let w=e.width-s.right-s.left,v=e.height-s.top-s.bottom,T=new hl(w,v),M=t.getProjection().viewport;t.settings.squareAxes&&(M=M.squareCrop(T,t.settings));let C=new Rs(T,M,t.settings),P=e.getContext("2d"),F=document.createElement("canvas");F.width=w,F.height=v;let B=F.getContext("2d"),x=document.createElement("canvas");x.width=w,x.height=v;let L=x.getContext("2d"),N=document.createElement("canvas");N.width=w,N.height=v;let O=N.getContext("2d"),z=document.createElement("canvas");z.width=w,z.height=v;let V=z.getContext("2d"),$=document.createElement("canvas");$.width=w,$.height=v;let G=$.getContext("2d");if(P!==null&&V!==null&&B!==null&&O!==null&&G!==null&&L!==null){t.settings.disableFill=!0,t.screenshotToCanvas(z,{width:w,height:v,targetPixelRatio:1,transparentBackground:!0,showMovablePoints:o}),t.settings.disableFill=!1,t.screenshotToCanvas(F,{width:w,height:v,targetPixelRatio:1,transparentBackground:!0,showMovablePoints:o}),P.fillStyle="white",P.fillRect(0,0,e.width,e.height);let W=Math.round(C.mapx(0)),U=Math.round(C.mapy(0)),D=l.xAxisLabel!==""?l.xAxisLabel.replace(/ /g,"\\ "):"x",de=l.yAxisLabel!==""?l.yAxisLabel.replace(/ /g,"\\ "):"y",ge=1;if(d&&C.coordsAreOnscreen(w-6,U-8,0)){let H=ie(R({},a),{cellPadding:a.cellPadding+ge}),Z=2+2*OD(H),ce=w-2,Re=U-Z,he=Up(D,i);({x:ce,y:Re}=XP(H,ce,Re,he)),{x:ce,y:Re}=Gv(H,B,ce,Re,he),Lv(H,G,ce,Re,he)}if(u&&C.coordsAreOnscreen(W+4,1,0)){let H=ie(R({},a),{cellPadding:a.cellPadding+ge}),Z=W+4,ce=1,Re=Up(de,i);({x:Z,y:ce}=Gv(H,B,Z,ce,Re)),Lv(H,G,Z,ce,Re)}let{x:K,y:se}=qie(a,i,C);if(d){let H;for(let Z of K){if(Z===0&&u)continue;let ce=Math.round(C.mapx(Z));if(!(ce<2||ce>C.screen.width-2)&&p){let Re=zp(a,Up("-1",i))-zp(a,Up("1",i)),he=Z<0?Re+1:1,Ie=ce-he,Ee=U+4,Be=Up(""+Z,i);({x:Ie,y:Ee}=Gv(a,G,Ie,Ee,Be)),YP(a,V,Ie,Ee,Be)&&(Lv(a,G,Ie,Ee,Be),H=LD(H,RD(a,Ie,Ee,Be)))}}a.embossPatternInequalities&&H&&(H=LD(H,{x:0,y:U,width:w,height:0}),O.fillStyle="white",O.fillRect(H.x,H.y,H.width,H.height))}if(u){let H;for(let Z of se){if(Z===0&&d)continue;let ce=Math.round(C.mapy(Z));if(ce<2||ce>C.screen.height-2)continue;let Re=-Math.ceil(OD(a)/2);if(f){let he=W-4,Ie=ce+Re,Ee=Up(""+Z,i);({x:he,y:Ie}=XP(a,he,Ie,Ee)),{x:he,y:Ie}=Gv(a,G,he,Ie,Ee),YP(a,V,he,Ie,Ee)&&(Lv(a,G,he,Ie,Ee),H=LD(H,RD(a,he,Ie,Ee)))}}a.embossPatternInequalities&&H&&(H=LD(H,{x:W,y:0,width:0,height:v}),O.fillStyle="white",O.fillRect(H.x,H.y,H.width,H.height))}if(d&&u){let H=W-2,Z=U+2,ce=Up(p||f?"0":"o",i);({x:H,y:Z}=XP(a,H,Z,ce)),C.coordsAreOnscreen(H,Z,0)&&({x:H,y:Z}=Gv(a,G,H,Z,ce),YP(a,V,H,Z,ce)&&Lv(a,G,H,Z,ce))}for(let H of K){let Z=Math.round(C.mapx(H));Z<2||Z>C.screen.width-2||u&&H===0||c&&Pv(O,"white",Z-1,0,v,3)}for(let H of se){let Z=Math.round(C.mapy(H));Z<2||Z>C.screen.height-2||d&&H===0||c&&Vv(O,"white",Z-1,0,w,3)}d&&Vv(O,"white",U-3,0,w,7),u&&Pv(O,"white",W-3,0,v,7);for(let H of K){let Z=Math.round(C.mapx(H));Z<2||Z>C.screen.width-2||u&&H===0||(c?Pv(O,PD(n),Z,0,v):d&&Pv(O,PD(n),Z,U-3,U+2))}for(let H of se){let Z=Math.round(C.mapy(H));Z<2||Z>C.screen.height-2||d&&H===0||(c?Vv(O,PD(n),Z,0,w):u&&Vv(O,PD(n),Z,W-3,W+2))}if(d&&Vv(O,hy(n),U,0,w),u&&Pv(O,hy(n),W,0,v),y!=="NONE"&&(Yie(O,hy(n),W,0),y==="BOTH"&&jie(O,hy(n),W,v-1)),g!=="NONE"&&(Wie(O,hy(n),w-1,U),g==="BOTH"&&$ie(O,hy(n),0,U)),a.embossPatternInequalities)for(let H=0;H<w;H+=6)for(let Z=0;Z<v;Z+=6){let ce={x:H,y:Z,width:3,height:3};Nie(B,ce)&&VD(O,ce)&&VD(V,ce)&&VD(G,ce)&&Xie(L,"black",H,Z)}a.embossPatternInequalities||P.drawImage(F,s.left,s.top),P.drawImage(N,s.left,s.top),P.drawImage(z,s.left,s.top),P.drawImage($,s.left,s.top),a.embossPatternInequalities&&P.drawImage(x,s.left,s.top)}for(let W in _)t.settings[W]=l[W]}function Hie(e){if(e==="etc8"||e==="etc11")return{dotSpacing:0,cellPadding:1,graphLineWidth:1.75,embossPatternInequalities:!0};if(e==="vpmax8"||e==="vpmax11")return{dotSpacing:1,cellPadding:2,graphLineWidth:1,embossPatternInequalities:!1};{let t=e;throw new Error(`Unexpected embosser model ${t}`)}}function Kie(e){if(e==="etc8"||e==="etc11")return!1;if(e==="vpmax8"||e==="vpmax11")return!0;{let t=e;throw new Error(`Unexpected embosser model ${t}`)}}function hy(e){switch(e){case"vpmax8":case"vpmax11":return"rgb(145, 145, 145)";case"etc8":case"etc11":return"rgb(0, 0, 0)";default:let t=e;throw new Error("Unexpected embosser model: "+t)}}function PD(e){switch(e){case"vpmax8":case"vpmax11":return"rgb(219, 219, 219)";case"etc8":case"etc11":return"rgb(0, 0, 0)";default:let t=e;throw new Error("Unexpected embosser model: "+t)}}function Pv(e,t,r,n,i,o=1){let a=e.fillStyle;e.fillStyle=t,e.fillRect(r-1,n,o,i-n),e.fillStyle=a}function Vv(e,t,r,n,i,o=1){let a=e.fillStyle;e.fillStyle=t,e.fillRect(n,r-1,i-n,o),e.fillStyle=a}function Wie(e,t,r,n){let i=e.fillStyle;e.fillStyle=t;for(let o=-2;o<=2;o++)e.fillRect(r-Math.abs(o),n-1+o,1,1);e.fillStyle=i}function $ie(e,t,r,n){let i=e.fillStyle;e.fillStyle=t;for(let o=-2;o<=2;o++)e.fillRect(r+Math.abs(o),n-1+o,1,1);e.fillStyle=i}function jie(e,t,r,n){let i=e.fillStyle;e.fillStyle=t;for(let o=-2;o<=2;o++)e.fillRect(r-1+o,n-Math.abs(o),1,1);e.fillStyle=i}function Yie(e,t,r,n){let i=e.fillStyle;e.fillStyle=t;for(let o=-2;o<=2;o++)e.fillRect(r-1+o,n+Math.abs(o),1,1);e.fillStyle=i}function Xie(e,t,r,n){let i=e.fillStyle;e.fillStyle=t,e.fillRect(r+1,n,1,1),e.fillRect(r,n+1,1,1),e.fillRect(r+1,n+1,1,1),e.fillRect(r+2,n+1,1,1),e.fillRect(r+1,n+2,1,1),e.fillStyle=i}__dcg_shared_module_exports__.e(ne());function JP(e,t){return`${e}_dcg_delim_${t}`}var Ov=class{constructor(e){this.hoveredObjects={},this.grapher=e,this.controller=this.grapher.controller,this.renderedTabTargetOrder=[],this.renderedTabTargets={}}getOrderedTabTargets(){return this.renderedTabTargetOrder.map(e=>{let t=this.renderedTabTargets[e];return{calcId:t.id,listIndex:t.listIndex,polygonEdge:void 0,description:t.description}})}recomputeClickableObjects(){this.renderedTabTargets={},this.renderedTabTargetOrder=[];for(let e of this.grapher.getTabOrder()){let t=this.controller.getItemModel(e);if(!t)continue;let r=this.grapher.getGraphSketch(e),n=this.grapher.getGraphImage(e);if(r&&t.type==="expression"&&$n(t))for(let i=0;i<r.branches.length;i++){let o=r.branches[i];if(!o.segments||o.segments.length===0)continue;let a=0;__dcg_shared_module_exports__._d(o)?r.getBranchPOI(i).forEach(s=>{a=s.pointIdxOnBranch||0,isFinite(s.x)&&isFinite(s.y)&&this.addTabTarget(t,a)}):(a="listIndex"in o&&o.listIndex!==void 0?o.listIndex:0,o.segments.length>0&&this.addTabTarget(t,a))}else if(n&&n.shouldGraph&&t.type==="image"&&Dg(t)){let i=t.formula&&t.formula.dimensions;if(!i||!i.x||!i.y||!i.width||!i.height||!i.radianAngle)continue;for(let o=0;o<i.x.length;o++)isFinite(i.x[o])&&isFinite(i.y[o])&&isFinite(i.width[o])&&isFinite(i.height[o])&&isFinite(i.radianAngle[o])&&this.addTabTarget(t,o)}}Object.keys(this.hoveredObjects).length||this.pressedObject?this.grapher.setLayerClass("clickableObjects","dcg-mouse-over-clickable-object"):this.grapher.setLayerClass("clickableObjects",void 0)}addTabTarget(e,t){let r=JP(e.id,t);this.renderedTabTargetOrder.indexOf(r)!==-1||this.renderedTabTargets[r]!==void 0||(this.renderedTabTargetOrder.push(r),this.renderedTabTargets[r]={type:e.type,id:e.id,listIndex:t,description:this.getComputedDescription(e,t)})}getTabIndex(e){if(this.controller.getActiveTool()!=="selection"||!this.renderedTabTargets[e])return-1;let t=this.grapher.settings;return!t.config.graphpaper||!t.config.enableTabindex?-1:0}getAriaHidden(){return!this.grapher.settings.config.graphpaper}getCachedDescription(e){return this.renderedTabTargets[e].description}getComputedDescription(e,t){let r=e.formula&&e.formula.computed_description&&e.formula.computed_description[t];return r&&r!==""?ei(r):this.grapher.getAudioTrace().getExpressionAriaLabel(e.id)}getModelId(e){let t=this.renderedTabTargets[e];return t?t.id:""}getListIndex(e){let t=this.renderedTabTargets[e];if(t)return t.listIndex}isKeyboardFocused(e,t){if(!e)return!1;let r=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention(),n=r==null?void 0:r.calcId;return e===n&&(t===void 0||t===(r==null?void 0:r.listIndex))}shouldDrawHovered(e,t,r){if(!t)return!1;if(this.isKeyboardFocused(t,r))return!0;let{translationPreviewVectorParents:n,rotationPreviewAngleMarkerParents:i}=e.transformationPreviewParentData;if(n.has(t)||i.has(t)&&!this.controller.isToolPreviewItem(t))return!0;if(this.isAnObjectPressed()&&!this.isObjectPressed(t))return!1;let o=this.getHoveredObjectById(t);return o?o.listIndexes===void 0||r===void 0?!0:!!o.listIndexes[r]:!1}setHoveredObjects(e){__dcg_shared_module_exports__.E(e,this.hoveredObjects)||(this.hoveredObjects=e,this.requestRedrawNextFrame())}getHoveredObjects(){let e=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention();if(e){let t=__dcg_shared_module_exports__.Jc(this.hoveredObjects),r=t[e.calcId],n=e.listIndex||0;return r?r.listIndexes?r.listIndexes[n]=!0:r.listIndexes={[n]:!0}:(r={listIndexes:{[n]:!0}},t[e.calcId]=r),t}else return this.hoveredObjects}getHoveredObjectById(e){return this.getHoveredObjects()[e]}shouldDrawPressed(e,t){if(!e)return!1;let r=this.pressedObject;return!r||r.id!==e?!1:t===void 0?!0:r.listIndex===t}isObjectPressed(e){return e===void 0?!1:!!(this.pressedObject&&this.pressedObject.id===e)}setPressedObject(e){!e&&!this.pressedObject||e&&this.pressedObject&&e.id===this.pressedObject.id&&e.listIndex===this.pressedObject.listIndex||(this.pressedObject=e,this.requestRedrawNextFrame())}getPressedObject(){return this.pressedObject}isAnObjectPressed(){return!!this.pressedObject}requestRedrawNextFrame(){this.controller.requestRedrawGraph()}shouldDrawGhosted(e){if(!e)return!1;let t=this.controller.getItemModel(e);return!t||t.type!=="expression"?!1:Hi(t)}},qp=__dcg_shared_module_exports__.e(ne()),{If:Qie}=qp.Components,FD=class extends qp.Class{init(){this.controller=this.props.grapher().controller,this.poiController=this.props.grapher().poiController}template(){return qp.createElement(Qie,{predicate:this.bindFn(this.showCursor)},()=>qp.createElement("div",{class:qp.const("dcg-geo-keyboard-cursor"),style:()=>({top:`${this.getPosition().y}px`,left:`${this.getPosition().x}px`})}))}getPosition(){let e=this.poiController.getGeoKeyboardPt(),t=this.props.grapher().getProjection();return{x:t.mapx(e.x),y:t.mapy(e.y)}}showCursor(){return this.controller.isVirtualMouseAllowed()}},r6=__dcg_shared_module_exports__.e(ne()),ka=__dcg_shared_module_exports__.e(ne()),{If:Zie}=ka.Components,ND=class extends ka.Class{init(){this.grapher=this.props.grapher(),this.controller=this.grapher.controller,this.width=0,this.height=0,this.pixelRatio=0}getDevicePixelRatio(){return window.devicePixelRatio||1}template(){return ka.createElement("div",{class:ka.const("dcg-graph-outer"),didMount:e=>this.rootNode=e,manageFocus:this.const(rt({controller:this.controller,location:{type:"graph-paper"}}))},ka.createElement("div",{tabIndex:()=>this.getShiftTabElementTabIndex(),onFocus:()=>{let e=this.rootNode.getAttribute("aria-label")||"";this.rootNode.setAttribute("aria-label",""),this.rootNode.focus(),this.rootNode.setAttribute("aria-label",e),this.controller.get2dPOIController().handleTabEvent("prev")}}),ka.createElement(Zie,{predicate:()=>this.isIOSAndIframe()},()=>ka.createElement("div",{style:ka.const("width:1px; height:.5px; pointer-events:none; opacity: 0;"),"aria-hidden":ka.const("true")},ka.const("text"))),ka.createElement("canvas",{class:ka.const("dcg-graph-inner"),didMount:e=>{this.canvasNode=e,this.ctx=this.canvasNode.getContext("2d"),this.resize(0,0)},style:()=>({position:"relative",display:"block",outline:"none","-webkit-transform":this.isIOSAndIframe()?"translate3d(0,-.25px,0)":void 0})}))}getShiftTabElementTabIndex(){var e;return((e=this.rootNode)==null?void 0:e.getAttribute("tabindex"))!=="0"||this.controller.getActiveTool()!=="selection"||this.rootNode===document.activeElement?"-1":"0"}isIOSAndIframe(){return Ml&&mp}resize(e,t,r){var n;r=r||this.getDevicePixelRatio(),!(e===this.width&&t===this.height&&r===this.pixelRatio)&&(this.width=e,this.height=t,this.canvasNode.style.width=e+"px",this.canvasNode.style.height=t+"px",this.canvasNode.setAttribute("width",""+e*r),this.canvasNode.setAttribute("height",""+t*r),this.pixelRatio=r,this.ctx=this.canvasNode.getContext("2d"),(n=this.ctx)==null||n.scale(r,r),this.update())}getAriaLabel(e){let t=[],{graphDescription:r}=this.grapher.settings.config;if(this.grapher.type==="3d"&&this.controller.is3dProduct())r!==void 0?t.push(r):(t.push(`${this.controller.s("graphing-calculator-narration-3d-graphpaper-label")}.`),t.push(Iv(this.controller)));else if(this.grapher.type==="2d"&&!this.controller.is3dProduct()){let n=this.grapher.getAudioTrace();if(!n)return"";r!==void 0?t.push(r):(t.push(`${this.controller.s("graphing-calculator-narration-graphpaper-label")}.`),t.push(Iv(this.controller)),e>0&&(n.getAudioTraceActive()||n.agNavigator.getFirstTraceableSketch({selectAssociatedExpression:!1})!==void 0&&(Zo?t.push(this.controller.s("graphing-calculator-narration-audio-instructions-enter-audio-trace-mac")):t.push(this.controller.s("graphing-calculator-narration-audio-instructions-enter-audio-trace-windows")))))}if(t.length)return t.join(" ").trim()}updateAria(e,t){let r=this.getAriaLabel(t);r!==void 0?(this.rootNode.setAttribute("role","img"),this.rootNode.setAttribute("aria-roledescription",this.controller.s("graphing-calculator-narration-graphpaper-label")),this.rootNode.setAttribute("aria-label",r),this.rootNode.setAttribute("aria-hidden",!e||!this.grapher.settings.config.graphpaper?"true":"false"),this.rootNode.setAttribute("tabindex",e&&this.grapher.settings.config.graphpaper&&this.grapher.settings.config.enableTabindex?"0":"-1")):["role","aria-roledescription","aria-label","aria-hidden","tabindex"].forEach(n=>this.rootNode.removeAttribute(n)),this.update()}speakAriaLabelAgain(){let e=this.rootNode.getAttribute("aria-label");e&&xe(e)}},QP=class{constructor(e){this._layerClasses={},this._classLayers={},this.elt=e.elt,this.settings=e.settings,this.controller=e.controller,this.evaluator=e.evaluator,this.elt.style.overflow="hidden"}classLayers(e){var t,r;return(r=(t=this._classLayers)[e])!=null?r:t[e]=new Set}setLayerClass(e,t){let r=this._layerClasses[e];if(this._layerClasses[e]=t,r!==t){if(r){let n=this.classLayers(r);n.delete(e),n.size===0&&this.elt.classList.remove(r)}t&&(this.classLayers(t).add(e),this.elt.classList.add(t))}}},ZP=class extends QP{constructor(e){super(e),this.canvasLayer=r6.mountToNode(ND,this.elt,{grapher:()=>this}),this.elt.appendChild(this.canvasLayer.rootNode)}getImageData(e,t,r,n){var i;return(i=this.canvasLayer.ctx)==null?void 0:i.getImageData(e,t,r,n)}_setIsVisible(e){e!==this.isVisible&&(this.isVisible=e,e?this.controller.requestRedrawGraph():this.canvasLayer.resize(0,0))}getIsVisible(){return this.isVisible}};function*Rv(e){for(let t=0;t<e.length;t++)yield*wn(e[t].drawOrder)}var eV=class extends ZP{setDrawLayers(e){__dcg_shared_module_exports__.E(this.__drawLayers,e)||(this.__drawLayers=e,this.controller.requestRedrawGraph())}setTabOrder(e){this.__tabOrder=e}getDrawLayers(){return this.__drawLayers}getTabOrder(){return this.__tabOrder}generateMergeDrawOrder(){return Rv(this.__drawLayers)}},tV=class extends eV{constructor(){super(...arguments),this.__redrawRequested=!1,this.events=new Kl}redrawAllLayers(){this.__redrawRequested=!0}redrawAllLayersSynchronously(){return this._redrawAllLayers()}notifyAfterRedraw(e){if(!this.__redrawRequested)e();else{this.notifyAfterRedraw_i?this.notifyAfterRedraw_i++:this.notifyAfterRedraw_i=1;let t="redraw.notifyAfterRedraw"+this.notifyAfterRedraw_i;this.events.observeEvent(t,()=>{this.events.unobserveEvent(t),e()})}}},rV=class extends tV{getUserRequestedViewport(){return this._lastUserRequestedViewport}setUserRequestedViewport(e){this._lastUserRequestedViewportUpdateToken||(this._lastUserRequestedViewportUpdateToken=0),this._lastUserRequestedViewportUpdateToken+=1,this._lastUserRequestedViewport=__dcg_shared_module_exports__.Jc(e),this._afterViewportChange()}getCurrentViewport(){return this.viewportController.getViewport().toObject()}debounceUserRequestedViewportChange(){this.__debouncedViewportCommit||(this.__debouncedViewportCommit=__dcg_shared_module_exports__.A((t,r)=>{if(!this.isDragging&&this._lastUserRequestedViewportUpdateToken===r){if(this._lastUserRequestedViewport){let n=Br.fromObject(this._lastUserRequestedViewport);if(this.computeConcreteViewport(n).equals(t))return}this.controller.dispatch({type:"commit-user-requested-viewport",viewport:t})}},1e3));let e=this.getCurrentViewport();this.__debouncedViewportCommit(e,this._lastUserRequestedViewportUpdateToken)}},oV=class extends rV{getState(e){let t=R({},this.getCurrentViewport());this.controller.is3dProduct()||(delete t.zmin,delete t.zmax);let r={viewport:t};return this.settings.stateProperties.forEach(n=>{n!=="randomSeed"&&n!=="includeFunctionParametersInRandomSeed"&&(!this.controller.is3dProduct()&&TK(n)||(r[n]=this.settings[n]))}),e.stripDefaults&&(r=__dcg_shared_module_exports__.md(Os,r)),r}getUndoRedoDiffState(){let e=this.getUndoRedoFullState();return e.speed3D!==0&&delete e.worldRotation3D,e}getUndoRedoFullState(){let e={};return this.settings.stateProperties.forEach(t=>{e[t]=this.settings[t]}),e.viewport=this.getUserRequestedViewport(),e}},my=class extends oV{},BD=class{constructor(e,t){this.is3d=!1,this.color="#000000",this.style="normal",this.showPOI=!1,this.showHighlight=!1,this.hoistToTop=!1,this.selected=!1,this.tokenHovered=!1,this.tokenSelected=!1,this.labels=[],this.id=e,this.branches=t!==void 0?t:[],this.getPOI().forEach(r=>{r.type===1008&&this.labels.push({type:"poi",poi:r})}),t.forEach((r,n)=>{if(r.graphMode===22){if(r.objectType===17){let i=new Lp(0,0,1008,this,n,0,!1);this.labels.push({id:"label-"+e+"-"+(r.listIndex||0),type:"segment",poi:i,segments:r.segments[0],text:r.labels&&r.labels[0]||""})}else if(r.objectType===16){let i=new Lp(0,0,1008,this,n,0,!1);this.labels.push({id:"label-"+e+"-"+(r.listIndex||0),type:"polygon",poi:i,segments:r.segments[0],text:r.labels&&r.labels[0]||""})}else if(r.objectType===23){let i=new Lp(0,0,1008,this,n,0,!1);this.labels.push({id:"label-"+e+"-"+(r.listIndex||0),type:"angle",poi:i,segments:r.segments[0],text:r.labels&&r.labels[0]||""})}}})}getPOI(){if(this.__cachedPOI)return this.__cachedPOI;this.__cachedPOI=[],this.__cachedPOIIds={};for(let e=0;e<this.branches.length;e++){let t=this.branches[e];if(t.graphMode===1||t.graphMode===2){let r=t.poi;r.zeros&&this._pushPOI(r.zeros,e,1002),r.intercept&&this._pushPOI(r.intercept,e,1003),r.extrema&&this._pushPOI(r.extrema,e,1004),r.intersections&&this._pushPOI(r.intersections,e,1001)}else if(__dcg_shared_module_exports__._d(t)){let r=t.poi,n=(t.graphMode===3||t.graphMode===25)&&t.interactiveLabel===!0;if(t.showLabel===!0||n){let i=t.nakedLabel;r.defined&&this._pushPOI(r.defined,e,1008,i)}else r.defined&&this._pushPOI(r.defined,e,1006)}}return this.__cachedPOI}getBranchPOI(e){return this.getPOI().filter(t=>t.branch===e)}getMovablePoints(){if(this.__cachedMovablePoints)return this.__cachedMovablePoints;this.__cachedMovablePoints=[];let e=this.branches[0];if(e&&e.segments.length===1&&__dcg_shared_module_exports__.$d(e)){let t=e.segments[0];for(let r=0;r<t.length;r++){let n;e.tableId&&(n={tableId:e.tableId,columnId:this.id,rowIndex:e.movablePointInfo[r].index,dragX:e.movablePointInfo[r].dragX,dragY:e.movablePointInfo[r].dragY});let i=e.scaleFactors?e.scaleFactors[0][r]:void 0,o=n?n.rowIndex:r,a=e.segments.length===1&&e.labels&&e.labels[r]?e.labels[r]:void 0,s=e.hasOwnProperty("pointOpacity")?e.pointOpacity:1,l=e.pointSize!==void 0?e.pointSize:8;this.__cachedMovablePoints.push({type:"movable-point",id:"movable:["+this.id+","+o+"]",listIndex:o,sketch:this,color:this.color,pointOpacity:s,pointSize:l,tableInfo:n,scaleFactor:i,x:t[r][0],y:t[r][1],label:a,ariaLabel:a&&ei(a)})}}return this.__cachedMovablePoints}getMovablePointByIndex(e){return this.getMovablePoints()[e]}getStaticLabeledPoints(){if(this.__cachedStaticLabeledPoints)return this.__cachedStaticLabeledPoints;let e=this.branches[0];return this.__cachedStaticLabeledPoints=[],this.getPOI().forEach(t=>{if(t.type!==1006&&t.type!==1008||e.graphMode!==3&&e.graphMode!==25)return;let r=e.showLabel,n=t.getLabel();!r&&n===""||this.__cachedStaticLabeledPoints.push({type:"static-labeled-point",id:"static["+this.id+","+t.id+"]",listIndex:t.pointIdxOnBranch,x:t.x,y:t.y,sketch:t.sketch,label:n,ariaLabel:n!==""?ei(n):void 0})}),this.__cachedStaticLabeledPoints}_pushPOI(e,t,r,n=!1){for(let i=0,o=e.x.length;i<o;i++){let a=new Lp(e.x[i],e.y[i],r,this,t,i,n);e.intersects&&(a.intersects=e.intersects[i]),this.__cachedPOI.push(a),this.__cachedPOIIds[a.id]=a}}updateIntersections(e){for(let r=0,n=this.branches.length;r<n;r++){let i=this.branches[r];i.graphMode!==15&&i.graphMode!==22&&(i.poi.intersections=e[r])}let t=this.__cachedPOI;this.__cachedPOI=[],t.forEach(r=>{r.type!==1001?this.__cachedPOI.push(r):delete this.__cachedPOIIds[r.id]});for(let r=0;r<this.branches.length;r++){let n=this.branches[r];if(n.graphMode===1||n.graphMode===2){let i=n.poi;i.intersections&&this._pushPOI(i.intersections,r,1001)}}}getPOIById(e){return this.__cachedPOIIds[e]}updateFrom(e){if(e&&(this.showPOI=e.showPOI,this.showHighlight=e.showHighlight,this.hoistToTop=e.hoistToTop,this.selected=e.selected,this.tokenSelected=e.tokenSelected,this.tokenHovered=e.tokenHovered,__dcg_shared_module_exports__._d(this.branches[0]))){let t=!0;for(let r=0;r<this.__cachedPOI.length;r++){let n=e.__cachedPOI[r],i=this.__cachedPOI[r];if(!n||n.type!==i.type){t=!1;break}}if(t)for(let r=0;r<this.__cachedPOI.length;r++){let n=e.__cachedPOI[r],i=this.__cachedPOI[r];delete this.__cachedPOIIds[i.id],this.__cachedPOIIds[n.id]=i,i.id=n.id}}}},Hp=document.createElement("canvas").getContext("2d"),_a=class Li{constructor(t,r){this._label=t,this._fontSize=r,this._layout=tne(t,r)}getRect(){return this.getRectWhenCenteredAt({x:0,y:0})}getRectWhenCenteredAt(t){return{left:this._layout.left+t.x,right:this._layout.right+t.x,top:this._layout.top+t.y,bottom:this._layout.bottom+t.y}}getBoundsWhenCenteredAt(t,r){switch(r){case"x":return{lower:this._layout.left+t,upper:this._layout.right+t};case"y":return{lower:this._layout.top+t,upper:this._layout.bottom+t};default:let n=r;throw new Error(`Unknown axis: ${n}`)}}getWidth(){return this._layout.right-this._layout.left}getHeight(){return this._layout.bottom-this._layout.top}getDimensionAlongAxis(t){switch(t){case"x":return this.getWidth();case"y":return this.getHeight();default:let r=t;throw new Error(`Unknown axis: ${r}`)}}clampBoundsWithinRect(t,r){let n,i;return t.x+this._layout.left<r.left?n=r.left-this._layout.left:t.x+this._layout.right>r.right?n=r.right-this._layout.right:n=t.x,t.y+this._layout.top<r.top?i=r.top-this._layout.top:t.y+this._layout.bottom>r.bottom?i=r.bottom-this._layout.bottom:i=t.y,{x:n,y:i}}getValue(){return this._label.value}getMinusWidth(){return this.getValue()<0?(Li.setCtxFontSize(Hp,this._fontSize),Hp.measureText("-1").width-Hp.measureText("1").width):0}getString(){return this._label.superscript?this._label.mantissa+"^"+this._label.superscript:this._label.string}drawCenteredAt(t,r,n){let i=r.x,o=Li.computeBaselineFromCenter(r.y,this._fontSize);n&&No(t,n),t.save(),n&&To(t),Li.setCtxFontSize(t,this._fontSize),this._label.superscript?(t.strokeText(this._label.mantissa,this._layout.mantissa_x+i,this._layout.mantissa_y+o),t.strokeText(this._label.superscript,this._layout.superscript_x+i,this._layout.superscript_y+o),t.fillText(this._label.mantissa,this._layout.mantissa_x+i,this._layout.mantissa_y+o),t.fillText(this._label.superscript,this._layout.superscript_x+i,this._layout.superscript_y+o)):(t.strokeText(this._label.string,this._layout.mantissa_x+i,this._layout.mantissa_y+o),t.fillText(this._label.string,this._layout.mantissa_x+i,this._layout.mantissa_y+o)),t.restore()}static computeBaselineFromCenter(t,r){return t+.272*r}static setCtxFontSize(t,r){t.font=r+"px Arial",t.textAlign="center"}};function tne(e,t){if(e.superscript){let r=t;_a.setCtxFontSize(Hp,r);let n=Hp.measureText(e.mantissa).width,i=Math.round(.8*t);_a.setCtxFontSize(Hp,i);let o=Hp.measureText(e.superscript).width,a=0,s=t/5,l=n/2+o/2,c=-t/4,d=c-i/2,u=s+r/2,p=a-n/2,g=l+o/2;return{top:d,bottom:u,left:p,right:g,mantissa_height:r,mantissa_width:n,mantissa_x:a,mantissa_y:s,superscript_height:i,superscript_width:o,superscript_x:l,superscript_y:c}}else{let r=t;_a.setCtxFontSize(Hp,t);let n=Hp.measureText(e.string).width,i=0,o=0,a=o-r/2,s=o+r/2,l=i-n/2,c=i+n/2;return{top:a,bottom:s,left:l,right:c,mantissa_height:r,mantissa_width:n,mantissa_x:i,mantissa_y:o}}}function rne(e,t,r,n){let i=Math.ceil(e/r),o=Math.floor(t/r),a=1/r;if(!(i>o)&&!(o-i>1e4))for(let s=i;s<=o;s++)n(s/a)}var iV={base:10,major:[1,2,5],minor:[5,4,5]},one={base:10,major:[Math.PI,2*Math.PI,5*Math.PI],minor:[4,4,5]},ine={base:2,major:[Math.PI/3],minor:[3]};function nne(e){return e?{base:10,major:[e,2*e,5*e],minor:[4,4,5]}:iV}function nV(e,t){let{major:r,minor:n,base:i}=t,o=1/0,a=1/0;for(let s=0;s<r.length;s++){let l=r[s],c=Math.ceil(Math.log(e/l)/Math.log(i)),d=l*Math.pow(i,c);if(d<o){o=d;let u=n[s];a=o/u}}return{major:o,minor:a}}function ane(e,t,r){return 1+(t-e)/r}function o6(e){let t=e.screen.width,r=e.screen.height,n=e.viewport.xmax-e.viewport.xmin,i=e.viewport.ymax-e.viewport.ymin,o=e.settings.pixelsPerLabel;return{majorStepX:o/t*n,majorStepY:o/r*i}}function gl(e){let t=l=>{let[c,d,u,p,g]=l==="x"?[e.viewport.xmin,e.viewport.xmax,e.settings.xAxisStep,e.settings.xAxisNumbers,e.settings.xAxisMinorSubdivisions]:[e.viewport.ymin,e.viewport.ymax,e.settings.yAxisStep,e.settings.yAxisNumbers,e.settings.yAxisMinorSubdivisions],f=d-c,y=Math.abs(u!=null?u:NaN),E=0,_=0;if(y&&y!==Math.PI){let w=ane(c,d,y);if(w>=3&&w<100){let v=0;if(p){let M=0;rne(c,d,y,C=>{let P=new _a(__dcg_shared_module_exports__.ea(C,f),e.settings.labelSize);M=Math.max(P.getDimensionAlongAxis(l),M)}),v=M+10}else v=g===1?8:20;let T=l==="x"?"width":"height";w*v<=e.screen[T]&&(E=y,y===3||y===5?_=1:_=y/4)}}if(!E){let w=o6(e)[l==="x"?"majorStepX":"majorStepY"],v=nV(w,__dcg_shared_module_exports__.ea(y,f).string.indexOf("π")>=0?w>=1?one:ine:nne(y));E=v.major,_=v.minor}return{majorStep:E,minorStep:_}},r=()=>{var l,c;if(Math.abs((l=e.settings.xAxisStep)!=null?l:NaN)===Math.abs((c=e.settings.yAxisStep)!=null?c:NaN)){let{xmin:d,xmax:u,ymin:p,ymax:g}=e.viewport,f=e.screen.width/(u-d),y=e.screen.height/(g-p),E=f/y,_=.01;if(E>=1-_&&E<=2){let{majorStep:w,minorStep:v}=t("y");return{x:{majorStep:w,minorStep:v},y:{majorStep:w,minorStep:v}}}if(E<=1-_&&E>=.5){let{majorStep:w,minorStep:v}=t("x");return{x:{majorStep:w,minorStep:v},y:{majorStep:w,minorStep:v}}}}return{x:t("x"),y:t("y")}},n=()=>{let{xAxisScale:l,yAxisScale:c}=e.settings,d=l==="logarithmic",u=c==="logarithmic";return!d&&!u?r():{x:d?{majorStep:NaN,minorStep:NaN}:t("x"),y:u?{majorStep:NaN,minorStep:NaN}:t("y")}},{x:i,y:o}=n(),{xAxisMinorSubdivisions:a=0,yAxisMinorSubdivisions:s=0}=e.settings;return{majorStepX:i.majorStep,minorStepX:a>0?i.majorStep/a:i.minorStep,majorStepY:o.majorStep,minorStepY:s>0?o.majorStep/s:o.minorStep}}function i6(e){let t=o6(e),r=nV(t.majorStepX,iV),n=nV(t.majorStepY,iV),i=r.major>n.major?r:n;return{majorStepR:i.major,minorStepR:i.minor}}var{floor:Xg,ceil:Jg,round:sne,log10:UD,log2:n6,abs:lh}=Math,sh=e=>US?`rgba(255,255,255,${e})`:`rgba(0,0,0,${e})`,HD=class{redrawToCtx(e,t){let{ctx:r,projection:n}=e;Ja(r,"graphpaper");let i=n.settings.showGrid&&!n.settings.threeDMode;if(n.settings.polarMode&&i){let o=i6(n);Ja(r,"grid"),this.drawPolarGrid(r,n,o),Qa(r),Ja(r,"axis"),this.drawAxes(r,n,t);let a=this.drawPolarStepNumbers(r,n,o);this.drawLabels(r,n,a),Qa(r)}else{let o=gl(n),a=aV(n);i&&(Ja(r,"grid"),this.drawCartesianGrid(r,n,o,a),Qa(r));let s=!i&&!n.settings.threeDMode;Ja(r,"axis"),n.settings.threeDMode||this.drawAxes(r,n,t);let l=this.drawCartesianStepNumbers(r,n,o,s,a);this.drawLabels(r,n,l),Qa(r)}Qa(r)}addTextShadow(e,t){let{threeDMode:r,showPlane3D:n}=t.settings;e.strokeStyle=t.settings.getBackgroundColor({invertWhite:r}),e.lineWidth=3,r&&(!n||t.settings.invertedColors)&&(e.lineWidth=1.5),e.miterLimit=2}drawPolarGrid(e,t,r){e.save();let n=t.settings.minorAxisOpacity,i=1-(1-t.settings.majorAxisOpacity)/(1-n),o=__dcg_shared_module_exports__.Z(t.mapx(0)),a=__dcg_shared_module_exports__.Z(t.mapy(0)),s=t.screen.height/(t.viewport.ymax-t.viewport.ymin),l=t.screen.width/(t.viewport.xmax-t.viewport.xmin),c=s/l,d=l/s,u=a/c,p=t.viewport.smallestR(),g=t.viewport.largestR(),f=r.minorStepR*Math.max(1,Math.floor(p/r.minorStepR)),y=r.majorStepR*Math.max(1,Math.floor(p/r.majorStepR));e.lineWidth=1,e.strokeStyle=sh(n);for(let _ of ds(f,g,r.minorStepR)){No(e,"dcg-svg-minor-gridline"),e.beginPath(),To(e),e.scale(1,c);let w=t.mapx(_)-o;e.moveTo(o+w,u),e.arc(o,u,w,0,2*Math.PI),e.scale(1,d),e.stroke()}let E=p>0?5:15;for(let _ of ds(0,359,E)){if((_===0||_===180)&&t.settings.showXAxis||(_===90||_===270)&&t.settings.showYAxis)continue;No(e,"dcg-svg-minor-gridline"),e.beginPath(),To(e),e.moveTo(o,a);let w=t.mapx(g*Math.cos(_*Math.PI/180)),v=t.mapy(g*Math.sin(_*Math.PI/180));e.lineTo(__dcg_shared_module_exports__.Z(w),__dcg_shared_module_exports__.Z(v)),e.stroke()}e.lineWidth=1,e.strokeStyle=sh(i);for(let _ of ds(y,g,r.majorStepR)){No(e,"dcg-svg-major-gridline"),e.beginPath(),To(e),e.scale(1,c);let w=t.mapx(_)-o;e.moveTo(o+w,u),e.arc(o,u,w,0,2*Math.PI),e.scale(1,d),e.stroke()}e.restore()}drawCartesianGrid(e,t,r,n=aV(t)){e.save();let{xmin:i,xmax:o,ymin:a,ymax:s}=t.viewport,l=t.screen.width,c=t.screen.height,d=c,u=0;t.settings.restrictGridToFirstQuadrant&&(i=0,a=0,d=t.mapy(0),u=t.mapx(0));let p=t.settings.minorAxisOpacity*n.x.unitOpacity,g=t.settings.minorAxisOpacity*n.y.unitOpacity,f=t.settings.majorAxisOpacity;e.lineWidth=1;let y=O=>{if(O===0&&t.settings.showYAxis)return;let z=__dcg_shared_module_exports__.Z(t.mapx(O));z===__dcg_shared_module_exports__.Z(0)||z===__dcg_shared_module_exports__.Z(l)||(e.beginPath(),e.moveTo(z,0),e.lineTo(z,d),e.stroke())},E=O=>{if(O===0&&t.settings.showXAxis)return;let z=__dcg_shared_module_exports__.Z(t.mapy(O));z===__dcg_shared_module_exports__.Z(0)||z===__dcg_shared_module_exports__.Z(c)||(e.beginPath(),e.moveTo(u,z),e.lineTo(l,z),e.stroke())};No(e,"dcg-svg-minor-gridline");let{majorStepX:_,majorStepY:w,minorStepX:v,minorStepY:T}=r,M=t.settings.xAxisScale==="logarithmic",C=t.settings.yAxisScale==="logarithmic",P=M?n.x.minor:ds(i,o,v),F=C?n.y.minor:ds(a,s,T);e.strokeStyle=sh(p);for(let O of P)y(O);e.strokeStyle=sh(g);for(let O of F)E(O);To(e);let B=1-(1-f)/(1-p),x=1-(1-f)/(1-g);No(e,"dcg-svg-major-gridline");let L=M?n.x.major:ds(i,o,_),N=C?n.y.major:ds(a,s,w);e.strokeStyle=sh(B);for(let O of L)y(O);e.strokeStyle=sh(x);for(let O of N)E(O);To(e),e.restore()}drawAxes(e,t,r){let n=t.settings.axisLineOffset,i=t.settings.axisOpacity,o=`rgba(127,205,230,${i.toString()})`,a=sh(i),s=t.settings.xAxisArrowMode,l=t.settings.yAxisArrowMode,c=t.settings.showXAxis,d=t.settings.showYAxis,u=1,p=Math.round(t.mapx(0))-n,g=Math.round(t.mapy(0))-n,f=t.screen.height,y=t.screen.width;function E(v,T,M){e.save();let C=Math.PI/12,P=8*Math.max(e.lineWidth,1.5);e.lineJoin="round",e.fillStyle=a,e.strokeStyle=a,e.beginPath(),e.moveTo(v,T),e.lineTo(v+Math.cos(M-C)*P,T+Math.sin(M-C)*P),e.lineTo(v+Math.cos(M+C)*P,T+Math.sin(M+C)*P),e.lineTo(v,T),e.lineTo(v+Math.cos(M-C)*P,T+Math.sin(M-C)*P),e.stroke(),e.fill(),e.restore()}let _=f,w=0;t.settings.restrictGridToFirstQuadrant&&(_=g,w=p,s==="BOTH"&&(s="POSITIVE"),l==="BOTH"&&(l="POSITIVE")),d&&(Ja(e,"yaxis"),t.settings.takingScreenshot&&rv(e,t.settings.yAxisLabel||"Y axis"),e.save(),No(e,"dcg-svg-axis-line"),e.lineWidth=t.settings.axisLineWidth*(r==="y"?u:1),e.strokeStyle=r==="y"?o:a,l==="BOTH"?(e.beginPath(),e.moveTo(p,2*t.settings.axisLineWidth),e.lineTo(p,f-2*t.settings.axisLineWidth),e.stroke(),E(p,f-t.settings.axisLineWidth,3*Math.PI/2),E(p,t.settings.axisLineWidth,Math.PI/2)):l==="POSITIVE"?(e.beginPath(),e.moveTo(p,2*t.settings.axisLineWidth),e.lineTo(p,_),e.stroke(),E(p,t.settings.axisLineWidth,Math.PI/2)):(e.beginPath(),e.moveTo(p,0),e.lineTo(p,_),e.stroke()),To(e),e.restore(),Qa(e)),c&&(Ja(e,"xaxis"),t.settings.takingScreenshot&&rv(e,t.settings.xAxisLabel||"X axis"),e.save(),No(e,"dcg-svg-axis-line"),e.lineWidth=t.settings.axisLineWidth*(r==="x"?u:1),e.strokeStyle=r==="x"?o:a,s==="BOTH"?(e.beginPath(),e.moveTo(2*t.settings.axisLineWidth,g),e.lineTo(y-2*t.settings.axisLineWidth,g),e.stroke(),E(t.settings.axisLineWidth,g,0),E(y-t.settings.axisLineWidth,g,Math.PI)):s==="POSITIVE"?(e.beginPath(),e.lineTo(w,g),e.lineTo(y-2*t.settings.axisLineWidth,g),e.stroke(),E(y-t.settings.axisLineWidth,g,Math.PI)):(e.beginPath(),e.lineTo(w,g),e.lineTo(y,g),e.stroke()),To(e),e.restore(),Qa(e))}drawPolarStepNumbers(e,t,r){e.save();let n=t.settings.showGrid,i=t.settings.xAxisNumbers&&t.settings.showXAxis,o=t.settings.yAxisNumbers&&t.settings.showYAxis,a=n&&t.settings.polarNumbers,s=t.viewport.largestR(),l=t.viewport.smallestR(),c=t.viewport.xmin,d=t.viewport.xmax,u=t.viewport.ymin,p=t.viewport.ymax,g=t.screen.width,f=t.screen.height,y={left:3,right:g-3,top:3,bottom:f-3},E=t.settings.labelHangingColor,_=t.settings.getTextColor(),w=t.settings.labelSize,v=w;this.addTextShadow(e,t),e.fillStyle=_;function T(V,$,G){let W=Math.sqrt(V*V-$*$);u<=W&&W<=p&&G.push({x:t.mapx($),y:t.mapy(W)}),u<=-W&&-W<=p&&G.push({x:t.mapx($),y:t.mapy(-W)})}function M(V,$,G){let W=Math.sqrt(V*V-$*$);c<=W&&W<=d&&G.push({x:t.mapx(W),y:t.mapy($)}),c<=-W&&-W<=d&&G.push({x:t.mapx(-W),y:t.mapy($)})}let C=t.mapx(0),P=t.mapy(0),F=u<=0&&0<=p,B=c<=0&&0<=d,x=F&&i,L=B&&o,N="";if(!x&&!L&&n){let V=lh(C),$=lh(C-g),G=lh(P),W=lh(P-f),U,D,de,ge;V<=$?(U="left",de=V):(U="right",de=$),G<=W?(D="top",ge=G):(D="bottom",ge=W),i&&o?N=de<=ge?U:D:o?N=U:i&&(N=D)}let O={left:0,right:g,top:P-1,bottom:P+1},z={left:C-1,right:C+1,top:0,bottom:f};for(let V of ds(0,s,r.majorStepR)){let $=[],G=[],W=[],U=new _a(__dcg_shared_module_exports__.ea(V,s),w),D=U.getRect();switch(V>0?(L&&u<=V&&V<=p&&G.push({x:C-D.right-5,y:t.mapy(V)}),L&&u<=-V&&-V<=p&&G.push({x:C-D.right-5,y:t.mapy(-V)}),x&&c<=V&&V<=d&&$.push({x:t.mapx(V),y:P-D.top+3}),x&&c<=-V&&-V<=d&&$.push({x:t.mapx(-V),y:P-D.top+3})):L&&!i&&u<=V&&V<=p?G.push({x:C-D.right-5,y:t.mapy(V)}):x&&!o&&c<=V&&V<=d&&$.push({x:t.mapx(V),y:P-D.top+3}),N){case"top":M(V,p,W);break;case"bottom":M(V,u,W);break;case"left":T(V,c,W);break;case"right":T(V,d,W);break}$.forEach(de=>{de=U.clampBoundsWithinRect(de,y),U.drawCenteredAt(e,de,"dcg-svg-axis-value"),zD(O,U.getRectWhenCenteredAt(de))}),G.forEach(de=>{de=U.clampBoundsWithinRect(de,y),U.drawCenteredAt(e,de,"dcg-svg-axis-value"),zD(z,U.getRectWhenCenteredAt(de))}),W.forEach(de=>{de=U.clampBoundsWithinRect(de,y),U.drawCenteredAt(e,de,"dcg-svg-axis-value")})}if(a){let V=Math.ceil(l/r.majorStepR),$=Math.floor(s/r.majorStepR),G=Math.ceil((V+$)/2)*r.majorStepR,W=l>0?15:30;for(let U of ds(0,359,W)){let D;t.settings.degreeMode?D=U.toString()+"°":D=__dcg_shared_module_exports__.ea(U*Math.PI/180,2*Math.PI).string;let de=e.measureText(D).width/2,ge=G/1.05,K=ge*Math.cos(U*Math.PI/180),se=ge*Math.sin(U*Math.PI/180);if(K<c||K>d||se<u||se>p)continue;let H=t.mapx(K),Z=t.mapy(se);U===0||U===180?Z-=v:(U===90||U===270)&&(H+=de+3);let ce=__dcg_shared_module_exports__.Sb(H,3+de,g-3-de),Re=__dcg_shared_module_exports__.Sb(Z,3+v,f-3-v);Re=_a.computeBaselineFromCenter(Re,w),No(e,"dcg-svg-polar-axis-value"),e.save(),To(e),e.fillStyle=E,_a.setCtxFontSize(e,w),e.strokeText(D,ce,Re),e.fillText(D,ce,Re),e.restore()}}return e.restore(),{x:O,y:z}}drawLabels(e,t,r){let n=t.viewport.xmin,i=t.viewport.xmax,o=t.viewport.ymin,a=t.viewport.ymax,s=t.screen.width,l=t.screen.height,c=(i-n)/s,d=(a-o)/l,u=t.settings.getTextColor(),p=t.mapx(0),g=t.mapy(0),f=t.settings.labelSize,y=15,E=t.settings.showXAxis&&t.settings.xAxisLabel,_=t.settings.showYAxis&&t.settings.yAxisLabel,w=r.x,v=r.y;if(E&&w){No(e,"dcg-svg-axis-label"),e.save(),To(e),e.fillStyle=u;let T;if(e.__xLabelOffset&&t.settings.isViewportTransient&&qD(e.__xLabelOffset.xscale,c)&&qD(e.__xLabelOffset.yscale,d)&&(T={x:e.__xLabelOffset.x+p,y:e.__xLabelOffset.y+g}),this._setAxisLabelFont(e,E,f,t),!T){let M=e.measureText(E).width,C=s-M-y,P=f;w.bottom+P<l?T={x:C,y:w.bottom+P}:T={x:C,y:w.top-P/2},e.__xLabelOffset={x:T.x-p,y:T.y-g,xscale:c,yscale:d}}e.strokeText(E,T.x,T.y),e.fillText(E,T.x,T.y),e.restore()}else e.__xLabelPosition=null;if(_&&v){No(e,"dcg-svg-axis-label"),e.save(),To(e),e.fillStyle=u;let T;if(e.__yLabelOffset&&t.settings.isViewportTransient&&qD(e.__yLabelOffset.xscale,c)&&qD(e.__yLabelOffset.yscale,d)&&(T={x:e.__yLabelOffset.x+p,y:e.__yLabelOffset.y+g}),this._setAxisLabelFont(e,_,f,t),!T){let M=e.measureText(_).width,C=f,P=M+5;if(!this._isShortMathyLabel(_)){let B=M;M=C,C=B,P=M*.5}let F=0+y+C;v.left-M>0?T={x:v.left-P,y:F}:T={x:v.right+M,y:F},e.__yLabelOffset={x:T.x-p,y:T.y-g,xscale:c,yscale:d}}e.translate(T.x,T.y),this._isShortMathyLabel(_)||e.rotate(-Math.PI/2),e.strokeText(_,0,0),e.fillText(_,0,0),e.restore()}else e.__yLabelPosition=null}_isShortMathyLabel(e){return e.trim().match(/^([a-zA-Z]?)\(?([a-zA-Z]?)\)?$/)}_setAxisLabelFont(e,t,r,n){this.addTextShadow(e,n),this._isShortMathyLabel(t)?e.font="italic "+Math.round(r*1.4)+"px Times":e.font=Math.round(r*1.2)+"px Arial"}drawCartesianStepNumbers(e,t,r,n,i=aV(t)){e.save();let{showXAxis:o,showYAxis:a}=t.settings,s=o&&t.settings.xAxisNumbers,l=a&&t.settings.yAxisNumbers,{xmin:c,xmax:d,ymin:u,ymax:p}=t.viewport,g=t.screen.width,f=t.screen.height,y={left:3,top:3,right:g-3,bottom:f-3};t.settings.restrictGridToFirstQuadrant&&(c=0,u=0);let E=t.settings.getTextColor({invertBlack:t.settings.threeDMode}),_=t.settings.threeDMode?E:t.settings.labelHangingColor,w=t.mapx(0),v=t.mapy(0),T=t.settings.labelSize;this.addTextShadow(e,t);let M={left:0,right:g,top:v-1,bottom:v+1},C={left:w-1,right:w+1,top:0,bottom:f};if(t.settings.threeDMode&&!t.settings.showNumbers3D)return{x:M,y:C};let P=5,F=!1;if(o&&a&&(s||l)){F=!0,e.fillStyle=E;let O=new _a(__dcg_shared_module_exports__.ea(0,1),T);O.drawCenteredAt(e,{x:w-O.getRect().right-P,y:v-O.getRect().top+P},"dcg-svg-axis-value")}let{majorStepX:B,majorStepY:x}=r,L=[],N=[];if(s){let O=t.settings.xAxisScale==="logarithmic",z=O?i.x.label:ds(c,d,B);for(let V of z){let $=O?void 0:d-c,G=__dcg_shared_module_exports__.ea(V,$,O),W=new _a(G,T);W.getString()==="0"&&F||L.push(W)}}if(l){let O=t.settings.yAxisScale==="logarithmic",z=O?i.y.label:ds(u,p,x);for(let V of z){let $=O?void 0:p-u,G=__dcg_shared_module_exports__.ea(V,$,O),W=new _a(G,T);W.getString()==="0"&&F||N.push(W)}}if(n){e.save(),No(e,"dcg-svg-tickmark");let O=t.settings.axisLineOffset,z=t.settings.axisOpacity,V=sh(z);e.lineWidth=t.settings.axisLineWidth,e.strokeStyle=V;let $=Math.round(t.mapy(0))-O,G=Math.round(t.mapx(0))-O,W=Math.round(2*e.lineWidth)-O;e.beginPath(),L.forEach(U=>{let D=Math.round(t.mapx(U.getValue()))-O;e.moveTo(D,$-W),e.lineTo(D,$+W)}),N.forEach(U=>{let D=Math.round(t.mapy(U.getValue()))-O;e.moveTo(G-W,D),e.lineTo(G+W,D)}),e.stroke(),To(e),e.restore()}return L.forEach(O=>{let z={x:t.mapx(O.getValue())-.5*O.getMinusWidth(),y:v-O.getRect().top+P},V=O.clampBoundsWithinRect(z,y);e.fillStyle=z.y===V.y||t.settings.yAxisScale==="logarithmic"?E:_;let $="dcg-svg-axis-value";z.x!==V.x&&($+=" dcg-svg-offcenter-axis-value"),O.drawCenteredAt(e,V,$),zD(M,O.getRectWhenCenteredAt(V)),To(e)}),N.forEach(O=>{let z={x:w-P-O.getRect().right,y:t.mapy(O.getValue())},V=O.clampBoundsWithinRect(z,y);e.fillStyle=z.x===V.x||t.settings.xAxisScale==="logarithmic"?E:_;let $="dcg-svg-axis-value";z.y!==V.y&&($+=" dcg-svg-offcenter-axis-value"),O.drawCenteredAt(e,V,$),zD(C,O.getRectWhenCenteredAt(V)),To(e)}),e.restore(),{x:M,y:C}}};function ds(e,t,r){let n=Math.ceil(e/r),i=Math.floor(t/r);if(!lne({nmin:n,nmax:i}))return[];let o=[];for(let a=n;a<=i;a++)o.push(a*r);return o}var lne=({nmin:e,nmax:t})=>isFinite(t-e)&&t-e<=1e4;function aV(e){return{x:a6("x",e),y:a6("y",e)}}function a6(e,t){let r=new Set,n=new Set,i=new Set,o=1;function a(K){return v?t.mapx(K):t.mapy(K)}function s(K,se){return lh(a(se)-a(K))}let l=(K,se)=>{let H=K*se,Z=(K+1)*se;if(H<T&&Z<T||H>M&&Z>M)return;let ce=K>=5?s(7*se,8*se):K>=2?s(3*se,4*se):s(se,2*se),Re=ce/s(H,Z);if(ce<40)return;let he={settings:{pixelsPerLabel:t.settings.pixelsPerLabel*Re,labelSize:t.settings.labelSize,xAxisNumber:t.settings.xAxisNumbers,yAxisNumber:t.settings.yAxisNumbers},screen:{width:ce,height:ce},viewport:{xmin:H,ymin:H,xmax:Z,ymax:Z}},{minorStepX:Ie,majorStepX:Ee}=gl(he),Be=Math.max(H,T),J=Math.min(Z,M);for(let j=Xg(Be/Ie);j<Jg(J/Ie);j++)i.add(j*Ie);for(let j=Xg(Be/Ee);j<Jg(J/Ee);j++){let pe=j*Ee;pe<=H||pe>=Z||(n.add(pe),r.add(pe))}},c={label:[],major:[],minor:[],unitOpacity:1},{xAxisScale:d,yAxisScale:u,pixelsPerLabel:p}=t.settings,{xmin:g,xmax:f,ymin:y,ymax:E}=t.viewport,{width:_,height:w}=t.screen,v=e==="x",[T,M]=v?[g,f]:[y,E],C=v?_:w,P=v?d:u,F=t.settings.xAxisMinorSubdivisions!==0;if(P!=="logarithmic")return c;let B=Xg(UD(T)),x=Jg(UD(M)),L=Jg(UD(M)-UD(T)),N=s(wr(10,B),wr(10,B+1)),O=15,z=100,V=N>O,$=[];N>6.25*p&&($=[2,3,4,6,8]),N>12*p&&($=[2,3,4,5,6,7,8]),N>14*p&&($=[2,3,4,5,6,7,8,9]);let G=$.length!=0;if(O<=N&&N<=z&&(o=Math.sqrt((N-O)/(z-O))),!isFinite(L))return c;let W=Xg(C/p),U=Math.max(1,wr(2,sne(n6(L/W))));for(let K=Jg(B/U);K<=Xg(x/U);K++)r.add(wr(10,K*U));n=new Set([...r]);let D=Xg(C/O),de=Math.max(1,wr(2,Jg(n6(L/D))));for(let K=Jg(B/de);K<=Xg(x/de);K++)(V?n:i).add(wr(10,K*de));if(V)for(let K=B;K<x;K++){let se=wr(10,K);for(let H of $)r.add(H*se);if(G){for(let H=2;H<=9;H++)n.add(H*se);for(let H=1;H<=9;H++)l(H,se)}else for(let H=2;H<=9;H++)i.add(H*se)}F&&(i=new Set);let ge=v?t.reverse_mapx(a(T)+p/4):t.reverse_mapy(a(T)-2*t.settings.labelSize);return{label:[...r].filter(K=>ge<=K&&K<=M),major:[...n].filter(K=>T<=K&&K<=M),minor:[...i].filter(K=>T<=K&&K<=M),unitOpacity:o}}function zD(e,t){t.left<e.left&&(e.left=t.left),t.right>e.right&&(e.right=t.right),t.top<e.top&&(e.top=t.top),t.bottom>e.bottom&&(e.bottom=t.bottom)}function qD(e,t){let r=lh(e),n=lh(t);return lh(r-n)<=(r<n?n:r)*1e-4}__dcg_shared_module_exports__.e(ne());var Nv=class{constructor(e){this.grapher=e,this.controller=this.grapher.controller,this.renderedTabTargetOrder=[],this.renderedTabTargets={}}recomputeImages(e){let{projection:t}=e;this.renderedTabTargets={},this.renderedTabTargetOrder=[];for(let r of this.grapher.generateMergeDrawOrder()){let n=this.controller.getItemModel(r);if(n&&n.type==="image"&&n.shouldGraph&&fc(n)){let i=n.formula.dimensions;if(!i||!i.x||!i.y||!i.width||!i.height||!i.radianAngle)continue;for(let o=0;o<i.x.length;o++)if(isFinite(i.x[o])&&isFinite(i.y[o])&&isFinite(i.width[o])&&isFinite(i.height[o])&&isFinite(i.radianAngle[o])){this.renderedTabTargetOrder.push(r),this.renderedTabTargets[r]={id:r,description:this.getComputedDescription(n,o),x:i.x[o],y:i.y[o],radianAngle:i.radianAngle[o],width:i.width[o],height:i.height[o],widthScale:Math.abs(t.mapx(1)-t.mapx(0)),heightScale:Math.abs(t.mapy(1)-t.mapy(0)),screenX:t.mapx(i.x[o]),screenY:t.mapy(i.y[o]),centerId:n.formula.center_reference_id,selected:Sa(n)};break}}}this.speakAriaAlert()}getOrderedTabTargets(){return this.getTabIndex()===-1?[]:this.renderedTabTargetOrder.map(e=>{var t;let r=this.renderedTabTargets[e];return{calcId:r.id,listIndex:void 0,polygonEdge:void 0,description:this.controller.isGeometry()||(t=this.getAriaAlert({id:r.id,includeUsageInstructions:!0}))==null?void 0:t.completeMessage}})}getStyle(e){let t=this.renderedTabTargets[e];if(!t)return;let{screenX:r,screenY:n,radianAngle:i,width:o,height:a,widthScale:s,heightScale:l}=t,c=l/s,d=o*s,u=a*l/c,p=r-d/2,g=n-u/2,f=`translate(${p}px, ${g}px)`,y=i?` rotate(${i}rad)`:"",E=c===1?"":` scale(1,${c})`;return{position:"absolute",top:0,left:0,transform:f+E+y,width:d+"px",height:u+"px"}}getTabIndex(){if(this.controller.getActiveTool()!=="selection")return-1;let e=this.grapher.settings;return e.config.graphpaper&&e.config.enableTabindex?0:-1}getAriaHidden(){return!this.grapher.settings.config.graphpaper}getComputedDescription(e,t){let r=e.formula&&e.formula.computed_description&&e.formula.computed_description[t];return r&&r!==""?ei(r):this.grapher.getAudioTrace().getExpressionAriaLabel(e.id)}getAriaLabel(e){let t=this.getAriaAlert({id:e,includeUsageInstructions:!1});return t&&t.completeMessage}speakAriaAlert(){if(this.controller.isGeometry())return;let e=this.getFocusedImage();if(!e){this.lastAriaAlert=void 0;return}let t=e.id,r=this.getAriaAlert({id:t,lastAriaAlert:this.lastAriaAlert,includeUsageInstructions:!0});this.lastAriaAlert=r,r&&r.completeMessage&&xe(r.completeMessage)}getAriaAlert(e){let{id:t,lastAriaAlert:r,includeUsageInstructions:n}=e;if(!t)return;let i=this.controller.getItemModel(t);if(!i||i.type!=="image")return;let o=this.renderedTabTargets[t];if(!o)return;r&&r.id!==t&&(r=void 0);let a=r==null?void 0:r.label,s=o.description,l=a!==s,c=!!(r!=null&&r.selected),d=o.selected,u=c!==d,p=r&&r.coordX,g=r&&r.coordY,f=o.x,y=o.y,E=f!==p||y!==g,_=this.grapher.getProjection(),w=ll(this.controller,f,y),v=s,T=n?this.controller.s("graphing-calculator-narration-movable-point-suffix-usage-instructions"):"",M=this.isImageFullyVisible(i,_)?"":this.controller.s("graphing-calculator-narration-draggable-image-off-screen-prompt"),C;return r?l||!E&&u?C=v+M:E?C=w+M:C="":C=this.controller.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:v,coordinates:w})+T+M,{id:t,coordX:f,coordY:y,label:s,completeMessage:C}}getFocusedImage(){let e=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention();return e?this.renderedTabTargets[e.calcId]:void 0}speakImageAttribute(e,t){if(!(!e||!this.grapher.getAudioTrace()||!this.grapher.getProjection()))switch(t){case"X":xe(Bl(this.controller,e.x));break;case"Y":xe(Ul(this.controller,e.y));break;case"L":xe(e.description);break}}hasNonlinearMoveStrategy(e){if(!e)return!1;let t=this.controller.getItemModel(e);if(!t||t.type!=="expression"||!t.formula)return!1;let r=t.formula.move_strategy;return!r||!r[0]?!1:r[0].type==="updateSliderNonlinear"}isImageFullyVisible(e,t){let r=e.formula.dimensions;if(!r||!r.x||!r.y)return!1;for(let n=0;n<r.x.length;n++)if(!t.coordsAreOnscreen(t.mapx(r.x[n]),t.mapy(r.y[n])))return!1;return!0}},s6={translate:!0,reflect:!0,dilate:!0,rotate:!0},fy=Object.keys(s6),Et=__dcg_shared_module_exports__.e(ne());function sV(e,t){if(e.indexOf("\\idref_{")===0){let r=e.indexOf("}"),n=e.slice(8,r);return t(n)+e.slice(r+1)}else return e}function lV(e,t){var r;let n={};for(let o in e){let a=e[o];if(a.type==="polygon-segment"&&!a.showAsSepratePreviewObject){let s=l6(a,t,{});if(!s)throw new Error("Expected polygon-segment object to be converted");n[o]={type:"inline",rhs:s.rhs}}}let i=R({},n);for(let o in e){if(n[o])continue;let a=e[o],s=l6(a,t,n);s&&(i[o]={type:"assignment",latex:`${(r=s.lhs)!=null?r:a.id}=${s.rhs}`,color:a.color,showAngleLabel:s.showAngleLabel,sliderInfo:s.sliderInfo})}return i}function l6(e,t,r){var n;let i=a=>{let s=a;return r[a]?s=r[a].rhs:t.isBeingCommitted&&(s=sV(a,t.getVariableNameForId)),s},o=a=>a.map(i);switch(e.type){case"point-reference":return{rhs:e.parents[0]};case"point":let{x:a,y:s}=e;return{rhs:"\\left("+__dcg_shared_module_exports__.be(a)+","+__dcg_shared_module_exports__.be(s)+"\\right)"};case"glider":return{rhs:"\\operatorname{glider}\\left("+o(e.parents)[0]+","+__dcg_shared_module_exports__.be(e.t)+"\\right)"};case"polygon":return{rhs:"\\operatorname{"+e.type+"}\\left("+o(e.parents).join(",")+"\\right)"};case"circle":case"arc":case"compass":case"segment":case"line":case"ray":case"parallel":case"perpendicular":case"anglebisector":case"intersection":case"midpoint":return{rhs:"\\operatorname{"+e.type+"}\\left("+o(e.parents).join(",")+"\\right)"};case"vector-copy":{let[u,p]=o(e.parents);return{rhs:`\\operatorname{translate}\\left(${u},${u}.\\operatorname{start},${p}\\right)`}}case"vector":return{rhs:"\\operatorname{"+e.type+"}\\left("+o(e.parents).join(",")+"\\right)"};case"vector-endpoint":return{rhs:`${o(e.parents)[0]}.\\operatorname{${e.location}}`};case"translate":case"reflect":case"dilate":case"rotate":{let u=e.type==="dilate"||e.type==="rotate"?[...o([e.parents[0]]),e.parents[1]]:o(e.parents);return{rhs:`\\operatorname{${e.type}}\\left(x,${u.join(",")}\\right)`,lhs:`${e.id}\\left(x\\right)`}}case"angle":case"directedangle":return{showAngleLabel:(n=e.showAngleLabel)!=null?n:!0,rhs:"\\operatorname{"+e.type+"}\\left("+o(e.parents).join(",")+"\\right)"};case"polygon-angle":case"polygon-directedangle":let l=e.type==="polygon-angle"?"angles":"directedangles",c=o(e.parents)[0],d=e.angleIndex;return{showAngleLabel:t.isBeingCommitted,rhs:`\\operatorname{${l}}\\left(${c}\\right)\\left[${d}\\right]`};case"polygon-segment":return{rhs:o(e.parents)[0]+(e.listAccess!==void 0?"\\left["+e.listAccess+"\\right]":"")+".\\operatorname{segments}\\left["+(e.edgeNumber+1)+"\\right]"};case"slider":return{lhs:e.lhsLatex,rhs:e.rhsLatex,sliderInfo:e.sliderInfo};case"expression-edit-preview-latex":return e.rhsLatex===""?void 0:{showAngleLabel:e.rhsLatex.trim().startsWith("\\operatorname{angle}\\left("),rhs:e.rhsLatex};default:return e}}function cV(e,t){__dcg_shared_module_exports__.Ob(e)?e.value.forEach((r,n)=>{let i=__dcg_shared_module_exports__.xb(e.valueType);if(__dcg_shared_module_exports__.Bb(i))throw new Error("Programming error: unexpected lambda type");t({valueType:i,value:r},n+1)}):t(e,void 0)}function Bv(e){let t=e.formula.geometry,r=t==null?void 0:t.identifier;return r?__dcg_shared_module_exports__.ma(r):"\\idref_{"+e.id+"}"}function Qg(e,t){let{controller:r,expandLists:n=!0}=e;r.getAllItemModels().concat(r.getAllToolPreviewItems()).forEach(i=>{var o;if(!il(i))return;let a=i.formula.typed_constant_value,s=i.formula.geometry,l=Bv(i),c=!r.getItemModel(i.id);n&&r.canExpandListForItem(i.id)?cV(a,(d,u)=>{var p;let g=l+(u===void 0?"":"\\left["+u+"\\right]"),f={calcId:i.id,data:s,hidden:!i.shouldGraph,isGraphableAndInteractive:!!((p=i.formula)!=null&&p.is_graphable)&&!e.controller.shouldIgnoreGraphInteractions(i),assignment:l,listIndex:u!==void 0?u-1:void 0,typedRuntimeValue:d,referenceLatex:g};t(f,c)}):t({calcId:i.id,data:s,hidden:!i.shouldGraph,isGraphableAndInteractive:!!((o=i.formula)!=null&&o.is_graphable)&&!e.controller.shouldIgnoreGraphInteractions(i),assignment:l,listIndex:void 0,typedRuntimeValue:a,referenceLatex:l},c)})}function cne(e,t){switch(e.valueType){case __dcg_shared_module_exports__.Da:return{valueType:__dcg_shared_module_exports__.ya,value:e.value[t]};case __dcg_shared_module_exports__.Oa:return{valueType:__dcg_shared_module_exports__.Na,value:e.value[t]};case __dcg_shared_module_exports__.Ma:return{valueType:__dcg_shared_module_exports__.La,value:e.value[t]};case __dcg_shared_module_exports__.Ua:return{valueType:__dcg_shared_module_exports__.Ta,value:e.value[t]};case __dcg_shared_module_exports__.ab:return{valueType:__dcg_shared_module_exports__.$a,value:e.value[t]};case __dcg_shared_module_exports__.Sa:return{valueType:__dcg_shared_module_exports__.Ra,value:e.value[t]};case __dcg_shared_module_exports__.Ka:return{valueType:__dcg_shared_module_exports__.Ja,value:e.value[t]};case __dcg_shared_module_exports__.Qa:return{valueType:__dcg_shared_module_exports__.Pa,value:e.value[t]};case __dcg_shared_module_exports__.Wa:return{valueType:__dcg_shared_module_exports__.Va,value:e.value[t]};case __dcg_shared_module_exports__.Ya:return{valueType:__dcg_shared_module_exports__.Xa,value:e.value[t]};case __dcg_shared_module_exports__.Ea:case __dcg_shared_module_exports__.Ba:case __dcg_shared_module_exports__.eb:case __dcg_shared_module_exports__._a:case __dcg_shared_module_exports__.Ca:case __dcg_shared_module_exports__.cb:case __dcg_shared_module_exports__.Ia:case __dcg_shared_module_exports__.gb:case __dcg_shared_module_exports__.ib:case __dcg_shared_module_exports__.kb:case __dcg_shared_module_exports__.mb:case __dcg_shared_module_exports__.ob:case __dcg_shared_module_exports__.qb:throw new Error("Programming Error: unexpected type "+__dcg_shared_module_exports__.vb(e.valueType));default:throw e.valueType,new Error("Programming Error: expected a list type but found "+__dcg_shared_module_exports__.vb(e.valueType))}}function dV(e,t){return ie(R({},e),{referenceLatex:e.assignment+"\\left["+t+"\\right]",typedRuntimeValue:cne(e.typedRuntimeValue,t),listIndex:t})}function KD(e){switch(e){case __dcg_shared_module_exports__.ya:return"Point";case __dcg_shared_module_exports__.Na:return"Circle";case __dcg_shared_module_exports__.Pa:return"Arc";case __dcg_shared_module_exports__.Ja:return"Polygon";case __dcg_shared_module_exports__.Ra:return"Line";case __dcg_shared_module_exports__.La:return"Segment";case __dcg_shared_module_exports__.Ta:return"Ray";case __dcg_shared_module_exports__.$a:return"Vector";case __dcg_shared_module_exports__.Va:return"Angle";case __dcg_shared_module_exports__.Xa:return"Angle"}}function c6(e){if(!e)return;let t=e.typedRuntimeValue;return KD(t.valueType)}var _c=class{constructor(e){this.model=e,this.s=e.s}createOutput(){return this.model.createCustomToolOutput(this.getSpec())}clearTentativeOutputs(){let e=this.getSpec(),t={},r=this.model.getNonObjectsState().ui.currentTool.idMap;for(let n in r){let i=r[n];!this.model.isObjectALockedToolInput(i)&&this.model.isObjectUncommitted(i)&&(t[n]=i)}this.model.deleteObjectsAndRememberReusableId(t),this.model.tentativelyMatchToolInput(e,""),this.createOutput()}didLockInput(e){var t;let{currentTool:r}=this.model.getNonObjectsState().ui,n=r.inputIndex,i=e.inputs[n];i&&(t=i.numberInputInfo)!=null&&t.defaultLatex&&!r.idMap[i.id]&&this.onNumberInput(i.numberInputInfo.defaultLatex)}shouldReferenceSpecificItemInList(e,t){return!t}getExpandedReferenceForDef(e,t){return this.shouldReferenceSpecificItemInList(e,t)?e.referenceLatex:e.assignment}getListIndexForHover(e,t){if(this.shouldReferenceSpecificItemInList(e,t))return e.listIndex}_getOrCreatePoint(e,t,r){let n=this.model.getOrCreatePointNearMouse(e,r);if(n.type==="def")return{createdNew:!1,def:n.def,reference:this.getExpandedReferenceForDef(n.def,t),previewOnly:!1};let i=this.createPointDefinition(n.spec,t),o=n.spec.type==="point-reference"?n.spec.targetSpec.parentDefs:n.spec.parentDefs,a=0;for(let s=0;s<o.length;s++){let l=o[s];if(l.polygonEdgeInfo){let c=this.model.createToolInputDependency({type:"polygon-segment",parents:[l.polygonEdgeInfo.polygonDef.referenceLatex],edgeNumber:l.polygonEdgeInfo.edgeNumber||0,polygonColor:this.getPolygonEdgeColor(l)},this.getSpec(),a);i.parents[s]=c,a+=1,this.model.setObjectHovered({tokenId:c,listIndex:void 0})}else this.model.setObjectHovered({calcId:l.calcId,listIndex:this.getListIndexForHover(l,t)})}return{createdNew:!0,def:void 0,reference:this.model._createInputObject(i),previewOnly:i.type==="point"&&i.previewOnly}}_isReadyToCommit(){return this.model.getNonObjectsState().ui.currentTool.inputIndex>=this.getSpec().inputs.length}_getFirstMissingInput(){let{inputIndex:e}=this.model.getNonObjectsState().ui.currentTool;return this.getSpec().inputs[e]}canNextInputBePoint(){let e=this._getFirstMissingInput();return e&&e.type==="point"?!0:!!(e&&e.type==="union"&&e.valueTypes.indexOf(__dcg_shared_module_exports__.ya)!==-1)}getNonPointInputType(){let e=this._getFirstMissingInput();if(!(!e||e.type==="point"))return e.type==="union"?e:e.type}isValidNextInputType(e){if(this.canNextInputBePoint()&&__dcg_shared_module_exports__.ua(e,__dcg_shared_module_exports__.ya))return!0;let t=this._getFirstMissingInput();if(!t)return!1;let r=[];if(t.type==="union")r=t.valueTypes;else{let n=t.type;switch(n){case"point":r=[__dcg_shared_module_exports__.ya];break;case"straight":r=[...__dcg_shared_module_exports__.zb.types];break;case"angle":r=[__dcg_shared_module_exports__.Va,__dcg_shared_module_exports__.Xa];break;case"arc":r=[__dcg_shared_module_exports__.Pa];break;case"circle":r=[__dcg_shared_module_exports__.Na];break;case"polygon":r=[__dcg_shared_module_exports__.Ja];break;case"segment":r=[__dcg_shared_module_exports__.La];break;case"vector":r=[__dcg_shared_module_exports__.$a];break;default:return n}}return t.numberInputInfo&&r.push(__dcg_shared_module_exports__.wa),r.some(n=>__dcg_shared_module_exports__.ua(e,n))}getAllValidNextInputTypes(){return __dcg_shared_module_exports__.tb.filter(e=>this.isValidNextInputType(e))}getHint(){let e=this._getFirstMissingInput();return e?e.hint!==void 0?this.s(e.hint):this.s("graphing-calculator-text-geometry-select-hint",{type:e.type}):""}getSpecIdToLockIn(e,t){let r=e.inputs[t];if(r)return r.id}tryCommitResults(){if(this.model.attemptLockToolInputIn(this.getSpec()),this._isReadyToCommit()){let e=this.model.getUncommittedObjects();for(let r in e)e[r].type==="expression-edit-preview-latex"&&delete e[r];let t=R({},this.model.getNonObjectsState().ui.currentTool.idMap);return this.model.commitObjects(),this.model.deselectAllObjects(),this.model.cancelToolplay(),{committed:e,toolIdToLatex:t}}return{committed:void 0}}tentativelyAddInput({target:e,pointInfo:t},r){var n,i;let o;if(e)if(e.polygonEdgeInfo){let a=this.model.createToolInputDependency({type:"polygon-segment",parents:[(n=e.polygonEdgeInfo)==null?void 0:n.polygonDef.referenceLatex],edgeNumber:((i=e.polygonEdgeInfo)==null?void 0:i.edgeNumber)||0,polygonColor:this.getPolygonEdgeColor(e)},this.getSpec(),0);this.model.setObjectHovered({tokenId:a,listIndex:void 0}),o=a}else o=this.getExpandedReferenceForDef(e,r),this.model.setObjectHovered({calcId:e.calcId,listIndex:this.getListIndexForHover(e,r)});else t&&(o=t.reference,t!=null&&t.def&&!t.createdNew&&!t.previewOnly&&this.model.setObjectHovered({calcId:t.def.calcId,listIndex:this.getListIndexForHover(t.def,r)}));o&&this.model.tentativelyMatchToolInput(this.getSpec(),o)}onFocus(e){this.clearTentativeOutputs(),e&&this.tentativelyAddInput({target:e},!1),this.createOutput()}onMove(e){this.clearTentativeOutputs();let t=this.canNextInputBePoint(),r=this.getNonPointInputType(),n=!1;if(r){let i=this.model.getObjectDefUnderMouse(e.pt,e.tolerance,this.model.getCurrentTool());i&&this.model.objectIsInstanceOf(i,r)&&(this.tentativelyAddInput({target:i},e.shift),n=!0)}if(!n&&t){let i=this._getOrCreatePoint(e.pt,e.shift,e.tolerance);n=!i.previewOnly,this.isDegenerateInput(i.reference)?i.def&&this.model.setObjectHovered({calcId:i.def.calcId,listIndex:this.getListIndexForHover(i.def,e.shift)}):this.tentativelyAddInput({pointInfo:i},e.shift)}return this.createOutput(),n}isDegenerateInput(e){return!!this.model.getNonObjectsState().ui.currentTool.lockedIds[e]}getNumberInputLatex(){let e=this.getSpec(),{inputIndex:t,idMap:r}=this.model.getNonObjectsState().ui.currentTool,n=e.inputs[t];return n!=null&&n.numberInputInfo&&r[`${n.id}-number`]||""}onNumberInput(e){this.clearTentativeOutputs();let t=this.getSpec();this.model.storeNumberInputLatex(t,e),this.createOutput()}createPointDefinition(e,t){let r=e.parentDefs,n;switch(e.type){case"point-reference":{n={type:"point-reference",parents:[this.getExpandedReferenceForDef(r[0],t)]};break}default:{let i=r.map(o=>this.getExpandedReferenceForDef(o,t));n=ie(R({},e),{parents:i})}}return n}shouldUseJitEdges(){return!0}shouldHighlightRelevantObjects(){return!0}getPolygonEdgeColor(e){var t;let{ui:r}=this.model.getNonObjectsState(),n=e.polygonEdgeInfo?this.model.controller.getItemModel(e.polygonEdgeInfo.polygonDef.calcId):void 0;if((n==null?void 0:n.type)!=="expression")return r.colors.line;let i=bE(n)&&yE(n);return e.listIndex!==void 0&&Array.isArray(i)?(t=i[e.listIndex])!=null?t:r.colors.line:typeof i=="string"?i:n.color}};function WD(e,t){if(typeof t=="object")return t.valueTypes.some(r=>__dcg_shared_module_exports__.ua(e,r));switch(t){case"point":return e===__dcg_shared_module_exports__.ya;case"straight":return e===__dcg_shared_module_exports__.Ra||e===__dcg_shared_module_exports__.Ta||e===__dcg_shared_module_exports__.La||e===__dcg_shared_module_exports__.$a;case"angle":return e===__dcg_shared_module_exports__.Va||e===__dcg_shared_module_exports__.Xa;case"arc":return e===__dcg_shared_module_exports__.Pa;case"circle":return e===__dcg_shared_module_exports__.Na;case"polygon":return e===__dcg_shared_module_exports__.Ja;case"segment":return e===__dcg_shared_module_exports__.La;case"vector":return e===__dcg_shared_module_exports__.$a;default:return t}}var jD=class Ho{constructor(t,r){this.value=t,this.valueType=r}static point(t){return new Ho(t,__dcg_shared_module_exports__.ya)}static polygonSegment(t){return new Ho(t,__dcg_shared_module_exports__.La)}},Vr=class extends _c{constructor(e,t){super(e),this.definition=t,this.s=e.s,this.displayName=t.displayName,this.toolType=t.toolType,this.toolName=t.name,this.icon=t.icon,this.workflows=t.workflows.map(r=>{let n=r.input.broadcast?__dcg_shared_module_exports__.Db(r.input.types,{geometry:!0}):__dcg_shared_module_exports__.Cb(r.input.types,{geometry:!0});return ie(R({},r),{signature:n})})}getWorkflows(){return this.workflows}getMatchingWorkflow(e){let t=e.map(o=>o.valueType),r=this.workflows.filter(o=>o.signature.matches(t));if(r.length===0)return;let n=r.find(o=>t.length>=o.signature.minArity),i=n!=null&&n.canCommit?n.canCommit(e):!!n;return{firstMatch:n!=null?n:r[0],canCommit:i,allMatches:r,inputs:e,argTypes:t}}getInputAtIndex(e){let{idMap:t}=this.model.getNonObjectsState().ui.currentTool,r=t[`${e}`];if(r)return this.getInputById(r)}getInputById(e){let t=this.model.getUncommittedObjects()[e];if(t&&dne(t))return jD.point(t);if(t&&t.type==="polygon-segment")return jD.polygonSegment(t);let r=this.model.findDefsForInputId(e)[0];return r==null?void 0:r.typedRuntimeValue}getMatchingWorkflowForCurrentInputs(e=1/0){let{inputIndex:t}=this.model.getNonObjectsState().ui.currentTool,r=[];for(let n=0;n<=Math.min(t,e);n++){let i=this.getInputAtIndex(n);if(i===void 0)break;r.push(i)}return this.getMatchingWorkflow(r)}canNextInputBePoint(){let{inputIndex:e}=this.model.getNonObjectsState().ui.currentTool,t=this.getMatchingWorkflowForCurrentInputs(e-1);return!!(t!=null&&t.allMatches.some(r=>{let n=r.signature.argTypeAtIndex(e);return n===void 0?!1:__dcg_shared_module_exports__.Eb(__dcg_shared_module_exports__.ya,n)}))}isDegenerateInput(e){if(this.definition.isDegenerateInput){let t=this.getMatchingWorkflowForCurrentInputs(),r=this.getInputById(e);return r?this.definition.isDegenerateInput({previousInputs:(t==null?void 0:t.inputs)||[],proposedInput:r}):!1}return super.isDegenerateInput(e)}getSpec({isCommitting:e}={isCommitting:!1}){var t,r;let n=this.getMatchingWorkflowForCurrentInputs();if(!n)return{inputs:[],outputs:[]};let{inputIndex:i}=this.model.getNonObjectsState().ui.currentTool,o=n.firstMatch,a=[],s=(t=o.signature.maxArity)!=null?t:i+1;for(let l=0;l<s;l++){let c=o.signature.argTypeAtIndex(l);if(!c)throw new Error(`Expected arg type for arg ${l}`);if(d6(c)){let d=[];if(l===i){let u=this.getMatchingWorkflowForCurrentInputs(l-1);for(let p of(r=u==null?void 0:u.allMatches)!=null?r:[]){let g=p.signature.argTypeAtIndex(l);g&&!d6(g)&&d.push(...typeof g=="number"?[g]:g.getTypes())}}d.length>0?a.push({id:`${l}`,type:"union",hint:$D(o,l),valueTypes:[...d,__dcg_shared_module_exports__.ya]}):a.push({id:`${l}`,type:"point",hint:$D(o,l)})}else a.push({id:`${l}`,type:"union",hint:$D(o,l),valueTypes:typeof c=="number"?[c]:c.getTypes().slice()})}return{inputs:a,outputs:pV(o,n.inputs,e)}}tryCommitResults(){var e;if(this.model.attemptLockToolInputIn(this.getSpec()),(e=this.getMatchingWorkflowForCurrentInputs())!=null&&e.canCommit){this.clearTentativeOutputs(),this.model.createCustomToolOutput(this.getSpec({isCommitting:!0}));let t=this.model.getUncommittedObjects();for(let n in t)t[n].type==="expression-edit-preview-latex"&&delete t[n];let r=R({},this.model.getNonObjectsState().ui.currentTool.idMap);return this.model.commitObjects(),this.model.deselectAllObjects(),this.model.cancelToolplay(),{committed:t,toolIdToLatex:r}}return{committed:void 0}}getExpressionEditHint(e){var t;let r=(t=this.getMatchingWorkflowForCurrentInputs())==null?void 0:t.firstMatch;return r?this.s($D(r,e)):""}shouldReferenceSpecificItemInList(e,t){var r,n;if(t){let{inputIndex:i}=this.model.getNonObjectsState().ui.currentTool;return!((n=(r=this.getMatchingWorkflowForCurrentInputs())==null?void 0:r.allMatches)!=null?n:[]).some(o=>{let a=o.signature.argTypeAtIndex(i);return a===void 0?!1:typeof a=="number"?__dcg_shared_module_exports__.wb(a):a.getTypes().some(__dcg_shared_module_exports__.wb)})}else return!0}};function pV(e,t,r){let n;return Array.isArray(e.output)?n=e.output:n=e.output({inputs:t,isCommitting:r}),n.map((i,o)=>ie(R({},i),{id:`result-${o}`,hidden:!1,parents:i.parents.map(a=>({type:"reference-input",id:`${a}`}))}))}function d6(e){return typeof e=="number"?e===__dcg_shared_module_exports__.ya:e.getTypes().every(t=>__dcg_shared_module_exports__.Ab(t,__dcg_shared_module_exports__.ya))}function $D(e,t){return Array.isArray(e.input.hints)?e.input.hints[t]:e.input.hints(t)}function dne(e){switch(e.type){case"point":case"intersection":case"glider":case"point-reference":case"midpoint":case"vector-endpoint":return!0;default:return e.type,!1}}var Kp=__dcg_shared_module_exports__.e(ne()),by=class extends Kp.Class{template(){return Kp.createElement("div",{class:Kp.const("dcg-dot-dot-dropdown")},Kp.createElement("i",{class:Kp.const("dcg-icon-ellipsis-vertical"),"aria-hidden":Kp.const("true")}))}},yy=__dcg_shared_module_exports__.e(ne());qt();var p6='a, input, button:not([disabled]), textarea, select [role="textbox"], [tabIndex="0"], [role="option"], [role="button"], [role="link"], summary',YD=class{constructor({closeMenu:e,focusIcon:t,getIconSelector:r,getContainerEl:n,isIconFocused:i}){this.globalKeyDownListener=o=>{let a=ke(o);if(a===kn){o.preventDefault(),o.stopPropagation(),this.focusIcon(),this.closeMenu();return}if(a==="Tab"&&!o.altKey&&!o.ctrlKey&&!o.metaKey){if(this.isIconFocused()){o.shiftKey?this.focusLastOption():this.focusFirstOption(),o.preventDefault(),o.stopPropagation();return}if(this.isLastOptionViewFocused()&&!o.shiftKey){this.focusIcon(),o.preventDefault(),o.stopPropagation();return}if(this.isFirstOptionViewFocused()&&o.shiftKey){this.focusIcon(),o.preventDefault(),o.stopPropagation();return}}},this.tapListener=o=>{let a=this.getContainerEl();if(!a)return;let{target:s}=o,l=this.getIconSelector();if(!(l&&s.closest(l))){if(a.contains(s)){if(!s.matches(p6))return;let{first:c,last:d}=this.getDOMTabStops();c===s?this.focusFirstOption():d===s&&this.focusLastOption();return}Array.from(document.querySelectorAll(".dcg-keypad,.dcg-show-keypad-container")).some(c=>c.contains(s))||this.closeMenu()}},this.closeMenu=e,this.getContainerEl=n,this.getIconSelector=r,this.isIconFocused=i,this.focusIcon=t}isFirstOptionViewFocused(){let{first:e}=this.getDOMTabStops();return e!==void 0&&e.matches(":focus")}focusFirstOption(){let{first:e}=this.getDOMTabStops();e!==void 0&&e.focus()}focusLastOption(){let{last:e}=this.getDOMTabStops();e!==void 0&&e.focus()}isLastOptionViewFocused(){let{last:e}=this.getDOMTabStops();return e!==void 0&&e.matches(":focus")}getDOMTabStops(){let e=this.getContainerEl();if(e===void 0)return{};let t=Array.from(e.querySelectorAll(p6)).filter(r=>r.getAttribute("tabIndex")!=="-1");return{first:t.find(r=>bp(r)),last:[...t.reverse()].find(r=>bp(r))}}},ps=class extends yy.Class{init(){this.controller=this.props.controller()}template(){return yy.createElement("div",{class:yy.const("dcg-options-menu-container"),didMount:this.bindFn(this.didMountView),didUnmount:this.bindFn(this.didUnmountView)},this.props.children)}didMount(){this.props.openAriaAlert&&xe(this.props.openAriaAlert())}willUnmount(){this.props.closeAriaAlert&&xe(this.props.closeAriaAlert())}didMountView(e){this.focusHelper=new YD({isIconFocused:()=>this.isIconModelFocused(),focusIcon:()=>this.focusIcon(),getContainerEl:()=>this.openView,closeMenu:()=>this.hideOptions(),getIconSelector:()=>{var t;return`[dcg-open-menu-guid="${(t=this.controller.getOpenItemMenu())==null?void 0:t.guid}"]`}}),this.guid=__dcg_shared_module_exports__.K("dcg-dropdown-menu"),this.openView=e,this.positionMenu(),this.moveFocusIfAppropriate(),this.attachKeyDownListeners(),this.attachTapListener()}isIconModelFocused(){let e=this.controller.getFocusLocation();return __dcg_shared_module_exports__.E(e,this.props.menuButtonFocusLocation())}attachKeyDownListeners(){this.props.shouldHandleTabAndEscape()&&document.addEventListener("keydown",this.focusHelper.globalKeyDownListener)}attachTapListener(){ee(document.body).on(`dcg-tapstart.${this.guid}`,this.focusHelper.tapListener)}didUnmountView(){document.removeEventListener("keydown",this.focusHelper.globalKeyDownListener),ee(document.body).off(`.${this.guid}`),this.openView=void 0}moveFocusIfAppropriate(){this.shouldMoveFocusToFirstOption()?this.focusHelper.focusFirstOption():this.shouldMoveFocusToLastOption()&&this.focusHelper.focusLastOption()}hideOptions(){this.controller.dispatch({type:"close-item-settings-menu"})}getRootEl(){return this.controller.findEl(this.props.rootElSelector())}positionMenu(){var e;let t=this.controller.getOpenMenuIcon();if(!t||!this.openView)return;let r=this.getRootEl();if(!r)return;let n=r.getBoundingClientRect(),i=t.getBoundingClientRect(),o=i.width;if(this.props.menuType()==="geo-tool-dropdown"||this.props.menuType()==="multi-select-construct"||this.props.menuType()==="multi-select-style"||this.props.menuType()==="multi-select-label"||this.props.menuType()==="multi-select-more"){Wn(this.openView,{display:"block"});let a=(e=this.openView.querySelector(".dcg-options-menu"))==null?void 0:e.getBoundingClientRect();if(!a)return;let s=i.left-n.left,l=n.right-(i.left+o);s+o/2>=a.width/2&&l+o/2>=a.width/2?Wn(this.openView,{top:`${i.top-n.top}px`,left:`${s+o/2-a.width/2}px`}):s<l?Wn(this.openView,{top:`${i.top-n.top}px`,left:"0px"}):Wn(this.openView,{top:`${i.top-n.top}px`,right:`${a.width}px`})}else Wn(this.openView,{top:`${i.top-n.top}px`,left:`${i.left-n.left}px`,display:"block"})}focusIcon(){this.controller.focusOpenMenuIcon()}shouldMoveFocusToFirstOption(){if(this.props.focusOnOpen)return this.props.focusOnOpen()==="first";if(this.openView&&this.openView.matches(":focus-within"))return!1;let e=this.controller.getOpenItemMenu();return(e==null?void 0:e.type)===this.props.menuType()&&!!(e!=null&&e.focusFirstOption)}shouldMoveFocusToLastOption(){return this.props.focusOnOpen?this.props.focusOnOpen()==="last":!1}},Zg=__dcg_shared_module_exports__.e(ne()),XD=class extends Zg.Class{onSpanMount(e){e.insertAdjacentHTML("beforeend",'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><style>.cls-1{fill:#7c69b3}.cls-3{fill:#719972}</style></defs><g id="Layer_1"><path d="M35.3 45.6ZM7.2 97.3z" class="cls-3"/><path fill="#fff" d="M7.2 97.3"/><path d="M47.7 39.8c2.5-2.9 3.7-6.3 3.7-10.3s-1-6.6-3-9.3c-2-2.7-4.6-4.6-7.7-5.7V2.7H30v11.8c-3.1 1.1-5.7 3-7.7 5.7s-3 5.8-3 9.3 1.3 7.6 3.9 10.5L4.7 89.4l2.5 7.9 8.2-5.1 17.1-46.9c.9.2 1.9.2 2.8.2 1.1 0 2.1 0 3.1-.3l16.8 47.1 8.2 4.3 1.7-8.2-17.5-48.7Zm-16.2-6.5c-1-1-1.5-2.3-1.5-3.8s.5-2.8 1.5-3.8 2.3-1.5 3.8-1.5 2.8.5 3.8 1.5 1.5 2.3 1.5 3.8-.5 2.8-1.5 3.8-2.3 1.5-3.8 1.5-2.8-.5-3.8-1.5Z" class="cls-3"/><path d="m49.8 94.3-9.9-27.8-8.7 15.6c-.6 1.1-.2 2.5.8 3.2l17.6 10.5c.4.2.8.3 1.2.3-.4-.5-.8-1.1-1-1.8ZM94.1 16 76.5 5.5c-1.1-.6-2.5-.3-3.1.8L54.2 40.8l11.3 31.3 29.5-53c.6-1.1.2-2.5-.8-3.2Z" class="cls-1"/></g></svg>')}template(){return Zg.createElement("span",{"aria-hidden":Zg.const("true"),class:Zg.const("dcg-construct-button-icon"),onMount:this.bindFn(this.onSpanMount)})}},_r=__dcg_shared_module_exports__.e(ne()),JD=__dcg_shared_module_exports__.e(ne());function h6(e,t,r){e.save();for(let n of r)switch(n.type){case"point":{let i;!n.color||n.color==="dark"?i=GT({isPoint:!0,color:t.point,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):n.color==="light"?i=__dcg_shared_module_exports__.Kd(t.point,.7):i=n.color;let o;switch(n.size){case"small":o=5;break;case"large":o=10;break;case"medium":default:o=5;break}n.hollow?(e.lineWidth=2,e.strokeStyle=i,e.beginPath(),e.arc(n.x,n.y,o-1,0,2*Math.PI),e.stroke()):(e.fillStyle=i,e.beginPath(),e.arc(n.x,n.y,o,0,2*Math.PI),e.fill())}break;case"circle":{let i;!n.color||n.color==="dark"?i=tv({isPoint:!1,color:t.circle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):n.color==="light"?i=__dcg_shared_module_exports__.Kd(t.circle,.7):typeof n.color=="function"?i=n.color(t):i=n.color;let o;switch(n.lineWidth){case"small":o=2;break;case"large":o=7;break;case"medium":case void 0:o=4;break;default:o=n.lineWidth;break}e.lineWidth=o,e.strokeStyle=i,e.beginPath(),e.arc(n.x,n.y,n.radius,0,2*Math.PI),e.stroke()}break;case"arc":{let i;!n.color||n.color==="dark"?i=tv({isPoint:!1,color:t.circle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):n.color==="light"?i=__dcg_shared_module_exports__.Kd(t.circle,.7):i=n.color;let o;switch(n.lineWidth){case"small":o=2;break;case"large":o=7;break;case"medium":default:o=4;break}e.lineWidth=o,e.strokeStyle=i,e.beginPath(),e.arc(n.x,n.y,n.radius,n.startAngle,n.endAngle),e.stroke()}break;case"stroked-path":{let i;!n.color||n.color==="dark"?i=tv({isPoint:!1,color:t.line,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):n.color==="light"?i=__dcg_shared_module_exports__.Kd(t.line,.7):typeof n.color=="function"?i=n.color(t):i=n.color;let o=n.path,a;switch(n.lineWidth){case"small":a=1;break;case"large":a=5;break;case"medium":default:a=3;break}e.lineCap="round",e.lineJoin="round",e.strokeStyle=i,e.lineWidth=a,e.beginPath(),e.moveTo(o[0],o[1]);for(let s=2;s<o.length;s+=2)e.lineTo(o[s],o[s+1]);if(n.arrow){let s=[],l=o.length-1;une(s,o[l-3],o[l-2],o[l-1],o[l],a/2+9.5);for(let c=0;c<s.length;c+=2)e.lineTo(s[c],s[c+1])}e.stroke()}break;case"filled-polygon":{let i;n.color?i=n.color:i=GT({isPoint:!1,color:t.polygon,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1,isTransparentObject:!0});let o=n.path;e.fillStyle=i,e.beginPath(),e.moveTo(o[0],o[1]);for(let a=2;a<o.length;a+=2)e.lineTo(o[a],o[a+1]);e.fill()}break;case"angle":{let i=tv({isPoint:!1,color:t.angle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1,isTransparentObject:!0}),o=GT({isPoint:!1,color:t.angle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1,isTransparentObject:!0});pne(e,{type:"angle-indicator",lineWidth:4,strokeStyle:i,fillStyle:o,isRightAngle:!1,x:n.x,y:n.y,isDirected:n.isDirected,radius:n.radius,startAngle:n.startAngle,deltaAngle:n.deltaAngle})}break;case"ellipse":e.lineWidth=n.lineWidth,e.strokeStyle=n.color,e.beginPath(),e.ellipse(n.x,n.y,n.rx,n.ry,0,0,2*Math.PI),e.stroke();break;default:return n}e.restore()}function pne(e,t){e.beginPath(),u6(e,t),e.lineTo(t.x,t.y),e.lineTo(t.x+t.radius*Math.cos(t.startAngle),t.y+t.radius*Math.sin(t.startAngle)),t.isDirected||(e.fillStyle=t.fillStyle,e.fill()),e.strokeStyle=t.strokeStyle,e.lineWidth=t.lineWidth,e.beginPath(),u6(e,t),e.stroke()}function u6(e,t){let r=t.startAngle+t.deltaAngle;e.arc(t.x,t.y,t.radius,t.startAngle,r)}function une(e,t,r,n,i,o=12){let a=Math.atan2(i-r,n-t),s=n-o*Math.cos(a-Math.PI/9),l=i-o*Math.sin(a-Math.PI/9),c=n-o*Math.cos(a+Math.PI/9),d=i-o*Math.sin(a+Math.PI/9),u=n-(o-2)*Math.cos(a-Math.PI/18),p=i-(o-2)*Math.sin(a-Math.PI/18),g=n-(o-2)*Math.cos(a+Math.PI/18),f=i-(o-2)*Math.sin(a+Math.PI/18);e.push(s,l,c,d,n,i,u,p,g,f,n,i)}var em=class extends JD.Class{template(){return JD.createElement("canvas",{didMount:this.bindFn(this.didMountCanvas),width:()=>this.props.width(),height:()=>this.props.height(),style:()=>({width:this.props.width()/2+"px",height:this.props.height()/2+"px"})})}didMountCanvas(e){this.canvas=e,this.redraw()}didUpdate(){this.redraw()}redraw(){let e=this.props.instructions()||[],t=this.props.model().getNonObjectsState().ui.colors;if(__dcg_shared_module_exports__.E(e,this.lastInstructions)&&__dcg_shared_module_exports__.E(t,this.lastColors))return;this.lastInstructions=e,this.lastColors=t;let r=this.canvas.getContext("2d");r.clearRect(0,0,r.canvas.width,r.canvas.height),h6(r,t,e)}},pa=__dcg_shared_module_exports__.e(ne()),{For:hne,Each:gne,SwitchUnion:mne}=pa.Components,xy=class extends pa.Class{init(){this.controller=this.props.controller(),this.geoModel=this.controller.getGeoModel()}template(){return pa.createElement("div",{class:()=>({"dcg-options-menu":!0,"dcg-select-tools-dropdown":!0,"dcg-shift-menu-left":this.props.items()[0][0]==="angle"||this.props.items()[0][0]==="segment"}),"aria-label":this.props.ariaLabel,onKeyDown:this.bindFn(this.handleKeyPress),"dcg-geo-tool-group":this.bindFn(this.props.group)},pa.createElement("div",{class:pa.const("dcg-options-menu-section-container"),role:pa.const("menu")},gne(()=>this.props.items(),{item:e=>pa.createElement("div",{class:()=>({"dcg-options-menu-section":!0})},pa.createElement(hne,{each:()=>e},t=>pa.createElement("button",{role:pa.const("menuitemradio"),tabIndex:()=>t===e[0]&&this.sectionKey(e)===this.sectionKey(this.props.items()[0])?0:-1,"aria-disabled":()=>!this.isToolEnabled(t),"aria-description":()=>this.isToolEnabled(t)?void 0:this.controller.s("graphing-calculator-narration-geometry-tool-disabled",{tool:t}),"aria-checked":()=>this.controller.getActiveTool()===t,onTap:r=>{this.isToolEnabled(t)&&this.props.onChooseTool({tool:t,fromKeyboard:r.device==="keyboard"})},"dcg-geo-tool":this.const(t),class:()=>({"dcg-dropdown-tool":!0,"dcg-unstyled-button":!0,"dcg-transformation-tool":__dcg_shared_module_exports__.Dc(t),"dcg-selected-tool":this.controller.getActiveTool()===t,"dcg-disabled":!this.isToolEnabled(t),"dcg-will-be-hidden-or-disabled":this.controller.toolWillBeHiddenOrDisabled(t)}),manageFocus:this.const(rt({controller:this.controller,location:{type:"geo-basic-tool-menu-item",tool:t}}))},mne("type",()=>this.getIconInfo(t))({css:r=>pa.createElement("i",{class:()=>r().className}),canvas:r=>pa.createElement(em,{model:()=>this.geoModel,width:this.const(100),height:this.const(100),instructions:()=>r().instructions})}),pa.createElement("span",null,()=>this.geoModel.getDisplayNameForTool(t))))),key:e=>this.sectionKey(e)})),this.props.children)}sectionKey(e){return e.join("-")}getIconInfo(e){switch(e){case"dilate":return{type:"css",className:"dcg-icon-dilation"};case"reflect":return{type:"css",className:"dcg-icon-reflection"};case"rotate":return{type:"css",className:"dcg-icon-rotation"};case"translate":return{type:"css",className:"dcg-icon-vector"};default:return{type:"canvas",instructions:this.geoModel.getIconInstructionsForTool(e)}}}isToolEnabled(e){return this.controller.isGeoToolEnabled(e)&&this.geoModel.isToolActuallyUsable(e)}handleKeyPress(e){let t=ke(e);if(t!=="Up"&&t!=="Down"&&t!=="Esc")return;let r=__dcg_shared_module_exports__.t(this.props.items()),n=this.controller.getFocusLocation();if(t==="Esc"){(n==null?void 0:n.type)==="geo-basic-tool-menu-item"&&this.focusMenuIcon(),this.controller.dispatch({type:"close-item-settings-menu"}),e.stopPropagation(),e.preventDefault();return}if((n==null?void 0:n.type)!=="geo-basic-tool-menu-item")return;let i=t==="Down"?1:-1,o=(r.indexOf(n.tool)+i)%r.length;o<0&&(o=r.length+o),o>=0&&(this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool-menu-item",tool:r[o]}}),e.preventDefault(),e.stopPropagation())}focusMenuIcon(){let e=this.props.group();if(!e)return;if(e==="construct-from-selection")return this.controller.dispatch({type:"set-focus-location",location:{type:"multi-select-construct-icon"}});let t=this.controller.getGeoToolbarItemsForGroup(e),r=t==null?void 0:t.current;if(r)return this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:r}})}},{If:g6,For:fne,Switch:bne}=_r.Components,tm=class extends _r.Class{getAriaLabel(){let e=this.props.controller(),t=this.props.menuName();if(t)return e.s("graphing-calculator-label-geometry-tools-open-dropdown-menu-transformation",{item:t})}template(){return _r.createElement("span",{class:_r.const("dcg-tool-dropdown"),role:_r.const("button"),tabIndex:_r.const("-1"),"aria-label":this.bindFn(this.getAriaLabel),"aria-expanded":this.props.ariaExpanded,onTap:this.bindFn(this.handleOnTap)},_r.createElement("span",{class:_r.const("dcg-dropdown-icon")},_r.createElement("i",{class:_r.const("dcg-icon-caret-down")})))}handleOnTap(e){e.handle(),this.props.openDropDown()}},QD=class extends _r.Class{init(){this.controller=this.props.controller(),this.geoModel=this.controller.getGeoModel()}getGroups(){return this.controller.getGeoToolbarGroupKeys()}hasDropdown(e){return!!this.getGroup(e).dropdown}template(){return _r.createElement("div",{role:_r.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-label-geometry-tools"),class:_r.const("dcg-geo-basic-tools dcg-animate-in-after-initial-load"),onKeyDown:e=>this.handleToolbarKeydown(e)},_r.createElement("div",{class:_r.const("dcg-geo-basic-tools-row")},_r.createElement(fne,{each:()=>this.getGroups()},e=>_r.createElement("div",{class:_r.const("dcg-tool-button-container")},_r.createElement("button",{class:()=>({"dcg-split-btn":this.hasDropdown(e),"dcg-selected":this.isGroupSelected(this.getGroup(e)),"dcg-disabled":!this.isGroupEnabled(this.getGroup(e)),"dcg-menu-open":this.isGroupDropdownOpen(this.getGroup(e)),"dcg-will-be-hidden-or-disabled":this.controller.toolWillBeHiddenOrDisabled(this.getGroup(e).current)}),"dcg-geo-tool":()=>this.getGroup(e).current,"dcg-geo-tool-group":()=>e,tabIndex:()=>this.isGroupSelected(this.getGroup(e))?0:-1,"aria-label":()=>this.geoModel.getDisplayNameForTool(this.getGroup(e).current),"aria-disabled":()=>!this.isGroupEnabled(this.getGroup(e)),"aria-haspopup":()=>this.hasDropdown(e),"aria-pressed":()=>this.isGroupSelected(this.getGroup(e)),onTap:t=>this.handleTap(t,this.getGroup(e)),onLongHold:()=>this.openMenuFromLongHold(this.getGroup(e)),"dcg-open-menu-guid":()=>this.getGuid(this.getGroup(e)),manageFocus:()=>rt({controller:this.controller,location:{type:"geo-basic-tool",tool:this.getGroup(e).current}}),"aria-controls":()=>this.getGuid(this.getGroup(e)),"aria-expanded":()=>this.isGroupDropdownOpen(this.getGroup(e))},_r.createElement("span",{class:()=>({"dcg-basic-tool-btn":!0,"dcg-icon":!0})},_r.createElement(em,{model:()=>this.geoModel,width:this.const(96),height:this.const(96),instructions:()=>this.geoModel.getIconInstructionsForTool(this.getGroup(e).current)})),_r.createElement(g6,{predicate:()=>this.hasDropdown(e)},()=>_r.createElement(tm,{menuName:()=>m6(this.controller,e),controller:this.props.controller,ariaExpanded:()=>this.isGroupDropdownOpen(this.getGroup(e)),openDropDown:()=>this.openDropdownMenu(this.getGroup(e))}))),_r.createElement(g6,{predicate:()=>this.isGroupDropdownOpen(this.getGroup(e))},()=>_r.createElement(ps,{controller:this.props.controller,shouldHandleTabAndEscape:this.const(!1),menuType:this.const("geo-tool-dropdown"),menuButtonFocusLocation:this.const({type:"geo-basic-tool",tool:this.getGroup(e).current}),rootElSelector:this.const(".dcg-geo-basic-tools-row")},_r.createElement(xy,{controller:this.props.controller,group:()=>e,ariaLabel:()=>m6(this.controller,e),items:()=>this.getDropdownTools(e),onChooseTool:t=>{this.controller.dispatch({type:"select-geo-tool",tool:t.tool,focusGraphPaper:!!t.fromKeyboard})}})))))),_r.createElement(bne,{key:()=>this.controller.getGeometryGettingStartedMessageState()},e=>{switch(e){case"hidden":return _r.createElement("span",null);case"construct":case"pick-a-tool":return _r.createElement("div",{class:()=>({"dcg-geo-getting-started-pointer":!0,"dcg-geo-getting-started-has-tool":this.controller.getGeometryGettingStartedMessageState()!=="pick-a-tool"})},this.bindFn(this.getPointerMessage),_r.createElement("span",{class:_r.const("dcg-curved-icon-container")},_r.createElement("i",{class:_r.const("dcg-icon-curved-arrow")})))}}))}getDropdownTools(e){let t=this.controller.getOpenItemMenu();if(!t||t.type!=="geo-tool-dropdown"||t.group!==e)return[];if(t.group==="line"){let r=[],n=[];for(let i of t.tools)i==="segment"||i==="line"||i==="ray"||i==="vector"?r.push(i):n.push(i);return[r,n]}return[t.tools]}isGroupSelected(e){return this.selectedTool()===e.current}isGroupEnabled(e){return this.controller.isGeoToolEnabled(e.current)}getGroup(e){let t=this.controller.getGeoToolbarItemsForGroup(e);if(!t)throw new Error("Programing error: "+e+" not found");return t}getPointerMessage(){return this.controller.getGeometryGettingStartedMessageState()==="pick-a-tool"?this.controller.s("geometry-label-pick-tool-instruction"):this.controller.s("geometry-label-construct-instruction")}getFocusedOrActiveTool(){let e=this.controller.getAllVisibleGeoToolbarItems(),t=this.controller.getFocusLocation();if(!t)return;let r;return t.type==="geo-basic-tool"||t.type==="geo-basic-tool-menu-item"?r=t.tool:r=this.controller.getActiveTool(),e.find(n=>{var i,o;return n.current===r||n.dropdown&&((o=(i=n.dropdown)==null?void 0:i.indexOf)==null?void 0:o.call(i,r))>-1})}handleToolbarKeydown(e){var t,r,n,i;let o=ke(e);if(o!=="Up"&&o!=="Down"&&o!=="Left"&&o!=="Right"&&o!=="Home"&&o!=="End"||(e.preventDefault(),e.stopPropagation(),!this.controller.getFocusLocation()))return;let a=this.controller.getAllVisibleGeoToolbarItems(),s=this.getFocusedOrActiveTool();if(!s)return;let l=a.findIndex(d=>d.group===s.group),c;if(o==="Home")c=(t=a[0])==null?void 0:t.current;else if(o==="End")c=(r=a[a.length-1])==null?void 0:r.current;else if(o==="Left"||o==="Right"){let d=o==="Left"?-1:1,u=Math.max(0,Math.min(a.length-1,l+d));c=(n=a[u])==null?void 0:n.current,((i=this.controller.getOpenItemMenu())==null?void 0:i.type)==="geo-tool-dropdown"&&this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"geo-tool-dropdown",guid:this.getGuid(s),tools:[],group:s.group}})}else(o==="Up"||o==="Down")&&this.openDropdownMenu(s);c&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:c}})}selectedTool(){let e=this.controller.getActiveTool();return e==="expression-edit"?"selection":e}openDropdownMenu(e){e.dropdown&&(this.isGroupSelected(e)||this.controller.dispatch({type:"select-geo-tool",tool:e.current}),this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"geo-tool-dropdown",guid:this.getGuid(e),tools:e.dropdown,group:e.group,focusFirstOption:!1}}),this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool-menu-item",tool:e.current}}))}getGuid(e){return e.dropdown?"geo-dropdown-"+e.dropdown[0]:""}openMenuFromLongHold(e){this.controller.dispatch({type:"select-geo-tool",tool:e.current}),this.openDropdownMenu(e)}handleTap(e,t){e.wasLongheld()||e.wasHandled()||(e.shiftKey||this.isGroupSelected(this.getGroup(t.group))?this.openDropdownMenu(t):(this.controller.dispatch({type:"select-geo-tool",tool:t.current,focusGraphPaper:e.device==="keyboard"}),e.device!=="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:t.current}})))}isGroupDropdownOpen(e){let t=this.controller.getOpenItemMenu();return(t==null?void 0:t.type)==="geo-tool-dropdown"&&t.group===e.group}};function m6(e,t){switch(t){case"selection":return e.s("graphing-calculator-label-geometry-tools-dropdown-menu-selection");case"point":return e.s("graphing-calculator-label-geometry-tools-dropdown-menu-point");case"line":return e.s("graphing-calculator-label-geometry-tools-dropdown-menu-line");case"circle":return e.s("graphing-calculator-label-geometry-tools-dropdown-menu-circle");case"angle":return e.s("graphing-calculator-label-geometry-tools-dropdown-menu-angle");case"polygon":return e.s("graphing-calculator-label-geometry-tools-dropdown-menu-polygon");case"transformation":return e.s("graphing-calculator-label-geometry-tools-dropdown-menu-transformation")}}var Zn=__dcg_shared_module_exports__.e(ne()),or=__dcg_shared_module_exports__.e(ne()),{Switch:yne,SwitchUnion:xne}=or.Components,Pd=class extends or.Class{template(){return xne("type",()=>this.getLatexOrToken())({identifier:e=>or.createElement(Ad,{identifier:()=>e().identifier,insideMQ:()=>!1,controller:()=>this.props.controller(),insideGroup:()=>!1,putInTabOrder:()=>!1}),latex:e=>or.createElement(nt,{config:()=>this.props.controller().getMathquillConfig({}),latex:()=>e().latex,tokenController:this.props.controller})})}getLatexOrToken(){let e=this.props.parent();switch(e.type){case"arbitrary-expression":return{type:"latex",latex:e.latex};case"list-access":case"polygon-edge":case"simple":return{type:"identifier",identifier:__dcg_shared_module_exports__.Cc(e)};default:return{type:"latex",latex:"unknown"}}}},ZD=class extends or.Class{init(){this.controller=this.props.controller()}template(){return or.createElement(yne,{key:this.bindFn(this.getTransformationType)},e=>{switch(e){case"translate":return this.getParents().length===1?or.createElement("div",null,or.createElement(Oi,{i18n:this.const(this.controller),key:this.const("graphing-calculator-label-geometry-translation-by-vector")},or.const("Translate by"),or.const(" "),Oi.subview("parent1",()=>or.createElement(Pd,{controller:this.props.controller,parent:()=>this.getParents()[0]})))):or.createElement("div",null,or.createElement(Oi,{i18n:this.const(this.controller),key:this.const("graphing-calculator-label-geometry-translation-by-two-points")},or.const("Translate from"),or.const(" "),Oi.subview("parent1",()=>or.createElement(Pd,{controller:this.props.controller,parent:()=>this.getParents()[0]})),or.const(" "),or.const("to"),or.const(" "),Oi.subview("parent2",()=>or.createElement(Pd,{controller:this.props.controller,parent:()=>this.getParents()[1]}))));case"reflect":return or.createElement("div",null,or.createElement(Oi,{i18n:this.const(this.controller),key:this.const("graphing-calculator-label-geometry-reflection-over-point")},or.const("Reflect over"),or.const(" "),Oi.subview("parent1",()=>or.createElement(Pd,{controller:this.props.controller,parent:()=>this.getParents()[0]}))));case"dilate":return or.createElement("div",null,or.createElement(Oi,{i18n:this.const(this.controller),key:this.const("graphing-calculator-label-geometry-dilation-by-point")},or.const("Dilate at"),or.const(" "),Oi.subview("parent1",()=>or.createElement(Pd,{controller:this.props.controller,parent:()=>this.getParents()[0]})),or.const(" by "),Oi.subview("parent2",()=>or.createElement(Pd,{controller:this.props.controller,parent:()=>this.getParents()[1]}))));case"rotate":return or.createElement("div",null,or.createElement(Oi,{i18n:this.const(this.controller),key:this.const("graphing-calculator-label-geometry-rotation-around-point-by-angle")},or.const("Rotate around"),or.const(" "),Oi.subview("parent1",()=>or.createElement(Pd,{controller:this.props.controller,parent:()=>this.getParents()[0]})),or.const(" by "),Oi.subview("parent2",()=>or.createElement(Pd,{controller:this.props.controller,parent:()=>wne(this.getParents()[1],this.controller.getGraphSettings().degreeMode)}))));case void 0:return or.createElement("span",null)}})}getParents(){let e=this.getGeometry();return!e||!e.call?[]:e&&e.call?e.call.parents:[]}getGeometry(){var e;return(e=this.props.model())==null?void 0:e.formula.geometry}getTransformationType(){var e;let t=this.getGeometry(),r=(e=t==null?void 0:t.call)==null?void 0:e.symbol;switch(r){case"translate":case"dilate":case"reflect":case"rotate":return r}}};function wne(e,t){let r=t?"°":"";if(e.type==="arbitrary-expression")return ie(R({},e),{latex:e.latex+r});if(e.type==="simple"){let n=__dcg_shared_module_exports__.ma(e.identifier);if(!/^\\token\{(\d+)\}$/.test(n))return{type:"arbitrary-expression",latex:n+r}}return e}var{Each:vne,If:Cne}=Zn.Components,ek=class extends Zn.Class{init(){this.controller=this.props.controller()}template(){return Zn.createElement(xy,{controller:this.props.controller,ariaLabel:()=>this.controller.s("graphing-calculator-narration-geometry-construct-menu"),group:()=>"construct-from-selection",items:()=>{var e,t;let r=[this.getTransformations()],n=(t=(e=this.props.constructFromSelectionInfo())==null?void 0:e.relevantTools)!=null?t:[];return n.length>0&&r.push(n),r},onChooseTool:e=>this.chooseTool(e)},Zn.createElement(Cne,{predicate:()=>this.props.existingTransformations().length>0},()=>Zn.createElement("div",{class:Zn.const("dcg-options-menu-section dcg-existing-transformations-container")},Zn.createElement("div",{class:Zn.const("dcg-transformation-header")},()=>this.controller.s("graphing-calculator-label-recent-transformations")),Zn.createElement("div",{role:Zn.const("menu"),"aria-label":()=>this.controller.s("graphing-calculator-label-recent-transformations"),onKeyDown:this.bindFn(this.handleKeyPress)},vne(()=>this.props.existingTransformations(),{item:(e,t)=>Zn.createElement("div",{class:Zn.const("dcg-existing-transformation"),role:Zn.const("menuitemradio"),tabIndex:()=>t===this.props.existingTransformations()[0].id?0:-1,onTap:()=>this.applyTransformation(e),onPointerOut:r=>this.onPointerOut(r,e),onPointerOver:r=>this.onPointerOver(r,e),willUnmount:()=>this.onImplicitMouseOut(e),manageFocus:()=>rt({controller:this.controller,location:{type:"geo-construct-menu-existing-transformations",transformationId:e.id}})},Zn.createElement(ZD,{controller:this.props.controller,model:()=>e})),key:e=>e.id})))))}generateToolOutput(e){let t=this.props.constructFromSelectionInfo();if(!t)return;let{selected:r}=t;return this.controller.getGeoModel().generatePureToolOutput(e,r)}chooseTool(e){var t,r;let n=e.tool;if(!__dcg_shared_module_exports__.Dc(n)){let i=this.generateToolOutput(n);if(i!=null&&i.canCommit)this.controller.dispatch({type:"close-item-settings-menu"}),this.controller.getGeoModel().resetToolMode(),this.controller.dispatch({type:"commit-geo-objects",shiftKey:!1,committed:i.outputs,clearToolAndSelection:!0,toolIdToLatex:{}});else{let o=this.controller.getSelectedItem();this.controller.dispatch({type:"select-geo-tool",tool:n,forceSingleUse:!0,focusGraphPaper:!!e.fromKeyboard});let a=this.controller.getGeoModel(),s=(r=(t=a.getTool(n)).getSpec)==null?void 0:r.call(t);if(!s||(o==null?void 0:o.type)!=="expression")return;a.tentativelyMatchToolInput(s,Bv(o)),a.attemptLockToolInputIn(s)}return}this.controller.dispatch({type:"select-geo-tool",tool:n,focusGraphPaper:!!e.fromKeyboard})}getTransformations(){return fy.filter(e=>this.controller.isGeoToolVisible(e))}handleKeyPress(e){let t=ke(e);if(t!=="Up"&&t!=="Down"&&t!=="Esc")return;let r=this.props.existingTransformations(),n=this.controller.getFocusLocation();if(t==="Esc"){if((n==null?void 0:n.type)==="geo-construct-menu-existing-transformations")return this.controller.dispatch({type:"set-focus-location",location:{type:"multi-select-construct-icon"}});this.controller.dispatch({type:"close-item-settings-menu"}),e.stopPropagation(),e.preventDefault();return}if((n==null?void 0:n.type)!=="geo-construct-menu-existing-transformations")return;let i=t==="Down"?1:-1,o=(r.findIndex(a=>a.id===n.transformationId)+i)%r.length;o<0&&(o=r.length+o),o>=0&&(this.controller.dispatch({type:"set-focus-location",location:{type:"geo-construct-menu-existing-transformations",transformationId:r[o].id}}),e.preventDefault(),e.stopPropagation())}onPointerOver(e,t){var r;if(e.pointerType!=="mouse")return;let n=(r=pi(t))==null?void 0:r.identifier;n&&(this.currentlyActiveTokenIdentifier=n,this.controller.dispatch({type:"set-active-token",identifier:this.currentlyActiveTokenIdentifier,style:"hovered"}))}onPointerOut(e,t){var r;if(e.pointerType!=="mouse")return;let n=(r=pi(t))==null?void 0:r.identifier;n&&this.currentlyActiveTokenIdentifier&&this.currentlyActiveTokenIdentifier===n&&(this.controller.dispatch({type:"unset-active-token",identifier:this.currentlyActiveTokenIdentifier,style:"hovered"}),this.currentlyActiveTokenIdentifier=void 0)}onImplicitMouseOut(e){var t;let r=(t=pi(e))==null?void 0:t.identifier;r&&this.currentlyActiveTokenIdentifier&&this.currentlyActiveTokenIdentifier===r&&this.controller.runAfterDispatch(()=>{let n=this.currentlyActiveTokenIdentifier;n&&(this.currentlyActiveTokenIdentifier=void 0,this.controller.dispatch({type:"unset-active-token",identifier:n,style:"hovered"}))})}applyTransformation(e){var t;if(!((t=e.formula.geometry)!=null&&t.identifier))return;let r=__dcg_shared_module_exports__.ma(e.formula.geometry.identifier);this.controller.dispatch({type:"apply-transformation-to-selected",assignmentLatex:r})}},dn=__dcg_shared_module_exports__.e(ne()),{If:Sne,IfElse:Ene,SwitchUnion:Tne}=dn.Components,tk=class extends dn.Class{init(){this.controller=this.props.controller(),this.updateSingleItemState()}willUpdate(){this.updateSingleItemState()}updateSingleItemState(){var e;let t=this.getSelectionLabelInfo();if(t.type==="multiple"){this.singleItemState=void 0;return}if(((e=this.singleItemState)==null?void 0:e.itemId)===t.model.id)return;let r;ja(t.model)?r=t.model.label===""?"measurement":"text":r="text",this.singleItemState={itemId:t.model.id,mode:r}}sectionValues(){return this.props.sectionValues()}getSelectionLabelInfo(){var e,t;let r=this.sectionValues().singleLabelableExpressionModel;switch((t=(e=r==null?void 0:r.formula)==null?void 0:e.geometry)==null?void 0:t.valueType){case __dcg_shared_module_exports__.ya:return{type:"single",objectType:"point",model:r};case __dcg_shared_module_exports__.Va:case __dcg_shared_module_exports__.Xa:return{type:"single",objectType:"angle",model:r};case __dcg_shared_module_exports__.La:return{type:"single",objectType:"segment",model:r};default:return{type:"multiple",objectType:"point"}}}allowPointCoordinates(){return!!this.controller.getGraphSettings().showXAxis}getLabelMode(){var e;return this.getSelectionLabelInfo().type==="multiple"?this.sectionValues().pointLabels:(e=this.singleItemState)==null?void 0:e.mode}getSegmentedLabels(){switch(this.getSelectionLabelInfo().objectType){case"point":return{text:"A,B,C",measurement:"(x,y)"};case"angle":return{text:"Text",measurement:"Measure"};case"segment":return{text:"Text",measurement:"Length"}}}getSegmentedControlConfig(){let e=()=>this.getSelectionLabelInfo().objectType==="point"&&this.allowPointCoordinates()?"dcg-segmented-control-btn--point":"";return[{key:"text",label:()=>this.getSegmentedLabels().text,selected:()=>this.getLabelMode()==="text",onSelect:t=>{this.lastSelectionDevice=t,this.onSelectTextLabel()},class:e},{key:"measurements",label:()=>this.getSegmentedLabels().measurement,selected:()=>this.getLabelMode()==="measurement",onSelect:t=>{this.lastSelectionDevice=t,this.onSelectMeasurementLabel()},class:e}]}onSelectTextLabel(){var e;let t=this.getSelectionLabelInfo();if(t.type==="multiple"){this.controller.dispatch({type:"set-label-state-for-selected-points",state:this.getLabelMode()==="text"?"none":"auto"});return}if(!this.singleItemState)throw new Error("Expected singleItemState to be defined");this.getLabelMode()==="text"?(this.singleItemState.mode="none",this.controller.dispatch({type:"set-item-showlabel",id:t.model.id,showLabel:!1})):(this.singleItemState.mode="text",((e=t.model.formula.geometry)==null?void 0:e.valueType)===__dcg_shared_module_exports__.ya?this.controller.dispatch({type:"set-label-state-for-selected-points",state:"auto"}):this.controller.dispatch({type:"set-item-showlabel",id:t.model.id,showLabel:!1}))}onSelectMeasurementLabel(){let e=this.getSelectionLabelInfo();if(e.type==="multiple"){this.controller.dispatch({type:"set-label-state-for-selected-points",state:this.getLabelMode()==="measurement"?"none":"measurement"});return}if(!this.singleItemState)throw new Error("Expected singleItemState to be defined");this.getLabelMode()==="measurement"?(this.singleItemState.mode="none",this.controller.dispatch({type:"set-item-showlabel",id:e.model.id,showLabel:!1})):(this.singleItemState.mode="measurement",this.controller.dispatch({type:"set-item-showlabel",id:e.model.id,showLabel:!0}),this.controller.dispatch({type:"set-item-label",id:e.model.id,label:""}))}template(){return dn.createElement("div",{class:()=>({"dcg-generic-options-menu":!0,"dcg-options-menu":!0,"dcg-multi-select-label-menu":!0}),role:dn.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-label-menu")},dn.createElement("div",{class:dn.const("dcg-options-menu-section")},Tne("type",()=>this.getSelectionLabelInfo())({multiple:()=>dn.createElement("div",null,Ene(this.bindFn(this.allowPointCoordinates),{true:()=>dn.createElement("div",{class:dn.const("dcg-multi-select-menu_margin-top-section")},()=>this.controller.s("graphing-calculator-button-geometry-label-points"),dn.const(":")),false:()=>dn.createElement(mt,{checked:()=>this.getLabelMode()==="text",onChange:()=>this.onSelectTextLabel()},()=>this.controller.s("graphing-calculator-button-geometry-label-points"))})),single:e=>dn.createElement("div",{class:dn.const("dcg-multi-select-menu_margin-top-section")},dn.createElement(Hg,{controller:this.props.controller,model:()=>e().model,forceEnabled:this.const(!0),displayComputedValue:()=>{if(this.getLabelMode()!=="measurement")return;let t=this.controller.getGrapher2d(),r=t.getGraphSketch(e().model.id);return r&&r.labels.length===1?iP(r.labels[0],t.getProjection()).text:""},selectInputOnMount:()=>this.lastSelectionDevice!=="keyboard",suppressInput:()=>this.getLabelMode()==="none",manageInputFocus:this.const(rt({controller:this.controller,location:{type:"multi-select-label-menu-label-input"}}))}))}),dn.createElement(Sne,{predicate:()=>this.getSelectionLabelInfo().objectType!=="point"||this.allowPointCoordinates()},()=>dn.createElement(vo,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-geometry-label-options"),staticConfig:this.bindFn(this.getSegmentedControlConfig)}))))}},ao=__dcg_shared_module_exports__.e(ne()),Fi=__dcg_shared_module_exports__.e(ne()),{Input:Dne,If:uV}=Fi.Components,rk=class extends Fi.Class{constructor(){super(...arguments),this.controller=this.props.controller(),this.newFolderTitle=""}init(){this.cacheFolderList()}willUpdate(){this.cacheFolderList()}template(){return Fi.createElement(uV,{predicate:()=>this.getMovableItems().length>0},()=>Fi.createElement("div",{class:Fi.const("dcg-move-to-expression-list")},Fi.createElement("div",{class:Fi.const("dcg-move-to-expression-list-title"),role:()=>this.canMoveToExpressionList()?"button":void 0,tabIndex:()=>this.canMoveToExpressionList()?0:void 0,onTap:this.bindFn(this.moveToExpressionList)},Fi.createElement(uV,{predicate:()=>this.canMoveToExpressionList()},()=>Fi.createElement("i",{class:Fi.const("dcg-icon-insert"),"aria-hidden":Fi.const("true")})),Fi.createElement("span",null,this.bindFn(this.getMoveMessage))),Fi.createElement(uV,{predicate:()=>!this.canMoveToExpressionList()},()=>Fi.createElement("div",{class:Fi.const("dcg-move-to-expression-list-flex")},Fi.createElement(Dne,{"aria-label":this.bindFn(this.getMoveMessage),value:()=>this.newFolderTitle,onInput:e=>{this.newFolderTitle=e,this.update()},placeholder:()=>this.controller.s("graphing-calculator-label-geometry-move-to-folder-placeholder"),didMount:e=>{e.onkeydown=function(t){let r=ke(t);(r==="Backspace"||r==="Del")&&t.stopPropagation()}},onEnterPressed:this.bindFn(this.onEnterPressed)}),Fi.createElement("div",{class:()=>({"dcg-btn-purple":!0,"dcg-disabled":!this.newFolderTitle}),role:Fi.const("button"),tabIndex:()=>this.newFolderTitle?0:-1,onTap:this.bindFn(this.createNewFolder)},()=>this.controller.s("graphing-calculator-button-move-to-expression-list-action"))))))}getMovableItems(){return this.controller.getAllSelectedItems().filter(e=>!this.controller.isItemReadonly(e.id))}canMoveToExpressionList(){var e,t;let r=this.getMovableItems(),[n]=r;if(!(r.length===1&&n.type!=="folder"&&n.folderId===__dcg_shared_module_exports__.xd))return!1;if(n.type!=="expression"||((t=(e=n.formula.geometry)==null?void 0:e.call)==null?void 0:t.symbol)!=="apply")return!0;let i=n.formula.geometry.call.parents[0];return i.type==="arbitrary-expression"?!0:this.controller.getItemsByIdentifier(__dcg_shared_module_exports__.Cc(i)).every(o=>o.folderId!==__dcg_shared_module_exports__.xd)}getMoveMessage(){return`${this.controller.s("graphing-calculator-text-geometry-move-to-expression-list-message")}${this.canMoveToExpressionList()?"":":"}`}onEnterPressed(){let e=this.folderList.find(t=>t.title===this.newFolderTitle);e?this.chooseFolder(e.id):this.createNewFolder()}chooseFolder(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"folderId",value:e}})}createNewFolder(){this.newFolderTitle&&this.controller.dispatch({type:"update-all-selected-items",update:{prop:"folderId",value:this.newFolderTitle,createFolder:!0}})}cacheFolderList(){this.folderList=this.controller.getAllItemModels().filter(e=>e.type==="folder"&&!this.controller.isGeoFolder(e))}moveToExpressionList(){this.canMoveToExpressionList()&&this.controller.dispatch({type:"move-selected-item-to-expression-list"})}},{If:Uv}=ao.Components,ok=class extends ao.Class{constructor(){super(...arguments),this.controller=this.props.controller()}sectionValues(){return this.props.sectionValues()}template(){return ao.createElement("div",{class:()=>({"dcg-generic-options-menu":!0,"dcg-options-menu":!0,"dcg-multi-select-options-menu":!0}),role:ao.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu")},ao.createElement("div",{class:ao.const("dcg-options-menu-section")},ao.createElement(Uv,{predicate:()=>this.hasSelectedAndEditableItems()},()=>ao.createElement("div",{role:ao.const("button"),handleEvent:ao.const("true"),class:ao.const("dcg-delete-btn dcg-btn-purple"),tabIndex:ao.const("0"),onTap:this.bindFn(this.deleteSelected)},ao.createElement("i",{class:ao.const("dcg-icon-trashcan"),"aria-hidden":ao.const("true")}),ao.createElement("span",null,()=>this.getDeleteItemString()))),ao.createElement(Uv,{predicate:()=>this.sectionValues().draggableFreePoint!==void 0},()=>ao.createElement("div",{class:ao.const("dcg-checkbox-section")},ao.createElement(mt,{checked:()=>!!this.sectionValues().draggableFreePoint,onChange:this.bindFn(this.onDraggableFreePointChanged)},()=>this.controller.s("graphing-calculator-button-draggable-points")))),ao.createElement(Uv,{predicate:()=>this.sectionValues().graphInteractionDisabled!==void 0&&this.props.controller().shouldShowAuthorFeatures()},()=>ao.createElement("div",{class:ao.const("dcg-checkbox-section dcg-disable-graph-interactions")},ao.createElement(mt,{checked:()=>!!this.sectionValues().graphInteractionDisabled,onChange:()=>this.toggleGraphInteractionsDisabled()},()=>this.controller.s("graphing-calculator-label-disable-graph-interactions")))),ao.createElement(Uv,{predicate:()=>this.sectionValues().arrowMode!==void 0},()=>ao.createElement("div",null,()=>this.controller.s("graphing-calculator-text-geometry-arrow-mode",{mode:this.getArrowModeDisplayName()}))),ao.createElement(Uv,{predicate:()=>this.controller.getGraphSettings().config.expressions},()=>ao.createElement(rk,{controller:this.props.controller}))))}getSelectedAndEditableItems(){return this.controller.getAllSelectedItems().filter(e=>!this.controller.isItemReadonly(e.id))}hasSelectedAndEditableItems(){return this.getSelectedAndEditableItems().length>0}toggleGraphInteractionsDisabled(){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"disableGraphInteractions",value:!this.sectionValues().graphInteractionDisabled}})}onDraggableFreePointChanged(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"dragMode",value:e?"XY":"NONE"}})}getArrowModeDisplayName(){let e=this.sectionValues().arrowMode;if(!e)return"";switch(e){case"NONE":return this.controller.s("graphing-calculator-text-arrow-mode-none");case"DEFAULT":return this.controller.s("graphing-calculator-text-arrow-mode-default");case"POSITIVE":return this.controller.s("graphing-calculator-text-arrow-mode-positive");case"BOTH":return this.controller.s("graphing-calculator-text-arrow-mode-both")}}getSelectedCount(){return this.controller.getAllSelectedItems().length}getDeleteItemString(){let e=this.getSelectedCount(),t=this.getSelectedAndEditableItems().length;return e-t>0?this.controller.s("graphing-calculator-text-geometry-delete-selected-unlocked-objects",{count:__dcg_shared_module_exports__.ra(t)}):this.controller.s("graphing-calculator-text-geometry-delete-selected-objects",{count:__dcg_shared_module_exports__.ra(t)})}deleteSelected(){this.controller.dispatch({type:"delete-all-selected-items"})}},us=__dcg_shared_module_exports__.e(ne()),{If:kne}=us.Components,ik=class extends us.Class{init(){this.controller=this.props.controller()}sectionValues(){return this.props.sectionValues()}getSelectedColor(){let e=this.sectionValues().color;return!(e!=null&&e.isUnique)||!(e!=null&&e.selectedColor)?"":e.selectedColor}template(){return us.createElement("div",{class:()=>({"dcg-generic-options-menu":!0,"dcg-options-menu":!0,"dcg-multi-select-style-menu":!0}),role:us.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-style-menu")},us.createElement("div",{class:us.const("dcg-options-menu-section")},us.createElement("div",{class:us.const("dcg-multi-select-color-picker")},us.createElement(ey,{controller:this.props.controller,colorLatex:()=>{var e,t;return(t=(e=this.sectionValues().color)==null?void 0:e.colorLatex)!=null?t:""},selectedColor:this.bindFn(this.getSelectedColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),customColorVisibility:this.bindFn(this.getCustomColorVisibility)})),us.createElement(kne,{predicate:()=>this.sectionValues().arrowMode!==void 0},()=>us.createElement("div",null,()=>this.controller.s("graphing-calculator-text-geometry-arrow-mode",{mode:this.getArrowModeDisplayName()})))))}getArrowModeDisplayName(){let e=this.sectionValues().arrowMode;if(!e)return"";switch(e){case"NONE":return this.controller.s("graphing-calculator-text-arrow-mode-none");case"DEFAULT":return this.controller.s("graphing-calculator-text-arrow-mode-default");case"POSITIVE":return this.controller.s("graphing-calculator-text-arrow-mode-positive");case"BOTH":return this.controller.s("graphing-calculator-text-arrow-mode-both")}}onColorSelected(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"color",value:e}})}getCustomColorVisibility(){return this.controller.getGraphSettings().hideCustomColors?this.controller.shouldShowAuthorFeatures()?"suppressed":"hidden":"visible"}onCustomColorSelected(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"colorLatex",value:e}})}},{If:ch,Switch:f6}=Et.Components,nk=class extends Et.Class{init(){this.controller=this.props.controller(),this.cacheSectionValues(),this.cacheExistingTransformations()}willUpdate(){this.cacheSectionValues(),this.cacheExistingTransformations(),this.cachedConstructFromSelectionInfo=this.computeConstructFromSelectionInfo()}template(){return Et.createElement("div",{class:Et.const("dcg-multi-select-header dcg-animate-in-after-initial-load"),onKeyDown:this.bindFn(this.handleKeydown),role:Et.const("toolbar"),"aria-label":this.bindFn(this.getSelectedCountString)},Et.createElement(f6,{key:this.bindFn(this.getSelectedItemsKey)},()=>Et.createElement(ch,{predicate:()=>this.isButtonVisible("multi-select-show-hide-icon")},()=>Et.createElement("div",{class:()=>({"dcg-btn-outline":!0,"dcg-show-hide-btn":!0,"dcg-any-visible-objects":this.anyVisible()}),handleEvent:Et.const("true"),tabIndex:Et.const("0"),role:Et.const("button"),onTap:this.bindFn(this.toggleItemsVisible),manageFocus:this.const(rt({controller:this.controller,location:{type:"multi-select-show-hide-icon"}}))},Et.createElement("div",{"aria-hidden":()=>!this.anyVisible()},()=>this.controller.s("graphing-calculator-text-geometry-hide-objects"),()=>` (${this.getSelectedCount()})`),Et.createElement("div",{"aria-hidden":this.bindFn(this.anyVisible)},()=>this.controller.s("graphing-calculator-text-geometry-show-objects"),()=>` (${this.getSelectedCount()})`)))),Et.createElement("div",{class:()=>({"dcg-style-button":!0,"dcg-toolbar-dropdown-button":!0,"dcg-menu-open":this.isStyleMenuOpen()}),handleEvent:Et.const("true"),tabIndex:Et.const("-1"),role:Et.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-style-menu"),"aria-expanded":this.bindFn(this.isStyleMenuOpen),"dcg-open-menu-guid":()=>hV(),onTap:this.bindFn(this.toggleStyleMenu),manageFocus:this.const(rt({controller:this.controller,location:{type:"multi-select-style-icon"}}))},Et.createElement(Pp,{color:()=>this.getSelectedColor(),invertSwatches:()=>this.controller.invertSwatches()}),Et.createElement(tm,{menuName:()=>this.controller.s("graphing-calculator-narration-geometry-style-menu"),ariaExpanded:this.bindFn(this.isStyleMenuOpen),controller:this.const(this.controller),openDropDown:()=>{}})),Et.createElement(ch,{predicate:()=>this.isButtonVisible("multi-select-label-icon")},()=>Et.createElement("div",{class:()=>({"dcg-label-button":!0,"dcg-toolbar-dropdown-button":!0,"dcg-menu-open":this.isLabelMenuOpen()}),handleEvent:Et.const("true"),tabIndex:Et.const("-1"),role:Et.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-narration-label-menu"),"aria-expanded":this.bindFn(this.isLabelMenuOpen),"dcg-open-menu-guid":()=>gV(),onTap:this.bindFn(this.toggleLabelMenu),manageFocus:this.const(rt({controller:this.controller,location:{type:"multi-select-label-icon"}}))},Et.createElement("div",{class:Et.const("dcg-label-button-icon")},Et.const("A")),Et.createElement(tm,{menuName:()=>this.controller.s("graphing-calculator-narration-label-menu"),ariaExpanded:this.bindFn(this.isLabelMenuOpen),controller:this.const(this.controller),openDropDown:()=>{}}))),Et.createElement(ch,{predicate:()=>this.isButtonVisible("multi-select-construct-icon")},()=>Et.createElement("div",{class:()=>({"dcg-construct-button":!0,"dcg-toolbar-dropdown-button":!0,"dcg-menu-open":this.isConstructMenuOpen()}),handleEvent:Et.const("true"),tabIndex:Et.const("-1"),role:Et.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-construct-menu"),"aria-expanded":this.bindFn(this.isConstructMenuOpen),"dcg-open-menu-guid":()=>zv(),onTap:this.bindFn(this.toggleConstructMenu),manageFocus:this.const(rt({controller:this.controller,location:{type:"multi-select-construct-icon"}}))},Et.createElement(XD,null),Et.createElement(tm,{menuName:()=>this.controller.s("graphing-calculator-narration-geometry-construct-menu"),ariaExpanded:this.bindFn(this.isConstructMenuOpen),controller:this.const(this.controller),openDropDown:()=>{}}))),Et.createElement(ch,{predicate:()=>this.isButtonVisible("multi-select-more-icon")},()=>Et.createElement(Le,{tooltip:this.bindFn(this.getMoreString)},Et.createElement("div",{"aria-label":this.bindFn(this.getMoreString),role:Et.const("button"),tabIndex:Et.const("-1"),handleEvent:Et.const("true"),"aria-expanded":this.bindFn(this.isMoreMenuOpen),class:()=>({"dcg-multi-select-icon-button dcg-more-options dcg-toolbar-dropdown-button":!0,"dcg-menu-open":this.isMoreMenuOpen()}),"dcg-open-menu-guid":()=>rm(),manageFocus:this.const(rt({controller:this.controller,location:{type:"multi-select-more-icon"}})),onTap:this.bindFn(this.toggleMoreMenu)},Et.createElement(by,null)))),Et.createElement(ch,{predicate:this.bindFn(this.isLabelMenuOpen)},()=>Et.createElement(f6,{key:()=>Object.keys(this.controller.getSelectedExpressionIds()).join(":")},()=>Et.createElement(ps,{controller:this.props.controller,shouldHandleTabAndEscape:this.const(!0),menuType:this.const("multi-select-label"),menuButtonFocusLocation:this.const({type:"multi-select-label-icon"}),rootElSelector:this.const(".dcg-multi-select-header")},Et.createElement(tk,{controller:this.props.controller,sectionValues:()=>this.sectionValues})))),Et.createElement(ch,{predicate:this.bindFn(this.isStyleMenuOpen)},()=>Et.createElement(ps,{controller:this.props.controller,shouldHandleTabAndEscape:this.const(!0),menuType:this.const("multi-select-style"),menuButtonFocusLocation:this.const({type:"multi-select-style-icon"}),rootElSelector:this.const(".dcg-multi-select-header")},Et.createElement(ik,{controller:this.props.controller,sectionValues:()=>this.sectionValues}))),Et.createElement(ch,{predicate:this.bindFn(this.isConstructMenuOpen)},()=>Et.createElement(ps,{controller:this.props.controller,shouldHandleTabAndEscape:this.const(!0),menuType:this.const("multi-select-construct"),menuButtonFocusLocation:this.const({type:"multi-select-construct-icon"}),rootElSelector:this.const(".dcg-multi-select-header")},Et.createElement(ek,{controller:this.props.controller,constructFromSelectionInfo:()=>this.cachedConstructFromSelectionInfo,existingTransformations:()=>this.cachedExistingTransformations}))),Et.createElement(ch,{predicate:this.bindFn(this.isMoreMenuOpen)},()=>Et.createElement(ps,{controller:this.props.controller,shouldHandleTabAndEscape:this.const(!0),menuType:this.const("multi-select-more"),menuButtonFocusLocation:this.const({type:"multi-select-more-icon"}),rootElSelector:this.const(".dcg-multi-select-header")},Et.createElement(ok,{controller:this.props.controller,sectionValues:()=>this.sectionValues}))))}getFocusOrder(){return["multi-select-show-hide-icon","multi-select-style-icon","multi-select-label-icon","multi-select-construct-icon","multi-select-more-icon"].filter(e=>this.isButtonVisible(e)).map(e=>({type:e}))}isButtonVisible(e){switch(e){case"multi-select-show-hide-icon":return this.hasSelectedAndEditableItems();case"multi-select-style-icon":return!0;case"multi-select-label-icon":return this.sectionValues.pointLabels!==void 0||this.sectionValues.singleLabelableExpressionModel!==void 0;case"multi-select-construct-icon":return this.isSomeRelevantToolEnabled();case"multi-select-more-icon":return this.controller.shouldShowAuthorFeatures()||this.hasSelectedAndEditableItems()||this.sectionValues.draggableFreePoint!==void 0;default:return!1}}cacheSectionValues(){this.sectionValues=this.computeSectionValues()}computeSectionValues(){var e;let t={pointLabels:[],singleLabelableExpressionModel:[],draggableFreePoint:[],arrowMode:[],graphInteractionDisabled:[],color:[]},r=this.controller.getAllSelectedItems();for(let o of r){if(t.graphInteractionDisabled.push(Ds(o)),o.type!=="expression")continue;t.color.push({selectedColor:Fu(o),colorLatex:o.colorLatex});let a=(e=o.formula.geometry)==null?void 0:e.valueType;switch(__dcg_shared_module_exports__.wb(a)&&(a=__dcg_shared_module_exports__.xb(a)),a){case __dcg_shared_module_exports__.ya:o.showLabel?t.pointLabels.push(o.label?"text":"measurement"):t.pointLabels.push("none"),t.singleLabelableExpressionModel.push(o),o.formula.move_strategy&&t.draggableFreePoint.push(o.dragMode!=="NONE");break;case __dcg_shared_module_exports__.Ja:break;case __dcg_shared_module_exports__.Pa:t.arrowMode.push(o.arrowMode);break;case __dcg_shared_module_exports__.Na:break;case __dcg_shared_module_exports__.Ra:break;case __dcg_shared_module_exports__.Ta:break;case __dcg_shared_module_exports__.$a:break;case __dcg_shared_module_exports__.La:t.singleLabelableExpressionModel.push(o),t.arrowMode.push(o.arrowMode);break;case __dcg_shared_module_exports__.Va:case __dcg_shared_module_exports__.Xa:t.singleLabelableExpressionModel.push(o);break;case __dcg_shared_module_exports__.Za:break}}let n={},i=r.length;for(let o in t){let a=o;switch(a){case"singleLabelableExpressionModel":{let s=t[a];i===1&&s.length===1&&(n[a]=s[0])}break;case"pointLabels":{let s=t[a];if(s.length>0&&i>1){let l=__dcg_shared_module_exports__.v(s);l.length===1?n[a]=l[0]:n[a]="none"}}break;case"draggableFreePoint":{let s=t[a];s.length>0&&(n[a]=__dcg_shared_module_exports__.k(s))}break;case"arrowMode":break;case"graphInteractionDisabled":{n[a]=t[a].every(s=>s);break}case"color":{let s=t[a].map(c=>JSON.stringify(c)),l=new Set(s).size===1;n[a]=ie(R({},t[a][0]),{isUnique:l});break}default:return a}}return n}cacheExistingTransformations(){this.cachedExistingTransformations=this.computeExistingTransformations()}computeConstructFromSelectionInfo(){let e=this.controller.getSelectedItem();if((e==null?void 0:e.type)==="expression"){let t=e.formula.typed_constant_value;if(!t||__dcg_shared_module_exports__.Ab(t.valueType,__dcg_shared_module_exports__.ya))return;let r=this.controller.getAllAvailableGeoTools(),n=[];for(let i of r){let o=this.controller.getGeoModel().getTool(i);o instanceof Vr&&o.getMatchingWorkflow([t])&&n.push(i)}return{type:"single-selection",selected:[{referenceLatex:Bv(e),typedValue:t}],relevantTools:n}}}computeExistingTransformations(){var e,t;let r=[];for(let n of this.controller.getAllItemModels()){if(n.type!=="expression"||!this.controller.isItemInGeoFolder(n.id))continue;let i=(e=n.formula.geometry)==null?void 0:e.call;if(!i||!__dcg_shared_module_exports__.Dc(i.symbol)||!i.parents.every((a,s)=>a.type!=="arbitrary-expression"||(i.symbol==="rotate"||i.symbol==="dilate")&&s===1))continue;let o=(t=n.formula.typed_constant_value)==null?void 0:t.valueType;o!==void 0&&__dcg_shared_module_exports__.Ab(o,__dcg_shared_module_exports__.Za)&&r.push(n)}return r.reverse()}handleKeydown(e){let t=ke(e);if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||t!=="Left"&&t!=="Right"&&t!=="Home"&&t!=="End")return;let r=this.controller.getFocusLocation();if(!r)return;let n=__dcg_shared_module_exports__.w(this.getFocusOrder(),r);if(n===-1)return;e.preventDefault(),e.stopPropagation();let i=n;t==="Left"?i=Math.max(0,n-1):t==="Right"?i=Math.min(this.getFocusOrder().length-1,n+1):t==="Home"?i=0:t==="End"&&(i=this.getFocusOrder().length-1),i!==n&&(this.controller.dispatch({type:"close-item-settings-menu"}),this.controller.dispatch({type:"set-focus-location",location:this.getFocusOrder()[i]}))}getSelectedCountString(){return this.controller.getGrapherDimensions().width<450?"":this.controller.s("graphing-calculator-text-geometry-selected-objects",{count:__dcg_shared_module_exports__.ra(this.getSelectedCount())})}getSelectedAndEditableItems(){return this.controller.getAllSelectedItems().filter(e=>!this.controller.isItemReadonly(e.id))}hasSelectedAndEditableItems(){return this.getSelectedAndEditableItems().length>0}isSomeRelevantToolEnabled(){var e,t;return[...(t=(e=this.cachedConstructFromSelectionInfo)==null?void 0:e.relevantTools)!=null?t:[],...fy].some(r=>this.controller.isGeoToolVisible(r))}getMoreString(){return this.controller.s("graphing-calculator-text-geometry-multi-select-more-dropdown")}getSelectedItemsKey(){let e=this.controller.getAllSelectedItems();return __dcg_shared_module_exports__.m(e,"id").join("-")}toggleItemsVisible(){this.anyVisible()?this.hideSelected():this.showSelected()}anyVisible(){let e=this.controller.getAllSelectedItems();return __dcg_shared_module_exports__.k(e,t=>!Hi(t))}isFolderMenuOpen(){return this.controller.isItemSettingsMenuOpen(_ne())}isMoreMenuOpen(){return this.controller.isItemSettingsMenuOpen(rm())}isConstructMenuOpen(){return this.controller.isItemSettingsMenuOpen(zv())}isStyleMenuOpen(){return this.controller.isItemSettingsMenuOpen(hV())}isLabelMenuOpen(){return this.controller.isItemSettingsMenuOpen(gV())}toggleMoreMenu(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-more",guid:rm(),focusFirstOption:!0}})}toggleConstructMenu(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-construct",guid:zv(),focusFirstOption:!0}})}toggleStyleMenu(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-style",guid:hV(),focusFirstOption:!0}})}toggleLabelMenu(){var e;let t=this.sectionValues.singleLabelableExpressionModel;!this.isLabelMenuOpen()&&t&&!ja(t)&&((e=t.formula.geometry)==null?void 0:e.valueType)===__dcg_shared_module_exports__.ya&&this.controller.dispatch({type:"set-label-state-for-selected-points",state:"auto"}),this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-label",guid:gV(),focusFirstOption:!0}}),this.isLabelMenuOpen()&&t&&t.label!==""&&this.controller.dispatch({type:"set-focus-location",location:{type:"multi-select-label-menu-label-input"}})}getSelectedCount(){return this.controller.getAllSelectedItems().length}hideSelected(){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"visible",value:!1}})}showSelected(){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"visible",value:!0}})}getSelectedColor(){var e;let t=this.sectionValues.color,r=t&&((e=this.controller.getAllColorAssignments().find(n=>n.assignmentLatex===t.colorLatex))==null?void 0:e.id);if(r){let n=this.controller.getColorById(r);return Array.isArray(n)?{type:"color-array",value:n}:{type:"single-color",value:n}}else if(t!=null&&t.selectedColor)return{type:"single-color",value:t.selectedColor};return{type:"single-color",value:this.controller.getColors().GRAY}}};function _ne(){return"**multi-select-folder**"}function rm(){return"**multi-select-more**"}function zv(){return"**multi-select-construct**"}function hV(){return"**multi-select-style**"}function gV(){return"**multi-select-label**"}qt();function wy(e){let t=[[e.x0,e.y0],[e.x1,e.y1],[e.x2,e.y2]],[r,n]=__dcg_shared_module_exports__.Vb(t),i=__dcg_shared_module_exports__.Qb(e.x0-r,e.y0-n);return{x:r,y:n,radius:i}}function ak(e){let t=[[e.x0,e.y0],[e.x1,e.y1],[e.x2,e.y2]],[r,n]=__dcg_shared_module_exports__.Vb(t);return{startAngle:Math.atan2(e.y0-n,e.x0-r),deltaAngle:__dcg_shared_module_exports__.Wb(t)}}var Ine=Math.hypot&&Math.hypot(1/0,NaN)===1/0;function b6(e){return e===1/0||e===-1/0}var dh=Ine?Math.hypot:function(e,t){if(b6(e)||b6(t))return 1/0;if(isNaN(e)||isNaN(t))return NaN;if(e===0&&t===0)return 0;if(Math.abs(e)>Math.abs(t)){let r=t/e;return Math.abs(e)*Math.sqrt(r*r+1)}else{let r=e/t;return Math.abs(t)*Math.sqrt(r*r+1)}},y6=(e,t)=>({x:e.x-t.x,y:e.y-t.y}),Ane=(e,t)=>e.x*t.x+e.y*t.y;function lk(e,t){return dh(e.x-t.x,e.y-t.y)}function x6(e,t){let r={x:e.x1,y:e.y1},n={x:e.x2,y:e.y2},i=y6(t,r),o=y6(n,r),a=lk(r,n),s=a*a;return Ane(i,o)/s}function fV(e){return[{x1:e.left,y1:e.top,x2:e.left,y2:e.bottom,extendStart:!1,extendEnd:!1},{x1:e.left,y1:e.top,x2:e.right,y2:e.top,extendStart:!1,extendEnd:!1},{x1:e.right,y1:e.top,x2:e.right,y2:e.bottom,extendStart:!1,extendEnd:!1},{x1:e.left,y1:e.bottom,x2:e.right,y2:e.bottom,extendStart:!1,extendEnd:!1}]}function Mne(e){let{angle:t,width:r,height:n,center:i}=e,o=i.x,a=i.y,s=Math.cos(-t),l=Math.sin(-t),c=r/2,d=n/2,u={x:o+s*-c-l*-d,y:a+l*-c+s*-d},p={x:o+s*c-l*-d,y:a+l*c+s*-d},g={x:o+s*c-l*d,y:a+l*c+s*d},f={x:o+s*-c-l*d,y:a+l*-c+s*d};return[{x1:u.x,y1:u.y,x2:p.x,y2:p.y,extendStart:!1,extendEnd:!1},{x1:p.x,y1:p.y,x2:g.x,y2:g.y,extendStart:!1,extendEnd:!1},{x1:g.x,y1:g.y,x2:f.x,y2:f.y,extendStart:!1,extendEnd:!1},{x1:f.x,y1:f.y,x2:u.x,y2:u.y,extendStart:!1,extendEnd:!1}]}function Gne(e,t){let r=fV(e);return!!(ck(t,r[0])||ck(t,r[1])||ck(t,r[2])||ck(t,r[3]))}function Lne(e,t){let r=fV(e);return!!(Vd(t,r[0],!1)||Vd(t,r[1],!1)||Vd(t,r[2],!1)||Vd(t,r[3],!1)||Vd(t,r[0],!0)||Vd(t,r[1],!0)||Vd(t,r[2],!0)||Vd(t,r[3],!0))}function Pne(e,t){let r=fV(e);return!!(ph(t,r[0],!1)||ph(t,r[1],!1)||ph(t,r[2],!1)||ph(t,r[3],!1)||ph(t,r[0],!0)||ph(t,r[1],!0)||ph(t,r[2],!0)||ph(t,r[3],!0))}function Vne(e,t){return e.left<=t.left&&e.right>=t.right&&e.top<=t.top&&e.bottom>=t.bottom}function One(e,t){return e.left<=t.x&&t.x<=e.right&&e.top<=t.y&&t.y<=e.bottom}function dk(e,t){if(!t.extendStart){let r=e.left<=t.x1&&t.x1<=e.right,n=e.top<=t.y1&&t.y1<=e.bottom;if(r&&n)return!0}return Gne(e,t)}function T6(e,t){let r={x:t.x0,y:t.y0};return!!(One(e,r)||Pne(e,t))}function D6(e,t){let r={left:t.x-t.radius,right:t.x+t.radius,top:t.y-t.radius,bottom:t.y+t.radius};return!!(Vne(e,r)||Lne(e,t))}function Rne(e,t){let r=e.x-t.center.x,n=e.y-t.center.y,i=Math.atan2(n,r),o=dh(r,n),a={x:o*Math.cos(i+t.angle),y:o*Math.sin(i+t.angle)};return Math.abs(a.x)<=t.width/2&&Math.abs(a.y)<=t.height/2}function k6(e,t){if(t.length<4)return!1;let r={x1:NaN,y1:NaN,x2:t[0],y2:t[1],extendStart:!1,extendEnd:!1};for(let n=2;n<t.length;n+=2)if(r.x1=r.x2,r.y1=r.y2,r.x2=t[n],r.y2=t[n+1],dk(e,r))return!0;return!1}function _6(e,t){let r=Mne(t);for(let n of r)if(dk(e,n))return!0;return!!Rne({x:e.left,y:e.top},t)}function Fne(e,t,r){let n=t.x1-e.x,i=t.x2-e.x,o=t.y1-e.y,a=t.y2-e.y,s=e.radius,l=i-n,c=a-o,d=l*l+c*c,u=n*a-i*o,p=Math.sqrt(s*s*d-u*u);if(p<0)return;let g=c>=0?1:-1,f=r?-1*g:1*g;return{x:e.x+(u*c+f*g*l*p)/d,y:e.y+(-u*l+f*Math.abs(c)*p)/d}}function Nne(e,t){let r=e.y2-e.y1,n=e.x1-e.x2,i=t.y2-t.y1,o=t.x1-t.x2,a=r*e.x1+n*e.y1,s=i*t.x1+o*t.y1,l=r*o-i*n;if(l!==0)return{x:(o*a-n*s)/l,y:(r*s-i*a)/l}}function mV(e,t){let r=x6(t,e);return!(isNaN(r)||r<0&&!t.extendStart||r>1&&!t.extendEnd)}function Bne(e,t){let{x:r,y:n}=wy(t),{startAngle:i,deltaAngle:o}=ak(t),a=Math.atan2(e.y-n,e.x-r);return __dcg_shared_module_exports__.Q(a,i,o)}function Vd(e,t,r){let n=Fne(e,t,r);if(n!=null&&mV(n,t))return n}function ph(e,t,r){let n=Vd(wy(e),t,!1)||v6,i=C6(r,S6(e,n),E6(t));if(i||(n=Vd(wy(e),t,!0)||v6,i=C6(r,S6(e,n),E6(t))),i&&Bne(n,e))return n}var v6={x:NaN,y:NaN};function ck(e,t){let r=Nne(e,t);if(r!=null&&mV(r,e)&&mV(r,t))return r}function C6(e,t,r){let n=t.x*r.y-t.y*r.x;return n>0&&e||n<0&&!e}function S6(e,t){let{x:r,y:n}=wy(e),{deltaAngle:i}=ak(e);return i>0?{x:n-t.y,y:t.x-r}:{x:t.y-n,y:r-t.x}}function E6(e){return{x:e.x2-e.x1,y:e.y2-e.y1}}var om=class{constructor(){this.displayName="graphing-calculator-text-geometry-tool-box-selection-display-name",this.toolType="selection",this.icon=[{type:"stroked-path",color:"#aaa",path:[35,35,51,35,51,51,35,51,35,35]},{type:"filled-polygon",color:"#000",path:[50,50,63.5,62,58.25,62.75,62,72.5,59.75,74,55.25,64.25,50.75,68,50,50]}]}getNumberInputLatex(){return""}clearTentativeOutputs(){}canNextInputBePoint(){return!1}getAllValidNextInputTypes(){return __dcg_shared_module_exports__.tb.filter(e=>this.isValidNextInputType(e))}isValidNextInputType(e){return e!==__dcg_shared_module_exports__.Za}getNonPointInputType(){}getHint(){return""}getExpressionEditHint(e){return this.getHint()}onNumberInput(e){}onMove(e){return!0}onFocus(e){}tryCommitResults(){return{committed:void 0}}shouldUseJitEdges(){return!1}shouldHighlightRelevantObjects(){return!1}};function I6(e,t){return e===void 0?t===void 0:!(t===void 0||e.calcId!==t.calcId||e.listIndex!==t.listIndex||e.polygonEdge!==t.polygonEdge)}var pk=class{constructor(e){this.poiController=e,this.controller=e.controller,this.grapher=e.manager}getKeyboardAttention(){return this.objectUnderAttention}setKeyboardAttention(e){this.objectUnderAttention=e}findNonGeometryTabTargetsInGraph(){let e=this.controller.getGrapher3d();if(e)return e.getOrderedTabTargets();let t=this.grapher.imageLayer.getOrderedTabTargets(),r=this.grapher.clickableObjectsLayer.getOrderedTabTargets(),n=this.grapher.movablePointsLayer.getOrderedTabTargets();return t.concat(r).concat(n)}findTabbableObjectsForCurrentTool(e){let t=e==null?void 0:e.calcId,r={};if(this.controller.isGeometry()){let c=this.controller.getGeoModel();c.getAllChoosableDefsUnordered({mode:"tab"},c.getCurrentTool()).forEach(d=>{var u;r[d.calcId]||(r[d.calcId]=[]);let p={calcId:d.calcId,listIndex:d.listIndex,polygonEdge:(u=d.polygonEdgeInfo)==null?void 0:u.edgeNumber,geoDef:R({},d)};r[d.calcId].push(p)})}let n=this.controller.getGeoModel().getCurrentTool();(!this.controller.isGeometry()||n.isValidNextInputType(__dcg_shared_module_exports__.va))&&this.findNonGeometryTabTargetsInGraph().filter(c=>!(n instanceof om&&this.controller.isClickableId(c.calcId))).forEach(c=>{var d;let u=(d=c.listIndex)!=null?d:0;if(!r[c.calcId])r[c.calcId]=[];else if(u&&!(!this.controller.isGeometry()||this.controller.canExpandListForItem(c.calcId)))return;r[c.calcId][u]?r[c.calcId][u].description=c.description:r[c.calcId].push(c)});let i=[],o=-1,a=!1,s=this.controller.getGrapher3d(),l=s?s.getTabOrder():this.grapher.getTabOrder();for(let c of l){c===t&&(o=i.length);let d=r[c];if(d){d.sort((u,p)=>u.listIndex!==p.listIndex?u.listIndex===void 0?-1:p.listIndex===void 0?1:u.listIndex-p.listIndex:u.polygonEdge!==p.polygonEdge?u.polygonEdge===void 0?-1:p.polygonEdge===void 0?1:u.polygonEdge-p.polygonEdge:0);for(let u of d)c===t&&(a||(o=i.length),I6(u,e)&&(a=!0)),i.push(u)}}return{targets:i,currentTabIndex:o,currentIsTabbable:a}}findNextObjFromKeyboard(e,t){let{targets:r,currentIsTabbable:n,currentTabIndex:i}=this.findTabbableObjectsForCurrentTool(t);if(!r.length)return;if(i===-1)return e==="next"?{wrapped:!1,target:r[0]}:{wrapped:!1,target:r[r.length-1]};let o=!1,a=i;return e==="prev"?a-=1:n&&(a+=1),a===-1?(o=!0,a=r.length-1):a>=r.length&&(o=!0,a=0),{wrapped:o,target:r[a]}}focusNextObjFromKeyboard(e={}){let t={allowWrapping:!0,selectNonClickables:!1,direction:"next"},{direction:r,allowWrapping:n,selectNonClickables:i}=R(R({},t),e),o=this.findNextObjFromKeyboard(r,this.getKeyboardAttention());return!o||!n&&o.wrapped?(i&&this.controller.dispatch({type:"set-none-selected"}),!1):(o.wrapped&&this.controller.isVirtualMouseAllowed()?this.resetBackToGeoKeyboardPt():(i&&(this.controller.isClickableId(o.target.calcId)||!this.controller.isGeoItem(o.target.calcId)?this.controller.dispatch({type:"set-none-selected"}):this.controller.dispatch({type:"set-selected-id",id:o.target.calcId,state:"selected"})),this.updateKeyboardAttention(o.target,{describe:!0})),!0)}updateKeyboardAttention(e,t){let r=this.getKeyboardAttention();I6(e,r)||(this.setKeyboardAttention(e),this.controller.isGeometry()&&this.controller.getGeoModel().onFocus(e==null?void 0:e.geoDef),this.poiController.moveGeoKeyboardPtToFocusedItem(t),t.describe&&this.poiController.describeFocusedItem({includeDetails:!0}))}clearAttentionIfNotTabbable(){let{currentIsTabbable:e}=this.findTabbableObjectsForCurrentTool(this.getKeyboardAttention());e||this.updateKeyboardAttention(void 0,{describe:!1})}handleGrapherGainedFocus(){if(this.controller.getGeoModel().speakCurrentGeoToolHint(),this.controller.isVirtualMouseAllowed())this.resetBackToGeoKeyboardPt();else{let e=this.findTabbableObjectsForCurrentTool(void 0).targets;e.length?(this.setKeyboardAttention(void 0),this.updateKeyboardAttention(e[0],{describe:!0})):xe(this.controller.s("graphing-calculator-narration-geometry-no-tool-inputs"))}}resetBackToGeoKeyboardPt(){this.updateKeyboardAttention(void 0,{describe:!0}),this.poiController.geoKeyboardPt.x=this.poiController.geoKeyboardPt.lastArrowedX,this.poiController.geoKeyboardPt.y=this.poiController.geoKeyboardPt.lastArrowedY,this.poiController.handleGeoKeyboardPtMove()}};function uk(e){if(!e)return 0;if(e.type==="image"&&e.listIndex)return e.listIndex;if("poi"in e)return e.poi.pointIdxOnBranch;if("branchInfo"in e&&e.branchInfo.sketch){let t=e.branchInfo.branch,r=e.branchInfo.sketch.branches[t];return"listIndex"in r&&r.listIndex||0}return 0}var qne=0,hk=class Bn{constructor(t,r){this.geoKeyboardPt={x:NaN,y:NaN,lastArrowedX:NaN,lastArrowedY:NaN},this.canceledGeoToolplayWhilePressed=!1,this.manager=t,this.controller=t.controller,this.keyboardAttentionManager=new pk(this),this.graphSettings=r,this.elt=this.manager.elt,this.id=qne++,this.graphSettings.config.observe("disableMouseInteractions",()=>{this.graphSettings.config.disableMouseInteractions?this.removeHandlers():this.graphSettings.config.graphpaper&&this.addHandlers()}),this.speakThrottledDescription=__dcg_shared_module_exports__.z((n,i,o)=>{var a,s;let l=this.controller.getItemModel(n);if(!l||l.type!=="expression"&&l.type!=="image")return;let c=(s=(a=l.formula)==null?void 0:a.computed_description)==null?void 0:s[i];c&&c!==o&&xe(ei(c))},100,{leading:!1,trailing:!0}),!(!this.graphSettings.config.graphpaper||this.graphSettings.config.disableMouseInteractions)&&this.addHandlers()}remove(){this.removeHandlers()}addHandlers(){this.addTouchEventHandlers(),this.addHoverEventHandler(),this.addKeyboardEventHandlers(),this.addManualUnhoverListener(),this.addGeoEventHandlers()}removeHandlers(){this.removeAllGlobalMouseListeners(),this.removeManualUnhoverListener(),this.removeAllGeoListeners(),this.removeHoverEventHandler(),this.removeElementListeners()}removeElementListeners(){ee(this.elt).off("touchstart"),ee(this.elt).off("dcg-tapstart"),ee(this.elt).off("mouseleave"),ee(this.elt).off("keydown")}addGlobalMouseListener(t,r){let n=t.split(" ");for(let i of n){let o=i+".dcg-poiController-"+this.id;ee(document).on(o,r)}}removeAllGeoListeners(){ee(document).off(".dcg-poiController-geo-"+this.id)}removeAllGlobalMouseListeners(){ee(document).off(".dcg-poiController-"+this.id)}getToleranceByDevice(t){return t==="touch"?20:10}addGeoEventHandlers(){ee(document).on("mouseleave.dcg-poiController-geo-"+this.id,()=>{var t;if(this.controller.isGeoToolActive()&&!((t=this.pointerState)!=null&&t.isPressed)){let r=this.controller.getGeoModel();r.onMouseAction("move",{pt:{x:NaN,y:NaN},shift:!1,tolerance:0}),r.onPreviewChange()}}),ee(document).on("dcg-tapend.dcg-poiController-geo-"+this.id,t=>{var r;let n=!!((r=this.pointerState)!=null&&r.isPressed),i=this.updatePointerState(t);this.controller.isGeoToolActive()&&n&&this.handleGeoTapEnd(i,t)})}removeHoverEventHandler(){ee(document).off(".dcg-poiController-global-hover-"+this.id)}addHoverEventHandler(){let t="dcg-tapmove.dcg-poiController-global-hover-"+this.id;ee(document).on(t,r=>this.handleTapmove(r))}handleTapmove(t){var r;let n=this.updatePointerState(t);if(this.controller.isGeoToolActive()&&this.handleGeoTapMove(n)||t.device==="touch")return;let i=document.elementFromPoint(t.clientX,t.clientY),o=!!i&&!!i.closest(".dcg-grapher"),a=!!i&&!!i.closest(".dcg-label"),s=!!i&&!!i.closest(".dcg-opened"),l=a&&!s,c=(r=this.controller.getGrapher3d())==null?void 0:r.webglLayer,d=this.manager.poiLabelsLayer,u=this.getMouseRelativeToGrapher(t),p=this.getToleranceByDevice(t.device);c&&(c==null||c.setMouse(o?u:void 0));let g;o&&!a&&(g=this.getFeatureUnderPoint(u,p)),((t==null?void 0:t.originalEvent)||t).buttons&&(g=void 0);let f;if(g&&g.type==="movable-point"){let P=g.poi,F=P&&P.getMovablePoint();f=F&&F.id}let y,E=0;g&&g.isClickable&&!this.isBoxSelectActive(t)&&!this.manager.movablePointsLayer.isMovingPoint()&&!this.manager.traceLayer.isTracing()&&(y=g.model,E=uk(g));let _=this.manager.clickableObjectsLayer,w={};y&&(w[y.id]={listIndexes:E===void 0?void 0:{[E]:!0}}),_.setHoveredObjects(w);let v;g&&"poi"in g&&g.poi&&(!g.poi.isAttachedToPlottedPoint()||g.poi.hasInteractiveLabel())&&(v=g.poi);let T=!v&&l;v!==d.getHoveredPOI()&&!T&&(this.controller.isTraceEnabled()?d.setHoveredPOI(v):d.setHoveredPOI(void 0),this.controller.requestRedrawGraph());let M=!1;if(g&&g.type==="image"){let P=fc(g.model),F=g.isClickable;M=P&&!F}let C=!1;g&&g.type==="draggable-label"&&(C=!0),M||C?this.manager.setLayerClass("extraMoveCursor","dcg-mouse-over-movable-point"):this.manager.setLayerClass("extraMoveCursor",""),this.manager.movablePointsLayer.setHoveredPointId(f)}addManualUnhoverListener(){let t=()=>{let r=this.manager;r.poiLabelsLayer.setHoveredPOI(void 0),r.clickableObjectsLayer.setHoveredObjects({}),this.controller.requestRedrawGraph()};ee(window).on("blur.dcg-poiController-"+this.id,t),ee(this.elt).on("mouseleave",t)}removeManualUnhoverListener(){ee(window).off(".dcg-poiController-"+this.id)}getPickResults(t,r){let n=r.webglLayer,{x:i,y:o}=this.getMouseRelativeToGrapher(t);return n.setMouse({x:i,y:o}),n.pickAtMouseAndReadResults(),n.getPickResult()}isClickable(t){let r=this.controller.getItemModel(t);return bb(r)}add3DTouchEventHandlers(t){let r=t.elt;if(!r)return;let n=t.webglLayer;ee(r).on("dcg-tapstart",i=>{if(i.touches.length>1)return;let o=this.getPickResults(i,t);if(o!=null&&o.id){let{id:a,index:s}=o;this.isClickable(a)?(n.setPressedAction({id:a,index:s}),i.stopPropagation(),i.preventDefault()):this.controller.dispatch({type:"set-selected-id",id:a,state:"selected"})}}),ee(r).on("dcg-tapend dcg-tapcancel",()=>{let i=n.getPressedAction();i&&(n.setPressedAction(void 0),this.controller.dispatch({type:"clickable-item-clicked",id:i.id,listIndex:i.index})),n.isTrackingPressedAction=!1}),ee(r).on("dcg-tapmove",i=>{if(n.isTrackingPressedAction){let o=this.getPickResults(i,t);if(o!=null&&o.id){let{id:a,index:s}=o;this.isClickable(a)?n.setPressedAction({id:a,index:s}):n.setPressedAction(void 0)}else n.setPressedAction(void 0)}})}addTouchEventHandlers(){ee(this.elt).on("touchstart",t=>this.handleTouchstart(t)),ee(this.elt).on("dcg-tapstart",t=>this.handleTapstart(t))}handleTouchstart(t){if(!this.isViewportLocked()){t.target.matches("input, textarea")||t.preventDefault();return}let r=this.getMouseRelativeToGrapher(t),n=this.getToleranceByDevice(t.device),i=this.getFeatureUnderPoint(r,n);i&&(i.type==="image"&&!Sa(i.model)&&!fc(i.model)||i.type==="sketch-branch"&&this.graphSettings.config.onlyTraceSelected&&!i.sketch.selected||t.target.matches("input, textarea")||t.preventDefault())}handleTapstart(t){let r=this.updatePointerState(t);if(this.controller.isGeoToolActive()&&this.handleGeoTapStart(r,t)){t.handle();return}if(t.target.closest(".dcg-label")){t.handle("do-not-clear-poi-labels");return}let n=this.getMouseRelativeToGrapher(t),i=this.getToleranceByDevice(t.device),o=this.getFeatureUnderPoint(n,i);if(!o){this.isBoxSelectActive(t)||this.controller.dispatch({type:"set-none-selected"}),this.isBoxSelectActive(t)?this.startBoxSelect(t):this.manager.viewportController.beginPanning(t);return}if(o.isClickable&&!this.isBoxSelectActive(t)){let c="model"in o&&o.model;c?this.manager.clickableObjectsLayer.setPressedObject({id:c.id,listIndex:uk(o)}):this.manager.clickableObjectsLayer.setPressedObject(void 0)}else this.manager.clickableObjectsLayer.setPressedObject(void 0);if(o.type==="editable-label"){t.handle();return}else Jr();if(o.type==="draggable-label"){this.startMovingPoints({poiUnderMouse:void 0,evt:t,points:[{type:"draggable-label",label:o.label,model:o.model,startScreenPt:n}],originalTargetObjectId:o.model.id}),t.handle();return}if(o.type==="clickable-label"&&t.handle(),o.type==="image"&&fc(o.model)&&!this.isBoxSelectActive(t)){let c=!!o.isClickable;if(this.startMovingPoints({poiUnderMouse:void 0,evt:t,points:[{type:"image",image:o.model,startScreenPt:n,shouldDelayUntilRealMove:c}],originalTargetObjectId:o.model.id}),!c){t.handle();return}}let a=!1,s=o.model;if(this.controller.isGeometry()&&s&&s.type==="expression"&&s.formula.geometry){let c;"poi"in o&&(c=o.poi),a=this.startReverseDrag(s.id,t,c),a&&o.type!=="static-point"&&this.manager.clickableObjectsLayer.setPressedObject({id:s.id,listIndex:uk(o)}),!a&&o.isClickable&&this.controller.dispatch({type:"set-none-selected"})}if(o.type==="movable-point"&&(t.handle(),t.handle("do-not-clear-poi-labels"),!a)){this.startMovingPoints({poiUnderMouse:o.poi,evt:t,points:[{type:"poi",poi:o.poi,startScreenPt:n}],originalTargetObjectId:o.sketch.id});return}if(!a&&this._togglePOIUnderPoint(o)){t.handle(),t.handle("do-not-clear-poi-labels");return}if(!a&&o.type==="sketch-branch"&&!o.isClickable){let c=!this.controller.isTraceEnabled();if(this.graphSettings.config.onlyTraceSelected){if(t.handle("do-not-clear-poi-labels"),!c&&this.controller.getItemSelectedState(o.model.id)==="selected"&&!this.isBoxSelectActive(t)){this.startTracingBranch(o,n),t.handle();return}}else{let d=!this.controller.isListEnabled();if(c&&d||(this.selectItemIfNotSecret(o.model.id,{multiSelect:this.isBoxSelectActive(t),tentative:!1}),c))return;this.startTracingBranch(o,n),t.handle(),t.handle("do-not-clear-poi-labels");return}}(this.controller.shouldShowMultiSelectHeader()?"multi-select":"default")=="default"&&a||this.selectFeatureUnderMouse(o,{multiSelect:this.isBoxSelectActive(t),tentative:!0});let l=!1;this.addGlobalMouseListener("dcg-tapmove",c=>{l=!0,this.manager.clickableObjectsLayer.isAnObjectPressed()?n=this.getMouseRelativeToGrapher(c):a||(this.removeAllGlobalMouseListeners(),this.controller.isGeometry()&&(this.controller.dispatch({type:"clear-tentative-selection"}),this.addGlobalMouseListener("dcg-tapend",d=>{this.removeAllGlobalMouseListeners(),this.shouldTreatSmallDragAsClick(t,d)&&this.selectFeatureUnderMouse(o,{multiSelect:this.isBoxSelectActive(d),tentative:!1})})),this.manager.viewportController.beginPanning(c))}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",c=>{this.removeAllGlobalMouseListeners();let d=this.manager.clickableObjectsLayer.getPressedObject(),u=d&&d.id;this.manager.clickableObjectsLayer.setPressedObject(void 0);let p=this.getFeatureUnderPoint(n,i);if(p&&p.isClickable){let g="model"in p&&p.model;g&&g.id===u&&!c.wasHandled("dragged-clickable-object")&&!this.isBoxSelectActive(c)&&this.controller.dispatch({type:"clickable-item-clicked",id:g.id,listIndex:uk(p)});return}(!l||this.shouldTreatSmallDragAsClick(t,c))&&(this.controller.hasTentativeSelection()?this.controller.dispatch({type:"commit-tentative-selection"}):this.selectFeatureUnderMouse(p,{multiSelect:this.isBoxSelectActive(c),tentative:!1}))})}shouldTreatSmallDragAsClick(t,r){var n,i,o,a;let s=((n=r.clientX)!=null?n:NaN)-((i=t.clientX)!=null?i:NaN),l=((o=r.clientY)!=null?o:NaN)-((a=t.clientY)!=null?a:NaN),c=this.getToleranceByDevice(r.device);return Math.abs(s)<c&&Math.abs(l)<c}selectFeatureUnderMouse(t,r){var n;if(!t)return;let i=(n=t.model)==null?void 0:n.id;i&&(this.controller.isItemSelected(i)&&!r.multiSelect||this.controller.isItemSelected(i)&&r.tentative||t.type==="movable-point"&&!this.controller.isGeometry()||t.isClickable||this.selectItemIfNotSecret(i,r))}isBoxSelectActive(t){if(!this.controller.isMultiSelectEnabled())return!1;let r=this.controller.getActiveTool();return r==="selection"&&t.shiftKey||r==="box-selection"}isViewportLocked(){return this.graphSettings.config.lockViewport||this.graphSettings.userLockedViewport}addKeyboardEventHandlers(){let t=`dcg-poiController-${this.id}`;ee(document).on(`keyup.${t} keydown.${t}`,r=>{this.handleShiftKeyChange(r.shiftKey)}),ee(this.elt).on("keydown",r=>{var n,i,o,a,s;let l=r;if(this.manager.getAudioTrace().getAudioTraceActive())return;let c=this.manager.movablePointsLayer.getPOIUnderAttention(),d=this.manager.imageLayer.getFocusedImage(),u=ke(l),p=Ko(l);if((u==="Up"||u==="Down"||u==="Left"||u==="Right")&&this.controller.isGraphPaperFocused()){l.stopPropagation(),l.preventDefault();let g=this.keyboardAttentionManager.getKeyboardAttention(),f=this.controller.getActiveTool();if(!g&&(f==="selection"||f==="box-selection")&&!l.altKey&&!l.ctrlKey&&!l.metaKey&&!l.shiftKey){this.manager.viewportController.panFromKeyboard(u);return}else if(g&&this.controller.shouldAllowMovingPointsWithKeyboard()){let y=d?d.centerId:g.calcId;if(!y)return;let E=this.getDraggablePointOrAncestors(y,l);this.movePointsFromKeyboard(E,l),this.controller.getEvaluator().notifyWhenSynced(()=>{this.describeFocusedItem({includeDetails:!0})})}else this.controller.isVirtualMouseAllowed()&&(this.keyboardAttentionManager.updateKeyboardAttention(void 0,{describe:!1}),this.moveGeoPointFromKeyboard(l))}else if(u==="Tab"&&this.controller.isGraphPaperFocused()){let g=l.shiftKey?"prev":"next",f=this.keyboardAttentionManager.getKeyboardAttention();if(this.controller.getActiveTool()==="selection"&&!f&&g==="prev")return;this.handleTabEvent(g,l)}else if((u==="Enter"||u==="Space")&&this.controller.isGraphPaperFocused()&&this.controller.getActiveTool()==="selection"){let g=this.keyboardAttentionManager.getKeyboardAttention();if(g){let f=this.controller.getItemModel(g.calcId);if(f&&!this.isBoxSelectActive(l)){let y=f.type==="expression"&&$n(f),E=f.type==="image"&&Dg(f);if(y||E){this.controller.dispatch({type:"clickable-item-clicked",id:g.calcId,listIndex:g.listIndex});let _=g.listIndex||0;this.speakThrottledDescription(g.calcId,_,(i=(n=f.formula)==null?void 0:n.computed_description)==null?void 0:i[_])}}}l.preventDefault(),l.stopPropagation();return}else if(this.controller.isGeometry()&&this.controller.isGraphPaperFocused()){let g=!1;if(l.ctrlKey&&l.shiftKey&&!l.altKey&&!l.metaKey){let f;if(p==="O"?f={type:"multi-select-more",guid:rm(),focusFirstOption:!0,previousFocusLocation:{type:"graph-paper"}}:p==="A"&&(f={type:"multi-select-construct",guid:zv(),focusFirstOption:!0,previousFocusLocation:{type:"graph-paper"}}),f){l.preventDefault(),l.stopPropagation();let y=this.keyboardAttentionManager.getKeyboardAttention();this.controller.getActiveTool()!=="box-selection"&&y&&this.controller.getItemModel(y.calcId)&&this.controller.dispatch({type:"set-selected-id",id:y.calcId,state:"selected"}),this.controller.dispatch({type:"toggle-item-settings-menu",menu:f})}}else if(!l.altKey&&!l.ctrlKey&&!l.metaKey){if(u==="Enter"||u==="Space")if(l.preventDefault(),this.controller.getActiveTool()!=="selection"&&l.stopPropagation(),this.controller.getActiveTool()==="box-selection"){let f=((o=this.keyboardAttentionManager.getKeyboardAttention())==null?void 0:o.calcId)||"";this.controller.isClickableId(f)&&(f=""),this.selectItemIfNotSecret(f,{multiSelect:!0,tentative:!1}),this.describeFocusedItem({includeDetails:!1})}else{let f=this.keyboardAttentionManager.getKeyboardAttention();this.activateGeoObjectFromKeyboard(f,l)}else if(p==="?")l.preventDefault(),l.stopPropagation(),this.controller.getGeoModel().speakCurrentGeoToolHint();else if(p==="D")l.preventDefault(),l.stopPropagation(),this.describeFocusedItem({includeDetails:!0});else if(u==="Backspace"||u==="Del"){l.preventDefault(),l.stopPropagation();let f=this.keyboardAttentionManager.getKeyboardAttention();this.controller.getActiveTool()!=="box-selection"&&f&&this.controller.getItemModel(f.calcId)&&this.controller.dispatch({type:"set-selected-id",id:f.calcId,state:"selected"}),this.controller.dispatch({type:"delete-all-selected-items"}),g=!0}else if(p==="-"||p==="="){l.preventDefault(),l.stopPropagation();let f=this.controller.getAllVisibleGeoToolbarItems(),y=f.findIndex(E=>(E==null?void 0:E.current)===this.controller.getActiveTool());for(let E=1;E<f.length;E++){let _=y+(p==="-"?-E:E);_<0&&(_=f.length+_),_>f.length-1&&(_=_-f.length);let w=(a=f[_])==null?void 0:a.current;if(this.selectGeoTool(w)){g=!0;break}}}else if(p==="["||p==="]"){l.preventDefault(),l.stopPropagation();let f=this.controller.getAllVisibleGeoToolbarItems().find(_=>(_==null?void 0:_.current)===this.controller.getActiveTool());if(!f)return;let y=f.dropdown||[f.current];if(y.length===0)return;let E=y.indexOf(f.current);for(let _=1;_<y.length;_++){let w=E+(p==="["?-_:_);w<0&&(w=y.length+w),w>y.length-1&&(w=w-y.length);let v=y[w];if(this.selectGeoTool(v)){g=!0;break}}}else if(!l.shiftKey&&p!==void 0&&p>="0"&&p<="9"){let f=(s=this.controller.getAllVisibleGeoToolbarItems()[l.which-49])==null?void 0:s.current;g=this.selectGeoTool(f)}}g&&this.handleGeoKeyboardPtMove()}else c&&(p==="X"||p==="Y"||p==="L"||p==="C")?this.speakPoint(c,p):d&&(p==="X"||p==="Y"||p==="L")&&this.manager.imageLayer.speakImageAttribute(d,p)})}selectGeoTool(t){return t?this.controller.isGeoToolEnabled(t)?(this.controller.dispatch({type:"select-geo-tool",tool:t}),!0):(xe(this.controller.s("graphing-calculator-narration-geometry-tool-disabled",{tool:this.controller.getGeoModel().getDisplayNameForTool(t)})),!1):!1}getMouseRelativeToGrapher(t){let r=this.elt.getBoundingClientRect(),n=t.touches?t.touches[0]:t,i=n.clientX-r.left,o=n.clientY-r.top;return{x:i,y:o}}_getStyledPointRadiusAdjustments(){return{radiusMultiplier:this.graphSettings.getHighlightPropertyMultiplier("pointLineWidth",!1),selectedRadiusMultiplier:this.graphSettings.getHighlightPropertyMultiplier("pointLineWidth",!0)}}_getStyledPointRadiusForPOI(t,r){let n=t.getPointSize()/2,i=t.isSelected()?r.selectedRadiusMultiplier:r.radiusMultiplier;return n*i}handleTabEvent(t,r){let n=this.controller.getActiveTool()!=="selection";if(this.keyboardAttentionManager.focusNextObjFromKeyboard({direction:t,allowWrapping:n,selectNonClickables:this.controller.getActiveTool()==="selection"})){r==null||r.preventDefault(),r==null||r.stopPropagation();return}else if(!n){this.keyboardAttentionManager.updateKeyboardAttention(void 0,{describe:!1}),t==="prev"&&(r==null||r.preventDefault(),r==null||r.stopPropagation(),this.manager.speakGrapherFocusAriaLabel());return}}_getDistanceFromStyledPOI(t,r){let n=this._getStyledPointRadiusForPOI(t,r.adjustments),i=Math.max(0,r.tolerance-n),o=r.projection.map_pt(t),a=__dcg_shared_module_exports__.S(o.x-r.screenPt.x,o.y-r.screenPt.y),s=Math.max(0,a-n);if(s<=i)return s}_getClosestPoint(t,r,n){let i=1/0,o,a={projection:this.manager.getProjection(),adjustments:this._getStyledPointRadiusAdjustments(),screenPt:r,tolerance:n};for(let s of t){let l=this._getDistanceFromStyledPOI(s,a);l!==void 0&&l<=i&&(i=l,o=s)}return o}findIdsThatIntersectBox(t){let r={};for(let n of this.manager.generateMergeDrawOrder()){let i=this.controller.getItemModel(n);if(i&&!this.controller.shouldIgnoreGraphInteractions(i)){if(i.type==="expression"){let o=this.manager.getGraphSketch(n);if(!o||$n(i)||this.controller.isItemNotSelectableBecauseItsSecret(n))continue;let a=o.branches;if(!a||!a.length)continue;for(let s=0;s<a.length;s++)if(this.doesBoxIntersectBranch(a[s],t)){r[i.id]=!0;break}}else if(i.type==="image"){let o=this.manager.getGraphImage(n);if(!o)continue;Bn.doesBoxIntersectAnyImage(o,t)&&(r[i.id]=!0)}}}return this.manager.poiDotsLayer.getDrawnPOI().forEach(n=>{let i=n.sketch.id,o=this.controller.getItemModel(i);o&&this.controller.shouldIgnoreGraphInteractions(o)||o&&o.type==="expression"&&$n(o)||this.controller.isItemNotSelectableBecauseItsSecret(i)||n.isBareLabel()||(n.isMovable()||n.isAttachedToPlottedPoint())&&Bn.doesBoxIntersectPOI(n,t)&&(r[i]=!0)}),r}_getStyledLineAdjustments(){return{thicknessMultiplier:this.graphSettings.getHighlightPropertyMultiplier("graphLineWidth",!1),selectedThicknessMultiplier:this.graphSettings.getHighlightPropertyMultiplier("graphLineWidth",!0)}}_getStyledLineThicknessForBranch(t,r,n){let i=Math.max(0,"lineWidth"in t&&t.lineWidth||0)/2;return r?i*n.selectedThicknessMultiplier:i*n.thicknessMultiplier}_getDistanceFromStyledBranch(t,r,n,i){let o=this._getStyledLineThicknessForBranch(t,r,i.adjustments),a=this.calculateDistanceFromBranch(t,i.screenPt,i.projection,n),s=Math.max(0,a-o),l=Math.max(0,i.tolerance-o);if(s<=l)return s}getLabelUnderPoint(t){let r=this.manager.poiLabelsLayer.getInteractiveLabelUnderPoint(t);if(r&&!this.controller.shouldIgnoreGraphInteractions(r.model))switch(r.type){case"editable":return{type:"label",stackingContext:-1/0,stackingLayer:r.layerNumber,distance:0,label:{type:"editable-label",model:r.model,isClickable:void 0}};case"draggable":return{type:"label",stackingContext:-1/0,stackingLayer:r.layerNumber,distance:0,label:{type:"draggable-label",label:r.label,model:r.model,isClickable:void 0}};case"clickable":return{type:"label",stackingContext:-1/0,stackingLayer:r.layerNumber,distance:0,label:{type:"clickable-label",model:r.model,poi:r.poi,isClickable:!0}}}}getFeatureUnderPointInLayer(t,r,n,i){var o,a,s,l;let c,d=t.layer,u=t.drawOrder,p=this.manager.getProjection(),g={adjustments:this._getStyledLineAdjustments(),projection:p,screenPt:r,tolerance:n},f=1;for(let y=u.length-1;y>=0;y--){let E=u[y],_=this.controller.getItemModel(E),w=f;if(i[E]={layerNumber:d,stackingContext:w},!_){let v=this.manager.getGraphSketch(E),T=(a=(o=v==null?void 0:v.branches)==null?void 0:o[0])==null?void 0:a.tableId;if(T){let M=this.controller.getItemModel(T);(M==null?void 0:M.type)==="table"&&((s=M.regression)==null?void 0:s.id)===E&&(_=M)}}if(_&&!this.controller.shouldIgnoreGraphInteractions(_)){if(_.type==="expression"||_.type==="table"&&((l=_.regression)==null?void 0:l.id)===E){let v=this.manager.getGraphSketch(E);if(!v)continue;let T=v.branches;if(!T||!T.length)continue;if(v.hoistToTop&&!this.controller.isGeometry()&&(w=-1/0,i[E]={layerNumber:1/0,stackingContext:w}),!c||c.stackingContext>=w){let M=_.type==="table"?!1:$n(_);for(let C=0;C<T.length;C++){let P=T[C],F=this._getDistanceFromStyledBranch(P,v.showHighlight,M,g);if(F!==void 0){let B=!1;c?(w<c.stackingContext||w===c.stackingContext&&F<c.distance-3.5)&&(B=!0):B=!0,B&&(c={type:"sketch-branch",model:_,sketch:v,distance:F,stackingContext:w,stackingLayer:d,branchInfo:{id:v.id,branch:C,sketch:v}})}}}}else if(_.type==="image"){let v=this.manager.getGraphImage(E);if(!v)continue;let T=this.getImageInfoUnderMouse(v,p.pixelsToMath.mapPoint(r),n);if(!T)continue;f+=1,w=f,i[E]={layerNumber:d,stackingContext:w},f+=1,(!c||c.stackingContext>w)&&(c={type:"image",model:v,distance:0,stackingContext:w,stackingLayer:d,listIndex:T.listIndex})}}}return c}getFeatureUnderPoint(t,r){var n;if(this.manager.scaleAxis)return;let i,o=this.getLabelUnderPoint(t);if(o){if(o.label.type==="editable-label")return o.label;i=o}let a={},s=this.manager.getDrawLayers();for(let y=s.length-1;y>=0;y--){let E=s[y],_=this.getFeatureUnderPointInLayer(E,t,r,a);_&&(i?_.stackingLayer>i.stackingLayer&&(i=_):i=_)}let l=[],c=[],d=[],u=[];this.manager.poiDotsLayer.getDrawnPOI().forEach(y=>{var E;if(y.isBareLabel())return;let _=y.sketch.id,w=this.controller.getItemModel(_);if(!(w&&this.controller.shouldIgnoreGraphInteractions(w))){if(!w&&y.sketch.branches.length>0){let v=y.sketch.branches[0].tableId,T=v!==void 0?this.controller.getItemModel(v):void 0,M=(T==null?void 0:T.type)==="table"&&Eo(T,_);if(M&&this.controller.shouldIgnoreGraphInteractions(M))return}if(y.isMovable()){let v=w&&w.type==="expression"&&((E=w.formula.geometry)==null?void 0:E.call);(!i||i.stackingLayer<=a[y.sketch.id].layerNumber)&&(v&&v.symbol==="glider"?l.push(y):c.push(y))}else y.isAttachedToPlottedPoint()?(!i||i.stackingLayer<a[y.sketch.id].layerNumber||i.stackingLayer===a[y.sketch.id].layerNumber&&i.stackingContext>=a[y.sketch.id].stackingContext)&&d.push(y):u.push(y)}});let p=this._getClosestPoint(l,t,r);if(p||(p=this._getClosestPoint(c,t,r)),p)return{type:"movable-point",poi:p,isClickable:void 0,sketch:p.sketch,model:this.controller.getItemModel(p.sketch.id)};let g=this._getClosestPoint(u,t,r+2);if(g)return{type:"poi",poi:g,isClickable:!1,model:void 0};let f=this._getClosestPoint(d,t,r);if(f){let y=this.controller.getItemModel(f.sketch.id);return y&&y.type==="expression"&&$n(y)?{type:"static-point",poi:f,sketch:f.sketch,isClickable:!0,model:y}:{type:"static-point",poi:f,isClickable:!1,sketch:f.sketch,model:y}}if(i){if(i.type==="label")return i.label;if(i.type==="sketch-branch"){let y,E;if(i.model.type==="table")E=!0,y=!1;else{y=$n(i.model);let _=(n=i.model.formula.typed_constant_value)==null?void 0:n.valueType;E=!(this.controller.isGeometry()&&_&&__dcg_shared_module_exports__.yb(_))}return{type:"sketch-branch",branchInfo:i.branchInfo,sketch:i.sketch,model:i.model,isClickable:y,isTraceable:E,isSelected:this.controller.isItemSelected(i.model.id),selectionId:this.controller.isItemSelectable(i.model.id)?i.model.id:void 0}}else if(i.type==="image")return{type:"image",model:i.model,isClickable:Dg(i.model),listIndex:i.listIndex,isSelected:this.controller.isItemSelected(i.model.id),selectionId:this.controller.isItemSelectable(i.model.id)?i.model.id:void 0}}}_togglePOIUnderPoint(t){if(!this.controller.isTraceEnabled())return;if(t.isClickable)return!1;let r="poi"in t&&t.poi;return!r||r.isBareLabel()||this.controller.isGeometry()&&t.type==="static-point"&&!r.hasInteractiveLabel()?!1:(this.manager.poiLabelsLayer.isOpenPOI(r)?(this.manager.poiLabelsLayer.closePOI(r),this.manager.poiLabelsLayer.setHoveredPOI(void 0)):(this.manager.poiLabelsLayer.openPOI(r),this.speakPoint(r)),this.controller.requestRedrawGraph(),!0)}getImageInfoUnderMouse(t,r,n){if(!t)return;let i=t.formula;if(!i)return;let o=i.dimensions;if(!(!o.x||!o.y||!o.width||!o.height||!o.radianAngle||!t.shouldGraph))for(let a=o.x.length-1;a>=0;a--){let s=o.x[a],l=o.y[a],c=o.radianAngle[a],d=s+Math.cos(c)*(r.x-s)-Math.sin(c)*(r.y-l),u=l+Math.sin(c)*(r.x-s)+Math.cos(c)*(r.y-l),p=.5*Math.abs(o.width[a]),g=.5*Math.abs(o.height[a]);if(d>s-p&&d<s+p&&u>l-g&&u<l+g)return{listIndex:a}}}doesBoxIntersectBranch(t,r){let n=!1,i=!1;switch(t.graphMode){case 5:case 8:case 2:break;case 6:n=!0;break;case 1:i=!0;break;case 18:case 17:case 19:case 24:return dk(r,{x1:t.segments[0][0],y1:t.segments[0][1],x2:t.segments[0][2],y2:t.segments[0][3],extendStart:t.graphMode===18,extendEnd:t.graphMode!==17});case 20:return D6(r,{x:t.segments[0][0],y:t.segments[0][1],radius:t.segments[0][2]});case 21:case 23:{let[a,s]=t.segments[0],[l,c,d]=t.graphMode===21?this.getBoxIntersectArgsForArc(t):this.getBoxIntersectArgsForAngleMarker(t),u=(d-c)/2+c;return T6(r,{x0:a+l*Math.cos(c),y0:s+l*Math.sin(c),x1:a+l*Math.cos(u),y1:s+l*Math.sin(u),x2:a+l*Math.cos(d),y2:s+l*Math.sin(d)})}default:return!1}let o=t.segments;for(let a=0;a<o.length;a++){let s=o[a];if(n){let l=s;s=[];for(let c=0;c<l.length;c+=2){let d=l[c],u=l[c+1];s.push(u*Math.cos(d),u*Math.sin(d))}}else if(i){let l=s;s=[];for(let c=0;c<l.length;c+=2)s.push(l[c+1],l[c])}if(k6(r,s))return!0}return!1}getBoxIntersectArgsForArc(t){return[t.segments[0][2],t.segments[0][3],t.segments[0][4]]}getBoxIntersectArgsForAngleMarker(t){let r=t.segments[0][3],n=this.manager.getProjection(),i=Zu(r,n),o=n.pixelsToMath.dangerouslyGetXScaleFactor(),a=n.pixelsToMath.dangerouslyGetYScaleFactor();return[Math.abs(Math.min(o,a))*i,t.segments[0][2],t.segments[0][2]+r]}static doesBoxIntersectAnyImage(t,r){let n=t.formula;if(!n)return;let i=n.dimensions;if(!(!i.x||!i.y||!i.width||!i.height||!i.radianAngle||!t.shouldGraph)){for(let o=i.x.length-1;o>=0;o--)if(_6(r,{width:i.width[o],height:i.height[o],angle:i.radianAngle[o],center:{x:i.x[o],y:i.y[o]}}))return!0;return!1}}static doesBoxIntersectPOI(t,r){return r.left<=t.x&&t.x<=r.right&&r.top<=t.y&&t.y<=r.bottom}calculateDistanceFromBranch(t,r,n,i){let o=this.controller.isGeometry()&&t.graphMode===7;if(i||o){let s=[r.x,r.y],l=JL(n,t);for(let c of l)if(__dcg_shared_module_exports__.ba(c,s))return 0}if(t.graphMode===7)return 1/0;let a=Bn.getBranchesDistanceInfo(t,r,n,i,this.controller.isGeometry());return a?a.minDistance:1/0}static getBranchesDistanceInfo(t,r,n,i,o){let a=r.x,s=r.y,{mathToPixels:l,pixelsToMath:c}=n;switch(t.graphMode){case 5:if(!o&&!i)return;break;case 8:if(!i)return;break;case 6:if(!i)return;break;case 2:case 1:break;case 23:{let[_,w,v,T]=t.segments[0],M=l.dangerouslyGetXScaleFactor(),C=l.dangerouslyGetYScaleFactor(),[P,F]=c.mapCoordinatePair([a,s]),B=Zu(T,n),x=B/M,L=1/0,N=F-w,O=P-_,z=Math.atan2(N,O);if(__dcg_shared_module_exports__.Q(z,v,T))__dcg_shared_module_exports__.S(N*C,O*M)<=B+7&&(L=0);else{let V=__dcg_shared_module_exports__.V(P,F,_+x*Math.cos(v),w+x*Math.sin(v),_,w),$=__dcg_shared_module_exports__.V(P,F,_+x*Math.cos(v+T),w+x*Math.sin(v+T),_,w),G=__dcg_shared_module_exports__.S(M*(V[0]-P),C*(V[1]-F)),W=__dcg_shared_module_exports__.S(M*($[0]-P),C*($[1]-F));L=Math.min(G,W)}return{closestPoint:{x:a,y:s},minDistance:L,secondDistance:L}}case 18:case 17:case 19:case 24:{if(!t.segments.length)return null;let _=l.mapX(t.segments[0][0]),w=l.mapY(t.segments[0][1]),v=l.mapX(t.segments[0][2]),T=l.mapY(t.segments[0][3]),M=t.graphMode===18,C=t.graphMode===18||t.graphMode===19,P=__dcg_shared_module_exports__.W(a,s,_,w,v,T,M,C);if(!P)return null;let F=__dcg_shared_module_exports__.S(P[0]-a,P[1]-s);return{closestPoint:{x:P[0],y:P[1]},minDistance:F,secondDistance:F}}case 21:case 20:{let _=t.segments[0][0],w=t.segments[0][1],v=t.segments[0][2],T=t.graphMode===21?t.segments[0][3]:0,M=t.graphMode===21?t.segments[0][4]:Math.PI*2,C=__dcg_shared_module_exports__.X(c.mapX(a),c.mapY(s),_,w,v,T,M);if(!C)return null;let P=l.mapCoordinatePair(C),F=__dcg_shared_module_exports__.S(P[0]-a,P[1]-s);return{closestPoint:{x:P[0],y:P[1]},minDistance:F,secondDistance:F}}default:return}let d=1/0,u=1/0,p,g;for(let _=0;_<t.segments.length;_++){let w=t.segments[_];for(let v=0;v<w.length-3;v+=2){let T=w[v],M=w[v+1],C=w[v+2],P=w[v+3];if(t.graphMode===6){let z=M,V=T;T=z*Math.cos(V),M=z*Math.sin(V);let $=P,G=C;C=$*Math.cos(G),P=$*Math.sin(G)}t.graphMode===1&&([T,M]=[M,T],[C,P]=[P,C]);let[F,B]=l.mapCoordinatePair([T,M]),[x,L]=l.mapCoordinatePair([C,P]),N=__dcg_shared_module_exports__.V(0,0,F-a,B-s,x-a,L-s),O=__dcg_shared_module_exports__.S(N[0],N[1]);N[t.graphMode===1?1:0]<0?O<d&&(d=O,p=N):O<u&&(u=O,g=N)}}let f=d<u?p:g;if(!f)return;let y=f[0]+a,E=f[1]+s;return{closestPoint:{x:y,y:E},minDistance:Math.min(d,u),secondDistance:Math.max(d,u)}}static getBranchesTracePoint(t,r,n,i){let o,a=n.pixelsToMath.mapPoint(r);switch(t.graphMode){case 20:case 21:{let B=t.graphMode===21?t.segments[0][3]:0,x=t.graphMode===21?t.segments[0][4]:Math.PI*2;o=__dcg_shared_module_exports__.X(a.x,a.y,t.segments[0][0],t.segments[0][1],t.segments[0][2],B,x);break}case 18:case 19:case 17:o=__dcg_shared_module_exports__.W(a.x,a.y,t.segments[0][0],t.segments[0][1],t.segments[0][2],t.segments[0][3],t.graphMode===18,t.graphMode!==17);break}if(o)return{x:o[0],y:o[1]};if(!t)return;let s="compiled"in t&&t.compiled,l=s&&s.fn;if(!l)return;let c=this.getBranchesDistanceInfo(t,r,n,!1,i);if(!c)return;let{mathToPixels:d,pixelsToMath:u}=n,p,g;t.graphMode===2?(g="x",p="y"):(g="y",p="x",d=new __dcg_shared_module_exports__.jd(d.yScale,d.xScale),u=d.inverse());let f=Math.pow(c.minDistance/c.secondDistance,2),y=c.closestPoint[g]*(1-f)+r[g]*f,E=.5,_=.5,w=d.mapY(l(u.mapX(y-E))),v=d.mapY(l(u.mapX(y))),T=d.mapY(l(u.mapX(y+E))),M=E*Math.min(1,_/Math.abs(w-v)),C=E*Math.min(1,_/Math.abs(T-v));isFinite(M)||(M=E),isFinite(C)||(C=E);let P=ho(u.mapX(y-M),u.mapX(y+C)),F=l(P);if(!isFinite(d.mapY(F))){let B=d.mapX(P)-E,x=d.mapX(P)+E,L=u.mapX(B),N=u.mapX(x),O=l(L),z=l(N),V=d.mapY(O),$=d.mapY(z);Math.abs(V-r[p])<Math.abs($-r[p])?F=O:F=z}return{x:t.graphMode===2?P:F,y:t.graphMode===2?F:P}}getPointInfo(t){switch(t.type){case"movable-point":case"static-labeled-point":return A6(t);case"poi":return A6(t.poi.getMovablePoint());case"movable-point-parent":return{calcId:t.id,isReverseDrag:!0};case"image":return{calcId:t.image.formula.center_reference_id,isReverseDrag:!1};case"draggable-label":return{calcId:t.model.id,isReverseDrag:!1};default:return t}}getDraggablePointOrAncestors(t,r){if(!this.controller.isGeometry()){let l=this.controller.getItemModel(t);if(l&&l.type==="expression"&&xT(l)){let c=SH(l);return c?Ro(l)==="NONE"?[]:[R({type:"movable-point-parent",id:t,shouldDelayUntilRealMove:!0},c)]:[]}}let n=[t];(this.isBoxSelectActive(r)||this.controller.isItemSelected(t))&&n.push(...this.controller.getAllSelectedItems().map(l=>l.id).filter(l=>l!==t));let i=!1,o={},a=[];Qg({controller:this.controller},(l,c)=>{if(!c&&l.typedRuntimeValue.valueType===__dcg_shared_module_exports__.ya&&l.data.isMovablePoint){let[d,u]=l.typedRuntimeValue.value;o[l.calcId]={id:l.calcId,value:{x:d,y:u}}}});let s=this.controller.getGeoModel().getComputedBoard().computeReversibilityLineages(n);for(let l in s){let c=o[l];if(!c){i=!0;break}a.push({type:"movable-point-parent",id:l,x:c.value.x,y:c.value.y,shouldDelayUntilRealMove:!0,transformations:s[l]})}return i?[]:a}getFeatureCenterMathPoint(t){switch(t.type){case"poi":return t.poi;case"movable-point-parent":let r={x:t.x,y:t.y};if(t.transformations){let n=__dcg_shared_module_exports__.oc(t.transformations.forward,[r.x,r.y]);r={x:n[0],y:n[1]}}return r;case"image":return{x:t.image.formula.dimensions.x[0],y:t.image.formula.dimensions.y[0]};case"draggable-label":return{x:t.label.x,y:t.label.y}}}startReverseDrag(t,r,n){let i=this.getMouseRelativeToGrapher(r),o=this.getDraggablePointOrAncestors(t,r).map(a=>ie(R({},a),{startScreenPt:i}));return o.length>0?(this.startMovingPoints({poiUnderMouse:n,evt:r,points:o,originalTargetObjectId:t}),!0):!1}startMovingPoints(t){let r=t.points,n=!1,i=r.map(this.getPointInfo),o=this.controller;function a(){n=!0,o.dispatch({type:"start-moving-points",points:i})}let s=!1;for(let p of r)if(p.shouldDelayUntilRealMove){s=!0;break}s||a();let l;t.poiUnderMouse&&t.poiUnderMouse.isMovable()&&(l=t.poiUnderMouse.getMovablePoint().id),this.manager.movablePointsLayer.setPressedPointId(l);let c=r.map(p=>{let g=this.manager.getProjection().map_pt(this.getFeatureCenterMathPoint(p));return{x:p.startScreenPt.x-g.x,y:p.startScreenPt.y-g.y}}),d,u=()=>{if(!d)return;this.shouldTreatSmallDragAsClick(t.evt,d)||this.controller.dispatch({type:"clear-tentative-selection"}),n||a();let p=this.manager.getProjection(),g=this.getMouseRelativeToGrapher(d);d=void 0,this.controller.dispatch({type:"on-move-points",points:r.map(this.getPointInfo),screenPts:c.map(f=>({x:g.x-f.x,y:g.y-f.y})),transform:r.map(f=>f.type==="movable-point-parent"?f.transformations:void 0),previousScreenPts:r.map(f=>f.startScreenPt),projection:p})};this.manager.registerMovablePointListener(u),this.addGlobalMouseListener("dcg-tapmove",p=>{d=p}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",p=>{u(),this.manager.deregisterMovablePointListener(),this.removeAllGlobalMouseListeners(),this.manager.movablePointsLayer.setPressedPointId(void 0),n&&(p.handle("dragged-clickable-object"),this.controller.dispatch({type:"stop-moving-points",points:r.map(this.getPointInfo)}))})}startTracingBranch(t,r){if(!t.isTraceable)return;let n=t.branchInfo;this.manager.markLabelsDirty(),this.lastScreenPt=r;let i=this.manager.getProjection(),o=n.sketch.branches[n.branch],a=Bn.getBranchesTracePoint(o,r,i,this.controller.isGeometry());a&&this.speakPoint(a),this.manager.traceLayer.setTraceInfo({pt:a,branchInfo:n}),this.controller.requestRedrawGraph(),this.addGlobalMouseListener("dcg-tapmove",this.handleTraceUpdate.bind(this)),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",this.stopTracingBranch.bind(this))}stopTracingBranch(t){this.manager.markLabelsDirty();let r=this.manager.poiLabelsLayer.getHoveredPOI();r&&!this.manager.poiLabelsLayer.isOpenPOI(r)&&(this.manager.poiLabelsLayer.openPOI(r),this.speakPoint(r),this.controller.requestRedrawGraph()),this.lastScreenPt=void 0,this.manager.traceLayer.setTraceInfo(void 0),this.controller.requestRedrawGraph(),this.removeAllGlobalMouseListeners()}handleTraceUpdate(t){if(!this.manager.traceLayer.traceInfo)return;let r=this.manager.getProjection(),n;if(t)n=this.getMouseRelativeToGrapher(t),this.lastScreenPt=n,this.manager.markLabelsDirty();else if(this.lastScreenPt)n=this.lastScreenPt;else return;let i=1/0,o=-1,a=this.manager.traceLayer.traceInfo,s=this.manager.graphSketches[a.branchInfo.sketch.id];if(!s)return;a.branchInfo.sketch=s;let l=a.branchInfo.sketch.branches;for(let u=0;u<l.length;u++){let p=this.calculateDistanceFromBranch(l[u],n,r,!1);p<i&&(o=u,i=p)}let c=l[o],d=c?Bn.getBranchesTracePoint(c,n,r,this.controller.isGeometry()):void 0;d&&this.speakPoint(d),this.manager.traceLayer.traceInfo.branchInfo.branch=o,this.manager.traceLayer.traceInfo.pt=d,this.controller.requestRedrawGraph()}hasNonlinearMoveStrategy(t){if(!t||t.type!=="movable-point-parent")return!1;let r=this.controller.getItemModel(t.id);if(!r||r.type!=="expression"||!r.formula)return!1;let n=r.formula.move_strategy;return!n||!n[0]?!1:n[0].type==="updateSliderNonlinear"}movePointsFromKeyboard(t,r){if(!r)return;let n=this.manager.getProjection(),i=t.map(g=>{let{x:f,y}=n.map_pt(this.getFeatureCenterMathPoint(g));return{x:f,y}}),o=0,a=0,s=ke(r),l=(n.pixelCoordinates.right-n.pixelCoordinates.left)/40,c=(n.pixelCoordinates.bottom-n.pixelCoordinates.top)/40,d=s==="Up"||s==="Down"?c:l;d=r.shiftKey?d*5:d;let u,p;if(s==="Up"?(p="y",a-=d,u=r.shiftKey?"bigup":"up"):s==="Down"?(p="y",a+=d,u=r.shiftKey?"bigdown":"down"):s==="Left"?(p="x",o-=d,u=r.shiftKey?"bigdown":"down"):s==="Right"&&(p="x",o+=d,u=r.shiftKey?"bigup":"up"),u){let g=i.map(({x:y,y:E})=>({x:y+o,y:E+a})),f;p==="x"||t.some(y=>this.hasNonlinearMoveStrategy(y))?f={x:u}:p==="y"&&(f={y:u}),this.controller.dispatch({type:"on-move-points",points:t.map(y=>this.getPointInfo(y)),screenPts:g,previousScreenPts:i,transform:t.map(y=>y.type==="movable-point-parent"?y.transformations:void 0),projection:n,keyboardDirection:f})}}getGeoKeyboardPt(){return this.initGeoKeyboardPt(),this.geoKeyboardPt}setGeoKeyboardPt(t){this.geoKeyboardPt=ie(R({},this.geoKeyboardPt),{x:t.x,y:t.y}),t.fromArrowKeys&&(this.geoKeyboardPt.lastArrowedX=t.x,this.geoKeyboardPt.lastArrowedY=t.y),this.controller.requestRedrawGraph()}initGeoKeyboardPt(){if(!isNaN(this.geoKeyboardPt.x)&&!isNaN(this.geoKeyboardPt.y))return;let t=this.manager.getProjection();if(!t)return;let r=t.viewport,n=gl(t),i=n.minorStepX,o=n.minorStepY,a=Math.round((r.xmin+r.xmax)/2/i)*i,s=Math.round((r.ymin+r.ymax)/2/o)*o;this.setGeoKeyboardPt({x:a,y:s})}moveGeoPointFromKeyboard(t){if(!t)return;this.initGeoKeyboardPt();let r=this.manager.getProjection();if(!r)return;let n=r.viewport,i=gl(r),o=i.minorStepX/4,a=i.minorStepY/4,s=this.geoKeyboardPt.x,l=this.geoKeyboardPt.y,c=ke(t);c==="Down"?t.ctrlKey?l=n.ymin:l=Math.max(Math.round((l-a)/a)*a,n.ymin):c==="Up"?t.ctrlKey?l=n.ymax:l=Math.min(Math.round((l+a)/a)*a,n.ymax):c==="Left"?t.ctrlKey?s=n.xmin:s=Math.max(Math.round((s-o)/o)*o,n.xmin):c==="Right"&&(t.ctrlKey?s=n.xmax:s=Math.min(Math.round((s+o)/o)*o,n.xmax)),!(s===this.geoKeyboardPt.x&&l===this.geoKeyboardPt.y)&&(this.setGeoKeyboardPt({x:s,y:l,fromArrowKeys:!0}),this.handleGeoKeyboardPtMove(t),this.controller.getEvaluator().notifyWhenSynced(()=>{yt(ll(this.controller,this.geoKeyboardPt.x,this.geoKeyboardPt.y));let d=this.manager.clickableObjectsLayer.getHoveredObjects(),u=[];for(let p in d){let g=this.controller.getItemModel(p,{includePreviewItems:!0});g!==void 0&&u.push(Fo(g,this.controller,{includeDetails:!1,depth:this.controller.isToolPreviewItem(p)?0:1}))}u.length&&yt(this.controller.s("graphing-calculator-narration-geometry-near-item",{item:Cd(this.controller.getLanguage(),u)})),xe()}))}handleGeoKeyboardPtMove(t){this.initGeoKeyboardPt();let r=this.controller.getGeoModel(),n=!!(t&&t.shiftKey);r.onMouseAction("move",{pt:this.geoKeyboardPt,shift:n,tolerance:this.getToleranceByDevice("keyboard")}),r.onPreviewChange()}activateGeoObjectFromKeyboard(t,r){t!=null&&t.geoDef?this.tapGeoObjectFromKeyboard(t.geoDef,r):this.tapGeoPointFromKeyboard(r)}tapGeoObjectFromKeyboard(t,r){var n;let i=this.controller.getGeoModel(),o=i.getCurrentTool();if(!o)return;o.onFocus(t);let a=o.tryCommitResults();a.committed&&this.controller.dispatch(R({type:"commit-geo-objects",shiftKey:r.shiftKey},a)),i.updateNextObjectId(i.controller.findLastTokenNumber()+1),i.clearHoveredObjects(),i.onPreviewChange(),this.speakGeoReleaseAction(this.controller.getActiveTool(),(n=o.getSpec)==null?void 0:n.call(o),a.committed),this.keyboardAttentionManager.clearAttentionIfNotTabbable()}tapGeoPointFromKeyboard(t){var r;this.initGeoKeyboardPt();let n=this.controller.getGeoModel(),i=this.controller.getActiveTool(),o=n.getCurrentTool(),a=(r=o.getSpec)==null?void 0:r.call(o),s=!!t.shiftKey,l=n.onMouseAction("release",{pt:this.geoKeyboardPt,shift:s,tolerance:this.getToleranceByDevice("keyboard")});l.committed&&this.controller.dispatch(R({type:"commit-geo-objects",shiftKey:t.shiftKey},l)),n.onMouseAction("move",{pt:this.geoKeyboardPt,shift:s,tolerance:this.getToleranceByDevice("keyboard")}),n.onPreviewChange(),this.speakGeoReleaseAction(i,a,l.committed),this.keyboardAttentionManager.clearAttentionIfNotTabbable()}speakGeoReleaseAction(t,r,n){var i;if(n!==void 0){let o=Object.keys(n);if(!o.length||!r)return;let a="";if(t==="point"||t==="expression-edit"){for(let s in n){let l=n[s];if(l){if(l.type==="point-reference"){a=this.controller.s("graphing-calculator-text-geometry-tool-point-display-name");break}else if(l.type==="intersection"){a=this.controller.s("graphing-calculator-text-geometry-intersection");break}else if(l.type==="glider"){a=this.controller.s("graphing-calculator-text-geometry-glider");break}else if(l.type==="vector-endpoint"){l.location==="start"?a=this.controller.s("graphing-calculator-text-geometry-tool-vector-start-point-display-name"):a=this.controller.s("graphing-calculator-text-geometry-tool-vector-end-point-display-name");break}}}a===""&&(a=this.controller.s("graphing-calculator-text-geometry-tool-point-display-name"))}else{let s=(i=r.outputs[0])==null?void 0:i.type;switch(s){case"arc":a=this.controller.s("graphing-calculator-text-geometry-tool-arc-display-name");break;case"circle":a=this.controller.s("graphing-calculator-text-geometry-tool-circle-display-name");break;case"line":a=this.controller.s("graphing-calculator-text-geometry-tool-line-display-name");break;case"segment":a=this.controller.s("graphing-calculator-text-geometry-tool-segment-display-name");break;case"ray":a=this.controller.s("graphing-calculator-text-geometry-tool-ray-display-name");break;case"vector-copy":a=this.controller.s("graphing-calculator-text-geometry-tool-vector-copy-display-name");break;case"vector":a=this.controller.s("graphing-calculator-text-geometry-tool-vector-display-name");break;case"parallel":a=this.controller.s("graphing-calculator-text-geometry-tool-parallel-display-name");break;case"perpendicular":a=this.controller.s("graphing-calculator-text-geometry-tool-perpendicular-display-name");break;case"anglebisector":a=this.controller.s("graphing-calculator-text-geometry-tool-angle-bisector-display-name");break;case"midpoint":a=this.controller.s("graphing-calculator-text-geometry-tool-midpoint-display-name");break;case"polygon":a=this.controller.s("graphing-calculator-text-geometry-tool-polygon-display-name");break;case"angle":a=this.controller.s("graphing-calculator-text-geometry-tool-angle-display-name");break;case"directedangle":a=this.controller.s("graphing-calculator-text-geometry-tool-directed-angle-display-name");break;case"reflect":a=this.controller.s("graphing-calculator-text-geometry-tool-reflect-display-name");break;case"translate":a=this.controller.s("graphing-calculator-text-geometry-tool-translate-display-name");break;case"dilate":a=this.controller.s("graphing-calculator-text-geometry-tool-dilate-display-name");break;case"rotate":a=this.controller.s("graphing-calculator-text-geometry-tool-rotate-display-name");break;case"vector-endpoint":case"expression-edit-preview-latex":case"point":case"intersection":case"glider":case"slider":case"polygon-angle":case"polygon-directedangle":case"compass":case"polygon-segment":case"point-reference":case void 0:a=this.controller.s("shared-calculator-narration-item-unknown");break;default:let l=s;throw new Error("Exhaustive Check failed"+l)}}o.length===1?xe(this.controller.s("graphing-calculator-narration-geometry-added-object-type",{type:a})):a!=="graphing-calculator-text-geometry-point"?o.length===2?xe(this.controller.s("graphing-calculator-narration-geometry-added-object-type-and-point",{type:a})):xe(this.controller.s("graphing-calculator-narration-geometry-added-object-type-and-points",{type:a,points:o.length-1})):xe(this.controller.s("graphing-calculator-narration-geometry-added-points",{points:o.length}))}else this.controller.getGeoModel().speakCurrentGeoToolHint()}describeFocusedItem(t){let r=this.keyboardAttentionManager.getKeyboardAttention(),n=this.controller.getItemModel((r==null?void 0:r.calcId)||"");this.controller.getEvaluator().notifyWhenSynced(()=>{var i,o;if(!this.controller.isGeometry()&&n&&n.type==="image"&&((i=this.manager.imageLayer.getFocusedImage())==null?void 0:i.id)===n.id){this.manager.imageLayer.speakAriaAlert();return}n&&((o=this.manager.movablePointsLayer.getPOIUnderAttention())==null?void 0:o.sketch.id)===n.id&&this.manager.movablePointsLayer.speakAriaAlert()||xe(Fo(n,this.controller,{includeDetails:t.includeDetails,description:r==null?void 0:r.description,poi:this.manager.movablePointsLayer.getPOIUnderAttention(),listIndex:r==null?void 0:r.listIndex,polygonEdge:r==null?void 0:r.polygonEdge,includeSelectionState:this.controller.isGeometry()&&(this.controller.getActiveTool()==="box-selection"||this.controller.getActiveTool()==="selection")}))})}getPointFromFocusedItem(){var t;let r=this.keyboardAttentionManager.getKeyboardAttention(),n=this.controller.getItemModel((r==null?void 0:r.calcId)||"");if(!n||n.type!=="expression"||!n.latex)return;let i=n.formula.typed_constant_value;if(!i||!this.manager.getProjection())return;let o=i.valueType,a=i.value;if(__dcg_shared_module_exports__.wb(i.valueType)){let d=r==null?void 0:r.listIndex;d&&(o=__dcg_shared_module_exports__.xb(o),a=a[d])}let s=r==null?void 0:r.polygonEdge;if(o===__dcg_shared_module_exports__.Ja&&s!==void 0&&s>=0&&a.length>s){let d=a[s],u=a[(s+1)%a.length];o=__dcg_shared_module_exports__.La,a=[d,u]}let l=NaN,c=NaN;return o===__dcg_shared_module_exports__.ya?(l=a[0],c=a[1]):o===__dcg_shared_module_exports__.Ra||o===__dcg_shared_module_exports__.Ta||o===__dcg_shared_module_exports__.La?(l=(a[0][0]+a[1][0])/2,c=(a[0][1]+a[1][1])/2):o===__dcg_shared_module_exports__.$a?(l=a[1][0]+a[0][0]/2,c=a[1][1]+a[0][1]/2):(t=a[0])!=null&&t.length&&(l=a[0][0],c=a[0][1]),{x:l,y:c}}moveGeoKeyboardPtToFocusedItem(t){let r=this.getPointFromFocusedItem();if(!r)return;let{x:n,y:i}=r,o=this.keyboardAttentionManager.getKeyboardAttention(),a=this.controller.getFocusLocation(),s=a&&a.type==="expression"&&a.isFakeGraphFocus;this.controller.getGeoModel().setObjectHovered({calcId:(o==null?void 0:o.calcId)||"",listIndex:void 0}),!isNaN(n)&&!isNaN(i)?(this.setGeoKeyboardPt({x:n,y:i}),!s&&this.controller.isVirtualMouseAllowed()&&t.describe&&xe(this.controller.s("graphing-calculator-narration-geometry-moved-to-coordinates",{x:Bl(this.controller,n),y:Ul(this.controller,i)}))):!s&&this.controller.isVirtualMouseAllowed()&&t.describe&&xe(this.controller.s("graphing-calculator-narration-geometry-unable-to-move"))}speakPoint(t,r){if(!(!t||!this.manager.getAudioTrace()||!this.manager.getProjection()))switch(r){case"X":xe(Bl(this.controller,t.x));break;case"Y":xe(Ul(this.controller,t.y));break;case"L":"ariaLabel"in t&&t.ariaLabel?xe(t.ariaLabel):xe(this.controller.s("graphing-calculator-narration-poi-graph-point"));break;case"C":"sketch"in t&&xe(md(this.controller,t.sketch.color))}}selectItemIfNotSecret(t,r){this.controller.isItemNotSelectableBecauseItsSecret(t)||(!this.controller.isMultiSelectEnabled()||!r.multiSelect?this.controller.dispatch({type:"set-selected-id",id:t,state:r.tentative?"tentatively-selected":"selected"}):this.controller.dispatch({type:"toggle-selected-with-multi-select",id:t,state:r.tentative?"tentatively-selected":"selected"}))}convertTouchEventToMathPoint(t){let{clientX:r,clientY:n}=t.changedTouches[0],i=this.manager.elt.getBoundingClientRect();return this.controller.getGeoModel().convertCanvasPixelsToPoint({x:r-i.left,y:n-i.top})}handleGeoTapStart(t,r){let n=this.controller.getGeoModel();this.canceledGeoToolplayWhilePressed=!1;let i=t.shift;return n.onMouseAction("move",{pt:t.mathPoint,shift:i,tolerance:this.getToleranceByDevice(t.device)}).handled?(t.device==="mouse"?this.handleGeoTapMove(t):(n.onPreviewChange(),this.updateGeoHoveredObjects()),n.getToolMode()==="expression-edit"&&r.preventDefault(),!0):!1}updatePointerState(t){var r;let n=t.target&&t.target instanceof HTMLElement&&t.target.closest(".dcg-geometry-toolbar-view"),i=this.isEventWithinInstance(t),o;return t.type==="dcg-tapstart"?o=!0:t.type==="dcg-tapend"?o=!1:o=!!((r=this.pointerState)!=null&&r.isPressed),this.pointerState={mathPoint:this.convertTouchEventToMathPoint(t),device:t.device,shift:!!t.shiftKey,isPressed:o,isOnToolbar:n,isWithinInstance:i},(t.type==="dcg-tapmove"||t.type==="dcg-tapstart")&&this.updateClickToInsertMode(),this.pointerState}updateClickToInsertMode(){var t;let r=this.pointerState;if(!r||!this.controller.isGeometry()||((t=this.controller.getFocusLocation())==null?void 0:t.type)!=="expression")return;let n=this.controller.getGeoModel();n.getClickToInsertMode()!=="permissive"&&r.shift?n.getObjectDefUnderMouse(r.mathPoint,this.getToleranceByDevice(r.device),{shouldUseJitEdges:()=>!0,isValidNextInputType:()=>!0})&&this.controller.dispatch({type:"update-click-to-insert-mode",clickToInsertMode:"permissive"}):n.getClickToInsertMode()==="permissive"&&!r.shift&&this.controller.dispatch({type:"update-click-to-insert-mode",clickToInsertMode:"valid-type"})}handleShiftKeyChange(t){let r=this.pointerState;if(!(!r||r.shift===t)&&(r.shift=t,this.updateClickToInsertMode(),this.controller.isGeoToolActive())){let n=this.controller.getGeoModel();n.onMouseAction("move",{pt:r.mathPoint,shift:r.shift,tolerance:this.getToleranceByDevice("mouse")}),n.onPreviewChange()}}handleGeoTapMove(t){let r=this.controller.getGeoModel(),n;return!t.isOnToolbar&&(t.isWithinInstance||t.isPressed)?n=r.onMouseAction("move",{pt:t.mathPoint,shift:t.shift,tolerance:this.getToleranceByDevice(t.device)}).handled:(r.onMouseAction("move",{pt:{x:NaN,y:NaN},shift:!1,tolerance:0}),n=!0),r.onPreviewChange(),n}replayGeoTapMove(){let t=this.controller.getGeoModel(),r=this.pointerState;r&&(t.onMouseAction("move",{pt:R({},r.mathPoint),shift:r.shift,tolerance:this.getToleranceByDevice("mouse")}),t.onPreviewChange())}handleGeoTapEnd(t,r){var n;let i=this.controller.getGeoModel(),o=this.canceledGeoToolplayWhilePressed?{committed:void 0}:i.onMouseAction("release",{pt:t.mathPoint,shift:t.shift,tolerance:this.getToleranceByDevice(t.device)});this.canceledGeoToolplayWhilePressed=!1,o.committed&&this.controller.dispatch(R({type:"commit-geo-objects",shiftKey:t.shift},o)),t.isWithinInstance&&t.device==="mouse"?this.handleGeoTapMove(t):i.onPreviewChange();let a=this.controller.getActiveTool(),s=i.getCurrentTool(),l=(n=s.getSpec)==null?void 0:n.call(s);this.speakGeoReleaseAction(a,l,o.committed),i.getToolMode()==="expression-edit"&&r.preventDefault()}isEventWithinInstance(t){return t.target?this.manager.elt.contains(t.target):!1}updateGeoHoveredObjects(){let t=this.controller.getGeoModel(),r={};t.getHoveredItems().forEach(n=>{let i;if("tokenId"in n){let o=this.controller.getGeoTokenInfoFromIdentifier(__dcg_shared_module_exports__.na(n.tokenId));i=o&&o.calcId}else i=n.calcId;if(i!==void 0){let o=r[i];o?n.listIndex===void 0?o.listIndexes=void 0:o.listIndexes!==void 0&&(o.listIndexes[n.listIndex]=!0):r[i]={listIndexes:n.listIndex===void 0?void 0:{[n.listIndex]:!0}}}}),this.manager.clickableObjectsLayer.setHoveredObjects(r),this.manager.movablePointsLayer.setGeoHoveredObjects(this.controller.getActiveTool()==="point"?{}:r)}cancelGeoToolplay(){var t;this.canceledGeoToolplayWhilePressed=!!((t=this.pointerState)!=null&&t.isPressed),this.updateGeoHoveredObjects()}startBoxSelect(t){let r={};this.controller.getAllSelectedItems().forEach(o=>r[o.id]=!0);let n=this.manager.getProjection().reverse_map_pt(this.getMouseRelativeToGrapher(t)),i;this.addGlobalMouseListener("dcg-tapmove",o=>{i=this.manager.getProjection().reverse_map_pt(this.getMouseRelativeToGrapher(o));let a={left:Math.min(n.x,i.x),top:Math.min(n.y,i.y),right:Math.max(n.x,i.x),bottom:Math.max(n.y,i.y)};this.manager.setBoxSelectRectangle(a);let s=this.findIdsThatIntersectBox(a);this.controller.dispatch({type:"set-all-selected-ids",ids:R(R({},r),s)})}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",o=>{this.removeAllGlobalMouseListeners(),this.manager.setBoxSelectRectangle(void 0),i||this.controller.dispatch({type:"set-none-selected"})})}};function A6(e){return{calcId:e.sketch.id,isReverseDrag:!1,scaleFactor:e.type==="movable-point"?e.scaleFactor:void 0,tableInfo:e.type==="movable-point"?e.tableInfo:void 0}}var gk=class{constructor(e){this.savedPOI=[],this.controller=e}redrawToCtx(e,t,r,n,i){let{ctx:o,projection:a}=e,s=[];for(let l of Rv(i)){let c=t[l];if(!c)continue;if(c.hoistToTop&&!this.controller.isGeometry()){let u=c.showHighlight;u&&e.projection.settings.setProperty("highlight",!0),Td.drawSketchToCtx({sketch:c,drawContext:e,poiLabelsLayer:r,clickableObjectsLayer:n,geometryContext:this.controller.getGeoModel()}),u&&e.projection.settings.setProperty("highlight",!1)}let d=c.getPOI();(c.showPOI||d.length&&d[0].isAttachedToPlottedPoint())&&s.push.apply(s,this.drawPOIs(d,o,a))}this.savedPOI=s}getDrawnPOI(){return this.savedPOI}drawPOIs(e,t,r){t.lineWidth=r.settings.pointLineWidth,t.strokeStyle="#AAAAAA",t.fillStyle="#AAAAAA",t.lineJoin="round",t.lineCap="round";let n=[];if(e.length&&e[0].isAttachedToPlottedPoint())for(let i of e)Td.mapPointToScreen(r,i.x,i.y)&&n.push(i);else for(let i of e)Td.drawPointToCtx(R({ctx:t,projection:r},i))&&n.push(i);return n}};mg();var Wp=__dcg_shared_module_exports__.e(ne()),mk=class extends Wp.Class{template(){return Wp.createElement("div",{class:this.const(cf),style:()=>({width:this.props.width(),height:this.props.height(),position:"fixed",left:"0px",top:"0px"})},Wp.createElement("div",{class:Wp.const("dcg-container")},Wp.createElement("div",{class:Wp.const("dcg-grapher"),style:()=>({"font-size":this.props.concreteFontSize()})})))}};__dcg_shared_module_exports__.e(ne());var Ic=class extends _c{generateDefaultName(){return"does not matter"}},M6="graphing-calculator-text-geometry-tool-rotation-hint-center",Hne="graphing-calculator-text-geometry-tool-rotation-hint-angle",Kne="graphing-calculator-text-geometry-tool-rotation-hint-angle-start",Wne="graphing-calculator-text-geometry-tool-rotation-hint-angle-end",im=class extends Ic{constructor(e){super(e),this.model=e,this.displayName="graphing-calculator-text-geometry-tool-rotate-display-name",this.toolName="rotation",this.toolType="transformation"}getMode(){let{idMap:e}=this.model.getNonObjectsState().ui.currentTool;return e["2-number"]?"number":"directed-angle"}getExpressionEditHint(e){return e===0?this.s(M6):this.s(Hne)}onNumberInput(e){super.onNumberInput(e),this.clearTentativeOutputs()}onMove(e){return this.getMode()==="number"&&this.model.getNonObjectsState().ui.currentTool.inputIndex===1?!1:super.onMove(e)}getSpecIdToLockIn(e,t){if(t===1){let r=e.inputs[t];return this.getMode()==="number"?`${r.id}-number`:r.id}return super.getSpecIdToLockIn(e,t)}getPartialAnglePreviewInfo(){let{inputIndex:e,idMap:t}=this.model.getNonObjectsState().ui.currentTool;if(e>0){let r=this.model.findDefsForInputId(t[1])[0];if(!r)return;let n=[r.typedRuntimeValue],i=this.model.findDefsForInputId(t[2])[0],o=this.model.findDefsForInputId(t[3])[0];if(i&&o&&n.push(i.typedRuntimeValue,o.typedRuntimeValue),r)return{id:t["angle-output"],type:"rotation-with-incomplete-angle",args:n}}}getSpec(){let e={inputs:[{type:"point",id:"1",hint:M6},{type:"union",valueTypes:[__dcg_shared_module_exports__.ya,__dcg_shared_module_exports__.Xa],id:"2",hint:Kne,numberInputInfo:{defaultLatex:"",sliderInfo:{value:this.model.controller.getDegreeMode()?"90":"1.57079632679",min:"0",max:this.model.controller.getDegreeMode()?"360":"2\\pi"}}}],outputs:[]},t={id:"number-output",type:"rotate",hidden:this.getMode()!=="number",name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2-number"}]};if(this.getMode()==="directed-angle"){let{idMap:r,inputIndex:n}=this.model.getNonObjectsState().ui.currentTool;n>1&&delete e.inputs[1].numberInputInfo;let i=r[2],o=!1,a=i&&this.model.findDefsForInputId(i)[0];o=!!(a&&a.typedRuntimeValue.valueType==__dcg_shared_module_exports__.ya),o?(e.inputs.push({type:"point",id:"3",hint:Wne}),e.outputs.push({id:"directed-angle",type:"directedangle",hidden:!1,showAngleLabel:!1,parents:[{type:"reference-input",id:"2"},{type:"reference-input",id:"1"},{type:"reference-input",id:"3"}]},{id:"angle-output",type:"rotate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"directed-angle"}]})):e.outputs.push({id:"angle-output",type:"rotate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]})}else e.outputs.push(t);return e}},G6="graphing-calculator-text-geometry-tool-vector-hint-start",$ne="graphing-calculator-text-geometry-tool-vector-hint-end",jne="graphing-calculator-text-geometry-tool-vector-copy-hint-end",Yne={name:"vector",displayName:"graphing-calculator-text-geometry-tool-vector-display-name",toolType:"simple",icon:[{type:"stroked-path",path:[32,68,65,35],lineWidth:"large",arrow:!0},{type:"point",x:32,y:68},{type:"point",x:68,y:32}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__.ya,__dcg_shared_module_exports__.ya],hints:[G6,$ne]},output:[{type:"vector",parents:[0,1]}]},{input:{broadcast:!1,types:[__dcg_shared_module_exports__.$a,__dcg_shared_module_exports__.ya],hints:[G6,jne]},output:[{type:"vector-copy",parents:[0,1]}]}]},qv=class extends Vr{constructor(e){super(e,Yne),this.model=e}};function Xne(e){return Array.isArray(e)&&e.length===2&&e.every(t=>Array.isArray(t)&&t.length===2&&t.every(r=>!Array.isArray(r)&&!isNaN(r)))}function nm(e){if(!Xne(e))return __dcg_shared_module_exports__.Pb(__dcg_shared_module_exports__.$a);let t=e[1][0],r=e[1][1],n=e[1][0]+e[0][0],i=e[1][1]+e[0][1];return[[t,r],[n,i]]}var Jne=14,L6=2.5,Qne=40,Zne=15,eae=.75,tae=1;function uh(e){return e.valueType===__dcg_shared_module_exports__.ya?e.value:e.valueType===__dcg_shared_module_exports__.Da?e.value[0]:void 0}function rae(e){return e.valueType===__dcg_shared_module_exports__.$a?e.value:e.valueType===__dcg_shared_module_exports__.ab?e.value[0]:void 0}function oae(e){return e.valueType===__dcg_shared_module_exports__.Ra||e.valueType===__dcg_shared_module_exports__.Ta||e.valueType===__dcg_shared_module_exports__.La||e.valueType===__dcg_shared_module_exports__.$a?{segment:e.valueType===__dcg_shared_module_exports__.La,value:e.value}:e.valueType===__dcg_shared_module_exports__.Sa||e.valueType===__dcg_shared_module_exports__.Ua||e.valueType===__dcg_shared_module_exports__.Ma||e.valueType===__dcg_shared_module_exports__.ab?{segment:e.valueType===__dcg_shared_module_exports__.Ma,value:e.value[0]}:void 0}function P6(e){return e.valueType===__dcg_shared_module_exports__.wa?e.value:e.valueType===__dcg_shared_module_exports__.Ba?e.value[0]:void 0}function V6(e){return e.valueType===__dcg_shared_module_exports__.Xa?e.value:e.valueType===__dcg_shared_module_exports__.Ya?e.value[0]:void 0}var fk=class{constructor(e){this.controller=e.controller}getTransformationPreviewInfoFromItem(e,t){var r;if(e.type!=="expression"||e.hidden)return;let{translationsWithVisibleVectorParent:n}=t.transformationPreviewParentData;if(n.has(e.id))return;let i=(r=e.formula.geometry)==null?void 0:r.transformation_preview_info;if(i)return ie(R({},i),{id:e.id})}getInprogressTransformation(e){let t=this.controller.getAllToolPreviewItems();for(let n of t){let i=this.getTransformationPreviewInfoFromItem(n,e);if(i)return i}let r=this.controller.getGeoModel().getCurrentTool();if(r instanceof im)return r.getPartialAnglePreviewInfo()}getHoveredOrSelectedTransformations(e){let t=this.controller.getAllSelectedItems(),r=this.controller.getHoveredOrFocusedTokenIdentifier(),n=r?this.controller.getItemsByIdentifier(r)[0]:void 0;n&&!t.some(o=>o.id===n.id)&&t.push(n);let i=[];return t.forEach(o=>{if(o.type!=="expression")return;let a=this.getTransformationPreviewInfoFromItem(o,e);a&&i.push(a)}),i}drawTranslationPreview(e,t,r,n){let i=t.mapx(r[0]),o=t.mapy(r[1]),a=t.mapx(n[0]),s=t.mapy(n[1]);e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=5,e.moveTo(i,o),e.lineTo(a,s),xc(e,i,o,a,s,20),e.stroke(),e.restore()}drawReflectionPreview(e,t,r){let n=r.value,i=r.segment,[o,a,s,l]=Rg([n[0][0],n[0][1],n[1][0],n[1][1]],t,18).clipped,c=(o+s)/2,d=(a+l)/2;if(i){let[_,w,v,T]=Rg([n[0][0],n[0][1],n[1][0],n[1][1]],t,17).clipped;c=(_+v)/2,d=(w+T)/2}if(isNaN(c)&&isNaN(d))return;let u=40,p=u/__dcg_shared_module_exports__.S(o-s,a-l),g=c+(l-a)*p,f=d-(s-o)*p,y=c-(l-a)*p,E=d+(s-o)*p;if(e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=4,e.moveTo(o,a),e.lineTo(s,l),this.controller.getGraphSettings().config.reflectionArc){let _=Math.atan2(f-d,g-c),w=u,v=u*.7;e.moveTo(g,f),e.ellipse(c,d,w,v,_,0,Math.PI,!1);let T=.35,M=_+Math.PI/2+T,C=_+Math.PI/2-T;xc(e,g+Math.cos(M),f+Math.sin(M),g,f,10),xc(e,y+Math.cos(C),E+Math.sin(C),y,E,10)}else e.moveTo(g,f),e.lineTo(y,E),xc(e,c,d,g,f,10),xc(e,c,d,y,E,10);e.stroke(),e.restore()}drawDilationPreview(e,t,r,n){e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=3;let i=n<.6||n>1.4&&n<2?6:10,o=t.pixelsToMath.mapX(25)-t.pixelsToMath.mapX(0);[[o,0],[0,o],[-o,0],[0,-o]].forEach(a=>{let s=[r[0]+a[0],r[1]+a[1]],l=__dcg_shared_module_exports__.oc(__dcg_shared_module_exports__.lc(r,n),s),[c,d]=t.map_xy_pairs(s),[u,p]=t.map_xy_pairs(l);e.moveTo(c,d),e.lineTo(u,p),xc(e,c,d,u,p,i)}),e.stroke(),e.restore()}drawRotationPreview(e,t,r,n,i,o){if(this.drawRotationCenterPreview(e,t,r),!(i===void 0||!isFinite(i))){if(o!==void 0&&o!==0&&isFinite(o)){if(n&&n[0]===r[0]&&n[1]===r[1])return;this.drawFullRotationAngle(e,t,r,i,o,!1)}else if(n){this.drawPlaceholderRotationAngle(e,t,n,i);return}}}drawFullRotationAngle(e,t,r,n,i,o){e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=L6;let a=Qne,s=-n,l=-i,c,d;if(o){let E=Rg([r[0],r[1],r[0]+Math.cos(n),r[1]+Math.sin(n)],t,19).clipped;c=E[0],d=E[1];let _=Rg([r[0],r[1],r[0]+Math.cos(n+i),r[1]+Math.sin(n+i)],t,19).clipped;e.moveTo(c,d),e.lineTo(E[2],E[3]),e.moveTo(c,d),e.lineTo(_[2],_[3]);let w=a*Math.abs(l),v=.5*(1-eae)*w,T=Math.min(v,Zne),M=(l>0?1:-1)*T/a;s+=M,l-=2*M}else[c,d]=t.map_xy_pairs(r);let u=l<=0,p=c+a*Math.cos(s),g=d+a*Math.sin(s),f=c+a*Math.cos(s+l),y=d+a*Math.sin(s+l);e.moveTo(p,g),e.arc(c,d,a,s,s+l,u),QL(e,f,y,s,l,10,a),e.stroke(),e.restore()}drawPlaceholderRotationAngle(e,t,r,n){e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=tae;let i=-n,[o,a]=t.map_xy_pairs(r);e.moveTo(o,a);let s=1.5*Zu(0,t);e.lineTo(o+s*Math.cos(i),a+s*Math.sin(i)),e.stroke(),e.restore()}drawRotationCenterPreview(e,t,r){let[n,i]=t.map_xy_pairs(r);e.save(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=L6,e.beginPath(),e.arc(n,i,Jne,0,2*Math.PI),e.stroke(),e.restore()}redrawToCtx(e){let{ctx:t,projection:r}=e,n=this.getInprogressTransformation(e),i=this.getHoveredOrSelectedTransformations(e);n&&i.push(n);for(let o=0;o<i.length;o++){let a=i[o],s=a.args;switch(a.type){case"translate":if(s.length===2){let l=uh(s[0]),c=uh(s[1]);l&&c&&this.drawTranslationPreview(t,r,l,c)}else if(s.length===1){let l=rae(s[0]);if(l){let[c,d]=nm(l);this.drawTranslationPreview(t,r,c,d)}}break;case"reflect":{let l=oae(s[0]);l&&this.drawReflectionPreview(t,r,l)}break;case"dilate":{let l=uh(s[0]),c=P6(s[1]);l&&c!==void 0&&isFinite(c)&&c!==1&&this.drawDilationPreview(t,r,l,c)}break;case"rotate":{let l=uh(s[0]);if(!l)return;let c=P6(s[1]),d=V6(s[1]),u,p;if(c!==void 0)p=this.controller.getDegreeMode()?c*Math.PI/180:c,u=0;else if(d)u=d[1],p=d[2],e.transformationPreviewParentData.rotationsWithVisibleAndCenteredAngle.has(a.id)&&(p=void 0);else return;this.drawRotationPreview(t,r,l,d?d[0]:void 0,u,p)}break;case"rotation-with-incomplete-angle":{let l=uh(s[0]);if(!l)return;let c,d;if(s.length>=3){let u=uh(s[1]);if(c=uh(s[2]),!l||!u||!c)return;let p=u[0]-c[0],g=u[1]-c[1];d=Math.atan2(g,p)}this.drawRotationPreview(t,r,l,c,d,void 0)}}}}};function O6(e){var t,r,n,i,o,a,s,l,c,d;let u=new Set,p=new Set,g=new Set,f=new Set,y={},E={};for(let v of[...e.getAllItemModels(),...e.getAllToolPreviewItems()]){if(v.type!=="expression"||Hi(v))continue;let T=v.formula.typed_constant_value;if(!T)continue;if(__dcg_shared_module_exports__.Ab(T.valueType,__dcg_shared_module_exports__.$a)){let C=(t=pi(v))==null?void 0:t.identifier;C&&(y[C]=v.id)}let M=V6(T);if(M){let C=(r=pi(v))==null?void 0:r.identifier;C&&(E[C]={id:v.id,value:M})}}let _=e.getHoveredOrFocusedTokenIdentifier(),w=[...e.getAllItemModels().filter(v=>{var T;if(e.isItemSelected(v.id))return!0;if(v.type==="expression"&&_){let M=(T=pi(v))==null?void 0:T.identifier;return _===M}return!1}),...e.getAllToolPreviewItems()];for(let v of w){if(v.type!=="expression")continue;let T=v.formula.geometry,M=T==null?void 0:T.transformation_preview_info;if(((n=T==null?void 0:T.call)==null?void 0:n.symbol)==="translate"&&(M==null?void 0:M.args.length)===1&&__dcg_shared_module_exports__.Ab(M.args[0].valueType,__dcg_shared_module_exports__.$a)){let C=(a=(o=(i=v.formula.geometry)==null?void 0:i.call)==null?void 0:o.parents)==null?void 0:a[0];if(!C||C.type==="arbitrary-expression")continue;let P=y[__dcg_shared_module_exports__.Cc(C)];P&&(u.add(v.id),p.add(P))}if(((s=T==null?void 0:T.call)==null?void 0:s.symbol)==="rotate"&&M!=null&&M.args&&(M==null?void 0:M.args.length)>1&&__dcg_shared_module_exports__.Ab(M.args[1].valueType,__dcg_shared_module_exports__.Xa)){let C=(d=(c=(l=v.formula.geometry)==null?void 0:l.call)==null?void 0:c.parents)==null?void 0:d[1];if(!C||C.type==="arbitrary-expression")continue;let P=E[__dcg_shared_module_exports__.Cc(C)];if(!P)continue;f.add(P.id);let F=uh(M.args[0]);if(!F)continue;P.value[0][0]===F[0]&&P.value[0][1]===F[1]&&g.add(v.id)}}return{translationsWithVisibleVectorParent:u,translationPreviewVectorParents:p,rotationsWithVisibleAndCenteredAngle:g,rotationPreviewAngleMarkerParents:f}}var Ia=class xi{constructor(t=0,r=0,n=1,i=n){this.tx=t,this.ty=r,this.sx=n,this.sy=i}toJSON(){return{tx:this.tx,ty:this.ty,sx:this.sx,sy:this.sy}}compose(t){return new xi(this.sx*t.tx+this.tx,this.sy*t.ty+this.ty,this.sx*t.sx,this.sy*t.sy)}translate(t,r){let n=r===void 0?t.x:r.x-t.x,i=r===void 0?t.y:r.y-t.y;return new xi(this.tx+n,this.ty+i,this.sx,this.sy)}scale(t,r){return xi.scale(t,r).compose(this)}scaleAtPoint(t,r,n=r){return xi.scaleAtPoint(t,r,n).compose(this)}mapX(t){return this.sx*t+this.tx}mapY(t){return this.sy*t+this.ty}mapPoint(t){return{x:this.mapX(t.x),y:this.mapY(t.y)}}mapRect(t){return{left:this.mapX(t.left),right:this.mapX(t.right),bottom:this.mapY(t.bottom),top:this.mapY(t.top)}}};Ia.scale=function(e,t=e){return new Ia(0,0,e,t)},Ia.translate=function(e,t){return new Ia().translate(e,t)},Ia.scaleAtPoint=function(e,t,r=t){return r===void 0&&(r=t),new Ia(e.x*(1-t),e.y*(1-r),t,r)},Ia.fromRects=function(e,t){let r=(t.right-t.left)/(e.right-e.left),n=(t.top-t.bottom)/(e.top-e.bottom);return new Ia(t.left-r*e.left,t.bottom-n*e.bottom,r,n)},Ia.fromJSON=function(e){return new Ia(e.tx,e.ty,e.sx,e.sy)};var $p=Ia;qt();var{log10:bk}=Math;function bV(e,t){let r=t.x-e.x,n=t.y-e.y,i=.5*(e.x+t.x),o=.5*(e.y+t.y),a=.5*__dcg_shared_module_exports__.S(r,n);return{center:Aa(i,o),radius:a}}function R6(e,t){let r={x:2*e.x-t.x,y:2*e.y-t.y};return bV(t,r)}function F6(e,t){let r=[];for(let n=0;n<e.length;n++)r.push(Aa(e[n].pageX-t.left,e[n].pageY-t.top));return r}function Aa(e,t){return{x:e,y:t}}function N6(e){return Aa(.5*(e.left+e.right),.5*(e.bottom+e.top))}var aae=0,yk=class{constructor(e,t){this.s=Ip(()=>this.grapher.settings.config.language),this.grapher=e,this.elt=e.elt,this.id=aae++,this.controller=t,this.isScalingEnabled=!1,this.mousePt=Aa(0,0),this.lastScrollZoom=Date.now(),this.preventScrollZoom=!1,this.addMouseWheelEventHandler(),this.addTouchEventHandler()}remove(){ee(window).off(".viewportcontroller-"+this.id)}getViewport(){return this.grapher.getProjection().viewport}getProjection(){return this.grapher.getProjection()}isViewportLocked(){let e=this.getProjection().settings;return e.config.lockViewport||e.userLockedViewport}updateMouse(e){let t=this.elt.getBoundingClientRect();this.mousePt=Aa(e.clientX-t.left,e.clientY-t.top)}updateScaleAxis(){this.isMouseInViewport()&&(this.isMouseNearYAxis()?this.grapher.scaleAxis="y":this.isMouseNearXAxis()?this.grapher.scaleAxis="x":this.grapher.scaleAxis="both"),this.updateCursor(),this.controller.requestRedrawGraph()}updateCursor(){this.elt.classList.toggle("dcg-scale-horizontal",this.grapher.scaleAxis==="x"),this.elt.classList.toggle("dcg-scale-vertical",this.grapher.scaleAxis==="y"),this.elt.classList.toggle("dcg-scale-both",this.grapher.scaleAxis==="both")}isMouseNearOrigin(){let e=this.getProjection().mathToPixels.mapPoint(Aa(0,0));return Math.abs(this.mousePt.x-e.x)<50&&Math.abs(this.mousePt.y-e.y)<50}isMouseNearXAxis(){let e=this.getProjection(),t=e.pixelCoordinates,r=e.mathToPixels.mapY(0);return r=Math.min(Math.max(t.top,r),t.bottom),Math.abs(this.mousePt.y-r)<40&&e.settings.showXAxis}isMouseNearYAxis(){let e=this.getProjection(),t=e.pixelCoordinates,r=e.mathToPixels.mapX(0);return r=Math.min(Math.max(t.left,r),t.right),Math.abs(this.mousePt.x-r)<40&&e.settings.showYAxis}isMouseInViewport(){let e=this.getProjection(),t=e.mathCoordinates,r=e.pixelsToMath.mapPoint(this.mousePt);return r.x>=t.left&&r.x<=t.right&&r.y>=t.bottom&&r.y<=t.top}_setViewportWithoutCancellingAnimation(e){if(!e.isValid(this.controller.getAxisScaleSettings())||e.equals(this.getViewport()))return;let t=this.getProjection();this.grapher._setProjection(new Rs(t.screen,e,t.settings))}setViewport(e){this.cancelAnimation(),this._setViewportWithoutCancellingAnimation(e)}setScreen(e){let t=this.getProjection(),r=t.settings.squareAxes?t.viewport.squareYAxis(e,t.settings):t.viewport,n=new Rs(e,r,t.settings);this.grapher._setProjection(n)}getTransformedViewport(e){let{pixelCoordinates:t,mathCoordinates:r,settings:n}=this.getProjection(),{xAxisScale:i,yAxisScale:o}=n,a=e.mapRect(t),s=__dcg_shared_module_exports__.jd.fromRectsInverse(r,a,{xAxisScale:i,yAxisScale:o}).mapRect(t);return new Br(s.left,s.right,s.bottom,s.top)}transformViewport(e){this.setViewport(this.getTransformedViewport(e)),(this.grapher.scaleAxis==="x"||this.grapher.scaleAxis==="y")&&this.controller.markSquareAxesAfterUserEditedViewport()}animateToViewport(e){this.cancelAnimation();let t=this.getProjection(),r=t.viewport,n=t.mathToPixels,i=0,o,a=s=>{o||(o=s);let l=(s-o)/500;if(i+=l,i<1){this.__animationTimeout=requestAnimationFrame(a);let c=n.interpolateX(r.xmin,e.xmin,i),d=n.interpolateX(r.xmax,e.xmax,i),u=n.interpolateY(r.ymin,e.ymin,i),p=n.interpolateY(r.ymax,e.ymax,i);this._setViewportWithoutCancellingAnimation(new Br(c,d,u,p)),this.grapher.debounceUserRequestedViewportChange()}else this.setViewport(Br.fromObject(e)),this.grapher.debounceUserRequestedViewportChange(),this.controller.markSquareAxesAfterUserEditedViewport()};this.__animationTimeout=requestAnimationFrame(a)}cancelAnimation(){cancelAnimationFrame(this.__animationTimeout)}addMouseWheelEventHandler(){let e=!1,t,r;ee(window).on("scroll.viewportcontroller-"+this.id,o=>{e=!0}),ee(window).on("wheel.viewportcontroller-"+this.id,o=>{t=o.clientX,r=o.clientY}),ee(window).on("mousemove.viewportcontroller-"+this.id,o=>{if(!e)return;let a=o.clientX-t,s=o.clientY-r;a*a+s*s<100||(e=!1)});let n=0,i=o=>{let a=o.originalEvent;if(a.deltaX===0&&a.deltaY===0)return;let s=Date.now(),l=s-this.lastScrollZoom;if(this.preventScrollZoom&&l>50&&(this.preventScrollZoom=!1),this.lastScrollZoom=s,this.preventScrollZoom)return;let c=this.getProjection();if(this.isViewportLocked())return;let d=c.mathToPixels;if(e)return;a.preventDefault(),this.updateMouse(a);let u=d.mapPoint(Aa(0,0)),p=(a.deltaY===0?-a.deltaX:-a.deltaY)>0?1:-1,g=this.isMouseNearOrigin()&&p>0?u:this.mousePt;if(n>0)return;n+=1,requestAnimationFrame(()=>{n--});let{xAxisScale:f,yAxisScale:y}=c.settings,E=.0625;(f==="logarithmic"||y==="logarithmic")&&l<25&&(E*=Math.max(10,l)/25);let _=p>0?1+E:1/(1+E),w=this.grapher.scaleAxis,v=w==="x"||w==="both"||!w?_:1,T=w==="y"||w==="both"||!w?_:1,M=$p.scaleAtPoint(g,v,T),C=this.getTransformedViewport(M);p==-1&&this.tooBig(C)||p==1&&this.tooSmall(C)||(this.transformViewport(M),this.grapher.debounceUserRequestedViewportChange())};ee(this.elt).on("wheel",i)}applyPanTouchChanges(e,t){if(this.isViewportLocked()||this.isScalingEnabled)return;let r=Aa(t[0].x-e[0].x,t[0].y-e[0].y);this.transformViewport($p.translate(r)),this.grapher.debounceUserRequestedViewportChange()}chooseDragScaleCenter(){let e=this.getProjection(),t=e.pixelCoordinates,r=e.mathToPixels.mapX(0),n=e.mathToPixels.mapY(0);return r=Math.min(Math.max(t.left,r),t.right),n=Math.min(Math.max(t.top,n),t.bottom),Aa(r,n)}applyScaleTouchChanges(e,t){if(this.isViewportLocked())return;let r=this.grapher.scaleAxis,n,i;if(e.length===2&&t.length===2)n=bV(e[0],e[1]),i=bV(t[0],t[1]);else if(t.length===1){let d=this.chooseDragScaleCenter();n=R6(d,e[0]),i=R6(d,t[0])}else return;let o=i.radius/n.radius,a=r==="y"?1:o,s=r==="x"?1:o,l=$p.scaleAtPoint(n.center,a,s).translate(n.center,i.center),c=this.getTransformedViewport(l);o<1&&this.tooBig(c)||o>1&&this.tooSmall(c)||(this.transformViewport(l),this.grapher.debounceUserRequestedViewportChange())}panFromKeyboard(e){if(this.isViewportLocked()||this.isScalingEnabled)return;let t=Aa(0,0);e==="Up"?(xe(this.s("graphing-calculator-narration-viewport-pan-up")),t=Aa(0,-5)):e==="Down"?(xe(this.s("graphing-calculator-narration-viewport-pan-down")),t=Aa(0,5)):e==="Left"?(xe(this.s("graphing-calculator-narration-viewport-pan-left")),t=Aa(-5,0)):e==="Right"&&(xe(this.s("graphing-calculator-narration-viewport-pan-right")),t=Aa(5,0)),this.transformViewport($p.translate(t)),this.grapher.debounceUserRequestedViewportChange()}addTouchEventHandler(){let e=[],t=!1,r=!0,n=!0,i=p=>{t||this.isViewportLocked()||(this.updateMouse(p.originalEvent),this.isScalingEnabled&&this.updateScaleAxis())};ee(window).on("mousemove.viewportcontroller-"+this.id,i),this.beginPanning=p=>{let g=this.getProjection();if(this.isViewportLocked()||t||p.touches.length!==p.changedTouches.length)return;t=!0,this.grapher.isDragging=!0,this.updateMouse(p);let f=g.mathToPixels.mapPoint(Aa(0,0)),y=this.grapher.scaleAxis;(y==="x"||y==="both")&&(r=this.mousePt.x>f.x),(y==="y"||y==="both")&&(n=this.mousePt.y>f.y),this.controller.dispatch({type:"grapher/drag-start"}),ee(document).on("dcg-tapmove.graphdrag",d),ee(document).on("dcg-tapstart.graphdrag dcg-tapend.graphdrag dcg-tapcancel.graphdrag",u)};let o=p=>{if(p.length<2)return;let g=this.grapher.getProjection(),f=g.pixelCoordinates,y=g.mathToPixels.mapX(0),E=g.mathToPixels.mapY(0),_=40;y=Math.min(Math.max(f.left,y),f.right),E=Math.min(Math.max(f.top,E),f.bottom);let w=p[1].x-p[0].x,v=p[1].y-p[0].y;return Math.abs(p[0].x-y)<_&&Math.abs(p[1].x-y)<_&&Math.abs(v)>3*Math.abs(w)&&g.settings.showYAxis?"y":Math.abs(p[0].y-E)<_&&Math.abs(p[1].y-E)<_&&Math.abs(w)>3*Math.abs(v)&&g.settings.showXAxis?"x":"both"},a=p=>(this.grapher.scaleAxis||(this.grapher.scaleAxis=o(p)),this.grapher.scaleAxis),s=()=>{this.grapher.scaleAxis&&(this.grapher.scaleAxis=void 0,this.controller.requestRedrawGraph(),this.updateCursor())},l=()=>{this.isScalingEnabled=!1,this.preventScrollZoom=!0,s()},c=p=>p.altKey||p.ctrlKey||p.metaKey,d=p=>{let g=p;if(!t||this.isViewportLocked())return;let f=F6(g.touches,Gl(this.elt));if(e.length===2&&f.length===2)a(f),this.applyScaleTouchChanges(e,f);else if(e.length===1&&this.isScalingEnabled){this.updateMouse(g);let y=this.grapher.scaleAxis,E=this.getProjection().mathToPixels.mapPoint(Aa(0,0)),_,w,v=5,T=r?1:-1,M=n?1:-1;if((y==="x"||y==="both")&&(_=this.mousePt.x>E.x+v*T),(y==="y"||y==="both")&&(w=this.mousePt.y>E.y+v*M),y==="x"&&r!==_||y==="y"&&n!==w||y==="both"&&r!==_&&n!==w)return;this.applyScaleTouchChanges(e,f)}else s();e.length===1&&this.applyPanTouchChanges(e,f),this.controller.dispatch({type:"grapher/drag-move"}),e=f},u=p=>{let g=p;t&&(this.cancelAnimation(),e=F6(g.touches,Gl(this.elt)),g.touches.length===0&&(t=!1,this.grapher.isDragging=!1,ee(document).off(".graphdrag"),this.grapher.debounceUserRequestedViewportChange(),this.controller.dispatch({type:"grapher/drag-end"})),(g.touches.length===0||g.touches.length===1&&!this.isScalingEnabled)&&s())};ee(window).on("keydown.viewportcontroller-"+this.id,p=>{this.controller.isGeoToolActive()||this.isViewportLocked()||(ke(p)===tw&&!c(p)&&this.shouldAllowShiftScaling()?(this.isScalingEnabled=!0,this.grapher.scaleAxis||this.updateScaleAxis()):l())}),ee(window).on("keyup.viewportcontroller-"+this.id+" blur.viewportcontroller-"+this.id,l)}shouldAllowShiftScaling(){return!this.controller.isGeometry()}zoom(e){let t=this.getProjection().pixelCoordinates;if(e==="in"){let r=this.getTransformedViewport($p.scaleAtPoint(N6(t),2));this.tooSmall(r)||this.animateToViewport(r),xe(this.s("graphing-calculator-narration-viewport-zoom-in"))}else if(e==="out"){let r=this.getTransformedViewport($p.scaleAtPoint(N6(t),.5));this.tooBig(r)||this.animateToViewport(r),xe(this.s("graphing-calculator-narration-viewport-zoom-out"))}else if(e==="square"){let r=this.getSquareViewport();this.getProjection().settings.setProperty("squareAxes",!0),this.animateToViewport(r),xe(this.s("graphing-calculator-narration-viewport-zoom-square"))}else e==="default"&&this.setDefaultViewport()}tooBig(e){let t=this.getProjection(),{xAxisScale:r,yAxisScale:n}=t.settings,{xmin:i,xmax:o,ymin:a,ymax:s}=e;return r==="logarithmic"&&bk(o)-bk(i)>60||n==="logarithmic"&&bk(s)-bk(a)>60||this.controller.isGeometry()&&o-i>1e5}tooSmall(e){let{xmin:t,xmax:r}=e;return this.controller.isGeometry()&&r-t<1e-4}zoomSquareImmediately(){this.setViewport(this.getSquareViewport())}zoomCustom(e){this.animateToViewport(e),xe(this.s("graphing-calculator-narration-viewport-updated"))}setDefaultViewport(){let e=this.controller.getDefaultViewport();this.animateToViewport(e),xe(this.s("graphing-calculator-narration-viewport-default"))}isDefaultViewportRestored(){let e=this.getProjection(),{xAxisScale:t,yAxisScale:r}=e.settings,n=t==="linear",i=r==="linear",o=e.viewport,a=this.controller.getDefaultViewport(),s=n?o.xmax-o.xmin:Math.log(o.xmax/o.xmin),l=i?o.ymax-o.ymin:Math.log(o.ymax/o.ymin),c=n?o.xmin-a.xmin:Math.log(o.xmin/a.xmin),d=n?o.xmax-a.xmax:Math.log(o.xmax/a.xmax),u=i?o.ymin-a.ymin:Math.log(o.ymin/a.ymin),p=i?o.ymax-a.ymax:Math.log(o.ymax/a.ymax),g=.025;return Math.abs(c/s)<g&&Math.abs(d/s)<g&&Math.abs(u/l)<g&&Math.abs(p/l)<g}getSquareViewport(){let e=this.getProjection();return e.settings.lastChangedAxis==="y"?e.viewport.squareXAxis(e.screen,e.settings):e.viewport.squareYAxis(e.screen,e.settings)}};function sae(){return new hl(1024,768)}function B6(e){let{xAxisScale:t,yAxisScale:r}=e;return new Br(...t==="linear"?[-Xu,Xu]:[wr(10,-Ju),wr(10,Ju)],...r==="linear"?[-Xu,Xu]:[wr(10,-Ju),wr(10,Ju)])}var lae=document.createElement("canvas"),am=class Zs extends my{constructor(t,r,n,i){super({elt:t,settings:r,controller:n,evaluator:i}),this.type="2d",this.__screenRequested3D=new hl(768,768),this.lastActiveToken={selected:void 0,hovered:void 0};let o=sae(),a=B6(r).squareYAxis(o,r);this.setUserRequestedViewport(a),this.__projection=new Rs(o,a,r),this.markLabelsDirty=__dcg_shared_module_exports__.A(()=>{this.evaluator.notifyWhenSynced(()=>{this.poiLabelsLayer.markLabelsDirty(),this.controller.requestRedrawGraph()})},300),this.poiController=new hk(this,r),this.viewportController=new yk(this,this.controller),this.showPOIDots=!0,this.graphSketches={},this.graphImages={},this.audioGraph=new MD(n,this),this.boxSelectLayer=new GD;let s=document.createElement("div");this.elt.appendChild(s),this.imageLayer=new Nv(this),this.gridLayer=new HD,this.poiDotsLayer=new gk(this.controller),this.graphsLayer=new Td(this.controller,this.settings,d=>this.audioGraph.getExpressionAriaLabel(d)),this.transformationPreviewLayer=new fk(this),this.clickableObjectsLayer=new Ov(this),this.movablePointsLayer=new nv(this);let l=document.createElement("div");this.elt.appendChild(l),this.poiLabelsLayer=Hv.mountToNode(Pb,l,{grapher:()=>this});let c=document.createElement("div");this.elt.appendChild(c),this.geoKeyboardCursorLayer=Hv.mountToNode(FD,c,{grapher:()=>this}),this.traceLayer=this.poiLabelsLayer,this.scaleAxis=void 0}privateGetGridLayer(){return this.gridLayer}static copyGraphProperties(t,r){t=__dcg_shared_module_exports__.od(Os,t);let n=R({},t);delete n.viewport;let i=r.validateSettings(n);for(let o in i)r.setProperty(o,i[o]);return t}remove(){this.elt.remove(),this.poiController.remove(),this.viewportController.remove(),this.audioGraph.remove()}tick(t){(this.__redrawRequested||this.poiLabelsLayer.areAnyLabelsAnimating())&&this._redrawAllLayers(),this.__movablePointListener&&this.__movablePointListener()}registerMovablePointListener(t){this.__movablePointListener=t}deregisterMovablePointListener(){this.__movablePointListener=void 0}clear(){this.graphSketches={},this.graphImages={}}getGraphSketch(t){return this.graphSketches[t]}getGraphImage(t){return this.graphImages[t]}addGraphSketch(t){this.graphSketches[t.id]=t}removeGraphSketch(t){delete this.graphSketches[t]}addGraphImage(t){t.imageObj.width&&t.imageObj.height?(this.graphImages[t.id]=t,this.controller.requestRedrawGraph()):ee(t.imageObj).on("load.calc_load",()=>this.addGraphImage(t))}removeGraphImage(t){let r=this.graphImages[t];r&&ee(r.imageObj).off("load.calc_load"),delete this.graphImages[t],this.controller.requestRedrawGraph()}setBoxSelectRectangle(t){this.boxSelectRectangle=t,this.controller.requestRedrawGraph()}getProjection(){return this.__projection}_setProjection(t){this.__projection=t,this.controller.requestRedrawGraph()}getAudioTrace(){return this.audioGraph}getDefaultViewport(){let t=this.getProjection();return B6(this.settings).squareYAxis(t.screen,this.settings)}_updateScreenSize(t,r){if(t<=0||r<=0)return;let n=this.getProjection().screen;if(n.width===t&&n.height===r)return;let i=new hl(t,r);this.viewportController.setScreen(i)}update(){let{top:t,left:r,width:n,height:i}=this.controller.computeMajorLayout().grapher,o=this.controller.isGraphPaperFocused()&&!this.poiController.keyboardAttentionManager.getKeyboardAttention()&&!this.controller.getSelectedGeoExpression()&&!this.geoKeyboardCursorLayer.showCursor()&&!this.controller.inAudioTraceMode()&&wU();this.elt.classList.toggle("dcg-grapher-focused",o),this.controller.isThreeDMode()&&({width:n,height:i}=this.__screenRequested3D),n>0&&i>0?(this._setIsVisible(!0),this._updateScreenSize(n,i),Wn(this.elt,{position:"absolute",left:r+"px",top:t+"px",width:n+"px",height:i+"px"})):this._setIsVisible(!1)}setActiveToken(t,r){let n=this.lastActiveToken[r];this.lastActiveToken[r]=t;let i=t&&this.getGraphSketch(t),o=n&&this.getGraphSketch(n);o!==i&&(o&&(r==="selected"?o.tokenSelected=!1:r==="hovered"&&(o.tokenHovered=!1)),i&&(r==="selected"?i.tokenSelected=!0:r==="hovered"&&(i.tokenHovered=!0))),this.controller.requestRedrawGraph()}deselectSketch(t){let r=this.getGraphSketch(t);r&&(r.selected=!1,r.showPOI=!1,r.showHighlight=!1)}selectSketch(t){let r=this.getGraphSketch(t);r&&(r.selected=!0,r.showPOI=this.controller.isTraceEnabled(),r.showHighlight=!0)}setSketchHoistedToTop(t,r){let n=this.getGraphSketch(t);n&&(n.hoistToTop=r)}updateSketch(t,r){let n=this.getGraphSketch(t);if(!r.length){this.removeGraphSketch(t);return}let i=new BD(t,r);r[0].graphMode!==15&&(i.color=r[0].color,r[0].style&&(i.style=r[0].style)),n&&i.updateFrom(n);let o=this.controller.getPropagatedSelectedIds(),a=!!o.selected[t],s=!!o.hoistedToTop[t];i.selected=a,i.tokenHovered=t===String(this.lastActiveToken.hovered),i.tokenSelected=t===String(this.lastActiveToken.selected),i.showPOI=a&&this.controller.isTraceEnabled(),i.showHighlight=a,i.hoistToTop=s,this.addGraphSketch(i)}updateIntersections(t,r){let n=this.getGraphSketch(t);n&&n.updateIntersections(r)}_clear(){let t=this.getProjection().screen;this.canvasLayer.resize(t.width,t.height),this.canvasLayer.ctx&&(this.canvasLayer.ctx.clearRect(0,0,t.width,t.height),this.controller.isThreeDMode()?this.controller.getInvertedColors()||(this.canvasLayer.ctx.fillStyle="rgba(255,255,255,0.001961)",this.canvasLayer.ctx.fillRect(0,0,t.width,t.height)):US&&(this.controller.getInvertedColors()||(this.canvasLayer.ctx.fillStyle="rgb(0,0,0)",this.canvasLayer.ctx.fillRect(0,0,t.width,t.height))))}isDrawingPlaneFor3dMode(){return this.controller.showPlane3D()||this.controller.showNumbers3D()}createDrawContext(){if(this.canvasLayer.ctx)return{ctx:this.canvasLayer.ctx,projection:this.getProjection(),transformationPreviewParentData:O6(this.controller)}}_redrawAllLayers(){if(this.update(),!this.isVisible&&!this.isDrawingPlaneFor3dMode())return;this.__redrawRequested=!1;let t=Date.now();this._clear();let r=this.createDrawContext();this.audioGraph.recomputePoints(),this._redrawGrapher(r),this._redrawTransformationPreviewLayer(r),this._redrawBoxSelectLayer(r),this._redrawGeoKeyboardCursorLayer(),this._updateCanvasLayerAria(),this.events.triggerEvent("redraw",Date.now()-t);let n=this.controller.getGrapher3d();this.isDrawingPlaneFor3dMode()&&n&&n.webglLayer.updatePlaneMap()}_redrawTransformationPreviewLayer(t){t&&this.transformationPreviewLayer.redrawToCtx(t)}_redrawBoxSelectLayer(t){t&&this.boxSelectLayer.redrawToCtx(t,this.boxSelectRectangle)}_redrawGeoKeyboardCursorLayer(){this.geoKeyboardCursorLayer.update()}_updateCanvasLayerAria(){let t=0;for(let r in this.graphSketches)ul(this.controller,this.graphSketches[r])&&(t+=1);this.canvasLayer.updateAria(this.isVisible,t)}_redrawGrapher(t){if(!t)return;let r=this.controller.isThreeDMode();this.clickableObjectsLayer.recomputeClickableObjects(),r||(this.imageLayer.recomputeImages(t),this.movablePointsLayer.recomputeMovablePoints(t),this.poiLabelsLayer.recomputeLabels(t,this.size(),()=>this.drawLabelHitMask({projection:this.getProjection(),showMovablePoints:!0,includePillboxes:!0})));let n=i=>{this.graphsLayer.redrawToCtx(t,this.graphSketches,this.graphImages,i.drawOrder,this.poiLabelsLayer,this.clickableObjectsLayer),r||(this.poiLabelsLayer.copyToCtx(t.ctx,{filter:"canvas-labels",allowedSketches:i.drawSet}),this.movablePointsLayer.redrawToCtx(t.ctx,t.projection,i.drawOrder,{showMovablePoints:!0,renderForScreenshot:!1}))};for(let i of this.__drawLayers)i.layer<0&&n(i);this.gridLayer.redrawToCtx(t,this.scaleAxis);for(let i of this.__drawLayers)i.layer>=0&&n(i);!r&&this.showPOIDots&&this.poiDotsLayer.redrawToCtx(t,this.graphSketches,this.poiLabelsLayer,this.clickableObjectsLayer,this.__drawLayers)}size(){let t=this.canvasLayer.ctx;if(!t)return{width:0,height:0};let r=t.canvas.getBoundingClientRect();return{width:r.width,height:r.height}}_parseScreenshotOpts(t){return yV(t,this.settings,this.getProjection().screen)}_syncScreenshotReturnCanvas(t){let r=document.createElement("canvas");if(t&&t.braille){let{embosserModel:n,brailleMode:i}=t.braille,o=uy[n];r.width=o.width,r.height=o.height,t6(r,this,o,n,i,!!t.showMovablePoints)}else{let n=this._parseScreenshotOpts(t);r.width=n.width*n.targetPixelRatio,r.height=n.height*n.targetPixelRatio,this.screenshotToCanvas(r,t)}return r}screenshot(t){return t&&t.showLabels&&(t=ie(R({},t),{showLabels:!1})),this._syncScreenshotReturnCanvas(t).toDataURL("image/png")}asyncScreenshot(t,r){if(t&&t.format==="svg"){t.transparentBackground&&(t=__dcg_shared_module_exports__.Jc(t),t.transparentBackground=!1);let{width:n,height:i,targetPixelRatio:o}=this._parseScreenshotOpts(t);n*=o,i*=o;let a=new PK(n,i),s={getContext:()=>a,width:n,height:i};this.screenshotToCanvas(s,t),r(a.getSerializedSvg())}else{let n=this._syncScreenshotReturnCanvas(t);r(n.toDataURL("image/png"))}}makeScreenshotProjection(t){let{width:r,height:n,settings:i}=this._parseScreenshotOpts(t),o=new hl(r,n),a=this.getProjection().viewport;return this.settings.squareAxes&&(a=a.squareCrop(o,this.settings)),new Rs(o,a,i)}drawLabelHitMask(t){let r=t.projection,n=lae;n.width=r.screen.width,n.height=r.screen.height;let i=n.getContext("2d");i.clearRect(0,0,r.screen.width,r.screen.height);let o={ctx:i,projection:r,transformationPreviewParentData:{translationPreviewVectorParents:new Set,translationsWithVisibleVectorParent:new Set,rotationPreviewAngleMarkerParents:new Set,rotationsWithVisibleAndCenteredAngle:new Set}},a=[...this.generateMergeDrawOrder()];if(this.gridLayer.redrawToCtx(o),this.graphsLayer.redrawToCtx(o,this.graphSketches,this.graphImages,a,this.poiLabelsLayer,this.clickableObjectsLayer),this.movablePointsLayer.redrawToCtx(o.ctx,o.projection,a,{showMovablePoints:t.showMovablePoints,renderForScreenshot:!0}),t.includePillboxes){let s=this.elt.getBoundingClientRect(),l=this.controller.findEl(".dcg-overgraph-pillbox-elements"),c=this.controller.findEl(".dcg-graphpaper-branding");__dcg_shared_module_exports__.g([l,c],d=>{if(!d)return;let u=d.getBoundingClientRect();i.globalAlpha=1,i.fillStyle="black",i.fillRect(u.left-s.left,u.top-s.top,u.width,u.height)})}return i}screenshotToCanvas(t,r){let n=this._parseScreenshotOpts(r),{targetPixelRatio:i,transparentBackground:o}=n,a=t.getContext("2d");a.scale(i,i);let s=this.makeScreenshotProjection(r);s.settings.takingScreenshot=!0,Ja(a,"background"),No(a,"dcg-svg-background"),o?a.clearRect(0,0,s.screen.width,s.screen.height):(a.fillStyle="white",a.fillRect(0,0,s.screen.width,s.screen.height)),To(a),Qa(a);let l={ctx:a,projection:s,transformationPreviewParentData:{translationPreviewVectorParents:new Set,translationsWithVisibleVectorParent:new Set,rotationPreviewAngleMarkerParents:new Set,rotationsWithVisibleAndCenteredAngle:new Set}};this.imageLayer.recomputeImages(l);let c;if(r&&"showLabels"in r&&r.showLabels){let u=s.screen.width,p=s.screen.height,g=s.settings.labelSize||15,f=1;(u<200||p<200)&&(f=.9);let y=g*f+"px",E=document.createElement("div");E.classList.add("dcg-calculator-screenshot-labels-container"),Hv.mountToNode(mk,E,{concreteFontSize:()=>y,width:()=>`${s.screen.width}px`,height:()=>`${s.screen.height}px`}),document.body.append(E);let _=Hv.mountToNode(Pb,E.querySelector(".dcg-grapher"),{grapher:()=>this});_.takingScreenshot=!0;let w={width:s.screen.width,height:s.screen.height};_.recomputeLabels({projection:s,ctx:a,transformationPreviewParentData:{translationPreviewVectorParents:new Set,translationsWithVisibleVectorParent:new Set,rotationPreviewAngleMarkerParents:new Set,rotationsWithVisibleAndCenteredAngle:new Set}},w,()=>this.drawLabelHitMask({projection:s,showMovablePoints:!!r.showMovablePoints,includePillboxes:!1})),c={labelsLayer:_,layersWrapper:E}}let d=u=>{this.graphsLayer.redrawToCtx(l,this.graphSketches,this.graphImages,u.drawOrder,this.poiLabelsLayer,this.clickableObjectsLayer),c&&c.labelsLayer.copyToCtx(a,{filter:"canvas-labels",allowedSketches:u.drawSet}),this.movablePointsLayer.redrawToCtx(l.ctx,l.projection,u.drawOrder,{showMovablePoints:!!(r!=null&&r.showMovablePoints),renderForScreenshot:!0})};for(let u of this.__drawLayers)u.layer<0&&d(u);this.gridLayer.redrawToCtx(l);for(let u of this.__drawLayers)u.layer>=0&&d(u);c&&(c.labelsLayer.copyToCtx(a,{filter:"above-canvas",allowedSketches:new Set([...this.generateMergeDrawOrder()])}),c.layersWrapper.remove())}speakGrapherFocusAriaLabel(){this.canvasLayer.speakAriaLabelAgain()}_afterViewportChange(){}setGrapherState(t,r){if((!r||!r.doNotClear)&&this.clear(),"complex"in t&&!this.controller.canEnableComplexMode()&&(t=ie(R({},t),{complex:!1})),t=Zs.copyGraphProperties(t,this.settings),"viewport"in t){let n=Br.fromObject(t.viewport);this.setUserRequestedViewport(n);let i=this.computeConcreteViewport(n);this.viewportController.setViewport(i)}this.controller.requestRedrawGraph()}computeConcreteViewport(t){let r=this.getProjection().screen;return this.settings.squareAxes&&!t.isSquare(r,this.controller.getAxisScaleSettings())?t.squareYAxis(r,this.settings):t}setCanvasSizeFor3D(t,r){this.__screenRequested3D=new hl(t,r)}getCanvasNode(){return this.canvasLayer.canvasNode}};function yV(e,t,r){let n,i,o,a,s,l;return e?(n=e.width||e.height||r.width,i=e.height||e.width||r.height,o=e.targetPixelRatio||1,o<1&&(o=1),a=(n<256||i<256)&&!e.preserveAxisNumbers,s=Bp.fromObject(R(R({},t),e.settings)),l=!!e.transparentBackground):(n=r.width,i=r.height,o=1,a=!1,s=Bp.fromObject(t),l=!1),a&&(s.setProperty("xAxisNumbers",!1),s.setProperty("yAxisNumbers",!1),s.setProperty("polarNumbers",!1)),{width:n,height:i,targetPixelRatio:o,settings:s,transparentBackground:l}}var Ma=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],xk=Math.PI/180,xV=180/Math.PI;function Yl(){let e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Ma[e&255]+Ma[e>>8&255]+Ma[e>>16&255]+Ma[e>>24&255]+"-"+Ma[t&255]+Ma[t>>8&255]+"-"+Ma[t>>16&15|64]+Ma[t>>24&255]+"-"+Ma[r&63|128]+Ma[r>>8&255]+"-"+Ma[r>>16&255]+Ma[r>>24&255]+Ma[n&255]+Ma[n>>8&255]+Ma[n>>16&255]+Ma[n>>24&255]).toLowerCase()}function sm(e,t,r){return Math.max(t,Math.min(r,e))}function wV(e){return(e&e-1)===0&&e!==0}function Kv(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function vy(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(e*4294967295);case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int32Array:return Math.round(e*2147483647);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}var U6="155",z6=0,vV=1,q6=2,Wv=0,lm=1,ua=2,wk=0,hh=1,CV=2,SV=3,EV=4,vk=5,Od=100,H6=101,K6=102,W6=103,$6=104,Ck=200,Sk=201,j6=202,Y6=203,Ek=204,Tk=205,X6=206,J6=207,Q6=208,Z6=209,eW=210,tW=0,rW=1,oW=2,$v=3,iW=4,nW=5,aW=6,sW=7,TV=300,jv=1e3,cm=1001,Yv=1002,Rd=1003,lW=1004,DV=1005,ml=1006,cW=1007,Xv=1008,Vn=1009,dW=1010,pW=1011,Cy=1012,Dk=1013,Ac=1014,Xl=1015,Sy=1016,kk=1017,_k=1018,Fd=1020,uW=1021,Nd=1023,hW=1024,gW=1025,Yp=1026,gh=1027,mW=1028,Ik=1029,fW=1030,Ak=1031,Mk=1033,Gk=33776,Lk=33777,Pk=33778,Vk=33779,kV=35840,_V=35841,IV=35842,AV=35843,bW=36196,MV=37492,GV=37496,LV=37808,PV=37809,VV=37810,OV=37811,RV=37812,FV=37813,NV=37814,BV=37815,UV=37816,zV=37817,qV=37818,HV=37819,KV=37820,WV=37821,$V=36492,jV=36283,YV=36284,XV=36285,JV=36286,Ey="",Lo="srgb",Ga="srgb-linear",Ok=7680,yW=519,xW=512,wW=513,vW=514,CW=515,SW=516,EW=517,TW=518,DW=519,kW=35044,QV="300 es",Rk=1035,Jl=2e3,Jv=2001,ye=class Qs{constructor(t=0,r=0,n=0){this.x=t,this.y=r,this.z=n}set(t,r,n){return n===void 0&&(n=this.z),this.x=t,this.y=r,this.z=n,this}clone(){return new Qs(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addVectors(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}applyMatrix3(t){let r=this.x,n=this.y,i=this.z,o=t.elements;return this.x=o[0]*r+o[3]*n+o[6]*i,this.y=o[1]*r+o[4]*n+o[7]*i,this.z=o[2]*r+o[5]*n+o[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){let r=this.x,n=this.y,i=this.z,o=t.elements,a=1/(o[3]*r+o[7]*n+o[11]*i+o[15]);return this.x=(o[0]*r+o[4]*n+o[8]*i+o[12])*a,this.y=(o[1]*r+o[5]*n+o[9]*i+o[13])*a,this.z=(o[2]*r+o[6]*n+o[10]*i+o[14])*a,this}applyQuaternion(t){let r=this.x,n=this.y,i=this.z,o=t.x,a=t.y,s=t.z,l=t.w,c=l*r+a*i-s*n,d=l*n+s*r-o*i,u=l*i+o*n-a*r,p=-o*r-a*n-s*i;return this.x=c*l+p*-o+d*-s-u*-a,this.y=d*l+p*-a+u*-o-c*-s,this.z=u*l+p*-s+c*-a-d*-o,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}transformDirection(t){let r=this.x,n=this.y,i=this.z,o=t.elements;return this.x=o[0]*r+o[4]*n+o[8]*i,this.y=o[1]*r+o[5]*n+o[9]*i,this.z=o[2]*r+o[6]*n+o[10]*i,this.normalize()}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){return this.multiplyScalar(1/(this.length()||1))}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this.z+=(t.z-this.z)*r,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,r){let n=t.x,i=t.y,o=t.z,a=r.x,s=r.y,l=r.z;return this.x=i*l-o*s,this.y=o*a-n*l,this.z=n*s-i*a,this}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){let r=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return r*r+n*n+i*i}setFromMatrixPosition(t){let r=t.elements;return this.x=r[12],this.y=r[13],this.z=r[14],this}setFromMatrixColumn(t,r){let n=r*4,i=t.elements;return this.x=i[n],this.y=i[n+1],this.z=i[n+2],this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}toArray(t,r=0){return t[r]=this.x,t[r+1]=this.y,t[r+2]=this.z,t}fromBufferAttribute(t,r){return this.x=t.getX(r),this.y=t.getY(r),this.z=t.getZ(r),this}},Nt=class El{constructor(t,r,n,i,o,a,s,l,c,d,u,p,g,f,y,E){this.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,r,n,i,o,a,s,l,c,d,u,p,g,f,y,E)}set(t,r,n,i,o,a,s,l,c,d,u,p,g,f,y,E){let _=this.elements;return _[0]=t,_[4]=r,_[8]=n,_[12]=i,_[1]=o,_[5]=a,_[9]=s,_[13]=l,_[2]=c,_[6]=d,_[10]=u,_[14]=p,_[3]=g,_[7]=f,_[11]=y,_[15]=E,this}clone(){let t=new El,r=this.elements;for(let n=0;n<16;n++)t.elements[n]=r[n];return t}copy(t){let r=this.elements,n=t.elements;return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],this}setFromMatrix3(t){let r=t.elements;return this.set(r[0],r[3],r[6],0,r[1],r[4],r[7],0,r[2],r[5],r[8],0,0,0,0,1),this}extractRotation(t){let r=this.elements,n=t.elements,i=1/ZV.setFromMatrixColumn(t,0).length(),o=1/ZV.setFromMatrixColumn(t,1).length(),a=1/ZV.setFromMatrixColumn(t,2).length();return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r[3]=0,r[4]=n[4]*o,r[5]=n[5]*o,r[6]=n[6]*o,r[7]=0,r[8]=n[8]*a,r[9]=n[9]*a,r[10]=n[10]*a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromEuler(t){let r=this.elements,n=t.x,i=t.y,o=t.z,a=Math.cos(n),s=Math.sin(n),l=Math.cos(i),c=Math.sin(i),d=Math.cos(o),u=Math.sin(o);if(t.order==="XYZ"){let p=a*d,g=a*u,f=s*d,y=s*u;r[0]=l*d,r[4]=-l*u,r[8]=c,r[1]=g+f*c,r[5]=p-y*c,r[9]=-s*l,r[2]=y-p*c,r[6]=f+g*c,r[10]=a*l}else if(t.order==="YXZ"){let p=l*d,g=l*u,f=c*d,y=c*u;r[0]=p+y*s,r[4]=f*s-g,r[8]=a*c,r[1]=a*u,r[5]=a*d,r[9]=-s,r[2]=g*s-f,r[6]=y+p*s,r[10]=a*l}else if(t.order==="ZYX"){let p=a*d,g=a*u,f=s*d,y=s*u;r[0]=l*d,r[4]=f*c-g,r[8]=p*c+y,r[1]=l*u,r[5]=y*c+p,r[9]=g*c-f,r[2]=-c,r[6]=s*l,r[10]=a*l}return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromQuaternion(t){return this.compose(cae,t,dae)}lookAt(t,r,n){let i=this.elements;return fl.subVectors(t,r),fl.lengthSq()===0&&(fl.z=1),fl.normalize(),mh.crossVectors(n,fl),mh.lengthSq()===0&&(Math.abs(n.z)===1?fl.x+=1e-4:fl.z+=1e-4,fl.normalize(),mh.crossVectors(n,fl)),mh.normalize(),Fk.crossVectors(fl,mh),i[0]=mh.x,i[4]=Fk.x,i[8]=fl.x,i[1]=mh.y,i[5]=Fk.y,i[9]=fl.y,i[2]=mh.z,i[6]=Fk.z,i[10]=fl.z,this}multiply(t){return this.multiplyMatrices(this,t)}multiplyMatrices(t,r){let n=t.elements,i=r.elements,o=this.elements,a=n[0],s=n[4],l=n[8],c=n[12],d=n[1],u=n[5],p=n[9],g=n[13],f=n[2],y=n[6],E=n[10],_=n[14],w=n[3],v=n[7],T=n[11],M=n[15],C=i[0],P=i[4],F=i[8],B=i[12],x=i[1],L=i[5],N=i[9],O=i[13],z=i[2],V=i[6],$=i[10],G=i[14],W=i[3],U=i[7],D=i[11],de=i[15];return o[0]=a*C+s*x+l*z+c*W,o[4]=a*P+s*L+l*V+c*U,o[8]=a*F+s*N+l*$+c*D,o[12]=a*B+s*O+l*G+c*de,o[1]=d*C+u*x+p*z+g*W,o[5]=d*P+u*L+p*V+g*U,o[9]=d*F+u*N+p*$+g*D,o[13]=d*B+u*O+p*G+g*de,o[2]=f*C+y*x+E*z+_*W,o[6]=f*P+y*L+E*V+_*U,o[10]=f*F+y*N+E*$+_*D,o[14]=f*B+y*O+E*G+_*de,o[3]=w*C+v*x+T*z+M*W,o[7]=w*P+v*L+T*V+M*U,o[11]=w*F+v*N+T*$+M*D,o[15]=w*B+v*O+T*G+M*de,this}determinant(){let t=this.elements,r=t[0],n=t[4],i=t[8],o=t[12],a=t[1],s=t[5],l=t[9],c=t[13],d=t[2],u=t[6],p=t[10],g=t[14],f=t[3],y=t[7],E=t[11],_=t[15];return f*(+o*l*u-i*c*u-o*s*p+n*c*p+i*s*g-n*l*g)+y*(+r*l*g-r*c*p+o*a*p-i*a*g+i*c*d-o*l*d)+E*(+r*c*u-r*s*g-o*a*u+n*a*g+o*s*d-n*c*d)+_*(-i*s*d-r*l*u+r*s*p+i*a*u-n*a*p+n*l*d)}invert(){let t=this.elements,r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],d=t[8],u=t[9],p=t[10],g=t[11],f=t[12],y=t[13],E=t[14],_=t[15],w=u*E*c-y*p*c+y*l*g-s*E*g-u*l*_+s*p*_,v=f*p*c-d*E*c-f*l*g+a*E*g+d*l*_-a*p*_,T=d*y*c-f*u*c+f*s*g-a*y*g-d*s*_+a*u*_,M=f*u*l-d*y*l-f*s*p+a*y*p+d*s*E-a*u*E,C=r*w+n*v+i*T+o*M;if(C===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let P=1/C;return t[0]=w*P,t[1]=(y*p*o-u*E*o-y*i*g+n*E*g+u*i*_-n*p*_)*P,t[2]=(s*E*o-y*l*o+y*i*c-n*E*c-s*i*_+n*l*_)*P,t[3]=(u*l*o-s*p*o-u*i*c+n*p*c+s*i*g-n*l*g)*P,t[4]=v*P,t[5]=(d*E*o-f*p*o+f*i*g-r*E*g-d*i*_+r*p*_)*P,t[6]=(f*l*o-a*E*o-f*i*c+r*E*c+a*i*_-r*l*_)*P,t[7]=(a*p*o-d*l*o+d*i*c-r*p*c-a*i*g+r*l*g)*P,t[8]=T*P,t[9]=(f*u*o-d*y*o-f*n*g+r*y*g+d*n*_-r*u*_)*P,t[10]=(a*y*o-f*s*o+f*n*c-r*y*c-a*n*_+r*s*_)*P,t[11]=(d*s*o-a*u*o-d*n*c+r*u*c+a*n*g-r*s*g)*P,t[12]=M*P,t[13]=(d*y*i-f*u*i+f*n*p-r*y*p-d*n*E+r*u*E)*P,t[14]=(f*s*i-a*y*i-f*n*l+r*y*l+a*n*E-r*s*E)*P,t[15]=(a*u*i-d*s*i+d*n*l-r*u*l-a*n*p+r*s*p)*P,this}getMaxScaleOnAxis(){let t=this.elements,r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(r,n,i))}makeTranslation(t,r,n){return this.set(1,0,0,t,0,1,0,r,0,0,1,n,0,0,0,1),this}makeRotationX(t){let r=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,r,-n,0,0,n,r,0,0,0,0,1),this}makeRotationAxis(t,r){let n=Math.cos(r),i=Math.sin(r),o=1-n,a=t.x,s=t.y,l=t.z,c=o*a,d=o*s;return this.set(c*a+n,c*s-i*l,c*l+i*s,0,c*s+i*l,d*s+n,d*l-i*a,0,c*l-i*s,d*l+i*a,o*l*l+n,0,0,0,0,1),this}makeScale(t,r,n){return this.set(t,0,0,0,0,r,0,0,0,0,n,0,0,0,0,1),this}compose(t,r,n){let i=this.elements,o=r._x,a=r._y,s=r._z,l=r._w,c=o+o,d=a+a,u=s+s,p=o*c,g=o*d,f=o*u,y=a*d,E=a*u,_=s*u,w=l*c,v=l*d,T=l*u,M=n.x,C=n.y,P=n.z;return i[0]=(1-(y+_))*M,i[1]=(g+T)*M,i[2]=(f-v)*M,i[3]=0,i[4]=(g-T)*C,i[5]=(1-(p+_))*C,i[6]=(E+w)*C,i[7]=0,i[8]=(f+v)*P,i[9]=(E-w)*P,i[10]=(1-(p+y))*P,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}makePerspective(t,r,n,i,o,a,s=Jl){let l=this.elements,c=2*o/(r-t),d=2*o/(n-i),u=(r+t)/(r-t),p=(n+i)/(n-i),g,f;if(s===Jl)g=-(a+o)/(a-o),f=-2*a*o/(a-o);else if(s===Jv)g=-a/(a-o),f=-a*o/(a-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);return l[0]=c,l[4]=0,l[8]=u,l[12]=0,l[1]=0,l[5]=d,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=g,l[14]=f,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(t,r,n,i,o,a,s=Jl){let l=this.elements,c=1/(r-t),d=1/(n-i),u=1/(a-o),p=(r+t)*c,g=(n+i)*d,f,y;if(s===Jl)f=(a+o)*u,y=-2*u;else if(s===Jv)f=o*u,y=-1*u;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-p,l[1]=0,l[5]=2*d,l[9]=0,l[13]=-g,l[2]=0,l[6]=0,l[10]=y,l[14]=-f,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(t){let r=this.elements,n=t.elements;for(let i=0;i<16;i++)if(r[i]!==n[i])return!1;return!0}fromArray(t,r=0){for(let n=0;n<16;n++)this.elements[n]=t[n+r];return this}toArray(t,r=0){let n=this.elements;return t[r]=n[0],t[r+1]=n[1],t[r+2]=n[2],t[r+3]=n[3],t[r+4]=n[4],t[r+5]=n[5],t[r+6]=n[6],t[r+7]=n[7],t[r+8]=n[8],t[r+9]=n[9],t[r+10]=n[10],t[r+11]=n[11],t[r+12]=n[12],t[r+13]=n[13],t[r+14]=n[14],t[r+15]=n[15],t}},ZV=new ye,cae=new ye(0,0,0),dae=new ye(1,1,1),mh=new ye,Fk=new ye,fl=new ye,_W=new Nt,Fs=class{constructor(e=0,t=0,r=0,n="XYZ"){this._x=e,this._y=t,this._z=r,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,n=this._order){return this._x=e,this._y=t,this._z=r,this._order=n,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){let n=e.elements,i=n[0],o=n[4],a=n[8],s=n[1],l=n[5],c=n[9],d=n[2],u=n[6],p=n[10];switch(t){case"XYZ":this._y=Math.asin(sm(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,p),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-sm(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,p),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-d,i),this._z=0);break;case"ZYX":this._y=Math.asin(-sm(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(u,p),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-o,l));break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return _W.makeRotationFromQuaternion(e),this.setFromRotationMatrix(_W,t,r)}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}},Po=class Sl{constructor(t,r,n,i,o,a,s,l,c){this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,r,n,i,o,a,s,l,c)}set(t,r,n,i,o,a,s,l,c){let d=this.elements;return d[0]=t,d[1]=i,d[2]=s,d[3]=r,d[4]=o,d[5]=l,d[6]=n,d[7]=a,d[8]=c,this}copy(t){let r=this.elements,n=t.elements;return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],this}setFromMatrix4(t){let r=t.elements;return this.set(r[0],r[4],r[8],r[1],r[5],r[9],r[2],r[6],r[10]),this}multiply(t){return this.multiplyMatrices(this,t)}multiplyMatrices(t,r){let n=t.elements,i=r.elements,o=this.elements,a=n[0],s=n[3],l=n[6],c=n[1],d=n[4],u=n[7],p=n[2],g=n[5],f=n[8],y=i[0],E=i[3],_=i[6],w=i[1],v=i[4],T=i[7],M=i[2],C=i[5],P=i[8];return o[0]=a*y+s*w+l*M,o[3]=a*E+s*v+l*C,o[6]=a*_+s*T+l*P,o[1]=c*y+d*w+u*M,o[4]=c*E+d*v+u*C,o[7]=c*_+d*T+u*P,o[2]=p*y+g*w+f*M,o[5]=p*E+g*v+f*C,o[8]=p*_+g*T+f*P,this}invert(){let t=this.elements,r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],d=t[8],u=d*a-s*c,p=s*l-d*o,g=c*o-a*l,f=r*u+n*p+i*g;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);let y=1/f;return t[0]=u*y,t[1]=(i*c-d*n)*y,t[2]=(s*n-i*a)*y,t[3]=p*y,t[4]=(d*r-i*l)*y,t[5]=(i*o-s*r)*y,t[6]=g*y,t[7]=(n*l-c*r)*y,t[8]=(a*r-n*o)*y,this}transpose(){let t,r=this.elements;return t=r[1],r[1]=r[3],r[3]=t,t=r[2],r[2]=r[6],r[6]=t,t=r[5],r[5]=r[7],r[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}equals(t){let r=this.elements,n=t.elements;for(let i=0;i<9;i++)if(r[i]!==n[i])return!1;return!0}toArray(t,r=0){let n=this.elements;return t[r]=n[0],t[r+1]=n[1],t[r+2]=n[2],t[r+3]=n[3],t[r+4]=n[4],t[r+5]=n[5],t[r+6]=n[6],t[r+7]=n[7],t[r+8]=n[8],t}clone(){let t=new Sl,r=this.elements;for(let n=0;n<9;n++)t.elements[n]=r[n];return t}},Ql=class kl{constructor(t=0,r=0,n=0,i=1){this.isQuaternion=!0,this._x=t,this._y=r,this._z=n,this._w=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,r,n,i){return this._x=t,this._y=r,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new kl(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,r){let n=t._x,i=t._y,o=t._z,a=t._order,s=Math.cos,l=Math.sin,c=s(n/2),d=s(i/2),u=s(o/2),p=l(n/2),g=l(i/2),f=l(o/2);switch(a){case"XYZ":this._x=p*d*u+c*g*f,this._y=c*g*u-p*d*f,this._z=c*d*f+p*g*u,this._w=c*d*u-p*g*f;break;case"YXZ":this._x=p*d*u+c*g*f,this._y=c*g*u-p*d*f,this._z=c*d*f-p*g*u,this._w=c*d*u+p*g*f;break;case"ZYX":this._x=p*d*u-c*g*f,this._y=c*g*u+p*d*f,this._z=c*d*f-p*g*u,this._w=c*d*u+p*g*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return r!==!1&&this._onChangeCallback(),this}setFromRotationMatrix(t){let r=t.elements,n=r[0],i=r[4],o=r[8],a=r[1],s=r[5],l=r[9],c=r[2],d=r[6],u=r[10],p=n+s+u;if(p>0){let g=.5/Math.sqrt(p+1);this._w=.25/g,this._x=(d-l)*g,this._y=(o-c)*g,this._z=(a-i)*g}else if(n>s&&n>u){let g=2*Math.sqrt(1+n-s-u);this._w=(d-l)/g,this._x=.25*g,this._y=(i+a)/g,this._z=(o+c)/g}else if(s>u){let g=2*Math.sqrt(1+s-n-u);this._w=(o-c)/g,this._x=(i+a)/g,this._y=.25*g,this._z=(l+d)/g}else{let g=2*Math.sqrt(1+u-n-s);this._w=(a-i)/g,this._x=(o+c)/g,this._y=(l+d)/g,this._z=.25*g}return this._onChangeCallback(),this}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,r){let n=t._x,i=t._y,o=t._z,a=t._w,s=r._x,l=r._y,c=r._z,d=r._w;return this._x=n*d+a*s+i*c-o*l,this._y=i*d+a*l+o*s-n*c,this._z=o*d+a*c+n*l-i*s,this._w=a*d-n*s-i*l-o*c,this._onChangeCallback(),this}slerp(t,r){if(r===0)return this;if(r===1)return this.copy(t);let n=this._x,i=this._y,o=this._z,a=this._w,s=a*t._w+n*t._x+i*t._y+o*t._z;if(s<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),s>=1)return this._w=a,this._x=n,this._y=i,this._z=o,this;let l=1-s*s;if(l<=Number.EPSILON){let g=1-r;return this._w=g*a+r*this._w,this._x=g*n+r*this._x,this._y=g*i+r*this._y,this._z=g*o+r*this._z,this.normalize(),this._onChangeCallback(),this}let c=Math.sqrt(l),d=Math.atan2(c,s),u=Math.sin((1-r)*d)/c,p=Math.sin(r*d)/c;return this._w=a*u+this._w*p,this._x=n*u+this._x*p,this._y=i*u+this._y*p,this._z=o*u+this._z*p,this._onChangeCallback(),this}toArray(t,r=0){return t[r]=this._x,t[r+1]=this._y,t[r+2]=this._z,t[r+3]=this._w,t}fromBufferAttribute(t,r){return this._x=t.getX(r),this._y=t.getY(r),this._z=t.getZ(r),this._w=t.getW(r),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}},hs=new ye,ha=class{constructor(e,t,r=!1){if(this.isBufferAttribute=!0,Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=kW,this.updateRange={offset:0,count:-1},this.gpuType=Xl,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)hs.fromBufferAttribute(this,t),hs.applyMatrix4(e),this.setXYZ(t,hs.x,hs.y,hs.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)hs.fromBufferAttribute(this,t),hs.applyNormalMatrix(e),this.setXYZ(t,hs.x,hs.y,hs.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)hs.fromBufferAttribute(this,t),hs.transformDirection(e),this.setXYZ(t,hs.x,hs.y,hs.z);return this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Kv(t,this.array)),t}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Kv(t,this.array)),t}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Kv(t,this.array)),t}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Kv(t,this.array)),t}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=vy(t,this.array),r=vy(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,n){return e*=this.itemSize,this.normalized&&(t=vy(t,this.array),r=vy(r,this.array),n=vy(n,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this}},fh=class extends ha{constructor(e,t,r){super(new Uint16Array(e),t,r)}},bh=class extends ha{constructor(e,t,r){super(new Uint32Array(e),t,r)}},Bo=class extends ha{constructor(e,t,r){super(new Float32Array(e),t,r)}},Ns=class{hasEventListener(e,t){if(this._listeners===void 0)return!1;let r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let n=r.indexOf(t);n!==-1&&r.splice(n,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let r=t.slice(0);for(let n=0,i=r.length;n<i;n++)r[n].call(this,e);e.target=null}}},Ty=class{constructor(){this.mask=1}enable(e){this.mask|=1<<e|0}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}},pae=0,IW=new ye,AW=new Ql,Qv=new Nt,eO=new ye,tO=new ye,uae=new ye(1,0,0),hae=new ye(0,1,0),gae=new ye(0,0,1),mae={type:"added"},fae={type:"removed"},yh=class zi extends Ns{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:pae++}),this.uuid=Yl(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=zi.DEFAULT_UP.clone();let t=new ye,r=new Fs,n=new Ql,i=new ye(1,1,1);function o(){n.setFromEuler(r,!1)}function a(){r.setFromQuaternion(n,void 0,!1)}r._onChange(o),n._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Nt},normalMatrix:{value:new Po}}),this.matrix=new Nt,this.matrixWorld=new Nt,this.dcgModelMatrix=new Nt,this.matrixAutoUpdate=zi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=zi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Ty,this.visible=!0,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}setPickingColorArray(t){this.pickingColorArray=t;let{repeatColorCounts:r,colors:n}=t,i=[];for(let o=0;o<r.length;o++){let a=n[o],s=r[o];for(let l=0;l<s;l++)i.push(...a)}this.geometry&&this.geometry.setAttribute("vertexPickingColor",new ha(new Float32Array(i),4))}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}translateOnAxis(t,r){return IW.copy(t).applyQuaternion(this.quaternion),this.position.add(IW.multiplyScalar(r)),this}translateX(t){return this.translateOnAxis(uae,t)}translateY(t){return this.translateOnAxis(hae,t)}translateZ(t){return this.translateOnAxis(gae,t)}lookAt(t){eO.copy(t);let r=this.parent;this.updateWorldMatrix(!0,!1),tO.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Qv.lookAt(tO,eO,this.up):Qv.lookAt(eO,tO,this.up),this.quaternion.setFromRotationMatrix(Qv),r&&(Qv.extractRotation(r.matrixWorld),AW.setFromRotationMatrix(Qv),this.quaternion.premultiply(AW.invert()))}add(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(mae)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}let r=this.children.indexOf(t);return r!==-1&&(t.parent=null,this.children.splice(r,1),t.dispatchEvent(fae)),this}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,r){if(this[t]===r)return this;for(let n=0,i=this.children.length;n<i;n++){let o=this.children[n].getObjectByProperty(t,r);if(o!==void 0)return o}}getObjectsByProperty(t,r){let n=[];this[t]===r&&n.push(this);for(let i=0,o=this.children.length;i<o;i++){let a=this.children[i].getObjectsByProperty(t,r);a.length>0&&(n=n.concat(a))}return n}traverse(t){t(this);let r=this.children;for(let n=0,i=r.length;n<i;n++)r[n].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);let r=this.children;for(let n=0,i=r.length;n<i;n++)r[n].traverseVisible(t)}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);let r=this.children;for(let n=0,i=r.length;n<i;n++){let o=r[n];(o.matrixWorldAutoUpdate===!0||t===!0)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,r){let n=this.parent;if(t===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),r===!0){let i=this.children;for(let o=0,a=i.length;o<a;o++){let s=i[o];s.matrixWorldAutoUpdate===!0&&s.updateWorldMatrix(!1,!0)}}}};yh.DEFAULT_UP=new ye(0,1,0),yh.DEFAULT_MATRIX_AUTO_UPDATE=!0,yh.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var Ii=yh,Dy=class extends Ii{constructor(){super(),this.isCamera=!0,this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Nt,this.projectionMatrix=new Nt,this.projectionMatrixInverse=new Nt,this.coordinateSystem=Jl}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},Xp=class extends Dy{constructor(e=-1,t=1,r=1,n=-1,i=.1,o=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=n,this.near=i,this.far=o,this.updateProjectionMatrix()}setViewOffset(e,t,r,n,i,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=r-e,o=r+e,a=n+t,s=n-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=l*this.view.offsetX,o=i+l*this.view.width,a-=c*this.view.offsetY,s=a-c*this.view.height}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},xh=class extends Dy{constructor(e=50,t=1,r=.1,n=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=xV*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(xk*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return xV*2*Math.atan(Math.tan(xk*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,n,i,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(xk*.5*this.fov)/this.zoom,r=2*t,n=this.aspect*r,i=-.5*n,o=this.view;if(o!==null&&o.enabled){let s=o.fullWidth,l=o.fullHeight;i+=o.offsetX*n/s,t-=o.offsetY*r/l,n*=o.width/s,r*=o.height/l}let a=this.filmOffset;a!==0&&(i+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},dm=class{constructor(e=new ye(1/0,1/0,1/0),t=new ye(-1/0,-1/0,-1/0)){this.min=e,this.max=t}setFromBufferAttribute(e){this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0;for(let t=0,r=e.count;t<r;t++)rO.fromBufferAttribute(e,t),this.min.min(rO),this.max.max(rO);return this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}},rO=new ye,ky=new ye,oO=new ye,Jp=class{constructor(e=new ye,t=-1){this.center=e,this.radius=t}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(oO.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(ky.copy(e.center).add(oO)),this.expandByPoint(ky.copy(e.center).sub(oO))),this)}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;ky.subVectors(e,this.center);let t=ky.lengthSq();if(t>this.radius*this.radius){let r=Math.sqrt(t),n=(r-this.radius)*.5;ky.multiplyScalar(n/r),this.center.add(ky),this.radius+=n}return this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}};function Nk(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}function Bk(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function bae(e){let t=e.getError();switch(t){case e.NO_ERROR:return"NO_ERROR";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";default:return typeof t=="number"?t.toString(16):t}}function wt(e,t,r){if(e==null){let n=`Expected ${t} to be defined and not null.`;throw r&&(n+=` GL Error: ${bae(r)}.`),new Error(n)}}var yae=0,_y=new Nt,MW=new dm,pm=new ye,La=class extends Ns{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:yae++}),this.uuid=Yl(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.groups=[],this.boundingSphere=null,this.userData={}}setIndex(e){return Array.isArray(e)?this.index=new(Nk(e)?bh:fh)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let r=this.attributes.normal;if(r!==void 0){let i=new Po().getNormalMatrix(e);r.applyNormalMatrix(i),r.needsUpdate=!0}let n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(e),n.needsUpdate=!0),this.boundingSphere!==null&&this.computeBoundingSphere(),this}rotateX(e){return _y.makeRotationX(e),this.applyMatrix4(_y),this}translate(e,t,r){return _y.makeTranslation(e,t,r),this.applyMatrix4(_y),this}scale(e,t,r){return _y.makeScale(e,t,r),this.applyMatrix4(_y),this}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Jp);let e=this.attributes.position;if(e){let t=this.boundingSphere.center;MW.setFromBufferAttribute(e),MW.getCenter(t);let r=0;for(let n=0,i=e.count;n<i;n++)pm.fromBufferAttribute(e,n),r=Math.max(r,t.distanceToSquared(pm));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new ha(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let u=0,p=r.count;u<p;u++)r.setXYZ(u,0,0,0);let n=new ye,i=new ye,o=new ye,a=new ye,s=new ye,l=new ye,c=new ye,d=new ye;if(e)for(let u=0,p=e.count;u<p;u+=3){let g=e.getX(u+0),f=e.getX(u+1),y=e.getX(u+2);n.fromBufferAttribute(t,g),i.fromBufferAttribute(t,f),o.fromBufferAttribute(t,y),c.subVectors(o,i),d.subVectors(n,i),c.cross(d),a.fromBufferAttribute(r,g),s.fromBufferAttribute(r,f),l.fromBufferAttribute(r,y),a.add(c),s.add(c),l.add(c),r.setXYZ(g,a.x,a.y,a.z),r.setXYZ(f,s.x,s.y,s.z),r.setXYZ(y,l.x,l.y,l.z)}else for(let u=0,p=t.count;u<p;u+=3)n.fromBufferAttribute(t,u+0),i.fromBufferAttribute(t,u+1),o.fromBufferAttribute(t,u+2),c.subVectors(o,i),d.subVectors(n,i),c.cross(d),r.setXYZ(u+0,c.x,c.y,c.z),r.setXYZ(u+1,c.x,c.y,c.z),r.setXYZ(u+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)pm.fromBufferAttribute(e,t),pm.normalize(),e.setXYZ(t,pm.x,pm.y,pm.z)}dispose(){this.dispatchEvent({type:"dispose"})}},pn=class Tl{constructor(t=0,r=0,n=0,i=1){this.x=t,this.y=r,this.z=n,this.w=i}set(t,r,n,i){return this.x=t,this.y=r,this.z=n,this.w=i,this}clone(){return new Tl(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,r=0){return this.x=t[r],this.y=t[r+1],this.z=t[r+2],this.w=t[r+3],this}toArray(t,r=0){return t[r]=this.x,t[r+1]=this.y,t[r+2]=this.z,t[r+3]=this.w,t}fromBufferAttribute(t,r){return this.x=t.getX(r),this.y=t.getY(r),this.z=t.getZ(r),this.w=t.getW(r),this}},Tt=class Cl{constructor(t=0,r=0){this.x=t,this.y=r}set(t,r){return this.x=t,this.y=r,this}clone(){return new Cl(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScaledVector(t,r){return this.x+=t.x*r,this.y+=t.y*r,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subVectors(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}applyMatrix3(t){let r=this.x,n=this.y,i=t.elements;return this.x=i[0]*r+i[3]*n+i[6],this.y=i[1]*r+i[4]*n+i[7],this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){return this.multiplyScalar(1/(this.length()||1))}distanceTo(t){let r=this.x-t.x,n=this.y-t.y,i=r*r+n*n;return Math.sqrt(i)}equals(t){return t.x===this.x&&t.y===this.y}toArray(t,r=0){return t[r]=this.x,t[r+1]=this.y,t}fromBufferAttribute(t,r){return this.x=t.getX(r),this.y=t.getY(r),this}},xae=0,Uk=class{constructor(e){this.data=e,this.isSource=!0,this.uuid=Yl(),this.version=0,Object.defineProperty(this,"id",{value:xae++})}set needsUpdate(e){e===!0&&this.version++}},Bd=class{constructor(e,t,r){this.width=e,this.height=t,this.depth=r}},wae=0,Iy=class Xo extends Ns{constructor(t,r=Xo.DEFAULT_MAPPING,n=cm,i=cm,o=ml,a=Xv,s=Nd,l=Vn,c=Xo.DEFAULT_ANISOTROPY,d=Ey){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:wae++}),this.uuid=Yl(),this.name="",this.source=new Uk(t),this.mipmaps=[],this.mapping=r,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=o,this.minFilter=a,this.anisotropy=c,this.format=s,this.internalFormat=null,this.type=l,this.offset=new Tt(0,0),this.repeat=new Tt(1,1),this.center=new Tt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Po,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=d,this.userData={},this.version=0,this.onUpdate=void 0,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==TV)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case jv:t.x=t.x-Math.floor(t.x);break;case cm:t.x=t.x<0?0:1;break;case Yv:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case jv:t.y=t.y-Math.floor(t.y);break;case cm:t.y=t.y<0?0:1;break;case Yv:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}};Iy.DEFAULT_ANISOTROPY=1,Iy.DEFAULT_MAPPING=TV;var Bs=Iy,zk=class extends Ns{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new pn(0,0,e,t),this.scissorTest=!1,this.viewport=new pn(0,0,e,t);let n=new Bd(e,t,1);this.texture=new Bs(n,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:ml,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null,this.samples=r.samples!==void 0?r.samples:0}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;let n=this.texture.image;n.width=e,n.height=t,n.depth=r,this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}dispose(){this.dispatchEvent({type:"dispose"})}},wh=class{constructor(){this.arcLengthDivisions=200,this.needsUpdate=!1}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,n=this.getPoint(0),i=0;t.push(0);for(let o=1;o<=e;o++)r=this.getPoint(o/e),i+=r.distanceTo(n),t.push(i),n=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let r=this.getLengths(),n=0,i=r.length,o;t?o=t:o=e*r[i-1];let a=0,s=i-1,l;for(;a<=s;)if(n=Math.floor(a+(s-a)/2),l=r[n]-o,l<0)a=n+1;else if(l>0)s=n-1;else{s=n;break}if(n=s,r[n]===o)return n/(i-1);let c=r[n],d=r[n+1]-c,u=(o-c)/d;return(n+u)/(i-1)}getTangent(e,t){let r=e-1e-4,n=e+1e-4;r<0&&(r=0),n>1&&(n=1);let i=this.getPoint(r),o=this.getPoint(n),a=t||new Tt;return a.copy(o).sub(i).normalize(),a}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){let r=new ye,n=[],i=[],o=[],a=new ye,s=new Nt;for(let u=0;u<=e;u++){let p=u/e,g=this.getTangentAt(p,new Tt);n[u]=new ye(g.x,g.y,0)}i[0]=new ye,o[0]=new ye;let l=Number.MAX_VALUE,c=Math.abs(n[0].x),d=Math.abs(n[0].y);c<=l&&(l=c,r.set(1,0,0)),d<=l&&(l=d,r.set(0,1,0)),a.crossVectors(n[0],r).normalize(),i[0].crossVectors(n[0],a),o[0].crossVectors(n[0],i[0]);for(let u=1;u<=e;u++){if(i[u]=i[u-1].clone(),o[u]=o[u-1].clone(),a.crossVectors(n[u-1],n[u]),a.length()>Number.EPSILON){a.normalize();let p=Math.acos(sm(n[u-1].dot(n[u]),-1,1));i[u].applyMatrix4(s.makeRotationAxis(a,p))}o[u].crossVectors(n[u],i[u])}if(t===!0){let u=Math.acos(sm(i[0].dot(i[e]),-1,1));u/=e,n[0].dot(a.crossVectors(i[0],i[e]))>0&&(u=-u);for(let p=1;p<=e;p++)i[p].applyMatrix4(s.makeRotationAxis(n[p],u*p)),o[p].crossVectors(n[p],i[p])}return{tangents:n,normals:i,binormals:o}}},um=class extends wh{constructor(e=new Tt,t=new Tt){super(),this.v1=e,this.v2=t}getPoint(e,t=new Tt){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Tt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}},qk=class extends wh{constructor(){super(...arguments),this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new um(t,e))}getPoint(e,t){let r=e*this.getLength(),n=this.getCurveLengths(),i=0;for(;i<n.length;){if(n[i]>=r){let o=n[i]-r,a=this.curves[i],s=a.getLength(),l=s===0?0:1-o/s;return a.getPointAt(l,t)}i++}}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=void 0,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,n=this.curves.length;r<n;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],r;for(let n=0,i=this.curves;n<i.length;n++){let o=i[n],a=o instanceof um?1:e,s=o.getPoints(a);for(let l=0;l<s.length;l++){let c=s[l];r&&r.equals(c)||(t.push(c),r=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}};function vae(e,t){let r=1-e;return r*r*t}function Cae(e,t){return 2*(1-e)*e*t}function Sae(e,t){return e*e*t}function iO(e,t,r,n){return vae(e,t)+Cae(e,r)+Sae(e,n)}var Hk=class extends wh{constructor(e=new Tt,t=new Tt,r=new Tt){super(),this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Tt){let r=t,n=this.v0,i=this.v1,o=this.v2;return r.set(iO(e,n.x,i.x,o.x),iO(e,n.y,i.y,o.y)),r}},hm=class extends qk{constructor(e){super(),this.currentPoint=new Tt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new um(this.currentPoint.clone(),new Tt(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,n){let i=new Hk(this.currentPoint.clone(),new Tt(e,t),new Tt(r,n));return this.curves.push(i),this.currentPoint.set(r,n),this}},Ay=class extends hm{constructor(){super(...arguments),this.uuid=Yl(),this.holes=[]}getPointsHoles(e){let t=[];for(let r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}},vt=class Jo{constructor(t){if(this.isColor=!0,t instanceof Jo)this.copy(t);else if(typeof t=="number")this.setHex(t);else if(typeof t=="string"){let{r,g:n,b:i}=__dcg_shared_module_exports__.Nd(t);this.setRGB(r/255,n/255,i/255)}else this.r=1,this.g=1,this.b=1}setHex(t){return t=Math.floor(t),this.setRGB((t>>16&255)/255,(t>>8&255)/255,(t&255)/255),this}setRGB(t,r,n){return this.r=__dcg_shared_module_exports__.Od(t),this.g=__dcg_shared_module_exports__.Od(r),this.b=__dcg_shared_module_exports__.Od(n),this}clone(){let t=new Jo;return t.r=this.r,t.g=this.g,t.b=this.b,t}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}getRGB(t,r){r===Lo?(t.r=__dcg_shared_module_exports__.Pd(this.r),t.g=__dcg_shared_module_exports__.Pd(this.g),t.b=__dcg_shared_module_exports__.Pd(this.b)):(t.r=this.r,t.g=this.g,t.b=this.b)}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,r=0){return this.r=t[r],this.g=t[r+1],this.b=t[r+2],this}toArray(t=[],r=0){return t[r]=this.r,t[r+1]=this.g,t[r+2]=this.b,t}fromBufferAttribute(t,r){return this.r=t.getX(r),this.g=t.getY(r),this.b=t.getZ(r),this}},LW={triangulate:function(e,t,r=2){let n=t&&t.length,i=n?t[0]*r:e.length,o=Eae(e,0,i,r,!0),a=[];if(!o||o.next===o.prev)return a;let s,l,c,d,u,p,g;if(n)throw new Error("EarCut does not support holes");if(e.length>80*r){s=c=e[0],l=d=e[1];for(let f=r;f<i;f+=r)u=e[f],p=e[f+1],u<s&&(s=u),p<l&&(l=p),u>c&&(c=u),p>d&&(d=p);g=Math.max(c-s,d-l),g=g!==0?32767/g:0}return Tae(o,a,r,s,l,g),a}};function Eae(e,t,r,n,i){let o,a;if(i===Mae(e,t,r,n)>0)for(o=t;o<r;o+=n)a=GW(o,e[o],e[o+1],a);else for(o=r-n;o>=t;o-=n)a=GW(o,e[o],e[o+1],a);return a&&Aae(a,a.next)&&(PW(a),a=a.next),a}function Tae(e,t,r,n,i,o,a){if(!e)return;o&&_ae(e,n,i,o);let s=e,l,c;for(;e.prev!==e.next;){if(l=e.prev,c=e.next,o?kae(e,n,i,o):Dae(e)){t.push(l.i/r|0),t.push(e.i/r|0),t.push(c.i/r|0),PW(e),e=c.next,s=c.next;continue}if(e=c,e===s)throw new Error("EarCut does not expect ear === stop")}}function Dae(e){let t=e.prev,r=e,n=e.next;if(gm(t,r,n)>=0)return!1;let i=t.x,o=r.x,a=n.x,s=t.y,l=r.y,c=n.y,d=i<o?i<a?i:a:o<a?o:a,u=s<l?s<c?s:c:l<c?l:c,p=i>o?i>a?i:a:o>a?o:a,g=s>l?s>c?s:c:l>c?l:c,f=n.next;for(;f!==t;){if(f.x>=d&&f.x<=p&&f.y>=u&&f.y<=g&&Zv(i,s,o,l,a,c,f.x,f.y)&&gm(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function kae(e,t,r,n){let i=e.prev,o=e,a=e.next;if(gm(i,o,a)>=0)return!1;let s=i.x,l=o.x,c=a.x,d=i.y,u=o.y,p=a.y,g=s<l?s<c?s:c:l<c?l:c,f=d<u?d<p?d:p:u<p?u:p,y=s>l?s>c?s:c:l>c?l:c,E=d>u?d>p?d:p:u>p?u:p,_=nO(g,f,t,r,n),w=nO(y,E,t,r,n),v=e.prevZ,T=e.nextZ;for(;v&&v.z>=_&&T&&T.z<=w;){if(v.x>=g&&v.x<=y&&v.y>=f&&v.y<=E&&v!==i&&v!==a&&Zv(s,d,l,u,c,p,v.x,v.y)&&gm(v.prev,v,v.next)>=0||(v=v.prevZ,T.x>=g&&T.x<=y&&T.y>=f&&T.y<=E&&T!==i&&T!==a&&Zv(s,d,l,u,c,p,T.x,T.y)&&gm(T.prev,T,T.next)>=0))return!1;T=T.nextZ}for(;v&&v.z>=_;){if(v.x>=g&&v.x<=y&&v.y>=f&&v.y<=E&&v!==i&&v!==a&&Zv(s,d,l,u,c,p,v.x,v.y)&&gm(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;T&&T.z<=w;){if(T.x>=g&&T.x<=y&&T.y>=f&&T.y<=E&&T!==i&&T!==a&&Zv(s,d,l,u,c,p,T.x,T.y)&&gm(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}function _ae(e,t,r,n){let i=e;do i.z===0&&(i.z=nO(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=void 0,i.prevZ=void 0,Iae(i)}function Iae(e){let t,r,n,i,o,a,s,l,c=1;do{for(r=e,e=void 0,o=void 0,a=0;r;){for(a++,n=r,s=0,t=0;t<c&&(s++,n=n.nextZ,!!n);t++);for(l=c;s>0||l>0&&n;)s!==0&&(l===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,l--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;r=n}o.nextZ=void 0,c*=2}while(a>1);return e}function nO(e,t,r,n,i){return e=(e-r)*i|0,t=(t-n)*i|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function Zv(e,t,r,n,i,o,a,s){return(i-a)*(t-s)>=(e-a)*(o-s)&&(e-a)*(n-s)>=(r-a)*(t-s)&&(r-a)*(o-s)>=(i-a)*(n-s)}function gm(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Aae(e,t){return e.x===t.x&&e.y===t.y}function GW(e,t,r,n){let i=new aO(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function PW(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}var aO=class{constructor(e,t,r){this.i=e,this.x=t,this.y=r,this.z=0,this.prevZ=void 0,this.nextZ=void 0,this.steiner=!1}};function Mae(e,t,r,n){let i=0;for(let o=t,a=r-n;o<r;o+=n)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}var vh=class Dl{static area(t){let r=t.length,n=0;for(let i=r-1,o=0;o<r;i=o++)n+=t[i].x*t[o].y-t[o].x*t[i].y;return n*.5}static isClockWise(t){return Dl.area(t)<0}static triangulateShape(t,r){let n=[],i=[],o=[];VW(t),OW(n,t);let a=t.length;r.forEach(VW);for(let l=0;l<r.length;l++)i.push(a),a+=r[l].length,OW(n,r[l]);let s=LW.triangulate(n,i);for(let l=0;l<s.length;l+=3)o.push(s.slice(l,l+3));return o}};function VW(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function OW(e,t){for(let r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}var Kk=class{constructor(){this.color=new vt,this.subPaths=[],this.currentPath=new hm}moveTo(e,t){return this.currentPath=new hm,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,n){return this.currentPath.quadraticCurveTo(e,t,r,n),this}toShapes(e=!1){function t(E){let _=[];for(let w=0,v=E.length;w<v;w++){let T=E[w],M=new Ay;M.curves=T.curves,_.push(M)}return _}function r(E,_){let w=_.length,v=!1;for(let T=w-1,M=0;M<w;T=M++){let C=_[T],P=_[M],F=P.x-C.x,B=P.y-C.y;if(Math.abs(B)>Number.EPSILON){if(B<0&&(C=_[M],F=-F,P=_[T],B=-B),E.y<C.y||E.y>P.y)continue;if(E.y===C.y){if(E.x===C.x)return!0}else{let x=B*(E.x-C.x)-F*(E.y-C.y);if(x===0)return!0;if(x<0)continue;v=!v}}else{if(E.y!==C.y)continue;if(P.x<=E.x&&E.x<=C.x||C.x<=E.x&&E.x<=P.x)return!0}}return v}let n=vh.isClockWise,i=this.subPaths;if(i.length===0)return[];let o,a,s,l=[];if(i.length===1)return a=i[0],s=new Ay,s.curves=a.curves,l.push(s),l;let c=!n(i[0].getPoints());c=e?!c:c;let d=[],u=[],p=[],g=0,f;p[g]=[];for(let E=0,_=i.length;E<_;E++)if(a=i[E],f=a.getPoints(),o=n(f),o=e?!o:o,o){!c&&u[g]&&g++;let w={s:new Ay,p:f};w.s.curves=a.curves,u[g]=w,c&&g++,p[g]=[]}else p[g].push({h:a,p:f[0]});if(!u[0])return t(i);if(u.length>1){let E=!1,_=0;for(let w=0,v=u.length;w<v;w++)d[w]=[];for(let w=0,v=u.length;w<v;w++){let T=p[w];for(let M=0;M<T.length;M++){let C=T[M],P=!0;for(let F=0;F<u.length;F++)r(C.p,u[F].p)&&(w!==F&&_++,P?(P=!1,d[F].push(C)):E=!0);P&&d[w].push(C)}}_>0&&E===!1&&(p=d)}let y;for(let E=0,_=u.length;E<_;E++){s=u[E].s,l.push(s),y=p[E];for(let w=0,v=y.length;w<v;w++)s.holes.push(y[w].h)}return l}},Ud=class extends La{constructor(e=1,t=1,r=1,n=32,i=1,o=!1,a=0,s=Math.PI*2){super(),this.type="CylinderGeometry";let l=this;n=Math.floor(n),i=Math.floor(i);let c=[],d=[],u=[],p=[],g=0,f=[],y=r/2,E=0;_(),o===!1&&(e>0&&w(!0),t>0&&w(!1)),this.setIndex(c),this.setAttribute("position",new Bo(d,3)),this.setAttribute("normal",new Bo(u,3)),this.setAttribute("uv",new Bo(p,2));function _(){let v=new ye,T=new ye,M=0,C=(t-e)/r;for(let P=0;P<=i;P++){let F=[],B=P/i,x=B*(t-e)+e;for(let L=0;L<=n;L++){let N=L/n,O=N*s+a,z=Math.sin(O),V=Math.cos(O);T.x=x*z,T.y=-B*r+y,T.z=x*V,d.push(T.x,T.y,T.z),v.set(z,C,V).normalize(),u.push(v.x,v.y,v.z),p.push(N,1-B),F.push(g++)}f.push(F)}for(let P=0;P<n;P++)for(let F=0;F<i;F++){let B=f[F][P],x=f[F+1][P],L=f[F+1][P+1],N=f[F][P+1];c.push(B,x,N),c.push(x,L,N),M+=6}l.addGroup(E,M,0),E+=M}function w(v){let T=g,M=new Tt,C=new ye,P=0,F=v===!0?e:t,B=v===!0?1:-1;for(let L=1;L<=n;L++)d.push(0,y*B,0),u.push(0,B,0),p.push(.5,.5),g++;let x=g;for(let L=0;L<=n;L++){let N=L/n*s+a,O=Math.cos(N),z=Math.sin(N);C.x=F*z,C.y=y*B,C.z=F*O,d.push(C.x,C.y,C.z),u.push(0,B,0),M.x=O*.5+.5,M.y=z*.5*B+.5,p.push(M.x,M.y),g++}for(let L=0;L<n;L++){let N=T+L,O=x+L;v===!0?c.push(O,O+1,N):c.push(O+1,O,N),P+=3}l.addGroup(E,P,v===!0?1:2),E+=P}}},Wk=class extends Ud{constructor(e=1,t=1,r=32,n=1,i=!1,o=0,a=Math.PI*2){super(0,e,t,r,n,i,o,a),this.type="ConeGeometry"}},$k=class extends La{constructor(e,t={}){super(),this.type="ExtrudeGeometry";let r=this,n=[],i=[];for(let a=0,s=e.length;a<s;a++){let l=e[a];o(l)}this.setAttribute("position",new Bo(n,3)),this.setAttribute("uv",new Bo(i,2)),this.computeVertexNormals();function o(a){let s=[],l=t.curveSegments!==void 0?t.curveSegments:12,c=t.steps!==void 0?t.steps:1,d=t.depth!==void 0?t.depth:1,u=t.bevelEnabled!==void 0?t.bevelEnabled:!0,p=t.bevelThickness!==void 0?t.bevelThickness:.2,g=t.bevelSize!==void 0?t.bevelSize:p-.1,f=t.bevelOffset!==void 0?t.bevelOffset:0,y=t.bevelSegments!==void 0?t.bevelSegments:3,E=t.UVGenerator!==void 0?t.UVGenerator:Gae;u||(y=0,p=0,g=0,f=0);let _=a.extractPoints(l),w=_.shape,v=_.holes;if(!vh.isClockWise(w)){w=w.reverse();for(let K=0,se=v.length;K<se;K++){let H=v[K];vh.isClockWise(H)&&(v[K]=H.reverse())}}let T=vh.triangulateShape(w,v),M=w;for(let K=0,se=v.length;K<se;K++){let H=v[K];w=w.concat(H)}function C(K,se,H){return se||console.error("THREE.ExtrudeGeometry: vec does not exist"),K.clone().addScaledVector(se,H)}let P=w.length,F=T.length;function B(K,se,H){let Z,ce,Re,he=K.x-se.x,Ie=K.y-se.y,Ee=H.x-K.x,Be=H.y-K.y,J=he*he+Ie*Ie,j=he*Be-Ie*Ee;if(Math.abs(j)>Number.EPSILON){let pe=Math.sqrt(J),De=Math.sqrt(Ee*Ee+Be*Be),Te=se.x-Ie/pe,Se=se.y+he/pe,qe=H.x-Be/De,st=H.y+Ee/De,Ve=((qe-Te)*Be-(st-Se)*Ee)/(he*Be-Ie*Ee);Z=Te+he*Ve-K.x,ce=Se+Ie*Ve-K.y;let _e=Z*Z+ce*ce;if(_e<=2)return new Tt(Z,ce);Re=Math.sqrt(_e/2)}else{let pe=!1;he>Number.EPSILON?Ee>Number.EPSILON&&(pe=!0):he<-Number.EPSILON?Ee<-Number.EPSILON&&(pe=!0):Math.sign(Ie)===Math.sign(Be)&&(pe=!0),pe?(Z=-Ie,ce=he,Re=Math.sqrt(J)):(Z=he,ce=Ie,Re=Math.sqrt(J/2))}return new Tt(Z/Re,ce/Re)}let x=[];for(let K=0,se=M.length,H=se-1,Z=K+1;K<se;K++,H++,Z++)H===se&&(H=0),Z===se&&(Z=0),x[K]=B(M[K],M[H],M[Z]);let L=[],N,O=x.concat();for(let K=0,se=v.length;K<se;K++){let H=v[K];N=[];for(let Z=0,ce=H.length,Re=ce-1,he=Z+1;Z<ce;Z++,Re++,he++)Re===ce&&(Re=0),he===ce&&(he=0),N[Z]=B(H[Z],H[Re],H[he]);L.push(N),O=O.concat(N)}for(let K=0;K<y;K++){let se=K/y,H=p*Math.cos(se*Math.PI/2),Z=g*Math.sin(se*Math.PI/2)+f;for(let ce=0,Re=M.length;ce<Re;ce++){let he=C(M[ce],x[ce],Z);W(he.x,he.y,-H)}for(let ce=0,Re=v.length;ce<Re;ce++){let he=v[ce];N=L[ce];for(let Ie=0,Ee=he.length;Ie<Ee;Ie++){let Be=C(he[Ie],N[Ie],Z);W(Be.x,Be.y,-H)}}}let z=g+f;for(let K=0;K<P;K++){let se=u?C(w[K],O[K],z):w[K];W(se.x,se.y,0)}for(let K=1;K<=c;K++)for(let se=0;se<P;se++){let H=u?C(w[se],O[se],z):w[se];W(H.x,H.y,d/c*K)}for(let K=y-1;K>=0;K--){let se=K/y,H=p*Math.cos(se*Math.PI/2),Z=g*Math.sin(se*Math.PI/2)+f;for(let ce=0,Re=M.length;ce<Re;ce++){let he=C(M[ce],x[ce],Z);W(he.x,he.y,d+H)}for(let ce=0,Re=v.length;ce<Re;ce++){let he=v[ce];N=L[ce];for(let Ie=0,Ee=he.length;Ie<Ee;Ie++){let Be=C(he[Ie],N[Ie],Z);W(Be.x,Be.y,d+H)}}}V(),$();function V(){let K=n.length/3;if(u){let se=0,H=P*se;for(let Z=0;Z<F;Z++){let ce=T[Z];U(ce[2]+H,ce[1]+H,ce[0]+H)}se=c+y*2,H=P*se;for(let Z=0;Z<F;Z++){let ce=T[Z];U(ce[0]+H,ce[1]+H,ce[2]+H)}}else{for(let se=0;se<F;se++){let H=T[se];U(H[2],H[1],H[0])}for(let se=0;se<F;se++){let H=T[se];U(H[0]+P*c,H[1]+P*c,H[2]+P*c)}}r.addGroup(K,n.length/3-K,0)}function $(){let K=n.length/3,se=0;G(M,se),se+=M.length;for(let H=0,Z=v.length;H<Z;H++){let ce=v[H];G(ce,se),se+=ce.length}r.addGroup(K,n.length/3-K,1)}function G(K,se){let H=K.length;for(;--H>=0;){let Z=H,ce=H-1;ce<0&&(ce=K.length-1);for(let Re=0,he=c+y*2;Re<he;Re++){let Ie=P*Re,Ee=P*(Re+1),Be=se+Z+Ie,J=se+ce+Ie,j=se+ce+Ee,pe=se+Z+Ee;D(Be,J,j,pe)}}}function W(K,se,H){s.push(K),s.push(se),s.push(H)}function U(K,se,H){de(K),de(se),de(H);let Z=n.length/3,ce=E.generateTopUV(r,n,Z-3,Z-2,Z-1);ge(ce[0]),ge(ce[1]),ge(ce[2])}function D(K,se,H,Z){de(K),de(se),de(Z),de(se),de(H),de(Z);let ce=n.length/3,Re=E.generateSideWallUV(r,n,ce-6,ce-3,ce-2,ce-1);ge(Re[0]),ge(Re[1]),ge(Re[3]),ge(Re[1]),ge(Re[2]),ge(Re[3])}function de(K){n.push(s[K*3+0]),n.push(s[K*3+1]),n.push(s[K*3+2])}function ge(K){i.push(K.x),i.push(K.y)}}}},Gae={generateTopUV:function(e,t,r,n,i){let o=t[r*3],a=t[r*3+1],s=t[n*3],l=t[n*3+1],c=t[i*3],d=t[i*3+1];return[new Tt(o,a),new Tt(s,l),new Tt(c,d)]},generateSideWallUV:function(e,t,r,n,i,o){let a=t[r*3],s=t[r*3+1],l=t[r*3+2],c=t[n*3],d=t[n*3+1],u=t[n*3+2],p=t[i*3],g=t[i*3+1],f=t[i*3+2],y=t[o*3],E=t[o*3+1],_=t[o*3+2];return Math.abs(s-d)<Math.abs(a-c)?[new Tt(a,1-l),new Tt(c,1-u),new Tt(p,1-f),new Tt(y,1-_)]:[new Tt(s,1-l),new Tt(d,1-u),new Tt(g,1-f),new Tt(E,1-_)]}},e0=class extends La{constructor(e=1,t=1,r=1,n=1){super(),this.type="PlaneGeometry";let i=e/2,o=t/2,a=Math.floor(r),s=Math.floor(n),l=a+1,c=s+1,d=e/a,u=t/s,p=[],g=[],f=[],y=[];for(let E=0;E<c;E++){let _=E*u-o;for(let w=0;w<l;w++){let v=w*d-i;g.push(v,-_,0),f.push(0,0,1),y.push(w/a),y.push(1-E/s)}}for(let E=0;E<s;E++)for(let _=0;_<a;_++){let w=_+l*E,v=_+l*(E+1),T=_+1+l*(E+1),M=_+1+l*E;p.push(w,v,M),p.push(v,T,M)}this.setIndex(p),this.setAttribute("position",new Bo(g,3)),this.setAttribute("normal",new Bo(f,3)),this.setAttribute("uv",new Bo(y,2))}},My=class extends Ii{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new vt(e),this.intensity=t}dispose(){}},Gy=class extends My{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}},Ch=class extends My{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ii.DEFAULT_UP),this.updateMatrix(),this.target=new Ii}dispose(){}};function Sh(e){let t={};for(let r in e){t[r]={};for(let n in e[r]){let i=e[r][n];i&&(i instanceof vt||i instanceof Po||i instanceof Nt||i instanceof Tt||i instanceof ye||i instanceof pn||i instanceof Bs||i instanceof Ql)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[r][n]=null):t[r][n]=i.clone():Array.isArray(i)?t[r][n]=i.slice():t[r][n]=i}}return t}function RW(e){let t=[];for(let r=0;r<e.length;r++)t.push(e[r].clone());return t}function FW(e){return e.getRenderTarget()===null?e.outputColorSpace:Ga}var Lae=0,Zl=class extends Ns{constructor(e){super(),Object.defineProperty(this,"id",{value:Lae++}),this.uuid=Yl(),this.name="",this.type="Material",this.blending=hh,this.side=Wv,this.vertexColors=!1,this.useVertexPickingColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Ek,this.blendDst=Tk,this.blendEquation=Od,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=$v,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=yW,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ok,this.stencilZFail=Ok,this.stencilZPass=Ok,this.stencilWrite=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.userData={},this.version=0,this._alphaTest=0,this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="",this.fragmentShader="",this.wireframe=!1,this.lights=!1,this.forceSinglePass=!0,this.exprTooComplex=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}customProgramCacheKey(){return"no-custom-cache-key"}setValues(e){if(e!==void 0)for(let t in e){let r=t,n=e[r];if(n===void 0){console.warn(`THREE.Material: parameter '${r}' has value of undefined.`);continue}let i=this[r];if(i===void 0){console.warn(`THREE.Material: '${r}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(n):i&&i instanceof ye&&n&&n instanceof ye?i.copy(n):this[r]=n}}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.useVertexPickingColors=e.useVertexPickingColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Sh(e.uniforms),this.uniformsGroups=RW(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.lights=e.lights,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},Eh=class extends ha{constructor(e,t,r=!1,n=1){super(e,t,r),this.meshPerAttribute=n}},Ai=class extends Ii{constructor(e,t){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t}},NW=new Nt,BW=new Jp,Mi=class extends Ai{constructor(e,t,r){super(e,t),this.instanceMatrix=new Eh(new Float32Array(r*16),16),this.instanceColor=new Eh(new Float32Array(r*3),3),this.instancePickingColor=new Eh(new Float32Array(r*4),4),this.count=r}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getPickingColorAt(e,t){let r=this.instancePickingColor.array;e=e*4,t[0]=r[e+0],t[1]=r[e+1],t[2]=r[e+2],t[3]=r[e+3]}setColorAt(e,t){t.toArray(this.instanceColor.array,e*3)}setPickingColorAt(e,t){let r=this.instancePickingColor.array,n=e*4;r[n+0]=t[0],r[n+1]=t[1],r[n+2]=t[2],r[n+3]=t[3]}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}computeBoundingSphere(){var e,t;let r=this.geometry,n=this.count;this.boundingSphere||(this.boundingSphere=new Jp),r.boundingSphere||r.computeBoundingSphere(),(e=this.boundingSphere)==null||e.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,NW),BW.copy(r.boundingSphere).applyMatrix4(NW),(t=this.boundingSphere)==null||t.union(BW)}dispose(){this.dispatchEvent({type:"dispose"})}},Qp=class{constructor(e=new ye(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}setComponents(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}distanceToPoint(e){return this.normal.dot(e)+this.constant}},t0=new Jp,jk=class{constructor(e=new Qp,t=new Qp,r=new Qp,n=new Qp,i=new Qp,o=new Qp){this.planes=[e,t,r,n,i,o]}setFromProjectionMatrix(e,t=Jl){let r=this.planes,n=e.elements,i=n[0],o=n[1],a=n[2],s=n[3],l=n[4],c=n[5],d=n[6],u=n[7],p=n[8],g=n[9],f=n[10],y=n[11],E=n[12],_=n[13],w=n[14],v=n[15];if(r[0].setComponents(s-i,u-l,y-p,v-E).normalize(),r[1].setComponents(s+i,u+l,y+p,v+E).normalize(),r[2].setComponents(s+o,u+c,y+g,v+_).normalize(),r[3].setComponents(s-o,u-c,y-g,v-_).normalize(),r[4].setComponents(s-a,u-d,y-f,v-w).normalize(),t===Jl)r[5].setComponents(s+a,u+d,y+f,v+w).normalize();else if(t===Jv)r[5].setComponents(a,d,f,w).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){let t=e.geometry;return t?(e instanceof Mi?(e.computeBoundingSphere(),t0.copy(e.boundingSphere).applyMatrix4(e.matrixWorld)):(t.boundingSphere||t.computeBoundingSphere(),t0.copy(t.boundingSphere),t0.applyMatrix4(e.dcgModelMatrix),t0.applyMatrix4(e.matrixWorld)),this.intersectsSphere(t0)):!1}intersectsSphere(e){let t=this.planes,r=e.center,n=-e.radius;for(let i=0;i<6;i++)if(t[i].distanceToPoint(r)<n)return!1;return!0}},r0=class extends Ii{constructor(){super(),this.isGroup=!0,this.type="Group"}},UW=new ye,zW=new ye,Yk=class extends Ii{constructor(e,t){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[0];for(let n=1,i=t.count;n<i;n++)UW.fromBufferAttribute(t,n-1),zW.fromBufferAttribute(t,n),r[n]=r[n-1],r[n]+=UW.distanceTo(zW);e.setAttribute("lineDistance",new Bo(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},qW=new ye,HW=new ye,Xk=class extends Yk{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[];for(let n=0,i=t.count;n<i;n+=2)qW.fromBufferAttribute(t,n),HW.fromBufferAttribute(t,n+1),r[n]=n===0?0:r[n-1],r[n+1]=r[n]+qW.distanceTo(HW);e.setAttribute("lineDistance",new Bo(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},KW=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}

vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
`,WW=`
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6

#define saturate( a ) clamp( a, 0.0, 1.0 )

float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }

#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif

struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};

struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};

struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
};

vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}

vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}

vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
`,$W=`
#ifdef USE_MAP
	diffuseColor *= texture2D( map, vMapUv );
#endif

#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif
`,jW=`
#ifdef OPAQUE
  diffuseColor.a = 1.0;
#endif

gl_FragColor = vec4( outgoingLight, diffuseColor.a );
gl_FragColor = linearToOutputTexel( gl_FragColor );

#ifdef PREMULTIPLIED_ALPHA
	// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.
	gl_FragColor.rgb *= gl_FragColor.a;
#endif
`,YW=`
#ifdef USE_MAP
	varying vec2 vMapUv;
	uniform sampler2D map;
#endif

#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif

#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif

#if defined(USE_INSTANCING_PICKINGCOLOR) || defined(USE_VERTEX_PICKING_COLOR)
	varying vec4 vPickingColor;
#endif
`,XW=`
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif

#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif

#if defined(USE_INSTANCING_PICKINGCOLOR) || defined (USE_VERTEX_PICKING_COLOR)
	varying vec4 vPickingColor;
#endif
`,JW=`
#ifdef USE_MAP
	vMapUv = ( vec3( MAP_UV, 1 ) ).xy;
#endif

vec3 transformed = vec3( position );
vec4 mvPosition = vec4( transformed, 1.0 );

#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#else
	mvPosition = dcgModelMatrix * mvPosition;
#endif

mvPosition = modelViewMatrix * mvPosition;

gl_Position = projectionMatrix * mvPosition;

#ifdef USE_COLOR
	vColor = color;
#endif

#ifdef USE_INSTANCING_COLOR
  vColor = instanceColor;
#endif

#ifdef USE_INSTANCING_PICKINGCOLOR
	vPickingColor = instancePickingColor;
#endif

#ifdef USE_VERTEX_PICKING_COLOR
	vPickingColor = vertexPickingColor;
#endif

`,QW=`
PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );

vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );

material.roughness = max( roughnessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.
material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );

#ifdef IOR
	material.ior = ior;
	float specularIntensityFactor = 1.0;
	vec3 specularColorFactor = vec3( 1.0 );
	material.specularF90 = 1.0;
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif

GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );

IncidentLight directLight;

#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif

#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
#endif

#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif

#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif

#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif
`,ZW=`
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];

vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}

vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}

vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}

#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif

struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;

	#ifdef IOR
		float ior;
	#endif
};

vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );

float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}

float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1
	return RECIPROCAL_PI * a2 / pow2( denom );
}

vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness ); // UE4's roughness
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}

vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}

void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	vec3 Fr = specularColor;
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619; // 1/21
	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}

void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}

void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}

void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}

#define RE_Direct RE_Direct_Physical
#define RE_IndirectDiffuse RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular	RE_IndirectSpecular_Physical
`,un={common:WW,colorspace_pars_fragment:KW,common_fragment_begin:$W,common_fragment_end:jW,common_pars_fragment:YW,common_pars_vertex:XW,common_vertex:JW,lights_fragment:QW,lights_pars_fragment:ZW},sO={common:{diffuse:{value:new vt(16777215)},opacity:{value:1},map:{value:null},alphaTest:{value:0}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}}}},Jk=class{constructor(e,t){this.gl=e,this.info=t}setMode(e){this.mode=e}render(e,t){this.gl.drawArrays(this.mode,e,t),this.info.update(t,this.mode,1)}renderInstances(e,t,r){r!==0&&(this.gl.drawArraysInstanced(this.mode,e,t,r),this.info.update(t,this.mode,r))}},Qk=class{constructor(e,t,r){let n;function i(){if(n!==void 0)return n;if(t.has("EXT_texture_filter_anisotropic")===!0){let C=t.get("EXT_texture_filter_anisotropic");n=e.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n||0}function o(C){if(C==="highp"){let P=e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT),F=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);if(P!==null&&P.precision>0&&F!==null&&F.precision>0)return"highp";C="mediump"}if(C==="mediump"){let P=e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT),F=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT);if(P!==null&&P.precision>0&&F!==null&&F.precision>0)return"mediump"}return"lowp"}let a=typeof WebGL2RenderingContext!="undefined"&&e.constructor.name==="WebGL2RenderingContext",s=r.precision!==void 0?r.precision:"highp",l=o(s);l!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",l,"instead."),s=l);let c=a||t.has("WEBGL_draw_buffers"),d=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),u=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),p=e.getParameter(e.MAX_TEXTURE_SIZE),g=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),f=e.getParameter(e.MAX_VERTEX_ATTRIBS),y=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),E=e.getParameter(e.MAX_VARYING_VECTORS),_=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),w=u>0,v=a||t.has("OES_texture_float"),T=w&&v,M=a?e.getParameter(e.MAX_SAMPLES):0;this.isWebGL2=a,this.drawBuffers=c,this.getMaxAnisotropy=i,this.getMaxPrecision=o,this.precision=s,this.maxTextures=d,this.maxVertexTextures=u,this.maxTextureSize=p,this.maxCubemapSize=g,this.maxAttributes=f,this.maxVertexUniforms=y,this.maxVaryings=E,this.maxFragmentUniforms=_,this.vertexTextures=w,this.floatFragmentTextures=v,this.floatVertexTextures=T,this.maxSamples=M}},Zk=class{constructor(e){let t={};function r(n){if(t[n]!==void 0)return t[n];let i;switch(n){case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(n)}return t[n]=i,i}this.has=function(n){return r(n)!==null},this.init=function(){r("EXT_color_buffer_float"),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture")},this.get=function(n){let i=r(n);return i===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),i}}},Ly=class extends La{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}},e_=class{constructor(e,t,r,n){let i={},o=new WeakMap;function a(u){let p=u.target;p.index!==null&&t.remove(p.index);for(let f in p.attributes)t.remove(p.attributes[f]);p.removeEventListener("dispose",a),delete i[p.id];let g=o.get(p);g&&(t.remove(g),o.delete(p)),n.releaseStatesOfGeometry(p),p instanceof Ly&&delete p._maxInstanceCount,r.memory.geometries--}function s(u,p){return i[p.id]===!0||(p.addEventListener("dispose",a),i[p.id]=!0,r.memory.geometries++),p}function l(u){let p=u.attributes;for(let g in p)t.update(p[g],e.ARRAY_BUFFER)}function c(u){let p=[],g=u.index,f=u.attributes.position,y=0;if(g!==null){let w=g.array;y=g.version;for(let v=0,T=w.length;v<T;v+=3){let M=w[v+0],C=w[v+1],P=w[v+2];p.push(M,C,C,P,P,M)}}else if(f!==void 0){let w=f.array;y=f.version;for(let v=0,T=w.length/3-1;v<T;v+=3){let M=v+0,C=v+1,P=v+2;p.push(M,C,C,P,P,M)}}else return;let E=new(Nk(p)?bh:fh)(p,1);E.version=y;let _=o.get(u);_&&t.remove(_),o.set(u,E)}function d(u){let p=o.get(u);if(p){let f=u.index;f!==null&&p.version<f.version&&c(u)}else c(u);let g=o.get(u);return wt(g,"attribute"),g}this.get=s,this.update=l,this.getWireframeAttribute=d}},t_=class{constructor(e,t){this.gl=e,this.info=t}setMode(e){this.mode=e}setIndex(e){this.type=e.type,this.bytesPerElement=e.bytesPerElement}render(e,t){this.gl.drawElements(this.mode,t,this.type,e*this.bytesPerElement),this.info.update(t,this.mode,1)}renderInstances(e,t,r){r!==0&&(this.gl.drawElementsInstanced(this.mode,t,this.type,e*this.bytesPerElement,r),this.info.update(t,this.mode,r))}},r_=class{constructor(e){this.gl=e,this.autoReset=!0,this.programs=null,this.memory={geometries:0,textures:0},this.render={frame:0,calls:0,triangles:0,points:0,lines:0}}update(e,t,r){let n=this.gl,i=this.render;switch(i.calls++,t){case n.TRIANGLES:i.triangles+=r*(e/3);break;case n.LINES:i.lines+=r*(e/2);break;case n.LINE_STRIP:i.lines+=r*(e-1);break;case n.LINE_LOOP:i.lines+=r*e;break;case n.POINTS:i.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",t);break}}reset(){this.render.calls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}},lO=class{constructor(){this.lights={}}get(e){let t=this.lights,r=t[e.id];if(r!==void 0)return r;let n={direction:new ye,color:new vt};return t[e.id]=n,n}},Pae=0,o_=class{constructor(){let e=new lO;this.state={version:0,hash:{directionalLength:-1},ambient:[0,0,0],directional:[]};let t=this.state,r=new ye;function n(o){let a=0,s=0,l=0,c=0;for(let u=0,p=o.length;u<p;u++){let g=o[u],f=g.color,y=g.intensity;if(g instanceof Gy)a+=f.r*y,s+=f.g*y,l+=f.b*y;else if(g instanceof Ch){let E=e.get(g);E.color.copy(g.color).multiplyScalar(g.intensity),t.directional[c]=E,c++}}t.ambient[0]=a,t.ambient[1]=s,t.ambient[2]=l;let d=t.hash;d.directionalLength!==c&&(t.directional.length=c,d.directionalLength=c,t.version=Pae++)}function i(o,a){let s=0,l=a.matrixWorldInverse;for(let c=0,d=o.length;c<d;c++){let u=o[c];if(u instanceof Ch){let p=t.directional[s];p.direction.setFromMatrixPosition(u.matrixWorld),r.setFromMatrixPosition(u.target.matrixWorld),p.direction.sub(r),p.direction.transformDirection(l),s++}}}this.setup=n,this.setupView=i}},i_=class{constructor(e,t,r,n){let i=new WeakMap;function o(l){let c=n.render.frame,d=l.geometry,u=t.get(l,d);return i.get(u)!==c&&(t.update(u),i.set(u,c)),l instanceof Mi&&(l.hasEventListener("dispose",s)===!1&&l.addEventListener("dispose",s),i.get(l)!==c&&(r.update(l.instanceMatrix,e.ARRAY_BUFFER),l.instanceColor&&r.update(l.instanceColor,e.ARRAY_BUFFER),l.instancePickingColor&&r.update(l.instancePickingColor,e.ARRAY_BUFFER),i.set(l,c))),u}function a(){i=new WeakMap}function s(l){let c=l.target;c.removeEventListener("dispose",s),r.remove(c.instanceMatrix),c.instanceColor&&r.remove(c.instanceColor),c.instancePickingColor&&r.remove(c.instancePickingColor)}this.update=o,this.dispose=a}};Ss();function cO(e,t,r){let n=e.createShader(t);if(!n)throw new Error(`Error creating shader (type ${t}): ${r}`);return e.shaderSource(n,r),e.compileShader(n),n}var a7=new Bs(new Bd(0,0));function Vae(e){return typeof e[0]=="number"}function Zp(e){return!Array.isArray(e)&&"x"in e}var e7=[],t7=[],r7=new Float32Array(16),o7=new Float32Array(9),i7=new Float32Array(4);function Py(e,t,r){if(Vae(e))return e;let n=t*r,i=e7[n];if(i===void 0&&(i=new Float32Array(n),e7[n]=i),t!==0){e[0].toArray(i,0);for(let o=1,a=0;o!==t;++o)a+=r,e[o].toArray(i,a)}return i}function Pa(e,t){if(e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0}function Va(e,t){for(let r=0,n=t.length;r<n;r++)e[r]=t[r]}function Oae(e,t){let r=t7[t];r===void 0&&(r=new Int32Array(t),t7[t]=r);for(let n=0;n!==t;++n)r[n]=e.allocateTextureUnit();return r}function Rae(e,t){let r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function Fae(e,t){let r=this.cache;if(Zp(t))(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Pa(r,t))return;e.uniform2fv(this.addr,t),Va(r,t)}}function Nae(e,t){let r=this.cache;if(Zp(t))(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(t instanceof vt)(r[0]!==t.r||r[1]!==t.g||r[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(Pa(r,t))return;e.uniform3fv(this.addr,t),Va(r,t)}}function Bae(e,t){let r=this.cache;if(Zp(t))(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Pa(r,t))return;e.uniform4fv(this.addr,t),Va(r,t)}}function Uae(e,t){let r=this.cache;if(Array.isArray(t)){if(Pa(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),Va(r,t)}else{let n=t.elements;if(Pa(r,n))return;i7.set(n),e.uniformMatrix2fv(this.addr,!1,i7),Va(r,n)}}function zae(e,t){let r=this.cache;if(Array.isArray(t)){if(Pa(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),Va(r,t)}else{let n=t.elements;if(Pa(r,n))return;o7.set(n),e.uniformMatrix3fv(this.addr,!1,o7),Va(r,n)}}function qae(e,t){let r=this.cache;if(Array.isArray(t)){if(Pa(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),Va(r,t)}else{let n=t.elements;if(Pa(r,n))return;r7.set(n),e.uniformMatrix4fv(this.addr,!1,r7),Va(r,n)}}function Hae(e,t){let r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function Kae(e,t){let r=this.cache;if(Zp(t))(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Pa(r,t))return;e.uniform2iv(this.addr,t),Va(r,t)}}function Wae(e,t){let r=this.cache;if(Zp(t))(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(Pa(r,t))return;e.uniform3iv(this.addr,t),Va(r,t)}}function $ae(e,t){let r=this.cache;if(Zp(t))(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Pa(r,t))return;e.uniform4iv(this.addr,t),Va(r,t)}}function jae(e,t){let r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function Yae(e,t){let r=this.cache;if(Zp(t))(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Pa(r,t))return;e.uniform2uiv(this.addr,t),Va(r,t)}}function Xae(e,t){let r=this.cache;if(Zp(t))(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(Pa(r,t))return;e.uniform3uiv(this.addr,t),Va(r,t)}}function Jae(e,t){let r=this.cache;if(Zp(t))(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Pa(r,t))return;e.uniform4uiv(this.addr,t),Va(r,t)}}function Qae(e,t,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture2D(t||a7,i)}function Zae(e){switch(e){case 5126:return Rae;case 35664:return Fae;case 35665:return Nae;case 35666:return Bae;case 35674:return Uae;case 35675:return zae;case 35676:return qae;case 5124:case 35670:return Hae;case 35667:case 35671:return Kae;case 35668:case 35672:return Wae;case 35669:case 35673:return $ae;case 5125:return jae;case 36294:return Yae;case 36295:return Xae;case 36296:return Jae;case 35678:case 36198:case 36298:case 36306:return Qae;case 35679:case 36299:case 36307:throw new Error("THREE.WebGLUniforms: sampler3D support is not implemented.");case 35680:case 36300:case 36308:throw new Error("THREE.WebGLUniforms: samplerCube support is not implemented.");case 36289:case 36303:case 36311:throw new Error("THREE.WebGLUniforms: sampler2DArray support is not implemented.")}throw new Error(`Unknown uniform type: ${e}`)}function ese(e,t){e.uniform1fv(this.addr,t)}function tse(e,t){let r=Py(t,this.size,2);e.uniform2fv(this.addr,r)}function rse(e,t){let r=Py(t,this.size,3);e.uniform3fv(this.addr,r)}function ose(e,t){let r=Py(t,this.size,4);e.uniform4fv(this.addr,r)}function ise(e,t){let r=Py(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function nse(e,t){let r=Py(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function ase(e,t){let r=Py(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function sse(e,t){e.uniform1iv(this.addr,t)}function lse(e,t){e.uniform2iv(this.addr,t)}function cse(e,t){e.uniform3iv(this.addr,t)}function dse(e,t){e.uniform4iv(this.addr,t)}function pse(e,t){e.uniform1uiv(this.addr,t)}function use(e,t){e.uniform2uiv(this.addr,t)}function hse(e,t){e.uniform3uiv(this.addr,t)}function gse(e,t){e.uniform4uiv(this.addr,t)}function mse(e,t,r){let n=this.cache,i=t.length,o=Oae(r,i);Pa(n,o)||(e.uniform1iv(this.addr,o),Va(n,o));for(let a=0;a!==i;++a)r.setTexture2D(t[a]||a7,o[a])}function fse(e){switch(e){case 5126:return ese;case 35664:return tse;case 35665:return rse;case 35666:return ose;case 35674:return ise;case 35675:return nse;case 35676:return ase;case 5124:case 35670:return sse;case 35667:case 35671:return lse;case 35668:case 35672:return cse;case 35669:case 35673:return dse;case 5125:return pse;case 36294:return use;case 36295:return hse;case 36296:return gse;case 35678:case 36198:case 36298:case 36306:return mse;case 35679:case 36299:case 36307:throw new Error("THREE.WebGLUniforms: sampler3DArray support is not implemented.");case 35680:case 36300:case 36308:throw new Error("THREE.WebGLUniforms: samplerCube support is not implemented.");case 36289:case 36303:case 36311:throw new Error("THREE.WebGLUniforms: sampler2DArray support is not implemented.")}throw new Error(`Unrecognized uniform type: ${e}`)}var pO=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=Zae(t.type)}},uO=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=fse(t.type)}},n_=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){let n=this.seq;for(let i=0,o=n.length;i!==o;++i){let a=n[i];a.setValue(e,t[a.id],r)}}},dO=/(\w+)(\])?(\[|\.)?/g;function n7(e,t){e.seq.push(t),e.map[t.id]=t}function bse(e,t,r){let n=e.name,i=n.length;for(dO.lastIndex=0;;){let o=dO.exec(n),a=dO.lastIndex;wt(o,"parseUniform match");let s=o[1],l=o[2]==="]",c=o[3];if(l&&(s=s|0),c===void 0||c==="["&&a+2===i){n7(r,c===void 0?new pO(s,e,t):new uO(s,e,t));break}else{let d=r.map[s];if(d===void 0&&(d=new n_(s),n7(r,d)),!(d instanceof n_))throw new Error(`THREE.WebGLUniforms: Programming error: expected ${s} to be a StructuredUniform`);r=d}}}var Th=class{constructor(e,t){this.seq=[],this.map={};let r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let n=0;n<r;++n){let i=e.getActiveUniform(t,n);wt(i,"active info",e);let o=e.getUniformLocation(t,i.name);bse(i,o,this)}}setValue(e,t,r,n){let i=this.map[t];i!==void 0&&i.setValue(e,r,n)}setOptional(e,t,r,n){let i=t[r];i!==void 0&&this.setValue(e,r,i,n)}static upload(e,t,r,n){for(let i=0,o=t.length;i!==o;++i){let a=t[i],s=r[a.id];s.needsUpdate!==!1&&a.setValue(e,s.value,n)}}static seqWithValue(e,t){let r=[];for(let n=0,i=e.length;n!==i;++n){let o=e[n];o.id in t&&r.push(o)}return r}},yse=0;function xse(e,t){if(e===null)throw new Error("Shader source is undefined.");let r=e.split(`
`),n=[],i=Math.max(t-6,0),o=Math.min(t+6,r.length);for(let a=i;a<o;a++){let s=a+1;n.push(`${s===t?">":" "} ${s}: ${r[a]}`)}return n.join(`
`)}function wse(e){switch(e){case Ga:return["Linear","( value )"];case Lo:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",e),["Linear","( value )"]}}function s7(e,t,r){let n=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t);wt(i,"shader info",e);let o=i.trim()||"";if(n&&o==="")return"";let a=/ERROR: 0:(\d+)/.exec(o);if(a){let s=parseInt(a[1]);return r.toUpperCase()+`

`+o+`

`+xse(e.getShaderSource(t),s)}else return o}function vse(e,t){let r=wse(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function Cse(e){let t=[];for(let r in e){let n=e[r];n!==!1&&t.push("#define "+r+" "+n)}return t.join(`
`)}function Sse(e,t){let r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){let o=e.getActiveAttrib(t,i);if(!o)throw new Error("THREE.WebGLProgram: Error fetching attribute info.");let a=o.name,s=1;o.type===e.FLOAT_MAT2&&(s=2),o.type===e.FLOAT_MAT3&&(s=3),o.type===e.FLOAT_MAT4&&(s=4),r[a]={type:o.type,location:e.getAttribLocation(t,a),locationSize:s}}return r}function l7(e){return e!==""}function c7(e,t){return e.replace(/NUM_DIR_LIGHTS/g,""+t.numDirLights)}var Ese=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function d7(e){return e.replace(Ese,Tse)}function Tse(e,t,r,n){let i="";for(let o=parseInt(t);o<parseInt(r);o++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,""+o);return i}function p7(e){let t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}var a_=class{constructor(e,t,r,n){var i,o,a;let s=e.getContext(),l=r.defines,c=r.vertexShader,d=r.fragmentShader,u=Cse(l),p=s.createProgram();if(!p)throw new Error("THREE.WebGLProgram: Unable to create program.");let g,f,y=r.glslVersion?"#version "+r.glslVersion+`
`:"";g=[p7(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,u,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.instancingPickingColor?"#define USE_INSTANCING_PICKINGCOLOR":"",r.vertexPickingColor?"#define USE_VERTEX_PICKING_COLOR":"",r.map?"#define USE_MAP":"",r.mapUv?"#define MAP_UV "+r.mapUv:"",r.vertexColors?"#define USE_COLOR":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_PICKINGCOLOR","	attribute vec4 instancePickingColor;","#endif","#ifdef USE_VERTEX_PICKING_COLOR"," attribute vec4 vertexPickingColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif",`
`].filter(l7).join(`
`),f=[p7(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,u,r.map?"#define USE_MAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.vertexColors?"#define USE_COLOR":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.instancingPickingColor?"#define USE_INSTANCING_PICKINGCOLOR":"",r.vertexPickingColor?"#define USE_VERTEX_PICKING_COLOR":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.opaque?"#define OPAQUE":"",un.colorspace_pars_fragment,vse("linearToOutputTexel",r.outputColorSpace),`
`].filter(l7).join(`
`),c=c7(c,r),d=c7(d,r),c=d7(c),d=d7(d),y=`#version 300 es
`,g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,f=["#define varying in",r.glslVersion===QV?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===QV?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+f;let E=y+g+c,_=y+f+d,w=cO(s,s.VERTEX_SHADER,E),v=cO(s,s.FRAGMENT_SHADER,_);if(s.attachShader(p,w),s.attachShader(p,v),r.index0AttributeName!==void 0&&s.bindAttribLocation(p,0,r.index0AttributeName),s.linkProgram(p),e.debug.checkShaderErrors){let C=(i=s.getProgramInfoLog(p))==null?void 0:i.trim(),P=(o=s.getShaderInfoLog(w))==null?void 0:o.trim(),F=(a=s.getShaderInfoLog(v))==null?void 0:a.trim();wt(C,"program lob",s),wt(P,"vertex log",s),wt(F,"fragment log",s);let B=!0,x=!0,L=!1;if(s.getProgramParameter(p,s.LINK_STATUS)===!1)if(B=!1,typeof e.debug.onShaderError=="function")e.debug.onShaderError(s,p,w,v);else{let N=s7(s,w,"vertex"),O=s7(s,v,"fragment"),z=s.getError();L=O.includes("Expression too complex"),L||(console.error("THREE.WebGLProgram: Shader Error "+z+" - VALIDATE_STATUS "+s.getProgramParameter(p,s.VALIDATE_STATUS)+`

Program Info Log: `+C+`
`+N+`
`+O),z&&z!=1282||N||O||C&&z!=1282?(s.getProgramParameter(p,s.VALIDATE_STATUS),void 0):void 0)}else C!==""?console.warn("THREE.WebGLProgram: Program Info Log:",C):(P===""||F==="")&&(x=!1);x&&(this.diagnostics={runnable:B,exprTooComplex:L,programLog:C,vertexShader:{log:P,prefix:g},fragmentShader:{log:F,prefix:f}})}s.deleteShader(w),s.deleteShader(v);let T;this.getUniforms=function(){return T===void 0&&(T=new Th(s,p)),T};let M;this.getAttributes=function(){return M===void 0&&(M=Sse(s,p)),M},this.destroy=function(){n.releaseStatesOfProgram(this),s.deleteProgram(p),this.program=void 0},this.type=r.shaderType,this.name=r.shaderName,this.id=yse++,this.cacheKey=t,this.usedTimes=1,this.program=p,this.vertexShader=w,this.fragmentShader=v}},Dse=0,s_=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,r=e.fragmentShader,n=this._getShaderStage(t),i=this._getShaderStage(r),o=this._getShaderCacheForMaterial(e);return o.has(n)===!1&&(o.add(n),n.usedTimes++),o.has(i)===!1&&(o.add(i),i.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let r of t||[])r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){let t=this.shaderCache,r=t.get(e);return r===void 0&&(r=new hO(e),t.set(e,r)),r}},hO=class{constructor(e){this.id=Dse++,this.code=e,this.usedTimes=0}},l_=class{constructor(e,t,r){let n=new Ty,i=new s_,o=[],a=t.vertexTextures,s=t.precision;function l(_){return _===0?"uv":`uv${_}`}function c(_,w,v,T){var M,C,P,F;let B=T.geometry;_.precision!==null&&(s=t.getMaxPrecision(_.precision),s!==_.precision&&console.warn("THREE.WebGLProgram.getParameters:",_.precision,"not supported, using",s,"instead."));let x=_.vertexShader,L=_.fragmentShader;i.update(_);let N=i.getVertexShaderID(_),O=i.getFragmentShaderID(_),z=e.getRenderTarget(),V=T instanceof Mi,$=!!B.attributes.uv1,G=!!B.attributes.uv2,W=!!B.attributes.uv3;return{shaderType:_.type,shaderName:_.name,vertexShader:x,fragmentShader:L,defines:_.defines,customVertexShaderID:N,customFragmentShaderID:O,glslVersion:_.glslVersion,precision:s,instancing:V,instancingColor:V&&!!T.instanceColor,instancingPickingColor:V&&!!T.instancePickingColor,vertexPickingColor:!!T.pickingColorArray,supportsVertexTextures:a,outputColorSpace:z===null?e.outputColorSpace:Ga,map:!!_.map,opaque:_.transparent===!1&&_.blending===hh,alphaTest:_.alphaTest>0,mapUv:!!_.map&&l(_.map.channel),vertexColors:_.vertexColors,vertexUv1s:$,vertexUv2s:G,vertexUv3s:W,numDirLights:w.directional.length,premultipliedAlpha:_.premultipliedAlpha,doubleSided:_.side===ua,flipSided:_.side===lm,index0AttributeName:_.index0AttributeName,extensionDerivatives:((M=_.extensions)==null?void 0:M.derivatives)===!0,extensionFragDepth:((C=_.extensions)==null?void 0:C.fragDepth)===!0,extensionDrawBuffers:((P=_.extensions)==null?void 0:P.drawBuffers)===!0,extensionShaderTextureLOD:((F=_.extensions)==null?void 0:F.shaderTextureLOD)===!0,rendererExtensionFragDepth:!0,rendererExtensionDrawBuffers:!0,rendererExtensionShaderTextureLod:!0,customProgramCacheKey:_.customProgramCacheKey()}}function d(_){let w=[];if(w.push(_.customVertexShaderID),w.push(_.customFragmentShaderID),_.defines!==void 0)for(let v in _.defines)w.push(v),w.push(_.defines[v]);return u(w,_),p(w,_),w.push(e.outputColorSpace),w.push(_.customProgramCacheKey),w.join()}function u(_,w){_.push(w.precision),_.push(w.outputColorSpace),_.push(w.mapUv),_.push(w.numDirLights)}function p(_,w){n.disableAll(),n.enable(0),w.instancing&&n.enable(2),w.instancingColor&&n.enable(3),w.instancingPickingColor&&n.enable(4),w.vertexPickingColor&&n.enable(5),w.supportsVertexTextures&&n.enable(1),w.alphaTest&&n.enable(10),w.vertexColors&&n.enable(11),w.vertexUv1s&&n.enable(13),w.vertexUv2s&&n.enable(14),w.vertexUv3s&&n.enable(15),_.push(n.mask),n.disableAll(),w.premultipliedAlpha&&n.enable(8),w.doubleSided&&n.enable(11),w.flipSided&&n.enable(12),w.opaque&&n.enable(17),_.push(n.mask)}function g(_,w){let v;for(let T=0,M=o.length;T<M;T++){let C=o[T];if(C.cacheKey===w){v=C,++v.usedTimes;break}}return v===void 0&&(v=new a_(e,w,_,r),o.push(v)),v}function f(_){if(--_.usedTimes===0){let w=o.indexOf(_);o[w]=o[o.length-1],o.pop(),_.destroy()}}function y(_){i.remove(_)}function E(){i.dispose()}this.getParameters=c,this.getProgramCacheKey=d,this.getUniforms=_=>_.uniforms,this.acquireProgram=g,this.releaseProgram=f,this.releaseShaderCache=y,this.programs=o,this.dispose=E}},c_=class{constructor(){let e=new WeakMap;function t(o){let a=e.get(o);return a===void 0&&(a={},e.set(o,a)),a}function r(o){e.delete(o)}function n(o,a,s){e.get(o)[a]=s}function i(){e=new WeakMap}this.get=t,this.remove=r,this.update=n,this.dispose=i}},d_=class{constructor(){let e=[],t=0,r=[],n=[];function i(){t=0,r.length=0,n.length=0}function o(d,u,p,g,f,y){let E=e[t];return E===void 0?(E={id:d.id,object:d,geometry:u,material:p,groupOrder:g,renderOrder:d.renderOrder,z:f,group:y},e[t]=E):(E.id=d.id,E.object=d,E.geometry=u,E.material=p,E.groupOrder=g,E.renderOrder=d.renderOrder,E.z=f,E.group=y),t++,E}function a(d,u,p,g,f,y){let E=o(d,u,p,g,f,y);p.transparent===!0?n.push(E):r.push(E)}function s(d,u,p,g,f,y){let E=o(d,u,p,g,f,y);p.transparent===!0?n.unshift(E):r.unshift(E)}function l(d,u){r.length>1&&r.sort(d||kse),n.length>1&&n.sort(u||_se)}function c(){for(let d=t,u=e.length;d<u;d++){let p=e[d];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}this.opaque=r,this.transparent=n,this.init=i,this.push=a,this.unshift=s,this.finish=c,this.sort=l}},p_=class{constructor(){let e=new WeakMap;function t(n,i){let o=e.get(n),a;return o===void 0?(a=new d_,e.set(n,[a])):i>=o.length?(a=new d_,o.push(a)):a=o[i],a}function r(){e=new WeakMap}this.get=t,this.dispose=r}};function kse(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function _se(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}var u_=class{constructor(e){function t(){let oe=!1,me=new pn,te=null,ae=new pn(0,0,0,0);return{setMask:function(He){te!==He&&!oe&&(e.colorMask(He,He,He,He),te=He)},setLocked:function(He){oe=He},setClear:function(He,Ue,It,it,Cr){Cr===!0&&(He*=it,Ue*=it,It*=it),me.set(He,Ue,It,it),ae.equals(me)===!1&&(e.clearColor(He,Ue,It,it),ae.copy(me))},reset:function(){oe=!1,te=null,ae.set(-1,0,0,0)}}}function r(){let oe=!1,me=null,te=null,ae=null;return{setTest:function(He){He?se(e.DEPTH_TEST):H(e.DEPTH_TEST)},setMask:function(He){me!==He&&!oe&&(e.depthMask(He),me=He)},setFunc:function(He){if(te!==He){switch(He){case tW:e.depthFunc(e.NEVER);break;case rW:e.depthFunc(e.ALWAYS);break;case oW:e.depthFunc(e.LESS);break;case $v:e.depthFunc(e.LEQUAL);break;case iW:e.depthFunc(e.EQUAL);break;case nW:e.depthFunc(e.GEQUAL);break;case aW:e.depthFunc(e.GREATER);break;case sW:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}te=He}},setLocked:function(He){oe=He},setClear:function(He){ae!==He&&(e.clearDepth(He),ae=He)},reset:function(){oe=!1,me=null,te=null,ae=null}}}function n(){let oe=!1,me=null,te=null,ae=null,He=null,Ue=null,It=null,it=null,Cr=null;return{setTest:function(Gt){oe||(Gt?se(e.STENCIL_TEST):H(e.STENCIL_TEST))},setMask:function(Gt){me!==Gt&&!oe&&(e.stencilMask(Gt),me=Gt)},setFunc:function(Gt,ar,Vt){(te!==Gt||ae!==ar||He!==Vt)&&(e.stencilFunc(Gt,ar,Vt),te=Gt,ae=ar,He=Vt)},setOp:function(Gt,ar,Vt){(Ue!==Gt||It!==ar||it!==Vt)&&(e.stencilOp(Gt,ar,Vt),Ue=Gt,It=ar,it=Vt)},setLocked:function(Gt){oe=Gt},setClear:function(Gt){Cr!==Gt&&(e.clearStencil(Gt),Cr=Gt)},reset:function(){oe=!1,me=null,te=null,ae=null,He=null,Ue=null,It=null,it=null,Cr=null}}}let i=t(),o=r(),a=n(),s=new WeakMap,l=new WeakMap,c={},d={},u=new WeakMap,p=[],g=null,f=!1,y=null,E=null,_=null,w=null,v=null,T=null,M=null,C=!1,P=null,F=null,B=null,x=null,L=null,N=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),O=!1,z=0,V=e.getParameter(e.VERSION);if(V.indexOf("WebGL")!==-1){let oe=/^WebGL (\d)/.exec(V);wt(oe,"webgl version match",e),z=parseFloat(oe[1]),O=z>=1}else if(V.indexOf("OpenGL ES")!==-1){let oe=/^OpenGL ES (\d)/.exec(V);wt(oe,"opengl es version match",e),z=parseFloat(oe[1]),O=z>=2}let $=null,G={},W=e.getParameter(e.SCISSOR_BOX),U=e.getParameter(e.VIEWPORT),D=new pn().fromArray(W),de=new pn().fromArray(U);function ge(oe,me,te,ae){let He=new Uint8Array(4),Ue=e.createTexture();e.bindTexture(oe,Ue),e.texParameteri(oe,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(oe,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let It=0;It<te;It++)oe===e.TEXTURE_3D||oe===e.TEXTURE_2D_ARRAY?(wt(ae,"dimensions"),e.texImage3D(me,0,e.RGBA,1,1,ae,0,e.RGBA,e.UNSIGNED_BYTE,He)):e.texImage2D(me+It,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,He);return Ue}let K={[e.TEXTURE_2D]:ge(e.TEXTURE_2D,e.TEXTURE_2D,1),[e.TEXTURE_CUBE_MAP]:ge(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),[e.TEXTURE_2D_ARRAY]:ge(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),[e.TEXTURE_3D]:ge(e.TEXTURE_3D,e.TEXTURE_3D,1,1)};i.setClear(0,0,0,1),o.setClear(1),a.setClear(0),se(e.DEPTH_TEST),o.setFunc($v),J(!1),j(vV),se(e.CULL_FACE),Ee(wk);function se(oe){c[oe]!==!0&&(e.enable(oe),c[oe]=!0)}function H(oe){c[oe]!==!1&&(e.disable(oe),c[oe]=!1)}function Z(oe,me){return d[oe]!==me?(e.bindFramebuffer(oe,me),d[oe]=me,oe===e.DRAW_FRAMEBUFFER&&(d[e.FRAMEBUFFER]=me),oe===e.FRAMEBUFFER&&(d[e.DRAW_FRAMEBUFFER]=me),!0):!1}function ce(oe,me){let te=p,ae=!1;oe?(wt(me,"framebuffer",e),te=u.get(me),te===void 0&&(te=[],u.set(me,te)),te[0]!==e.COLOR_ATTACHMENT0&&(te[0]=e.COLOR_ATTACHMENT0,ae=!0)):te[0]!==e.BACK&&(te[0]=e.BACK,ae=!0),ae&&e.drawBuffers(te)}function Re(oe){return g!==oe?(wt(oe,"program",e),e.useProgram(oe),g=oe,!0):!1}let he={[Od]:e.FUNC_ADD,[H6]:e.FUNC_SUBTRACT,[K6]:e.FUNC_REVERSE_SUBTRACT,[W6]:e.MIN,[$6]:e.MAX},Ie={[Ck]:e.ZERO,[Sk]:e.ONE,[j6]:e.SRC_COLOR,[Ek]:e.SRC_ALPHA,[eW]:e.SRC_ALPHA_SATURATE,[Q6]:e.DST_COLOR,[X6]:e.DST_ALPHA,[Y6]:e.ONE_MINUS_SRC_COLOR,[Tk]:e.ONE_MINUS_SRC_ALPHA,[Z6]:e.ONE_MINUS_DST_COLOR,[J6]:e.ONE_MINUS_DST_ALPHA};function Ee(oe,me,te,ae,He,Ue,It,it){if(oe===wk){f===!0&&(H(e.BLEND),f=!1);return}if(f===!1&&(se(e.BLEND),f=!0),oe!==vk){if(oe!==y||it!==C){if((E!==Od||v!==Od)&&(e.blendEquation(e.FUNC_ADD),E=Od,v=Od),it)switch(oe){case hh:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case CV:e.blendFunc(e.ONE,e.ONE);break;case SV:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case EV:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",oe);break}else switch(oe){case hh:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case CV:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case SV:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case EV:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",oe);break}_=null,w=null,T=null,M=null,y=oe,C=it}return}He=He||me,Ue=Ue||te,It=It||ae,(me!==E||He!==v)&&(wt(me,"blendEquation"),wt(He,"blendEquationAlpha"),e.blendEquationSeparate(he[me],he[He]),E=me,v=He),(te!==_||ae!==w||Ue!==T||It!==M)&&(wt(te,"blendSrc"),wt(ae,"blendDst"),wt(Ue,"blendSrcAlpha"),wt(It,"blendDstAlpha"),e.blendFuncSeparate(Ie[te],Ie[ae],Ie[Ue],Ie[It]),_=te,w=ae,T=Ue,M=It),y=oe,C=!1}function Be(oe,me){oe.side===ua?H(e.CULL_FACE):se(e.CULL_FACE);let te=oe.side===lm;me&&(te=!te),J(te),oe.blending===hh&&oe.transparent===!1?Ee(wk):Ee(oe.blending,oe.blendEquation,oe.blendSrc,oe.blendDst,oe.blendEquationAlpha,oe.blendSrcAlpha,oe.blendDstAlpha,oe.premultipliedAlpha),o.setFunc(oe.depthFunc),o.setTest(oe.depthTest),o.setMask(oe.depthWrite),i.setMask(oe.colorWrite);let ae=oe.stencilWrite;a.setTest(ae),ae&&(a.setMask(oe.stencilWriteMask),a.setFunc(oe.stencilFunc,oe.stencilRef,oe.stencilFuncMask),a.setOp(oe.stencilFail,oe.stencilZFail,oe.stencilZPass)),De(oe.polygonOffset,oe.polygonOffsetFactor,oe.polygonOffsetUnits),oe.alphaToCoverage===!0?se(e.SAMPLE_ALPHA_TO_COVERAGE):H(e.SAMPLE_ALPHA_TO_COVERAGE)}function J(oe){P!==oe&&(oe?e.frontFace(e.CW):e.frontFace(e.CCW),P=oe)}function j(oe){oe!==z6?(se(e.CULL_FACE),oe!==F&&(oe===vV?e.cullFace(e.BACK):oe===q6?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):H(e.CULL_FACE),F=oe}function pe(oe){oe!==B&&(O&&e.lineWidth(oe),B=oe)}function De(oe,me,te){oe?(se(e.POLYGON_OFFSET_FILL),(x!==me||L!==te)&&(wt(me,"factor"),wt(te,"units"),e.polygonOffset(me,te),x=me,L=te)):H(e.POLYGON_OFFSET_FILL)}function Te(oe){oe?se(e.SCISSOR_TEST):H(e.SCISSOR_TEST)}function Se(oe){oe===void 0&&(oe=e.TEXTURE0+N-1),$!==oe&&(e.activeTexture(oe),$=oe)}function qe(oe,me,te){te===void 0&&($===null?te=e.TEXTURE0+N-1:te=$);let ae=G[te];ae===void 0&&(ae={type:void 0,texture:void 0},G[te]=ae),(ae.type!==oe||ae.texture!==me)&&($!==te&&(e.activeTexture(te),$=te),e.bindTexture(oe,me||K[oe]),ae.type=oe,ae.texture=me)}function st(){if($===null)throw new Error("THREE.WebGLState: Trying to unbind a texture that was never bound");let oe=G[$];oe!==void 0&&oe.type!==void 0&&(e.bindTexture(oe.type,null),oe.type=void 0,oe.texture=void 0)}this.compressedTexImage2D=function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}},this.compressedTexImage3D=function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}},this.texSubImage2D=function(){try{e.texSubImage2D.apply(e,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}},this.texSubImage3D=function(){try{e.texSubImage3D.apply(e,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}},this.compressedTexSubImage2D=function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}},this.compressedTexSubImage3D=function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}},this.texStorage2D=function(){try{e.texStorage2D.apply(e,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}},this.texStorage3D=function(){try{e.texStorage3D.apply(e,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}},this.texImage2D=function(){try{e.texImage2D.apply(e,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}},this.texImage3D=function(){try{e.texImage3D.apply(e,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}};function Ve(oe){D.equals(oe)===!1&&(e.scissor(oe.x,oe.y,oe.z,oe.w),D.copy(oe))}function _e(oe){de.equals(oe)===!1&&(e.viewport(oe.x,oe.y,oe.z,oe.w),de.copy(oe))}function gt(oe,me){let te=l.get(me);te===void 0&&(te=new WeakMap,l.set(me,te));let ae=te.get(oe);ae===void 0&&(ae=e.getUniformBlockIndex(me,oe.name),te.set(oe,ae))}function At(oe,me){let te=l.get(me).get(oe);s.get(me)!==te&&(e.uniformBlockBinding(me,te,oe.__bindingPointIndex),s.set(me,te))}function zt(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),c={},$=null,G={},d={},u=new WeakMap,p=[],g=null,f=!1,y=null,E=null,_=null,w=null,v=null,T=null,M=null,C=!1,P=null,F=null,B=null,x=null,L=null,D.set(0,0,e.canvas.width,e.canvas.height),de.set(0,0,e.canvas.width,e.canvas.height),i.reset(),o.reset(),a.reset()}this.buffers={color:i,depth:o,stencil:a},this.enable=se,this.disable=H,this.bindFramebuffer=Z,this.drawBuffers=ce,this.useProgram=Re,this.setBlending=Ee,this.setMaterial=Be,this.setFlipSided=J,this.setCullFace=j,this.setLineWidth=pe,this.setPolygonOffset=De,this.setScissorTest=Te,this.activeTexture=Se,this.bindTexture=qe,this.unbindTexture=st,this.updateUBOMapping=gt,this.uniformBlockBinding=At,this.scissor=Ve,this.viewport=_e,this.reset=zt}},mm=class extends Bs{constructor(e,t,r,n,i,o,a,s,l,c){if(c=c!==void 0?c:Yp,c!==Yp&&c!==gh)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&c===Yp&&(r=Ac),r===void 0&&c===gh&&(r=Fd);let d=new Bd(e,t);super(d,n,i,o,a,s,c,r,l),this.isDepthTexture=!0,this.isDepthTexture=!0,this.image=d,this.magFilter=a!==void 0?a:Rd,this.minFilter=s!==void 0?s:Rd,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}},h_=class{constructor(e,t,r,n,i,o,a){let s=i.maxTextures,l=i.maxTextureSize,c=i.maxSamples,d=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,u=typeof navigator=="undefined"?!1:/OculusBrowser/g.test(navigator.userAgent),p,g=new WeakMap,f=!1;try{f=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch(J){}function y(J,j){return f?new OffscreenCanvas(J,j):Bk("canvas")}function E(J,j){let pe=1;if((J.width>j||J.height>j)&&(pe=j/Math.max(J.width,J.height)),pe<1)if(typeof HTMLImageElement!="undefined"&&J instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&J instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&J instanceof ImageBitmap){let De=Math.floor(pe*J.width),Te=Math.floor(pe*J.height);p===void 0&&(p=y(De,Te)),p.width=De,p.height=Te;let Se=p.getContext("2d");if(wt(Se,"2d context"),!(Se instanceof OffscreenCanvasRenderingContext2D||Se instanceof CanvasRenderingContext2D))throw new Error("Expected a 2d rendering context");return Se.drawImage(J,0,0,De,Te),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+J.width+"x"+J.height+") to ("+De+"x"+Te+")."),p}else return"data"in J&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+J.width+"x"+J.height+")."),J;return J}function _(J){return wV(J.width)&&wV(J.height)}function w(J){return J.generateMipmaps&&J.minFilter!==Rd&&J.minFilter!==ml}function v(J){e.generateMipmap(J)}function T(J,j,pe,De,Te=!1){if(J!==null){if(e[J]!==void 0)return e[J];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+J+"'")}let Se=j;return j===e.RED&&(pe===e.FLOAT&&(Se=e.R32F),pe===e.HALF_FLOAT&&(Se=e.R16F),pe===e.UNSIGNED_BYTE&&(Se=e.R8)),j===e.RED_INTEGER&&(pe===e.UNSIGNED_BYTE&&(Se=e.R8UI),pe===e.UNSIGNED_SHORT&&(Se=e.R16UI),pe===e.UNSIGNED_INT&&(Se=e.R32UI),pe===e.BYTE&&(Se=e.R8I),pe===e.SHORT&&(Se=e.R16I),pe===e.INT&&(Se=e.R32I)),j===e.RG&&(pe===e.FLOAT&&(Se=e.RG32F),pe===e.HALF_FLOAT&&(Se=e.RG16F),pe===e.UNSIGNED_BYTE&&(Se=e.RG8)),j===e.RGBA&&(pe===e.FLOAT&&(Se=e.RGBA32F),pe===e.HALF_FLOAT&&(Se=e.RGBA16F),pe===e.UNSIGNED_BYTE&&(Se=De===Lo&&Te===!1?e.SRGB8_ALPHA8:e.RGBA8),pe===e.UNSIGNED_SHORT_4_4_4_4&&(Se=e.RGBA4),pe===e.UNSIGNED_SHORT_5_5_5_1&&(Se=e.RGB5_A1)),(Se===e.R16F||Se===e.R32F||Se===e.RG16F||Se===e.RG32F||Se===e.RGBA16F||Se===e.RGBA32F)&&t.get("EXT_color_buffer_float"),Se}function M(J,j){return w(J)===!0?Math.log2(Math.max(j.width,j.height))+1:J.mipmaps!==void 0&&J.mipmaps.length>0?J.mipmaps.length:1}function C(J){let j=J.target;j.removeEventListener("dispose",C),F(j)}function P(J){let j=J.target;j.removeEventListener("dispose",P),x(j)}function F(J){let j=n.get(J);if(j.__webglInit===void 0)return;let pe=J.source,De=g.get(pe);if(De){let Te=De[j.__cacheKey];Te.usedTimes--,Te.usedTimes===0&&B(J),Object.keys(De).length===0&&g.delete(pe)}n.remove(J)}function B(J){let j=n.get(J);e.deleteTexture(j.__webglTexture);let pe=J.source,De=g.get(pe);wt(De,"webglTextures"),delete De[j.__cacheKey],a.memory.textures--}function x(J){let j=J.texture,pe=n.get(J),De=n.get(j);De.__webglTexture!==void 0&&(e.deleteTexture(De.__webglTexture),a.memory.textures--),J.depthTexture&&J.depthTexture.dispose();let Te=pe.__webglFramebuffer;if(Array.isArray(Te))for(let Se=0;Se<Te.length;Se++)e.deleteFramebuffer(Te[Se]);else Te&&e.deleteFramebuffer(Te);if(pe.__webglDepthbuffer&&e.deleteRenderbuffer(pe.__webglDepthbuffer),pe.__webglMultisampledFramebuffer&&e.deleteFramebuffer(pe.__webglMultisampledFramebuffer),pe.__webglColorRenderbuffer)for(let Se=0;Se<pe.__webglColorRenderbuffer.length;Se++)pe.__webglColorRenderbuffer[Se]&&e.deleteRenderbuffer(pe.__webglColorRenderbuffer[Se]);pe.__webglDepthRenderbuffer&&e.deleteRenderbuffer(pe.__webglDepthRenderbuffer),n.remove(j),n.remove(J)}let L=0;function N(){L=0}function O(){let J=L;return J>=s&&console.warn("THREE.WebGLTextures: Trying to use "+J+" texture units while this GPU supports only "+s),L+=1,J}function z(J){let j=[];return j.push(J.wrapS),j.push(J.wrapT),j.push(J.magFilter),j.push(J.minFilter),j.push(J.anisotropy),j.push(J.internalFormat),j.push(J.format),j.push(J.type),j.push(J.generateMipmaps),j.push(J.premultiplyAlpha),j.push(J.flipY),j.push(J.unpackAlignment),j.push(J.colorSpace),j.join()}function V(J,j){let pe=n.get(J);if(J.isRenderTargetTexture===!1&&J.version>0&&pe.__version!==J.version)if(J.image.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{de(pe,J,j);return}r.bindTexture(e.TEXTURE_2D,pe.__webglTexture,e.TEXTURE0+j)}let $={[jv]:e.REPEAT,[cm]:e.CLAMP_TO_EDGE,[Yv]:e.MIRRORED_REPEAT},G={[Rd]:e.NEAREST,[lW]:e.NEAREST_MIPMAP_NEAREST,[DV]:e.NEAREST_MIPMAP_LINEAR,[ml]:e.LINEAR,[cW]:e.LINEAR_MIPMAP_NEAREST,[Xv]:e.LINEAR_MIPMAP_LINEAR},W={[xW]:e.NEVER,[DW]:e.ALWAYS,[wW]:e.LESS,[CW]:e.LEQUAL,[vW]:e.EQUAL,[TW]:e.GEQUAL,[SW]:e.GREATER,[EW]:e.NOTEQUAL};function U(J,j){if(e.texParameteri(J,e.TEXTURE_WRAP_S,$[j.wrapS]),e.texParameteri(J,e.TEXTURE_WRAP_T,$[j.wrapT]),e.texParameteri(J,e.TEXTURE_MAG_FILTER,G[j.magFilter]),e.texParameteri(J,e.TEXTURE_MIN_FILTER,G[j.minFilter]),j.compareFunction&&(e.texParameteri(J,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(J,e.TEXTURE_COMPARE_FUNC,W[j.compareFunction])),t.has("EXT_texture_filter_anisotropic")===!0){let pe=t.get("EXT_texture_filter_anisotropic");if(j.magFilter===Rd||j.minFilter!==DV&&j.minFilter!==Xv||j.type===Xl&&t.has("OES_texture_float_linear")===!1)return;(j.anisotropy>1||n.get(j).__currentAnisotropy)&&(e.texParameterf(J,pe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(j.anisotropy,i.getMaxAnisotropy())),n.get(j).__currentAnisotropy=j.anisotropy)}}function D(J,j){let pe=!1;J.__webglInit===void 0&&(J.__webglInit=!0,j.addEventListener("dispose",C));let De=j.source,Te=g.get(De);Te===void 0&&(Te={},g.set(De,Te));let Se=z(j);if(Se!==J.__cacheKey){Te[Se]===void 0&&(Te[Se]={texture:e.createTexture()||void 0,usedTimes:0},a.memory.textures++,pe=!0),Te[Se].usedTimes++;let qe=J.__cacheKey?Te[J.__cacheKey]:void 0;qe!==void 0&&(Te[J.__cacheKey].usedTimes--,qe.usedTimes===0&&B(j)),J.__cacheKey=Se,J.__webglTexture=Te[Se].texture}return pe}function de(J,j,pe){let De=e.TEXTURE_2D,Te=D(J,j),Se=j.source;r.bindTexture(De,J.__webglTexture,e.TEXTURE0+pe);let qe=n.get(Se);if(Se.version!==qe.__version||Te===!0){r.activeTexture(e.TEXTURE0+pe),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,j.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,j.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,j.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);let st=E(j.image,l);st=Be(j,st);let Ve=_(st),_e=o.convert(j.format,j.colorSpace),gt=o.convert(j.type),At=T(j.internalFormat,_e,gt,j.colorSpace);U(De,j);let zt,oe=j.mipmaps,me=qe.__version===void 0||Te===!0,te=M(j,st);if(j instanceof mm)At=e.DEPTH_COMPONENT,j.type===Xl?At=e.DEPTH_COMPONENT32F:j.type===Ac?At=e.DEPTH_COMPONENT24:j.type===Fd?At=e.DEPTH24_STENCIL8:At=e.DEPTH_COMPONENT16,j.format===Yp&&At===e.DEPTH_COMPONENT&&j.type!==Cy&&j.type!==Ac&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),j.type=Ac,gt=o.convert(j.type)),j.format===gh&&At===e.DEPTH_COMPONENT&&(At=e.DEPTH_STENCIL,j.type!==Fd&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),j.type=Fd,gt=o.convert(j.type))),me&&r.texStorage2D(e.TEXTURE_2D,1,At,st.width,st.height);else if(oe.length>0&&Ve){me&&r.texStorage2D(e.TEXTURE_2D,te,At,oe[0].width,oe[0].height);for(let ae=0,He=oe.length;ae<He;ae++)zt=oe[ae],r.texSubImage2D(e.TEXTURE_2D,ae,0,0,_e,gt,zt);j.generateMipmaps=!1}else{if(me&&r.texStorage2D(e.TEXTURE_2D,te,At,st.width,st.height),st instanceof Bd)throw new Error("Texture does not have any image data to upload.");r.texSubImage2D(e.TEXTURE_2D,0,0,0,_e,gt,st)}w(j)&&v(De),qe.__version=Se.version,j.onUpdate&&j.onUpdate(j)}J.__version=j.version}function ge(J,j,pe,De,Te,Se){if(!J||Array.isArray(J))throw new Error("THREE.WebGLTextures: expected non-array framebuffer");let qe=o.convert(pe.format,pe.colorSpace),st=o.convert(pe.type),Ve=T(pe.internalFormat,qe,st,pe.colorSpace);if(!n.get(j).__hasExternalTextures){let _e=Math.max(1,j.width>>Se),gt=Math.max(1,j.height>>Se);r.texImage2D(Te,Se,Ve,_e,gt,0,qe,st,null)}if(r.bindFramebuffer(e.FRAMEBUFFER,J),Ee(j))d.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,De,Te,n.get(pe).__webglTexture,0,Ie(j));else if(Te===e.TEXTURE_2D||Te>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&Te<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z){let _e=n.get(pe).__webglTexture;wt(_e,"webglTexture"),e.framebufferTexture2D(e.FRAMEBUFFER,De,Te,_e,Se)}r.bindFramebuffer(e.FRAMEBUFFER,null)}function K(J,j,pe){if(e.bindRenderbuffer(e.RENDERBUFFER,J||null),j.depthBuffer&&!j.stencilBuffer){let De=e.DEPTH_COMPONENT16;if(pe||Ee(j)){let Te=j.depthTexture;Te&&Te.isDepthTexture&&(Te.type===Xl?De=e.DEPTH_COMPONENT32F:Te.type===Ac&&(De=e.DEPTH_COMPONENT24));let Se=Ie(j);Ee(j)?d.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,Se,De,j.width,j.height):e.renderbufferStorageMultisample(e.RENDERBUFFER,Se,De,j.width,j.height)}else e.renderbufferStorage(e.RENDERBUFFER,De,j.width,j.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,J||null)}else if(j.depthBuffer&&j.stencilBuffer){let De=Ie(j);pe&&Ee(j)===!1?e.renderbufferStorageMultisample(e.RENDERBUFFER,De,e.DEPTH24_STENCIL8,j.width,j.height):Ee(j)?d.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,De,e.DEPTH24_STENCIL8,j.width,j.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,j.width,j.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,J||null)}else{let De=[j.texture];for(let Te=0;Te<De.length;Te++){let Se=De[Te],qe=o.convert(Se.format,Se.colorSpace),st=o.convert(Se.type),Ve=T(Se.internalFormat,qe,st,Se.colorSpace),_e=Ie(j);pe&&Ee(j)===!1?e.renderbufferStorageMultisample(e.RENDERBUFFER,_e,Ve,j.width,j.height):Ee(j)?d.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,_e,Ve,j.width,j.height):e.renderbufferStorage(e.RENDERBUFFER,Ve,j.width,j.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function se(J,j){if(r.bindFramebuffer(e.FRAMEBUFFER,J),!(j.depthTexture&&j.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(j.depthTexture).__webglTexture||j.depthTexture.image.width!==j.width||j.depthTexture.image.height!==j.height)&&(j.depthTexture.image.width=j.width,j.depthTexture.image.height=j.height,j.depthTexture.needsUpdate=!0),V(j.depthTexture,0);let pe=n.get(j.depthTexture).__webglTexture;wt(pe,"webglDepthTexture");let De=Ie(j);if(j.depthTexture.format===Yp)Ee(j)?d.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,pe,0,De):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,pe,0);else if(j.depthTexture.format===gh)Ee(j)?d.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,pe,0,De):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,pe,0);else throw new Error("Unknown depthTexture format")}function H(J){let j=n.get(J),pe=gO(j);J.depthTexture&&!j.__autoAllocateDepthBuffer?se(pe,J):(r.bindFramebuffer(e.FRAMEBUFFER,pe),j.__webglDepthbuffer=e.createRenderbuffer()||void 0,K(j.__webglDepthbuffer,J,!1)),r.bindFramebuffer(e.FRAMEBUFFER,null)}function Z(J,j,pe){let De=n.get(J),Te=gO(De);j!==void 0&&ge(Te,J,J.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),pe!==void 0&&H(J)}function ce(J){let j=J.texture,pe=n.get(J),De=n.get(j);if(J.addEventListener("dispose",P),De.__webglTexture===void 0&&(De.__webglTexture=e.createTexture()||void 0),De.__version=j.version,a.memory.textures++,j.mipmaps&&j.mipmaps.length>0){let Se=[];pe.__webglFramebuffer=Se;for(let qe=0;qe<j.mipmaps.length;qe++){let st=e.createFramebuffer();wt(st,"framebuffer",e),Se[qe]=st}}else{let Se=e.createFramebuffer();pe.__webglFramebuffer=Se||void 0}if(J.samples>0&&Ee(J)===!1){let Se=[j],qe=e.createFramebuffer();wt(qe,"framebuffer",e),pe.__webglMultisampledFramebuffer=qe,pe.__webglColorRenderbuffer=[],r.bindFramebuffer(e.FRAMEBUFFER,pe.__webglMultisampledFramebuffer);for(let st=0;st<Se.length;st++){let Ve=Se[st],_e=e.createRenderbuffer();wt(_e,"renderbuffer",e),pe.__webglColorRenderbuffer[st]=_e,e.bindRenderbuffer(e.RENDERBUFFER,pe.__webglColorRenderbuffer[st]);let gt=o.convert(Ve.format,Ve.colorSpace),At=o.convert(Ve.type),zt=T(Ve.internalFormat,gt,At,Ve.colorSpace,!1),oe=Ie(J);e.renderbufferStorageMultisample(e.RENDERBUFFER,oe,zt,J.width,J.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+st,e.RENDERBUFFER,pe.__webglColorRenderbuffer[st])}if(e.bindRenderbuffer(e.RENDERBUFFER,null),J.depthBuffer){let st=e.createRenderbuffer();wt(st,"renderbuffer",e),pe.__webglDepthRenderbuffer=st,K(pe.__webglDepthRenderbuffer,J,!0)}r.bindFramebuffer(e.FRAMEBUFFER,null)}let Te=e.TEXTURE_2D;if(r.bindTexture(Te,De.__webglTexture),U(Te,j),j.mipmaps&&j.mipmaps.length>0){let Se=Ise(pe);for(let qe=0;qe<j.mipmaps.length;qe++)ge(Se[qe],J,j,e.COLOR_ATTACHMENT0,Te,qe)}else ge(pe.__webglFramebuffer,J,j,e.COLOR_ATTACHMENT0,Te,0);w(j)&&v(Te),r.unbindTexture(),J.depthBuffer&&H(J)}function Re(J){let j=[J.texture];for(let pe=0,De=j.length;pe<De;pe++){let Te=j[pe];if(w(Te)){let Se=e.TEXTURE_2D,qe=n.get(Te).__webglTexture;r.bindTexture(Se,qe),v(Se),r.unbindTexture()}}}function he(J){if(J.samples>0&&Ee(J)===!1){let j=[J.texture],pe=J.width,De=J.height,Te=e.COLOR_BUFFER_BIT,Se=[],qe=J.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,st=n.get(J);wt(st.__webglMultisampledFramebuffer,"__webglMultisampledFramebuffer"),r.bindFramebuffer(e.READ_FRAMEBUFFER,st.__webglMultisampledFramebuffer),r.bindFramebuffer(e.DRAW_FRAMEBUFFER,gO(st));for(let Ve=0;Ve<j.length;Ve++){Se.push(e.COLOR_ATTACHMENT0+Ve),J.depthBuffer&&Se.push(qe);let _e=st.__ignoreDepthValues!==void 0?st.__ignoreDepthValues:!1;_e===!1&&(J.depthBuffer&&(Te|=e.DEPTH_BUFFER_BIT),J.stencilBuffer&&(Te|=e.STENCIL_BUFFER_BIT)),_e===!0&&(e.invalidateFramebuffer(e.READ_FRAMEBUFFER,[qe]),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[qe])),e.blitFramebuffer(0,0,pe,De,0,0,pe,De,Te,e.NEAREST),u&&e.invalidateFramebuffer(e.READ_FRAMEBUFFER,Se)}r.bindFramebuffer(e.READ_FRAMEBUFFER,null),r.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),r.bindFramebuffer(e.DRAW_FRAMEBUFFER,st.__webglMultisampledFramebuffer)}}function Ie(J){return Math.min(c,J.samples)}function Ee(J){let j=n.get(J);return J.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&j.__useRenderToTexture!==!1}function Be(J,j){let pe=J.colorSpace,De=J.format,Te=J.type;return J.format===Rk||pe!==Ga&&pe!==Ey&&(pe===Lo?(De!==Nd||Te!==Vn)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",pe)),j}this.allocateTextureUnit=O,this.resetTextureUnits=N,this.setTexture2D=V,this.rebindTextures=Z,this.setupRenderTarget=ce,this.updateRenderTargetMipmap=Re,this.updateMultisampleRenderTarget=he,this.useMultisampledRTT=Ee}};function gO(e){let t=e.__webglFramebuffer;if(!t||Array.isArray(t))throw new Error("THREE.WebGLTextures: expected non-array framebuffer");return t}function Ise(e){let t=e.__webglFramebuffer;if(!t||!Array.isArray(t))throw new Error("THREE.WebGLTextures: expected array framebuffer");return t}var g_=class{constructor(e,t,r){let n={},i={},o=[],a=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function s(_,w){let v=w.program;wt(v,"webglProgram"),r.uniformBlockBinding(_,v)}function l(_,w){let v=n[_.id];v===void 0&&(g(_),v=c(_),n[_.id]=v,_.addEventListener("dispose",y));let T=w.program;wt(T,"webglProgram"),r.updateUBOMapping(_,T);let M=t.render.frame;i[_.id]!==M&&(u(_),i[_.id]=M)}function c(_){let w=d();_.__bindingPointIndex=w;let v=e.createBuffer(),T=_.__size,M=_.usage;return e.bindBuffer(e.UNIFORM_BUFFER,v),e.bufferData(e.UNIFORM_BUFFER,T,M),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,w,v),v}function d(){for(let _=0;_<a;_++)if(o.indexOf(_)===-1)return o.push(_),_;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function u(_){let w=n[_.id],v=_.uniforms,T=_.__cache;if(w===void 0)throw new Error("THREE.WebGLUniformsGroups: buffer is undefined");e.bindBuffer(e.UNIFORM_BUFFER,w);for(let M=0,C=v.length;M<C;M++){let P=v[M];if(p(P,M,T)===!0){let F=P.__offset,B=Array.isArray(P.value)?P.value:[P.value],x=0;for(let L=0;L<B.length;L++){let N=B[L],O=f(N);typeof N=="number"?(P.__data[0]=N,e.bufferSubData(e.UNIFORM_BUFFER,F+x,P.__data)):N instanceof Po?(P.__data[0]=N.elements[0],P.__data[1]=N.elements[1],P.__data[2]=N.elements[2],P.__data[3]=N.elements[0],P.__data[4]=N.elements[3],P.__data[5]=N.elements[4],P.__data[6]=N.elements[5],P.__data[7]=N.elements[0],P.__data[8]=N.elements[6],P.__data[9]=N.elements[7],P.__data[10]=N.elements[8],P.__data[11]=N.elements[0]):(N.toArray(P.__data,x),x+=O.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,F,P.__data)}}e.bindBuffer(e.UNIFORM_BUFFER,null)}function p(_,w,v){let T=_.value;if(v[w]===void 0){if(typeof T=="number")v[w]=T;else{let M=Array.isArray(T)?T:[T],C=[];for(let P=0;P<M.length;P++){let F=M[P];C.push(typeof F=="number"?F:F.clone())}v[w]=C}return!0}else if(typeof T=="number"){if(v[w]!==T)return v[w]=T,!0}else{let M=v[w],C=Array.isArray(M)?M:[M],P=Array.isArray(T)?T:[T];for(let F=0;F<C.length;F++){let B=C[F];if(B.equals(P[F])===!1)return B.copy(P[F]),!0}}return!1}function g(_){let w=_.uniforms,v=0,T=16,M=0;for(let C=0,P=w.length;C<P;C++){let F=w[C],B={boundary:0,storage:0},x=Array.isArray(F.value)?F.value:[F.value];for(let L=0,N=x.length;L<N;L++){let O=x[L],z=f(O);B.boundary+=z.boundary,B.storage+=z.storage}if(F.__data=new Float32Array(B.storage/Float32Array.BYTES_PER_ELEMENT),F.__offset=v,C>0){M=v%T;let L=T-M;M!==0&&L-B.boundary<0&&(v+=T-M,F.__offset=v)}v+=B.storage}M=v%T,M>0&&(v+=T-M),_.__size=v,_.__cache={}}function f(_){let w={boundary:0,storage:0};return typeof _=="number"?(w.boundary=4,w.storage=4):_ instanceof Tt?(w.boundary=8,w.storage=8):_ instanceof ye||_ instanceof vt?(w.boundary=16,w.storage=12):_ instanceof pn?(w.boundary=16,w.storage=16):_ instanceof Po?(w.boundary=48,w.storage=48):_ instanceof Nt?(w.boundary=64,w.storage=64):_ instanceof Bs?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",_),w}function y(_){let w=_.target;w.removeEventListener("dispose",y);let v=o.indexOf(w.__bindingPointIndex);o.splice(v,1);let T=n[w.id];T!==void 0&&e.deleteBuffer(T),delete n[w.id],delete i[w.id]}function E(){for(let _ in n){let w=n[_];w!==void 0&&e.deleteBuffer(w)}o=[],n={},i={}}this.bind=s,this.update=l,this.dispose=E}},m_=class{constructor(e,t){function r(n,i=Ey){let o;if(n===Vn)return e.UNSIGNED_BYTE;if(n===kk)return e.UNSIGNED_SHORT_4_4_4_4;if(n===_k)return e.UNSIGNED_SHORT_5_5_5_1;if(n===dW)return e.BYTE;if(n===pW)return e.SHORT;if(n===Cy)return e.UNSIGNED_SHORT;if(n===Dk)return e.INT;if(n===Ac)return e.UNSIGNED_INT;if(n===Xl)return e.FLOAT;if(n===Sy)return e.HALF_FLOAT;if(n===uW)return e.ALPHA;if(n===Nd)return e.RGBA;if(n===hW)return e.LUMINANCE;if(n===gW)return e.LUMINANCE_ALPHA;if(n===Yp)return e.DEPTH_COMPONENT;if(n===gh)return e.DEPTH_STENCIL;if(n===Rk)return o=t.get("EXT_sRGB"),o!==null?o.SRGB_ALPHA_EXT:null;if(n===mW)return e.RED;if(n===Ik)return e.RED_INTEGER;if(n===fW)return e.RG;if(n===Ak)return e.RG_INTEGER;if(n===Mk)return e.RGBA_INTEGER;if(n===Gk||n===Lk||n===Pk||n===Vk)if(i===Lo)if(o=t.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(n===Gk)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Lk)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Pk)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Vk)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=t.get("WEBGL_compressed_texture_s3tc"),o!==null){if(n===Gk)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Lk)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Pk)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Vk)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===kV||n===_V||n===IV||n===AV)if(o=t.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(n===kV)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===_V)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===IV)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===AV)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===bW)return o=t.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(n===MV||n===GV)if(o=t.get("WEBGL_compressed_texture_etc"),o!==null){if(n===MV)return i===Lo?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(n===GV)return i===Lo?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===LV||n===PV||n===VV||n===OV||n===RV||n===FV||n===NV||n===BV||n===UV||n===zV||n===qV||n===HV||n===KV||n===WV)if(o=t.get("WEBGL_compressed_texture_astc"),o!==null){if(n===LV)return i===Lo?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===PV)return i===Lo?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===VV)return i===Lo?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===OV)return i===Lo?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===RV)return i===Lo?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===FV)return i===Lo?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===NV)return i===Lo?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===BV)return i===Lo?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===UV)return i===Lo?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===zV)return i===Lo?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===qV)return i===Lo?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===HV)return i===Lo?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===KV)return i===Lo?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===WV)return i===Lo?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===$V)if(o=t.get("EXT_texture_compression_bptc"),o!==null){if(n===$V)return i===Lo?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(n===jV||n===YV||n===XV||n===JV)if(o=t.get("EXT_texture_compression_rgtc"),o!==null){if(n===jV)return o.COMPRESSED_RED_RGTC1_EXT;if(n===YV)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===XV)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===JV)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Fd?e.UNSIGNED_INT_24_8:e[n]!==void 0?e[n]:null}this.convert=r}},eu=class extends Ii{constructor(){super(),this.isScene=!0,this.isScene=!0,this.type="Scene",this.background=null,this.overrideMaterial=null}},f_=class{constructor(e){let t=new WeakMap;function r(s,l){let c=s.array,d=s.usage,u=e.createBuffer();e.bindBuffer(l,u),e.bufferData(l,c,d),s.onUploadCallback();let p;if(c instanceof Float32Array)p=e.FLOAT;else if(c instanceof Uint16Array)p=e.UNSIGNED_SHORT;else if(c instanceof Int16Array)p=e.SHORT;else if(c instanceof Uint32Array)p=e.UNSIGNED_INT;else if(c instanceof Int32Array)p=e.INT;else if(c instanceof Int8Array)p=e.BYTE;else if(c instanceof Uint8Array)p=e.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:u,type:p,bytesPerElement:c.BYTES_PER_ELEMENT,version:s.version}}function n(s,l,c){let d=l.array,u=l.updateRange;e.bindBuffer(c,s),u.count===-1?e.bufferSubData(c,0,d):(e.bufferSubData(c,u.offset*d.BYTES_PER_ELEMENT,d,u.offset,u.count),u.count=-1),l.onUploadCallback()}function i(s){return t.get(s)}function o(s){let l=t.get(s);l&&(e.deleteBuffer(l.buffer),t.delete(s))}function a(s,l){let c=t.get(s);c===void 0?t.set(s,r(s,l)):c.version<s.version&&(n(c.buffer,s,l),c.version=s.version)}this.get=i,this.remove=o,this.update=a}},b_=new vt(0),y_=class{constructor(e,t,r,n,i){let o=new vt(0),a=n===!0?0:1;function s(c,d){let u=!1,p=d.isScene===!0?d.background:null;p===null?l(o,a):p&&p.isColor&&(l(p,1),u=!0),(e.autoClear||u)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil)}function l(c,d){c.getRGB(b_,FW(e)),t.buffers.color.setClear(b_.r,b_.g,b_.b,d,i)}this.getClearColor=function(){return o},this.setClearColor=function(c,d=1){o.copy(c),a=d,l(o,a)},this.getClearAlpha=function(){return a},this.setClearAlpha=function(c){a=c,l(o,a)},this.render=s}},x_=class{constructor(e,t){let r=e.getParameter(e.MAX_VERTEX_ATTRIBS),n={},i=p(null),o=i,a=!1;function s(x,L,N,O,z){let V=!1;{let $=u(O,N,L);o!==$&&(o=$,c(o.object)),V=g(x,O,N,z),V&&f(x,O,N,z)}if(z!==null&&t.update(z,e.ELEMENT_ARRAY_BUFFER),(V||a)&&(a=!1,T(x,L,N,O),z!==null)){let $=t.get(z);wt($,"indexAttributes"),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,$.buffer)}}function l(){return e.createVertexArray()}function c(x){e.bindVertexArray(x)}function d(x){return e.deleteVertexArray(x)}function u(x,L,N){let O=N.wireframe===!0?"true":"false",z=n[x.id];z===void 0&&(z={},n[x.id]=z);let V=z[L.id];V===void 0&&(V={},z[L.id]=V);let $=V[O];return $===void 0&&($=p(l()),V[O]=$),$}function p(x){let L=[],N=[],O=[];for(let z=0;z<r;z++)L[z]=0,N[z]=0,O[z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:L,enabledAttributes:N,attributeDivisors:O,object:x,attributes:{},index:null}}function g(x,L,N,O){let z=o.attributes,V=L.attributes,$=0,G=N.getAttributes();for(let W in G)if(G[W].location>=0){let U=z[W],D=V[W];if(D===void 0&&x instanceof Mi&&(W==="instanceMatrix"&&x.instanceMatrix&&(D=x.instanceMatrix),W==="instanceColor"&&x.instanceColor&&(D=x.instanceColor),W==="instancePickingColor"&&x.instancePickingColor&&(D=x.instancePickingColor)),U===void 0||U.attribute!==D||D&&U.data!==D.data)return!0;$++}return o.attributesNum!==$||o.index!==O}function f(x,L,N,O){let z={},V=L.attributes,$=0,G=N.getAttributes();for(let W in G)if(G[W].location>=0){let U=V[W];U===void 0&&x instanceof Mi&&(W==="instanceMatrix"&&x.instanceMatrix&&(U=x.instanceMatrix),W==="instanceColor"&&x.instanceColor&&(U=x.instanceColor),W==="instancePickingColor"&&x.instancePickingColor&&(U=x.instancePickingColor));let D={attribute:U};U&&"data"in U&&U.data&&(D.data=U.data),z[W]=D,$++}o.attributes=z,o.attributesNum=$,o.index=O}function y(){let x=o.newAttributes;for(let L=0,N=x.length;L<N;L++)x[L]=0}function E(x){_(x,0)}function _(x,L){let N=o.newAttributes,O=o.enabledAttributes,z=o.attributeDivisors;N[x]=1,O[x]===0&&(e.enableVertexAttribArray(x),O[x]=1),z[x]!==L&&(e.vertexAttribDivisor(x,L),z[x]=L)}function w(){let x=o.newAttributes,L=o.enabledAttributes;for(let N=0,O=L.length;N<O;N++)L[N]!==x[N]&&(e.disableVertexAttribArray(N),L[N]=0)}function v(x,L,N,O,z,V,$){$===!0?e.vertexAttribIPointer(x,L,N,z,V):e.vertexAttribPointer(x,L,N,O,z,V)}function T(x,L,N,O){y();let z=O.attributes,V=N.getAttributes(),$=L.defaultAttributeValues;for(let G in V){let W=V[G];if(W.location>=0){let U=z[G];if(U===void 0&&x instanceof Mi&&(G==="instanceMatrix"&&x.instanceMatrix&&(U=x.instanceMatrix),G==="instanceColor"&&x.instanceColor&&(U=x.instanceColor),G==="instancePickingColor"&&x.instancePickingColor&&(U=x.instancePickingColor)),U!==void 0){let D=U.normalized,de=U.itemSize,ge=t.get(U);if(ge===void 0)continue;let K=ge.buffer,se=ge.type,H=ge.bytesPerElement,Z=se===e.INT||se===e.UNSIGNED_INT||U.gpuType===Dk;if(U instanceof Eh){for(let ce=0;ce<W.locationSize;ce++)_(W.location+ce,U.meshPerAttribute);!(x instanceof Mi)&&O._maxInstanceCount===void 0&&(O._maxInstanceCount=U.meshPerAttribute*U.count)}else for(let ce=0;ce<W.locationSize;ce++)E(W.location+ce);e.bindBuffer(e.ARRAY_BUFFER,K);for(let ce=0;ce<W.locationSize;ce++)v(W.location+ce,de/W.locationSize,se,D,de*H,de/W.locationSize*ce*H,Z)}else if($!==void 0){let D=$[G];if(D!==void 0)switch(D.length){case 2:e.vertexAttrib2fv(W.location,D);break;case 3:e.vertexAttrib3fv(W.location,D);break;case 4:e.vertexAttrib4fv(W.location,D);break;default:e.vertexAttrib1fv(W.location,D)}}}}w()}function M(){F();for(let x in n){let L=n[x];for(let N in L){let O=L[N];for(let z in O){let V=O[z];wt(V,"state"),d(V.object),delete O[z]}delete L[N]}delete n[x]}}function C(x){if(n[x.id]===void 0)return;let L=n[x.id];for(let N in L){let O=L[N];for(let z in O){let V=O[z];wt(V,"state"),d(V.object),delete O[z]}delete L[N]}delete n[x.id]}function P(x){for(let L in n){let N=n[L];if(wt(N,"programMap"),N[x.id]===void 0)continue;let O=N[x.id];for(let z in O){let V=O[z];wt(V,"state"),d(V.object),delete O[z]}delete N[x.id]}}function F(){B(),a=!0,o!==i&&(o=i,c(o.object))}function B(){i.geometry=null,i.program=null,i.wireframe=!1}this.setup=s,this.reset=F,this.resetDefaultState=B,this.dispose=M,this.releaseStatesOfGeometry=C,this.releaseStatesOfProgram=P,this.initAttributes=y,this.enableAttribute=E,this.disableUnusedAttributes=w}},w_=class{constructor(){let e=new o_,t=[];function r(){t.length=0}function n(a){t.push(a)}function i(){e.setup(t)}function o(a){e.setupView(t,a)}this.state={lightsArray:t,lights:e},this.init=r,this.pushLight=n,this.setupLights=i,this.setupLightsView=o}},v_=class{constructor(){let e=new WeakMap;this.get=function(t,r=0){let n=e.get(t),i;return n===void 0?(i=new w_,e.set(t,[i])):r>=n.length?(i=new w_,n.push(i)):i=n[r],i},this.dispose=function(){e=new WeakMap}}};function u7(e){return e instanceof pn}function h7(e){return e.isLight}function Ase(e){return e.isScene}function C_(e){return e.isMesh}function mO(e){return e.isLine}function Mse(e){return e.isLineSegments}function Gse(){let e=Bk("canvas");return e.style.display="block",e}var Vy=class{constructor(e={}){let{canvas:t=Gse(),context:r=null,depth:n=!0,stencil:i=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:s=!0,preserveDrawingBuffer:l=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:d=!1}=e;this.isWebGLRenderer=!0;let u;r!==null?u=r.getContextAttributes().alpha:u=o;let p=new Uint32Array(4),g=new Int32Array(4),f=null,y=null,E=[],_=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.outputColorSpace=Lo;let w=this,v=!1,T=0,M=0,C=null,P=-1,F=null,B=new pn,x=new pn,L=null,N=t.width,O=t.height,z=1,V=null,$=null,G=new pn(0,0,N,O),W=new pn(0,0,N,O),U=!1,D=new jk,de=new Nt,ge=new ye,K=new eu;function se(){return C===null?z:1}let H={alpha:!0,depth:n,stencil:i,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:d};"setAttribute"in t&&t.setAttribute("data-engine",`three.js r${U6}`),t.addEventListener("webglcontextlost",oe,!1),t.addEventListener("webglcontextrestored",me,!1),t.addEventListener("webglcontextcreationerror",te,!1);let Z=(()=>{let X=r||t.getContext("webgl2",H);if(X===null)throw new Error("THREE.WebGLRenderer: Error creating WebGL context with your selected attributes.");return X})(),ce,Re,he,Ie,Ee,Be,J,j,pe,De,Te,Se,qe,st,Ve,_e,gt,At;function zt(){wt(Z,"gl context"),ce=new Zk(Z),Re=new Qk(Z,ce,e),ce.init(),_e=new m_(Z,ce),he=new u_(Z),Ie=new r_(Z),Ee=new c_,Be=new h_(Z,ce,he,Ee,Re,_e,Ie),J=new f_(Z),gt=new x_(Z,J),j=new e_(Z,J,Ie,gt),pe=new i_(Z,j,J,Ie),De=new l_(w,Re,gt),Te=new p_,Se=new v_,qe=new y_(w,he,pe,u,s),At=new g_(Z,Ie,he),st=new Jk(Z,Ie),Ve=new t_(Z,Ie),Ie.programs=De.programs,w.capabilities=Re,w.extensions=ce,w.properties=Ee,w.renderLists=Te,w.state=he,w.info=Ie}zt(),this.getContext=function(){return Z},this.getContextAttributes=function(){return Z.getContextAttributes()},this.forceContextLoss=function(){let X=ce.get("WEBGL_lose_context");X&&X.loseContext()},this.forceContextRestore=function(){let X=ce.get("WEBGL_lose_context");X&&X.restoreContext()},this.getPixelRatio=function(){return z},this.setPixelRatio=function(X){X!==void 0&&(z=X,this.setSize(N,O,!1))},this.getSize=function(X){return X.set(N,O)},this.setSize=function(X,fe,Oe=!0){N=X,O=fe,t.width=Math.floor(X*z),t.height=Math.floor(fe*z),Oe===!0&&(t.style.width=X+"px",t.style.height=fe+"px"),this.setViewport(0,0,X,fe)},this.getDrawingBufferSize=function(X){return X.set(N*z,O*z).floor()},this.setDrawingBufferSize=function(X,fe,Oe){N=X,O=fe,z=Oe,t.width=Math.floor(X*Oe),t.height=Math.floor(fe*Oe),this.setViewport(0,0,X,fe)},this.getCurrentViewport=function(X){return X.copy(B)},this.getViewport=function(X){return X.copy(G)},this.setViewport=function(X,fe,Oe,we){u7(X)?G.set(X.x,X.y,X.z,X.w):G.set(X,fe,Oe,we),he.viewport(B.copy(G).multiplyScalar(z).floor())},this.getScissor=function(X){return X.copy(W)},this.setScissor=function(X,fe,Oe,we){u7(X)?W.set(X.x,X.y,X.z,X.w):W.set(X,fe,Oe,we),he.scissor(x.copy(W).multiplyScalar(z).floor())},this.getScissorTest=function(){return U},this.setScissorTest=function(X){he.setScissorTest(U=X)},this.setOpaqueSort=function(X){V=X},this.setTransparentSort=function(X){$=X},this.getClearColor=function(X){return X.copy(qe.getClearColor())},this.setClearColor=function(...X){qe.setClearColor.apply(qe,X)},this.getClearAlpha=function(){return qe.getClearAlpha()},this.setClearAlpha=function(...X){qe.setClearAlpha.apply(qe,X)},this.clear=function(X=!0,fe=!0,Oe=!0){let we=0;if(X){let Ge=!1;if(C!==null){let Je=C.texture.format;Ge=Je===Mk||Je===Ak||Je===Ik}if(Ge){wt(C,"render target");let Je=C.texture.type,ut=Je===Vn||Je===Ac||Je===Cy||Je===Fd||Je===kk||Je===_k,St=qe.getClearColor(),Lt=qe.getClearAlpha(),dt=St.r,ft=St.g,kt=St.b;ut?(p[0]=dt,p[1]=ft,p[2]=kt,p[3]=Lt,Z.clearBufferuiv(Z.COLOR,0,p)):(g[0]=dt,g[1]=ft,g[2]=kt,g[3]=Lt,Z.clearBufferiv(Z.COLOR,0,g))}else we|=Z.COLOR_BUFFER_BIT}fe&&(we|=Z.DEPTH_BUFFER_BIT),Oe&&(we|=Z.STENCIL_BUFFER_BIT),Z.clear(we)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",oe,!1),t.removeEventListener("webglcontextrestored",me,!1),t.removeEventListener("webglcontextcreationerror",te,!1),Te.dispose(),Se.dispose(),Ee.dispose(),pe.dispose(),gt.dispose(),At.dispose(),De.dispose()};function oe(X){X.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),v=!0}function me(){console.log("THREE.WebGLRenderer: Context Restored."),v=!1;let X=Ie.autoReset;zt(),Ie.autoReset=X}function te(X){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",X.statusMessage)}function ae(X){let fe=X.target;fe.removeEventListener("dispose",ae),He(fe)}function He(X){Ue(X),Ee.remove(X)}function Ue(X){let fe=Ee.get(X).programs;fe!==void 0&&(fe.forEach(Oe=>{De.releaseProgram(Oe)}),De.releaseShaderCache(X))}this.renderBufferDirect=function(X,fe,Oe,we,Ge,Je){fe===null&&(fe=K);let ut=!!C_(Ge)&&Ge.matrixWorld.determinant()<0,St=at(X,fe,we,Ge);he.setMaterial(we,ut);let Lt=Oe.index,dt=1;if(we.wireframe===!0){if(Lt=j.getWireframeAttribute(Oe),Lt===void 0)return;dt=2}let ft=Oe.attributes.position,kt=0,Ct=1/0*dt;Je!==null&&(kt=Math.max(kt,Je.start*dt),Ct=Math.min(Ct,(Je.start+Je.count)*dt)),Lt!==null?(kt=Math.max(kt,0),Ct=Math.min(Ct,Lt.count)):ft!=null&&(kt=Math.max(kt,0),Ct=Math.min(Ct,ft.count));let ur=Ct-kt;if(ur<0||ur===1/0)return;wt(St,"program"),gt.setup(Ge,we,St,Oe,Lt);let Bt,Ot=st;if(Lt!==null&&(Bt=J.get(Lt),Ot=Ve,wt(Bt,"attribute"),Ve.setIndex(Bt)),C_(Ge)?we.wireframe===!0?(he.setLineWidth(se()),Ot.setMode(Z.LINES)):Ot.setMode(Z.TRIANGLES):mO(Ge)&&(he.setLineWidth(se()),Mse(Ge)?Ot.setMode(Z.LINES):Ot.setMode(Z.LINE_STRIP)),Ge instanceof Mi)Ot.renderInstances(kt,ur,Ge.count);else if(Oe instanceof Ly){let pr=Oe._maxInstanceCount!==void 0?Oe._maxInstanceCount:1/0,Gr=Math.min(Oe.instanceCount,pr);Ot.renderInstances(kt,ur,Gr)}else Ot.render(kt,ur)},this.compile=function(X,fe){function Oe(we,Ge,Je){we.transparent===!0&&we.side===ua&&we.forceSinglePass===!1?(we.side=lm,we.needsUpdate=!0,ar(we,Ge,Je),we.side=Wv,we.needsUpdate=!0,ar(we,Ge,Je),we.side=ua):ar(we,Ge,Je)}y=Se.get(X),y.init(),_.push(y),X.traverseVisible(we=>{wt(y,"render state"),h7(we)&&we.layers.test(fe.layers)&&y.pushLight(we)}),y.setupLights(),X.traverse(we=>{let Ge=we.material;if(Ge){if(!C_(we)&&!mO(we))throw new Error(`THREE.WebGLRenderer: Object of type ${we.type} has material but no geometry.`);if(Array.isArray(Ge))for(let Je=0;Je<Ge.length;Je++){let ut=Ge[Je];Oe(ut,X,we)}else Oe(Ge,X,we)}}),_.pop(),y=null},this.render=function(X,fe){if(fe!==void 0&&fe.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}v!==!0&&(X.matrixWorldAutoUpdate===!0&&X.updateMatrixWorld(),fe.parent===null&&fe.matrixWorldAutoUpdate===!0&&fe.updateMatrixWorld(),y=Se.get(X,_.length),y.init(),_.push(y),de.multiplyMatrices(fe.projectionMatrix,fe.matrixWorldInverse),D.setFromProjectionMatrix(de),f=Te.get(X,E.length),f.init(),E.push(f),It(X,fe,0,w.sortObjects),f.finish(),w.sortObjects===!0&&f.sort(V,$),this.info.render.frame++,this.info.autoReset===!0&&this.info.reset(),qe.render(f,X),y.setupLights(),it(f,X,fe),C!==null&&(Be.updateMultisampleRenderTarget(C),Be.updateRenderTargetMipmap(C)),gt.resetDefaultState(),P=-1,F=null,_.pop(),_.length>0?y=_[_.length-1]:y=null,E.pop(),E.length>0?f=E[E.length-1]:f=null)};function It(X,fe,Oe,we){if(X.visible===!1)return;if(X.layers.test(fe.layers)){if(wt(y,"render state"),X.isGroup)Oe=X.renderOrder;else if(h7(X))y.pushLight(X);else if((C_(X)||mO(X))&&(wt(f,"render list"),!X.frustumCulled||D.intersectsObject(X))){let Je=pe.update(X),ut=X.material;if(wt(ut,"material"),we&&(Je.boundingSphere===null&&Je.computeBoundingSphere(),ge.copy(Je.boundingSphere.center),ge.applyMatrix4(X.matrixWorld).applyMatrix4(de)),Array.isArray(ut)){let St=Je.groups;for(let Lt=0,dt=St.length;Lt<dt;Lt++){let ft=St[Lt],kt=ft.materialIndex&&ut[ft.materialIndex];kt&&kt.visible&&f.push(X,Je,kt,Oe,ge.z,ft)}}else ut.visible&&f.push(X,Je,ut,Oe,ge.z,null)}}let Ge=X.children;for(let Je=0,ut=Ge.length;Je<ut;Je++)It(Ge[Je],fe,Oe,we)}function it(X,fe,Oe,we){let Ge=X.opaque,Je=X.transparent;wt(y,"render state"),y.setupLightsView(Oe),Ge.length>0&&Cr(Ge,fe,Oe),Je.length>0&&Cr(Je,fe,Oe),he.buffers.depth.setTest(!0),he.buffers.depth.setMask(!0),he.buffers.color.setMask(!0),he.setPolygonOffset(!1)}function Cr(X,fe,Oe){let we=Ase(fe)?fe.overrideMaterial:null;for(let Ge=0,Je=X.length;Ge<Je;Ge++){let ut=X[Ge],St=ut.object,Lt=ut.geometry,dt=we===null?ut.material:we,ft=ut.group;St.layers.test(Oe.layers)&&Gt(St,fe,Oe,Lt,dt,ft)}}function Gt(X,fe,Oe,we,Ge,Je){X.modelViewMatrix.multiplyMatrices(Oe.matrixWorldInverse,X.matrixWorld),X.normalMatrix.getNormalMatrix(X.modelViewMatrix),Ge.transparent===!0&&Ge.side===ua&&Ge.forceSinglePass===!1?(Ge.side=lm,Ge.needsUpdate=!0,w.renderBufferDirect(Oe,fe,we,Ge,X,Je),Ge.side=Wv,Ge.needsUpdate=!0,w.renderBufferDirect(Oe,fe,we,Ge,X,Je),Ge.side=ua):w.renderBufferDirect(Oe,fe,we,Ge,X,Je)}function ar(X,fe,Oe){fe.isScene!==!0&&(fe=K);let we=Ee.get(X);wt(y,"render state");let Ge=y.state.lights,Je=Ge.state.version,ut=De.getParameters(X,Ge.state,fe,Oe),St=De.getProgramCacheKey(ut),Lt=we.programs;Lt===void 0&&(X.addEventListener("dispose",ae),Lt=new Map,we.programs=Lt);let dt=Lt.get(St);if(dt!==void 0){if(we.currentProgram===dt&&we.lightsStateVersion===Je)return Vt(X,ut),dt}else ut.uniforms=De.getUniforms(X),dt=De.acquireProgram(ut,St),Lt.set(St,dt),we.uniforms=ut.uniforms;let ft=we.uniforms;wt(ft,"uniforms"),Vt(X,ut),we.needsLights=ue(X),we.lightsStateVersion=Je,we.needsLights&&(ft.ambientLightColor.value=Ge.state.ambient,ft.directionalLights.value=Ge.state.directional);let kt=dt.getUniforms(),Ct=Th.seqWithValue(kt.seq,ft);return we.currentProgram=dt,we.uniformsList=Ct,dt}function Vt(X,fe){let Oe=Ee.get(X);Oe.outputColorSpace=fe.outputColorSpace,Oe.instancing=fe.instancing,Oe.instancingColor=fe.instancingColor,Oe.instancingPickingColor=fe.instancingPickingColor}function at(X,fe,Oe,we){var Ge;fe.isScene!==!0&&(fe=K),Be.resetTextureUnits();let Je=C===null?w.outputColorSpace:Ga,ut=Ee.get(Oe);wt(y,"render state");let St=y.state.lights,Lt=!1;Oe.version===ut.__version?(ut.needsLights&&ut.lightsStateVersion!==St.state.version||ut.outputColorSpace!==Je||we instanceof Mi!=!!ut.instancing)&&(Lt=!0):(Lt=!0,ut.__version=Oe.version);let dt=ut.currentProgram;Lt===!0&&(dt=ar(Oe,fe,we)),Oe.exprTooComplex=((Ge=dt==null?void 0:dt.diagnostics)==null?void 0:Ge.exprTooComplex)===!0;let ft=!1,kt=!1,Ct=!1;wt(dt,"program");let ur=dt.getUniforms(),Bt=ut.uniforms;if(he.useProgram(dt.program)&&(ft=!0,kt=!0,Ct=!0),Oe.id!==P&&(P=Oe.id,kt=!0),ft||F!==X){ur.setValue(Z,"projectionMatrix",X.projectionMatrix,Be),F!==X&&(F=X,kt=!0,Ct=!0);let pr=ur.map.cameraPosition;pr!==void 0&&pr.setValue(Z,ge.setFromMatrixPosition(X.matrixWorld),Be),ur.setValue(Z,"isOrthographic",X instanceof Xp,Be),ur.setValue(Z,"viewMatrix",X.matrixWorldInverse,Be)}kt&&(ut.needsLights&&(wt(Bt,"m_uniforms"),We(Bt,Ct)),Oe.uniformsNeedUpdate=!1,wt(ut.uniformsList,"uniformsList"),wt(Bt,"m_uniforms"),Th.upload(Z,ut.uniformsList,Bt,Be)),Oe.uniformsNeedUpdate===!0&&(wt(ut.uniformsList,"uniformsList"),wt(Bt,"m_uniforms"),Th.upload(Z,ut.uniformsList,Bt,Be),Oe.uniformsNeedUpdate=!1),ur.setValue(Z,"dcgModelMatrix",we.dcgModelMatrix,Be),ur.setValue(Z,"modelViewMatrix",we.modelViewMatrix,Be),ur.setValue(Z,"pickingColor",we.pickingColor||[0,0,0,0],Be),ur.setValue(Z,"normalMatrix",we.normalMatrix,Be);let Ot=Oe.uniformsGroups;for(let pr=0,Gr=Ot.length;pr<Gr;pr++){let kr=Ot[pr];At.update(kr,dt),At.bind(kr,dt)}return dt}function We(X,fe){X.ambientLightColor.needsUpdate=fe,X.directionalLights.needsUpdate=fe}function ue(X){return X.lights===!0}this.getActiveCubeFace=function(){return T},this.getActiveMipmapLevel=function(){return M},this.getRenderTarget=function(){return C},this.setRenderTarget=function(X,fe=0,Oe=0){C=X,T=fe,M=Oe;let we=!0,Ge=null;if(X){let Je=Ee.get(X);Je.__useDefaultFramebuffer!==void 0?(he.bindFramebuffer(Z.FRAMEBUFFER,null),we=!1):Je.__webglFramebuffer===void 0?Be.setupRenderTarget(X):Je.__hasExternalTextures&&X.depthTexture&&Be.rebindTextures(X,Ee.get(X.texture).__webglTexture,Ee.get(X.depthTexture).__webglTexture);let ut=Ee.get(X).__webglFramebuffer;X.samples>0&&Be.useMultisampledRTT(X)===!1?Ge=Ee.get(X).__webglMultisampledFramebuffer:Array.isArray(ut)?Ge=ut[Oe]:Ge=ut,B.copy(X.viewport),x.copy(X.scissor),L=X.scissorTest}else B.copy(G).multiplyScalar(z).floor(),x.copy(W).multiplyScalar(z).floor(),L=U;he.bindFramebuffer(Z.FRAMEBUFFER,Ge)&&Re.drawBuffers&&we&&he.drawBuffers(X,Ge),he.viewport(B),he.scissor(x),he.setScissorTest(L),P=-1},this.readRenderTargetPixels=function(X,fe,Oe,we,Ge,Je,ut){if(!(X&&X.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let St=Ee.get(X).__webglFramebuffer;if(St){he.bindFramebuffer(Z.FRAMEBUFFER,St);try{let Lt=X.texture,dt=Lt.format,ft=Lt.type;if(dt!==Nd&&_e.convert(dt)!==Z.getParameter(Z.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let kt=ft===Sy&&(ce.has("EXT_color_buffer_half_float")||ce.has("EXT_color_buffer_float"));if(ft!==Vn&&_e.convert(ft)!==Z.getParameter(Z.IMPLEMENTATION_COLOR_READ_TYPE)&&ft!==Xl&&!kt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}fe>=0&&fe<=X.width-we&&Oe>=0&&Oe<=X.height-Ge&&Z.readPixels(fe,Oe,we,Ge,_e.convert(dt),_e.convert(ft),Je)}finally{let Lt=C!==null?Ee.get(C).__webglFramebuffer:null;he.bindFramebuffer(Z.FRAMEBUFFER,Lt||null)}}},this.copyFramebufferToTexture=function(X,fe,Oe=0){let we=Math.pow(2,-Oe),Ge=Math.floor(fe.image.width*we),Je=Math.floor(fe.image.height*we);Be.setTexture2D(fe,0),Z.copyTexSubImage2D(Z.TEXTURE_2D,Oe,0,0,X.x,X.y,Ge,Je),he.unbindTexture()},this.copyTextureToTexture=function(X,fe,Oe,we=0){let Ge=_e.convert(Oe.format),Je=_e.convert(Oe.type);Be.setTexture2D(Oe,0),Z.pixelStorei(Z.UNPACK_FLIP_Y_WEBGL,Oe.flipY),Z.pixelStorei(Z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Oe.premultiplyAlpha),Z.pixelStorei(Z.UNPACK_ALIGNMENT,Oe.unpackAlignment),Z.texSubImage2D(Z.TEXTURE_2D,we,X.x,X.y,Ge,Je,fe.image),we===0&&Oe.generateMipmaps&&Z.generateMipmap(Z.TEXTURE_2D),he.unbindTexture()},this.initTexture=function(X){Be.setTexture2D(X,0),he.unbindTexture()},this.resetState=function(){T=0,M=0,C=null,he.reset(),gt.reset()}}get coordinateSystem(){return Jl}},Oa=class extends zk{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}},S_=class extends Bs{constructor(e,t,r,n,i,o,a,s,l){super(e,t,r,n,i,o,a,s,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},o0=class extends $k{constructor(e,t){let r=t.font.generateShapes(e,t.size),n=ie(R({},t),{depth:t.height!==void 0?t.height:50});n.bevelThickness===void 0&&(n.bevelThickness=10),n.bevelSize===void 0&&(n.bevelSize=8),n.bevelEnabled===void 0&&(n.bevelEnabled=!1),super(r,n)}},i0=class{constructor(e){this.data=e}generateShapes(e,t=100){let r=[],n=Lse(e,t,this.data);for(let i=0,o=n.length;i<o;i++)r.push(...n[i].toShapes());return r}};function Lse(e,t,r){let n=Array.from(e),i=t/r.resolution,o=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*i,a=[],s=0,l=0;for(let c=0;c<n.length;c++){let d=n[c];if(d===`
`)s=0,l-=o;else{let u=Pse(d,i,s,l,r);s+=u.offsetX,a.push(u.path)}}return a}function Pse(e,t,r,n,i){let o=i.glyphs[e]||i.glyphs["?"];if(!o)throw new Error('THREE.Font: character "'+e+'" does not exists in font family '+i.familyName+".");let a=new Kk,s,l,c,d,u,p;if(o.o){let g=o._cachedOutline||(o._cachedOutline=o.o.split(" "));for(let f=0,y=g.length;f<y;){let E=g[f++];switch(E){case"m":s=g[f++]*t+r,l=g[f++]*t+n,a.moveTo(s,l);break;case"l":s=g[f++]*t+r,l=g[f++]*t+n,a.lineTo(s,l);break;case"q":c=g[f++]*t+r,d=g[f++]*t+n,u=g[f++]*t+r,p=g[f++]*t+n,a.quadraticCurveTo(u,p,c,d);break;default:if(E)throw new Error("unrecognized action: "+E)}}}return{offsetX:o.ha*t,path:a}}qt();var{abs:g7,PI:m7}=Math;function x7(e,t,r,n){let i=f7(e,r,n),o=f7(t,r,n);return v7(i,o)}function f7(e,t,r){let n={x:(e.x-t.x)/r,y:-(e.y-t.y)/r},i=n.x*n.x+n.y*n.y,o=Math.sqrt(i);return i<1?new ye(n.x,-n.y,Math.sqrt(1-i)):new ye(n.x/o,-n.y/o,0)}function w7(e,t,r){let n=b7(e,r),i=b7(t,r);return v7(n,i)}function b7(e,t){let r={x:e.x-t.x,y:e.y-t.y},n=Math.hypot(r.x,r.y);return n===0?new ye(1,0,0):new ye(r.x/n,r.y/n,0)}function Vse(e){let t=e.elements,r=new ye(t[3],t[4],t[5]).normalize(),n=new ye(t[6],t[7],t[8]),i=new ye().crossVectors(r,n).normalize();n.crossVectors(i,r).normalize();let o=new Po;return o.set(i.x,r.x,n.x,i.y,r.y,n.y,i.z,r.z,n.z),o}function Oy(e,t){let r=e.clone().transpose(),n=new Po().multiplyMatrices(r,t),i=new Po().multiplyMatrices(n,e);return Vse(i)}function v7(e,t){let r=t.clone();r.cross(e);let n=r.length(),i=t.dot(e),o=1-i;n>0&&(r.x=r.x/n,r.y=r.y/n,r.z=r.z/n);let a=new Po;return a.set(o*r.z*r.z+i,o*r.z*r.x-n*r.y,o*r.y*r.z+n*r.x,o*r.z*r.x+n*r.y,o*r.x*r.x+i,o*r.y*r.x-n*r.z,o*r.y*r.z-n*r.x,o*r.y*r.x+n*r.z,o*r.y*r.y+i),a}var{sin:n0,cos:E_}=Math;function zd(){let e=Ry(-(11*Math.PI)/16);return fm(Math.PI/8).multiply(e)}function T_(){let e=Ry(-Math.PI/2);return fm(Math.PI/2).multiply(e)}function Ry(e){let t=new Po;return t.set(E_(e),-n0(e),0,n0(e),E_(e),0,0,0,1),t}function fm(e){let t=new Po;return t.set(E_(e),0,-n0(e),0,1,0,n0(e),0,E_(e)),t}function fO(e){let t=e.elements,r=t[0]+t[4]+t[8];if(r<3){let n=Math.acos(.5*(r-1)),i=2*n0(n),o=(t[5]-t[7])/i,a=(t[6]-t[2])/i,s=(t[1]-t[3])/i;return{axis:new ye(o,a,s),angle:n}}return{axis:new ye(0,0,-1),angle:0}}function C7(e,t){let r=__dcg_shared_module_exports__.dd(e,t),n=new Po;return n.elements=r,n}function y7(e,t){return t*Math.floor(e/t+.5)}function D_(e){let t=Df?.06:.03,r=new Nt().setFromMatrix3(e),{y:n,z:i}=new Fs(0,0,0,"YXZ").setFromRotationMatrix(r),o=y7(n,m7/2),a=y7(i,m7/2),s=g7(n-o)<t,l=g7(i-a)<t,c;if(s||l){let d=s?o:n,u=l?a:i,p=new Fs(0,d,u,"YXZ"),g=new Nt().makeRotationFromEuler(p);c=new Po().setFromMatrix4(g)}else c=e;return{matrix:c,isXYsnapped:l,isZsnapped:s}}qt();var Ose=.1,__=class{constructor(e,t){this.viewport=e,this.grapher3d=t,this.s=Ip(()=>this.grapher3d.settings.config.language)}isDefaultViewportRestored(){return this.grapher3d.isDefaultDomain()}getCurrentDomain(){var e,t;return{xmin:this.viewport.xmin,xmax:this.viewport.xmax,ymin:this.viewport.ymin,ymax:this.viewport.ymax,zmin:(e=this.viewport.zmin)!=null?e:__dcg_shared_module_exports__.xc.zmin,zmax:(t=this.viewport.zmax)!=null?t:__dcg_shared_module_exports__.xc.zmax}}animateToDomain(e){let t=this.getCurrentDomain(),r=this.grapher3d.transition;r.isZooming||(r.isZooming=!0,r.startTime=window.performance.now(),r.duration=150,r.zoom0=t,r.zoom1=e,this.grapher3d.startZoom())}setDefaultViewport(){this.animateToDomain(new __dcg_shared_module_exports__.Yd),xe(this.s("graphing-calculator-narration-viewport-default"))}setViewport(e){var t,r;if(!e.isValid({xAxisScale:"linear",yAxisScale:"linear"})||!e.isZValid())return;let n=e.toObject();e=Br.fromObject(Nse(ie(R({},n),{zmin:(t=n.zmin)!=null?t:__dcg_shared_module_exports__.xc.zmin,zmax:(r=n.zmax)!=null?r:__dcg_shared_module_exports__.xc.zmax}))),this.grapher3d.controller.getGrapher2d().viewportController.setViewport(e),this.viewport=e,this.grapher3d.controller.requestRedrawGraph()}getViewport(){return this.viewport}setScreen(){}zoom(e){let t=this.getCurrentDomain(),r=this.grapher3d.transition;switch(e){case"in":{if(r.isZooming)return;r.isZooming=!0,r.startTime=window.performance.now(),r.duration=150,r.zoom0=t,r.zoom1=a0(t,1/2),this.grapher3d.startZoom(),xe(this.s("graphing-calculator-narration-viewport-zoom-in"))}break;case"out":{if(r.isZooming)return;r.isZooming=!0,r.startTime=window.performance.now(),r.duration=150,r.zoom0=t,r.zoom1=yO(t,2,Ose),this.grapher3d.startZoom(),xe(this.s("graphing-calculator-narration-viewport-zoom-out"))}break;case"square":this.grapher3d.settings.setProperty("squareAxes",!0),this.animateToDomain(Rse(this.getCurrentDomain())),xe(this.s("graphing-calculator-narration-viewport-zoom-square"));break;case"default":this.setDefaultViewport();break;case"default3dOrientation":this.animateToOrientation(zd()),xe(this.s("graphing-calculator-narration-viewport-zoom-3d-default"));break;case"xy3dOrientation":this.animateToOrientation(T_()),xe(this.s("graphing-calculator-narration-viewport-zoom-3d-xy"));break;case"recenter":this.animateToDomain(Fse(this.getCurrentDomain())),xe(this.s("graphing-calculator-narration-viewport-zoom-recenter"));break}}animateToOrientation(e){this.grapher3d.settings.setProperty("speed3D",0),this.grapher3d.settings.setProperty("worldRotation3D",[...e.elements]),this.grapher3d.controls.animateToOrientation(e)}zoomSquareImmediately(){}remove(){}beginPanning(){}zoomCustom(e){}getProjection(){return this.grapher3d.getProjection()}panFromKeyboard(e){}};function a0(e,t,r){let{xwidth:n,ywidth:i,zwidth:o}=Bse(e);return S7(e,{xwidth:n*t,ywidth:i*t,zwidth:o*t},r)}function yO(e,t,r,n=new ye(0,0,0)){let i=new ye((e.xmax+e.xmin)/2,(e.ymax+e.ymin)/2,(e.zmax+e.zmin)/2),o=new ye(n.x<i.x?e.xmax:e.xmin,n.y<i.y?e.ymax:e.ymin,n.z<i.z?e.zmax:e.zmin),a=0;for(let d of["x","y","z"])Math.abs(o[d]-n[d])>Math.abs(a)&&i[d]!==n[d]&&(a=(o[d]-n[d])/(i[d]-n[d]));let s=i.clone().sub(n).multiplyScalar(a).add(n);s.lerp(i,1-r);for(let d of["x","y","z"]){let u=e[`${d}min`],p=e[`${d}max`];u===0||p===0?s[d]=0:u===-p&&(s[d]=i[d])}let l=a0(e,t,s),c=new ye((l.xmax+l.xmin)/2,(l.ymax+l.ymin)/2,(l.zmax+l.zmin)/2);return c.x<n.x!=i.x<n.x&&(l.xmax=.5*(l.xmax-l.xmin),l.xmin=-l.xmax),c.y<n.y!=i.y<n.y&&(l.ymax=.5*(l.ymax-l.ymin),l.ymin=-l.ymax),c.z<n.z!=i.z<n.z&&(l.zmax=.5*(l.zmax-l.zmin),l.zmin=-l.zmax),l}function Rse(e){let t=e.xmax-e.xmin;return S7(e,{xwidth:t,ywidth:t,zwidth:t})}function S7(e,{xwidth:t,ywidth:r,zwidth:n},i){let o=new __dcg_shared_module_exports__.Yd;return[o.xmin,o.xmax]=bO(e.xmin,e.xmax,t,i==null?void 0:i.x),[o.ymin,o.ymax]=bO(e.ymin,e.ymax,r,i==null?void 0:i.y),[o.zmin,o.zmax]=bO(e.zmin,e.zmax,n,i==null?void 0:i.z),o}function Fse(e){let t=new __dcg_shared_module_exports__.Yd;return t.xmax=.5*(e.xmax-e.xmin),t.xmin=-t.xmax,t.ymax=.5*(e.ymax-e.ymin),t.ymin=-t.ymax,t.zmax=.5*(e.zmax-e.zmin),t.zmin=-t.zmax,t}function Nse(e){let t=new __dcg_shared_module_exports__.Yd;return[t.xmin,t.xmax]=k_(e.xmin,e.xmax),[t.ymin,t.ymax]=k_(e.ymin,e.ymax),[t.zmin,t.zmax]=k_(e.zmin,e.zmax),t}var Mc=134e3,E7=134e-6;function T7(e,t,r,n){return r=__dcg_shared_module_exports__.Sb(r,E7,Mc),n=n!=null?n:e===0||t===0?0:(e+t)/2,e=n+(e-n)/(t-e)*r,t=e+r,[e,t]}function bO(e,t,r,n){return[e,t]=T7(e,t,r,n),k_(e,t)}function k_(e,t){e<-Mc/2&&(t<-Mc/4&&(t+=-Mc/2-e,t=Math.min(Mc/2,t)),e=-Mc/2),t>Mc/2&&(e>Mc/4&&(e+=Mc/2-t,e=Math.max(-Mc/2,e)),t=Mc/2);let r=E7*Math.max(1,Math.abs(e),Math.abs(t));return t-e<r?T7(e,t,r):[e,t]}function Bse(e){let{xmin:t,xmax:r,ymin:n,ymax:i,zmin:o,zmax:a}=e;return{xwidth:r-t,ywidth:i-n,zwidth:a-o}}var{abs:Gc,min:I7,acos:D7,hypot:A7,PI:Lc}=Math,Use=1e3,zse=.2,tu={NONE:-1,ROTATE:0},qse={type:"start"},Hse={type:"end"},k7=50,Kse=5*Math.PI/180,I_=class extends Ns{constructor(e,t,r){super(),this.worldRotation3D=zd(),this.unsnappedRotation=new Po,this.axis3D=[0,0,1],this.speed3D=0,this.touches=[],this.spinningWorld=e,this.copyWorldRotationToWorld(),this.domElement=r!==void 0?r:document,this.grapher3d=t,this.state=tu.NONE,this.lastMovedTime=0,this.lastRotateTime=0,this.lastWheelEventTime=0,this.keyStillDown=!1,this.lastAngle=0,this.useVirtualSphere=!1,this.startedOutsideVirtualSphere=!1,this.isXYsnapped=!1,this.isZsnapped=!1,this.dimensions=()=>{let i=this.domElement===document?this.domElement.body:this.domElement,o=i.clientWidth,a=i.clientHeight,s=new Tt(o/2,a/2),l=Math.min(o,a)/2;return{center:s,radius:l,height:a,width:o}},this.onContextMenu=i=>{this.grapher3d.controller.dispatch({type:"blur-focus-location",location:this.grapher3d.controller.getFocusLocation()})},this.onTapStart=i=>{var o,a;let s=i,l=Object.keys(this.touches).length;this.touches=xO(s.touches);let c=Object.keys(this.touches).length,d=t.webglLayer.getPressedAction()!==void 0;if(l<2&&c===2&&!d){this.startPinchZoom();return}if(c>1)return;let{top:u,left:p}=Gl(this.grapher3d.elt),g=this.touches[0].pageX-p,f=this.touches[0].pageY-u;if(this.isPinchZooming()||(o=this.grapher3d)!=null&&o.transition.isOrienting)return;this.grapher3d.controller.dispatch({type:"set-none-selected"}),t.webglLayer.setMouse({x:g,y:f}),t.webglLayer.pickAtMouseAndReadResults();let y=(a=t.webglLayer.getPickResult())==null?void 0:a.id;if(y){let w=t.controller.getItemModel(y);if(w&&w.type==="expression"&&$n(w))return}this.state=tu.ROTATE,this.speed3D=0,this.invert=void 0;let{center:E,radius:_}=this.dimensions();this.startedOutsideVirtualSphere=A7(g-E.x,f-E.y)>=_,this.unsnappedRotation.copy(this.worldRotation3D),this.useVirtualSphere=s.shiftKey&&this.grapher3d.settings.config.beta3d||!this.isHorizonLevel(),this.state!==tu.NONE&&(this.grapher3d.isDragging=!0,ee(document).on("dcg-tapmove",this.onTapMove),ee(document).on("dcg-tapend",this.onTapUp),ee(document).on("dcg-tapcancel",this.onTapUp),this.dispatchEvent(qse))},this.onTapMove=i=>{var o;let a=i,s=a.changedTouches[0].identifier,l=a.changedTouches[0],c=this.touches.find(E=>E.identifier===s)||l;this.touches=xO(a.touches);let{top:d,left:u}=Gl(this.grapher3d.elt),p=new Tt(c.pageX-u,c.pageY-d),g=new Tt(l.pageX-u,l.pageY-d);if(this.isPinchZooming()){this.updatePinchZoom();return}if((o=this.grapher3d)!=null&&o.transition.isOrienting||this.state!=tu.ROTATE)return;let f=g.x-p.x,y=g.y-p.y;if(f!==0||y!==0){let E,{center:_,radius:w,height:v,width:T}=this.dimensions();if(this.useVirtualSphere)E=this.startedOutsideVirtualSphere?w7(g,p,_):x7(g,p,_,w),E=Oy(this.worldRotation3D,E),this.setWorldRotation(this.worldRotation3D.multiply(E));else{if(this.invert===void 0){this.invert=g.y>_.y?1:-1;let G=new ye(0,0,1).applyMatrix3(this.worldRotation3D);G.x>.7&&(this.invert*=-1),Gc(G.x)<.7&&(this.invert=G.z<-.7?-1:1)}let x=f/T*Lc*this.invert,L=y/v*Lc,N=Ry(x),O=fm(L);O=Oy(this.unsnappedRotation,O),Gc(y)>2*Gc(f)?this.unsnappedRotation.multiply(O):Gc(f)>2*Gc(y)?this.unsnappedRotation.multiply(N):this.unsnappedRotation.multiply(O).multiply(N);let{matrix:z,isXYsnapped:V,isZsnapped:$}=D_(this.unsnappedRotation);this.setWorldRotation(z),this.isXYsnapped=V,this.isZsnapped=$,O=fm(L),O=Oy(this.worldRotation3D,O),E=Gc(y)>Gc(f)?O:N}let{axis:M,angle:C}=fO(E),P=a.timeStamp,F=(P-this.lastMovedTime)*.001;this.axis3D=[M.x,M.y,M.z],this.useVirtualSphere&&this.snapSpinAxisIfClose();let B=240*(Lc/180);this.speed3D=__dcg_shared_module_exports__.Sb(C/F,-B,B),this.lastAngle=0,this.lastMovedTime=P,Gc(this.speed3D)<Kse&&(this.speed3D=0)}else this.lastMovedTime+k7<a.timeStamp&&(this.speed3D=0)},this.onTapUp=i=>{var o;let a=i,s=Object.keys(this.touches).length;this.touches=xO(a.touches);let l=Object.keys(this.touches).length;s===2&&l<2&&this.isPinchZooming()&&this.stopPinchZoom(),!((o=this.grapher3d)!=null&&o.transition.isOrienting)&&(l>0||(this.lastMovedTime+k7<a.timeStamp&&!this.isPinchZooming()&&(this.speed3D=0),this.grapher3d.isDragging=!1,ee(document).off("dcg-tapmove",this.onTapMove),ee(document).off("dcg-tapend",this.onTapUp),ee(document).off("dcg-tapcancel",this.onTapUp),this.dispatchEvent(Hse),this.grapher3d.debounceUserRequestedRotationChange(),this.state=tu.NONE,this.grapher3d.controller.dispatch({type:"render"})))},this.onMouseWheel=i=>{var o,a;let s=i;if(this.state!==tu.NONE||this.isLocked()||s.deltaY===0)return;s.preventDefault(),this.lastWheelEventTime===0&&this.grapher3d.startZoom(),this.lastWheelEventTime=window.performance.now();let l=this.grapher3d.webglLayer.domain(),c=this.grapher3d.webglLayer.getMouse(),d=Date.now(),u=this.speed3D!==0,p=s.deltaY<0?"in":"out",g=this.currentZoomAction&&d-this.currentZoomAction.lastChangeTime>Use;if(!this.currentZoomAction||this.currentZoomAction.input.type!=="pointer"||this.currentZoomAction.input.x!==(c==null?void 0:c.x)||this.currentZoomAction.input.y!==(c==null?void 0:c.y)||this.currentZoomAction.isSpinning!==u||p==="in"&&this.currentZoomAction.initialDirection==="out"||g){let T=p==="in"?(o=this.grapher3d.webglLayer.getZoomScrollWheelPickResult())==null?void 0:o.point:void 0;this.currentZoomAction={lastChangeTime:d,start:l,input:R({type:"pointer"},c),isSpinning:u,center:T==null?void 0:T.clone(),initialDirection:p}}else this.currentZoomAction&&(this.currentZoomAction.lastChangeTime=d);let f=(a=this.currentZoomAction)==null?void 0:a.center,y=this.currentZoomAction.start.xmax-this.currentZoomAction.start.xmin,E=l.xmax-l.xmin;if(this.currentZoomAction.initialDirection==="in"&&p==="out"&&E>=y){let T=this.currentZoomAction.start;delete this.currentZoomAction,l=T,f=void 0}if(!f){let T=l.xmin<=0&&l.xmax>=0,M=l.ymin<=0&&l.ymax>=0,C=l.zmin<=0&&l.zmax>=0;T&&M&&C&&(f=new ye(0,0,0))}let _=1.05,w;p==="out"&&(!f||f.lengthSq()===0)?w=yO(l,_,zse):w=a0(l,s.deltaY<0?1/_:_,f);let v=new Br(w.xmin,w.xmax,w.ymin,w.ymax,w.zmin,w.zmax);this.updateViewport(v),this.copyWorldRotationToWorld(),this.grapher3d.webglLayer.updateAxes(),this.grapher3d.controller.dispatch({type:"render"})};let n={passive:!1};this.onTouchStart=i=>{i.preventDefault()},this.domElement.addEventListener("touchstart",this.onTouchStart,n),ee(this.domElement).on("dcg-tapstart",this.onTapStart),ee(this.domElement).on("contextmenu",this.onContextMenu),this.domElement.addEventListener("wheel",this.onMouseWheel)}keyUp(){this.keyStillDown=!1,this.speed3D&&xe(this.grapher3d.controller.s("graphing-calculator-narration-3d-rotation-speed",{speed:Math.ceil(this.speed3D*180/Lc)}))}applyTiltFromKeyboard(e,t){var r;if(this.isPinchZooming()||(r=this.grapher3d)!=null&&r.transition.isOrienting)return;this.grapher3d.controller.dispatch({type:"set-none-selected"});let n={Up:this.grapher3d.controller.s("graphing-calculator-narration-3d-rotate-up"),Down:this.grapher3d.controller.s("graphing-calculator-narration-3d-rotate-down"),Left:this.grapher3d.controller.s("graphing-calculator-narration-3d-rotate-left"),Right:this.grapher3d.controller.s("graphing-calculator-narration-3d-rotate-right")},i=l=>{let c=fm(l);c=Oy(this.unsnappedRotation,c),this.unsnappedRotation.multiply(c)},o=l=>{this.unsnappedRotation.multiply(Ry(l))},a=l=>{let c=fm(l);return Oy(this.worldRotation3D,c)},s=l=>Ry(l);if(e===this.lastKeyboardDirection&&this.keyStillDown)if(this.speed3D===0){let l,c=2*Lc/180;switch(e){case"Up":l=a(-c);break;case"Down":l=a(+c);break;case"Left":l=s(-c);break;case"Right":l=s(+c);break}let{axis:d,angle:u}=fO(l);this.axis3D=[d.x,d.y,d.z],this.speed3D=u}else{let l=240*(Lc/180);this.speed3D=__dcg_shared_module_exports__.Sb(this.speed3D*1.1,-l,l)}else if(this.speed3D)this.lastKeyboardDirection=void 0,this.keyStillDown=!0,this.speed3D=0,xe(this.grapher3d.controller.s("graphing-calculator-narration-3d-rotation-stopped"));else{this.lastKeyboardDirection=e,this.keyStillDown=!0,xe(n[e]);let l=Lc/180;switch(e){case"Up":i(-l);break;case"Down":i(+l);break;case"Left":o(-l);break;case"Right":o(+l);break}let{matrix:c,isXYsnapped:d,isZsnapped:u}=D_(this.unsnappedRotation);this.setWorldRotation(c),this.isXYsnapped=d,this.isZsnapped=u,this.lastAngle=0}}isPinchZooming(){var e;return((e=this.currentZoomAction)==null?void 0:e.input.type)==="pinch"}startPinchZoom(){if(this.isLocked()||this.isPinchZooming())return;let e=__dcg_shared_module_exports__.Jc(this.touches);this.grapher3d.controller.dispatch({type:"set-none-selected"}),this.grapher3d.startZoom(),this.currentZoomAction={lastChangeTime:Date.now(),start:this.grapher3d.webglLayer.domain(),center:void 0,input:{type:"pinch",pinchZoomStartPositions:e},isSpinning:this.speed3D!==0,initialDirection:void 0}}stopPinchZoom(){this.isPinchZooming()&&(this.currentZoomAction=void 0,this.grapher3d.endZoom(),this.grapher3d.controller.dispatch({type:"render"}))}updatePinchZoom(){var e;if(((e=this.currentZoomAction)==null?void 0:e.input.type)!=="pinch")return;let t=_7(this.currentZoomAction.input.pinchZoomStartPositions),r=_7(this.touches)/t;if(!isFinite(r))return;let n=a0(this.currentZoomAction.start,1/r),i=new Br(n.xmin,n.xmax,n.ymin,n.ymax,n.zmin,n.zmax);this.updateViewport(i),this.copyWorldRotationToWorld()}snapSpinAxisIfClose(){if(!this.grapher3d.settings.showAxis3D)return;let[e,t,r]=this.axis3D,n=.97;e>n&&(this.axis3D=[1,0,0]),t>n&&(this.axis3D=[0,1,0]),r>n&&(this.axis3D=[0,0,1]),e<-n&&(this.axis3D=[-1,0,0]),t<-n&&(this.axis3D=[0,-1,0]),r<-n&&(this.axis3D=[0,0,-1])}copyWorldRotationToWorld(){this.spinningWorld.setRotationFromMatrix(new Nt().setFromMatrix3(this.worldRotation3D))}update(){return!0}dispose(){ee(this.domElement).off("dcg-tapstart",this.onTapStart),ee(document).off("dcg-tapmove",this.onTapMove),ee(document).off("dcg-tapend",this.onTapUp),ee(document).off("dcg-tapcancel",this.onTapUp),this.domElement.removeEventListener("wheel",this.onMouseWheel),this.domElement.removeEventListener("touchstart",this.onTouchStart)}setWorldRotation(e){this.worldRotation3D=e,this.copyWorldRotationToWorld();let{isXYsnapped:t,isZsnapped:r}=D_(e);this.isXYsnapped=t,this.isZsnapped=r}isHorizonLevel(){let e=new ye(0,0,1).applyMatrix3(this.worldRotation3D);return Gc(e.y)<1e-4}compareWorldRotationTo(e){let t=new Nt().setFromMatrix3(this.worldRotation3D),r=new Nt().setFromMatrix3(e),n=new Fs(0,0,0,"YXZ").setFromRotationMatrix(t),i=new Fs().setFromRotationMatrix(r),o=new Ql().setFromEuler(n).normalize(),a=new Ql().setFromEuler(i).normalize(),s=I7(Gc(o.dot(a)),1);return 2*D7(s)*(180/Lc)}isDefaultOrientation(){let e=this.compareWorldRotationTo(zd());return this.speed3D===0&&e<1}isXYPlaneOrientation(){let e=this.compareWorldRotationTo(T_());return this.speed3D===0&&e<.001}animateToOrientation(e){let t=this.grapher3d;this.speed3D=0;let r=t.transition,n=new Nt().setFromMatrix3(this.worldRotation3D),i=new Nt().setFromMatrix3(e),o=new Fs().setFromRotationMatrix(i),a=new Fs(0,0,0,"YXZ").setFromRotationMatrix(n);r.q0.setFromEuler(a),r.q1.setFromEuler(o);let s=r.q0.clone().normalize(),l=r.q1.clone().normalize(),c=2*D7(Gc(s.dot(l)))*(180/Lc);r.isOrienting=!0,r.startTime=window.performance.now(),r.duration=150*__dcg_shared_module_exports__.Sb(c/30,1,3)}updateViewport(e){let t=this.grapher3d,r=t.controller.getGrapher2d();t.viewportController.setViewport(e),t.debounceUserRequestedViewportChange(),r.viewportController.setViewport(e),r.redrawAllLayersSynchronously(),t.webglLayer.updatePlaneMap(),t.webglLayer.updateDomainObjects()}isLocked(){return this.grapher3d.controller.getGraphSettings().userLockedViewport}},A_=class{constructor(){this.isZooming=!1,this.zoom0=new __dcg_shared_module_exports__.Yd,this.zoom1=new __dcg_shared_module_exports__.Yd,this.isOrienting=!1,this.q0=new Ql,this.q1=new Ql,this.objectIdExtendingTo3D=void 0,this.startTime=0,this.duration=0}};function M7(e){let t=e.grapher3d,r=t.transition;if(t.settings.threeDMode){if(e.lastWheelEventTime!=0&&(window.performance.now()-e.lastWheelEventTime)*.001>.1&&(e.lastWheelEventTime=0,t.endZoom()),r.isZooming){let{zoom0:n,zoom1:i}=r,o=window.performance.now(),a=I7(1,(o-r.startTime)/r.duration),s=new Br(a*i.xmin+(1-a)*n.xmin,a*i.xmax+(1-a)*n.xmax,a*i.ymin+(1-a)*n.ymin,a*i.ymax+(1-a)*n.ymax,a*i.zmin+(1-a)*n.zmin,a*i.zmax+(1-a)*n.zmax);a>=1&&(t.endZoom(),r.isZooming=!1),e.updateViewport(s)}if(r.isOrienting){let n=(window.performance.now()-r.startTime)/r.duration;if(n>=1){let i=new Nt().makeRotationFromQuaternion(r.q1);e.setWorldRotation(new Po().setFromMatrix4(i)),r.isOrienting=!1,t.controller.dispatch({type:"render"})}else{let i=r.q0.clone().slerp(r.q1,n),o=new Nt().makeRotationFromQuaternion(i);e.setWorldRotation(new Po().setFromMatrix4(o)),e.unsnappedRotation.copy(e.worldRotation3D)}}if(r.objectIdExtendingTo3D&&r.startTime>0){let n=e.grapher3d.webglLayer,i=r.objectIdExtendingTo3D,o=n.domain(),{zmin:a,zmax:s}=o,l=(window.performance.now()-r.startTime)/r.duration;l>=1?(n.setZboundsOnSurfaces(i,-1/0,1/0),r.objectIdExtendingTo3D=void 0):n.setZboundsOnSurfaces(i,l*a,l*s),t.controller.requestRedrawGraph()}if(e.speed3D===0)e.lastRotateTime=window.performance.now();else{let n=window.performance.now(),i=(n-e.lastRotateTime)*.001,o=e.lastRotateTime!=0&&i<2?i*e.speed3D:0;if(o>20*Lc/180&&(o=20*Lc/180),e.state===tu.NONE){let a=e.axis3D,s=new ye(a[0],a[1],a[2]),l=C7(s,o);e.setWorldRotation(e.worldRotation3D.multiply(l)),e.unsnappedRotation.copy(e.worldRotation3D)}e.lastRotateTime=n,e.lastAngle=o}}}function _7(e){return e.length!==2?NaN:A7(e[0].pageX-e[1].pageX,e[0].pageY-e[1].pageY)}function xO(e){return __dcg_shared_module_exports__.Jc(e)}function G7(e,t=.01*(e.xmax-e.xmin)){return t*=2,Math.abs(e.xmin+e.xmax)<=t&&Math.abs(e.ymin+e.ymax)<=t&&Math.abs(e.zmin+e.zmax)<=t}Ss();var wO=[];function L7(e){return wO[e]===void 0&&(wO[e]=Wse(e)),wO[e]}function Wse(e){let t=Math.SQRT1_2,r=[0,0,1,0,0,-1,-t,-t,0,t,-t,0,t,t,0,-t,t,0],n=[0,3,4,0,4,5,0,5,2,0,2,3,1,4,3,1,5,4,1,2,5,1,3,2];function i(o){let a=r.length/3;for(let s=0;s<a;s++)if(o.x===r[3*s+0]&&o.y===r[3*s+1]&&o.z===r[3*s+2])return s;return r.push(o.x,o.y,o.z),a}for(let o=0;o<e;o++){let a=n.length/3;for(let s=0;s<a;s++){let l=n[3*s+0],c=n[3*s+1],d=n[3*s+2],u=new __dcg_shared_module_exports__.cd(r[3*l+0],r[3*l+1],r[3*l+2]),p=new __dcg_shared_module_exports__.cd(r[3*c+0],r[3*c+1],r[3*c+2]),g=new __dcg_shared_module_exports__.cd(r[3*d+0],r[3*d+1],r[3*d+2]),f=new __dcg_shared_module_exports__.cd().addVectors(u,p).multiply(.5).normalize(),y=new __dcg_shared_module_exports__.cd().addVectors(p,g).multiply(.5).normalize(),E=new __dcg_shared_module_exports__.cd().addVectors(g,u).multiply(.5).normalize(),_=i(f),w=i(y),v=i(E);n.push(l,_,v,_,c,w,w,d,v),n[3*s+0]=_,n[3*s+1]=w,n[3*s+2]=v}}return{vertices:new Float32Array(r),indices:new Uint16Array(n)}}var P7={name:"FillShader",defines:{},uniforms:{color:{value:new vt(16777215)},opacity:{value:1}},vertexShader:`
		void main() {
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`
		uniform vec3 color;
		uniform float opacity;
		void main() {
			gl_FragColor = vec4( color, opacity );
		}`},M_=class{constructor(){}setSize(e,t){}dispose(){}},$se=new Xp(-1,1,1,-1,0,1),G_=class{constructor(e){let t=new La;t.setAttribute("position",new Bo([-1,3,0,-1,-1,0,3,-1,0],3)),t.setAttribute("uv",new Bo([0,2,0,0,2,0],2)),this._mesh=new Ai(t,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,$se)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}},bl=class extends M_{constructor(e,t={},r="tDiffuse"){super(),this.inputTextureName=r,this.uniforms=Sh(e.uniforms),this.defines=e.defines?R({},e.defines):{},this.material=new Zl(ie(R({},t),{name:e.name!==void 0?e.name:"unspecified",defines:this.defines,uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsTriangle=new G_(this.material)}render(e,t,r){this.renderFromTexture(e,t,r.texture)}renderFromTexture(e,t,r){this.uniforms[this.inputTextureName]&&(this.uniforms[this.inputTextureName].value=r),this.fsTriangle.material=this.material,e.setRenderTarget(t),this.fsTriangle.render(e)}dispose(){this.material.dispose(),this.fsTriangle.dispose()}};function L_(e,t,r=0,n=0,i=t.width,o=t.height,a=new Uint8ClampedArray(4*i*o)){return e.readRenderTargetPixels(t,r,n,i,o,a),a}function l0(e,t,r,n){let i=4*(n*t+r);return[e[i],e[i+1],e[i+2],e[i+3]]}var s0=new Uint8Array(4),jse=new Float32Array(s0.buffer);function P_([e,t,r,n]){return s0[0]=n,s0[1]=r,s0[2]=t,s0[3]=e,jse[0]}function Yse(e){let t=e.getContext();if(!(t instanceof WebGL2RenderingContext))throw new Error("WebGL2 is required for waitForFullFlush");return t}function V7(e){return Fr(this,null,function*(){let t=Yse(e),r=t.fenceSync(t.SYNC_GPU_COMMANDS_COMPLETE,0);if(!r)throw new Error("Failed to create sync object");t.flush();let n=yield O7(t,r,0,0);return t.deleteSync(r),n})}function O7(e,t,r,n){let i=performance.now();return new Promise((o,a)=>{function s(){let l=e.clientWaitSync(t,r,0);if(l===e.WAIT_FAILED){a();return}if(l===e.TIMEOUT_EXPIRED){i=performance.now(),setTimeout(s,n);return}o([i,performance.now()])}s()})}function Xse(e,t,r,n,i,o,a){return Fr(this,null,function*(){let s=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);if(!s)throw new Error("Failed to create sync object");e.flush(),yield O7(e,s,0,10),e.deleteSync(s),e.bindBuffer(t,r),e.getBufferSubData(t,n,i,o,a),e.bindBuffer(t,null)})}function R7(e,t,r,n,i,o,a,s){return Fr(this,null,function*(){let l=e.createBuffer();if(!l)throw new Error("Failed to create buffer");return e.bindBuffer(e.PIXEL_PACK_BUFFER,l),e.bufferData(e.PIXEL_PACK_BUFFER,s.byteLength,e.STREAM_READ),e.readPixels(t,r,n,i,o,a,0),e.bindBuffer(e.PIXEL_PACK_BUFFER,null),yield Xse(e,e.PIXEL_PACK_BUFFER,l,0,s),e.deleteBuffer(l),s})}var vO;function F7(){if(vO)return vO;let e=new bl(P7),t=1,r=1,n=1,i=0,o=e.material;o.uniforms.color.value=new vt().setRGB(t,r,n),o.uniforms.opacity.value=i,o.blending=vk,o.blendEquation=Od,o.blendSrc=Sk,o.blendDst=Ck;let a=new Vy,s=a.getContext(),l=[Xl,Sy,Vn],c=[s.FLOAT,s.HALF_FLOAT,s.UNSIGNED_BYTE],d=[new Float32Array(4),new Uint16Array(4),new Uint8Array(4)],u=[1,15360,255],p=[];for(let g=0;g<l.length;g++){let f=new Oa(1,1,{minFilter:Rd,magFilter:Rd,type:l[g],format:Nd,stencilBuffer:!1,depthBuffer:!0});e.render(a,f,new Oa),s.readPixels(0,0,1,1,s.RGBA,c[g],d[g]);let y=[...d[g]];y[0]/=u[g],y[1]/=u[g],y[2]/=u[g],y[3]/=u[g];let E=(w,v,T=.01)=>w<v+T&&w>v-T,_=s.checkFramebufferStatus(s.FRAMEBUFFER)===s.FRAMEBUFFER_COMPLETE;_=_&&E(y[0],t),_=_&&E(y[1],r),_=_&&E(y[2],n),_=_&&E(y[3],i),_=_||g===l.length-1,f.dispose(),_&&p.push(l[g])}return e.dispose&&e.dispose(),vO=p,p}var CO;function Jse(){if(!CO){let e=document.createElement("div");e.className="dcg-3d-debug-root",document.body.appendChild(e),CO=e}return CO}var V_=class{constructor({filter:e}){this.canvases={},e?(this.enabled=!0,this.filter=new RegExp(e)):this.enabled=!1}removeUnused(){for(let e in this.canvases)this.canvases[e].used?this.canvases[e].used=!1:(this.canvases[e].container.remove(),delete this.canvases[e])}get(e,t){let r=t?`${e} ${t}`:e;if(!(!this.enabled||!this.filter.test(r)))return this.canvases[e]||(this.canvases[e]=new SO),this.canvases[e].setLabel(r),this.canvases[e].used=!0,this.canvases[e]}},SO=class{constructor(){this.container=document.createElement("div"),this.container.className="dcg-3d-debug-container",this.canvas=document.createElement("canvas"),this.container.appendChild(this.canvas),Jse().appendChild(this.container)}setLabel(e){this.container.setAttribute("dcg-label",e)}renderRawData(e,t,r,n){var i;let o=new ImageData(e,t,r);this.canvas.width=t,this.canvas.height=r,this.container.style.width=t*n+"px",this.container.style.height=r*n+"px",(i=this.canvas.getContext("2d"))==null||i.putImageData(o,0,0)}renderFromTarget(e,t,r){this.renderRawData(L_(e,t),t.width,t.height,r)}},N7=`{
  "glyphs": {
    "x": {
      "x_min": 0,
      "x_max": 675,
      "ha": 764,
      "o": "m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "
    },
    "y": {
      "x_min": 0,
      "x_max": 684.78125,
      "ha": 771,
      "o": "m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "
    },
    "z": {
      "x_min": -0.015625,
      "x_max": 613.890625,
      "ha": 697,
      "o": "m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "
    }
  },
  "cssFontWeight": "normal",
  "ascender": 1189,
  "underlinePosition": -100,
  "cssFontStyle": "normal",
  "boundingBox": { "yMin": -334, "xMin": -111, "yMax": 1189, "xMax": 1672 },
  "resolution": 1000,
  "original_font_information": {
    "postscript_name": "Helvetiker-Regular",
    "version_string": "Version 1.00 2004 initial release",
    "vendor_url": "http://www.magenta.gr/",
    "full_font_name": "Helvetiker",
    "font_family_name": "Helvetiker",
    "copyright": "Copyright (c) Μagenta ltd, 2004",
    "description": "",
    "trademark": "",
    "designer": "",
    "designer_url": "",
    "unique_font_identifier": "Μagenta ltd:Helvetiker:22-10-104",
    "license_url": "http://www.ellak.gr/fonts/MgOpen/license.html",
    "license_description": "Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\\r\\n\\r\\nPermission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license (\\"Fonts\\") and associated documentation files (the \\"Font Software\\"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \\r\\n\\r\\nThe above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\\r\\n\\r\\nThe Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word \\"MgOpen\\", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\\r\\n\\r\\nThis License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the \\"MgOpen\\" name.\\r\\n\\r\\nThe Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \\r\\n\\r\\nTHE FONT SOFTWARE IS PROVIDED \\"AS IS\\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.",
    "manufacturer_name": "Μagenta ltd",
    "font_sub_family_name": "Regular"
  },
  "descender": -334,
  "familyName": "Helvetiker",
  "lineHeight": 1522,
  "underlineThickness": 50
}
`,B7=`// License: MIT License (c) 2014 Mikola Lysenko
// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl

#define FLOAT_MAX  1.70141184e38
#define FLOAT_MIN  1.17549435e-38

lowp vec4 encode_float(highp float v) {
  highp float av = abs(v);

  //Handle special cases
  if(av < FLOAT_MIN) {
    return vec4(0.0, 0.0, 0.0, 0.0);
  } else if(v > FLOAT_MAX) {
    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;
  } else if(v < -FLOAT_MAX) {
    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;
  }

  highp vec4 c = vec4(0,0,0,0);

  //Compute exponent and mantissa
  highp float e = floor(log2(av));
  highp float m = av * pow(2.0, -e) - 1.0;

  //Unpack mantissa
  c[1] = floor(128.0 * m);
  m -= c[1] / 128.0;
  c[2] = floor(32768.0 * m);
  m -= c[2] / 32768.0;
  c[3] = floor(8388608.0 * m);

  //Unpack exponent
  highp float ebias = e + 127.0;
  c[0] = floor(ebias / 2.0);
  ebias -= c[0] * 2.0;
  c[1] += floor(ebias) * 128.0;

  //Unpack sign bit
  c[0] += 128.0 * step(0.0, -v);

  //Scale back to range
  return c / 255.0;
}
`,Fy=`
uniform int uDepthPeel; // 1 or 0
uniform vec2 uInverseScreenSize;
uniform highp sampler2D uOpaqueDepthTexture;
uniform highp sampler2D uPrevDepthTexture;
uniform int uDepthPeelLayer;
uniform float uDepthOffset;
`,Ny=`
  if (uDepthPeel != 0) {
    vec2 screenPos = gl_FragCoord.xy * uInverseScreenSize;
    float opaqueDepth = texture2D(uOpaqueDepthTexture, screenPos).x;
    if (opaqueDepth + uDepthOffset - gl_FragCoord.z < 0.0) {
      discard;
    }

    if(uDepthPeelLayer != 0){
      vec4 texel = texture2D(uPrevDepthTexture,screenPos);
      float prevDepth = texel.x;
      if(prevDepth + uDepthOffset - gl_FragCoord.z >= 0. ){
        discard;
      }
    }
  }
`,gs={Default:0,PickingObjectId:1,PickingX:2,PickingY:3,PickingZ:4,Depth:5};function O_(){return{zMinForAnimation:{value:-1/0},zMaxForAnimation:{value:1/0},clip_x:{value:!0},clip_y:{value:!0},clip_z:{value:!0},NaN:{value:NaN},Infinity:{value:1/0}}}var EO=`
#ifdef DCG_SUPPORTS_PICKING
  uniform vec4 pickingColor;
  ${B7}
#endif
`,R_=`#ifdef DCG_SUPPORTS_PICKING
if (dcgRenderMode == ${gs.PickingObjectId}) {
  #if defined(USE_INSTANCING_PICKINGCOLOR) || defined(USE_VERTEX_PICKING_COLOR)
  gl_FragColor = vPickingColor;
  #else
  gl_FragColor = pickingColor;
  #endif
  return;
} else if (dcgRenderMode == ${gs.PickingX}) {
  gl_FragColor = encode_float(vPosition.x);
  return;
} else if (dcgRenderMode == ${gs.PickingY}) {
  gl_FragColor = encode_float(vPosition.y);
  return;
} else if (dcgRenderMode == ${gs.PickingZ}) {
  gl_FragColor = encode_float(vPosition.z);
  return;
}
#endif
`,ele=`  varying vec3 vPosition;
  uniform bool clip_x;
  uniform bool clip_y;
  uniform bool clip_z;
  uniform float xMin;
  uniform float xMax;
  uniform float yMin;
  uniform float yMax;
  uniform float zMin;
  uniform float zMax;
  uniform float zMinForAnimation;
  uniform float zMaxForAnimation;
  uniform int dcgRenderMode;

  ${EO}
`,tle=`  if (clip_x && (vPosition.x < xMin || vPosition.x > xMax)) {discard;}
  if (clip_y && (vPosition.y < yMin || vPosition.y > yMax)) {discard;}
  if (clip_z && (vPosition.z < zMin || vPosition.z > zMax)) {discard;}
  if ((vPosition.z < zMinForAnimation) || (vPosition.z > zMaxForAnimation)) {discard;}
`,Dh=`  gl_FragColor = LinearTosRGB( gl_FragColor );
`;function F_({variant:e,uvArgs:t,extraMeshArgs:r,restrictionShader:n}){let i;e.type==="colorFunc"?i=`      vec3 color = getColor();
      if (isnan(color.x) || isnan(color.y) || isnan(color.z)) {discard;}
      vec4 diffuseColor = vec4(color.x, color.y, color.z, opacity );`:i="vec4 diffuseColor = vec4( diffuse, opacity );";let o=e.type==="colorFunc"?__dcg_shared_module_exports__.Gc`vec3 getColor() {
            ${U7(t,e.colorShader.source)}
            ${z7(r,e.colorShader.source)}
            ${e.colorShader.source}
            }\n`:"",a=[n].concat(e.type==="colorFunc"?[e.colorShader]:[]),s=__dcg_shared_module_exports__.Hc(...a.map(M=>M==null?void 0:M.shaderFunctions))+`
`+o+rle(n,U7(t,n==null?void 0:n.source),r),l=ole(n)+Ny+i,c=/\bvUV\b/.test(s)||/\bvUV\b/.test(l),d=[void 0,"float","vec2","vec3"][r.length],u=d&&(/\bvExtras\b/.test(s)||/\bvExtras\b/.test(l)),p=__dcg_shared_module_exports__.Ic(n==null?void 0:n.shaderUniforms),g=p.uniforms,f=p.declarations,y=`    ${__dcg_shared_module_exports__.Fc}
    ${f}
    ${c?`varying vec2 vUV;
`:""}
    ${u?`varying ${d} vExtras;
`:""}
    ${Fy}
    ${s}
`,E=(c?`varying vec2 vUV;
`:"")+(u?`attribute ${d} extras;
`:"")+(u?`varying ${d} vExtras;
`:"")+`varying vec3 vPosition;
uniform mat4 dcgModelMatrix;
`,_=`    ${u?"  vExtras = extras; ":""}
    ${c?"  vUV = uv; ":""}
    #ifdef USE_INSTANCING
      vPosition = (instanceMatrix * vec4( position, 1.0 )).xyz;
    #else
      vPosition = (dcgModelMatrix * vec4( position, 1.0 )).xyz;
    #endif
  `,w=e.type==="colorFunc"?"color::"+e.colorCacheKey+"::"+t.join(","):e.type,v=n?"::"+n.source:"",T=w+v;return{fragmentDeclarations:ele+y,fragmentColorChunk:tle+l,vertexDeclarations:E,vertexPositionChunk:_,cacheKey:T,glslUniforms:g}}function U7(e,t){let r=c=>c==="x"||c==="y"||c==="z",n=e[0],i=e[1],o=new RegExp(`\\b${n}\\b`),a=new RegExp(`\\b${i}\\b`),s=n!==void 0&&!r(n)&&t&&o.test(t),l=i!==void 0&&!r(i)&&t&&a.test(t);return(s?[`float ${n} = vUV.x;`]:[]).concat(l?[`float ${i} = vUV.y;`]:[]).join(`
`)}function z7(e,t){let r=n=>new RegExp(`\\b${n}\\b`).test(t);return["float x = vPosition.x;","float y = vPosition.y;","float z = vPosition.z;"].concat(e.length===1?r(e[0])?`float ${e[0]} = vExtras;`:"":e.map((n,i)=>r(n)?`float ${n} = vExtras.${"xyz"[i]};`:"")).join(`
`)}function rle(e,t,r){return e?__dcg_shared_module_exports__.Gc`bool restriction() {
      ${t}
      ${z7(r,e.source)}
      ${e.source}
      }\n`:""}function ole(e){return e?"if (!restriction()) {discard;}":""}function q7(e){let{cacheKey:t,vertexPositionChunk:r,vertexDeclarations:n,fragmentColorChunk:i,fragmentDeclarations:o,glslUniforms:a}=F_(e),s=`
varying vec3 vViewPosition;
varying vec3 vNormal;

${un.common}
${un.common_pars_vertex}

${n}

void main() {

	${un.common_vertex}

	vViewPosition = - mvPosition.xyz;
	vec3 transformedNormal = vec3( normal );

	#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	#else
	mat3 m = mat3( dcgModelMatrix );
	#endif
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;

	transformedNormal = normalMatrix * transformedNormal;

	#ifdef FLIP_SIDED
		transformedNormal = - transformedNormal;
	#endif
	vNormal = normalize( transformedNormal );

  ${r}
}
`,l=`
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
varying vec3 vNormal;

#ifdef IOR
	uniform float ior;
#endif

varying vec3 vViewPosition;

${un.common}
${un.common_pars_fragment}
${un.lights_pars_fragment}

${o}

void main() {

  ${i}

	#if defined( USE_COLOR  ) || defined( USE_INSTANCING_COLOR  )
		diffuseColor.rgb = vColor;
	#endif

	${e.disableLighting.value?"vec4 dcgRawColor = diffuseColor;":""}

	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	${un.common_fragment_begin}
	float roughnessFactor = roughness;
	float metalnessFactor = metalness;
	float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif

	// non perturbed normal for clearcoat among others
	vec3 geometryNormal = normal;

	// accumulation
	${un.lights_fragment}

	// modulation

	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;

	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;

	${R_}

	${un.common_fragment_end}

	${e.disableLighting.value?"gl_FragColor.rgb = dcgRawColor.rgb;":""}

	${Dh}

	if (uDepthPeel == 1) {
		// When depth peeling, we render with transparent: false, which causes <opaque_fragment> to set gl_FragColor.a = 1.
		// We need to set it back to the correct value so that it can be respsected in compositing.
		gl_FragColor.a = opacity;
	}
}
`;return{vertex:s,fragment:l,cacheKey:t,glslUniforms:a}}var ile=ie(R(R({},Sh(sO.common)),Sh(sO.lights)),{roughness:{value:.4},metalness:{value:0},emissive:{value:new vt(0)}}),kh=class extends Zl{constructor(e){let{vertex:t,fragment:r,cacheKey:n,glslUniforms:i}=q7(ie(R({},e),{disableLighting:e.globalUniforms.disableLighting})),o=typeof e.color=="string"&&__dcg_shared_module_exports__.Xd(e.color)?"#808080":e.color,a=R(ie(R(R(R(R({},Sh(ile)),O_()),e.graphUniforms),e.globalUniforms),{opacity:{value:e.opacity},diffuse:{value:new vt(o)},map:{value:e.map}}),i);super({name:"GraphSurfaceMaterial",wireframe:e.wireframe,vertexShader:t,fragmentShader:r,opacity:e.opacity,side:ua,lights:!0,uniforms:a}),this.defines={DCG_SUPPORTS_PICKING:!1},this.vertexColors=e.vertexColors,this.useVertexPickingColors=e.useVertexPickingColors,this.map=e.map,this.defines.DCG_SUPPORTS_PICKING=!0,this.cacheKey=n}setEmissiveIntensity(e){let t=new vt(16777215);t.multiplyScalar(e),this.uniforms.emissive.value.copy(t)}customProgramCacheKey(){return this.cacheKey}};function H7(e){let{cacheKey:t,vertexPositionChunk:r,vertexDeclarations:n,fragmentColorChunk:i,fragmentDeclarations:o,glslUniforms:a}=F_(e),s=`
  ${un.common}
  ${un.common_pars_vertex}

  ${n}

void main() {
  ${un.common_vertex}

  ${r}
}
`,l=`
uniform vec3 diffuse;
uniform float opacity;
varying vec3 vNormal;

${un.common}
${un.common_pars_fragment}

${o}

void main() {

  ${i}

  ${un.common_fragment_begin}
  float specularStrength = 1.0;

	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );

	// accumulation (baked indirect lighting only)
	reflectedLight.indirectDiffuse += vec3( 1.0 );

	// modulation

	reflectedLight.indirectDiffuse *= diffuseColor.rgb;

	vec3 outgoingLight = reflectedLight.indirectDiffuse;

  ${un.common_fragment_end}

	${Dh}
}
`;return{vertex:s,fragment:l,cacheKey:t,glslUniforms:a}}var N_=class extends Zl{constructor(e){let{vertex:t,fragment:r,cacheKey:n,glslUniforms:i}=H7({extraMeshArgs:[],restrictionShader:void 0,uvArgs:[],variant:{type:"zClip"},disableLighting:e.globalUniforms.disableLighting}),o=typeof e.color=="string"&&__dcg_shared_module_exports__.Xd(e.color)?"#808080":e.color,a=R(ie(R(R(R({},O_()),e.graphUniforms),e.globalUniforms),{roughness:{value:.4},metalness:{value:0},opacity:{value:e.opacity},diffuse:{value:new vt(o)}}),i);super({name:"LineMaterial",vertexShader:t,fragmentShader:r,opacity:e.opacity,side:ua,uniforms:a}),this.cacheKey=n}setColor(e){this.uniforms.diffuse.value.copy(e)}setOpacity(e){this.opacity=this.uniforms.opacity.value=e}customProgramCacheKey(){return this.cacheKey}},{abs:By,min:K7,max:$7}=Math,j7=11184810,nle=3355443,B_="#444444",U_="#bbbbbb",ale=1e-4;function Y7(e){let t=new vt(j7),r=new vt(nle);return{axisMaterial:W7(t,e),tickMaterial:W7(r,e)}}function TO(e,t,r){return new q_(new dm(new ye(e.xmin,e.ymin,e.zmin),new ye(e.xmax,e.ymax,e.zmax)),new vt(t),r)}function X7(e,t){let r=e.box;r.min.x=t.xmin,r.max.x=t.xmax,r.min.y=t.ymin,r.max.y=t.ymax,r.min.z=t.zmin,r.max.z=t.zmax,e.updateMatrixWorld()}function DO(e){e.dispose()}var sle=new i0(JSON.parse(N7));function W7(e,t){let r=new kh({color:e,extraMeshArgs:[],map:void 0,opacity:1,restrictionShader:void 0,uvArgs:[],variant:{type:"zClip"},wireframe:!1,vertexColors:!1,useVertexPickingColors:!1,globalUniforms:t,graphUniforms:{clip_x:{value:!1},clip_y:{value:!1},clip_z:{value:!1}}});return r.customProgramCacheKey=()=>"axis-material",r}function J7(e,t){let{xmin:r,xmax:n,ymin:i,ymax:o,zmin:a,zmax:s}=e,l=K7(t.width,t.height),c=.05*(l>360?1:l>120?360/l:4-l/120),d=4,u=d*c/.08,p=__dcg_shared_module_exports__.Sb(0,r,n),g=__dcg_shared_module_exports__.Sb(0,i,o),f=__dcg_shared_module_exports__.Sb(0,a,s),y=n-r,E=o-i,_=s-a,w=4*((p-r)/y-.5),v=4*((g-i)/E-.5),T=4*((f-a)/_-.5),M=s<=0?-4:K7(4*s/_,4);return{textSize:c,scale:d,delta:u,zLen:M,x:w,y:v,z:T}}var Q7=.02,qd=7*Q7;function Z7(e,t,r,{axisMaterial:n}){let{xmin:i,xmax:o,ymin:a,ymax:s,zmin:l,zmax:c}=e,d=o-i,u=s-a,p=c-l,g=(o+i)/2,f=(s+a)/2,y=(c+l)/2,E=new Ii,_=Math.PI,w=Q7,{textSize:v,scale:T,delta:M,zLen:C,x:P,y:F,z:B}=J7(e,t);function x(z){return new Ai(new Ud(.8*w,.8*w,z,10),n)}function L(){return new Ai(new Wk(2*w,qd,16),n)}function N(z,V,$,G=1){return z.position.set($[0],$[1],$[2]),z.setRotationFromEuler(ym(V[0],V[1],V[2])),z.scale.set(G,G,G),z.name="axes",E.add(z),z}function O(z,V,$=1){let G=ule(z,n);G.translateX(-V[0]*M),G.translateY(-V[1]*M),G.scale.set($,$,$),G.name="axes";let W=i9(G);W.name=z,E.add(W)}return N(x(4-6*w),[0,0,_/2],[-qd/2,F,B]),N(x(4-6*w),[0,0,0],[P,-qd/2,B]),N(x(4-6*w),[-_/2,0,0],[P,F,-qd/2]),N(L(),[0,0,-_/2],[2-qd/2,F,B]),N(L(),[0,0,0],[P,2-qd/2,B]),N(L(),[_/2,0,0],[P,F,B+$7(C,0)-qd/2]),r&&(O("x",[.027,.03],v*T),O("y",[.025,.02],v*T),O("z",[.025,.03],v*T)),E.scale.set(d/4,u/4,p/4),E.position.set(g,f,y),E}function kO(e){for(let t of e.getObjectsByProperty("name","axes"))t.geometry.dispose()}function e9(e){e.axisMaterial.dispose(),e.tickMaterial.dispose()}function t9({axes:e,plane:t,domain:r,screen:n,controls:i,invertedColors:o,isDepthPeelingActive:a}){let s=i.worldRotation3D,{xmax:l,ymax:c,zmax:d}=r,{scale:u,delta:p,zLen:g,x:f,y,z:E}=J7(r,n);if(e===void 0)return;let _=Math.PI,w=e.getObjectByName("x"),v=e.getObjectByName("y"),T=e.getObjectByName("z"),M=new ye(1,0,0).applyMatrix3(s),C=new ye(0,1,0).applyMatrix3(s),P=new ye(0,0,1).applyMatrix3(s);function F(he,Ie,Ee){he==null||he.setRotationFromEuler(ym(Ie[0],Ie[1],Ie[2])),he==null||he.position.set(Ee[0],Ee[1],Ee[2])}function B(he){return Math.acos(__dcg_shared_module_exports__.Sb(he,-1,1))}let x=l<=0?-1:1,L=c<=0?-1:1,N=d<=0?-1:1,O=[x*(.5*u+.05*p),y,E],z=[f,L*(.5*u+.05*p),E],V=[f,y,N*(E+$7(g,0)+.04*p)],$=i.speed3D===0||i.grapher3d.isDragging,G=By(i.axis3D[0])>.99,W=By(i.axis3D[1])>.99,U=By(i.axis3D[2])>.99,D=$||G,de=$||W,ge=$||U,{isXYsnapped:K,isZsnapped:se}=i,H=By(M.y)>.99&&K&&D,Z=By(C.y)>.99&&K&&de;if(By(P.z)<.001&&se&&ge)F(w,[_,0,_],O),F(v,[_,_,_],z),F(T,[_/2,0,0],V);else{let he=P.z<0?1:-1,Ie=C.y<0?1:-1,Ee=-he*(_/2),Be=(C.x*M.y<0?1:-1)*B(C.z),J=-he*B(-Ie*M.z),j=H?Be:_/2,pe=Z?J:Ee,De=(C.y<0?-1:1)*B(M.y)+_,Te=Ie*_/2;F(w,[j,0,0],O),F(v,[pe,0,Te],z),F(T,[Ee,0,De],V);let Se=t==null?void 0:t.getObjectByName("z plane");Se==null||Se.setRotationFromEuler(ym(_/2,0,De))}let ce=new ye(0,0,1).applyMatrix3(i.worldRotation3D).x;t==null||t.updateZOffsets(ce<0);let Re;t!=null&&t.xyPlane&&(Re=t.xyPlane.material,Re.uniforms.diffuse.value=new vt(o?0:16777215)),ple({invertedColors:o,obliqueness:ce,domainPlaneMaterial:Re,isDepthPeelingActive:a})}var z_=class extends r0{constructor(e,t,r,n,i){super();let{showNumbers3D:o,showPlane3D:a}=r.settings,{xmin:s,xmax:l,ymin:c,ymax:d,zmin:u,zmax:p}=e,[g,f,y]=[l-s,d-c,p-u],E=__dcg_shared_module_exports__.Sb(0,u,p);this.basePosition=new ye((l+s)/2,(d+c)/2,E),this.zOffset=ale*(p-u);let _=new e0(g,f);if(this.xyNumbersPlane=new Ai(_,t.xyNumbersMaterial),this.xyNumbersPlane.name="xy numbers plane",this.xyPlane=new Ai(_,t.xyPlaneMaterial),this.xyPlane.name="xy plane",a){this.add(this.xyPlane);let w=new q_(new dm(new ye(s,c,E),new ye(l,d,E)),new vt(j7),i);w.name="xy border",this.add(w)}if(o){this.add(this.xyNumbersPlane),this.add(dle(r,e,n));let w=new e0(4,4),v=new Ai(w,t.zMaterial),T=i9(v),[M,C]=[__dcg_shared_module_exports__.Sb(0,s,l),__dcg_shared_module_exports__.Sb(0,c,d)];v.setRotationFromEuler(ym(Math.PI/2,0,0)),v.name="z plane",T.scale.set(g/4,f/4,y/4),T.position.set(M,C,(p+u)/2),lle(t.zCanvas,r,e),t.zMaterial.uniforms.map.value.needsUpdate=!0,this.add(T)}}updateZOffsets(e){var t,r;let{x:n,y:i,z:o}=this.basePosition,a=e?this.zOffset:-this.zOffset;this.xyPlane&&((t=this.xyPlane)==null||t.position.set(n,i,o-a),this.xyPlane.renderOrder=0),this.xyNumbersPlane&&((r=this.xyNumbersPlane)==null||r.position.set(n,i,o+2*a),this.xyNumbersPlane.renderOrder=2)}};function lle(e,t,r){let n=e.getContext("2d");if(n===null)return;let i=r9(t,r),o=t.settings.labelSize,{xmin:a,xmax:s,zmin:l,zmax:c}=r,d=[];for(let v of i){let T=__dcg_shared_module_exports__.qa.value(v,c-l);d.push(new _a(T,o))}n.save(),n.scale(window.devicePixelRatio,window.devicePixelRatio),n.clearRect(0,0,t.screen.width,t.screen.height),n.fillStyle=`rgba(${t.settings.config.invertedColors?"0,0,0":"255,255,255"},0.001961)`,n.fillRect(0,0,t.screen.width,t.screen.height),n.lineWidth=1.5,n.miterLimit=2,n.strokeStyle=t.settings.getBackgroundColor({invertWhite:!0});let u=5,p=t.settings.getTextColor({invertBlack:!0}),g=t.screen.width,f=t.screen.height,y={left:3,top:3,right:g-3,bottom:f-3},E=new Br(a,s,l,c,l,c),_=new Rs(t.screen,E,t.settings),w=e.width/window.devicePixelRatio/2;for(let v of d){let T={x:w-u-v.getRect().right,y:_.mapy(v.getValue())},M=v.clampBoundsWithinRect(T,y);n.fillStyle=p,v.drawCenteredAt(n,M,"")}n.restore()}function r9(e,t){let{zmin:r,zmax:n}=t,i=ie(R({},e.viewport),{ymin:r,ymax:n}),o=ie(R({},e),{viewport:i}),{majorStepY:a}=gl(o),s=ds(r,n,a);return n>0&&(s=s.filter(l=>l!=0)),s}function cle(e,t){let{zmin:r,zmax:n}=t;return r9(e,t).filter(i=>i<=n-qd/4*(n-r))}function dle(e,t,{tickMaterial:r}){let{xmin:n,xmax:i,ymin:o,ymax:a,zmin:s,zmax:l}=t,c=__dcg_shared_module_exports__.Sb(0,n,i),d=__dcg_shared_module_exports__.Sb(0,o,a),u=__dcg_shared_module_exports__.Sb(0,s,l),p=Math.PI,g=.004,f=g*(i-n),y=g*(a-o),E=g*(l-s),_=new r0,w=.4;for(let M of cle(e,t)){let C=new Ud,P=new Ai(C,r);P.position.set(c,d,M),P.scale.set(f,w*E,y),P.setRotationFromEuler(ym(p/2,0,0)),P.name="ticks",_.add(P)}let{majorStepX:v,majorStepY:T}=gl(e);for(let M of ds(n,i,v)){if(M>i-qd/4*(i-n))continue;let C=new Ud,P=new Ai(C,r);P.position.set(M,d,u),P.scale.set(y,w*f,E),P.setRotationFromEuler(ym(0,0,p/2)),P.name="ticks",_.add(P)}for(let M of ds(o,a,T)){if(M>a-qd/4*(a-o))continue;let C=new Ud,P=new Ai(C,r);P.position.set(c,M,u),P.scale.set(E,w*y,f),P.setRotationFromEuler(ym(0,p/2,0)),P.name="ticks",_.add(P)}return _}function ple({obliqueness:e,domainPlaneMaterial:t,invertedColors:r}){if(!t)return;t.uniforms.obliqueness.value=Math.abs(e);let n=r?__dcg_shared_module_exports__.Md(B_):B_,i=r?__dcg_shared_module_exports__.Md(U_):U_;t.setGridColors({major:n,minor:i})}function o9(e){var t,r,n,i;let o=s=>e.getObjectByName(s);(t=o("xy numbers plane"))==null||t.geometry.dispose(),(r=o("xy plane"))==null||r.geometry.dispose(),(n=o("z plane"))==null||n.geometry.dispose(),(i=o("xy border"))==null||i.dispose();let a=e.getObjectsByProperty("name","ticks");for(let s of a)s.geometry.dispose()}function _O(e){e.uniforms.map.value.dispose(),e.dispose()}function i9(e){let t=new Ii;return t.add(e),t}function ule(e,t){let r=new o0(e,{font:sle,size:1,height:.02,curveSegments:12,bevelEnabled:!0,bevelThickness:.04,bevelSize:.04,bevelOffset:0,bevelSegments:5});return new Ai(r,t)}var ym=(e,t,r)=>new Fs(e,t,r,"ZYX"),q_=class extends Xk{constructor(e,t,r){let n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],o=new La;o.setIndex(new ha(n,1)),o.setAttribute("position",new Bo(i,3)),super(o,new N_({color:t,opacity:1,graphUniforms:{clip_x:{value:!1},clip_y:{value:!1},clip_z:{value:!1}},globalUniforms:r})),this.type="Box3Helper",this.box=e,this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},xm=class extends Zl{constructor(e,t){super({name:"DomainPlaneMaterial",side:ua,transparent:e.transparent,vertexShader:`
        varying vec3 vPosition;
        void main() {
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
          vPosition = position;
        }
      `,fragmentShader:`
        uniform mat4 projectionMatrix;
        uniform mat4 modelViewMatrix;

        varying vec3 vPosition;
        uniform int dcgRenderMode;
        uniform vec2 uScreenSize;
        uniform float xMin;
        uniform float xMax;
        uniform float yMin;
        uniform float yMax;

        uniform vec3 diffuse;
        uniform float opacity;

        uniform float xMinorStep;
        uniform float yMinorStep;
        uniform float xMajorStep;
        uniform float yMajorStep;
        uniform vec3 majorGridColor;
        uniform vec3 minorGridColor;
        uniform float obliqueness;

        ${Fy}
        ${EO}

        float getNearestStep(float t, float step) {
          float prev = step * floor(t / step);
          float next = prev + step;
          return abs(t - prev) < abs(t - next) ? prev : next;
        }

        vec2 projectToScreen(vec3 p) {
          vec4 pNDC = projectionMatrix * modelViewMatrix * vec4(p, 1.0);
          pNDC /= pNDC.w;
          return 0.5 * (pNDC.xy + 1.0) * uScreenSize;
        }

        bool isMajorStep(float s, float minorStep, float majorStep) {
          return mod(s, majorStep) < minorStep * 0.125;
        }

        void main() {
          ${Ny}
          ${R_}
          // the xyPlane geometry is shifted in domain3d-objects to reduce cancellation error
          float x0 = (xMin + xMax) / 2.;
          float y0 = (yMin + yMax) / 2.;
          float xNearest = getNearestStep(vPosition.x + x0, xMinorStep);
          float yNearest = getNearestStep(vPosition.y + y0, yMinorStep);
          bool xIsMajor = isMajorStep(xNearest, xMinorStep, xMajorStep);
          bool yIsMajor = isMajorStep(yNearest, yMinorStep, yMajorStep);
          vec2 xNearestScreen = projectToScreen(vec3(xNearest - x0, vPosition.y, vPosition.z));
          vec2 yNearestScreen = projectToScreen(vec3(vPosition.x, yNearest - y0, vPosition.z));
          float xDist = distance(gl_FragCoord.xy, xNearestScreen);
          float yDist = distance(gl_FragCoord.xy, yNearestScreen);
          float minDist = xDist < yDist ? xDist : yDist;
          bool isMajor = xDist < yDist ? xIsMajor : yIsMajor;

          vec4 grid = vec4(0.0);
          float baseWidth = 0.0;
          float feather = 2.0;
          if (obliqueness < FADE_THRESHOLD) {
            baseWidth = 3.0 * (1.0 - obliqueness / FADE_THRESHOLD);
            feather = 2.0 * obliqueness / FADE_THRESHOLD;
          }
          if (minDist <= baseWidth + feather) {
            vec3 gridColor = isMajor ? majorGridColor : minorGridColor;
            // We want integral of blurFactor to be 1.0 over the whole region
            //
            //   baseWidth
            //   --------------
            //   |            |            //   |            |             // h |            |              //   |            |               //   |            |                //   -------------|-----
            //               feather (2.0)
            // h * baseWidth + h * feather / 2 = 1
            // h = 1 / (baseWidth + feather / 2)
            float h = 1.0 / (baseWidth + feather / 2.0);
            float blurFactor = h - max(0.0, (minDist - baseWidth)) / feather;
            grid = vec4(gridColor, blurFactor);
          }

          // Composite the grid color ("grid") onto the domain plane color (diffuse, opacity)
          float composedAlpha = mix(opacity, grid.a, grid.a);
          vec3 composedColor = mix(diffuse*opacity, grid.rgb*grid.a, grid.a) / composedAlpha;
          gl_FragColor = vec4(composedColor, composedAlpha);

          ${Dh}
        }
      `,defines:{DCG_SUPPORTS_PICKING:!0,FADE_THRESHOLD:.4},uniforms:R({opacity:{value:e.opacity},diffuse:{value:e.color},majorGridColor:{value:new vt(B_)},minorGridColor:{value:new vt(U_)},obliqueness:{value:1}},t)})}setGridColors({major:e,minor:t}){this.uniforms.majorGridColor.value=new vt(e),this.uniforms.minorGridColor.value=new vt(t)}},wm=class extends Zl{constructor(e,t){let r=new S_(e.canvas);super({name:"DomainPlaneNumbersMaterial",side:ua,transparent:e.transparent,vertexShader:`
        varying vec2 vUv;

        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
      `,fragmentShader:`

        uniform sampler2D map;
        uniform float opacity;
        varying vec2 vUv;
        uniform int dcgRenderMode;

        ${Fy}

        uniform float alphaTest;

        void main() {
          ${Ny}

          vec4 sampleColor = texture2D( map, vUv );

          // When we're only showing numbers, we clear the canvas with a low alpha and discard it here.
          if ( sampleColor.a < alphaTest ) {
            discard;
          }

          #ifdef OPAQUE
          if (uDepthPeel == 0) {
            sampleColor.a = 1.0;
          }
          #endif

          gl_FragColor = sampleColor;

          ${Dh}
        }
      `,uniforms:R({map:{value:r},alphaTest:{value:.1}},t)}),this.canvas=e.canvas,this.texture=r}dispose(){super.dispose(),this.texture.dispose()}},hle={name:"DepthPeelLayerAddJittersShader",uniforms:{uCompositeType:{value:0},uTextureA:{value:null},uTextureB:{value:null},weight:{value:1}},defines:{},vertexShader:`
    varying vec2 vUv;
    void main(){
      vUv = uv;
      gl_Position = vec4(position.xy,0.,1.);
    }
  `,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D uTextureA;
    uniform sampler2D uTextureB;
    uniform int uCompositeType;
    uniform float weight;
    void main() {
      vec4 src = texture2D(uTextureA,vUv);
      src.a *= weight;
      vec4 dst = uCompositeType == 1 ? texture2D(uTextureB,vUv) : vec4(0.0);
      // Convert src, dst to premultiplied, and do the addition in premultiplied space.
      // We don't want to store the buffers premultiplied since that loses dynamic range.
      src.rgb *= src.a;
      dst.rgb *= dst.a;
      gl_FragColor = src + dst;
      // Convert output back to non-premultiplied
      // Don't need to check for division by zero, since it gets converted to a buffer 0-255 (an integer, not NaN),
      // which we will then multiply by 0 (the alpha).
      gl_FragColor.rgb /= gl_FragColor.a;
    }
  `},H_=class{constructor(){this.shaderPass=new bl(hle,{depthTest:!1,depthWrite:!1,transparent:!1},"uTextureA")}dispose(){this.shaderPass.dispose()}addInPremultiplied(e,t,r,n,i){this.shaderPass.uniforms.weight.value=n,i instanceof vt?(this.shaderPass.uniforms.uCompositeType.value=0,this.shaderPass.uniforms.uTextureB.value=null):(this.shaderPass.uniforms.uTextureB.value=i.texture,this.shaderPass.uniforms.uCompositeType.value=1),this.shaderPass.renderFromTexture(e,t,r.texture)}},gle={name:"DepthPeelLayerCompositeShader",uniforms:{uTopTexture:{value:null},uBottomTexture:{value:null},uBackgroundColor:{value:new vt(0)},uCompositeType:{value:0}},defines:{},vertexShader:`
    varying vec2 vUv;
    void main(){
      vUv = uv;
      gl_Position = vec4(position.xy,0.,1.);
    }
  `,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D uTopTexture;
    uniform sampler2D uBottomTexture;
    uniform vec3 uBackgroundColor;
    uniform int uCompositeType;
    void main() {
      vec4 top = texture2D(uTopTexture,vUv);
      vec4 bot = uCompositeType == 1 ? texture2D(uBottomTexture,vUv) : vec4(uBackgroundColor, 1.0);
      // Convert top, bot to premultiplied, and do the addition in premultiplied space.
      // We don't want to store the buffers premultiplied since that loses dynamic range.
      top.rgb *= top.a;
      bot.rgb *= bot.a;
      gl_FragColor = top + bot * (1. - top.a);
      // Convert output back to non-premultiplied
      gl_FragColor.rgb /= gl_FragColor.a;
    }
  `},K_=class{constructor(){this.shaderPass=new bl(gle,{depthTest:!1,depthWrite:!1,transparent:!1},"uTopTexture")}dispose(){this.shaderPass.dispose()}composite(e,t,r,n){n instanceof vt?(this.shaderPass.uniforms.uCompositeType.value=0,this.shaderPass.uniforms.uBackgroundColor.value=n,this.shaderPass.uniforms.uBottomTexture.value=null):(this.shaderPass.uniforms.uCompositeType.value=1,this.shaderPass.uniforms.uBackgroundColor.value=new vt(0),this.shaderPass.uniforms.uBottomTexture.value=n.texture),this.shaderPass.renderFromTexture(e,t,r.texture)}},c0=4,mle={name:"MaxWindow",uniforms:{tDiffuse:{value:null},sourcePixelSize:{value:new Tt(1,1)},destPixelSize:{value:new Tt(1,1)}},defines:{},vertexShader:`
  varying vec2 vUv;

  void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
  }`,fragmentShader:`
  uniform float weight;
  uniform sampler2D tDiffuse;
  uniform vec2 sourcePixelSize;
  uniform vec2 destPixelSize;
  varying vec2 vUv;

  void main() {
    vec2 demi = vec2(0.5,0.5);
    vec2 xy = destPixelSize * vUv - demi;
    vec4 maxAccum = vec4(0.);
    for (float i=0.; i < ${c0}.0; i+=1.) {
      for (float j=0.; j < ${c0}.0; j+=1.) {
        vec2 xySample = min(
          xy * ${c0}.0 + vec2(i,j) + demi,
          sourcePixelSize
        );
        vec2 uvSample = xySample / sourcePixelSize;
        vec4 val = texture2D(tDiffuse, uvSample);
        maxAccum = max(maxAccum, val);
      }
    }
    gl_FragColor = maxAccum;
  }`},IO=class{constructor(){this.shaderPass=new bl(mle,{depthTest:!1,depthWrite:!1,transparent:!0})}dispose(){this.shaderPass.dispose()}render(e,t,r){this.shaderPass.uniforms.sourcePixelSize={value:new Tt(r.width,r.height)},this.shaderPass.uniforms.destPixelSize={value:new Tt(t.width,t.height)},e.setRenderTarget(t),e.setClearColor(new vt(0),0),e.clear(),this.shaderPass.render(e,t,r)}},W_=class{constructor(e,t){this.targetType=t,this.maxPass=new IO,this.maxMipmapTargets=[];let r=e.x,n=e.y;for(let i=0;r=Math.ceil(r/c0),n=Math.ceil(n/c0),r>1||n>1;i++)this.maxMipmapTargets[i]=this.createTarget(r,n)}dispose(){for(let e of this.maxMipmapTargets)e.dispose();this.maxPass.dispose()}createTarget(e,t){return new Oa(e,t,{minFilter:ml,magFilter:ml,type:this.targetType,colorSpace:Ga})}renderMax(e,t,r,n,i,o){var a;for(let s=0;s<=this.maxMipmapTargets.length;s++){let l=s===0?r:this.maxMipmapTargets[s-1],c=s<this.maxMipmapTargets.length?this.maxMipmapTargets[s]:t;this.maxPass.render(e,c,l)}for(let s=0;s<this.maxMipmapTargets.length;s++){let l=this.maxMipmapTargets[s];(a=n.get(`max-mm-p${i}-${s}`,`${l.width}x${l.height}`))==null||a.renderFromTarget(e,l,o*Math.min(r.width/l.width,r.height/l.height))}}},$_=class{constructor(e,t,r,n,i,o){this.controller=e,this.renderer=t,this.materialManager=r,this.scene=n,this.camera=i,this.debug=o,this.triangles=0,this.pixelRatio=t.getPixelRatio();let a=t.getSize(new Tt).multiplyScalar(this.pixelRatio);this.size=a,this.init()}init(){this.samples=1;let e=this.controller.getGraphSettings().config.peelUpsample;e?this.samples=e:this.pixelRatio<1.5?this.samples=3:this.pixelRatio<2.5?this.samples=2:this.samples=1;let t=this.controller.getGraphSettings().config.peelFloatTexture?F7()[0]:Vn,r=()=>new Oa(this.size.x,this.size.y,{minFilter:ml,magFilter:ml,type:t,colorSpace:Ga});this.peelSampleTargets=[],this.peelResultTarget=r(),this.secondPeelResultTarget=r(),this.compositingTargets=[r(),r()],this.maxPass=new W_(this.size,t),this.finalMipmapTargets=[this.maxPass.createTarget(1,1),this.maxPass.createTarget(1,1)],this.opaqueBackgroundTargets=[];for(let i=0;i<this.samples;i++){let o=r();o.depthTexture=new mm(this.size.x,this.size.y),this.opaqueBackgroundTargets.push(o)}this.combinedOpaqueBackgroundTarget=r();let n=2*this.samples;for(let i=0;i<n;i++){let o=r();o.depthTexture=new mm(this.size.x,this.size.y),this.peelSampleTargets.push(o)}this.compositePass=new K_,this.addPremultipliedPass=new H_,this.materialManager.setScreenSize(this.size.x,this.size.y)}dispose(){this.peelSampleTargets.forEach(e=>e.dispose()),this.compositingTargets.forEach(e=>e.dispose()),this.peelResultTarget.dispose(),this.compositePass.dispose(),this.addPremultipliedPass.dispose(),this.maxPass.dispose()}getDebugScale(){return this.controller.getGraphSettings().config.debugScale}render(e){var t;let r=this.renderer,n=r.getPixelRatio(),i=r.getSize(new Tt).multiplyScalar(n);(n!==this.pixelRatio||this.size.x!==i.x||this.size.y!==i.y)&&(this.size.copy(i),this.dispose(),this.init());let o=r.getClearColor(new vt),a=r.autoClear;r.autoClear=!1,r.setClearColor(new vt(0),1),r.clear(),this.materialManager.setGlobalUniform("dcgRenderMode",gs.Default);let s=fle(this.scene);yle(this.scene),this.renderOpaqueBackground(),s9(this.scene,s),this.materialManager.setGlobalUniform("uDepthPeel",1),this.materialManager.setGlobalUniform("uDepthPeelLayer",0),this.materialManager.setGlobalUniform("uPrevDepthTexture",null);let l,c=this.peelSampleTargets.slice(0,this.samples),d=this.peelSampleTargets.slice(this.samples,2*this.samples),u=this.compositingTargets[0],p=this.compositingTargets[1];xle(this.scene);let g=[];this.renderTransparentLayer(c,void 0,0,u),e===1&&g.push(this.queryNonemptyPixels(0,u,this.finalMipmapTargets[0])),l=u;for(let y=0;y<e;y++){let E=y+1;this.renderTransparentLayer(d,c,E,this.peelResultTarget),this.compositePass.composite(this.renderer,p,u,this.peelResultTarget),(t=this.debug.get(`peel-c${E}`))==null||t.renderFromTarget(this.renderer,p,this.getDebugScale()),y>=e-2&&g.push(this.queryNonemptyPixels(E,this.peelResultTarget,this.finalMipmapTargets[y===e-2?0:1])),l=p,[d,c]=[c,d],[p,u]=[u,p]}let f=this.renderer.info.render.frame;Promise.all(g).then(y=>{if(y.length!==2)throw new Error(`Programming error: expected 2 nonempty pixel query results, got ${y.length}`);let E=y[0][3]>0,_=y[1][3]>0?1:E?2:0;this.controller.setAdaptiveDepthPeelingInfo({frame:f,peelLayers:e,status:_})}),s9(this.scene,s),this.compositePass.composite(this.renderer,null,l,this.combinedOpaqueBackgroundTarget),r.setClearColor(o),r.autoClear=a,this.materialManager.setGlobalUniform("uPrevDepthTexture",null),this.materialManager.setGlobalUniform("uDepthPeel",0)}renderOpaqueBackground(){this.materialManager.setGlobalUniform("uDepthPeel",0),this.materialManager.setGlobalUniform("uOpaqueDepthTexture",null);let e=this.combinedOpaqueBackgroundTarget,t=this.secondPeelResultTarget;this.samples%2===0&&([t,e]=[e,t]);for(let r=0;r<this.samples;r++){let n=this.opaqueBackgroundTargets[r];this.renderer.setRenderTarget(n),this.setJitterOffset(r),this.renderer.setClearColor(new vt(0),0),this.renderer.clear(),this.renderer.render(this.scene,this.camera),this.addPremultipliedPass.addInPremultiplied(this.renderer,e,n,n9(this.samples,r),r===0?new vt(0):t),[e,t]=[t,e]}this.camera.clearViewOffset()}renderTransparentLayer(e,t,r,n){var i,o;let a=this.secondPeelResultTarget;e.length%2===0&&([a,n]=[n,a]);for(let s=0;s<e.length;s++){let l=e[s];this.materialManager.setGlobalUniform("uOpaqueDepthTexture",this.opaqueBackgroundTargets[s].depthTexture),t&&this.materialManager.setGlobalUniform("uPrevDepthTexture",t[s].depthTexture),this.setJitterOffset(s),this.materialManager.setGlobalUniform("uDepthPeelLayer",r),this.materialManager.setGlobalUniform("dcgRenderMode",gs.Default),this.renderer.setClearColor(new vt(0),0),this.renderer.setRenderTarget(l),this.renderer.clear(!0,!0);let c=this.scene.background;this.scene.background=null,this.renderer.render(this.scene,this.camera),this.scene.background=c,this.triangles=this.renderer.info.render.triangles,(i=this.debug.get(`peel-p${r}-s${s}`))==null||i.renderFromTarget(this.renderer,l,this.getDebugScale()),this.addPremultipliedPass.addInPremultiplied(this.renderer,n,l,n9(this.samples,s),s===0?new vt(0):a),(o=this.debug.get(`peel-p${r}-s${s}-combined`))==null||o.renderFromTarget(this.renderer,n,this.getDebugScale()),[n,a]=[a,n]}this.camera.clearViewOffset()}setJitterOffset(e){if(!a9[this.samples])throw new Error(`Unsupported sample count: ${this.samples}`);let t=a9[this.samples];this.camera.setViewOffset(this.size.x,this.size.y,t[e][0]*.0625,t[e][1]*.0625,this.size.x,this.size.y)}queryNonemptyPixels(e,t,r){var n,i;(n=this.debug.get(`max-mm-p${e}-start`))==null||n.renderFromTarget(this.renderer,t,this.getDebugScale()),this.maxPass.renderMax(this.renderer,r,t,this.debug,e,this.getDebugScale());let o=this.renderer.getContext(),a=new Uint8Array(4*r.width*r.height),s=R7(o,0,0,r.width,r.height,o.RGBA,o.UNSIGNED_BYTE,a).then(()=>[...a]);return(i=this.debug.get(`max-mm-p${e}-end`,`${r.width}x${r.height}`))==null||i.renderFromTarget(this.renderer,r,this.getDebugScale()*Math.min(t.width/r.width,t.height/r.height)),s}};function n9(e,t){let r=1/e,n=1/32,i=-.5+(t+.5)/e;return r+n*i}var a9={1:[[0,0]],2:[[4,4],[-4,-4]],3:[[3.323,3.323],[-4.54,1.216],[1.216,-4.54]],4:[[-2,-6],[6,-2],[-6,2],[2,6]]};function fle(e){let t=new Map;return e.traverse(r=>{t.set(r,r.visible)}),t}function s9(e,t){e.traverse(r=>{r.visible=t.get(r)})}var ble=.999;function yle(e){e.traverse(t=>{l9(t)==="transparent"&&(t.visible=!1)})}function xle(e){e.traverse(t=>{l9(t)==="opaque"&&(t.visible=!1)})}function l9(e){let t=e.material;if(t)return t instanceof xm||t instanceof wm||t.opacity<ble?"transparent":"opaque"}var j_=class{constructor(){this.materialCache={},this.globalUniforms={dcgRenderMode:gs.Default,xMin:0,xMax:0,yMin:0,yMax:0,zMin:0,zMax:0,xMajorStep:0,xMinorStep:0,yMajorStep:0,yMinorStep:0,uDepthPeel:0,uDepthPeelLayer:0,uOpaqueDepthTexture:null,uPrevDepthTexture:null,uScreenSize:new Tt(1,1),uInverseScreenSize:new Tt(1,1),uDepthOffset:1e-6,disableLighting:!0}}setGlobalUniform(e,t){this.globalUniforms[e]=t}disposeAllMaterials(){this.disposeMaterialsNotInScene(new eu)}disposeMaterialsNotInScene(e){var t;let r={};e.traverse(n=>{if("material"in n){let i=n.material,o;Array.isArray(n.material)?o=i:o=[i],o.forEach(a=>{d9(a)&&(r[a.dcgMaterialCacheKey]=!0)})}});for(let n in this.materialCache)if(!r[n]){let i=this.materialCache[n];i.dispose(),(t=i.map)==null||t.dispose(),delete this.materialCache[n]}}getOrMakeMaterial(e){let t=wle(e.spec),r=this.materialCache[t];if(r)switch(e.type){case"surface-graph":c9(r.uniforms,e.uniforms);break;case"domain-plane":break;default:throw new Error(`Unexpected type ${e.type}`)}else{switch(e.type){case"surface-graph":r=this._buildSurfaceMaterial(e.spec,e.uniforms);break;case"domain-plane":r=this.buildDomainPlaneMaterial(e.spec);break;default:throw new Error(`Unexpected type ${e.type}`)}this.materialCache[t]=r,r.dcgMaterialCacheKey=t}return r}setScreenSize(e,t){this.globalUniforms.uScreenSize.set(e,t),this.globalUniforms.uInverseScreenSize.set(1/e,1/t)}setDomain(e,t){let{xmin:r,xmax:n,ymin:i,ymax:o,zmin:a,zmax:s}=e,l=1e-5,c=(n-r)*l,d=(o-i)*l,u=(s-a)*l;this.globalUniforms.xMin=r-c,this.globalUniforms.xMax=n+c,this.globalUniforms.yMin=i-d,this.globalUniforms.yMax=o+d,this.globalUniforms.zMin=a-u,this.globalUniforms.zMax=s+u;let p=gl(t);this.globalUniforms.xMinorStep=p.minorStepX,this.globalUniforms.xMajorStep=p.majorStepX,this.globalUniforms.yMinorStep=p.minorStepY,this.globalUniforms.yMajorStep=p.majorStepY}setDisableLighting(e){this.globalUniforms.disableLighting=e}setZBoundsUniform(e,t){if(!d9(e))throw new Error("Cannot update zBoundsForAnimation on a material that is not managed by MaterialManager");e instanceof xm||e instanceof wm||p9(e.uniforms,t)}_buildSurfaceMaterial(e,t){var r,n;let i=e.color,o=(r=e.uvArgs)!=null?r:[],a=(n=e.extraMeshArgs)!=null?n:[],s=e.restrictionShader,l=i.startsWith("wireframe:");l&&(i=i.slice(10));let c=this.getVariant(i,e.colorShader),d=new kh({color:__dcg_shared_module_exports__.Xd(i)?"#808080":i,wireframe:l,opacity:e.opacity,extraMeshArgs:a,map:void 0,variant:c,vertexColors:e.vertexColors||!1,useVertexPickingColors:e.useVertexPickingColors||!1,restrictionShader:s,uvArgs:o,globalUniforms:this.getGlobalUniforms()});return c9(d.uniforms,t),d}buildDomainPlaneMaterial(e){let t;return e.type==="domain-plane-numbers-material"?t=new wm(e,this.getGlobalUniforms()):t=new xm(e,this.getGlobalUniforms()),this.setupGlobalUniforms(t.uniforms),t}getVariant(e,t){return e.startsWith("shader:")?!t||!t.source?{type:"zClip"}:{type:"colorFunc",colorShader:t,colorCacheKey:JSON.stringify(t)}:{type:"zClip"}}getGlobalUniforms(){let e={};return this.setupGlobalUniforms(e),e}setupGlobalUniforms(e){let t=this;for(let r in this.globalUniforms){let n=r;e[n]={get value(){return t.globalUniforms[n]}}}}};function c9(e,t){let{clip:r,zBoundsForAnimation:n}=t;p9(e,n),e.clip_x={value:r.x},e.clip_y={value:r.y},e.clip_z={value:r.z},e.NaN={value:NaN},e.Infinity={value:1/0}}function p9(e,t){e.zMinForAnimation={value:t.zMinForAnimation},e.zMaxForAnimation={value:t.zMaxForAnimation}}function wle(e){return e.type==="domain-plane-numbers-material"?(e.canvas.hasAttribute("dcg-material-manager-id")||e.canvas.setAttribute("dcg-material-manager-id",Math.random()+""),JSON.stringify(ie(R({},e),{canvas:e.canvas.getAttribute("dcg-material-manager-id")}))):JSON.stringify(e)}function d9(e){return"dcgMaterialCacheKey"in e}function u9(e,t,r){var n,i,o;let a=__dcg_shared_module_exports__.Sb(Math.floor(8+30*t),8,20),{xmin:s,xmax:l,ymin:c,ymax:d,zmin:u,zmax:p}=r,g=(l-s)/2,f=(d-c)/2,y=(p-u)/2,E=30,_={xmin:s-E*g,xmax:l+E*g,ymin:c-E*f,ymax:d+E*f,zmin:u-E*y,zmax:p+E*y};function w(G,W,U){return _.xmin<=G&&G<=_.xmax&&_.ymin<=W&&W<=_.ymax&&_.zmin<=U&&U<=_.zmax}for(let G=0;G<e.length/3;G++){let W=e[3*G+0],U=e[3*G+1],D=e[3*G+2];if(w(W,U,D)||!O(G))continue;let de=G===e.length/3-1||!O(G+1)?G-1:G+1;if(!O(de))continue;let ge=e[3*de+0]-W,K=e[3*de+1]-U,se=e[3*de+2]-D,H=vle(_,W,U,D,ge,K,se);e[3*G+0]=(n=H==null?void 0:H.x)!=null?n:NaN,e[3*G+1]=(i=H==null?void 0:H.y)!=null?i:NaN,e[3*G+2]=(o=H==null?void 0:H.z)!=null?o:NaN}for(let G=0;G<e.length/3-1;G++)if(O(G)&&O(G+1)){e=e.slice(3*G);break}if(!(O(0)&&O(1)))return[[],[],[]];let v=e.length/3-1,T=new ye,M=new ye,C=[],P=[],F=[],B=$();for(let G=0;G<=v;G++)x(G);return L(),[C,P,F];function x(G){M.x=e[3*G+0],M.y=e[3*G+1],M.z=e[3*G+2];let W=B.normals[G],U=B.binormals[G];if(V(G))for(let D=0;D<=a;D++){let de=D/a*Math.PI*2,ge=Math.sin(de),K=-Math.cos(de);T.x=g*t*(K*W.x+ge*U.x),T.y=f*t*(K*W.y+ge*U.y),T.z=y*t*(K*W.z+ge*U.z),C.push(M.x+T.x,M.y+T.y,M.z+T.z),T.normalize(),P.push(T.x,T.y,T.z)}else for(let D=0;D<=a;D++)C.push(0,0,0),P.push(0,0,0)}function L(){for(let G=1;G<=v;G++)if(V(G-1)&&V(G))for(let W=1;W<=a;W++){let U=(a+1)*(G-1)+(W-1),D=(a+1)*G+(W-1),de=(a+1)*G+W,ge=(a+1)*(G-1)+W;F.push(U,D,ge,D,de,ge)}}function N(G){return new ye(e[3*G+0],e[3*G+1],e[3*G+2])}function O(G){return isFinite(Math.fround(e[3*G+0]))&&isFinite(Math.fround(e[3*G+1]))&&isFinite(Math.fround(e[3*G+2]))}function z(G){return isFinite(G.x)&&isFinite(G.y)&&isFinite(G.z)}function V(G){return O(G)&&z(B.normals[G])&&z(B.binormals[G])}function $(){let G=new ye,W=[],U=[],D=[],de=new ye,ge=new Nt;for(let K=0;K<=v;K++){let[se,H]=K<v?[K+1,K]:[K,K-1],Z=N(se).sub(N(H)).normalize();z(Z)?W[K]=Z:K>0&&(W[K]=W[K-1])}for(let K=0;K<=v;K++)if(K===0||!O(K-1)){U[K]=new ye,D[K]=new ye;let se=Number.MAX_VALUE,H=Math.abs(W[K].x),Z=Math.abs(W[K].y),ce=Math.abs(W[K].z);H<=se&&(se=H,G.set(1,0,0)),Z<=se&&(se=Z,G.set(0,1,0)),ce<=se&&G.set(0,0,1),de.crossVectors(W[K],G).normalize(),U[K].crossVectors(W[K],de),D[K].crossVectors(W[K],U[K])}else{if(U[K]=U[K-1].clone(),D[K]=D[K-1].clone(),de.crossVectors(W[K-1],W[K]),de.length()>Number.EPSILON){de.normalize();let H=Math.acos(__dcg_shared_module_exports__.Sb(W[K-1].dot(W[K]),-1,1));U[K].applyMatrix4(ge.makeRotationAxis(de,H))}let se=K>0&&W[K-1].dot(W[K])>-.999999*W[K-1].length()*W[K].length()?W[K].clone().add(W[K-1]).normalize():W[K];D[K].crossVectors(se,U[K]).normalize()}return{normals:U,binormals:D}}}function vle(e,t,r,n,i,o,a){let s,l,c,d,u,p,g=1/i,f=1/o,y=1/a;if(g>=0?(s=(e.xmin-t)*g,l=(e.xmax-t)*g):(s=(e.xmax-t)*g,l=(e.xmin-t)*g),f>=0?(c=(e.ymin-r)*f,d=(e.ymax-r)*f):(c=(e.ymax-r)*f,d=(e.ymin-r)*f),s>d||c>l||((c>s||isNaN(s))&&(s=c),(d<l||isNaN(l))&&(l=d),y>=0?(u=(e.zmin-n)*y,p=(e.zmax-n)*y):(u=(e.zmax-n)*y,p=(e.zmin-n)*y),s>p||u>l)||((u>s||s!==s)&&(s=u),(p<l||l!==l)&&(l=p),l<0))return;let E=s>=0?s:l;return{x:t+E*i,y:r+E*o,z:n+E*a}}Ss();var h9=new Set;h9.add("(0,0,0,0)");var Y_=class{constructor(){this.pickingColorToData=new Map,this.idToPickingColor=new Map,this.testingLastHashCollisionCount=0}setPickingColorForMesh(e){let{mesh:t,branchId:r}=e;if(t instanceof Mi)for(let n=0;n<t.count;n++){let i=r+":"+n,o=this._getOrCreatePickingColor({mesh:t,index:n,isPoint:e.isPoint,blocksPicking:e.blocksPicking,forceOpaque:!1,pickingId:i});t.setPickingColorAt(n,o)}else if(e.pickingColorVertexCounts){let n=[],{pickingColorVertexCounts:i}=e;for(let o=0;o<i.length;o++){let a=MO(r)+":"+o,s=this._getOrCreatePickingColor({mesh:t,index:o,isPoint:e.isPoint,blocksPicking:e.blocksPicking,forceOpaque:!1,pickingId:a});n.push(s)}t.setPickingColorArray({colors:n,repeatColorCounts:i})}else{let n=r;t.pickingColor=this._getOrCreatePickingColor({mesh:t,index:0,isPoint:e.isPoint,blocksPicking:e.blocksPicking,forceOpaque:e.forceOpaque,pickingId:n})}}_getOrCreatePickingColor(e){let t=e.pickingId,r=this.idToPickingColor.get(t);if(r){let s=r.key;return this.pickingColorToData.set(s,e),r.color}let n=Ele(e.pickingId),i,o,a=0;for(;;){let s=n+wr(a,2),l=s>>24&255,c=s>>16&255,d=s>>8&255,u=e.forceOpaque?255:s&255;if(i=`(${l},${c},${d},${u})`,o=[l/255,c/255,d/255,u/255],!h9.has(i)&&!this.pickingColorToData.has(i))break;if(a++,a>100){i="(0,0,0,0)",o=[0,0,0,0];break}}return this.testingLastHashCollisionCount=a,this.pickingColorToData.set(i,e),this.idToPickingColor.set(t,{key:i,color:o}),o}getDataForPickingColor(e){let t=`(${e.join(",")})`;return this.pickingColorToData.get(t)}disposeColorsNotInScene(e){let t=new Set;e.traverse(r=>{if(r instanceof Mi){let n=[0,0,0,0];for(let i=0;i<r.count;i++)r.getPickingColorAt(i,n),t.add(AO(n))}else if(r.pickingColorArray){let n=r.pickingColorArray.colors;if(n)for(let i of n)t.add(AO(i))}else{let n=r.pickingColor;n&&t.add(AO(n))}});for(let r of this.pickingColorToData.keys())if(!t.has(r)){let n=this.pickingColorToData.get(r);this.idToPickingColor.delete(n.pickingId),this.pickingColorToData.delete(r)}}};function AO(e){return"("+Math.round(e[0]*255)+","+Math.round(e[1]*255)+","+Math.round(e[2]*255)+","+Math.round(e[3]*255)+")"}var Cle=2166136261,Sle=16777619;function Ele(e){let t=Cle;for(let r=0;r<e.length;r++)t^=e.charCodeAt(r),t*=Sle;return t>>>0}var g9={name:"ConcatShader",uniforms:{t0:{value:null},t1:{value:null},t2:{value:null},t3:{value:null}},defines:{},vertexShader:`
		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`
		uniform sampler2D t0;
		uniform sampler2D t1;
		uniform sampler2D t2;
		uniform sampler2D t3;

		uniform float opacity;
		uniform sampler2D tDiffuse;
		varying vec2 vUv;

		void main() {
      int index = int(vUv.x * 4.0);
      float x = vUv.x * 4.0 - float(index);
      vec2 uv = vec2(x, vUv.y);
      if (index == 0) {
        gl_FragColor = texture2D( t0, uv );
      } else if (index == 1) {
        gl_FragColor = texture2D( t1, uv );
      } else if (index == 2) {
        gl_FragColor = texture2D( t2, uv );
      } else if (index == 3) {
        gl_FragColor = texture2D( t3, uv );
      }
		}`},m9={name:"CopyShader",uniforms:{tDiffuse:{value:null},weight:{value:1}},defines:{SRGB_COLOR_SPACE:!0},vertexShader:`
		varying vec2 vUv;

		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`
		uniform float weight;
		uniform sampler2D tDiffuse;
		varying vec2 vUv;

		void main() {
			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = weight * texel;
      #ifdef SRGB_COLOR_SPACE
      gl_FragColor = LinearTosRGB( gl_FragColor );
      #endif
		}`},{abs:GO,floor:Tle,sin:f9,cos:b9}=Math;function y9(e,t,r,n){if(!O(e)||!O(t)||!isFinite(r)||e.equals(t)||r===0)return[[],[],[]];let i=t.clone().sub(e).normalize(),o=i.clone().negate(),a=new ye,s=new ye,l=new ye,c=Number.MAX_VALUE,d=GO(i.x),u=GO(i.y),p=GO(i.z);d<=c&&(c=d,a.set(1,0,0)),u<=c&&(c=u,a.set(0,1,0)),p<=c&&a.set(0,0,1),l.crossVectors(i,a).normalize(),a.crossVectors(i,l),s.crossVectors(i,a);let g=new ye,f=(n.xmax-n.xmin)/2,y=(n.ymax-n.ymin)/2,E=(n.zmax-n.zmin)/2,_=[],w=[],v=[],T=t.clone().sub(e),M=new ye(T.x/f,T.y/y,T.z/E).length();r>M/6&&(r=M/6);let C=6*r,P=1-Math.min(1,C/M),F=e.clone().add(T.clone().multiplyScalar(P)),B=__dcg_shared_module_exports__.Sb(Tle(8+80*r),8,30);L(e,r),L(F,r),N();let x=_.length/3;_.push(e.x,e.y,e.z),w.push(o.x,o.y,o.z),L(e,r,o);for(let z=1;z<=B;z++)v.push(x,x+z,x+z+1);x=_.length/3,_.push(F.x,F.y,F.z),w.push(o.x,o.y,o.z),L(F,2*r,o);for(let z=1;z<=B;z++)v.push(x,x+z,x+z+1);x=_.length/3;for(let z=0;z<=B;z++){let V=z/B*Math.PI*2,$=f9(V),G=-b9(V);g.x=f*2*r*(G*a.x+$*s.x),g.y=y*2*r*(G*a.y+$*s.y),g.z=E*2*r*(G*a.z+$*s.z),_.push(F.x+g.x,F.y+g.y,F.z+g.z),_.push(t.x,t.y,t.z);let W=1/3,U=new ye(G*a.x+$*s.x+W*i.x,G*a.y+$*s.y+W*i.y,G*a.z+$*s.z+W*i.z).normalize();w.push(U.x,U.y,U.z,U.x,U.y,U.z)}for(let z=0;z<B;z++)v.push(x+2*z,x+2*z+1,x+2*z+2);return[_,w,v];function L(z,V,$){for(let G=0;G<=B;G++){let W=G/B*Math.PI*2,U=f9(W),D=-b9(W);g.x=f*V*(D*a.x+U*s.x),g.y=y*V*(D*a.y+U*s.y),g.z=E*V*(D*a.z+U*s.z),_.push(z.x+g.x,z.y+g.y,z.z+g.z),g.normalize(),$===void 0?w.push(g.x,g.y,g.z):w.push($.x,$.y,$.z)}}function N(){for(let z=1;z<=B;z++){let V=z-1,$=B+z,G=B+z+1,W=z;v.push(V,$,W,$,G,W)}}function O(z){return isFinite(z.x)&&isFinite(z.y)&&isFinite(z.z)}}var{abs:Q_,min:X_,max:d0,sqrt:Lle,round:v9,log10:C9,tan:PO,atan:S9,PI:Ple}=Math,tI=50,E9=6.75,yl=1,Uy=1,p0=.002,zy=30,u0=class{constructor(e,t){this.pickingColorManager=new Y_,this.perspective=1,this.lastFrameExpressionTooComplexIDs=new Set,this.debugOnlyMeasureGPUTiming=!1,this.lastRenderInfo={peelLayers:0,triangles:0,bufferUploads:0,bufferUploadItems:0,startTimeCPU:0,durationCPU:0},this.mainCopyOutputPass=new bl(m9),this.concatPass=new bl(g9),this.pickingPassCacheKey="",this.pickResult={pickingReadCacheKey:""},this.worldViewCacheKeyInfo={math:[new ye(0,0,0),new ye(1,0,0),new ye(0,1,0),new ye(0,0,1)],clip:[new ye(0,0,0),new ye(1,0,0),new ye(0,1,0),new ye(0,0,1)]},this.domainObjectUpdates=0;var r,n;let{config:i}=t.getGraphSettings();this.debug=new V_({filter:(r=i.debug3dRender)!=null?r:null}),(n=i.debug3dRender)!=null&&n.includes("pick")&&(Uy=5,yl=5),this.surfaces={},this.renderedTabTargets={},this.renderedTabTargetOrder=[],this.isTrackingPressedAction=!1,this.scene=new eu,this.spinningWorld=new Ii,this.world=new Ii,this.spinningWorld.add(this.world),this.scene.add(this.spinningWorld),this.controller=t,this.materialManager=new j_,this.cameraDistance=tI,this.camera=new xh,this.axesMaterials=Y7(this.materialManager.getGlobalUniforms()),this.setBackgroundColor(t.getGraphSettings().backgroundColor3d),this.canvas=e,this.renderer=Vle(this.canvas),this.mainRenderTarget=new Oa(this.canvas.width,this.canvas.height,{colorSpace:Ga,samples:4}),this.mainCopyOutputPass.defines.SRGB_COLOR_SPACE=!1;let o=new Gy(4210752,Math.PI);this.scene.add(o);let a=2.8,s=new Ch(16777215,a);s.position.set(-1,1,1),this.scene.add(s);let l=new Ch(16777215,a);l.position.set(-1,-1,0),this.scene.add(l),this.controller.getGraphSettings().config.observeAndSync("disableLighting",()=>{this.materialManager.setDisableLighting(this.controller.getGraphSettings().config.disableLighting)}),this.initDepthPeel(),this.updateDomainObjects(),this.initPickingTargets()}getNumberOfSurfaces(){return Object.keys(this.surfaces).length}showPlane(e){this.domainPlane!==void 0&&(e?this.world.add(this.domainPlane):this.world.remove(this.domainPlane))}showBox(e){e?this.world.add(this.domainBox):this.world.remove(this.domainBox);for(let t in this.surfaces)this.deleteSurface(t)}showAxes(e){e?this.world.add(this.domainAxes):this.world.remove(this.domainAxes)}updateCamera(){let e=this.canvas.width/this.canvas.height,t=this.controller.getPerspectiveDistortion();if(t===0&&!(this.camera instanceof Xp)?this.depthPeel.camera=this.camera=new Xp:t!==0&&!(this.camera instanceof xh)&&(this.depthPeel.camera=this.camera=new xh),this.camera instanceof xh){let r=Ple/360,n=E9/X_(e,1);this.cameraDistance=tI/t,this.camera.position.set(-this.cameraDistance,0,0),this.camera.fov=S9(t*PO(r*n))/r}else this.cameraDistance=50,this.camera.position.set(-this.cameraDistance,0,0),e>1?(this.camera.left=-2.95*e,this.camera.right=2.95*e,this.camera.bottom=-2.95,this.camera.top=2.95):(this.camera.left=-2.95,this.camera.right=2.95,this.camera.bottom=-2.95/e,this.camera.top=2.95/e);this.camera.up.set(0,0,1),this.camera.lookAt(new ye(0,0,0)),this.camera.updateProjectionMatrix(),this.perspective=t}initDepthPeel(){this.depthPeel=new $_(this.controller,this.renderer,this.materialManager,this.scene,this.camera,this.debug)}initPickingTargets(){let e=yl,t=Uy;this.pickingTargets={id:new Oa(e,t,{type:Vn}),x:new Oa(e,t,{type:Vn}),y:new Oa(e,t,{type:Vn}),z:new Oa(e,t,{type:Vn}),combined:new Oa(e*4,t,{type:Vn})}}debugOnlyTrackBufferUploads(){let e=this;ha.prototype.onUploadCallback=function(){e.lastRenderInfo.bufferUploads++,e.lastRenderInfo.bufferUploadItems+=this.array.length}}debugGetPrograms(){return this.renderer.info.programs||[]}getClipAxes(e){return this.controller.getGraphSettings().showBox3D?{x:!0,y:!0,z:!0}:e!=null?e:{x:!1,y:!1,z:!1}}setBackgroundColor(e){this.backgroundColor=new vt(e),this.updateBackgroundColor()}updateBackgroundColor(){if(this.controller.invertSwatches()){let{r:e,g:t,b:r}=this.backgroundColor;this.scene.background=new vt,this.scene.background.setRGB(1-e,1-t,1-r)}else this.scene.background=this.backgroundColor}domain(){var e,t;let r=this.controller.getGrapher3d();if(r){let n=r.viewportController.getViewport(),i=n.xmin,o=n.xmax,a=n.ymin,s=n.ymax,l=(e=n.zmin)!=null?e:-2,c=(t=n.zmax)!=null?t:2;return{xmin:i,xmax:o,ymin:a,ymax:s,zmin:l,zmax:c}}else return new __dcg_shared_module_exports__.Yd}updateAxes(){this.domainAxes!==void 0&&(this.world.remove(this.domainAxes),kO(this.domainAxes)),this.domainAxes=Z7(this.domain(),this.controller.get2dProjection().screen,this.controller.getGraphSettings().showAxisLabels3D,this.axesMaterials),this.controller.getGraphSettings().showAxis3D&&this.world.add(this.domainAxes)}updateBox(){let e=this.domain();this.domainBox?(this.updateDomainBoxColor(),X7(this.domainBox,e)):this.domainBox=TO(e,this.getDomainBoxColor(),this.materialManager.getGlobalUniforms());let t=this.controller.getGraphSettings().showBox3D,r=this.domainBox.parent===this.world;t!==r&&(t?this.world.add(this.domainBox):this.world.remove(this.domainBox))}getDomainBoxColor(){var e;return this.controller.isGraphPaperFocused()&&!((e=this.controller.getGrapher3d())!=null&&e.isDragging)&&this.controller.getGrapher2d().poiController.keyboardAttentionManager.getKeyboardAttention()===void 0?this.controller.getInvertedColors()?16777215:0:11184810}updateDomainBoxColor(){let{showBox3D:e}=this.controller.getGraphSettings();if(!e||!this.domainBox)return;let t=this.getDomainBoxColor();t!==this.domainBoxColor&&(this.domainBoxColor=t,this.world.remove(this.domainBox),DO(this.domainBox),this.domainBox=TO(this.domain(),t,this.materialManager.getGlobalUniforms()),this.world.add(this.domainBox))}updatePlaneMap(){this.disposePlaneTextureIfResized(),this.domainPlaneMaterials!==void 0&&(this.domainPlaneMaterials.xyNumbersMaterial.uniforms.map.value.needsUpdate=!0,this.domainPlaneMaterials.zMaterial.uniforms.map.value.needsUpdate=!0)}disposePlaneTextureIfResized(){let e=this.controller.getGrapher2d().getCanvasNode();this.domainPlaneMaterials&&(e.width!==this.domainPlaneMaterials.width||e.height!==this.domainPlaneMaterials.height)&&(_O(this.domainPlaneMaterials.xyNumbersMaterial),_O(this.domainPlaneMaterials.zMaterial),this.domainPlaneMaterials=void 0)}disposePlane(){this.domainPlane!==void 0&&(this.world.remove(this.domainPlane),o9(this.domainPlane),this.domainPlane=void 0)}updatePlane(){this.disposePlaneTextureIfResized(),this.disposePlane(),this.domainPlaneMaterials=this.constructDomainMaterials(),this.domainPlaneMaterials&&(this.domainPlane=new z_(this.domain(),this.domainPlaneMaterials,this.controller.getGrapher2d().getProjection(),this.axesMaterials,this.materialManager.getGlobalUniforms()),this.domainPlane.xyPlane&&this.pickingColorManager.setPickingColorForMesh({mesh:this.domainPlane.xyPlane,isPoint:!1,blocksPicking:!0,forceOpaque:!0,branchId:"**dcg_domain_plane_picking_id**"}),(this.controller.showPlane3D()||this.controller.showNumbers3D())&&this.world.add(this.domainPlane))}constructDomainMaterials(){var e,t,r,n,i;let{showNumbers3D:o,showPlane3D:a}=this.controller.getGraphSettings(),s=this.computeDepthPeelLayers()>0;if(this.domainPlaneMaterials!==void 0&&this.domainPlaneMaterials.showPlane3D===a&&this.domainPlaneMaterials.showNumbers3D===o&&this.domainPlaneMaterials.depthPeelingActive===s)return this.domainPlaneMaterials;(t=(e=this.domainPlaneMaterials)==null?void 0:e.xyNumbersMaterial)==null||t.dispose(),(r=this.domainPlaneMaterials)==null||r.xyPlaneMaterial.dispose(),(i=(n=this.domainPlaneMaterials)==null?void 0:n.zMaterial)==null||i.dispose();let l=this.controller.getGrapher2d().getCanvasNode();if(l.width===0||l.height===0)return;let c=this.materialManager.getOrMakeMaterial({type:"domain-plane",spec:{type:"domain-plane-numbers-material",canvas:l,showNumbers:o,transparent:a&&!s}}),d=document.createElement("canvas");d.width=l.width,d.height=l.height;let u=this.materialManager.getOrMakeMaterial({type:"domain-plane",spec:{type:"domain-plane-numbers-material",canvas:d,showNumbers:o,transparent:!1}}),p=this.controller.getGraphSettings().plane3dOpacity,g=Number(p);if((p===""||isNaN(g))&&(g=.5),g=__dcg_shared_module_exports__.Sb(g,0,1),g<p0)return;let f=this.materialManager.getOrMakeMaterial({type:"domain-plane",spec:{type:"domain-plane-material",opacity:g,transparent:!s,color:new vt(16777215)}});return{zCanvas:d,zMaterial:u,xyNumbersMaterial:c,xyPlaneMaterial:f,width:l.width,height:l.height,showNumbers3D:o,showPlane3D:a,depthPeelingActive:s}}computeDepthPeelLayers(){let e=this.computeDesiredDepthPeelLayersFromGeometry(),t=X_(e,zy);if(e===0)return 0;if(!this.getConfig().adaptivePeeling)return t;let r=this.controller.getAdaptiveDepthPeelingInfo(),n=e;if(r){let{peelLayers:i,status:o}=r;if(o===1){let a=Math.ceil(zy/3);n=(Math.floor(i/a)+1)*a}else o===0?n=i-1:n=i}return __dcg_shared_module_exports__.Sb(n,1,t)}getConfig(){return this.controller.getGraphSettings().config}computeDesiredDepthPeelLayersFromGeometry(){let{debugPeelLayers:e}=this.getConfig();if(e!==void 0)return e;let t=1,r=0;for(let i in this.surfaces){let o=this.surfaces[i];if(o.isTransparent){let a=__dcg_shared_module_exports__.Sb(o.mesh.material.opacity,0,1);if(a<p0)continue;a<t&&(t=a),o.shape==="plane"?r+=1:o.shape==="sphere"?r+=2:r+=v9(-2/C9(1-a))}}if(t===1)return 0;let n=X_(r,v9(-2/C9(1-t)));return this.controller.showPlane3D()&&(n+=1),d0(1,n)}updateDomainObjects(){this.domainObjectUpdates++,this.updateAxes(),this.updateBox(),this.updatePlane();let e=this.domain(),{xmin:t,xmax:r,ymin:n,ymax:i,zmin:o,zmax:a}=e;this.spinningWorld.scale.set(4/(r-t),4/(i-n),4/(a-o)),this.world.position.set(-(r+t)/2,-(i+n)/2,-(a+o)/2),this.materialManager.setDomain(e,this.controller.getGrapher2d().getProjection()),this.updateDomainObjectsFromCamera()}getZBoundsForAnimationForNewSurface(e){var t;let r=(t=this.controller.getGrapher3d())==null?void 0:t.transition,n=r==null?void 0:r.objectIdExtendingTo3D,{zmin:i,zmax:o}=this.domain(),a=window.performance.now();if(n&&e.startsWith(n+":")){r.startTime<0&&(r.startTime=a);let s=(a-r.startTime)/r.duration;return s>=1?_h:{zMinForAnimation:s*i,zMaxForAnimation:s*o}}return _h}setZboundsOnSurfaces(e,t,r){for(let n in this.surfaces)if(n.startsWith(e+":")){let i=this.surfaces[n].mesh.material;this.materialManager.setZBoundsUniform(i,{zMinForAnimation:t,zMaxForAnimation:r})}}deleteSurface(e){let t=this.surfaces[e];if(!t)return;this.world.remove(t.mesh);let r=t.mesh.geometry;Ole(r)||r.dispose(),delete this.surfaces[e]}getColorShader(e){if(e.startsWith("shader:"))return this.controller.getShader(e.slice(7))}renderPoint3D(e,t,r){let{position:n,radius:i,guid:o}=e;if(i<=0||!isFinite(i))return;let a=this.domain(),{xmin:s,xmax:l,ymin:c,ymax:d,zmin:u,zmax:p}=a,g=this.makeCacheKey(o,a);this.surfaces[t]&&(this.surfaces[t].cacheKey!==g||this.surfaces[t].materialColor!=r)&&this.deleteSurface(t);let[f,y,E]=n,_=i*(l-s)/4,w=i*(d-c)/4,v=i*(p-u)/4;if(!this.surfaces[t]){let T=this.materialManager.getOrMakeMaterial({type:"surface-graph",spec:{type:"surface-material",objectId:t,color:r,opacity:1,colorShader:this.getColorShader(r)},uniforms:{domain:a,clip:this.getClipAxes(),zBoundsForAnimation:_h}}),M=J_(i),C=new Ai(M,T);C.dcgModelMatrix=new Nt().makeTranslation(f,y,E).multiply(new Nt().makeScale(_,w,v)),this.surfaces[t]={mesh:C,cacheKey:g,isNotInSketchOrder:!1,materialColor:r,isTransparent:!1,isPoint:!0},this.world.add(C)}this.surfaces[t].isNotInSketchOrder=!1}makeCacheKey(e,t){return e+":"+JSON.stringify(t)}renderPointList3D(e,t){let r=this.domain(),{xmin:n,xmax:i,ymin:o,ymax:a,zmin:s,zmax:l}=r,{pressedId:c}=this.pressedActionData(),d=this.highlightedIndex(e),u=t.map(g=>g.color+"_"+g.guid).join(":")+`:${d}:${e===c}`,p=this.makeCacheKey(u,r);if(this.surfaces[e]&&this.surfaces[e].cacheKey!==p&&this.deleteSurface(e),!this.surfaces[e]){let g="",f=this.materialManager.getOrMakeMaterial({type:"surface-graph",spec:{type:"surface-material",objectId:e,color:g,opacity:1,colorShader:this.getColorShader(g)},uniforms:{domain:r,clip:this.getClipAxes(),zBoundsForAnimation:_h}}),y=t[0];if(y.graphMode!==114)return;let E=J_(y.radius),_=new Mi(E,f,t.length);for(let w=0;w<t.length;w++){let v=t[w];if(v.graphMode!==114)return;let[T,M,C]=v.position,P=v.radius,F=this.needsHighlighting(e,w)?vm(v.color,this.highlightAmount(e,w)):v.color,B=P*(i-n)/4,x=P*(a-o)/4,L=P*(l-s)/4;if(P<=0||!isFinite(P)||J_(P)!==E)return;let N=new Nt().makeTranslation(T,M,C).multiply(new Nt().makeScale(B,x,L));_.setMatrixAt(w,N),_.setColorAt(w,new vt(F))}this.surfaces[e]={mesh:_,cacheKey:p,isNotInSketchOrder:!1,materialColor:g,isTransparent:!1,isPoint:!0},this.world.add(_)}return this.surfaces[e].isNotInSketchOrder=!1,this.surfaces[e]}renderSphere3D(e,t,r){var n,i;let{position:o,radius:a,restrictionShader:s,guid:l}=e,c=e.surfaceOpacity;if(!this.getConfig().beta3d&&!this.controller.getTranslucentSurfaces()&&(c=1),c<p0)return;let d=((n=this.getColorShader(r))==null?void 0:n.source)||"";this.surfaces[t]&&(this.surfaces[t].cacheKey!==l||this.surfaces[t].materialColor!=r||d!=((i=this.surfaces[t].shader)!=null?i:""))&&this.deleteSurface(t);let[u,p,g]=o,[f,y,E]=[Q_(a[0]),Q_(a[1]),Q_(a[2])],{xmin:_,xmax:w,ymin:v,ymax:T,zmin:M,zmax:C}=this.domain(),[P,F,B]=[w-_,T-v,C-M],x=2*d0(f/P,y/F,E/B);if(!this.surfaces[t]){let L=this.materialManager.getOrMakeMaterial({type:"surface-graph",spec:{type:"surface-material",objectId:t,color:r,opacity:c,colorShader:this.getColorShader(r),restrictionShader:s},uniforms:{domain:this.domain(),clip:this.getClipAxes(),zBoundsForAnimation:_h}}),N=J_(x),O=new Ai(N,L);O.dcgModelMatrix=new Nt().makeTranslation(u,p,g).multiply(new Nt().makeScale(f,y,E)),this.surfaces[t]={mesh:O,material:L,cacheKey:l,isNotInSketchOrder:!1,materialColor:r,isTransparent:c<1,shape:"sphere",shader:d},this.world.add(O)}this.surfaces[t].isNotInSketchOrder=!1}renderCurve3D(e,t,r){var n,i;let{points:o,thickness:a,guid:s}=e,l=VO(e.graphMode);if(a<0||!isFinite(a))return;let c=this.domain(),d=s+":"+JSON.stringify(a)+":"+JSON.stringify(c),u=this.surfaces[t],p=((n=this.getColorShader(r))==null?void 0:n.source)||"";if(u&&(u.cacheKey!==d||u.materialColor!=r||p!=((i=u.shader)!=null?i:""))&&this.deleteSurface(t),!(o===void 0||o.length===0||a===0)){if(!this.surfaces[t]){let g=this.materialManager.getOrMakeMaterial({type:"surface-graph",spec:{type:"surface-material",objectId:t,color:r,opacity:1,colorShader:this.getColorShader(r)},uniforms:{domain:c,clip:this.getClipAxes(l),zBoundsForAnimation:_h}}),f=.01*a,[y,E,_]=u9(o,f,c),w=Z_(new Float32Array(y),new Float32Array(E),new Uint32Array(_)),v=new Ai(w,g);this.surfaces[t]={mesh:v,cacheKey:d,isNotInSketchOrder:!1,isTransparent:!1,materialColor:r},this.world.add(v)}this.surfaces[t].isNotInSketchOrder=!1}}renderVector3D(e,t,r,n){var i,o;let a=this.isClickable(t),s=t===this.pressedActionData().pressedId,l=this.highlightedIndex(t),c=t+`:${r}`,{points:d,thickness:u,guid:p}=e,g=VO(e.graphMode),f=this.domain(),y=JSON.stringify(f),E=`${p}:${y}:${u}:${l}:${s}`,_=this.surfaces[c],w=((i=this.getColorShader(n))==null?void 0:i.source)||"";if(_&&(_.cacheKey!==E||_.materialColor!=n||w!=((o=_.shader)!=null?o:""))&&this.deleteSurface(c),d===void 0||d.length<6||d.length%6!=0)return;this.needsHighlighting(t,r)&&d.length===6&&(n=vm(n,this.highlightAmount(t,r)));let v=l!==void 0&&d.length>6,T=vm(n,this.highlightAmount(t,l)),M=__dcg_shared_module_exports__.Qd(n),C=__dcg_shared_module_exports__.Qd(T);if(!this.surfaces[c]){let P=d.length>6&&a,F=this.materialManager.getOrMakeMaterial({type:"surface-graph",spec:{type:"surface-material",objectId:c,color:n,opacity:1,colorShader:this.getColorShader(n),vertexColors:v,useVertexPickingColors:P},uniforms:{domain:f,clip:this.getClipAxes(g),zBoundsForAnimation:_h}}),B=P?[]:void 0,x=.01*u,L=[],N=[],O=[],z=[];for(let G=0;G<d.length;G+=6){let W=new ye(d[G],d[G+1],d[G+2]),U=new ye(d[G+3],d[G+4],d[G+5]),[D,de,ge]=y9(W,U,x,f),K=L.length/3;if(L.push(...D),N.push(...de),O.push(...ge.map(se=>se+K)),B==null||B.push(D.length/3),v){let se=G/6===l?C:M;for(let H=0;H<D.length/3;H++)z.push(se[0],se[1],se[2])}}let V=Z_(new Float32Array(L),new Float32Array(N),new Uint32Array(O));v&&V.setAttribute("color",new ha(new Float32Array(z),3));let $=new Ai(V,F);this.surfaces[c]={mesh:$,cacheKey:E,isNotInSketchOrder:!1,isTransparent:!1,materialColor:n,pickingColorVertexCounts:B},this.world.add($)}this.surfaces[c].isNotInSketchOrder=!1}renderTriangle3D(e,t,r,n){if(e.surfaceOpacity<p0)return;let i=this.isClickable(t),o=t+`:${r}`,a=t===this.pressedActionData().pressedId,s=this.highlightedIndex(t),l=`:${s}:${a}`,c=e.meshData.faces.length/3,{meshData:d}=e,u=vm(n,this.highlightAmount(t,s)),p=__dcg_shared_module_exports__.Qd(n),g=__dcg_shared_module_exports__.Qd(u),f=[],y=c>1&&i;if(this.needsHighlighting(t,r)&&c===1&&(n=vm(n,this.highlightAmount(t,r))),s!==void 0&&c>1)if(d.colors&&s!=null){let _=d.colors,w=new Float32Array(_),v=9*s,T=255*__dcg_shared_module_exports__.Pd(_[v]),M=255*__dcg_shared_module_exports__.Pd(_[v+1]),C=255*__dcg_shared_module_exports__.Pd(_[v+2]),P=__dcg_shared_module_exports__.Ld(T,M,C),F=vm(P,this.highlightAmount(t,r)),B=__dcg_shared_module_exports__.Qd(F);w.set([...B,...B,...B],v),e=ie(R({},e),{meshData:ie(R({},e.meshData),{colors:w})})}else{for(let w=0;w<d.faces.length;w+=3){let v=w/3===s?g:p;f.push(v[0],v[1],v[2],v[0],v[1],v[2],v[0],v[1],v[2])}let _=new Float32Array(f);e=ie(R({},e),{meshData:ie(R({},e.meshData),{colors:_})})}let E=this.renderSurface(e,o,n,y,l);if(y){let _=[];for(let w=0;w<c;w++)_.push(3);E&&(E.pickingColorVertexCounts=_)}}renderSurface(e,t,r,n=!1,i=""){var o,a,s;this.getConfig().wireframe&&(r="wireframe:"+r);let{meshData:l,surfaceOpacity:c}=e;if(!this.getConfig().beta3d&&!this.controller.getTranslucentSurfaces()&&(c=1),c<p0)return;let{uvArgs:d,restrictionShader:u}=e,p=(o=e.extraMeshArgs)!=null?o:[],g=VO(e.graphMode),f=((a=this.getColorShader(r))==null?void 0:a.source)||"",y=this.domain(),E=l.guid+i;if(this.surfaces[t]&&(this.surfaces[t].cacheKey!==E||this.surfaces[t].materialColor!=r||f!=((s=this.surfaces[t].shader)!=null?s:"")||l.isDomainCube&&!Rle(y,this.surfaces[t].domain))&&this.deleteSurface(t),!this.surfaces[t]){let _=this.materialManager.getOrMakeMaterial({type:"surface-graph",spec:{type:"surface-material",objectId:t,color:r,opacity:c,colorShader:this.getColorShader(r),vertexColors:!!l.colors,useVertexPickingColors:n,restrictionShader:u,uvArgs:d,extraMeshArgs:p},uniforms:{domain:y,clip:this.getClipAxes(g),zBoundsForAnimation:l.isDomainCube?_h:this.getZBoundsForAnimationForNewSurface(t)}});if(l.isDomainCube){let T=y,M=this.controller.getGrapher3d().transition;if(M.objectIdExtendingTo3D&&M.startTime>0){let C=M.objectIdExtendingTo3D;if(C&&t.startsWith(C+":")){let P=this.domain(),{zmin:F,zmax:B}=P,x=(window.performance.now()-M.startTime)/M.duration;x<1&&(T.zmin=x*F,T.zmax=x*B)}}l.positions=__dcg_shared_module_exports__.Wd(T).positions}let w=Z_(l.positions,l.normals,l.faces);w.setAttribute("uv",new Bo(l.uvs,2)),p.length>0&&w.setAttribute("extras",new Bo(l.extraAttrs,p.length)),l.colors&&w.setAttribute("color",new ha(l.colors,3));let v=new Ai(w,_);this.surfaces[t]={mesh:v,material:_,cacheKey:E,isNotInSketchOrder:!1,materialColor:r,shader:f,isTransparent:c<1,shape:Fle(l,y)?"plane":void 0,domain:y},this.world.add(v)}return this.surfaces[t].isNotInSketchOrder=!1,this.surfaces[t]}projectMathCoordinates(e,t=new ye){return t.copy(e).applyMatrix4(this.world.matrixWorld).project(this.camera)}finalizeSurface(e){let{branchId:t,surface:r,renderOrder:n,isSurfaceSelected:i}=e;this.pickingColorManager.setPickingColorForMesh({branchId:t,mesh:r.mesh,isPoint:!!r.isPoint,blocksPicking:!1,forceOpaque:!1,pickingColorVertexCounts:r.pickingColorVertexCounts});let o=r==null?void 0:r.mesh.material;r&&o instanceof kh&&(r.mesh.renderOrder=n,o.setEmissiveIntensity(i?.015:0))}needsHighlighting(e,t){if(!this.isClickable(e))return!1;let{keyboardFocusId:r,keyboardFocusIndex:n}=this.getKeyboardFocus(),{pressedId:i,pressedIndex:o}=this.pressedActionData(),a=this.getPickResult(),s=a==null?void 0:a.id,l=a==null?void 0:a.index;return e===s&&t===l||e===r&&t===n||e===i&&t===o}highlightedIndex(e){if(!this.isClickable(e))return;let{keyboardFocusId:t,keyboardFocusIndex:r}=this.getKeyboardFocus(),{pressedId:n,pressedIndex:i}=this.pressedActionData(),o=this.getPickResult(),a=o==null?void 0:o.id,s=o==null?void 0:o.index;if(e===a)return s;if(e===t)return r;if(e===n)return i}highlightAmount(e,t){let{pressedId:r,pressedIndex:n}=this.pressedActionData();return e===r&&t===n?.16:.24}redraw(e,t){var r,n,i;(r=this.debug)==null||r.removeUnused();let o=this.controller.getGrapher3d();if(o===void 0)return;this.renderedTabTargets={},this.renderedTabTargetOrder=[];let a=this.canvas,s=performance.now(),l=this.lastRenderInfo={peelLayers:0,bufferUploadItems:0,bufferUploads:0,triangles:0,startTimeCPU:s,durationCPU:0},c=this.renderer;c.setRenderTarget(this.mainRenderTarget),this.updateBackgroundColor(),this.updateDomainObjectsFromCamera(),this.updateCamera();let d=window.devicePixelRatio||1;d!==c.getPixelRatio()&&(c.setPixelRatio(d),o.controls.updateViewport(o.viewportController.getViewport())),this.camera.setViewOffset(a.width/d,a.height/d,0,0,a.width/d,a.height/d),c.setSize(a.width/d,a.height/d);for(let O in this.surfaces)this.surfaces[O].isNotInSketchOrder=!0;let u=this.getPickResult();this.isClickable(u==null?void 0:u.id)?o.setLayerClass("clickableObjects","dcg-mouse-over-clickable-object"):o.setLayerClass("clickableObjects",void 0);let p=0;for(let O of Rv(t)){let z=e[O];if(!z||!z.branches)continue;let V=this.controller.isItemSelected(O),$=this.controller.getItemModel(O),G=this.isClickable(O);if(($==null?void 0:$.type)==="expression"&&(Lg($)||$u($))){let W=this.renderPointList3D(O,z.branches);if(W){if(p+=1,this.finalizeSurface({branchId:O,surface:W,renderOrder:p,isSurfaceSelected:V}),G)for(let U=0;U<z.branches.length;U++)this.addTabTarget($,U);continue}}for(let W in z.branches){p+=1;let U=z.branches[W],D=O+":"+W,de=U.color,ge=parseInt(W);this.needsHighlighting(O,ge)&&(de=vm(de,this.highlightAmount(O,ge))),U.graphMode===130||U.graphMode===103||U.graphMode===106||U.graphMode===107||U.graphMode===108||U.graphMode===109||U.graphMode===110||U.graphMode===111||U.graphMode===112||U.graphMode===113||U.graphMode===210?this.renderSurface(U,D,de):U.graphMode===100||U.graphMode===119||U.graphMode===128?this.renderCurve3D(U,D,de):U.graphMode===114?this.renderPoint3D(U,D,de):U.graphMode===118?this.renderSphere3D(U,D,de):U.graphMode===117?this.renderTriangle3D(U,O,ge,U.color):U.graphMode===129&&this.renderVector3D(U,O,ge,U.color);let K=this.surfaces[D];if(K&&(this.finalizeSurface({branchId:D,surface:K,renderOrder:p,isSurfaceSelected:V}),G))if(U.graphMode===117){let se=U.meshData.faces.length/3;for(let H=0;H<se;H++)this.addTabTarget($,H)}else if(U.graphMode===129&&ge===0){let se=U.points.length/6;for(let H=0;H<se;H++)this.addTabTarget($,H)}else this.addTabTarget($,ge)}}let g=2.0001*Lle(3),{xmin:f,xmax:y,ymin:E,ymax:_,zmin:w,zmax:v}=this.domain(),T=new ye((y+f)/2,(_+E)/2,(v+w)/2),M=4/d0(y-f,_-E,v-w);for(let O in this.surfaces)if(this.surfaces[O].isNotInSketchOrder)this.deleteSurface(O);else if(!this.controller.getGraphSettings().showBox3D){let z=this.surfaces[O].mesh.geometry;z.boundingSphere===null&&z.computeBoundingSphere();let V=z.boundingSphere;if(V===null)continue;let $=(new ye().subVectors(T,V.center).length()+V.radius)*M;g=d0(g,$)}let C=this.computeDepthPeelLayers();C>0!==((n=this.domainPlaneMaterials)==null?void 0:n.depthPeelingActive)&&this.updateDomainObjects();let P=this.controller.getPerspectiveDistortion(),F=1e3/(0<P&&P<1?P:1),B=d0(.001,this.cameraDistance-g),x=X_(F,this.cameraDistance+g);this.camera.near=B,this.camera.far=x,this.camera.updateProjectionMatrix(),this.materialManager.setGlobalUniform("dcgRenderMode",gs.Default),this.mainRenderTarget.setSize(a.width,a.height),this.renderer.setRenderTarget(this.mainRenderTarget),this.materialManager.setScreenSize(a.width,a.height),l.peelLayers=C,C>0?(this.depthPeel.render(C),l.triangles=this.depthPeel.triangles):(c.render(this.scene,this.camera),l.triangles=this.renderer.info.render.triangles),C==0&&this.mainCopyOutputPass.render(c,null,this.mainRenderTarget),this.debugOnlyMeasureGPUTiming&&V7(this.renderer).then(O=>{l.endTimeGPU=O}),l.durationCPU=performance.now()-s,this.materialManager.disposeMaterialsNotInScene(this.scene),this.pickingColorManager.disposeColorsNotInScene(this.scene);let L=new Set;for(let O in this.surfaces)(i=this.surfaces[O].material)!=null&&i.exprTooComplex&&L.add(MO(O));let N=[];for(let O of this.lastFrameExpressionTooComplexIDs)L.has(O)||N.push(O);(L.size>0||N.length>0)&&this.controller.dispatch({type:"mark-too-complex-for-gl",errors:L,fixed:N}),this.lastFrameExpressionTooComplexIDs=L,this.onRenderSpy&&this.onRenderSpy()}updateDomainObjectsFromCamera(){let e=this.controller.getGrapher3d();e&&t9({axes:this.domainAxes,plane:this.domainPlane,domain:this.domain(),screen:this.controller.get2dProjection().screen,controls:e.controls,invertedColors:this.controller.getInvertedColors(),isDepthPeelingActive:this.computeDepthPeelLayers()>0})}pickAtMouseAndReadResults(){this.pickingPass(),this.readPickingOutputFromGPU()}getAllSurfaceGeoemtriesCacheKey(){let e="";for(let t in this.surfaces){let r=this.surfaces[t];e+=r.cacheKey}return e+="|domainUpdates:"+this.domainObjectUpdates,e}getPickingCacheKey(){var e,t;return`world:${this.getWorldViewCacheKey()}:mouse:${(e=this.mouse)==null?void 0:e.x},${(t=this.mouse)==null?void 0:t.y}:surfaces:${this.getAllSurfaceGeoemtriesCacheKey()}`}pickingPass(){if(this.controller.getGrapher3d()===void 0)return;let e=this.mouse;if(!e)return;let t=this.pickingPassCacheKey,r=this.getPickingCacheKey();if(t===r)return;this.pickingPassCacheKey=r;let n=this.scene.background,i=this.renderer.getClearColor(new vt),o=new Map;this.world.children.forEach(u=>{var p;if(o.set(u,u.visible),u instanceof Ai){let g=u.material;u.visible=!!((p=g.defines)!=null&&p.DCG_SUPPORTS_PICKING)}else u.visible=!1}),this.domainPlane&&o.get(this.domainPlane)&&(this.domainPlane.visible=!0,this.domainPlane.children.forEach(u=>{o.set(u,u.visible),u.visible=u.name==="xy plane"}));let a=window.devicePixelRatio,s=Math.floor(yl/2),l=Math.floor(Uy/2),[c,d]=[Math.floor(e.x*a)-s,Math.floor(e.y*a)-l];this.camera.setViewOffset(this.renderer.domElement.width,this.renderer.domElement.height,c,d,yl,Uy),this.renderer.setClearColor(new vt(0),0),this.scene.background=null,this.materialManager.setGlobalUniform("dcgRenderMode",gs.PickingObjectId),this.renderer.setRenderTarget(this.pickingTargets.id),this.renderer.clearColor(),this.renderer.render(this.scene,this.camera),this.materialManager.setGlobalUniform("dcgRenderMode",gs.PickingX),this.renderer.setRenderTarget(this.pickingTargets.x),this.renderer.clearColor(),this.renderer.render(this.scene,this.camera),this.materialManager.setGlobalUniform("dcgRenderMode",gs.PickingY),this.renderer.setRenderTarget(this.pickingTargets.y),this.renderer.clearColor(),this.renderer.render(this.scene,this.camera),this.materialManager.setGlobalUniform("dcgRenderMode",gs.PickingZ),this.renderer.setRenderTarget(this.pickingTargets.z),this.renderer.clearColor(),this.renderer.render(this.scene,this.camera),this.concatPass.uniforms.t0={value:this.pickingTargets.id.texture},this.concatPass.uniforms.t1={value:this.pickingTargets.x.texture},this.concatPass.uniforms.t2={value:this.pickingTargets.y.texture},this.concatPass.uniforms.t3={value:this.pickingTargets.z.texture},this.camera.clearViewOffset(),this.renderer.setClearColor(i),this.scene.background=n,o.forEach((u,p)=>{p.visible=u}),this.concatPass.render(this.renderer,this.pickingTargets.combined,this.pickingTargets.combined)}readPickingOutputFromGPU(){var e,t,r;let n=this.getPickingCacheKey();if(this.pickResult.pickingReadCacheKey===n)return;let i=Math.floor(yl/2),o=Math.floor(Uy/2),a=L_(this.renderer,this.pickingTargets.combined,0,0,yl*4,Uy),s=l0(a,yl*4,i,o),l=l0(a,yl*4,yl+i,o),c=l0(a,yl*4,2*yl+i,o),d=l0(a,yl*4,3*yl+i,o),u=P_(l),p=P_(c),g=P_(d);if((e=this.debug.get("pick-combined"))==null||e.renderFromTarget(this.renderer,this.pickingTargets.combined,10),s.every(T=>T===0)){this.pickResult={pickingReadCacheKey:n};return}let f=this.pickingColorManager.getDataForPickingColor(s);if(!f){this.pickResult={pickingReadCacheKey:n};return}if(f.blocksPicking){this.pickResult={pickingReadCacheKey:n};return}let y=(r=(t=this.pickResult.result)==null?void 0:t.point)!=null?r:new ye;if(y.set(u,p,g),f.isPoint){let T=f.mesh,M;T instanceof Mi?(M=new Nt,T.getMatrixAt(f.index,M)):M=f.mesh.dcgModelMatrix,y=new ye(0,0,0).applyMatrix4(M)}let E=f.pickingId.split(":"),_=E.length,w=E[0],v=_>1?parseInt(E[_-1]):-1;this.pickResult={pickingReadCacheKey:n,result:{point:y,id:w,index:v}}}isClickable(e){if(e===void 0)return!1;let t=this.controller.getItemModel(e);return!!bb(t)}getPickResult(){return this.pickResult.result}getKeyboardFocus(){let e=this.controller.getGrapher2d().poiController.keyboardAttentionManager.getKeyboardAttention(),t=e==null?void 0:e.calcId,r=e==null?void 0:e.listIndex;return{keyboardFocusId:t,keyboardFocusIndex:r}}pressedActionData(){var e,t;let r=(e=this.pressedAction)==null?void 0:e.id,n=(t=this.pressedAction)==null?void 0:t.index;return{pressedId:r,pressedIndex:n}}getZoomScrollWheelPickResult(){if(this.controller.getGrapher3d().controls.speed3D===0)return this.getPickResult()}getMouse(){return this.mouse}setMouse(e){this.mouse=e}getWorldViewCacheKey(){let{math:e,clip:t}=this.worldViewCacheKeyInfo,r="";for(let n=0;n<e.length;n++)this.projectMathCoordinates(e[n],t[n]),r+=`:${t[n].x},${t[n].y}`;return r}baseplaneMultiplier(){let e=E9*(Math.PI/360),t=this.camera instanceof xh?S9(this.perspective*PO(e)):e;return 2/(PO(t)*-this.camera.position.x)}mathCoordinatesToBufferCoordinates(e){let t=new ye(e.x,e.y,e.z).applyMatrix4(this.world.matrixWorld).project(this.camera),r=this.canvas,n=r.width/2,i=r.height/2,o=Math.round(t.x*n+n),a=Math.round(t.y*i+i);return{x:o,y:a}}mathCoordinatesToScreenCoordinates(e,t){let r=new ye(e.x,e.y,e.z).applyMatrix4(this.world.matrixWorld).project(this.camera),n=this.canvas,i=window.devicePixelRatio,o=n.width/i/2,a=n.height/i/2,s=r.x*o+o,l=-r.y*a+a;return(!t||!t.skipRounding)&&(s=Math.round(s),l=Math.round(l)),{x:s,y:l}}_testingGetMeshById(e){let t=this.surfaces[e];return t?t.mesh:void 0}remove(){this.materialManager.disposeAllMaterials(),this.pickingColorManager.disposeColorsNotInScene(new eu),this.domainBox&&DO(this.domainBox),this.domainAxes&&(kO(this.domainAxes),e9(this.axesMaterials)),this.renderer.dispose(),this.renderer.forceContextLoss()}addTabTarget(e,t){let r=JP(e.id,t);this.renderedTabTargetOrder.indexOf(r)!==-1||this.renderedTabTargets[r]!==void 0||(this.renderedTabTargetOrder.push(r),this.renderedTabTargets[r]={type:e.type,id:e.id,listIndex:t,description:this.getComputedDescription(e,t)})}getOrderedTabTargets(){return this.renderedTabTargetOrder.map(e=>{let t=this.renderedTabTargets[e];return{calcId:t.id,listIndex:t.listIndex,polygonEdge:void 0,description:t.description}})}setPressedAction(e){this.pressedAction=e,e!==void 0&&(this.isTrackingPressedAction=!0);let t=this.controller.getGrapher3d();t&&(t.controls.state=tu.NONE,t.redrawAllLayers())}getPressedAction(){return this.pressedAction}getComputedDescription(e,t){let r=e.formula&&e.formula.computed_description&&e.formula.computed_description[t];return r&&r!==""?ei(r):this.getDescription(e)}getDescription(e){switch(e.formula.expression_type){case"SURFACE":case"SURFACE_AMBIGUOUS":case"SURFACE_CONSTANT_AMBIGUOUS":case"SURFACE_r_θz":case"SURFACE_r_θz_AMBIGUOUS":case"SURFACE_z_rθ":case"SURFACE_r_θφ":case"SURFACE_xyz_uv":case"IMPLICIT_SURFACE":case"IMPLICIT_SURFACE_AMBIGUOUS":return this.controller.raw("surface");case"CURVE3D_xyz_t":case"SLICE":case"SLICE_rθz_at_z":case"SLICE_zrθ_at_r":case"SLICE_zrθ_at_θ":case"SLICE_zrθ_at_xyz":case"SLICE_rθφ_at_θ":case"SLICE_rθφ_at_φ":case"SLICE_rθφ_at_xyz":case"SLICE_xyz_uv":return this.controller.raw("curve");case"SEGMENT3D":return this.controller.raw("segment");case"VECTOR3D":return this.controller.raw("vector");case"SPHERE3D":return this.controller.raw("sphere");case"POINT3D":case"POINT3D_LIST":return this.controller.raw("point");case"TRIANGLE3D":return this.controller.raw("triangle")}return this.controller.raw("3d object")}};function Vle(e){let t=new Vy({antialias:!0,alpha:!0,preserveDrawingBuffer:!0,canvas:e});return t.setPixelRatio(window.devicePixelRatio||1),t}function VO(e){switch(e){case 106:return{x:!0,y:!0,z:!1};case 107:return{x:!1,y:!0,z:!0};case 108:return{x:!0,y:!1,z:!0};case 110:return{x:!1,y:!1,z:!0};case 112:case 113:case 210:case 128:return{x:!0,y:!0,z:!0};default:return{x:!1,y:!1,z:!1}}}var _h={zMinForAnimation:-1/0,zMaxForAnimation:1/0};function Z_(e,t,r){let n=new La;return n.setIndex(e.length<65536?new fh(r,1):new bh(r,1)),n.setAttribute("position",new Bo(e,3)),n.setAttribute("normal",new Bo(t,3)),n}var eI=[];function J_(e){let t=e<.02?1:e<.05?2:e<.2?3:e<.8?4:5;if(eI[t]===void 0){let r=L7(t);eI[t]=Z_(r.vertices,r.vertices,r.indices)}return eI[t]}function Ole(e){return eI.includes(e)}function Rle(e,t){return t!==void 0&&e.xmin===t.xmin&&e.xmax===t.xmax&&e.ymin===t.ymin&&e.ymax===t.ymax&&e.zmin===t.zmin&&e.zmax===t.zmax}function vm(e,t){return __dcg_shared_module_exports__.Xd(e)?e:__dcg_shared_module_exports__.Kd(e,t)}function Fle(e,t){let r=e.faces.length/3,n=e.positions.length/3,{xmin:i,xmax:o,ymin:a,ymax:s,zmin:l,zmax:c}=t,d=g=>(g-i)/(o-i),u=g=>(g-a)/(s-a),p=g=>(g-l)/(c-l);if(r===1)return!0;if(r===2&&n===4){let g=e.positions,f=new ye(d(g[0]),u(g[1]),p(g[2])),y=new ye(d(g[3]),u(g[4]),p(g[5])),E=new ye(d(g[6]),u(g[7]),p(g[8])),_=new ye(d(g[9]),u(g[10]),p(g[11])),w=new ye().subVectors(y,f),v=new ye().subVectors(E,f),T=new ye().subVectors(_,f),M=w.cross(v);return Q_(M.dot(T)/(M.length()*T.length()))<.01}return!1}function MO(e){return e.split(":")[0]}var Nle=1e3;function Ble(){return new hl(1024,768)}function P9(){return new Br(__dcg_shared_module_exports__.xc.xmin,__dcg_shared_module_exports__.xc.xmax,__dcg_shared_module_exports__.xc.ymin,__dcg_shared_module_exports__.xc.ymax,__dcg_shared_module_exports__.xc.zmin,__dcg_shared_module_exports__.xc.zmax)}var rI=class extends my{constructor(e,t,r,n){super({elt:e,settings:t,controller:r,evaluator:n}),this.type="3d",this.screen=Ble(),this.redrawTickCount=0;let i=P9();this.setUserRequestedViewport(i),this.viewportController=new __(i,this),this.graphSketches={};let o=document.createElement("canvas");o.className="dcg-webgl-canvas",this.getDebugPixelRatio()!==1&&(o.style.imageRendering="pixelated"),this.webglLayer=new u0(o,r),this.elt.appendChild(o),this.transition=new A_,this.controls=new I_(this.webglLayer.spinningWorld,this,this.canvasLayer.canvasNode),this.controls.setWorldRotation(zd()),this.controls.unsnappedRotation.copy(this.controls.worldRotation3D),this.addKeydownEventHandler()}isDefaultDomain(){let e=this.viewportController.getViewport(),t=this.getDefaultViewport();return e.xmin===t.xmin&&e.xmax===t.xmax&&e.ymin===t.ymin&&e.ymax===t.ymax&&e.zmin===t.zmin&&e.zmax===t.zmax}getDebugPixelRatio(){var e;return(e=this.settings.config.debugPixelRatio)!=null?e:1}startZoom(){this.settings.config.disableWorkerOnZoom&&this.evaluator.setTicksEnabled(!1)}endZoom(){this.settings.config.disableWorkerOnZoom&&this.evaluator.setTicksEnabled(!0)}remove(){this.controls.dispose(),this.elt.remove(),this.viewportController.remove(),this.webglLayer.remove()}tick(e){this.redrawTickCount+=1,this.controller.getGrapher2d().tick(e),M7(this.controls);let t=this.webglLayer.getPickResult();this.webglLayer.pickAtMouseAndReadResults();let r=this.webglLayer.getPickResult();__dcg_shared_module_exports__.E(t,r)||(this.__redrawRequested=!0),(!this.lastRenderedWorldRotation||!this.lastRenderedWorldRotation.equals(this.controls.worldRotation3D))&&(this.__redrawRequested=!0,this.lastRenderedWorldRotation=this.controls.worldRotation3D.clone()),this.__redrawRequested&&this._redrawAllLayers()}clear(){this.graphSketches={},this.controller.getGrapher2d().clear()}getGraphSketch(e){return this.graphSketches[e]}addGraphSketch(e){this.graphSketches[e.id]=e}removeGraphSketch(e){e in this.graphSketches&&delete this.graphSketches[e]}flatWorldRotation3D(){return[...this.controls.worldRotation3D.elements]}debounceUserRequestedRotationChange(){this.__debouncedRotationCommit||(this.__debouncedRotationCommit=__dcg_shared_module_exports__.A(()=>{if(this.isDragging)return;let e=this.flatWorldRotation3D();(this.settings.worldRotation3D.length===0&&this.controls.worldRotation3D.equals(zd())||__dcg_shared_module_exports__.E(this.settings.worldRotation3D,e))&&this.settings.axis3D===this.controls.axis3D&&this.settings.speed3D===this.controls.speed3D||this.controller.dispatch({type:"commit-user-requested-rotation",worldRotation3D:e,axis3D:this.controls.axis3D,speed3D:this.controls.speed3D})},Nle)),this.__debouncedRotationCommit()}getDefaultViewport(){return P9()}_updateScreenSize(e,t){if(e<=0||t<=0)return;let r=this.screen;r.width===e&&r.height===t||(this.screen=new hl(e,t),this.viewportController.setScreen(this.screen))}getProjection(){return new Rs(this.screen,this.viewportController.getViewport(),this.settings)}size(){let e=this.canvasLayer.ctx;if(!e)return this.controller.getGrapher2d().size();let{width:t,height:r}=e.canvas.getBoundingClientRect();return t===0||r===0?this.controller.getGrapher2d().size():{width:t,height:r}}update(){let{top:e,left:t,width:r,height:n}=this.controller.computeMajorLayout().grapher,i=this.baseplaneWidth(),o=this.controller.getGrapher2d();o.setCanvasSizeFor3D(i,i),o.update(),this.webglLayer.updateDomainObjects(),r>0&&n>0?(this._setIsVisible(!0),this._updateScreenSize(r,n),Wn(this.elt,{position:"absolute",left:t+"px",top:e+"px",width:r+"px",height:n+"px"})):this._setIsVisible(!1)}deselectSketch(e){let t=this.getGraphSketch(e);t&&(t.selected=!1,t.showHighlight=!1)}selectSketch(e){let t=this.getGraphSketch(e);t&&(t.selected=!0,t.showHighlight=!0)}setSketchHoistedToTop(e,t){let r=this.getGraphSketch(e);r&&(r.hoistToTop=t)}updateSketch(e,t){if(!t.length){this.removeGraphSketch(e);return}let r=new _D(e,t);r.color=t[0].color;let n=this.getGraphSketch(e);n&&r.updateFrom(n);let i=this.controller.getPropagatedSelectedIds(),o=!!i.selected[e],a=!!i.hoistedToTop[e];r.selected=o,r.showHighlight=o,r.hoistToTop=a,this.addGraphSketch(r)}_redrawAllLayers(){if(!this.isVisible)return;let e=Date.now();this.__redrawRequested=!1,this.canvasLayer.resize(this.screen.width,this.screen.height),this.controls.update(),this._redrawWebglLayer(),this.events.triggerEvent("redraw",Date.now()-e),this.canvasLayer.updateAria(this.isVisible,0)}_redrawWebglLayer(){let e=this.getDebugPixelRatio();this.webglLayer.canvas.width=this.canvasLayer.canvasNode.width/e,this.webglLayer.canvas.height=this.canvasLayer.canvasNode.height/e,e!==1&&(this.webglLayer.canvas.style.transform=`scale(${e})`,this.webglLayer.canvas.style.transformOrigin="0 0"),this.webglLayer.redraw(this.graphSketches,this.__drawLayers)}_parseScreenshotOpts(e){return yV(e,this.settings,this.screen)}screenshot(e){let t=document.createElement("canvas"),r=this._parseScreenshotOpts(e);t.width=r.width*r.targetPixelRatio,t.height=r.height*r.targetPixelRatio;let n=this.screenshotToCanvas(t),i=t.toDataURL("image/png");return n&&n(),i}asyncScreenshot(e,t){e.format==="svg"&&__dcg_shared_module_exports__.qe.warn("Unsupported format 'svg' for 3d screenshot. Assuming 'png' format instead.");for(let r of["showLabels","showMovablePoints","mathBounds","mode"])e.hasOwnProperty(r)&&__dcg_shared_module_exports__.qe.warn(`Property ${r} is ignored for 3d screenshot.`);t(this.screenshot(e))}screenshotToCanvas(e){let t=new u0(e,this.controller);return t.spinningWorld.setRotationFromMatrix(new Nt().setFromMatrix3(this.controls.worldRotation3D)),t.redraw(this.graphSketches,this.__drawLayers),()=>t.remove()}_afterViewportChange(){this.webglLayer!==void 0&&this.webglLayer.updateDomainObjects()}computeConcreteViewport(e){return e}setGrapherState(e,t){e=__dcg_shared_module_exports__.od(Os,e),"complex"in e&&!this.controller.canEnableComplexMode()&&(e=ie(R({},e),{complex:!1})),(!t||!t.doNotClear)&&this.clear();for(let r in Os)Os.hasOwnProperty(r)&&this.settings.setProperty(r,e[r]);if("viewport"in e){let r=Br.fromObject(e.viewport);this.setUserRequestedViewport(r),this.viewportController.setViewport(r),this.webglLayer!==void 0&&this.webglLayer.updateDomainObjects()}if("speed3D"in e&&(this.controls.speed3D=e.speed3D),"worldRotation3D"in e){let r=e.worldRotation3D;if(r.length===9){let n=new Po;n.set(r[0],r[3],r[6],r[1],r[4],r[7],r[2],r[5],r[8]),this.controls.setWorldRotation(n),this.controls.unsnappedRotation.copy(this.controls.worldRotation3D),!this.controls.isHorizonLevel()&&!this.controller.getGraphSettings().config.beta3d&&(this.controls.setWorldRotation(zd()),this.controls.unsnappedRotation.copy(this.controls.worldRotation3D),this.controls.speed3D=0)}else this.controls.setWorldRotation(zd()),this.controls.unsnappedRotation.copy(this.controls.worldRotation3D)}"axis3D"in e&&(this.controls.axis3D=e.axis3D),this.controller.requestRedrawGraph()}baseplaneWidth(){let e=this.controller.computeMajorLayout().grapher,{width:t,height:r}=e;return t<360&&(r=360*(r/t),t=360),r<360&&(t=360*(t/r),r=360),Math.ceil(Math.min(t,r)*this.webglLayer.baseplaneMultiplier())}mathCoordinatesToScreenCoordinates(e){return this.webglLayer.mathCoordinatesToScreenCoordinates(e)}addKeydownEventHandler(){ee(this.elt).on("keydown",e=>{if(!this.controller.isGraphPaperFocused())return;let t=e;if(t.altKey||t.ctrlKey||t.metaKey)return;let r=ke(t);if(r==="Tab"){let i=t.shiftKey?"prev":"next";this.handleTabEvent(i,t),this.redrawAllLayers();return}let n=this.controller.getGrapher2d().poiController.keyboardAttentionManager.getKeyboardAttention();if(n){if(r==="Enter"||r==="Space"){let i=this.controller.getItemModel(n.calcId);bb(i)&&this.controller.dispatch({type:"clickable-item-clicked",id:n.calcId,listIndex:n.listIndex})}return}r!=="Up"&&r!=="Down"&&r!=="Left"&&r!=="Right"||(t.stopPropagation(),t.preventDefault(),this.controls.applyTiltFromKeyboard(r,t.shiftKey),this.debounceUserRequestedRotationChange())}),ee(this.elt).on("keyup",()=>{this.controller.isGraphPaperFocused()&&this.controls.keyUp()})}getCanvasNode(){return this.webglLayer.canvas}getOrderedTabTargets(){return this.webglLayer.getOrderedTabTargets()}handleTabEvent(e,t){let r=this.controller.getGrapher2d().poiController.keyboardAttentionManager,n=r.getKeyboardAttention()!==void 0;if(e==="prev"&&!n){r.updateKeyboardAttention(void 0,{describe:!1}),this.webglLayer.updateDomainObjects();return}if(r.focusNextObjFromKeyboard({direction:e,allowWrapping:!1,selectNonClickables:!1})){t==null||t.preventDefault(),t==null||t.stopPropagation(),this.webglLayer.updateDomainObjects();return}else{r.updateKeyboardAttention(void 0,{describe:!1}),e==="prev"&&n&&(this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}}),this.speakGrapherFocusAriaLabel(),t==null||t.preventDefault(),t==null||t.stopPropagation()),this.webglLayer.updateDomainObjects();return}}speakGrapherFocusAriaLabel(){let e=this.elt.getElementsByClassName("dcg-graph-outer")[0].getAttribute("aria-label");e&&xe(e)}};mg();var Wt=__dcg_shared_module_exports__.e(ne()),Ut=__dcg_shared_module_exports__.e(ne()),ze=__dcg_shared_module_exports__.e(ne()),ru=__dcg_shared_module_exports__.e(ne()),tr=class extends ru.Class{template(){return ru.createElement("div",{class:()=>{var e,t,r,n,i;return{"dcg-keypad-btn-container":!0,"dcg-disabled":this.isDisabled(),[(r=(t=(e=this.props).additionalClass)==null?void 0:t.call(e))!=null?r:""]:!!((i=(n=this.props).additionalClass)!=null&&i.call(n))}},style:()=>{var e;return{"flex-grow":(e=this.getColSpan())==null?void 0:e.toString()}}},ru.createElement("span",{role:ru.const("button"),class:this.bindFn(this.getClasses),"dcg-command":this.props.command,"aria-label":this.bindFn(this.getAriaLabel),"aria-disabled":this.bindFn(this.isDisabled),"aria-controls":this.props.ariaControls?this.props.ariaControls:this.const(void 0),"aria-expanded":this.props.ariaExpanded?this.bindFn(this.getAriaExpanded):this.const(void 0),onTap:()=>{this.isDisabled()||this.props.onTap()}},ru.createElement("span",{class:ru.const("dcg-keypad-btn-content")},this.props.children)))}getClasses(){let e={"dcg-keypad-btn":!0,"dcg-keypad-btn-active":this.isActive()},t=this.props.style();switch(t){case"default":e["dcg-btn-light-on-gray"]=!0;break;case"highlight":e["dcg-btn-dark-on-gray"]=!0;break;case"popover":e["dcg-btn-light-gray"]=!0;break;case"blue":e["dcg-btn-short-blue"]=!0;break;case"tall-blue":e["dcg-btn-tall-blue"]=!0;break;default:return t}return e}isActive(){return this.props.active?this.props.active():!1}getAriaLabel(){return this.props.ariaLabel?this.props.ariaLabel():this.props.command()}getColSpan(){if(this.props.colspan)return this.props.colspan()}isDisabled(){return this.props.disabled&&this.props.disabled()}getAriaExpanded(){return this.props.ariaExpanded?this.props.ariaExpanded():void 0}},oI=__dcg_shared_module_exports__.e(ne()),V9=__dcg_shared_module_exports__.e(ne()),Cm=class extends V9.Class{init(){this.controller=this.props.controller()}},Or=class extends Cm{template(){return oI.createElement("div",{class:oI.const("dcg-basic-keypad dcg-do-not-blur")},this.props.children)}},re=__dcg_shared_module_exports__.e(ne()),{IfElse:F9,If:O9,Switch:Ule}=re.Components;function cr(e,t){return e===void 0?re.const(t):typeof e=="function"?e:re.const(e)}function qy(e){return(t,r,n={},i)=>re.createElement(tr,{command:re.const(e.command||e.typedText||e.keys[0]),ariaLabel:()=>e.ariaLabelKey?i(e.ariaLabelKey):e.typedText||e.keys[0],colspan:cr(n.colspan,1),style:()=>n.style||"default",onTap:()=>r({type:"keypad/type-text",text:e.typedText||e.keys[0]})},F9(()=>e.keys[0]==="{"||e.keys[0]==="[",{true:()=>re.createElement("span",{class:re.const("dcg-mq-math-mode"),style:re.const("font-size: 120%")},re.const(e.keys[0]),re.const(" "),re.createElement("span",{style:re.const("color: #999")},re.const(e.keys[1]))),false:()=>re.createElement("span",{class:re.const("dcg-either-or-btn")},re.createElement(nt,{config:re.const({}),latex:re.const(e.keys[0])}),re.createElement("span",{style:re.const("color: #999")},re.createElement(nt,{config:re.const({}),latex:re.const(e.keys[1])})))}))}function Hy(e){return(t,r,n={},i)=>re.createElement(tr,{command:re.const(e.command||e.typedText||e.keys[1]),ariaLabel:()=>e.ariaLabelKey?i(e.ariaLabelKey):e.typedText||e.keys[0],colspan:cr(n.colspan,1),style:cr(n.style,"default"),onTap:()=>r({type:"keypad/type-text",text:e.typedText||e.keys[1]})},F9(()=>e.keys[1]==="}"||e.keys[1]==="]",{true:()=>re.createElement("span",{class:re.const("dcg-mq-math-mode"),style:re.const("font-size: 120%")},re.createElement("span",{style:re.const("color: #999")},re.const(e.keys[0])),re.const(" "),re.const(e.keys[1])),false:()=>re.createElement("span",null,re.createElement("span",{style:re.const("color: #999")},re.createElement(nt,{config:re.const({}),latex:re.const(e.keys[0])})),re.createElement(nt,{config:re.const({}),latex:re.const(e.keys[1])}))}))}function zle(e){return(t,r,n={},i)=>re.createElement(tr,{command:re.const(e.command),ariaLabel:()=>e.ariaLabelKey?i(e.ariaLabelKey):t,colspan:cr(n.colspan,1),style:()=>n.style||"default",onTap:()=>{r({type:"keypad/audio-trace",command:e.command})}},re.createElement(O9,{predicate:re.const(e.iconClass!==void 0)},()=>re.createElement("span",{class:()=>({"dcg-button-icon":!0,"dcg-icon-only":e.contentKey===void 0})},re.createElement("i",{class:re.const(e.iconClass),"aria-hidden":re.const("true")}))),re.createElement(O9,{predicate:re.const(e.contentKey!==void 0)},()=>re.createElement("span",null,()=>i(e.contentKey)||t)))}function Me(e){return(t,r,n={},i)=>re.createElement(tr,{command:re.const(e.command||t),ariaLabel:()=>e.ariaLabelKey?i(e.ariaLabelKey):t,colspan:cr(n.colspan,1),style:()=>n.style||"default",onTap:()=>r({type:"keypad/type-text",text:e.typedText||t})},re.createElement(nt,{config:re.const({}),latex:re.const(e.content||t)}))}function R9(e){return(t,r,n={},i)=>re.createElement(tr,{command:re.const(e.command||t),ariaLabel:()=>e.ariaLabelKey?i(e.ariaLabelKey):t,colspan:cr(n.colspan,1),style:()=>n.style||"default",onTap:()=>r({type:"keypad/type-text",text:e.typedText||t})},re.createElement("span",{class:re.const("dcg-mq-math-mode")},re.const(e.content||t)))}function Pe(e){return(t,r,n={},i)=>re.createElement(tr,{command:re.const(t),ariaLabel:()=>e.ariaLabelKey?i(e.ariaLabelKey):t,colspan:cr(n.colspan,1),style:()=>n.style||"default",onTap:()=>r({type:"keypad/type-text",text:t+"("})},re.createElement(Ule,{key:()=>!!t.match(/^[a-z]{2,}$/)},o=>o?re.createElement("span",{class:re.const("dcg-mq-math-mode dcg-static-mathquill-view")},re.createElement("span",{class:re.const("dcg-mq-root-block")},re.createElement("span",{class:re.const("dcg-mq-operator-name")},()=>t))):re.createElement(nt,{config:re.const({}),latex:re.const(t)})))}function On(e){return(t,r,n={},i)=>re.createElement(tr,{command:re.const(e.command),ariaLabel:()=>e.ariaLabelKey?i(e.ariaLabelKey):e.command,colspan:cr(n.colspan,1),style:()=>n.style||"default",onTap:()=>{r({type:"keypad/custom-command",command:e.command})}},re.createElement(nt,{config:re.const({}),latex:re.const(e.content)}))}var qle={"{":R9({ariaLabelKey:"shared-calculator-narration-keypad-key-left-bracket"}),"}":R9({ariaLabelKey:"shared-calculator-narration-keypad-key-right-bracket"}),"(":Me({ariaLabelKey:"shared-calculator-narration-keypad-key-left-paren"}),")":Me({ariaLabelKey:"shared-calculator-narration-keypad-key-right-paren"}),sqrt:Me({content:"\\sqrt{}",ariaLabelKey:"shared-calculator-narration-keypad-key-sqrt"}),"/":Me({ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),division:Me({content:"÷",typedText:"/",command:"/",ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),obelus:Me({content:"÷",typedText:"÷",ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),"*":Me({ariaLabelKey:"shared-calculator-narration-keypad-key-times"}),multiplication:Me({content:"×",typedText:"*",command:"*",ariaLabelKey:"shared-calculator-narration-keypad-key-times"}),"±":Me({ariaLabelKey:"shared-calculator-narration-keypad-plus-minus"}),"-":Me({ariaLabelKey:"shared-calculator-narration-keypad-key-minus"}),"+":Me({ariaLabelKey:"shared-calculator-narration-keypad-key-plus"}),".":Me({ariaLabelKey:"shared-calculator-narration-keypad-key-decimal"}),ans:(e,t,r={},n)=>re.createElement(tr,{command:re.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-ans"),colspan:cr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/type-text",text:e})},re.const("ans")),enter:(e,t,r={},n)=>re.createElement(tr,{command:re.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-enter"),colspan:cr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/press-key",key:"Enter",source:"keypad"})},re.createElement("i",{class:re.const("dcg-icon-arrow-enter"),"aria-hidden":re.const("true")})),undo:(e,t,r={},n)=>re.createElement(tr,{command:re.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-enter"),colspan:cr(r.colspan,1),disabled:cr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>t({type:"undo",source:"button-tap"})},re.createElement("i",{class:re.const("dcg-icon-undo"),"aria-hidden":re.const("true")})),redo:(e,t,r={},n)=>re.createElement(tr,{command:re.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-enter"),colspan:cr(r.colspan,1),disabled:cr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>t({type:"redo",source:"button-tap"})},re.createElement("i",{class:re.const("dcg-icon-redo"),"aria-hidden":re.const("true")})),shift:(e,t,r={},n)=>re.createElement(tr,{command:re.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-shift"),colspan:cr(r.colspan,1),style:()=>r.style||"default",active:cr(r.active,!1),onTap:()=>t({type:"keypad/shift"})},re.createElement("i",{class:re.const("dcg-icon-shift"),"aria-hidden":re.const("true")})),left:(e,t,r={},n)=>re.createElement(tr,{command:re.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-left-arrow"),colspan:cr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/press-key",key:"Left",source:"keypad"})},re.createElement("i",{class:re.const("dcg-icon-arrow-left"),"aria-hidden":re.const("true")})),right:(e,t,r={},n)=>re.createElement(tr,{command:re.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-right-arrow"),colspan:cr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/press-key",key:"Right",source:"keypad"})},re.createElement("i",{class:re.const("dcg-icon-arrow-right"),"aria-hidden":re.const("true")})),123:(e,t,r={},n)=>re.createElement(tr,{command:re.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-toggle-numbers"),colspan:cr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/123"})},re.const("1 2 3")),ABC:(e,t,r={},n)=>re.createElement(tr,{command:re.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-toggle-letters"),colspan:cr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/abc"})},re.const("A B C")),Audio:(e,t,r={},n)=>re.createElement(tr,{command:re.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-toggle-audio-trace"),colspan:cr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"on"})},re.createElement("i",{class:re.const("dcg-icon-volume"),"aria-hidden":re.const("true")})),backspace:(e,t,r={},n)=>re.createElement(tr,{command:re.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-backspace"),colspan:cr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/press-key",key:"Backspace",source:"keypad"})},re.createElement("i",{class:re.const("dcg-icon-delete"),"aria-hidden":re.const("true")})),pi:Me({content:"\\pi",ariaLabelKey:"shared-calculator-narration-keypad-key-pi"}),alpha:Me({content:"\\alpha",ariaLabelKey:"shared-calculator-narration-keypad-key-alpha"}),beta:Me({content:"\\beta",ariaLabelKey:"shared-calculator-narration-keypad-key-beta"}),theta:Me({content:"\\theta",ariaLabelKey:"shared-calculator-narration-keypad-key-theta"}),tau:Me({content:"\\tau",ariaLabelKey:"shared-calculator-narration-keypad-key-tau"}),phi:Me({content:"\\phi",ariaLabelKey:"shared-calculator-narration-keypad-key-phi"}),rho:Me({content:"\\rho",ariaLabelKey:"shared-calculator-narration-keypad-key-rho"}),"a^2":On({command:"a^2",content:"a^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"a^3":On({command:"a^3",content:"a^3",ariaLabelKey:"shared-calculator-narration-keypad-key-cubed"}),"x^3":On({command:"a^3",content:"x^3",ariaLabelKey:"shared-calculator-narration-keypad-key-cubed"}),"a^b":Me({content:"a^b",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-superscript"}),a_b:Me({content:"a_b",typedText:"_",ariaLabelKey:"shared-calculator-narration-keypad-key-subscript"}),"a/b":On({content:"\\frac{a}{b}",command:"a/b",ariaLabelKey:"shared-calculator-narration-keypad-key-fraction"}),"x^2":On({command:"a^2",content:"x^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"x^y":Me({content:"x^y",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-superscript"}),"x/y":Me({content:"\\frac{x}{y}",typedText:"/",ariaLabelKey:"shared-calculator-narration-keypad-key-fraction"}),nthroot:On({command:"nthroot",content:"\\sqrt[n]{}",ariaLabelKey:"shared-calculator-narration-keypad-key-nthroot"}),ythroot:On({command:"nthroot",content:"\\sqrt[y]{}",ariaLabelKey:"shared-calculator-narration-keypad-key-ythroot"}),sin:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-sin"}),cos:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-cos"}),tan:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-tan"}),tone:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-tone"}),sec:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-sec"}),csc:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-csc"}),cot:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-cot"}),sinh:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-sinh"}),cosh:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-cosh"}),tanh:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-tanh"}),sech:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-csch"}),csch:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-csch"}),coth:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-coth"}),arcsin:On({command:"arcsin",content:"sin^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arcsin"}),arccos:On({command:"arccos",content:"cos^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccos"}),arctan:On({command:"arctan",content:"tan^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arctan"}),arccsc:On({command:"arccsc",content:"csc^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccsc"}),arcsec:On({command:"arcsec",content:"sec^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arcsec"}),arccot:On({command:"arccot",content:"cot^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccot"}),"|a|":Me({typedText:"|",ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),"|x|":Me({typedText:"|",ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),ln:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-ln"}),midpoint:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-midpoint"}),segment:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-segment"}),line:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-line"}),ray:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-ray"}),parallel:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-parallel"}),perpendicular:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-perpendicular"}),circle:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-circle"}),arc:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-arc"}),angle:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-angle"}),directedangle:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-directed-angle"}),glider:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-glider"}),coterminal:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-coterminal"}),supplement:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-supplement"}),dilate:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-dilate"}),rotate:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-rotate"}),translate:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-translate"}),reflect:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-reflect"}),vertices:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-vertices"}),angles:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-angles"}),directedangles:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-directed-angles"}),segments:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-segments"}),radius:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-radius"}),center:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-center"}),intersection:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-intersection"}),area:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-area"}),perimeter:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-perimeter"}),log:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-log"}),quantile:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-quantile"}),quartile:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-quartile"}),var:Pe({}),varp:Pe({}),nCr:Pe({}),loga:On({command:"loga",content:"log_a",ariaLabelKey:"shared-calculator-narration-keypad-key-loga"}),stdev:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-stdev"}),mad:Pe({}),nPr:Pe({}),total:Pe({}),count:Pe({}),length:Pe({}),for:Pe({}),min:Pe({}),max:Pe({}),cov:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-cov"}),covp:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-covp"}),corr:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-corr"}),spearman:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-spearman"}),stats:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-stats"}),polygon:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-polygon"}),distance:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-distance"}),triangle:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-triangle"}),sphere:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-sphere"}),vector:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-vector"}),mean:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-mean"}),stdevp:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-stdevp"}),mod:Pe({}),"e^x":Me({typedText:"e^",ariaLabelKey:"shared-calculator-narration-keypad-key-exp"}),"10^n":Me({content:"\\times10^{n}",typedText:"*10^",ariaLabelKey:"shared-calculator-narration-keypad-key-10-n"}),"a^{-1}":Me({typedText:"^-1",ariaLabelKey:"shared-calculator-narration-keypad-key-reciprocal"}),sum:Me({content:"\\sum",ariaLabelKey:"shared-calculator-narration-keypad-key-sum"}),prod:Me({content:"\\prod",ariaLabelKey:"shared-calculator-narration-keypad-key-product"}),floor:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-floor"}),ceil:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-ceil"}),round:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-round"}),abs:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),"!":Me({ariaLabelKey:"shared-calculator-narration-keypad-key-factorial"}),"n!":Me({typedText:"!",ariaLabelKey:"shared-calculator-narration-keypad-key-factorial"}),median:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-median"}),lcm:Pe({}),gcd:Pe({}),gcf:Pe({}),ddx:On({command:"ddx",content:"\\frac{d}{dx}"}),integral:On({command:"integral",content:"\\int",ariaLabelKey:"shared-calculator-narration-keypad-key-int"}),"%":Me({content:"\\%",ariaLabelKey:"shared-calculator-narration-keypad-key-percent-of"}),"->":Me({content:"\\to",ariaLabelKey:"shared-calculator-narration-keypad-key-action-to"}),with:Me({typedText:"with",content:"with",ariaLabelKey:"shared-calculator-narration-keypad-key-action-with"}),prime:Me({typedText:"'",content:"f'",ariaLabelKey:"shared-calculator-narration-keypad-key-prime"}),exp:Pe({}),sign:Pe({}),normaldist:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-normaldist"}),poissondist:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-poissondist"}),binomialdist:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-binomialdist"}),uniformdist:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-uniformdist"}),erf:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-erf"}),histogram:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-histogram"}),boxplot:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-boxplot"}),dotplot:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-dotplot"}),tscore:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-tscore"}),ittest:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-ittest"}),ttest:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-ttest"}),tdist:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-tdist"}),pdf:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-pdf"}),cdf:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-pdf"}),random:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-random"}),inversecdf:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-inversecdf"}),hsv:Pe({}),rgb:Pe({}),sort:Pe({}),shuffle:Pe({}),unique:Pe({}),join:Pe({}),"A^-1":On({command:"A^-1",content:"A^{-1}",ariaLabelKey:"matrix-calculator-narration-keypad-key-inverse"}),"A^T":On({command:"A^T",content:"A^T",ariaLabelKey:"matrix-calculator-narration-keypad-key-transpose"}),"A^2":On({command:"A^2",content:"A^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"A^n":Me({content:"A^n",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-exp"}),det:Pe({ariaLabelKey:"matrix-calculator-narration-keypad-key-det"}),trace:Pe({ariaLabelKey:"matrix-calculator-narration-keypad-key-trace"}),rref:Pe({ariaLabelKey:"matrix-calculator-narration-keypad-key-rref"}),a:Me({}),b:Me({}),c:Me({}),d:Me({}),e:Me({}),f:Me({}),g:Me({}),h:Me({}),i:Me({}),j:Me({}),k:Me({}),l:Me({}),m:Me({}),n:Me({}),o:Me({}),p:Me({}),q:Me({}),r:Me({}),s:Me({}),t:Me({}),u:Me({}),v:Me({}),w:Me({}),x:Me({}),boldX:Me({content:"x",typedText:"x"}),y:Me({}),boldY:Me({content:"y",typedText:"y"}),z:Me({}),boldZ:Me({content:"z",typedText:"z"}),A:Me({}),B:Me({}),C:Me({}),D:Me({}),E:Me({}),F:Me({}),G:Me({}),H:Me({}),I:Me({}),J:Me({}),K:Me({}),L:Me({}),M:Me({}),N:Me({}),O:Me({}),P:Me({}),Q:Me({}),R:Me({}),S:Me({}),T:Me({}),U:Me({}),V:Me({}),W:Me({}),X:Me({}),Y:Me({}),Z:Me({}),0:Me({}),1:Me({}),2:Me({}),3:Me({}),4:Me({}),5:Me({}),6:Me({}),7:Me({}),8:Me({}),9:Me({}),",":Me({}),"=":Me({}),"[":Me({}),"]":Me({}),"{}_left":qy({keys:["{","}"]}),"{}_right":Hy({keys:["{","}"]}),"()_left":qy({keys:["(",")"]}),"()_right":Hy({keys:["(",")"]}),"[]_left":qy({keys:["[","]"]}),"[]_right":Hy({keys:["[","]"]}),",'_left":qy({keys:[",","′"]}),",'_right":Hy({keys:[",","′"],typedText:"'"}),'"':Me({}),"'":Me({}),"~":Me({}),":":Me({}),">":Me({}),"<":Me({}),">=":Me({content:"\\ge"}),"<=":Me({content:"\\le"}),"!%_left":qy({keys:["!","{}^{%}"]}),"!%_right":Hy({keys:["!","{}^{%}"],typedText:"%"}),"~:_left":qy({keys:["~","{}^{:}"]}),"~:_right":Hy({keys:["~","{}^{:}"],typedText:":"}),real:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-real"}),imag:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-imag"}),conj:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-conj"}),arg:Pe({ariaLabelKey:"shared-calculator-narration-keypad-key-arg"}),"audio-trace-off":zle({contentKey:"graphing-calculator-button-keypad-audio-trace-off",command:"off"}),"hear-graph":(e,t,r={},n)=>re.createElement(tr,{command:re.const(e),disabled:cr(r.disabled,!1),colspan:cr(r.colspan,1),style:cr(r.style,"blue"),ariaLabel:re.const(void 0),onTap:()=>{t({type:"keypad/audio-trace",command:"hear-graph"})}},re.createElement("span",{class:re.const("dcg-play-icon-container")},re.createElement("i",{class:re.const("dcg-icon-play"),"aria-hidden":re.const("true")})),re.createElement("span",null,()=>n("graphing-calculator-button-audio-trace-hear-graph"))),"stop-graph":(e,t,r={},n)=>re.createElement(tr,{command:re.const(e),disabled:cr(r.disabled,!1),colspan:cr(r.colspan,1),style:cr(r.style,"blue"),onTap:()=>{t({type:"keypad/audio-trace",command:"stop-graph"})}},re.createElement("span",{class:re.const("dcg-stop-icon-container")},re.createElement("span",{class:re.const("dcg-stop-icon")})),re.createElement("span",null,()=>n("graphing-calculator-button-audio-trace-stop-graph"))),"volume-down":(e,t,r={},n)=>re.createElement(tr,{command:re.const(e),ariaLabel:()=>n("graphing-calculator-narration-keypad-key-volume-down"),disabled:cr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"volume-down"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-volume-down"),"aria-hidden":re.const("true")}))),"volume-up":(e,t,r={},n)=>re.createElement(tr,{command:re.const(e),ariaLabel:()=>n("graphing-calculator-narration-keypad-key-volume-up"),disabled:cr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"volume-up"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-volume-up"),"aria-hidden":re.const("true")}))),"speed-down":(e,t,r={},n)=>re.createElement(tr,{command:re.const(e),ariaLabel:()=>n("graphing-calculator-narration-keypad-key-speed-down"),disabled:cr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"speed-down"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-hide"),"aria-hidden":re.const("true")}))),"speed-up":(e,t,r={},n)=>re.createElement(tr,{command:re.const(e),ariaLabel:()=>n("graphing-calculator-narration-keypad-key-speed-up"),disabled:cr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"speed-up"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-show"),"aria-hidden":re.const("true")}))),"previous-point":(e,t,r={},n)=>re.createElement(tr,{ariaLabel:()=>n("graphing-calculator-narration-keypad-key-previous-point"),command:re.const(e),disabled:cr(r.disabled,!1),colspan:cr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"previous-point"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-thin-arrow-left"),"aria-hidden":re.const("true")}))),"next-point":(e,t,r={},n)=>re.createElement(tr,{ariaLabel:()=>n("graphing-calculator-narration-keypad-key-next-point"),command:re.const(e),disabled:cr(r.disabled,!1),colspan:cr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"next-point"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-thin-arrow-right"),"aria-hidden":re.const("true")}))),"previous-poi":(e,t,r={},n)=>re.createElement(tr,{ariaLabel:()=>n("graphing-calculator-narration-keypad-key-previous-poi"),command:re.const(e),disabled:cr(r.disabled,!1),colspan:cr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"previous-poi"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-hide"),"aria-hidden":re.const("true")}))),"next-poi":(e,t,r={},n)=>re.createElement(tr,{ariaLabel:()=>n("graphing-calculator-narration-keypad-key-next-poi"),command:re.const(e),disabled:cr(r.disabled,!1),colspan:cr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"next-poi"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-show"),"aria-hidden":re.const("true")}))),"previous-curve":(e,t,r={},n)=>re.createElement(tr,{ariaLabel:()=>n("graphing-calculator-narration-keypad-key-previous-curve"),command:re.const(e),disabled:cr(r.disabled,!1),colspan:cr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"previous-curve"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-caret-up"),"aria-hidden":re.const("true")}))),"next-curve":(e,t,r={},n)=>re.createElement(tr,{ariaLabel:()=>n("graphing-calculator-narration-keypad-key-next-curve"),command:re.const(e),disabled:cr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"next-curve"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-caret-down"),"aria-hidden":re.const("true")})))};function I(e,t,r={}){let n=e.dispatch;return qle[t](t,n,r,e.s)}function to(e=1){return re.createElement("div",{style:re.const(`flex-grow:${e}`)})}var N9=__dcg_shared_module_exports__.e(ne()),OO=class extends N9.Class{init(){this.controller=this.props.controller(),this.dispatch=this.controller.dispatch,this.s=this.controller.s}};OO.uuid=Dd();var ii=OO,{IfElse:Hle}=ze.Components,iI=460,nI=class extends ii{template(){return ze.createElement(Or,{controller:this.props.controller},ze.createElement("div",{class:ze.const("dcg-audio-keypad-container")},ze.createElement("div",{class:ze.const("dcg-audio-keypad-column dcg-playback-column")},ze.createElement(Le,{tooltip:this.bindFn(this.getDisabledTooltipText),gravity:this.const("s")},ze.createElement("div",{class:ze.const("dcg-btn-playback")},Hle(()=>this.controller.isAudioTracing(),{true:()=>I(this,"stop-graph",{disabled:this.bindFn(this.isAudioDisabled)}),false:()=>I(this,"hear-graph",{disabled:this.bindFn(this.isAudioDisabled)})}))),ze.createElement("div",{class:ze.const("dcg-key-nav-section-container")},ze.createElement(Le,{tooltip:this.bindFn(this.getDisabledTooltipText),gravity:this.const("s")},ze.createElement("div",{class:ze.const("dcg-key-nav-section")},I(this,"volume-down",{disabled:this.bindFn(this.isVolumeDownDisabled)}),ze.createElement("div",{role:ze.const("heading"),"aria-level":ze.const("2"),class:()=>({"dcg-key-nav-section-title-container":!0,"dcg-disabled":this.isAudioDisabled()})},ze.createElement("span",{class:ze.const("dcg-key-nav-section-title")},()=>this.controller.s("graphing-calculator-label-audio-trace-volume")),ze.createElement("span",{class:ze.const("dcg-keypad-volume-value dcg-key-nav-section-value")},()=>this.getAudioTraceVolume())),I(this,"volume-up",{disabled:this.bindFn(this.isVolumeUpDisabled)})))),ze.createElement("div",{class:ze.const("dcg-key-nav-section-container")},ze.createElement(Le,{tooltip:this.bindFn(this.getDisabledTooltipText),gravity:this.const("s")},ze.createElement("div",{class:ze.const("dcg-key-nav-section")},I(this,"speed-down",{disabled:this.bindFn(this.isSpeedDownDisabled)}),ze.createElement("div",{class:()=>({"dcg-key-nav-section-title-container":!0,"dcg-disabled":this.isAudioDisabled()}),role:ze.const("heading"),"aria-level":ze.const("2")},ze.createElement("span",{class:ze.const("dcg-key-nav-section-title")},()=>this.controller.s("graphing-calculator-label-audio-trace-speed")),ze.createElement("span",{class:ze.const("dcg-keypad-speed-value dcg-key-nav-section-value")},()=>this.getAudioTraceSpeed())),I(this,"speed-up",{disabled:this.bindFn(this.isSpeedUpDisabled)})))),I(this,"audio-trace-off",{style:"highlight"})),ze.createElement("div",{class:ze.const("dcg-audio-keypad-spacer")}),ze.createElement("div",{class:ze.const("dcg-audio-keypad-column dcg-navigation-column")},ze.createElement("span",{class:ze.const("dcg-key-section-title dcg-center-col"),role:ze.const("heading"),"aria-level":ze.const("2")},()=>this.controller.s("graphing-calculator-heading-audio-trace-navigation")),ze.createElement("div",{class:ze.const("dcg-key-nav-section dcg-center-col")},I(this,"previous-point",{disabled:this.bindFn(this.isPrevPointDisabled)}),ze.createElement("div",{class:ze.const("dcg-key-nav-section-title-container"),role:ze.const("heading"),"aria-level":ze.const("2")},()=>this.controller.s("graphing-calculator-label-audio-trace-point")),I(this,"next-point",{disabled:this.bindFn(this.isNextPointDisabled)})),ze.createElement("div",{class:ze.const("dcg-key-nav-section")},I(this,"previous-poi",{disabled:this.bindFn(this.isPrevPOIDisabled)}),ze.createElement("div",{class:ze.const("dcg-key-nav-section-title-container dcg-poi-section-container"),role:ze.const("heading"),"aria-level":ze.const("2")},ze.createElement(Oi,{i18n:this.const(this.controller),key:this.const("graphing-calculator-heading-keypad-audio-trace-point-of-interest")},ze.createElement("span",{class:ze.const("dcg-key-nav-section-value")},ze.const("Point")),ze.createElement("span",{class:ze.const("dcg-key-nav-section-title")},ze.const("of Interest")))),I(this,"next-poi",{disabled:this.bindFn(this.isNextPOIDisabled)})),ze.createElement("div",{class:ze.const("dcg-key-nav-section dcg-center-col")},I(this,"previous-curve",{disabled:this.bindFn(this.isPrevCurveDisabled)}),ze.createElement("div",{class:ze.const("dcg-key-nav-section-title-container"),role:ze.const("heading"),"aria-level":ze.const("2")},()=>this.controller.s("graphing-calculator-label-audio-trace-curve")),I(this,"next-curve",{disabled:this.bindFn(this.isNextCurveDisabled)}))),ze.createElement("div",{class:ze.const("dcg-audio-keypad-spacer")}),ze.createElement("div",{class:ze.const("dcg-audio-keypad-column dcg-screenreader-options")},ze.createElement("span",{class:ze.const("dcg-key-section-title"),role:ze.const("heading"),"aria-level":ze.const("2")},()=>this.layoutWidth()<=iI?this.controller.s("graphing-calculator-heading-audio-trace-describe"):this.controller.s("graphing-calculator-heading-audio-trace-screen-reader"),ze.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-audio-trace-need-screen-reader"),gravity:this.const("s"),sticky:this.const(!0)},ze.createElement("i",{class:ze.const("dcg-icon-question-sign"),"aria-hidden":ze.const("true")}))),ze.createElement(tr,{command:ze.const("describe-point"),colspan:this.const(1),style:this.const("default"),onTap:()=>{this.dispatch({type:"keypad/audio-trace",command:"describe-point"})}},ze.createElement("span",null,()=>this.layoutWidth()<=iI?this.controller.s("graphing-calculator-button-keypad-describe-point-short"):this.controller.s("graphing-calculator-button-keypad-describe-point"))),ze.createElement(tr,{command:ze.const("describe-curve"),colspan:this.const(1),style:this.const("default"),onTap:()=>{this.dispatch({type:"keypad/audio-trace",command:"describe-curve"})}},ze.createElement("span",null,()=>this.layoutWidth()<=iI?this.controller.s("graphing-calculator-button-keypad-describe-curve-short"):this.controller.s("graphing-calculator-button-keypad-describe-curve"))),ze.createElement(tr,{command:ze.const("describe-axes"),colspan:this.const(1),style:this.const("default"),onTap:()=>{this.dispatch({type:"keypad/audio-trace",command:"describe-axes"})}},ze.createElement("span",null,()=>this.layoutWidth()<=iI?this.controller.s("graphing-calculator-label-axes"):this.controller.s("graphing-calculator-button-keypad-describe-axes"))))))}layoutWidth(){return this.controller.getLayoutMeasurements().width}isPrevPointDisabled(){let e=this.controller.getAudioGraph();return e?!e.agNavigator.canMoveToPrevPoint():!0}isNextPointDisabled(){let e=this.controller.getAudioGraph();return e?!e.agNavigator.canMoveToNextPoint():!0}isPrevPOIDisabled(){let e=this.controller.getAudioGraph();return e?!e.agNavigator.canMoveToPrevPOI():!0}isNextPOIDisabled(){let e=this.controller.getAudioGraph();return e?!e.agNavigator.canMoveToNextPOI():!0}isPrevCurveDisabled(){let e=this.controller.getAudioGraph();return e?!e.agNavigator.canMoveToPrevCurve():!0}isNextCurveDisabled(){let e=this.controller.getAudioGraph();return e?!e.agNavigator.canMoveToNextCurve():!0}isAudioDisabled(){return!this.controller.getAudio()}getAudioTraceVolume(){let e=this.controller.getAudioGraph();return!e||this.isAudioDisabled()?"0%":`${e.getAudioVolume()*100}%`}isVolumeDownDisabled(){let e=this.controller.getAudioGraph();return!e||this.isAudioDisabled()?!0:e.getAudioVolume()<=0}isVolumeUpDisabled(){let e=this.controller.getAudioGraph();return!e||this.isAudioDisabled()?!0:e.getAudioVolume()>=1}getAudioTraceSpeed(){let e=this.controller.getAudioGraph();return!e||this.isAudioDisabled()?"0":Mv[e.getAudioSpeedIndex()].displayedSpeed}isSpeedDownDisabled(){let e=this.controller.getAudioGraph();return!e||this.isAudioDisabled()?!0:e.getAudioSpeedIndex()<=0}isSpeedUpDisabled(){let e=this.controller.getAudioGraph();return!e||this.isAudioDisabled()?!0:e.getAudioSpeedIndex()===Mv.length-1}getDisabledTooltipText(){return this.isAudioDisabled()?this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"):""}},Ir=__dcg_shared_module_exports__.e(ne()),{If:aI,For:B9}=Ir.Components,sI=class extends ii{template(){return Ir.createElement("div",{class:()=>({"dcg-functions-popover":!0,"dcg-popover":!0,"dcg-top":!0,"dcg-two-column":this.shouldRenderWithTwoColumns()}),id:this.const(`dcg-functions-popover-${ii.uuid}`),role:Ir.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-button-functions")},Ir.createElement("div",{class:Ir.const("dcg-popover-interior")},Ir.createElement("div",{class:Ir.const("dcg-interior-buttons")},Ir.createElement("div",{class:Ir.const("dcg-basic-keypad dcg-do-not-blur")},Ir.createElement(B9,{each:this.bindFn(this.getKeypadKeys),key:e=>e.id},e=>Ir.createElement("div",{class:Ir.const("dcg-keypad-keys-section")},Ir.createElement(aI,{predicate:()=>e.title!==void 0},()=>Ir.createElement("div",{class:Ir.const("dcg-section-heading"),role:Ir.const("heading"),"aria-level":Ir.const("2")},()=>e.title,Ir.createElement(aI,{predicate:()=>!!e.beta},()=>Ir.createElement("span",{class:Ir.const("dcg-beta-tag")},()=>this.controller.s("shared-calculator-narration-keypad-key-beta"))),Ir.createElement(aI,{predicate:()=>!!e.helpLink},()=>Ir.createElement("a",{href:()=>e.helpLink.url,target:Ir.const("_blank"),"aria-label":()=>e.helpLink.tooltip},Ir.createElement("i",{class:Ir.const("dcg-icon-question-sign"),"aria-hidden":Ir.const("true")}))))),Ir.createElement(aI,{predicate:()=>e.title===void 0},()=>Ir.createElement("div",{class:Ir.const("dcg-popover-section-separator"),role:Ir.const("separator")})),Ir.createElement("div",{class:Ir.const("dcg-keypad-keys-buttons")},Ir.createElement(B9,{each:()=>e.keys},t=>this.b(t)))))))),Ir.createElement("div",{class:Ir.const("dcg-arrow")}))}shouldRenderWithTwoColumns(){let e=this.controller.getGraphSettings().config.projectorMode?410:375;return this.controller.getLayoutMeasurements().width<e}getInverseTrigSection(){let e=this.controller.areFunctionsRestricted()?["arcsin","arccos","arctan"]:["arcsin","arccos","arctan","arccsc","arcsec","arccot"];return{id:"inversetrig",title:this.controller.s("graphing-calculator-heading-inverse-trig"),keys:e}}getGeometryTools(){let e=["midpoint","intersection","segment","line","ray","vector","parallel","perpendicular","circle","arc","angle","directedangle","polygon","glider"];return{id:"geometry-tools",title:this.controller.s("graphing-calculator-heading-geometry-tools"),keys:e}}getGeometryTransformations(){let e=["dilate","rotate","reflect","translate"];return{id:"geometry-transformations",title:this.controller.s("graphing-calculator-heading-geometry-transformations"),keys:e}}getGeometryMeasurements(){let e=["distance","length","area","perimeter","vertices","angles","directedangles","segments","radius","center","coterminal","supplement"];return{id:"geometry-measurements",title:this.controller.s("graphing-calculator-heading-geometry-measurements"),keys:e}}getCalculatorGeometryMethods(){let e=!this.controller.areFunctionsRestricted()||this.controller.areGeometryFunctionsForceEnabled(),t=this.controller.isThreeDMode()?["segment","triangle","sphere","vector"]:["polygon"],r=this.controller.isThreeDMode()?["length","distance","midpoint"]:["distance","midpoint"],n=e?r:[];return{id:"geometry",title:this.controller.s("graphing-calculator-heading-geometry"),keys:[...t,...n]}}getTrigSection(){let e=this.controller.areFunctionsRestricted()?["sin","cos","tan"]:["sin","cos","tan","csc","sec","cot"];return{id:"trig",title:this.controller.s("graphing-calculator-heading-trig"),keys:e}}getHyperbolicTrigSection(){let e=this.controller.areFunctionsRestricted()?["sinh","cosh","tanh"]:["sinh","cosh","tanh","csch","sech","coth"];return{id:"hyperbtrig",title:this.controller.s("graphing-calculator-heading-hyperbolic-trig"),keys:e}}getListFunctions(){return{id:"lists",title:this.controller.s("graphing-calculator-heading-lists"),keys:["join","sort","shuffle","unique","for"]}}getStatTests(){return{id:"stat-tests",title:this.controller.s("graphing-calculator-heading-stat-tests"),keys:["ttest","tscore","ittest"]}}getStatsSection(){let e=["mean","median","min","max","quartile","quantile","stdev","stdevp","var"];return this.controller.areFunctionsRestricted()||(e=e.concat(["mad","cov","covp"])),e=e.concat(["corr","spearman","stats","count","total"]),{id:"stats",title:this.controller.s("graphing-calculator-heading-stats"),keys:e}}getMiscSection(){return{title:this.controller.s("graphing-calculator-button-functions-menu-number-theory"),id:"misc",keys:["lcm","gcd","mod","ceil","floor","round","sign","nthroot","nPr","nCr"]}}getVisualizationsSection(){return{title:this.controller.s("graphing-calculator-heading-dist-tab-visualizations"),id:"visualizations",keys:["histogram","dotplot","boxplot"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/360022405991-Data-Visualizations",tooltip:this.controller.s("graphing-calculator-narration-dist-tab-visualizations")}}}getCalculusSection(){return{title:this.controller.s("graphing-calculator-heading-calculus"),id:"calculus",keys:["exp","ln","log","loga","ddx","prime","integral","sum","prod"]}}getDistributionsSection(){return{title:this.controller.s("graphing-calculator-heading-dist-tab-distributions"),id:"distributions",keys:["normaldist","tdist","poissondist","binomialdist","uniformdist","pdf","cdf","inversecdf","random"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/360022401451-Distributions",tooltip:this.controller.s("graphing-calculator-narration-dist-tab-distributions")}}}getColorsSection(){return{title:this.controller.s("graphing-calculator-button-functions-menu-custom-colors"),id:"colors",keys:["rgb","hsv"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/4406795899533-Custom-Colors",tooltip:this.controller.s("graphing-calculator-button-functions-menu-custom-colors")}}}getAdvancedSection(){return{title:this.controller.s("graphing-calculator-heading-functions-menu-advanced"),id:"advanced",keys:["->","with"],helpLink:{url:"https://help.desmos.com/hc/en-us/sections/4406370087053-Advanced-Features",tooltip:this.controller.s("graphing-calculator-heading-functions-menu-advanced")}}}getPolarSection(){return{title:this.controller.s("graphing-calculator-heading-functions-menu-polar"),id:"polar",keys:["rho","theta","phi"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/15824510769805",tooltip:this.controller.s("graphing-calculator-heading-functions-menu-polar")}}}getSoundSection(){return{title:this.controller.s("graphing-calculator-heading-functions-menu-sound"),id:"sound",keys:["tone"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/21373904717197-Tone",tooltip:this.controller.s("graphing-calculator-heading-functions-menu-sound")}}}getComplexSection(){return{title:this.controller.s("graphing-calculator-heading-functions-menu-complex"),id:"complex",keys:["real","imag","conj","arg"]}}getKeypadKeys(){let e=[this.getTrigSection(),this.getInverseTrigSection(),this.getStatsSection(),this.getListFunctions()];return this.controller.areDistributionsEnabled()&&(this.controller.isThreeDMode()||e.push(this.getVisualizationsSection()),e.push(this.getDistributionsSection()),e.push(this.getStatTests())),e.push(this.getCalculusSection()),e.push(this.getHyperbolicTrigSection()),this.controller.is3dProduct()&&e.push(this.getPolarSection()),this.controller.isGeometry()?(e.push(this.getGeometryTools()),e.push(this.getGeometryMeasurements()),e.push(this.getGeometryTransformations())):e.push(this.getCalculatorGeometryMethods()),e.push(this.getColorsSection()),this.controller.toneAllowed()&&e.push(this.getSoundSection()),e.push(this.getMiscSection()),this.controller.isComplexModeEnabled()&&e.push(this.getComplexSection()),this.controller.areActionsEnabled()&&e.push(this.getAdvancedSection()),e}b(e){return I(this,e,{style:"popover"})}},Ih=__dcg_shared_module_exports__.e(ne()),Ky=__dcg_shared_module_exports__.e(ne()),$e=class extends Ky.Class{template(){return Ky.createElement("div",{class:Ky.const("dcg-keypad-row")},this.props.children)}},lI=class extends ii{template(){return Ih.createElement(Or,{controller:this.props.controller},Ih.createElement($e,null,I(this,"a"),I(this,"b"),I(this,"c"),I(this,"d"),I(this,"e"),I(this,"f"),I(this,"g"),I(this,"h"),I(this,"i"),I(this,"j")),Ih.createElement($e,null,I(this,"k"),I(this,"l"),I(this,"m"),I(this,"n"),I(this,"o"),I(this,"p"),I(this,"q"),I(this,"r"),I(this,"s"),I(this,"t")),Ih.createElement($e,null,I(this,"shift",{style:"highlight"}),I(this,"u"),I(this,"v"),I(this,"w"),I(this,"x"),I(this,"y"),I(this,"z"),I(this,"theta"),I(this,"backspace",{colspan:2,style:"highlight"})),Ih.createElement($e,null,I(this,"123",{colspan:2,style:"highlight"}),I(this,"a_b"),I(this,"!%_left"),I(this,"[]_left"),I(this,"{}_left"),I(this,this.controller.getGraphSettings().config.customRegressions?"~:_left":":"),Ih.const(" "),I(this,",'_left"),I(this,"enter",{colspan:2,style:"blue"})))}},Wy=__dcg_shared_module_exports__.e(ne()),cI=class extends ii{template(){return Wy.createElement(Or,{controller:this.props.controller},Wy.createElement($e,null,I(this,"A"),I(this,"B"),I(this,"C"),I(this,"D"),I(this,"E"),I(this,"F"),I(this,"G"),I(this,"H"),I(this,"I"),I(this,"J")),Wy.createElement($e,null,I(this,"K"),I(this,"L"),I(this,"M"),I(this,"N"),I(this,"O"),I(this,"P"),I(this,"Q"),I(this,"R"),I(this,"S"),I(this,"T")),Wy.createElement($e,null,I(this,"shift",{style:"highlight"}),I(this,"U"),I(this,"V"),I(this,"W"),I(this,"X"),I(this,"Y"),I(this,"Z"),I(this,"tau"),I(this,"backspace",{colspan:2,style:"highlight"})),Wy.createElement($e,null,I(this,"123",{colspan:2,style:"highlight"}),I(this,"a^b"),I(this,"!%_right"),I(this,"[]_right"),I(this,"{}_right"),I(this,this.controller.getGraphSettings().config.customRegressions?"~:_right":":"),I(this,",'_right"),I(this,"enter",{colspan:2,style:"blue"})))}},ga=__dcg_shared_module_exports__.e(ne()),{IfElse:Kle}=ga.Components,dI=class extends ii{template(){return ga.createElement(Or,{controller:this.props.controller},ga.createElement($e,null,I(this,"boldX"),I(this,"boldY"),Kle(()=>this.props.controller().isComplexModeEnabled(),{false:()=>I(this,"a^2"),true:()=>I(this,"i")}),I(this,"a^b"),to(.5),I(this,"7",{style:"highlight"}),I(this,"8",{style:"highlight"}),I(this,"9",{style:"highlight"}),I(this,"division"),to(.5),ga.createElement(tr,{command:this.const("functions"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-functions"),colspan:this.const(2),style:this.const("highlight"),active:()=>this.controller.isKeypadFunctionsPopoverOpen(),onTap:()=>this.dispatch({type:"keypad/functions"}),ariaControls:this.const(`dcg-functions-popover-${ii.uuid}`),ariaExpanded:()=>this.controller.isKeypadFunctionsPopoverOpen()},this.bindFn(this.getFuncsBtnText))),ga.createElement($e,null,I(this,"("),I(this,")"),I(this,"<"),I(this,">"),to(.5),I(this,"4",{style:"highlight"}),I(this,"5",{style:"highlight"}),I(this,"6",{style:"highlight"}),I(this,"multiplication"),to(.5),I(this,"left",{style:"highlight"}),I(this,"right",{style:"highlight"})),ga.createElement($e,null,I(this,"|a|"),I(this,","),I(this,"<="),I(this,">="),to(.5),I(this,"1",{style:"highlight"}),I(this,"2",{style:"highlight"}),I(this,"3",{style:"highlight"}),I(this,"-"),to(1),I(this,"backspace",{colspan:1.5,style:"highlight"})),ga.createElement($e,null,ga.createElement(tr,{command:ga.const("ABC"),colspan:this.const(1),additionalClass:this.const("dcg-abc-button--one-column"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-toggle-letters"),style:this.const("highlight"),onTap:()=>{this.dispatch({type:"keypad/abc"})}},()=>this.controller.getLayoutMeasurements().width<=600?this.controller.raw("ABC"):this.controller.raw("A B C")),ga.createElement(tr,{command:ga.const("Audio"),disabled:()=>!this.controller.canAudioTrace(),ariaLabel:()=>this.controller.s("graphing-calculator-narration-toggle-audio-trace"),colspan:this.const(1),style:()=>"highlight",onTap:()=>this.dispatch({type:"keypad/audio-trace",command:"on"})},ga.createElement("i",{class:ga.const("dcg-icon-volume"),"aria-hidden":ga.const("true")})),I(this,"sqrt"),I(this,"pi"),to(.5),I(this,"0",{style:"highlight"}),I(this,".",{style:"highlight"}),I(this,"="),I(this,"+"),to(.5),I(this,"enter",{colspan:2,style:"blue"})))}getFuncsBtnText(){return this.controller.isNarrow()?this.controller.s("graphing-calculator-button-funcs"):this.controller.s("graphing-calculator-button-functions")}},xl=__dcg_shared_module_exports__.e(ne()),{If:Wle}=xl.Components,pI=class extends ii{template(){return xl.createElement(Or,{controller:this.props.controller},xl.createElement($e,null,I(this,"boldX"),I(this,"boldY"),I(this,"boldZ"),I(this,"a^b"),to(.5),I(this,"7",{style:"highlight"}),I(this,"8",{style:"highlight"}),I(this,"9",{style:"highlight"}),I(this,"division"),to(.5),xl.createElement(tr,{command:this.const("functions"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-functions"),colspan:this.const(2),style:this.const("highlight"),active:()=>this.controller.isKeypadFunctionsPopoverOpen(),onTap:()=>this.dispatch({type:"keypad/functions"}),ariaControls:this.const(`dcg-functions-popover-${ii.uuid}`),ariaExpanded:()=>this.controller.isKeypadFunctionsPopoverOpen()},this.bindFn(this.getFuncsBtnText))),xl.createElement($e,null,I(this,"("),I(this,")"),I(this,"<"),I(this,">"),to(.5),I(this,"4",{style:"highlight"}),I(this,"5",{style:"highlight"}),I(this,"6",{style:"highlight"}),I(this,"multiplication"),to(.5),I(this,"left",{style:"highlight"}),I(this,"right",{style:"highlight"})),xl.createElement($e,null,I(this,"|a|"),I(this,","),I(this,"<="),I(this,">="),to(.5),I(this,"1",{style:"highlight"}),I(this,"2",{style:"highlight"}),I(this,"3",{style:"highlight"}),I(this,"-"),to(1),I(this,"backspace",{colspan:1.5,style:"highlight"})),xl.createElement($e,null,xl.createElement(tr,{command:xl.const("ABC"),colspan:()=>this.controller.isComplexModeEnabled()?1:2,additionalClass:()=>this.controller.isComplexModeEnabled()?"dcg-abc-button--one-column":void 0,ariaLabel:()=>this.controller.s("graphing-calculator-narration-toggle-letters"),style:this.const("highlight"),onTap:()=>{this.dispatch({type:"keypad/abc"})}},()=>this.controller.isComplexModeEnabled()&&this.controller.getLayoutMeasurements().width<=600?this.controller.raw("ABC"):this.controller.raw("A B C")),xl.createElement(Wle,{predicate:()=>this.controller.isComplexModeEnabled()},()=>I(this,"i")),I(this,"sqrt"),I(this,"pi"),to(.5),I(this,"0",{style:"highlight"}),I(this,".",{style:"highlight"}),I(this,"="),I(this,"+"),to(.5),I(this,"enter",{colspan:2,style:"blue"})))}getFuncsBtnText(){return this.controller.isNarrow()?this.controller.s("graphing-calculator-button-funcs"):this.controller.s("graphing-calculator-button-functions")}},$y=__dcg_shared_module_exports__.e(ne()),uI=class extends ii{template(){return $y.createElement(Or,{controller:this.props.controller},$y.createElement($e,null,I(this,"q"),I(this,"w"),I(this,"e"),I(this,"r"),I(this,"t"),I(this,"y"),I(this,"u"),I(this,"i"),I(this,"o"),I(this,"p")),$y.createElement($e,null,I(this,"a"),I(this,"s"),I(this,"d"),I(this,"f"),I(this,"g"),I(this,"h"),I(this,"j"),I(this,"k"),I(this,"l"),I(this,"theta")),$y.createElement($e,null,I(this,"shift",{colspan:1.364,style:"highlight"}),to(.136),I(this,"z"),I(this,"x"),I(this,"c"),I(this,"v"),I(this,"b"),I(this,"n"),I(this,"m"),to(.136),I(this,"backspace",{colspan:1.364,style:"highlight"})),$y.createElement($e,null,I(this,"123",{colspan:1.818,style:"highlight"}),to(.182),I(this,"a_b"),I(this,"!%_left"),I(this,"[]_left"),I(this,"{}_left"),I(this,this.controller.getGraphSettings().config.customRegressions?"~:_left":":"),I(this,",'_left"),to(.182),I(this,"enter",{colspan:1.818,style:"blue"})))}},jy=__dcg_shared_module_exports__.e(ne()),hI=class extends ii{template(){return jy.createElement(Or,{controller:this.props.controller},jy.createElement($e,null,I(this,"Q"),I(this,"W"),I(this,"E"),I(this,"R"),I(this,"T"),I(this,"Y"),I(this,"U"),I(this,"I"),I(this,"O"),I(this,"P")),jy.createElement($e,null,I(this,"A"),I(this,"S"),I(this,"D"),I(this,"F"),I(this,"G"),I(this,"H"),I(this,"J"),I(this,"K"),I(this,"L"),I(this,"tau")),jy.createElement($e,null,I(this,"shift",{colspan:1.364,active:!0,style:"highlight"}),to(.136),I(this,"Z"),I(this,"X"),I(this,"C"),I(this,"V"),I(this,"B"),I(this,"N"),I(this,"M"),to(.136),I(this,"backspace",{colspan:1.364,style:"highlight"})),jy.createElement($e,null,I(this,"123",{colspan:1.818,style:"highlight"}),to(.182),I(this,"a^b"),I(this,"!%_right"),I(this,"[]_right"),I(this,"{}_right"),I(this,this.controller.getGraphSettings().config.customRegressions?"~:_right":":"),I(this,",'_right"),to(.182),I(this,"enter",{colspan:1.818,style:"blue"})))}},{SwitchUnion:$le,If:RO}=Ut.Components,gI=class extends ii{template(){return Ut.createElement("div",{class:Ut.const("dcg-keypad"),role:Ut.const("region"),"aria-label":()=>this.controller.s("shared-calculator-narration-keypad")},Ut.createElement("div",{class:()=>({"dcg-keys-container":!0,"dcg-smaller-functions-text":this.controller.getLayoutMeasurements().width<650,"dcg-small-ABC":this.controller.getLayoutMeasurements().width<490,"dcg-smaller-ABC":this.controller.getLayoutMeasurements().width<420,"dcg-smallest-ABC":this.controller.getLayoutMeasurements().width<380}),style:this.bindFn(this.computeStyles),didMount:this.bindFn(this.didMountContainer),"aria-hidden":()=>!this.controller.isKeypadOpen()},Ut.createElement("div",{class:Ut.const("dcg-keys-background dcg-do-not-blur")},Ut.createElement("div",{class:Ut.const("dcg-keys")},$le(()=>this.controller.getKeypadLayout(),{letters:()=>Ut.createElement(uI,{controller:this.props.controller}),capitalLetters:()=>Ut.createElement(hI,{controller:this.props.controller}),mainNumbers:()=>Ut.createElement(dI,{controller:this.props.controller}),mainNumbers3D:()=>Ut.createElement(pI,{controller:this.props.controller}),noQwertyLetters:()=>Ut.createElement(lI,{controller:this.props.controller}),noQwertyCapitalLetters:()=>Ut.createElement(cI,{controller:this.props.controller}),audio:()=>Ut.createElement(nI,{controller:this.props.controller})}),Ut.createElement(RO,{predicate:()=>this.controller.isKeypadFunctionsPopoverOpen()},()=>Ut.createElement(sI,{controller:this.props.controller}))),Ut.createElement(RO,{predicate:()=>this.controller.isHideKeypadButtonVisible()},()=>Ut.createElement("div",{class:Ut.const("dcg-minimize-keypad-container")},Ut.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-hide-keypad"),gravity:this.const("n"),offset:this.const({left:6})},Ut.createElement("div",{role:Ut.const("button"),"aria-expanded":Ut.const("true"),"aria-controls":this.const(ii.uuid),"aria-label":()=>this.controller.s("graphing-calculator-label-hide-keypad"),class:Ut.const("dcg-minimize-keypad"),onTap:()=>{this.controller.dispatch({type:"keypad/set-minimized",minimized:!0})}},Ut.createElement("i",{class:Ut.const("dcg-icon-keyboard"),"aria-hidden":Ut.const("true")}),Ut.createElement("i",{class:Ut.const("dcg-icon-caret-down"),"aria-hidden":Ut.const("true")}))))))),Ut.createElement(RO,{predicate:this.bindFn(this.isShowKeypadButtonVisible)},()=>Ut.createElement("div",{class:Ut.const("dcg-show-keypad-container")},Ut.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-show-keypad"),gravity:this.const("n")},Ut.createElement("div",{role:Ut.const("button"),"aria-expanded":Ut.const("false"),"aria-controls":this.const(ii.uuid),"aria-label":()=>this.controller.s("graphing-calculator-label-show-keypad"),class:Ut.const("dcg-btn-flat-gray dcg-show-keypad dcg-do-not-blur"),onTap:()=>{this.controller.dispatch({type:"keypad/set-minimized",minimized:!1})}},Ut.createElement("i",{class:Ut.const("dcg-icon-keyboard"),"aria-hidden":Ut.const("true")}),Ut.createElement("i",{class:Ut.const("dcg-icon-caret-up dcg-do-not-blur"),"aria-hidden":Ut.const("true")}))))))}didMountContainer(e){this.containerElt=e}isShowKeypadButtonVisible(){return this.controller.getBrailleMode()!=="none"?!1:!this.controller.isKeypadOpen()&&!this.controller.isNarrow()&&!this.controller.isInEditListMode()&&(this.controller.isListVisible()||this.controller.inAudioTraceMode())}didMount(){this.updatePopoverPosition()}didUpdate(){this.updatePopoverPosition()}computeStyles(){let e={};return this.controller.isNarrow()||(e.transition="transform .3s, opacity .3s"),this.controller.isKeypadOpen()||(e.opacity="0",e.transform="translate3d(0, 255px, 0)"),e}updatePopoverPosition(){if(!this.controller.isKeypadFunctionsPopoverOpen()){this.__popoverCache=void 0;return}let e=this.controller.computeMajorLayout(),t={keypadTop:e.keypad.top,keypadWidth:e.keypad.width,keypadHeight:e.keypad.height,showToLeft:e.grapher.height<525};if(__dcg_shared_module_exports__.E(t,this.__popoverCache))return;this.__popoverCache=t;let r=this.containerElt,n=r.querySelector("[dcg-command=functions]"),i=r.querySelector(".dcg-functions-popover"),o=r.querySelector(".dcg-arrow");if(t.showToLeft){i.classList.remove("dcg-top"),i.classList.add("dcg-left");let a=t.keypadHeight-(Gl(n).top-Gl(r).top)-n.offsetHeight/2-2-10;o.style.left="auto",o.style.bottom=`${a}px`}else i.classList.remove("dcg-left"),i.classList.add("dcg-top"),o.style.left=`${i.offsetWidth-n.offsetWidth/2}px`,o.style.bottom="auto"}};qt(),qt();var jle=function(){{let e=!1,t=function(){r(document),e=!0},r=function(n){e||ee(n).bind("touchstart",i=>{let o=ee(i.target),a=0,s=null;if(!o[0].closest("[disablescroll]"))for(;a===0&&o.length&&o[0].tagName!==void 0;){let l=getComputedStyle(o[0]).overflow,c=getComputedStyle(o[0]).overflowY;if(l!=="hidden"&&l!=="visible"&&c!=="hidden"&&c!=="hidden"){let d=o.scrollTop();d!==0&&(a=2),o.scrollTop(d+1),o.scrollTop()!==d&&(a=1|a,o.scrollTop(d))}o=ee(o[0].parentElement)}if(a!==0){s=[];let l=i.originalEvent.touches;for(let c=0;c<l.length;c++){let d={};for(let u in l[c])l[c].hasOwnProperty(u)&&(d[u]=l[c][u]);s.push(d)}}ee(document).on("touchmove.scrollfix",l=>{if(s){let c=s[0],d=l.originalEvent.touches[0].screenY-c.screenY;(d>0&&!(a&2)||d<0&&!(a&1))&&(a=0),d&&(s=null)}a===0&&l.preventDefault()}),ee(document).on("touchend.scrollfix",()=>{ee(document).off(".scrollfix")})})};return{limitScrollOnElement:r,limitScrollOnDocument:t}}}(),{limitScrollOnElement:mI,limitScrollOnDocument:P4e}=jle;qt();function FO(e){ee(e).on("drag dragend dragenter dragover dragleave drop",t=>{t.preventDefault(),t.stopPropagation()})}var ro=__dcg_shared_module_exports__.e(ne()),ko=__dcg_shared_module_exports__.e(ne()),ec=__dcg_shared_module_exports__.e(ne()),fI=class extends ec.Class{template(){return ec.createElement("span",{class:ec.const("dcg-navigate-back"),onTap:this.props.onBack,"aria-label":this.props.ariaLabel,role:ec.const("button"),tabIndex:ec.const("0"),handleEvent:ec.const("true"),manageFocus:this.const(rt({controller:this.props.controller(),location:{type:"geo-header-back-link"}}))},ec.createElement("i",{class:ec.const("dcg-icon-chevron-left"),"aria-hidden":ec.const("true")}))}},{Each:Yle,SwitchUnion:Xle,If:Jle}=ko.Components,bI=class extends ko.Class{init(){this.controller=this.props.controller()}template(){return ko.createElement("div",{role:ko.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-label-geometry-tools"),class:ko.const("dcg-geo-basic-tools dcg-animate-in-after-initial-load dcg-complex-tool-instruction-view")},ko.createElement(fI,{ariaLabel:()=>this.controller.s("account-shell-button-mygraphs-cancel"),controller:this.props.controller,onBack:this.bindFn(this.onCancel)}),Yle(()=>this.getInputIndexes(),{item:e=>ko.createElement(NO,{activeStep:this.bindFn(this.getInputIndex),controller:this.props.controller,toolSpec:()=>this.getToolSpec(),stepIdx:()=>e})}))}onCancel(){this.controller.dispatch({type:"select-geo-tool",tool:"selection"}),this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:"selection"}})}getInputIndex(){return this.controller.getGeoModel().getNonObjectsState().ui.currentTool.inputIndex}getInputIndexes(){return this.getToolSpec().inputs.map((e,t)=>t)}getToolSpec(){return this.controller.getGeoModel().getCurrentTool().getSpec()}},NO=class extends ko.Class{init(){this.controller=this.props.controller()}template(){return Xle(()=>this.getInputType(),{completed:()=>ko.createElement("span",null),upcoming:()=>ko.createElement("span",{class:ko.const("dcg-step-upcoming")},ko.createElement("span",null)),active:()=>ko.createElement("span",{class:ko.const("dcg-active-step")},ko.createElement("span",{class:ko.const("dcg-step-active-icon")},ko.createElement("span",null,()=>this.props.stepIdx()+1)),ko.createElement("span",{class:ko.const("dcg-active-step-text")},this.bindFn(this.getActiveString)),ko.createElement(Jle,{predicate:this.bindFn(this.isNumberInputStep)},()=>ko.createElement("span",{class:ko.const("dcg-input-flex-container"),didMount:this.bindFn(this.didMountNumberInput)},ko.createElement(lr,{containerClass:()=>({"dcg-suffix-degree":this.getNumberUnits()==="°","dcg-suffix-radian":this.getNumberUnits()==="rad"}),readonly:()=>!1,latex:()=>this.getNumberInputLatex(),ariaLabel:this.bindFn(this.getActiveString),isFocused:()=>this.isNumberInputFocused(),handleFocusChanged:(e,t)=>this.handleFocusedChanged(e,t),hasError:this.bindFn(this.doesNumberInputHaveError),controller:this.props.controller,handlePressedKey:(e,t)=>{this.handlePressedKey(e,t)},handleLatexChanged:e=>{this.handleLatexChanged(e)},handleSelectionChanged:e=>{this.handleLatexChanged(e.latex,!0)},dataLabelAttributeValue:this.const("transformation-number")}),ko.createElement("span",{class:()=>({"dcg-action-submit":!0,"dcg-disabled":this.isSubmitNumberDisabled(),"dcg-btn-purple":!0}),role:ko.const("button"),tabIndex:()=>this.isSubmitNumberDisabled()?-1:0,"aria-disabled":this.bindFn(this.isSubmitNumberDisabled),onTap:e=>this.submitNumberInput({device:e.device})},()=>this.controller.s("shared-calculator-button-go")))))})}getNumberUnits(){return this.controller.getActiveTool()==="rotate"?this.controller.getDegreeMode()?"°":"rad":""}didMountNumberInput(){this.controller.dispatch({type:"set-focus-location",location:{type:"new-transformation-number"}})}isNumberInputFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="new-transformation-number")}doesNumberInputHaveError(){var e;if(!this.getNumberInputLatex()||this.getNumberInputLatex()===((e=this.getStep().numberInputInfo)==null?void 0:e.defaultLatex))return!1;let t=this.props.toolSpec().outputs[0].id,{idMap:r}=this.controller.getGeoModel().getNonObjectsState().ui.currentTool,n=r[t];if(!n)return!0;let i=rb(this.controller.getListModel()).filter(s=>{var l;if(s.type==="expression")return n===((l=pi(s))==null?void 0:l.latex)}),o=i[0];if(!o||i.length===0||i.length>1||o.error)return!0;let a=o.formula.typed_constant_value;if(!a)return!0;if(__dcg_shared_module_exports__.Ab(a.valueType,__dcg_shared_module_exports__.Za)){let s=__dcg_shared_module_exports__.wb(a.valueType)?a.value:[a.value];for(let l of s){let[[c,d],[u,p]]=l;if(isNaN(c)||isNaN(d)||isNaN(u)||isNaN(p))return!0}return!1}return!0}handlePressedKey(e,t){let r=Fe.getFocusedMathquill();if(e==="Enter"){this.submitNumberInput({device:"keyboard"});return}r&&(r.keystroke(e,t),this.handleLatexChanged(r.latex()))}getNumberInputLatex(){return this.controller.getGeoModel().getCurrentTool().getNumberInputLatex()}isSubmitNumberDisabled(){return!!(this.doesNumberInputHaveError()||!this.getNumberInputLatex())}submitNumberInput(e){var t,r;if(this.isSubmitNumberDisabled())return;let n=this.controller.getGeoModel(),i=this.controller.getActiveTool(),o=n.getCurrentTool(),a=(t=o.getSpec)==null?void 0:t.call(o),s=o.tryCommitResults();s.committed&&(this.controller.dispatch(R({type:"commit-geo-objects"},s)),(r=this.controller.get2dPOIController())==null||r.speakGeoReleaseAction(i,a,s.committed),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}}))}handleLatexChanged(e,t){(this.getNumberInputLatex()!==e||t)&&(this.controller.getGeoModel().getCurrentTool().onNumberInput(e),this.controller.getGeoModel().onPreviewChange())}handleFocusedChanged(e,t){e&&!this.isNumberInputFocused()?this.controller.dispatch({type:"set-focus-location",location:{type:"new-transformation-number"}}):this.isNumberInputFocused()&&this.controller.dispatch({type:"blur-focus-location",location:{type:"new-transformation-number"}})}getActiveString(){let e=this.props.controller(),t=this.getStep().hint;return t?e.s(t):e.s("shared-calculator-narration-item-unknown")}isNumberInputStep(){return!!this.getStep().numberInputInfo}getStep(){return this.props.toolSpec().inputs[this.props.stepIdx()]}getInputType(){let e=this.props.activeStep(),t=this.props.stepIdx();return t<e?"completed":t>e?"upcoming":"active"}},{SwitchUnion:Qle,If:z9}=ro.Components,yI=class extends ro.Class{constructor(){super(...arguments),this.afterInitialLoad=!1}init(){this.controller=this.props.controller()}template(){return ro.createElement("div",{class:()=>({"dcg-geometry-toolbar-view":!0,"dcg-after-initial-load":this.afterInitialLoad}),style:()=>({left:`${this.controller.computeMajorLayout().grapher.left}px`}),onTapStart:this.bindFn(this.onTapStart)},ro.createElement("div",{class:ro.const("dcg-header-left dcg-do-blur")},ro.createElement(z9,{predicate:this.bindFn(this.showHamburger)},()=>ro.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),gravity:this.const("s")},ro.createElement("div",{role:ro.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),tabIndex:ro.const("0"),class:ro.const("dcg-action-opendrawer dcg-icon-btn dcg-in-api-action-opendrawer"),onTap:()=>this.controller.dispatch({type:"open-drawer"})},ro.createElement("i",{class:ro.const("dcg-icon-hamburger"),"aria-hidden":ro.const("true")})))),ro.createElement(z9,{predicate:this.bindFn(this.showOpenExpressionsButton)},()=>ro.createElement("div",{class:ro.const("dcg-show-expressions-tab dcg-icon-btn"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-show-list"),role:ro.const("button"),tabIndex:ro.const("0"),onTap:e=>{this.controller.dispatch({type:"show-expressions-list",focusHideIcon:e.device==="keyboard"})},manageFocus:this.const(rt({controller:this.controller,location:{type:"show-expression-list-btn"}}))},ro.createElement("i",{class:ro.const("dcg-icon-show"),"aria-hidden":ro.const("true")})))),ro.createElement("div",{class:ro.const("dcg-flex-spacer dcg-do-blur")}),Qle(this.bindFn(this.getViewToShow),{tools:()=>ro.createElement(QD,{controller:this.props.controller}),selectedItems:()=>ro.createElement(nk,{controller:this.props.controller}),complexToolInstructions:()=>ro.createElement(bI,{controller:this.props.controller})}),ro.createElement("div",{class:ro.const("dcg-flex-spacer dcg-do-blur")}))}showHamburger(){return this.controller.getGraphSettings().config.showHamburger?!this.controller.isListEnabled()||!this.controller.isListVisible()||this.controller.isNarrow():!1}showOpenExpressionsButton(){return this.controller.isListEnabled()&&!this.controller.isListVisible()&&!this.controller.isNarrow()}willUpdate(){this.afterInitialLoad||this.getViewToShow()==="selectedItems"&&(this.afterInitialLoad=!0)}onTapStart(e){e.target.classList.contains("dcg-do-blur")&&(this.controller.dispatch({type:"set-none-selected"}),this.controller.dispatch({type:"select-geo-tool",tool:"selection"}))}getViewToShow(){let e=this.controller.getActiveTool();return __dcg_shared_module_exports__.Dc(e)?"complexToolInstructions":this.controller.shouldShowMultiSelectHeader()?"selectedItems":"tools"}},xo=__dcg_shared_module_exports__.e(ne()),ms=__dcg_shared_module_exports__.e(ne()),Yy=class extends ms.Class{init(){this.controller=this.props.controller()}template(){return ms.createElement("div",{class:()=>({"dcg-btn-flat-gray":this.props.isPillbox(),"dcg-btn-flat-gray-group":this.props.isPillbox(),"dcg-group-horizontal":this.props.isPillbox()})},ms.createElement(Le,{tooltip:()=>this.controller.getshowKeyboardShortcutsInTooltips()?this.controller.s("graphing-calculator-label-undo-with-shortcut-tooltip"):this.controller.s("graphing-calculator-label-undo-tooltip"),gravity:this.const("s"),disabled:()=>!this.controller.canUndo(),displayBlock:this.props.isPillbox},ms.createElement("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-action-undo":!0,"dcg-icon-btn":!0,"dcg-pillbox-btn-interior":this.props.isPillbox(),"dcg-disabled":!this.controller.canUndo()}),tabIndex:()=>this.controller.canUndo()?0:-1,"aria-label":()=>this.controller.s("graphing-calculator-narration-undo"),onTap:this.bindFn(this.undo),"aria-disabled":()=>!this.controller.canUndo()},ms.createElement("i",{class:ms.const("dcg-icon-undo"),"aria-hidden":ms.const("true")}))),ms.createElement(Le,{tooltip:()=>this.controller.getshowKeyboardShortcutsInTooltips()?this.controller.s("graphing-calculator-label-redo-with-shortcut-tooltip"):this.controller.s("graphing-calculator-label-redo-tooltip"),gravity:this.const("s"),disabled:()=>!this.controller.canRedo(),displayBlock:this.props.isPillbox},ms.createElement("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-action-redo":!0,"dcg-icon-btn":!0,"dcg-pillbox-btn-interior":this.props.isPillbox(),"dcg-disabled":!this.controller.canRedo()}),tabIndex:()=>this.controller.canRedo()?0:-1,"aria-label":()=>this.controller.s("graphing-calculator-narration-redo"),onTap:()=>this.controller.dispatch({type:"redo"}),"aria-disabled":()=>!this.controller.canRedo()},ms.createElement("i",{class:ms.const("dcg-icon-redo"),"aria-hidden":ms.const("true")}))))}undo(){this.controller.hasVisibleAndUndoableToast()?this.controller.toastUndo():this.controller.dispatch({type:"undo"})}},ta=__dcg_shared_module_exports__.e(ne()),{If:Zle}=ta.Components,Ah=class extends ta.Class{init(){this.controller=this.props.controller()}template(){return ta.createElement(Le,{tooltip:this.bindFn(this.getTooltip),gravity:this.const("w")},ta.createElement("div",{class:()=>({"dcg-action-settings":!0,"dcg-pillbox-btn-interior":!0,"dcg-icon-btn":!0,"dcg-btn-flat-gray":this.isPillbox(),"dcg-settings-pillbox":this.isPillbox()}),role:ta.const("button"),tabIndex:ta.const("0"),"aria-haspopup":ta.const("true"),"aria-expanded":()=>this.controller.isGraphSettingsOpen(),"aria-label":this.bindFn(this.getTooltip),onTap:this.bindFn(this.onTapSettingsButton),manageFocus:this.const(rt({controller:this.controller,location:{type:"settings",location:"icon"}}))},ta.createElement("i",{class:ta.const("dcg-icon-wrench"),"aria-hidden":ta.const("true")}),ta.createElement(Zle,{predicate:()=>this.controller.getLockViewportUserSetting()},()=>ta.createElement("i",{class:ta.const("dcg-icon-lock"),"aria-hidden":ta.const("true")}))))}getTooltip(){return this.controller.isGeometry()?this.controller.s("graphing-calculator-label-tooltip-geometry-settings"):this.controller.s("graphing-calculator-label-tooltip-graph-settings")}isPillbox(){return this.props.isPillbox&&this.props.isPillbox()}onTapSettingsButton(e){this.controller.dispatch({type:"toggle-graph-settings",focusOnOpen:e.device==="keyboard"})}},bo=__dcg_shared_module_exports__.e(ne()),{SwitchUnion:ece}=bo.Components,h0=class extends bo.Class{template(){return this.controller=this.props.controller(),ece(()=>this.controller.getBrandingMode(),{"static-edit-link":()=>bo.createElement("div",{class:bo.const("dcg-graphpaper-branding")},bo.createElement("a",{href:()=>this.controller.getEditLink(),target:bo.const("_blank")},bo.createElement("span",{class:bo.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-on-desmos")},()=>this.controller.s("graphing-calculator-link-edit-on-desmos")),bo.createElement("i",{class:bo.const("dcg-icon-desmos"),"aria-hidden":bo.const("true")}))),"edit-link":()=>bo.createElement("div",{class:bo.const("dcg-graphpaper-branding")},bo.createElement("span",{class:bo.const("dcg-edit-branding"),onTap:()=>this.controller.dispatch({type:"open-on-web"})},bo.createElement("span",{class:bo.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-on-desmos")},()=>this.controller.s("graphing-calculator-link-edit-on-desmos")),bo.createElement("i",{class:bo.const("dcg-icon-desmos"),"aria-hidden":bo.const("true")}))),"powered-by":()=>bo.createElement("div",{class:bo.const("dcg-graphpaper-branding dcg-unclickable")},bo.createElement("span",{class:bo.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-powered-by-desmos")},()=>this.controller.s("graphing-calculator-label-powered-by")),bo.createElement("i",{class:bo.const("dcg-icon-desmos"),"aria-hidden":bo.const("true")}))})}},zs=__dcg_shared_module_exports__.e(ne()),g0=class extends zs.Class{init(){this.controller=this.props.controller()}template(){return zs.createElement("div",{class:zs.const("dcg-reset-container")},zs.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-reset"),gravity:this.props.tooltipGravity},zs.createElement("div",{class:zs.const("dcg-reset-pillbox dcg-action-reset dcg-btn-flat-gray dcg-pillbox-btn-interior"),role:zs.const("button"),tabIndex:zs.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-reset"),onTap:this.bindFn(this.reset)},zs.createElement("i",{class:zs.const("dcg-icon-reset"),"aria-hidden":zs.const("true")}))))}reset(){this.controller.dispatch({type:"reset-graph"})}},ra=__dcg_shared_module_exports__.e(ne()),m0=class extends ra.Class{init(){this.controller=this.props.controller()}template(){return ra.createElement("div",{class:()=>({"dcg-3d-orientation-pillbox":!0,"dcg-btn-flat-gray":!0,"dcg-btn-flat-gray-group":!0,"dcg-group-horizontal":this.props.layout()==="horizontal","dcg-group-vertical":this.props.layout()==="vertical"}),role:ra.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-3d-orientation-options-label")},ra.createElement(Le,{disabled:this.bindFn(this.isDefaultOrientation),tooltip:this.bindFn(this.getDefaultOrientationLabel),gravity:this.bindFn(this.getTooltipGravity),displayBlock:this.const(!0)},ra.createElement("div",{class:()=>({"dcg-action-defaultorientation":!0,"dcg-pillbox-btn-interior":!0,"dcg-disabled":this.isDefaultOrientation()}),role:ra.const("button"),"aria-disabled":this.bindFn(this.isDefaultOrientation),tabIndex:()=>this.isDefaultOrientation()?-1:0,"aria-label":this.bindFn(this.getDefaultOrientationLabel),onTap:this.bindFn(this.rotateToDefaultOrientation)},ra.createElement("i",{class:ra.const("dcg-icon-3d-cube"),"aria-hidden":ra.const("true")}))),ra.createElement(Le,{tooltip:this.bindFn(this.getXYOrientationLabel),gravity:this.bindFn(this.getTooltipGravity),disabled:this.bindFn(this.isXYPlaneOrientation),displayBlock:this.const(!0)},ra.createElement("div",{class:()=>({"dcg-action-xyorientation":!0,"dcg-pillbox-btn-interior":!0,"dcg-disabled":this.isXYPlaneOrientation()}),role:ra.const("button"),"aria-disabled":this.bindFn(this.isXYPlaneOrientation),tabIndex:()=>this.isXYPlaneOrientation()?-1:0,"aria-label":this.bindFn(this.getXYOrientationLabel),onTap:this.bindFn(this.rotateToXyOrientation)},ra.createElement("i",{class:ra.const("dcg-icon-xy-plane"),"aria-hidden":ra.const("true")}))))}getTooltipGravity(){return this.props.layout()==="horizontal"?"s":"w"}rotateToDefaultOrientation(){this.controller.dispatch({type:"zoom",direction:"default3dOrientation"})}rotateToXyOrientation(){this.controller.dispatch({type:"zoom",direction:"xy3dOrientation"})}isDefaultOrientation(){var e;let t=(e=this.controller.getGrapher3d())==null?void 0:e.controls;return!!(t!=null&&t.isDefaultOrientation())}isXYPlaneOrientation(){var e;let t=(e=this.controller.getGrapher3d())==null?void 0:e.controls;return!!(t!=null&&t.isXYPlaneOrientation())}getDefaultOrientationLabel(){return this.controller.s("graphing-calculator-label-tooltip-zoom-default-orientation")}getXYOrientationLabel(){return this.controller.s("graphing-calculator-label-tooltip-zoom-xy-orientation")}},ve=__dcg_shared_module_exports__.e(ne());qt();var tc=function(e,t,r){if(e===void 0||t===void 0)return!1;let n,i=t.getBoundingClientRect().height,o=e.getBoundingClientRect().height,a=Gl(e),s=Gl(t);if(!a||!s)return!1;let l=t.scrollTop,c=a.top+l-s.top,d=c-r,u=o+c+r-i;return d>=u?n=Math.min(Math.max(l,u),d):n=.5*(d+u),n!==l?(t.scrollTop=n,t.scrollTop!=l):!1},yo=__dcg_shared_module_exports__.e(ne()),Mh=__dcg_shared_module_exports__.e(ne()),Sm=class extends Mh.Class{template(){return Mh.createElement("div",{class:Mh.const("dcg-checkbox-title dcg-lock-viewport-option")},Mh.createElement(mt,{ariaLabel:()=>this.props.controller().s("graphing-calculator-label-settings-lock-viewport"),onChange:()=>{this.props.controller().dispatch({type:"toggle-lock-viewport"})},checked:()=>this.props.controller().getLockViewportUserSetting()},()=>this.props.controller().s("graphing-calculator-label-settings-lock-viewport")),Mh.createElement(Md,{href:this.const("https://help.desmos.com/hc/en-us/articles/4405296853517#h_01FZX4DBWKD83TZVMH615XF3QA"),controller:this.props.controller}))}},{If:xI}=yo.Components,wI=class extends yo.Class{init(){this.controller=this.props.controller(),this.isOpen=this.getAxisScale("x")==="logarithmic"||this.getAxisScale("y")==="logarithmic"||this.controller.getLockViewportUserSetting()}template(){return yo.createElement("div",{class:yo.const("dcg-advanced-graph-settings-view")},yo.createElement(xI,{predicate:()=>this.shouldShowLogScalesOption()},()=>yo.createElement("div",null,yo.createElement("div",{class:()=>({"dcg-advanced-toggle":!0,"dcg-margin-top":!0,"dcg-opened":this.isOpen}),onTap:this.bindFn(this.toggleOpen),tabIndex:yo.const(0),role:yo.const("button"),"aria-pressed":()=>this.isOpen},yo.createElement("div",{class:yo.const("dcg-caret-container")},yo.createElement("i",{class:yo.const("dcg-icon-caret-down"),"aria-hidden":yo.const("true")})),()=>this.controller.s("graphing-calculator-label-more-viewport-options")),yo.createElement(xI,{predicate:()=>this.isOpen},()=>yo.createElement("div",{class:yo.const("dcg-advanced-contents")},yo.createElement("div",{class:yo.const("dcg-log-axes-container")},yo.createElement("div",null,()=>this.getAxisScaleLabel("x")),yo.createElement(vo,{ariaGroupLabel:()=>this.getAxisScaleLabel("x"),theme:this.const("mini"),staticConfig:this.const(this.getStaticConfigForAxis("x"))}),yo.createElement("div",null,()=>this.getAxisScaleLabel("y")),yo.createElement(vo,{ariaGroupLabel:()=>this.getAxisScaleLabel("y"),theme:this.const("mini"),staticConfig:this.const(this.getStaticConfigForAxis("y"))})),yo.createElement(xI,{predicate:()=>!this.controller.getLockViewportConfigSetting()},()=>yo.createElement(Sm,R({},this.props))))))),yo.createElement(xI,{predicate:()=>!this.controller.getLockViewportConfigSetting()&&!this.shouldShowLogScalesOption()},()=>yo.createElement(Sm,R({},this.props))))}toggleOpen(){this.isOpen=!this.isOpen,this.update()}getAxisScaleLabel(e){return e==="x"?this.controller.s("graphing-calculator-label-settings-x-axis")+":":this.controller.s("graphing-calculator-label-settings-y-axis")+":"}getStaticConfigForAxis(e){return[{key:"linear",label:()=>"Linear",selected:()=>this.getAxisScale(e)==="linear",onSelect:()=>this.setAxisScale({axis:e,scale:"linear"})},{key:"logarithmic",label:()=>"Logarithmic",selected:()=>this.getAxisScale(e)==="logarithmic",onSelect:()=>this.setAxisScale({axis:e,scale:"logarithmic"})}]}shouldShowLogScalesOption(){return this.controller.getGraphSettings().config.logScales&&!this.controller.isThreeDMode()}getAxisScale(e){return this.controller.getGraphSettings()[e==="x"?"xAxisScale":"yAxisScale"]}setAxisScale({axis:e,scale:t}){return this.controller.dispatch({type:"set-graph-settings",[e==="x"?"xAxisScale":"yAxisScale"]:t})}},hn=__dcg_shared_module_exports__.e(ne()),{If:tce}=hn.Components,Gh=class extends hn.Class{init(){this.controller=this.props.controller()}template(){return hn.createElement("div",null,hn.createElement("div",{class:hn.const("dcg-braille-options-buttons")},hn.createElement(vo,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-braille-mode"),staticConfig:this.bindFn(this.getBrailleOptions)})),hn.createElement("div",{class:hn.const("dcg-six-key-checkbox")},hn.createElement(mt,{onChange:e=>this.controller.dispatch({type:"set-six-key-input",useSixKeyInput:e}),checked:()=>this.controller.getSixKeyInput()},()=>this.controller.s("graphing-calculator-label-settings-six-key-braille")),hn.createElement(Md,{href:this.const("https://www.desmos.com/accessibility#braille"),controller:this.props.controller})),hn.createElement(tce,{predicate:this.props.showBrailleNote},()=>hn.createElement("div",{class:hn.const("dcg-refreshable-braille-note")},()=>this.controller.s("graphing-calculator-text-refreshable-braille-display-note")+" ",hn.createElement("a",{href:()=>"https://www.desmos.com/braille-examples?"+this.controller.getBrailleMode(),class:hn.const("dcg-blue-link"),target:hn.const("_blank")},()=>this.controller.s("graphing-calculator-link-view-braille-examples")))))}getBrailleOptions(){return[{key:"nemeth",label:()=>this.controller.s("shared-calculator-button-braille-mode-nemeth"),selected:()=>this.controller.getBrailleMode()==="nemeth",onSelect:()=>this.setBrailleMode("nemeth")},{key:"ueb",label:()=>this.controller.s("shared-calculator-button-braille-mode-ueb"),selected:()=>this.controller.getBrailleMode()==="ueb",onSelect:()=>this.setBrailleMode("ueb")}]}setBrailleMode(e){this.controller.dispatch({type:"set-braille-mode",mode:e})}},gn=__dcg_shared_module_exports__.e(ne()),{If:q9}=gn.Components,Lh=class extends gn.Class{init(){this.controller=this.props.controller()}toggleComplexMode(){this.controller.logEvent({category:"settings",action:this.props.isComplexModeEnabled()?"disable-complex":"enable-complex"}),this.props.toggleComplexMode()}template(){return gn.createElement("div",{class:gn.const("dcg-options-menu-section dcg-complex-container")},gn.createElement("div",{class:gn.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-label-settings-complex-mode"),gn.createElement(go,{ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-complex-mode"),onChange:this.bindFn(this.toggleComplexMode),toggled:this.props.isComplexModeEnabled})),gn.createElement(q9,{predicate:this.props.isComplexModeEnabled},()=>gn.createElement("div",{class:gn.const("dcg-complex-options-section")},gn.createElement("div",{class:gn.const("dcg-complex-enabled-note")},gn.createElement(es,{content:()=>this.controller.s("shared-calculator-text-complex-enabled-note",{eq1:"`i^2`",eq2:"`\\sqrt{-4}`"}),mqConfig:this.const({})}),gn.createElement(q9,{predicate:()=>this.props.product()==="graphing"||this.props.product()==="graphing-3d"},()=>gn.createElement("div",{class:gn.const("dcg-complex-plotting-note")},()=>this.controller.s("graphing-calculator-text-complex-plotting-note")))))))}},Pc=__dcg_shared_module_exports__.e(ne()),{IfElse:rce}=Pc.Components,rc=class extends Pc.Class{init(){this.controller=this.props.setup().controller}getGravity(){return this.props.setup().type==="basic"?"s":this.controller.isNarrow()?"n":"w"}template(){return Pc.createElement("div",{class:Pc.const("dcg-options-menu-section dcg-radiangroup")},rce(()=>this.controller.isComplexModeEnabled(),{true:()=>Pc.createElement(Le,{tooltip:()=>this.controller.s("shared-calculator-text-complex-radian-mode"),gravity:this.bindFn(this.getGravity),sticky:this.const(!0),displayBlock:this.const(!0),additionalClass:this.const("dcg-cursor-default")},Pc.createElement(vo,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-settings-angle"),theme:()=>this.props.setup().type==="basic"?"mini":"default",staticConfig:this.bindFn(this.getAngleModeOptions),disabled:()=>this.controller.isComplexModeEnabled()})),false:()=>this.renderControl()}))}renderControl(){return Pc.createElement(vo,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-settings-angle"),theme:()=>this.props.setup().type==="basic"?"mini":"default",staticConfig:this.bindFn(this.getAngleModeOptions),disabled:()=>this.controller.isComplexModeEnabled()})}getAngleModeOptions(){let e=this.props.setup();return[{key:"radians",label:()=>e.type==="basic"?this.controller.s("basic-calculator-label-controlbar-rad"):this.controller.s("graphing-calculator-button-settings-radians"),selected:()=>!this.getDegreeMode(),onSelect:()=>this.setDegreeMode(!1),focusHelperOptions:e.type==="advanced"?{controller:e.controller,location:{type:"settings",location:"radian-mode"}}:void 0},{key:"degrees",label:()=>e.type==="basic"?this.controller.s("basic-calculator-label-controlbar-deg"):this.controller.s("graphing-calculator-button-settings-degrees"),selected:()=>this.getDegreeMode(),onSelect:()=>this.setDegreeMode(!0),focusHelperOptions:e.type==="advanced"?{controller:e.controller,location:{type:"settings",location:"degree-mode"}}:void 0}]}getDegreeMode(){return this.controller.getDegreeMode()}setDegreeMode(e){this.controller.dispatch({type:"update-degree-mode",mode:e})}},ou=__dcg_shared_module_exports__.e(ne()),Xy=class extends ou.Class{init(){this.controller=this.props.controller()}template(){return ou.createElement("div",null,ou.createElement("div",{class:ou.const("dcg-displaysizegroup")},ou.createElement(vo,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size"),staticConfig:this.bindFn(this.getProjectorModeOptions)})),ou.createElement(mt,{onChange:this.bindFn(this.toggleInvertedColors),checked:()=>this.controller.getInvertedColors(),manageFocus:this.const(rt({controller:this.controller,location:{type:"settings",location:"reverse-contrast"}}))},()=>this.controller.s("graphing-calculator-label-settings-reverse-contrast")))}getProjectorModeOptions(){return[{key:"default",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-default"),class:()=>"dcg-displaysize-default",selected:()=>!this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!1),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"default-size"}}},{key:"large",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-large"),class:()=>"dcg-displaysize-large",selected:()=>this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!0),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"large-size"}}}]}onSelectProjectorModeOption(e){this.controller.dispatch({type:"set-projector-mode",value:e})}getProjectorMode(){return!!this.controller.getGraphSettings().config.projectorMode}toggleInvertedColors(){this.controller.dispatch({type:"set-inverted-colors",value:!this.controller.getInvertedColors()})}},{Input:H9,If:wl,IfElse:K9}=ve.Components,Ph=class extends ve.Class{template(){return ve.createElement(lr,{isFocused:()=>this.props.parent().getFocusedLimit()===this.props.limit(),latex:()=>this.props.parent().getLimitLatex(this.props.limit()),ariaLabel:this.props.ariaLabel,handleLatexChanged:e=>this.props.parent().setLimitLatex(this.props.limit(),e),handleFocusChanged:e=>this.props.parent().onFocusedChanged(this.props.limit(),e),hasError:()=>this.props.parent().isLimitInvalid(this.props.limit()),dataLabelAttributeValue:this.props.limit,controller:this.props.controller,readonly:this.const(!1),containerClass:()=>({"dcg-log-scale":this.props.axisScale()==="logarithmic"})})}},vI=class extends ve.Class{init(){this.controller=this.props.controller(),this.uuid=Dd()}template(){return ve.createElement("div",{class:ve.const("dcg-settings-view-container")},ve.createElement(Ah,ie(R({},this.props),{isPillbox:this.const(!0)})),ve.createElement(wl,{predicate:()=>this.controller.isGraphSettingsOpen()},()=>ve.createElement("div",{class:ve.const("dcg-settings-container dcg-left dcg-popover dcg-constrained-height-popover"),style:this.bindFn(this.getContainerStyle),didMount:this.bindFn(this.didMountContainer),didUnmount:this.bindFn(this.didUnmountContainer)},ve.createElement("div",{class:ve.const("dcg-popover-interior"),role:ve.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-graph-settings")},ve.createElement("div",{class:ve.const("dcg-visual-settings")},ve.createElement(Xy,{controller:this.props.controller}),ve.createElement(wl,{predicate:()=>this.controller.getBrailleControls()},()=>ve.createElement("div",{class:ve.const("dcg-braille-container dcg-braille-mode")},ve.createElement(mt,{onChange:this.bindFn(this.toggleBrailleMode),checked:()=>this.controller.getBrailleMode()!=="none"},()=>this.controller.s("shared-calculator-narration-braille-mode")),ve.createElement(wl,{predicate:()=>this.controller.getBrailleMode()!=="none"},()=>ve.createElement("div",{class:ve.const("dcg-braille-options-container")},ve.createElement(Gh,{controller:this.props.controller,showBrailleNote:this.const(!0)})))))),ve.createElement("div",{class:ve.const("dcg-top-section-flex dcg-grid-settings-container")},ve.createElement("div",{class:ve.const("dcg-grid-settings")},ve.createElement(mt,{class:this.const("dcg-settings-grid-toggle"),onChange:this.bindFn(this.toggleGrid),checked:this.bindFn(this.getShowGrid)},()=>this.controller.s("graphing-calculator-label-settings-grid")),ve.createElement(wl,{predicate:this.bindFn(this.getShowGrid)},()=>ve.createElement("div",{class:ve.const("dcg-circle-icon-group dcg-grid-group")},ve.createElement("div",{class:()=>({"dcg-circle-icon":!0,"dcg-action-cartesian":!0,"dcg-selected":!this.getPolarMode()}),role:ve.const("button"),tabIndex:ve.const("0"),"aria-pressed":()=>!this.getPolarMode(),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-cartesian-grid"),onTap:this.bindFn(this.setCartesianMode)},ve.createElement("i",{class:ve.const("dcg-icon-cartesian")})),ve.const(" "),ve.createElement("div",{class:()=>({"dcg-circle-icon":!0,"dcg-action-polar":!0,"dcg-selected":this.getPolarMode()}),role:ve.const("button"),tabIndex:ve.const("0"),"aria-pressed":()=>this.getPolarMode(),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-polar-grid"),onTap:this.bindFn(this.setPolarMode)},ve.createElement("i",{class:ve.const("dcg-icon-polar")})))),ve.createElement(mt,{onChange:this.bindFn(this.toggleArrows),checked:()=>this.getAxisArrowMode()!=="NONE"},()=>this.controller.s("graphing-calculator-label-settings-arrows")),ve.createElement(wl,{predicate:()=>this.getAxisArrowMode()!=="NONE"},()=>ve.createElement("div",{class:ve.const("dcg-circle-icon-group dcg-arrow-group")},ve.createElement("div",{role:ve.const("button"),tabIndex:ve.const("0"),class:()=>({"dcg-circle-icon":!0,"dcg-arrows":!0,"dcg-selected":this.getAxisArrowMode()==="BOTH"}),"dcg-arrows":ve.const("BOTH"),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-show-both"),"aria-pressed":()=>this.getAxisArrowMode()==="BOTH",onTap:()=>this.setAxisArrowMode("BOTH")},ve.createElement("i",{class:ve.const("dcg-icon-arrows-two"),"aria-hidden":ve.const("true")})),ve.const(" "),ve.createElement("div",{role:ve.const("button"),tabIndex:ve.const("0"),class:()=>({"dcg-circle-icon":!0,"dcg-arrows":!0,"dcg-selected":this.getAxisArrowMode()==="POSITIVE"}),"dcg-arrows":ve.const("POSITIVE"),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-show-positive"),"aria-pressed":()=>this.getAxisArrowMode()==="POSITIVE",onTap:()=>this.setAxisArrowMode("POSITIVE")},ve.createElement("i",{class:ve.const("dcg-icon-arrows-one"),"aria-hidden":ve.const("true")}))))),ve.createElement("div",{class:ve.const("dcg-top-checkboxes-container")},ve.createElement(mt,{onChange:this.bindFn(this.toggleAxisNumbers),checked:this.bindFn(this.getAxisNumbers),small:this.const(!0)},()=>this.controller.s("graphing-calculator-label-settings-axis-numbers")),ve.createElement(wl,{predicate:()=>this.getShowGrid()&&!this.getPolarMode()},()=>ve.createElement(mt,{onChange:this.bindFn(this.toggleMinorGridlines),checked:this.bindFn(this.getMinorGridlines),small:this.const(!0)},()=>this.controller.s("graphing-calculator-label-settings-minor-gridlines"))),ve.createElement(wl,{predicate:()=>this.controller.canUseAdvancedStyling()&&!this.getPolarMode()},()=>ve.createElement(mt,{checked:()=>this.controller.getGraphSettings().restrictGridToFirstQuadrant,onChange:e=>this.controller.dispatch({type:"set-graph-settings",restrictGridToFirstQuadrant:e}),small:this.const(!0)},()=>this.controller.s("graphing-calculator-label-settings-one-quadrant"))),ve.createElement(wl,{predicate:this.bindFn(this.showZoomSquareButton)},()=>ve.createElement("div",{role:ve.const("button"),tabIndex:ve.const("0"),class:ve.const("dcg-action-zoom-square dcg-btn-light-gray"),onTap:this.bindFn(this.zoomSquare)},()=>this.controller.s("graphing-calculator-button-settings-zoom-square"))))),ve.createElement("div",{class:ve.const("dcg-axes-settings-container")},ve.createElement("div",{class:ve.const("dcg-checkbox-title dcg-x-axis-title")},ve.createElement(mt,{onChange:this.bindFn(this.toggleXAxis),checked:this.bindFn(this.getShowXAxis)},ve.createElement("span",{id:this.const(`x-axis-description-${this.uuid}`)},()=>this.controller.s("graphing-calculator-label-settings-x-axis"))),ve.createElement(wl,{predicate:this.bindFn(this.getShowXAxis)},()=>ve.createElement("div",{class:ve.const("dcg-axis-label")},ve.createElement("label",{for:this.const(`x-axis-label-${this.uuid}`)},()=>this.controller.s("graphing-calculator-button-label")),ve.createElement(H9,{class:this.const("dcg-x-axis-label"),disabled:()=>this.getShowXAxis()?void 0:!0,onInput:this.bindFn(this.onXAxisLabelInput),value:this.bindFn(this.getXAxisLabel),"aria-describedby":this.const(`x-axis-description-${this.uuid}`),id:this.const(`x-axis-label-${this.uuid}`),placeholder:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-label-placeholder")})))),ve.createElement("div",{class:ve.const("dcg-editable-mathquill-container dcg-x-axis-options")},ve.createElement(Ph,{limit:this.const("xmin"),axisScale:()=>this.getAxisScale("x"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),ve.createElement(nt,{config:this.const({}),latex:this.const("\\le x\\le")},ve.createElement("span",{class:ve.const("dcg-interval-interior")})),ve.createElement(Ph,{limit:this.const("xmax"),axisScale:()=>this.getAxisScale("x"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),ve.createElement(wl,{predicate:()=>!this.getPolarMode()},()=>K9(()=>this.getAxisScale("x")==="linear",{true:()=>ve.createElement("span",{class:ve.const("dcg-step-container")},ve.createElement("span",{class:ve.const("dcg-step-label"),"aria-hidden":ve.const("true")},()=>this.controller.s("graphing-calculator-label-settings-step")),ve.createElement(Ph,{limit:this.const("xstep"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-step"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})),false:()=>ve.createElement("span",{style:ve.const("display: none")})}))),ve.createElement("div",{class:ve.const("dcg-checkbox-title dcg-y-axis-title")},ve.createElement(mt,{onChange:this.bindFn(this.toggleYAxis),checked:this.bindFn(this.getShowYAxis)},ve.createElement("span",{id:this.const(`y-axis-description-${this.uuid}`)},()=>this.controller.s("graphing-calculator-label-settings-y-axis"))),ve.createElement(wl,{predicate:this.bindFn(this.getShowYAxis)},()=>ve.createElement("div",{class:ve.const("dcg-axis-label")},ve.createElement("label",{for:this.const(`y-axis-label-${this.uuid}`)},()=>this.controller.s("graphing-calculator-button-label")),ve.createElement(H9,{class:this.const("dcg-y-axis-label"),onInput:this.bindFn(this.onYAxisLabelInput),value:this.bindFn(this.getYAxisLabel),"aria-describedby":this.const(`y-axis-description-${this.uuid}`),id:this.const(`y-axis-label-${this.uuid}`),placeholder:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-label-placeholder")})))),ve.createElement("div",{class:ve.const("dcg-editable-mathquill-container dcg-y-axis-options")},ve.createElement(Ph,{limit:this.const("ymin"),axisScale:()=>this.getAxisScale("y"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),ve.createElement(nt,{config:this.const({}),latex:this.const("\\le y\\le")},ve.createElement("span",{class:ve.const("dcg-interval-interior")})),ve.createElement(Ph,{limit:this.const("ymax"),axisScale:()=>this.getAxisScale("y"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),ve.createElement(wl,{predicate:()=>!this.getPolarMode()},()=>K9(()=>this.getAxisScale("y")==="linear",{true:()=>ve.createElement("span",{class:ve.const("dcg-step-container")},ve.createElement("span",{class:ve.const("dcg-step-label"),"aria-hidden":ve.const("true")},()=>this.controller.s("graphing-calculator-label-settings-step")),ve.createElement(Ph,{limit:this.const("ystep"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-step"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})),false:()=>ve.createElement("span",{style:ve.const("display: none")})})))),ve.createElement(wI,{controller:this.props.controller}),ve.createElement(wl,{predicate:()=>this.controller.canEnableComplexMode()},()=>ve.createElement(Lh,ie(R({},this.props),{isComplexModeEnabled:()=>this.controller.isComplexModeEnabled(),toggleComplexMode:()=>this.controller.dispatch({type:"toggle-complex-mode"}),product:()=>this.controller.getProduct()}))),ve.createElement(rc,{setup:this.const({controller:this.controller,type:"advanced"})}),ve.createElement("div",{class:ve.const("dcg-arrow")})))))}toggleBrailleMode(){this.controller.dispatch({type:"set-braille-mode",mode:this.controller.getBrailleMode()==="none"?"nemeth":"none"})}didMountContainer(e){this.node=e,ee(document.documentElement).on("dcg-tapstart.settings-view wheel.settings-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:t.device==="keyboard"})}),ee(document.documentElement).on("keydown.settings-view",t=>{let r=ke(t);if(r==="Esc"&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:!0}),this.controller.isGraphSettingsOpen()&&r==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let n=this.controller.getFocusLocation();if(!n||n.type!=="settings")return;let i=!!this.controller.getGraphSettings().config.projectorMode,o=!!this.controller.getGraphSettings().degreeMode;t.shiftKey?t.shiftKey&&(i&&n.location==="large-size"||!i&&n.location==="default-size"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation()):n.location==="icon"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:o?"degree-mode":"radian-mode"}}),t.preventDefault(),t.stopPropagation())):n.location==="icon"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:i?"large-size":"default-size"}}),t.preventDefault(),t.stopPropagation()):(!o&&n.location==="radian-mode"||o&&n.location==="degree-mode")&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation())}})}didUnmountContainer(){ee(document.documentElement).off(".settings-view")}didUpdate(){if(!this.controller.isGraphSettingsOpen())return;let e=this.controller.getKeypadHeight();e!==this.cachedKeypadHeight&&document.activeElement&&this.node.contains(document.activeElement)&&tc(document.activeElement,this.node.querySelector(".dcg-popover-interior"),50),this.cachedKeypadHeight=e}eventShouldClosePopover(e){let t=e.target,r=this.node.contains(t),n=!!t.closest(".dcg-action-settings"),i=this.isMathquillFocused()&&!!t.closest(".dcg-keypad"),o=!!t.closest(".dcg-action-undo")||!!t.closest(".dcg-action-redo");return!(r||n||i||o)}isMathquillFocused(){return this.getFocusedLimit()!==void 0}getLimitLatex(e){return this.controller.getSettingsViewModel().limitLatex[e]||""}setLimitLatex(e,t){t!==this.controller.getSettingsViewModel().limitLatex[e]&&this.controller.dispatch({type:"set-axis-limit-latex",limit:e,latex:t})}getFocusedLimit(){let e=this.controller.getFocusLocation();if(e&&e.type==="settings")return e.location}getInvalidLimits(){let e=!!this.controller.getGraphSettings().degreeMode,t=io(this.getLimitLatex("xmin"),e),r=io(this.getLimitLatex("xmax"),e),n=io(this.getLimitLatex("ymin"),e),i=io(this.getLimitLatex("ymax"),e),o=this.getLimitLatex("xstep")===""?0:io(this.getLimitLatex("xstep"),e),a=this.getLimitLatex("ystep")===""?0:io(this.getLimitLatex("ystep"),e),s={},l=new Br(t,r,n,i);return isFinite(t)&&isFinite(r)?(s.xmin=!l.isXValid(this.controller.getGraphSettings().xAxisScale),s.xmax=s.xmin):(s.xmin=!isFinite(t),s.xmax=!isFinite(r)),isFinite(n)&&isFinite(i)?(s.ymin=!l.isYValid(this.controller.getGraphSettings().yAxisScale),s.ymax=s.ymin):(s.ymin=!isFinite(n),s.ymax=!isFinite(i)),s.xstep=!ay(o),s.ystep=!ay(a),s}isLimitInvalid(e){return this.getInvalidLimits()[e]}onFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"settings",location:e}})}onXAxisLabelInput(e){this.controller.dispatch({type:"set-graph-settings",xAxisLabel:e})}onYAxisLabelInput(e){this.controller.dispatch({type:"set-graph-settings",yAxisLabel:e})}getXAxisLabel(){return this.controller.getGraphSettings().xAxisLabel}getYAxisLabel(){return this.controller.getGraphSettings().yAxisLabel}getShowXAxis(){return!!this.controller.getGraphSettings().showXAxis}toggleXAxis(){this.controller.dispatch({type:"set-graph-settings",showXAxis:!this.getShowXAxis()})}getShowYAxis(){return!!this.controller.getGraphSettings().showYAxis}toggleYAxis(){this.controller.dispatch({type:"set-graph-settings",showYAxis:!this.getShowYAxis()})}getAxisNumbers(){return!!this.controller.getGraphSettings().xAxisNumbers}toggleAxisNumbers(){let e=this.getAxisNumbers();this.controller.dispatch({type:"set-graph-settings",xAxisNumbers:!e,yAxisNumbers:!e,polarNumbers:!e})}getMinorGridlines(){return this.controller.getGraphSettings().xAxisMinorSubdivisions===0}toggleMinorGridlines(){let e=this.getMinorGridlines()?1:0;this.controller.dispatch({type:"set-graph-settings",yAxisMinorSubdivisions:e,xAxisMinorSubdivisions:e})}getPolarMode(){return!!this.controller.getGraphSettings().polarMode}setPolarMode(){this.controller.dispatch({type:"set-polar-mode",polarMode:!0})}setCartesianMode(){this.controller.dispatch({type:"set-polar-mode",polarMode:!1})}getAxisScale(e){return this.controller.getGraphSettings()[e==="x"?"xAxisScale":"yAxisScale"]}getAxisArrowMode(){return this.controller.getGraphSettings().xAxisArrowMode}setAxisArrowMode(e){this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})}getShowGrid(){return this.controller.getGraphSettings().showGrid}toggleGrid(){this.controller.dispatch({type:"set-graph-settings",showGrid:!this.getShowGrid()})}toggleArrows(){let e=this.getAxisArrowMode()==="NONE"?"BOTH":"NONE";this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})}showZoomSquareButton(){let e=this.controller.getAxisScaleSettings();return e.xAxisScale===e.yAxisScale&&!this.controller.getGraphSettings().squareAxes}getContainerStyle(){return this.controller.getKeypadHeight()?"bottom: 0":""}zoomSquare(){this.controller.dispatch({type:"zoom",direction:"square"})}},Tr=__dcg_shared_module_exports__.e(ne());qt();var Ra=__dcg_shared_module_exports__.e(ne()),{If:W9}=Ra.Components,Jy=class extends Ra.Class{init(){this.controller=this.props.controller()}template(){return Ra.createElement(W9,{predicate:this.bindFn(this.shouldShowBrailleSection)},()=>Ra.createElement("div",{class:Ra.const("dcg-options-menu-section")},Ra.createElement("div",{class:Ra.const("dcg-options-menu-section-title")},()=>this.controller.s("shared-calculator-narration-braille-mode"),Ra.createElement(go,{ariaLabel:()=>this.controller.s("shared-calculator-narration-braille-mode"),onChange:this.bindFn(this.toggleBrailleMode),toggled:()=>this.controller.getBrailleMode()!=="none"})),Ra.createElement(W9,{predicate:()=>this.controller.getBrailleMode()!=="none"},()=>Ra.createElement("div",{class:Ra.const("dcg-braille-options-container")},Ra.createElement(Gh,{controller:this.props.controller,showBrailleNote:this.const(!0)})))))}shouldShowBrailleSection(){return this.controller.getBrailleControls()&&this.controller.getGraphSettings().config.expressions}toggleBrailleMode(){this.controller.dispatch({type:"set-braille-mode",mode:this.controller.getBrailleMode()==="none"?"nemeth":"none"})}},Uo=__dcg_shared_module_exports__.e(ne()),{If:$9}=Uo.Components,BO=0,f0=tI/8,CI=class extends Uo.Class{init(){this.controller=this.props.controller()}template(){return Uo.createElement("div",{class:Uo.const("dcg-options-menu-section")},Uo.createElement("div",{class:Uo.const("dcg-options-menu-section-title dcg-local-display-preferences-title")},()=>this.controller.s("graphing-calculator-label-display-properties"),Uo.createElement(Md,{href:this.const("https://help.desmos.com/hc/en-us/articles/20301369699981-3D-Graph-Settings#h_01HCFSXHM8S59ETFXB55Y8CZQ5’"),controller:this.props.controller})),Uo.createElement(mt,{onChange:this.bindFn(this.toggleInvertedColors),checked:()=>this.controller.getInvertedColors(),manageFocus:this.const(rt({controller:this.controller,location:{type:"settings",location:"reverse-contrast"}}))},()=>this.controller.s("graphing-calculator-label-settings-reverse-contrast")),Uo.createElement($9,{predicate:()=>this.controller.getGraphSettings().config.beta3d},()=>Uo.createElement(mt,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showBox3D:!this.controller.getGraphSettings().showBox3D})},checked:()=>this.controller.getGraphSettings().showBox3D},()=>this.controller.raw("Clip to box"))),Uo.createElement($9,{predicate:()=>!this.controller.getGraphSettings().config.beta3d},()=>Uo.createElement(mt,{class:()=>"dcg-translucent-surfaces-checkbox",onChange:this.bindFn(this.toggleTranslucentSurfaces),checked:()=>this.controller.getTranslucentSurfaces(),ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-translucent-surfaces"),manageFocus:this.const(rt({controller:this.controller,location:{type:"settings",location:"translucent-surfaces"}}))},()=>this.controller.s("graphing-calculator-label-settings-translucent-surfaces"))),Uo.createElement("div",{class:Uo.const("dcg-perspective-slider")},Uo.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-settings-3d-perspective-min")},Uo.createElement("i",{class:Uo.const("dcg-icon-3d-cube"),"aria-hidden":Uo.const("true")})),Uo.createElement(Kg,{min:()=>BO-1,max:()=>f0-1,step:()=>{},value:()=>this.getPerspectiveValue(),ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-3d-perspective-distortion-ratio"),ariaPercent:this.const(!0),onDragUpdate:this.bindFn(this.onDragUpdate),onKeyboardUpdate:this.bindFn(this.onKeyboardUpdate)}),Uo.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-settings-3d-perspective-max")},Uo.createElement("i",{class:Uo.const("dcg-icon-3d-perspective"),"aria-hidden":Uo.const("true")}))))}toggleTranslucentSurfaces(){this.controller.dispatch({type:"set-translucent-surfaces",value:!this.controller.getTranslucentSurfaces()})}toggleInvertedColors(){this.controller.dispatch({type:"set-inverted-colors",value:!this.controller.getInvertedColors()})}getPerspectiveValue(){return this.controller.getPerspectiveDistortion()-1}onKeyboardUpdate(e){let t=this.getPerspectiveValue();switch(e){case"up":t+=.1;break;case"down":t-=.1;break;case"bigup":t+=.3;break;case"bigdown":t-=.3;break;case"min":t=BO-1;break;case"max":t=f0-1;break}t=__dcg_shared_module_exports__.Sb(t+1,BO,f0),this.controller.dispatch({type:"set-perspective-distortion",value:t})}onDragUpdate(e){this.controller.dispatch({type:"set-perspective-distortion",value:e+1})}},et=__dcg_shared_module_exports__.e(ne()),{If:Vh}=et.Components,Oh=class extends et.Class{template(){return et.createElement(lr,{isFocused:()=>this.props.parent().getFocusedLimit()===this.props.limit(),latex:()=>this.props.parent().getLimitLatex(this.props.limit()),ariaLabel:this.props.ariaLabel,handleLatexChanged:e=>this.props.parent().setLimitLatex(this.props.limit(),e),handleFocusChanged:e=>this.props.parent().onFocusedChanged(this.props.limit(),e),hasError:()=>this.props.parent().isLimitInvalid(this.props.limit()),dataLabelAttributeValue:this.props.limit,controller:this.props.controller,readonly:this.const(!1)})}},SI=class extends et.Class{init(){this.controller=this.props.controller(),this.isOpen=this.mustBeOpen()}willUpdate(){this.mustBeOpen()&&(this.isOpen=!0)}mustBeOpen(){var e;let t=(e=this.controller.getGrapher3d())==null?void 0:e.viewportController.getViewport();return t?t.xmin!==t.ymin||t.xmin!==t.zmin||t.xmax!==t.ymax||t.xmax!==t.zmax:!1}template(){return et.createElement("div",{class:et.const("dcg-three-d-domain dcg-advanced-graph-settings-view dcg-options-menu-section")},et.createElement("div",{class:et.const("dcg-options-menu-section-title dcg-flex-container")},et.createElement("div",null,()=>this.controller.s("graphing-calculator-label-edit-graph-bounds")),et.createElement("div",null,et.createElement(Vh,{predicate:this.bindFn(this.showRecenterButton)},()=>et.createElement("div",{role:et.const("button"),tabIndex:et.const("0"),class:et.const("dcg-action-zoom-recenter dcg-btn-light-gray"),onTap:this.bindFn(this.zoomRecenter)},()=>this.controller.s("graphing-calculator-label-recenter"))))),et.createElement("div",{class:et.const("dcg-three-d-domain-toggle-container")},et.createElement("div",{class:()=>({"dcg-advanced-toggle":!0,"dcg-opened":this.isOpen,"dcg-disabled":this.mustBeOpen()}),onTap:this.bindFn(this.toggleOpen),tabIndex:()=>this.mustBeOpen()?-1:0,"aria-disabled":()=>this.mustBeOpen(),role:et.const("button"),"aria-expanded":()=>this.isOpen,"aria-label":()=>this.controller.s("graphing-calculator-label-edit-graph-bounds")},et.createElement("div",{class:et.const("dcg-caret-container")},et.createElement("i",{class:et.const("dcg-icon-caret-down"),"aria-hidden":et.const("true")})),et.createElement(Vh,{predicate:()=>this.isOpen},()=>et.createElement("span",{class:et.const("dcg-axis-label")},et.createElement(nt,{config:this.const({}),latex:this.const("x")}),et.const("-axis:"))),et.createElement(Vh,{predicate:()=>!this.isOpen},()=>et.createElement("span",{class:et.const("dcg-axis-label")},()=>this.controller.s("graphing-calculator-label-settings-all-axes")))),et.createElement("div",{class:et.const("dcg-editable-mathquill-container dcg-x-axis-options")},et.createElement(Oh,{limit:this.const("xmin"),ariaLabel:()=>this.isOpen?this.controller.s("graphing-calculator-narration-settings-x-axis-min"):this.controller.s("graphing-calculator-narration-settings-all-axes-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),et.createElement(Vh,{predicate:()=>this.isOpen},()=>et.createElement(nt,{config:this.const({}),latex:this.const("\\le x\\le")},et.createElement("span",{class:et.const("dcg-interval-interior")}))),et.createElement(Vh,{predicate:()=>!this.isOpen},()=>et.createElement("span",{class:et.const("dcg-axis-label-to")},()=>this.controller.s("shared-label-to"))),et.createElement(Oh,{limit:this.const("xmax"),ariaLabel:()=>this.isOpen?this.controller.s("graphing-calculator-narration-settings-x-axis-max"):this.controller.s("graphing-calculator-narration-settings-all-axes-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}))),et.createElement(Vh,{predicate:()=>this.isOpen},()=>et.createElement("div",{class:et.const("dcg-advanced-contents")},et.createElement("div",{class:et.const("dcg-editable-mathquill-container dcg-y-axis-options")},et.createElement("span",{class:et.const("dcg-axis-label")},et.createElement(nt,{config:this.const({}),latex:this.const("y")}),et.const("-axis:")),et.createElement(Oh,{limit:this.const("ymin"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),et.createElement(nt,{config:this.const({}),latex:this.const("\\le y\\le")},et.createElement("span",{class:et.const("dcg-interval-interior")})),et.createElement(Oh,{limit:this.const("ymax"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})),et.createElement("div",null,et.createElement("div",{class:et.const("dcg-editable-mathquill-container dcg-z-axis-options")},et.createElement("span",{class:et.const("dcg-axis-label")},et.createElement(nt,{config:this.const({}),latex:this.const("z")}),et.const("-axis:")),et.createElement(Oh,{limit:this.const("zmin"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-z-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),et.createElement(nt,{config:this.const({}),latex:this.const("\\le z\\le")},et.createElement("span",{class:et.const("dcg-interval-interior")})),et.createElement(Oh,{limit:this.const("zmax"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-z-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}))),et.createElement(Vh,{predicate:this.bindFn(this.showZoomSquareButton)},()=>et.createElement("div",null,et.createElement("div",{role:et.const("button"),tabIndex:et.const("0"),class:et.const("dcg-action-zoom-square-3d dcg-btn-blue"),onTap:this.bindFn(this.zoomSquare)},()=>this.controller.s("graphing-calculator-button-settings-zoom-square")))))),et.createElement(Vh,{predicate:()=>!this.controller.getLockViewportConfigSetting()},()=>et.createElement(mt,{ariaLabel:()=>this.props.controller().s("graphing-calculator-label-disable-zoom"),onChange:()=>{this.props.controller().dispatch({type:"toggle-lock-viewport"})},checked:()=>this.props.controller().getLockViewportUserSetting()},()=>this.props.controller().s("graphing-calculator-label-disable-zoom"))))}showRecenterButton(){var e;let t=(e=this.controller.getGrapher3d())==null?void 0:e.webglLayer.domain();return!!t&&!G7(t,0)}zoomRecenter(e){this.controller.dispatch({type:"zoom",direction:"recenter"}),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"xmin"}})}getFocusedLimit(){let e=this.controller.getFocusLocation();if(e&&e.type==="settings")return e.location}getLimitLatex(e){return this.controller.getSettingsViewModel().limitLatex[e]||""}setLimitLatex(e,t){t!==this.controller.getSettingsViewModel().limitLatex[e]&&this.controller.dispatch({type:"set-axis-limit-latex",limit:e,latex:t,updateYZAlso:!this.isOpen&&(e==="xmin"||e==="xmax")})}getInvalidLimits(){let e=!!this.controller.getGraphSettings().degreeMode,t=io(this.getLimitLatex("xmin"),e),r=io(this.getLimitLatex("xmax"),e),n=io(this.getLimitLatex("ymin"),e),i=io(this.getLimitLatex("ymax"),e),o=io(this.getLimitLatex("zmin"),e),a=io(this.getLimitLatex("zmax"),e),s={},l=new Br(t,r,n,i,o,a);return isFinite(t)&&isFinite(r)?(s.xmin=!l.isXValid(this.controller.getGraphSettings().xAxisScale),s.xmax=s.xmin):(s.xmin=!isFinite(t),s.xmax=!isFinite(r)),isFinite(n)&&isFinite(i)?(s.ymin=!l.isYValid(this.controller.getGraphSettings().yAxisScale),s.ymax=s.ymin):(s.ymin=!isFinite(n),s.ymax=!isFinite(i)),isFinite(o)&&isFinite(a)?(s.zmin=!l.isZValid(),s.zmax=s.zmin):(s.zmin=!isFinite(o),s.zmax=!isFinite(a)),s}isLimitInvalid(e){return this.getInvalidLimits()[e]}onFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"settings",location:e}})}toggleOpen(){this.mustBeOpen()||(this.isOpen=!this.isOpen,this.update())}showZoomSquareButton(){return!this.controller.getGraphSettings().squareAxes}zoomSquare(e){this.controller.dispatch({type:"zoom",direction:"square"}),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"zmax"}})}},{If:UO}=Tr.Components,EI=class extends Tr.Class{init(){this.controller=this.props.controller()}template(){return Tr.createElement("div",{class:Tr.const("dcg-settings-view-container dcg-settings-view-3d-container")},Tr.createElement("div",{class:Tr.const("dcg-3d-settings-flex-container")},Tr.createElement(Ah,ie(R({},this.props),{isPillbox:this.const(!0)}))),Tr.createElement(UO,{predicate:()=>this.controller.isGraphSettingsOpen()},()=>Tr.createElement("div",{class:Tr.const("dcg-settings-container dcg-left dcg-popover dcg-constrained-height-popover"),style:this.bindFn(this.getContainerStyle),didMount:this.bindFn(this.didMountContainer),didUnmount:this.bindFn(this.didUnmountContainer)},Tr.createElement("div",{class:Tr.const("dcg-popover-interior dcg-generic-options-menu"),role:Tr.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-graph-settings")},Tr.createElement(CI,{controller:this.props.controller}),Tr.createElement(SI,{controller:this.props.controller}),Tr.createElement("div",{class:Tr.const("dcg-options-menu-section")},Tr.createElement("div",{class:Tr.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-label-axes"),Tr.createElement(go,{ariaLabel:()=>this.controller.s("graphing-calculator-label-axes"),onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showAxis3D:!this.controller.getGraphSettings().showAxis3D})},toggled:()=>!!this.controller.getGraphSettings().showAxis3D})),Tr.createElement(UO,{predicate:()=>this.controller.getGraphSettings().showAxis3D},()=>Tr.createElement("div",{class:Tr.const("dcg-show-axis-labels-section")},Tr.createElement("div",null,Tr.createElement(mt,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showPlane3D:!this.controller.getGraphSettings().showPlane3D})},checked:()=>!!this.controller.getGraphSettings().showPlane3D},()=>this.controller.s("graphing-calculator-label-settings-domain-plane"))),Tr.createElement("div",null,Tr.createElement(mt,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showNumbers3D:!this.controller.getGraphSettings().showNumbers3D})},checked:()=>!!this.controller.getGraphSettings().showNumbers3D},()=>this.controller.s("graphing-calculator-label-settings-numbers-3d"))),Tr.createElement("div",null,Tr.createElement(mt,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showAxisLabels3D:!this.controller.getGraphSettings().showAxisLabels3D})},checked:()=>!!this.controller.getGraphSettings().showAxisLabels3D},()=>this.controller.s("graphing-calculator-label-settings-axis-labels-3d")))))),Tr.createElement(UO,{predicate:()=>this.controller.canEnableComplexMode()},()=>Tr.createElement(Lh,ie(R({},this.props),{isComplexModeEnabled:()=>this.controller.isComplexModeEnabled(),toggleComplexMode:()=>this.controller.dispatch({type:"toggle-complex-mode"}),product:this.const("graphing-3d")}))),Tr.createElement(Jy,{controller:this.props.controller}),Tr.createElement(rc,{setup:this.const({controller:this.controller,type:"advanced"})}),Tr.createElement("div",{class:Tr.const("dcg-arrow")})))))}didMountContainer(e){this.node=e,ee(document.documentElement).on("dcg-tapstart.settings-view wheel.settings-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:t.device==="keyboard"})}),ee(document.documentElement).on("keydown.settings-view",t=>{let r=ke(t);if(r==="Esc"&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:!0}),this.controller.isGraphSettingsOpen()&&r==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let n=this.controller.getFocusLocation();if(!n||n.type!=="settings")return;let i=!!this.controller.getGraphSettings().degreeMode;t.shiftKey?t.shiftKey&&(n.location==="reverse-contrast"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation()):n.location==="icon"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:i?"degree-mode":"radian-mode"}}),t.preventDefault(),t.stopPropagation())):n.location==="icon"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"reverse-contrast"}}),t.preventDefault(),t.stopPropagation()):(!i&&n.location==="radian-mode"||i&&n.location==="degree-mode")&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation())}})}didUnmountContainer(){ee(document.documentElement).off(".settings-view")}didUpdate(){if(!this.controller.isGraphSettingsOpen())return;let e=this.controller.getKeypadHeight();e!==this.cachedKeypadHeight&&document.activeElement&&this.node.contains(document.activeElement)&&tc(document.activeElement,this.node.querySelector(".dcg-popover-interior"),50),this.cachedKeypadHeight=e}eventShouldClosePopover(e){let t=e.target,r=this.node.contains(t),n=!!t.closest(".dcg-action-settings"),i=this.isMathquillFocused()&&t.closest(".dcg-keypad"),o=!!t.closest(".dcg-action-undo")||!!t.closest(".dcg-action-redo");return!(r||n||i||o)}isMathquillFocused(){let e=this.controller.getFocusLocation();return(e==null?void 0:e.type)==="settings"}getContainerStyle(){return this.controller.getKeypadHeight()?"bottom: 0":""}},Vc=__dcg_shared_module_exports__.e(ne()),TI=class extends Vc.Class{init(){this.controller=this.props.controller()}template(){return Vc.createElement(Le,{tooltip:this.bindFn(this.getZoomRestoreLabel),gravity:this.const("w")},Vc.createElement("div",{class:()=>({"dcg-btn-flat-gray":!0,"dcg-pillbox-btn-interior":!0,"dcg-action-zoomrestore":!0}),role:Vc.const("button"),tabIndex:Vc.const("0"),"aria-label":this.bindFn(this.getZoomRestoreLabel),onTap:this.bindFn(this.setDefaultViewport),manageFocus:this.const(rt({controller:this.controller,location:{type:"zoom-restore-btn"}}))},Vc.createElement("i",{class:Vc.const("dcg-icon-home"),"aria-hidden":Vc.const("true")})))}setDefaultViewport(){this.controller.dispatch({type:"zoom",direction:"default"}),this.controller.dispatch({type:"set-focus-location",location:{type:"zoom-in-btn"}})}getZoomRestoreLabel(){return this.controller.s("graphing-calculator-label-tooltip-viewport-default")}},ni=__dcg_shared_module_exports__.e(ne()),DI=class extends ni.Class{init(){this.controller=this.props.controller()}template(){return ni.createElement("div",{class:ni.const("dcg-zoom-container")},ni.createElement("div",{class:ni.const("dcg-zoominout-pillbox dcg-btn-flat-gray dcg-btn-flat-gray-group dcg-group-vertical"),role:ni.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-zoom-options-label")},ni.createElement(Le,{tooltip:this.bindFn(this.getZoomInLabel),displayBlock:this.const(!0),gravity:this.const("w")},ni.createElement("div",{class:ni.const("dcg-action-zoomin dcg-pillbox-btn-interior"),role:ni.const("button"),tabIndex:ni.const("0"),"aria-label":this.bindFn(this.getZoomInLabel),onTap:this.bindFn(this.zoomIn),manageFocus:this.const(rt({controller:this.controller,location:{type:"zoom-in-btn"}}))},ni.createElement("i",{class:ni.const("dcg-icon-plus"),"aria-hidden":ni.const("true")}))),ni.createElement(Le,{tooltip:this.bindFn(this.getZoomOutLabel),displayBlock:this.const(!0),gravity:this.const("w")},ni.createElement("div",{class:ni.const("dcg-action-zoomout dcg-pillbox-btn-interior"),role:ni.const("button"),tabIndex:ni.const("0"),"aria-label":this.bindFn(this.getZoomOutLabel),onTap:this.bindFn(this.zoomOut)},ni.createElement("i",{class:ni.const("dcg-icon-minus"),"aria-hidden":ni.const("true")})))))}zoomIn(){this.controller.dispatch({type:"zoom",direction:"in"})}zoomOut(){this.controller.dispatch({type:"zoom",direction:"out"})}getZoomInLabel(){return this.controller.s("graphing-calculator-label-tooltip-zoom-in")}getZoomOutLabel(){return this.controller.s("graphing-calculator-label-tooltip-zoom-out")}},{Each:oce,If:b0}=xo.Components,kI=class extends xo.Class{init(){this.controller=this.props.controller()}template(){return xo.createElement("div",null,xo.createElement(b0,{predicate:this.bindFn(this.shouldShowLeftPillboxes)},()=>xo.createElement("div",{class:()=>({"dcg-left-pillboxes":!0,"dcg-geometry-toolbar-present":this.controller.shouldShowGeoToolbar()})},xo.createElement(b0,{predicate:this.bindFn(this.shouldShowUndoRedo)},()=>xo.createElement(Yy,{controller:this.props.controller,isPillbox:this.const(!0)})),xo.createElement(b0,{predicate:this.bindFn(this.shouldShowGeoReset)},()=>xo.createElement(g0,{controller:this.props.controller,tooltipGravity:this.const("s")})))),xo.createElement("div",{class:()=>({"dcg-pillbox-container":!0,"dcg-geometry-toolbar-present":this.controller.shouldShowGeoToolbar()}),role:()=>this.controller.isGeoUIActive()?void 0:"region","aria-label":()=>this.controller.isGeoUIActive()?void 0:this.controller.s("graphing-calculator-narration-graph-settings-controls")},xo.createElement("div",{class:xo.const("dcg-overgraph-pillbox-elements"),style:this.bindFn(this.getContainerStyle)},xo.createElement(b0,{predicate:()=>this.shouldShowOrientationPillbox()&&!this.onSmallScreen()},()=>xo.createElement("div",{class:xo.const("dcg-left-pillbox-elements")},xo.createElement(m0,{controller:this.props.controller,layout:this.const("horizontal")}))),xo.createElement(b0,{predicate:()=>this.getRightPillboxElements().length>0},()=>xo.createElement("div",{class:xo.const("dcg-right-pillbox-elements")},oce(()=>this.getRightPillboxElements(),{item:e=>{switch(e){case"settings2d":return xo.createElement(vI,{controller:this.props.controller});case"settings3d":return xo.createElement(EI,{controller:this.props.controller});case"settings-geo":return xo.createElement(Ah,ie(R({},this.props),{isPillbox:this.const(!0)}));case"reset":return xo.createElement(g0,{controller:this.props.controller,tooltipGravity:this.const("w")});case"zoom-in-out":return xo.createElement(DI,{controller:this.props.controller});case"orientation":return xo.createElement(m0,{layout:this.const("vertical"),controller:this.props.controller});case"zoom-home":return xo.createElement(TI,{controller:this.props.controller})}}}))))),xo.createElement(h0,{controller:()=>this.props.controller()}))}shouldShowLeftPillboxes(){return this.shouldShowGeoReset()||this.shouldShowUndoRedo()}shouldShowGeoReset(){return this.controller.isGeometry()&&this.shouldShowResetButton()&&!this.controller.isListEnabled()}shouldShowUndoRedo(){return this.controller.isGeometry()&&!this.controller.isListEnabled()&&!(this.controller.getGeoToolbarSuppressedByAuthor()||this.controller.getGraphSettings().config.hideGeoUI)}getRightPillboxElements(){let e=[];return this.shouldShowGraphSettings()&&e.push("settings2d"),this.shouldShow3DGraphSettings()&&e.push("settings3d"),this.shouldShowGeometrySettings()&&e.push("settings-geo"),this.shouldShowResetButton()&&!this.shouldShowGeoReset()&&e.push("reset"),this.shouldShowZoomInOutButtons()&&e.push("zoom-in-out"),this.shouldShowOrientationPillbox()&&this.onSmallScreen()&&e.push("orientation"),this.shouldShowZoomHomeButton()&&e.push("zoom-home"),e}shouldShowOrientationPillbox(){return this.controller.is3dProduct()&&this.controller.getGraphSettings().config.orientationButtons}getContainerStyle(){let e=this.controller.isKeypadOpen()?this.controller.getKeypadHeight():0;return this.controller.isGraphSettingsOpen()?`bottom: ${e}px;`:"bottom: auto"}shouldShow3DGraphSettings(){return this.controller.getGraphSettings().config.settingsMenu&&this.controller.is3dProduct()}shouldShowGraphSettings(){return this.controller.getGraphSettings().config.settingsMenu&&!this.controller.isGeometry()&&!this.controller.is3dProduct()}shouldShowGeometrySettings(){return this.controller.getGraphSettings().config.settingsMenu?this.controller.isGeometry():!1}zoomEnabled(){return this.controller.getGraphSettings().config.zoomButtons&&!this.isViewportLocked()}onSmallScreen(){let e=this.controller.getLayoutMeasurements();return e.width<450||e.height<450}shouldShowZoomInOutButtons(){return Df&&this.onSmallScreen()?!1:this.zoomEnabled()}shouldShowZoomHomeButton(){return this.zoomEnabled()&&!this.controller.isDefaultViewportRestored()}isViewportLocked(){return this.controller.getGraphSettings().config.lockViewport||this.controller.getGraphSettings().userLockedViewport}shouldShowResetButton(){return this.controller.getGraphSettings().config.showResetButtonOnGraphpaper&&this.controller.hasDefaultState()}},gr=__dcg_shared_module_exports__.e(ne()),{If:y0}=gr.Components,zO=class extends gr.Class{init(){this.controller=this.props.controller()}template(){return gr.createElement("span",{class:gr.const("dcg-toast")},gr.createElement("i",{class:gr.const("dcg-icon-error"),"aria-hidden":gr.const("true")}),gr.createElement(y0,{predicate:()=>!this.showUndo()},()=>gr.createElement("i",{class:gr.const("dcg-icon-remove"),onTap:()=>this.controller.dispatch({type:"toast/close"}),role:gr.const("link"),tabIndex:gr.const(0),"aria-label":gr.const("Dismiss Notice")})),gr.createElement("span",{class:gr.const("dcg-msg"),"aria-atomic":()=>this.shouldLiveUpdateAria(),"aria-live":()=>this.shouldLiveUpdateAria()?"assertive":""},()=>this.controller.toastData.message),gr.createElement(y0,{predicate:this.bindFn(this.showUndo)},()=>gr.createElement("a",{role:gr.const("link"),tabIndex:gr.const(0),class:gr.const("dcg-undo"),onTap:()=>this.controller.dispatch({type:"toast/undo"})},()=>this.controller.s("shared-calculator-label-toast-undo"))),gr.createElement(y0,{predicate:this.bindFn(this.showLearnMore)},()=>gr.createElement("a",{role:gr.const("link"),tabIndex:gr.const(0),target:gr.const("_blank"),onTap:()=>this.controller.dispatch({type:"toast/learn-more"})},()=>this.controller.s("shared-calculator-label-toast-learn-more"))),gr.createElement(y0,{predicate:()=>!!this.controller.toastData.link},()=>gr.createElement("a",{role:gr.const("link"),tabIndex:gr.const(0),target:gr.const("_blank"),href:()=>{var e;return((e=this.controller.toastData.link)==null?void 0:e.url)||""}},()=>{var e;return((e=this.controller.toastData.link)==null?void 0:e.text)||""})))}showUndo(){return!!this.controller.toastData.undoCallback}showLearnMore(){return!!this.controller.toastData.learnMoreCallback}shouldUpdate(){return!!this.controller.toastData.message}shouldLiveUpdateAria(){return!this.controller.toastData.noAria}},_I=class extends gr.Class{template(){return gr.createElement("div",{class:()=>({"dcg-toast-view":!0,"dcg-visible":!!this.props.controller().toastData.message,"dcg-below-geo-toolbar":this.isGeometryInCalculator()}),"toast-style":()=>this.props.controller().toastData.toastStyle},gr.createElement(y0,{predicate:()=>!!this.props.controller().toastData.message},()=>gr.createElement("div",{class:gr.const("dcg-toast-wrapper")},gr.createElement("div",{class:gr.const("dcg-toast-cover")}),gr.createElement(zO,R({},this.props)))))}isGeometryInCalculator(){var e;let t=this.props.controller();return(e=t.isGeometry)==null?void 0:e.call(t)}},tt=__dcg_shared_module_exports__.e(ne());qt();function j9(e){if(window.clipboardData&&window.clipboardData.getData)return window.clipboardData.getData("Text");if(e&&e.clipboardData&&e.clipboardData.getData)return e.clipboardData.getData("text/plain")}Ss();function qO(e){let t;if(typeof e=="number")t=e+"";else if(typeof e=="string")t=e;else return!1;return t.trim().match(/^-?[0-9]*\.?[0-9]*$/)}var Hd={delimiter:"",header:!1,dynamicTyping:!1,preview:0,step:void 0,encoding:"",comments:!1,complete:void 0,error:void 0,download:!1,chunk:void 0,keepEmptyRows:!1},Rn={};Rn.parse=ice,Rn.RECORD_SEP="",Rn.UNIT_SEP="",Rn.BYTE_ORDER_MARK="\uFEFF",Rn.BAD_DELIMITERS=["\r",`
`,'"',Rn.BYTE_ORDER_MARK],Rn.LocalChunkSize=1024*1024*10,Rn.RemoteChunkSize=1024*1024*5,Rn.DefaultDelimiter=",",Rn.Parser=II,Rn.ParserHandle=Y9;function ice(e,t){var r=nce(t),n=new Y9(r),i=n.parse(e);return i}function Y9(e){var t=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,r=this,n,i,o=!1,a,s=[],l={data:[],errors:[],meta:{}};e=HO(e),this.parse=function(E){if(a=!1,!e.delimiter){var _=g(E);_.successful?e.delimiter=_.bestDelimiter:(a=!0,e.delimiter=Rn.DefaultDelimiter),l.meta.delimiter=e.delimiter}if(Qy(e.step)){var w=e.step;e.step=function(v){l=v,d()?c():w(c(),r)}}return e.preview&&e.header&&e.preview++,n=E,i=new II(e),l=i.parse(n),c(),Qy(e.complete)&&!o&&e.complete(l),o?{meta:{paused:!0}}:l},this.pause=function(){o=!0,i.abort(),n=n.substr(i.getCharIndex())},this.resume=function(){o=!1,i=new II(e),i.parse(n),Qy(e.complete)&&!o&&e.complete(l)},this.abort=function(){i.abort(),Qy(e.complete)&&e.complete(l),n=""};function c(){return l&&a&&(y("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+Rn.DefaultDelimiter+"'"),a=!1),d()&&u(),p()}function d(){return e.header&&s.length==0}function u(){if(l){for(var E=0;d()&&E<l.data.length;E++)for(var _=0;_<l.data[E].length;_++)s.push(l.data[E][_]);l.data.splice(0,1)}}function p(){if(!l||!e.header&&!e.dynamicTyping)return l;for(var E=0;E<l.data.length;E++){for(var _={},w=0;w<l.data[E].length;w++){if(e.dynamicTyping){var v=l.data[E][w];v=="true"?l.data[E][w]=!0:v=="false"?l.data[E][w]=!1:l.data[E][w]=f(v)}e.header&&(w>=s.length?(_.__parsed_extra||(_.__parsed_extra=[]),_.__parsed_extra.push(l.data[E][w])):_[s[w]]=l.data[E][w])}e.header&&(l.data[E]=_,w>s.length?y("FieldMismatch","TooManyFields","Too many fields: expected "+s.length+" fields but parsed "+w,E):w<s.length&&y("FieldMismatch","TooFewFields","Too few fields: expected "+s.length+" fields but parsed "+w,E))}return e.header&&l.meta&&(l.meta.fields=s),l}function g(E){for(var _=[",","	","|",";",Rn.RECORD_SEP,Rn.UNIT_SEP],w,v,T,M=0;M<_.length;M++){var C=_[M],P=0,F=0;T=void 0;for(var B=new II({delimiter:C,preview:10}).parse(E),x=0;x<B.data.length;x++){var L=B.data[x].length;if(F+=L,typeof T=="undefined"){T=L;continue}else L>1&&(P+=Math.abs(L-T),T=L)}F/=B.data.length,(typeof v=="undefined"||P<v)&&F>1.99&&(v=P,w=C)}return e.delimiter=w,{successful:!!w,bestDelimiter:w}}function f(E){var _=t.test(E);return _?parseFloat(E):E}function y(E,_,w,v){l.errors.push({type:E,code:_,message:w,row:v})}}function II(e){var t=/^\s*$/,r,n,i,o,a,s,l,c,d,u,p,g,f,y,E=!1;e=e||{},n=e.delimiter,i=e.comments,o=e.step,a=e.preview,(typeof n!="string"||n.length!=1||Rn.BAD_DELIMITERS.indexOf(n)>-1)&&(n=","),i===!0?i="#":(typeof i!="string"||i.length!=1||Rn.BAD_DELIMITERS.indexOf(i)>-1||i==n)&&(i=!1),this.parse=function(K){if(typeof K!="string")throw"Input must be a string";return D(K),_()},this.abort=function(){E=!0},this.getCharIndex=function(){return l};function _(){for(;l<r.length&&!(E||a>0&&y>=a);)s=='"'?T():c?M():C(),w();return v()}function w(){l++,s=r[l]}function v(){if(E&&U("Abort","ParseAbort","Parsing was aborted by the user's step function"),c&&U("Quotes","MissingQuotes","Unescaped or mismatched quotes"),N(),!Qy(o))return ge()}function T(){G()&&!$()?c=!c:(B(),c&&$()?l++:U("Quotes","UnexpectedQuotes","Unexpected quotes"))}function M(){(z(l)||V(l))&&d++,B()}function C(){s==n?x():z(l)?(L(),w()):V(l)?L():P()?F():B()}function P(){if(!i)return!1;var K=l==0||V(l-1)||z(l-2);return K&&r[l]===i}function F(){for(;!z(l)&&!V(l)&&l<r.length;)w()}function B(){u[g][f]+=s}function x(){u[g].push(""),f=u[g].length-1}function L(){N(),d++,y++,u.push([]),g=u.length-1,x()}function N(){O(),Qy(o)&&(u[g]&&o(ge()),de())}function O(){u[g].length==1&&t.test(u[g][0])&&(e.keepEmptyRows?u[g].splice(0,1):u.splice(g,1),g=u.length-1)}function z(K){return K<r.length-1&&(r[K]=="\r"&&r[K+1]==`
`||r[K]==`
`&&r[K+1]=="\r")}function V(K){return r[K]=="\r"||r[K]==`
`}function $(){return!G()&&l<r.length-1&&r[l+1]=='"'}function G(){return!c&&W(l-1)||W(l+1)}function W(K){typeof K!="number"&&(K=l);var se=r[K];return K<=-1||K>=r.length||se==n||se=="\r"||se==`
`}function U(K,se,H){p.push({type:K,code:se,message:H,line:d,row:g,index:l})}function D(K){r=K,c=!1,l=0,y=0,d=1,de(),u=[[""]],s=r[l]}function de(){u=[],p=[],g=0,f=0}function ge(){return{data:u,errors:p,meta:{lines:d,delimiter:n,aborted:E,truncated:a>0&&l<r.length}}}}function nce(e){typeof e!="object"&&(e={});var t=HO(e);return(typeof t.delimiter!="string"||t.delimiter.length!=1||Rn.BAD_DELIMITERS.indexOf(t.delimiter)>-1)&&(t.delimiter=Hd.delimiter),typeof t.header!="boolean"&&(t.header=Hd.header),typeof t.dynamicTyping!="boolean"&&(t.dynamicTyping=Hd.dynamicTyping),typeof t.preview!="number"&&(t.preview=Hd.preview),typeof t.step!="function"&&(t.step=Hd.step),typeof t.complete!="function"&&(t.complete=Hd.complete),typeof t.error!="function"&&(t.error=Hd.error),typeof t.encoding!="string"&&(t.encoding=Hd.encoding),typeof t.download!="boolean"&&(t.download=Hd.download),typeof t.keepEmptyRows!="boolean"&&(t.keepEmptyRows=Hd.keepEmptyRows),t}function HO(e){if(typeof e!="object")return e;var t=e instanceof Array?[]:{};for(var r in e)t[r]=HO(e[r]);return t}function Qy(e){return typeof e=="function"}var{parse:X9}=Rn;function J9(e){let t=e.split(/\r?\n/),r=[],n=!1;if(!(t.length<2)){for(let i=0;i<t.length;i++){let o=t[i];if(!o.trim())continue;i>0&&!qO(o.replace(/,(\d{3})/g,"$1"))&&(n=!0);let a={content:o};r.push(a)}if(!n){let i=__dcg_shared_module_exports__.m(r,"content").map(o=>o.replace(/,(\d{3})/g,"$1"));return qO(i[0])||(i=i.slice(1)),[{content:"\\left["+i.join(",")+"\\right]",numberList:!0}]}return r}}function Q9(e){if(/^\s*$/.test(e))return;let t=X9(e,{preview:1e4}),r=t.data,n=[];if(t.errors.length&&!t.data.length){t.errors;return}if(!t.data.length||t.data.length<2)return;let i=r[0].length;for(let o=0;o<i;o++)n.push([]);for(let o=0;o<t.data.length;o++)if(!(o===0&&isNaN(parseFloat(r[o][0])))){if(r[o].length<2)return;if(!(!r[o][0]&&!r[o][1]))for(let a=0;a<i;a++){let s=(r[o][a]||"").replace(/,(\d{3})/g,"$1");if(s&&isNaN(parseFloat(s)))return;n[a].push(s)}}if(!(n[0].length<2))return n}function Z9(e){let t=__dcg_shared_module_exports__.Jc(dc(e));return t.graph.product="geometry-calculator",t}function AI(e){return/^\s*(https?:\/\/)?([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/calculator\/./.test(e)}function KO(e){return/^\s*(https?:\/\/)?([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/(geometry|geometry-beta)\/./.test(e)}function WO(e){return/^\s*(https?:\/\/)?([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/3d\/./.test(e)}function $O(e){return/^\s*(https?:\/\/)?([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/geometry-legacy\/./.test(e)}function e$(e){return AI(e)?"graphing":KO(e)?"geometry-calculator":$O(e)?"geometry":WO(e)?"graphing-3d":void 0}function MI(e,t,r){return Fr(this,null,function*(){let n=!1;e.dispatch({type:"toast/show",toast:{message:e.s("graphing-calculator-text-toast-importing-graph"),hideAfter:0,toastStyle:"cover",onHide:()=>{n=!0}}});let i=()=>{n||e.dispatch({type:"toast/show",toast:{message:e.s("graphing-calculator-text-toast-error-importing-graph"),toastStyle:"error",hideAfter:12e3}})},o=()=>{e.dispatch({type:"toast/show",toast:{message:e.s("graphing-calculator-text-toast-error-no-folders"),toastStyle:"error",hideAfter:12e3}})},a=(l,c)=>{e.dispatch({type:"set-state",state:l,opts:{forceUnsavedChanges:!0}}),e.dispatch({type:"toast/show",toast:{message:e.s("graphing-calculator-text-toast-imported-graph"),undoCallback:()=>{e.dispatch({type:"set-state",state:c,opts:{forceUnsavedChanges:!0}})}}})},s=(l,c,d)=>{if(n)return;let u=e.getSelectedItem();if(!u)return;let p=u.type==="folder",g=u.type!=="folder"&&!!u.folderId,f=p||g,y={},E=e.getState(),_=E.expressions.list;if(_.length===1&&!p&&!e.isGeometry()){a(l,E);return}if(e.isGeometry()&&d!=="graphing"){a(l,E);return}let w=l.expressions.list;d==="graphing"&&Array.isArray(w)&&(w=w.filter(P=>P.id!==__dcg_shared_module_exports__.xd));for(let P=0;P<w.length;P++){let F=e.generateId(),B=w[P];if(B.type==="folder")if(f){o();return}else{y[B.id]=F,B.id=F;continue}B.folderId?B.folderId=y[B.folderId]:p?B.folderId=u.id:g&&(B.folderId=u.folderId),B.id=F}let v=__dcg_shared_module_exports__.Jc(E),T=0;for(;T<_.length;){if(_[T].id===u.id){p&&(_[T].title=c);break}T+=1}let M=p?T+1:T,C=p?0:1;_.splice(M,C,...w),a(E,v)};try{let l=yield fetch(`${t}?${new URLSearchParams(wT)}`,{headers:{Accept:"application/json"}});if(!l.ok)throw void 0;let c=yield l.json(),d=c.state,u=e$(t);e.isGeometry()&&(u==="geometry"?d=ug(d):u==="graphing"&&(d=Z9(d))),d=dc(d),r(d,(p,g)=>{p||!g||!u?i():s(g,c.title||"",u)})}catch(l){i()}})}var Zy=__dcg_shared_module_exports__.e(ne()),x0=class extends Zy.Class{init(){this.controller=this.props.controller()}template(){return Zy.createElement("div",{class:Zy.const("dcg-drag-container"),style:()=>({top:this.getTopPx(),left:this.getLeftPx()})},this.props.children)}getTopPx(){let e=this.controller.getRawDragState();if(e)return e.itemTop+"px"}getLeftPx(){let e=this.controller.getRawDragState();if(e)return e.itemLeft+"px"}},iu=__dcg_shared_module_exports__.e(ne());qt();var{If:sce}=iu.Components,GI=class extends iu.Class{init(){this.guid=__dcg_shared_module_exports__.K("dcg-exp-list-resize")}template(){return iu.createElement(sce,{predicate:this.bindFn(this.isVisible)},()=>iu.createElement("div",{class:iu.const("dcg-exp-list-resizer"),onTapStart:this.bindFn(this.onTapStart)}))}isVisible(){return this.props.controller().expressionsAreFullWidth()?!1:this.props.controller().isListVisible()}onTapStart(e){this.initialWidth=this.props.controller().getExpListWidth(),this.initialLeft=e.changedTouches[0].clientX,ee(document).on(`dcg-tapmove.${this.guid}`,t=>{if(this.initialLeft===void 0||this.initialWidth===void 0)return;let r=t.changedTouches[0].clientX-this.initialLeft+this.initialWidth;this.props.controller().dispatch({type:"resize-exp-list",expListWidth:r})}),ee(document).on(`dcg-tapend.${this.guid}`,this.bindFn(this.onTapEnd)),ee(document).on(`dcg-tapcancel.${this.guid}`,this.bindFn(this.onTapEnd))}onTapEnd(){ee(document).off(`.${this.guid}`),this.initialLeft=void 0,this.initialWidth=void 0}},Qi=__dcg_shared_module_exports__.e(ne()),{For:lce,If:cce}=Qi.Components,LI=class extends Qi.Class{init(){var e;this.controller=this.props.controller(),this.model=this.props.model(),this.guid=(e=this.controller.getOpenItemMenu())==null?void 0:e.guid}didMount(){Fp(this.guid,this.controller)}willUnmount(){Np(this.guid,this.controller)}didMountArrow(e){this.arrowElt=e,Vs(this.arrowElt,this.controller)}didUpdate(){Vs(this.arrowElt,this.controller)}template(){let e=this.model;return Qi.createElement("div",{class:()=>({"dcg-table-column-menu":!0,"dcg-options-menu":!0}),role:Qi.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu")},Qi.createElement("div",null,Qi.createElement(lce,{each:this.bindFn(this.getSectionsWithColorAfterFirstOpen)},t=>{switch(t){case"points":return Qi.createElement(iy,{model:()=>e,controller:this.props.controller,isOpen:()=>this.isSectionOpen("points")});case"drag":return Qi.createElement(ty,{model:()=>e,controller:this.props.controller,isOpen:()=>this.isSectionOpen("drag")});case"lines":return Qi.createElement(oy,{model:()=>e,controller:this.props.controller,isOpen:()=>this.isSectionOpen("lines")});case"colors":return Qi.createElement(ih,{model:()=>e,controller:this.props.controller})}})),Qi.createElement(nh,{model:()=>e,controller:()=>this.props.controller()}),Qi.createElement(cce,{predicate:this.bindFn(this.shouldShowRegressionButton)},()=>Qi.createElement("div",{class:Qi.const("dcg-options-menu-section dcg-options-menu__regression-btn-container")},Qi.createElement("button",{class:()=>({"dcg-btn-light-gray":!0,"dcg-disabled":this.isRegressionButtonDisabled()}),onTap:this.bindFn(this.addRegression)},()=>this.controller.s("graphing-calculator-button-add-table-regression")))),Qi.createElement("div",{class:Qi.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow),didUnmount:()=>this.arrowElt=void 0}))}shouldShowRegressionButton(){return this.controller.shouldShowRegressionButton(this.model.table)?Cp(this.model):!1}getSectionsWithColorAfterFirstOpen(){let e=this.getSections(),t=[],r=!1;for(let n of e)t.push(n),n==="colors"&&(r=!0),!r&&this.canColorComeAfterSection(n)&&this.isSectionOpen(n)&&(t.push("colors"),r=!0);return t}canColorComeAfterSection(e){switch(e){case"colors":case"drag":return!1;case"lines":case"points":return!0;default:return e}}getSections(){return this.model.draggable&&!this.controller.isThreeDMode()&&!this.controller.shouldIgnoreGraphInteractions(this.model)?["points","lines","drag"]:["points","lines"]}isSectionOpen(e){switch(e){case"drag":return this.model.dragMode!=="NONE";case"lines":return!!this.model.lines;case"points":return!!this.model.points;case"colors":return!0}}addRegression(){this.isRegressionButtonDisabled()||(this.controller.dispatch({type:"close-item-settings-menu"}),this.controller.dispatch({type:"create-table-regression",tableId:this.model.table.id,regressionType:"linear",columnIds:{y:this.model.id,x:this.model.table.columnModels[0].id}}))}isRegressionButtonDisabled(){return!Ru(this.model)}},nu=__dcg_shared_module_exports__.e(ne()),PI=class extends nu.Class{init(){var e;this.controller=this.props.controller(),this.model=this.props.model(),this.guid=(e=this.controller.getOpenItemMenu())==null?void 0:e.guid}didMount(){Fp(this.guid,this.controller)}willUnmount(){Np(this.guid,this.controller)}didMountArrow(e){this.arrowElt=e,Vs(this.arrowElt,this.controller)}didUpdate(){Vs(this.arrowElt,this.controller)}template(){let e=this.model;return nu.createElement("div",{class:()=>({"dcg-table-column-menu":!0,"dcg-options-menu":!0}),role:nu.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu")},nu.createElement(ih,{model:()=>e,controller:this.props.controller}),nu.createElement("div",{class:nu.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow),didUnmount:()=>this.arrowElt=void 0}))}},ir=__dcg_shared_module_exports__.e(ne()),{If:w0}=ir.Components,VI=class extends ir.Class{constructor(){super(...arguments),this.justGlobalReplaced=!1}init(){this.controller=this.props.controller()}template(){return ir.createElement("div",{class:()=>({"dcg-expression-search-bar":!0,"dcg-expressions-scrolled":this.props.expsScrolled()&&!this.controller.getTickerOpen()}),role:ir.const("search")},ir.createElement("div",{class:ir.const("dcg-search-row")},ir.createElement("div",{class:ir.const("dcg-search-mathquill-container")},ir.createElement(Fe,{hasError:this.const(!1),getAriaLabel:()=>this.controller.s("graphing-calculator-label-search-expressions"),getAriaPostLabel:()=>this.controller.getExpressionSearchStr().length===0?this.controller.raw(""):this.shouldShowReplaceError()?this.controller.s("graphing-calculator-error-expression-replacement"):this.shouldShowSearchError()?this.controller.s("graphing-calculator-error-expression-search"):this.controller.s("shared-calculator-text-search-results",{count:__dcg_shared_module_exports__.ra(this.controller.getExpressionSearchCount())}),capExpressionSize:this.const(!1),onUserChangedLatex:this.bindFn(this.onSearchChange),latex:()=>this.controller.getRawExpressionSearchStr(),isFocused:this.bindFn(this.isSearchFocused),config:this.bindFn(this.getMQConfig),onFocusedChanged:this.bindFn(this.onSearchFocusChanged),noFadeout:this.const(!0),onUserPressedKey:(e,t)=>{if(e==="Esc")t&&t.preventDefault(),this.closeSearch();else if(e==="Enter")t&&t.preventDefault(),this.onEnter();else if(e==="Down"){let r=Fe.getFocusedMathquill();return!r||!Fe.applyArrowKeyAndReturnIfWasAtBounds(r,e,t)?void 0:this.controller.dispatch({type:"on-special-key-pressed",key:e})}else{let r=Fe.getFocusedMathquill();if(!r)return;r.keystroke(e,t),this.controller.getRawExpressionSearchStr()!==r.latex()&&(this.justGlobalReplaced=!1,this.onSearchChange(r.latex()))}}}),ir.createElement("i",{class:ir.const("dcg-icon-search"),"aria-hidden":ir.const("true")}),ir.createElement(w0,{predicate:()=>this.controller.getRawExpressionSearchStr().length===0},()=>ir.createElement("span",{class:ir.const("dcg-search-placeholder")},()=>this.controller.s("graphing-calculator-label-search-expressions"))),ir.createElement(w0,{predicate:()=>this.shouldShowSearchError()},()=>ir.createElement("span",{class:ir.const("dcg-search-replace-icon-container")},ir.createElement(Di,{error:()=>this.controller.s("graphing-calculator-error-expression-search"),size:this.const("small")}))),ir.createElement(w0,{predicate:()=>this.controller.isSearchReplaceValid()&&!this.justGlobalReplaced},()=>ir.createElement("span",{class:ir.const("dcg-search-replace-icon-container")},ir.createElement("i",{class:ir.const("dcg-icon-replace"),role:ir.const("button"),tabIndex:ir.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-button-replace"),onTap:this.bindFn(this.onGlobalReplace)}))),ir.createElement(w0,{predicate:()=>this.justGlobalReplaced},()=>ir.createElement("span",{class:ir.const("dcg-search-replace-icon-container")},ir.createElement("i",{class:ir.const("dcg-icon-check"),"aria-hidden":ir.const("true")}))),ir.createElement(w0,{predicate:()=>this.shouldShowReplaceError()},()=>ir.createElement("span",{class:ir.const("dcg-search-replace-icon-container")},ir.createElement(Di,{error:()=>this.controller.s("graphing-calculator-error-expression-replacement"),size:this.const("small")})))),ir.createElement("i",{onTap:()=>this.closeSearch(),tabIndex:ir.const("0"),"aria-label":()=>this.controller.s("account-shell-button-cancel"),role:ir.const("button"),class:ir.const("dcg-icon-remove dcg-do-not-blur")})))}onGlobalReplace(){this.justGlobalReplaced=!0,setTimeout(this.bindIfMounted(()=>{this.justGlobalReplaced=!1,this.update()}),1500),this.controller.dispatch({type:"rename-identifier-global",search:this.controller.getExpressionSearchStr(),replace:this.controller.getExpressionReplaceStr()})}onEnter(){this.controller.isSearchReplaceValid()?this.onGlobalReplace():this.controller.dispatch({type:"update-expression-search-str",str:this.controller.getRawExpressionSearchStr()})}shouldShowSearchError(){return!this.controller.getIsExpressionSearchStrValidForReplace()&&this.controller.getExpressionReplaceStr().length>0}shouldShowReplaceError(){return!this.shouldShowSearchError()&&!this.controller.getIsExpressionReplaceStrValidForReplace()&&this.controller.getExpressionReplaceStr().length>0}closeSearch(){this.controller.dispatch({type:"close-expression-search"})}onSearchChange(e){this.controller.dispatch({type:"update-expression-search-str",str:e})}onSearchFocusChanged(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"search-expressions"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"search-expressions"}})}isSearchFocused(){let e=this.controller.getFocusLocation();return!!e&&e.type==="search-expressions"}onReplaceChange(e){this.controller.dispatch({type:"update-expression-replace-str",str:e})}onReplaceFocusChanged(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"replace-expressions"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"replace-expressions"}})}isReplaceFocused(){let e=this.controller.getFocusLocation();return!!e&&e.type==="replace-expressions"}getMQConfig(){return this.controller.getMathquillConfig({additionalOperators:["label","rename","image"]})}},_t=__dcg_shared_module_exports__.e(ne()),ct=__dcg_shared_module_exports__.e(ne());qt();var{If:v0}=ct.Components,C0=class extends ct.Class{init(){this.controller=this.props.controller()}template(){return ct.createElement("div",{class:ct.const("dcg-add-expression-container")},ct.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-add-item-tooltip"),gravity:this.const("s")},ct.createElement("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-icon-btn":!0,"dcg-add-expression-btn":!0,"dcg-action-add-expression":!0,"dcg-do-blur":!0,"dcg-active":this.controller.isAddExpressionOpen()}),handleEvent:ct.const("true"),"aria-haspopup":ct.const("true"),"aria-expanded":()=>this.controller.isAddExpressionOpen(),"aria-label":()=>this.controller.s("graphing-calculator-label-add-item-tooltip"),didMount:e=>{this.toggleButtonNode=e},onTap:this.bindFn(this.toggleAddExpression),manageFocus:this.const(rt({controller:this.controller,location:{type:"add-item-btn"}}))},ct.createElement("i",{class:ct.const("dcg-icon-plus"),"aria-hidden":ct.const("true")}))),ct.createElement(v0,{predicate:()=>this.controller.isAddExpressionOpen()},()=>ct.createElement("div",{class:()=>({"dcg-add-expression-dropdown":!0,"dcg-popover":!0,"dcg-bottom":!this.controller.isNarrow(),"dcg-right":this.controller.isNarrow()}),role:ct.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-item-menu"),didMount:this.bindFn(this.didMountPopover),didUnmount:this.bindFn(this.didUnmountPopover)},ct.createElement("div",{class:ct.const("dcg-popover-interior")},ct.createElement("div",{class:ct.const("dcg-new-item dcg-do-not-blur dcg-action-newexpression"),role:ct.const("button"),tabIndex:ct.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-expression"),onTap:this.bindFn(this.newExpression),handleEvent:ct.const("true"),manageFocus:this.const(rt({controller:this.controller,location:{type:"add-expression-btn"}}))},ct.createElement("i",{class:ct.const("dcg-icon-new-expression dcg-expression-icon"),"aria-hidden":ct.const("true")}),()=>this.controller.s("graphing-calculator-label-expression-lowercase")),ct.createElement(v0,{predicate:()=>this.controller.areNotesEnabled()},()=>ct.createElement("div",{class:ct.const("dcg-new-item dcg-do-not-blur dcg-action-newtext"),role:ct.const("button"),tabIndex:ct.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-note"),onTap:this.bindFn(this.newText),handleEvent:ct.const("true"),manageFocus:this.const(rt({controller:this.controller,location:{type:"add-note-btn"}}))},ct.createElement("i",{class:ct.const("dcg-icon-new-text dcg-expression-icon"),"aria-hidden":ct.const("true")}),()=>this.controller.s("graphing-calculator-label-note-lowercase"))),ct.createElement("div",{class:ct.const("dcg-new-item dcg-do-not-blur dcg-action-newtable"),role:ct.const("button"),tabIndex:ct.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-table"),onTap:this.bindFn(this.newTable),handleEvent:ct.const("true"),manageFocus:this.const(rt({controller:this.controller,location:{type:"add-table-btn"}}))},ct.createElement("i",{class:ct.const("dcg-icon-table dcg-expression-icon"),"aria-hidden":ct.const("true")}),()=>this.controller.s("graphing-calculator-label-table-lowercase")),ct.createElement(v0,{predicate:()=>this.controller.areFoldersEnabled()},()=>ct.createElement("div",{class:ct.const("dcg-new-item dcg-do-not-blur dcg-action-newfolder"),role:ct.const("button"),tabIndex:ct.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-folder"),onTap:this.bindFn(this.newFolder),handleEvent:ct.const("true"),manageFocus:this.const(rt({controller:this.controller,location:{type:"add-folder-btn"}}))},ct.createElement("i",{class:ct.const("dcg-icon-new-folder dcg-expression-icon"),"aria-hidden":ct.const("true")}),()=>this.controller.s("graphing-calculator-label-folder-lowercase"))),ct.createElement(v0,{predicate:()=>this.controller.areImagesEnabled()},()=>ct.createElement(Op,{controller:()=>this.controller,ariaLabel:()=>this.controller.s("graphing-calculator-narration-add-image"),onFileChange:e=>this.insertFiles(e),location:this.const({type:"add-image-btn"}),readonly:this.const(!1)},ct.createElement("div",{class:ct.const("dcg-new-item dcg-action-newimage")},ct.createElement("i",{class:ct.const("dcg-icon-new-image dcg-expression-icon"),"aria-hidden":ct.const("true")}),()=>this.controller.s("graphing-calculator-label-image-lowercase")))),ct.createElement(v0,{predicate:this.bindFn(this.showAddTicker)},()=>ct.createElement("div",{class:ct.const("dcg-new-item dcg-do-not-blur dcg-action-ticker"),role:ct.const("button"),tabIndex:ct.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-ticker"),onTap:this.bindFn(this.addTicker),handleEvent:ct.const("true"),manageFocus:this.const(rt({controller:this.controller,location:{type:"add-ticker-btn"}}))},ct.createElement("i",{class:ct.const("dcg-icon-metronome dcg-expression-icon"),"aria-hidden":ct.const("true")}),()=>this.controller.s("graphing-calculator-label-ticker-lowercase")))),ct.createElement("span",{class:ct.const("dcg-arrow")}))))}showAddTicker(){return this.controller.areActionsEnabled()&&!this.controller.getTickerOpen()}didMountPopover(e){this.popoverNode=e,ee(document).on("dcg-tapstart.add-expression-view wheel.add-expression-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-add-expression",focusIconAfterClose:t.device==="keyboard"})}),ee(document).on("keydown.add-expression-view",t=>{if(ke(t)==="Esc"&&this.controller.dispatch({type:"close-add-expression",focusIconAfterClose:!0}),ke(t)==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let r=this.controller.getFocusLocation();if(!r)return;let n;this.showAddTicker()?n={type:"add-ticker-btn"}:this.controller.areImagesEnabled()?n={type:"add-image-btn"}:this.controller.areFoldersEnabled()?n={type:"add-folder-btn"}:n={type:"add-table-btn"},!t.shiftKey&&r.type===n.type?(this.controller.dispatch({type:"set-focus-location",location:{type:"add-item-btn"}}),t.preventDefault(),t.stopPropagation()):t.shiftKey&&r.type==="add-item-btn"&&(this.controller.dispatch({type:"set-focus-location",location:n}),t.preventDefault(),t.stopPropagation())}}),tl&&mp&&ee(e).on("dcg-tapstart",t=>t.preventDefault()),ee(e.querySelector(".dcg-new-item")).on("touchstart",t=>t.preventDefault())}didUnmountPopover(){ee(document).off(".add-expression-view")}toggleAddExpression(e){this.controller.dispatch({type:"toggle-add-expression",focusOnOpen:e.device==="keyboard"})}newExpression(){this.controller.dispatch({type:"new-expression"})}newText(){this.controller.dispatch({type:"new-text"})}newFolder(){this.controller.dispatch({type:"new-folder"})}addTicker(){this.controller.dispatch({type:"open-ticker"})}newTable(){this.controller.dispatch({type:"new-table"})}insertFiles(e){this.controller.dispatch({type:"new-images",files:e})}eventShouldClosePopover(e){let t=!!this.popoverNode.contains(e.target),r=!!this.toggleButtonNode.contains(e.target);return!(t||r)}},Kd=__dcg_shared_module_exports__.e(ne()),OI=class extends Kd.Class{init(){this.controller=this.props.controller()}template(){return Kd.createElement("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-constructions-count-link":!0,"dcg-icon-btn":!0,"dcg-active":this.controller.getShowConstructionsOpen(),"dcg-do-not-blur":!0}),handleEvent:Kd.const("true"),"aria-expanded":()=>this.controller.getShowConstructionsOpen(),manageFocus:this.const(rt({controller:this.controller,location:{type:"geo-show-constructions-icon"}})),onTap:this.bindFn(this.showAllConstructions)},Kd.createElement("i",{class:Kd.const("dcg-icon-geometry"),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-construction-icon-label")}),Kd.createElement("span",{class:Kd.const("dcg-construction-count")},()=>this.controller.getGeometryTokenCount()))}showAllConstructions(){this.controller.dispatch({type:"set-show-constructions-open",open:!this.controller.getShowConstructionsOpen(),setFocus:!1})}},Wd=__dcg_shared_module_exports__.e(ne());qt();var RI=class extends Wd.Class{init(){this.controller=this.props.controller()}toggleMuted(){var e;(e=this.controller.toneController)!=null&&e.isGlobalMuted()?this.controller.dispatch({type:"unmute-global"}):this.controller.dispatch({type:"mute-global"})}getMutedState(){return!this.controller.toneController||this.controller.toneController.isGlobalMuted()?"muted":"playing"}getAriaLabel(){switch(this.getMutedState()){case"playing":return this.controller.s("graphing-calculator-narration-mute-all");case"muted":return this.controller.s("graphing-calculator-narration-unmute-all")}}template(){return Wd.createElement(Le,{gravity:this.const("s"),tooltip:this.bindFn(this.getAriaLabel)},Wd.createElement("button",{class:()=>{var e;return{"dcg-global-mute-button":!0,"dcg-unstyled-button":!0,"dcg-icon-btn":!0,"dcg-is-muted":this.getMutedState()==="muted","dcg-has-never-interacted":!((e=this.controller.toneController)!=null&&e.getHasEverInteractedWithMute())}},didMount:e=>ee(e).on("tipsyshow",()=>{var t;(t=this.controller.toneController)==null||t.registerMuteInteraction(),this.update()}),onTap:()=>this.toggleMuted(),manageFocus:this.const(rt({controller:this.controller,location:{type:"global-mute-button"}})),"aria-label":this.bindFn(this.getAriaLabel)},Wd.createElement("span",{class:Wd.const("dcg-first-time-animation")}),Wd.createElement("i",{class:Wd.const("dcg-icon-volume")})))}},{If:$d}=_t.Components,S0=class extends _t.Class{init(){this.controller=this.props.controller()}template(){return _t.createElement("div",{class:()=>({"dcg-expression-top-bar":!0,"dcg-expressions-scrolled":this.showShadow()}),role:_t.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-narration-expression-bar"),didMount:e=>{this.node=e},onTapStart:this.bindFn(this.clearSelectionOnMobile)},_t.createElement($d,{predicate:this.bindFn(this.showHamburger)},()=>_t.createElement("button",{class:_t.const("dcg-unstyled-button dcg-action-opendrawer dcg-tooltip dcg-icon-btn dcg-in-api-action-opendrawer"),handleEvent:_t.const("true"),tooltip:this.bindFn(this.getHamburgerLabel),"aria-label":this.bindFn(this.getHamburgerLabel),onTap:()=>this.controller.dispatch({type:"open-drawer"})},_t.createElement("i",{class:_t.const("dcg-icon-hamburger"),"aria-hidden":_t.const("true")}))),_t.createElement($d,{predicate:()=>!this.controller.isInEditListMode()},()=>_t.createElement(C0,{controller:()=>this.props.controller()})),_t.createElement($d,{predicate:()=>this.controller.isGeoUIActive()&&!this.controller.isInEditListMode()},()=>_t.createElement(OI,{controller:this.props.controller})),_t.createElement($d,{predicate:this.bindFn(this.showMuteButton)},()=>_t.createElement(RI,{controller:this.props.controller})),_t.createElement($d,{predicate:this.bindFn(this.showRerandomize)},()=>_t.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-randomize-tooltip"),gravity:this.const("s")},_t.createElement("button",{class:_t.const("dcg-unstyled-button dcg-icon-btn"),handleEvent:_t.const("true"),"aria-label":()=>this.controller.s("graphing-calculator-label-randomize-tooltip"),onTap:()=>this.controller.dispatch({type:"re-randomize"})},_t.createElement("i",{class:_t.const("dcg-icon-randomize"),"aria-hidden":_t.const("true")})))),_t.createElement($d,{predicate:()=>this.controller.isInEditListMode()&&!this.controller.hasDefaultState()},()=>_t.createElement("button",{class:_t.const("dcg-btn-red dcg-action-clearall"),onTap:()=>this.controller.dispatch({type:"clear-graph"})},()=>this.controller.s("graphing-calculator-button-clear-graph"))),_t.createElement($d,{predicate:()=>this.controller.isInEditListMode()&&this.controller.hasDefaultState()},()=>_t.createElement("button",{class:_t.const("dcg-btn-red dcg-action-reset"),onTap:()=>this.controller.dispatch({type:"reset-graph"})},()=>this.controller.s("graphing-calculator-button-reset-graph"))),_t.createElement("div",{class:_t.const("dcg-center-buttons")},_t.createElement(Yy,ie(R({},this.props),{isPillbox:this.const(!1)}))),_t.createElement($d,{predicate:()=>!this.controller.isInEditListMode()},()=>_t.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-edit-list-tooltip"),gravity:this.const("s")},_t.createElement("button",{class:_t.const("dcg-unstyled-button dcg-icon-btn dcg-action-toggle-edit"),handleEvent:_t.const("true"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-expression-list"),onTap:this.bindFn(this.toggleEditListMode),manageFocus:this.const(rt({controller:this.controller,location:{type:"edit-list-toggle"}}))},_t.createElement("i",{class:_t.const("dcg-icon-settings"),"aria-hidden":_t.const("true")})))),_t.createElement($d,{predicate:()=>this.controller.isInEditListMode()},()=>_t.createElement("button",{class:_t.const("dcg-btn-blue dcg-action-toggle-edit dcg-do-not-blur"),handleEvent:_t.const("true"),onTap:this.bindFn(this.toggleEditListMode),manageFocus:this.const(rt({controller:this.controller,location:{type:"edit-list-toggle"}}))},()=>this.controller.s("graphing-calculator-button-done"))),_t.createElement($d,{predicate:()=>!this.controller.isInEditListMode()&&this.controller.getGraphSettings().config.graphpaper},()=>_t.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-hide-expression-list-tooltip"),gravity:this.const("s")},_t.const(" "),_t.createElement("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-resize-list-btn":!0,"dcg-action-hideexpressions":!0,"dcg-icon-btn":!0,"dcg-rotated":this.controller.isNarrow()}),"aria-label":()=>this.controller.s("graphing-calculator-label-hide-expression-list-tooltip"),onTap:e=>{this.controller.dispatch({type:"hide-expressions-list",focusShowIcon:e.device==="keyboard"})},manageFocus:this.const(rt({controller:this.controller,location:{type:"hide-expression-list-btn"}}))},_t.createElement("i",{class:_t.const("dcg-icon-hide"),"aria-hidden":_t.const("true")})))))}showShadow(){return this.controller.getTickerOpen()||this.controller.getExpressionSearchOpen()?!1:this.props.expsScrolled()}showRerandomize(){return this.controller.isInEditListMode()?!1:this.controller.anyItemDependsOnRandomSeed()}showHamburger(){return!this.controller.getGraphSettings().config.showHamburger||this.controller.isInEditListMode()?!1:!this.controller.isNarrow()}getHamburgerLabel(){return this.controller.getshowKeyboardShortcutsInTooltips()?this.controller.s("graphing-calculator-label-open-graph-with-shortcut-tooltip"):this.controller.s("graphing-calculator-label-open-graph-tooltip")}clearSelectionOnMobile(e){e.wasHandled()||this.controller.dispatch({type:"set-none-selected"})}toggleEditListMode(e){this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!this.controller.isInEditListMode(),focusExpressionList:!1}),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"edit-list-toggle"}})}showMuteButton(){return this.controller.isInEditListMode()?!1:this.controller.toneItemsExist()}},mr=__dcg_shared_module_exports__.e(ne()),Oc=__dcg_shared_module_exports__.e(ne());qt();var{Textarea:dce}=Oc.Components,au=class extends Oc.Class{template(){return Oc.createElement("div",{class:Oc.const("dcg-smart-textarea-container")},Oc.createElement("div",{class:Oc.const("dcg-displayTextarea dcg-fixed-width-element"),didMount:this.bindFn(this.didMountDisplay)}),Oc.createElement(dce,{class:()=>({"dcg-do-blur":!0,"dcg-fixed-width-element":!0,"dcg-smart-textarea":!0,"dcg-empty":!this.props.text()}),"aria-label":()=>{var e,t;return(t=(e=this.props).ariaLabel)==null?void 0:t.call(e)},placeholder:this.bindFn(this.getPlaceholder),readOnly:()=>this.props.readonly()?!0:void 0,value:this.props.text,onInput:this.props.onInput,didMount:this.bindFn(this.didMountTextarea),onKeyDown:this.bindFn(this.onKeydownEvent)}))}getDisplayTextHTML(){let e=this.props.text()||"",t=(i,o)=>e.slice(i,o).replace(/</g,"&lt;").replace(/>/g,"&gt;"),r=0,n="";if(this.props.showLinks()){let i=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,o=null;for(;(o=i.exec(e))!==null;){let[a]=o;n+=t(r,o.index),n+=`<a rel='nofollow ugc' href='${a}' target ='_blank'>${a}</a>`,r=i.lastIndex}}return n+=t(r),n}willUnmount(){this.textareaNode=void 0}didMountDisplay(e){this.displayNode=e,ee(e).on("touchend",t=>{t.preventDefault()}),ee(e).on("dcg-tap dcg-tapstart",t=>{t.target.closest("a")&&t.handle()}),this.renderDisplayText()}didMountTextarea(e){this.textareaNode=e,ee(e).on("dcg-tapstart",t=>{t.handle()}),ee(e).on("focusin focusout",()=>this.onFocusEvent()),this.updateFocused()}didUpdate(){this.updateFocused(),this.renderDisplayText()}onFocusEvent(){if(!this.textareaNode)return;let e=document.activeElement===this.textareaNode;this.shouldBeFocused()!==e&&this.props.onFocusChange(e)}renderDisplayText(){if(!this.displayNode)return;let e=this.getDisplayTextHTML();this.lastDisplayTextHTML!==e&&(this.lastDisplayTextHTML=e,this.displayNode.innerHTML=e)}isFocused(){return document.activeElement===this.textareaNode}shouldBeFocused(){return this.props.shouldFocus()}updateFocused(){if(!this.textareaNode)return;let e=this.isFocused(),t=this.shouldBeFocused();if(e!==t)if(!t)this.textareaNode.blur();else{if(tl&&mp)return;this.textareaNode.focus(),this.textareaNode.selectionStart=this.textareaNode.selectionEnd=this.textareaNode.value.length}}onKeydownEvent(e){let t=this.textareaNode;if(!t)return;let r=ke(e),n=this.props.readonly(),i=this.props.readonlyAction&&this.props.readonlyAction();if(n&&i!==void 0&&i.predicate()){!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(r==="Enter"||r==="Space")&&(e.preventDefault(),i.action());return}r==="Enter"&&!e.shiftKey?(e.preventDefault(),this.props.onSpecialKey("Enter")):r==="Esc"?Jr():r==="Up"?(n||t.selectionStart===0&&t.selectionEnd===0)&&!(e.altKey||e.metaKey)&&(e.preventDefault(),this.props.onSpecialKey("Up")):r==="Down"?(n||t.selectionStart===t.value.length&&t.selectionEnd===t.value.length)&&!(e.altKey||e.metaKey)&&(e.preventDefault(),this.props.onSpecialKey("Down")):r==="Backspace"&&!(n&&i!==void 0&&i.predicate())?t.value.length===0&&(e.preventDefault(),this.props.onSpecialKey("Backspace")):r==="Del"&&!(n&&i!==void 0&&i.predicate())&&t.value.length===0&&(e.preventDefault(),this.props.onSpecialKey("Delete")),this.props.onKeydown&&this.props.onKeydown(e)}getPlaceholder(){var e,t;if(!this.props.text())return(t=(e=this.props).placeholder)==null?void 0:t.call(e)}},{If:pce}=mr.Components,E0=class extends is{didMountRoot(e){this.onItemViewMounted(e)}willUnmount(){this.onItemViewUnmounted()}template(){return mr.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-expressionfolder":!0,"dcg-inFolder":!1,"dcg-selected":this.renderAsSelected(),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-collapsed":!!this.model.collapsed,"dcg-hidden":!!this.model.hidden,"dcg-has-items":this.controller.getNumberOfItemsInFolder(this.id)>0,"dcg-secretFolder":this.model.secret&&!this.controller.shouldShowAuthorFeatures()}),"expr-id":()=>this.model.id,onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect),didMount:this.bindFn(this.didMountRoot)},mr.createElement("div",{class:mr.const("dcg-fade-container")},mr.createElement("div",{class:mr.const("dcg-main")},mr.createElement("div",{role:mr.const("button"),tabIndex:mr.const("0"),"aria-pressed":()=>this.model.collapsed,"aria-label":()=>this.model.collapsed?Xr(this.model,"expand"):Xr(this.model,"collapse"),class:mr.const("dcg-caret-container dcg-action-toggle-folder-collapsed dcg-do-not-blur"),handleEvent:mr.const("true"),onTap:this.bindFn(this.toggleCollapsed)},mr.createElement("i",{class:mr.const("dcg-icon-caret-down"),"aria-hidden":mr.const("true")})),mr.createElement(au,{shouldFocus:this.bindFn(this.isFocused),text:()=>this.model.title,showLinks:()=>this.controller.areLinksEnabled(),onInput:this.bindFn(this.onInput),onFocusChange:this.bindFn(this.onFocusChange),onSpecialKey:this.bindFn(this.onSpecialKey),ariaLabel:this.bindFn(this.getAriaLabel),readonly:()=>this.controller.isInEditListMode()||this.controller.isItemReadonly(this.id),readonlyAction:this.const({predicate:()=>this.controller.isInEditListMode(),action:()=>this.exitEditListMode()}),placeholder:()=>this.controller.s("graphing-calculator-text-folder-placeholder")}),mr.createElement(mt,{checked:()=>this.model.secret,class:()=>{let e="dcg-action-toggle-secret-folder dcg-do-not-blur";return this.controller.canUseAdvancedStyling()?e:e+" dcg-last-folder-checkbox"},style:()=>({display:this.controller.shouldShowAuthorFeatures()?void 0:"none"}),onChange:this.bindFn(this.toggleSecret)},mr.createElement("span",{class:mr.const("dcg-checkbox-label")},()=>this.controller.s("graphing-calculator-button-hide-folder-from-students-2"))),mr.createElement(pce,{predicate:()=>this.controller.canUseAdvancedStyling()},()=>mr.createElement(mt,{checked:()=>this.model.inFrontOfEverything,class:this.const("dcg-action-toggle-in-front-of-everything dcg-do-not-blur dcg-last-folder-checkbox"),onChange:this.bindFn(this.toggleinFrontOfEverything)},mr.createElement("span",{class:mr.const("dcg-checkbox-label")},()=>this.controller.s("graphing-calculator-button-in-front-of-everything"))))),mr.createElement(Wl,{controller:this.props.controller,model:this.props.model})),mr.createElement("span",{class:mr.const("dcg-tab dcg-action-drag"),handleEvent:mr.const("true"),tapboundary:mr.const("true"),disablescroll:mr.const("true"),onTapStart:this.bindFn(this.onDragPending)},mr.createElement("span",{class:mr.const("dcg-num")},()=>this.model.displayIndex),mr.createElement("div",{class:mr.const("dcg-tab-interior")},mr.createElement("span",{role:mr.const("button"),tabIndex:mr.const("0"),"aria-pressed":()=>!!this.model.hidden,"aria-label":()=>this.model.hidden?Xr(this.model,"show"):Xr(this.model,"hide"),class:mr.const("dcg-circular-icon-container dcg-expression-icon-container"),onTap:this.bindFn(this.toggleHidden)},mr.createElement($o,{iconType:()=>this.model.hidden?"hidden":"folder",whiteIcon:()=>this.renderAsSelected()||this.controller.isItemBeingDragged(this.model.id)})))),mr.createElement(Hl,{controller:this.props.controller,id:()=>this.model.id}))}renderAsSelected(){return this.controller.isItemSelected(this.model.id)||this.model.collapsedChildIsSelected}toggleHidden(){this.controller.dispatch({type:"toggle-item-hidden",id:this.id})}toggleSecret(){this.controller.dispatch({type:"set-item-secret",id:this.id,isSecret:!this.model.secret})}toggleinFrontOfEverything(){this.controller.dispatch({type:"set-item-in-front-of-everything",id:this.id,inFrontOfEverything:!this.model.inFrontOfEverything})}toggleCollapsed(){this.controller.dispatch({type:"set-folder-collapsed",id:this.id,isCollapsed:!this.model.collapsed})}onInput(e){this.controller.dispatch({type:"set-folder-title",id:this.id,title:e})}onFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"folder",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"folder",id:this.id}})}onSpecialKey(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})}isFocused(){let e=this.controller.getFocusLocation();return!(!e||e.type!=="folder"||e.id!==this.id)}getAriaLabel(){let e="",t="";switch((this.model.hidden?1:0)+(this.model.collapsed?16:0)+(this.model.secret?256:0)+(this.model.readonly?4096:0)){case 0:t=this.controller.s("graphing-calculator-narration-description-folder");break;case 1:t=this.controller.s("graphing-calculator-narration-description-hidden-folder");break;case 16:t=this.controller.s("graphing-calculator-narration-description-collapsed-folder");break;case 256:t=this.controller.s("graphing-calculator-narration-description-secret-folder");break;case 4096:t=this.controller.s("graphing-calculator-narration-description-readonly-folder");break;case 17:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-folder");break;case 257:t=this.controller.s("graphing-calculator-narration-description-hidden-secret-folder");break;case 4097:t=this.controller.s("graphing-calculator-narration-description-hidden-readonly-folder");break;case 272:t=this.controller.s("graphing-calculator-narration-description-collapsed-secret-folder");break;case 4352:t=this.controller.s("graphing-calculator-narration-description-secret-readonly-folder");break;case 4112:t=this.controller.s("graphing-calculator-narration-description-collapsed-readonly-folder");break;case 273:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-secret-folder");break;case 4113:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-readonly-folder");break;case 4353:t=this.controller.s("graphing-calculator-narration-description-hidden-secret-readonly-folder");break;case 4368:t=this.controller.s("graphing-calculator-narration-description-collapsed-secret-readonly-folder");break;case 4369:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-secret-readonly-folder");break}let r=this.controller.getNumberOfItemsInFolder(this.id);return r>0?e=this.controller.s("graphing-calculator-narration-folder-has-items",{folder:t,count:r}):e=t,e}},mn=__dcg_shared_module_exports__.e(ne()),{For:t$,If:uce}=mn.Components,FI=class extends mn.Class{init(){this.controller=this.props.controller(),this.currentlyInspectedDepth=1/0,this.cachedTokenDepths={depths:{},isInvalid:!1},this.updateCachedTokenDepthInfo()}willUpdate(){this.updateCachedTokenDepthInfo()}updateCachedTokenDepthInfo(){let e="",t=!1,r=this.controller.getFocusLocation();if(r&&r.type==="expression"){let n=this.controller.getFocusedItem();(n==null?void 0:n.type)==="expression"&&(e=n.id,t=!!n.error&&n.latex!==""||!!n.formula.variables.length)}if(this.cachedTokenDepths.focusedExpressionBeforeError==e&&t){this.cachedTokenDepths.isInvalid=!0;return}this.cachedTokenDepths={depths:this.controller.cachedGeoTokenDepths,isInvalid:!1,focusedExpressionBeforeError:t?void 0:e}}template(){return mn.createElement("div",{class:()=>({"dcg-geo-show-constructions-pane":!0,"dcg-transient-error":this.cachedTokenDepths.isInvalid,"dcg-cant-drag-item":!!this.controller.getDraggedItemId()&&!this.controller.canDraggedItemBeMovedIntoTokenPane()}),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-token-navigator-label"),role:mn.const("region"),didUnmount:()=>this.lastFocusedIdentifier=void 0,onKeyDown:this.bindFn(this.handleKeydown)},mn.createElement(uce,{predicate:()=>this.controller.getGeometryTokenCount()===0},()=>mn.createElement("div",{class:mn.const("dcg-empty-constructions")},()=>this.controller.s("graphing-calculator-text-geometry-no-constructed-objects"))),mn.createElement("div",{class:mn.const("dcg-displayed-sections-container")},mn.createElement(t$,{each:this.bindFn(this.getObjectDepths)},e=>mn.createElement("div",{class:()=>({"dcg-displayed-section-level":!0,"dcg-selected-level":parseInt(e)===this.getCurrentlyInspectedDepth(),"dcg-below-the-line":parseInt(e)>this.getCurrentlyInspectedDepth()})},mn.createElement("span",{role:mn.const("listbox"),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-token-navigator-depth",{depth:e})},mn.createElement(t$,{each:()=>this.getTokensForDepth(e),key:(t,r)=>r},(t,r)=>mn.createElement("span",{class:()=>({"dcg-token-being-dragged-container":this.isTokenBeingDragged(e,r)}),onTapStart:n=>{let i=this.getCalcIdForDepth(e,r),o=this.controller.getItemModel(i);!o||o.type!=="expression"||this.controller.isItemInGeoFolder(o.id)&&this.props.onDragPending(n,{type:"token",calcId:i,originalIndex:o.index})}},mn.createElement(Ad,{showParentChildrenHover:this.const(!0),controller:this.props.controller,identifier:()=>this.getIdentifierForDepth(e,r),insideMQ:this.const(!1),insideGroup:this.const(!0),focusLocation:()=>({type:"geo-token",identifier:this.getIdentifierForDepth(e,r)}),putInTabOrder:()=>{if(this.lastFocusedIdentifier===void 0){let n=this.getObjectDepths();this.lastFocusedIdentifier=this.getIdentifierForDepth(n[0],0)}return this.lastFocusedIdentifier===this.getIdentifierForDepth(e,r)}}))))))))}isTokenBeingDragged(e,t){let r=this.controller.getDraggedItemId();if(!r)return!1;if(this.controller.isItemInGeoFolder(r))return r==this.getCalcIdForDepth(e,t)}getCurrentlyInspectedDepth(){return Math.min(this.currentlyInspectedDepth,this.getObjectDepths().length-1)}getIdentifierForDepth(e,t){let r=this.getTokensForDepth(e)[t];return r?r.identifier:""}getCalcIdForDepth(e,t){let r=this.getTokensForDepth(e)[t];return r?r.calcId:""}getTokensForDepth(e){let{depths:t}=this.cachedTokenDepths;return t[e]||[]}getObjectDepths(){let e=Object.keys(this.cachedTokenDepths.depths);return e.sort((t,r)=>{let n=parseInt(t),i=parseInt(r);return isFinite(n)?isFinite(i)?n-i:1:-1}),e}selectItemIfNecessary(){if(this.controller.hasAnyItemsSelected())return;let e=this.controller.getFocusLocation();if((e==null?void 0:e.type)!=="geo-token")return;let{calcId:t}=this.controller.cachedGeoTokenInfo[e.identifier];!t||!this.controller.getItemModel(t)||this.controller.dispatch({type:"set-selected-id",id:t,state:"selected"})}handleKeydown(e){let t=this.controller.getFocusLocation(),r=ke(e),n=Ko(e);if(e.ctrlKey&&e.shiftKey&&!e.altKey&&!e.metaKey&&n==="O"){e.preventDefault(),e.stopPropagation(),this.selectItemIfNecessary(),this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-more",guid:rm(),focusFirstOption:!0,previousFocusLocation:t}});return}if(e.altKey&&!e.ctrlKey&&!e.metaKey&&e.shiftKey&&n==="T"){if(e.preventDefault(),e.stopPropagation(),(t==null?void 0:t.type)!=="geo-token")return;let{calcId:u}=this.controller.cachedGeoTokenInfo[t.identifier];if(!u)return;let p=this.controller.getItemModel(u);if(!il(p))return;this.controller.convertToNamedAssignment(p),_n(p,""),this.controller.dispatch({type:"set-none-selected"}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:p.id}});return}if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;if(r==="Esc"){e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-show-constructions-open",open:!1,setFocus:!0});return}if(r!=="Up"&&r!=="Down"&&r!=="Left"&&r!=="Right")return;e.preventDefault(),e.stopPropagation();let i=this.getObjectDepths();if(i.length===0)return;let o="";if(t&&t.type==="geo-token")o=t.identifier;else{let u=this.getTokensForDepth(i[0])[0];if(!u)return;o=u.identifier}if(o==="")return;let a,s=-1,l=[];for(a=0;a<i.length;a++){let u=i[a];if(l=this.getTokensForDepth(u),!!l&&(s=__dcg_shared_module_exports__.w(l,{identifier:o}),s!==-1))break}if(a===-1||s===-1)return;r==="Up"?a=Math.max(a-1,0):r==="Down"?a=Math.min(a+1,i.length-1):r==="Left"?s=Math.max(s-1,0):r==="Right"&&(s=Math.min(s+1,l.length-1));let c=this.getTokensForDepth(i[a]);if(!c)return;s=Math.min(s,c.length-1);let d=c[s].identifier;this.controller.dispatch({type:"set-focus-location",location:{type:"geo-token",identifier:d}}),this.lastFocusedIdentifier=d}},Kt=__dcg_shared_module_exports__.e(ne()),{For:hce,If:T0,Textarea:gce}=Kt.Components,NI=class extends Kt.Class{template(){return Kt.createElement("div",{class:Kt.const("dcg-image-aria-container")},Kt.createElement(gce,{placeholder:()=>this.props.controller().s("graphing-calculator-text-add-screen-reader-label-placeholder"),value:()=>this.props.model().description,onInput:e=>this.props.controller().dispatch({type:"set-item-description",id:this.props.model().id,description:e})}))}},BI=class extends Kt.Class{init(){var e;this.controller=this.props.controller(),this.model=this.props.model(),this.guid=(e=this.controller.getOpenItemMenu())==null?void 0:e.guid}didMountArrow(e){this.arrowElt=e,Vs(this.arrowElt,this.controller)}didMount(){Fp(this.guid,this.controller)}willUnmount(){Np(this.guid,this.controller)}didUpdate(){Vs(this.arrowElt,this.controller)}template(){let e=this.model;return Kt.createElement("div",{class:Kt.const("dcg-image-options-menu dcg-options-menu")},Kt.createElement("div",{class:Kt.const("dcg-opacities-menu dcg-options-menu-section")},Kt.createElement("div",{role:Kt.const("heading"),"aria-level":Kt.const("2"),class:Kt.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-image-opacity")),Kt.createElement("div",{class:Kt.const("dcg-opacities-menu-flex"),role:Kt.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-image-opacity")},Kt.createElement(hce,{each:()=>this.controller.getImageOpacities()},t=>Kt.createElement("span",{class:Kt.const("dcg-opacity-option"),role:Kt.const("button"),tabIndex:Kt.const(0),"aria-label":()=>`opacity: ${t}`,"aria-pressed":()=>this.isOpacitySelected(t),handleEvent:Kt.const("true"),onTap:()=>this.onSelectOpacity(t)},Kt.createElement($o,{backgroundImage:this.bindFn(this.getBackgroundImage),iconType:()=>this.isOpacitySelected(t)?"check":"none",backgroundOpacity:()=>parseFloat(t)}))))),Kt.createElement("div",{class:Kt.const("dcg-styles-div dcg-options-menu-section dcg-section-without-title")},Kt.createElement(T0,{predicate:()=>this.shouldShowBackgroundCheckbox()},()=>Kt.createElement("div",{class:Kt.const("dcg-styles-menu"),role:Kt.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-image-styles")},Kt.createElement(mt,{checked:()=>!e.foreground,onChange:this.bindFn(this.onToggleForeground)},()=>this.controller.s("graphing-calculator-button-place-image-behind-graphs")))),Kt.createElement(T0,{predicate:()=>this.shouldShowDraggableCheckbox()},()=>Kt.createElement("div",{class:Kt.const("dcg-draggable-checkbox-container")},Kt.createElement(mt,{checked:()=>fc(e),onChange:this.bindFn(this.onToggleDraggable)},()=>this.controller.s("graphing-calculator-button-draggable"))))),Kt.createElement(T0,{predicate:()=>fc(e)},()=>Kt.createElement(NI,R({},this.props))),Kt.createElement(T0,{predicate:this.bindFn(this.shouldShowClickable)},()=>Kt.createElement(Zb,{controller:this.props.controller,model:()=>e,isOpen:()=>!!e.clickableInfo.enabled})),Kt.createElement(T0,{predicate:()=>!!e.clickableInfo.enabled&&!fc(e)},()=>Kt.createElement(NI,R({},this.props))),Kt.createElement(nh,{model:()=>e,controller:()=>this.props.controller()}),Kt.createElement("div",{class:Kt.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow),didUnmount:()=>this.arrowElt=void 0}))}onToggleDraggable(){jf(this.model)?this.controller.dispatch({type:"set-image-draggable",id:this.model.id,draggable:!this.model.draggable}):this.makeDraggable()}onToggleForeground(e){this.controller.dispatch({type:"set-image-in-foreground",id:this.model.id,foreground:!e})}onSelectOpacity(e){this.controller.dispatch({type:"set-image-opacity",id:this.model.id,opacity:e})}isOpacitySelected(e){return this.model.opacity===e}getBackgroundImage(){return this.model.image_url===this.lastURL?this.lastEncodedURL:(this.lastURL=this.model.image_url,this.lastEncodedURL='url("'+dD(this.model.image_url)+'")',this.lastEncodedURL)}shouldShowClickable(){return this.controller.shouldIgnoreGraphInteractions(this.model)?!1:this.controller.areActionsEnabled()}makeDraggable(){this.controller.dispatch({type:"convert-image-to-draggable",id:this.model.id})}shouldShowDraggableCheckbox(){if(this.controller.isThreeDMode()||this.controller.shouldIgnoreGraphInteractions(this.model))return!1;let e=jf(this.model);return e?xT(e):r4(this.model)}shouldShowBackgroundCheckbox(){let e=this.controller.getItemModel(this.model.folderId);return!(e&&e.type==="folder"&&e.inFrontOfEverything)}},Qe=__dcg_shared_module_exports__.e(ne()),{If:D0,SwitchUnion:mce}=Qe.Components,Em=class extends Qe.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return Qe.createElement(lr,{containerClass:()=>({"dcg-image-input-mathquill":!0,"dcg-suffix-degree":this.props.name()==="angle"&&this.props.controller().getGraphSettings().degreeMode,"dcg-suffix-radian":this.props.name()==="angle"&&!this.props.controller().getGraphSettings().degreeMode}),fontSize:this.const("large"),fullWidth:this.const(!0),readonly:this.props.readonly,latex:()=>this.model[this.props.name()],isFocused:()=>this.props.focusedInput()===this.props.name(),ariaLabel:()=>this.controller.raw(this.props.name()),handleFocusChanged:this.bindFn(this.handleMQFocusedChanged),hasError:()=>s4(this.model,this.props.name()),controller:this.props.controller,handlePressedKey:this.bindFn(this.handlePressedKey),handleLatexChanged:this.bindFn(this.handleLatexChanged),noBorder:()=>!this.props.focusedInput()})}getInputs(){return["center","width","angle","height","opacity"]}handlePressedKey(e,t){let r=this.props.name(),n=Fe.getFocusedMathquill(),i=this.getInputs(),o=i.indexOf(r);if(!this.controller.isInEditListMode()){if(e==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});if(e==="Esc"){Jr();return}}let a=-1;e==="Up"&&(a=o===1?4:o-2),e==="Down"&&(a=o===4?1:o+2),e==="Left"&&(a=o-1),e==="Right"&&(a=o+1);let s=e;if(a>=0&&a<i.length){let l=!1;if(n)l=Fe.applyArrowKeyAndReturnIfWasAtBounds(n,s,t);else if(e==="Up"||e==="Down")l=!0;else{let c=os();l=c&&(e==="Left"&&c.selectionStart===0||e==="Right"&&c.selectionStart===c.value.length)}l&&(this.focusInput(i[a]),t&&t.preventDefault());return}n&&(n.keystroke(e,t),this.handleLatexChanged(n.latex()))}focusInput(e){this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.model.id,location:e}})}handleLatexChanged(e){let t=this.props.name();this.model.draggingOnGraphpaper||Zz(this.model,t)!==e&&this.controller.dispatch({type:"set-image-mq-attribute",id:this.model.id,attribute:t,latex:e})}handleMQFocusedChanged(e){let t=this.props.name();e?this.props.focusedInput()!==t&&this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.model.id,location:t}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"image",id:this.model.id,location:t}})}},k0=class extends is{didMountRoot(e){this.onItemViewMounted(e)}willUnmount(){this.onItemViewUnmounted()}template(){return Qe.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-readonly":this.controller.isItemMarkedReadonly(this.id),"dcg-expressionimage":!0,"dcg-inFolder":!!this.model.folderId,"dcg-selected":this.controller.isItemSelected(this.id),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-input-focused":this.getFocusedInput()&&this.getFocusedInput()!=="name"}),"expr-id":()=>this.model.id,onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect),didMount:this.bindFn(this.didMountRoot)},Qe.createElement("div",{class:Qe.const("dcg-fade-container")},Qe.createElement("div",{class:Qe.const("dcg-main")},mce(()=>this.model.loadStatus,{failed:()=>Qe.createElement("div",null,Qe.createElement("div",{class:Qe.const("dcg-image-failed")},()=>this.controller.s("graphing-calculator-error-failed-to-load-image")),Qe.createElement("div",{role:Qe.const("button"),tabIndex:Qe.const(0),class:Qe.const("dcg-retry-loading-image"),onTap:this.bindFn(this.onRetryLoad)},()=>this.controller.s("graphing-calculator-button-load-image-retry"))),loading:()=>Qe.createElement("div",null,Qe.createElement("div",{class:Qe.const("dcg-image-loading")},()=>this.controller.s("graphing-calculator-text-loading-image")),Qe.createElement("div",{role:Qe.const("button"),tabIndex:Qe.const(0),class:Qe.const("dcg-retry-loading-image"),onTap:this.bindFn(this.onRetryLoad)},()=>this.controller.s("graphing-calculator-button-load-image-retry"))),loaded:()=>Qe.createElement("div",{class:Qe.const("dcg-image-loaded")},Qe.createElement("div",{class:Qe.const("dcg-image-title-row")},Qe.createElement(au,{shouldFocus:()=>this.getFocusedInput()==="name",text:()=>this.model.name,ariaLabel:()=>Xr(this.model,"edit_title"),placeholder:()=>this.controller.s("graphing-calculator-text-image-placeholder"),showLinks:()=>this.controller.areLinksEnabled(),onInput:this.bindFn(this.onNameInput),onFocusChange:this.bindFn(this.onNameFocusChange),onSpecialKey:this.bindFn(this.onNameSpecialKey),readonly:()=>this.controller.isInEditListMode()||this.isReadonly()}),Qe.createElement(D0,{predicate:()=>this.controller.areImagesEnabled()},()=>Qe.createElement(Op,{controller:()=>this.controller,ariaLabel:()=>this.controller.s("graphing-calculator-button-change-image"),onFileChange:e=>this.insertFiles(e),location:this.const({type:"change-image-btn",id:this.id}),readonly:this.bindFn(this.isReadonly)},Qe.createElement(D0,{predicate:()=>!this.isReadonly()},()=>Qe.createElement("div",{class:Qe.const("dcg-action-changeimage")},()=>this.controller.s("graphing-calculator-button-change-image")))))),Qe.createElement("div",{class:()=>({"dcg-do-blur":!0,"dcg-image-input-grid":!0}),handleEvent:Qe.const("true")},Qe.createElement("div",{class:Qe.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-center")),Qe.createElement(Em,{name:this.const("center"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),Qe.createElement("div",{class:Qe.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-width")),Qe.createElement(Em,{name:this.const("width"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),Qe.createElement("div",{class:Qe.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-angle")),Qe.createElement(Em,{name:this.const("angle"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),Qe.createElement("div",{class:Qe.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-height")),Qe.createElement(Em,{name:this.const("height"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),Qe.createElement("div",{class:Qe.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-opacity")),Qe.createElement(Em,{name:this.const("opacity"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)})))})),Qe.createElement("span",{class:Qe.const("dcg-fadeout")}),Qe.createElement(Wl,{controller:this.props.controller,model:this.props.model}),Qe.createElement(D0,{predicate:this.bindFn(this.shouldShowBrailleError)},()=>Qe.createElement("div",{class:this.getFooterClass()},Qe.createElement("div",{tabIndex:Qe.const(0),class:Qe.const("dcg-expression-braille-error"),"aria-roledescription":Qe.const("error"),"aria-label":()=>this.controller.unpack(this.model.error)},Qe.createElement("i",{class:Qe.const("dcg-icon-error"),"aria-hidden":Qe.const("true")}),()=>this.controller.unpack(this.model.error)))),Qe.createElement(D0,{predicate:()=>TE(this.model).length>0&&this.controller.areSlidersEnabled()},()=>Qe.createElement("div",{class:this.getFooterClass()},Qe.createElement(Ec,{model:this.props.model,controller:this.props.controller}))),Qe.createElement(D0,{predicate:this.bindFn(this.shouldShowActionInfo)},()=>Qe.createElement("div",{class:this.getFooterClass()},Qe.createElement(zg,{model:this.props.model,controller:this.props.controller})))),Qe.createElement("span",{class:Qe.const("dcg-tab dcg-action-drag dcg-action-icon-touch"),handleEvent:Qe.const("true"),tapboundary:Qe.const("true"),disablescroll:Qe.const("true"),onTapStart:this.bindFn(this.onDragPending)},Qe.createElement("span",{class:Qe.const("dcg-num")},()=>this.model.displayIndex),Qe.createElement("div",{class:Qe.const("dcg-tab-interior dcg-action-icon-mouse")},Qe.createElement($g,{model:this.props.model,controller:this.props.controller}))),Qe.createElement(Hl,{controller:this.props.controller,id:()=>this.model.id}))}isReadonly(){return this.controller.isItemReadonly(this.id)}shouldShowActionInfo(){return!!(this.model.clickableInfo&&this.model.clickableInfo.enabled&&this.model.clickableInfo.latex)}getFooterClass(){return this.isFirstRender()?this.const("dcg-expression-bottom dcg-indent-in-folder"):this.const("dcg-expression-bottom dcg-fadein-bottom dcg-indent-in-folder")}onNameInput(e){this.controller.dispatch({type:"set-image-name",id:this.id,name:e})}onNameFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.id,location:"name"}}):this.getFocusedInput()==="name"&&this.controller.dispatch({type:"blur-focus-location",location:{type:"image",id:this.id,location:"name"}})}onNameSpecialKey(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})}getFocusedInput(){let e=this.controller.getFocusLocation();if(e&&e.type==="image"&&e.id===this.model.id)return e.location}onRetryLoad(){this.controller.dispatch({type:"image-retry-loading",id:this.id})}shouldShowBrailleError(){return this.controller.getBrailleMode()!=="none"&&!!this.model.error}insertFiles(e){this.controller.dispatch({type:"change-image",files:e,id:this.id})}onMouseSelect(e){e.type==="dcg-tap"&&e.device==="mouse"||e.type==="dcg-tapstart"&&e.device==="touch"||e.wasHandled()||(e.handle(),this.controller.dispatch({type:"set-selected-id",id:this.id,state:"selected"}))}},Fa=__dcg_shared_module_exports__.e(ne()),_0=class extends Fa.Class{template(){return this.controller=this.props.controller(),Fa.createElement("div",{class:Fa.const("dcg-expressionitem dcg-new-expression dcg-opened")},Fa.createElement("div",{class:Fa.const("dcg-new-math-div dcg-do-not-blur dcg-action-newmath"),onTap:this.bindFn(this.newMath)},Fa.createElement("div",{class:Fa.const("dcg-new-expression-fade")})),Fa.createElement("span",{class:Fa.const("dcg-tab")},Fa.createElement("span",{class:Fa.const("dcg-num dcg-variable-index")},this.bindFn(this.getIndex)),Fa.createElement("div",{class:Fa.const("dcg-tab-interior")})))}getIndex(){return this.controller.getNextDisplayIndex()}newMath(){this.controller.dispatch({type:"new-expression-at-end"})}},Ar=__dcg_shared_module_exports__.e(ne()),I0=class extends Ar.Class{init(){this.controller=this.props.controller()}template(){return Ar.createElement("section",{class:Ar.const("dcg-progress-update-legend")},Ar.createElement("h2",{class:Ar.const("dcg-sr-only")},Ar.const("Progress Update Legend")),Ar.createElement("button",{onTap:()=>this.hideLegend(),class:Ar.const("dcg-hide-progress")},Ar.const("Hide Legend")),Ar.createElement("ul",{class:Ar.const("dcg-unstyled-list")},Ar.createElement("li",{class:Ar.const("dcg-legend-section")},Ar.createElement("span",{class:Ar.const("dcg-progress-unpublished dcg-progress-swatch"),"aria-label":Ar.const("light yellow swatch"),role:Ar.const("img")}),Ar.createElement("span",null,Ar.const("unpublished"))),Ar.createElement("li",{class:Ar.const("dcg-legend-section")},Ar.createElement("span",{class:Ar.const("dcg-progress-analyzing dcg-progress-swatch"),"aria-label":Ar.const("light blue swatch"),role:Ar.const("img")}),Ar.createElement("span",null,Ar.const("analyzing"))),Ar.createElement("li",{class:Ar.const("dcg-legend-section")},Ar.createElement("span",{class:Ar.const("dcg-progress-graphing dcg-progress-swatch"),"aria-label":Ar.const("light red swatch"),role:Ar.const("img")}),Ar.createElement("span",null,Ar.const("computing plot")))))}hideLegend(){this.controller.dispatch({type:"hide-progress-update-legend"})}},A0=__dcg_shared_module_exports__.e(ne()),M0=class extends is{didMountRoot(e){this.onItemViewMounted(e)}willUnmount(){this.onItemViewUnmounted()}template(){let e="";return this.model.cachedRenderHeight&&(e="height:"+this.model.cachedRenderHeight+"px"),A0.createElement("div",{class:A0.const("dcg-do-not-blur dcg-expressionitem dcg-shell"),"expr-id":this.const(this.model.id),onTap:this.bindFn(this.onMouseSelect),style:A0.const(e),didMount:this.bindFn(this.didMountRoot)})}},zo=__dcg_shared_module_exports__.e(ne()),fn=__dcg_shared_module_exports__.e(ne()),UI=[.05,.1,.15,.2,.35,.5,.75,1,1.5,2,3.5,5,7.5,10,15,20],fce=__dcg_shared_module_exports__.o(UI),bce=__dcg_shared_module_exports__.n(UI),G0=class extends fn.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return fn.createElement("div",{class:fn.const("dcg-slider-speed-container dcg-do-not-blur"),handleEvent:fn.const("true")},fn.createElement("span",{class:()=>({"dcg-action-slower":!0,"dcg-disabled":this.isSlowerDisabled()}),onTap:()=>this.animateSlower(),role:fn.const("button"),"aria-label":()=>this.getSlowerAriaLabel(),tabIndex:()=>this.isSlowerDisabled()?-1:0,"aria-disabled":()=>this.isSlowerDisabled()},fn.createElement("i",{class:fn.const("dcg-icon-show"),"aria-hidden":fn.const("true")})),fn.createElement("span",{class:fn.const("dcg-variable-speed")},this.bindFn(this.computeSpeed),fn.const("x")),fn.createElement("span",{class:()=>({"dcg-action-faster":!0,"dcg-disabled":this.isFasterDisabled()}),onTap:()=>this.animateFaster(),role:fn.const("button"),"aria-label":()=>this.getFasterAriaLabel(),tabIndex:()=>this.isFasterDisabled()?-1:0,"aria-disabled":()=>this.isFasterDisabled()},fn.createElement("i",{class:fn.const("dcg-icon-show"),"aria-hidden":fn.const("true")})))}computeSpeed(){let e=__dcg_shared_module_exports__.yd/this.model.slider.animationPeriod;return e=Number(e.toFixed(3)),e}isSlowerDisabled(){return fce>=this.computeSpeed()}isFasterDisabled(){return bce<=this.computeSpeed()}animateSlower(){let e=this.computeSpeed(),t=__dcg_shared_module_exports__.i(UI,r=>r<e);t.length!==0&&this.setPeriodFromSpeed(__dcg_shared_module_exports__.n(t))}animateFaster(){let e=this.computeSpeed(),t=__dcg_shared_module_exports__.i(UI,r=>r>e);t.length!==0&&this.setPeriodFromSpeed(__dcg_shared_module_exports__.o(t))}setPeriodFromSpeed(e){let t=__dcg_shared_module_exports__.yd/e;this.controller.dispatch({type:"set-slider-animationperiod",id:this.model.id,animationPeriod:t}),xe(this.controller.s("graphing-calculator-narration-slider-animating-at-speed",{speed:e+""}))}getSlowerAriaLabel(){return this.controller.s("graphing-calculator-narration-slider-animate-slower")}getFasterAriaLabel(){return this.controller.s("graphing-calculator-narration-slider-animate-faster")}},zI=class extends zo.Class{init(){var e;this.controller=this.props.controller(),this.model=this.props.model(),this.guid=(e=this.controller.getOpenItemMenu())==null?void 0:e.guid}didMount(){Fp(this.guid,this.controller)}willUnmount(){Np(this.guid,this.controller)}didMountArrow(e){this.arrowElt=e,Vs(this.arrowElt,this.controller)}didUpdate(){Vs(this.arrowElt,this.controller)}template(){let e=this.model;return zo.createElement("div",{class:zo.const("dcg-slider-options-view dcg-options-menu")},zo.createElement("div",{class:zo.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow),didUnmount:()=>this.arrowElt=void 0}),zo.createElement("div",{class:zo.const("dcg-slider-menu")},zo.createElement("div",{role:zo.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-slider-animation-mode")},zo.createElement("div",{role:zo.const("heading"),"aria-level":zo.const("2"),class:zo.const("dcg-title")},()=>this.controller.s("graphing-calculator-heading-slider-animation-mode")),zo.createElement(vo,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-heading-slider-animation-mode"),staticConfig:this.bindFn(this.getAnimationOptions),theme:this.const("mini")}))),zo.createElement("div",{class:zo.const("dcg-slider-menu dcg-slider-speed-menu"),role:zo.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-slider-speed")},zo.createElement("div",{role:zo.const("heading"),"aria-level":zo.const("2"),class:zo.const("dcg-title")},()=>this.controller.s("graphing-calculator-heading-slider-speed")),zo.createElement("div",{class:zo.const("dcg-slider-speed-container")},zo.createElement(G0,{model:()=>e,controller:this.props.controller}))))}getAnimationOptions(){let e=this.model;return["LOOP_FORWARD_REVERSE","LOOP_FORWARD","PLAY_ONCE","PLAY_INDEFINITELY"].map(t=>({key:t,icon:()=>__dcg_shared_module_exports__.qd(t),tooltip:()=>this.getTooltip(t),tooltipGravity:this.const("s"),selected:()=>this.isSelected(t),onSelect:()=>{this.controller.dispatch({type:"set-slider-loopmode",id:e.id,loopMode:t})}}))}getTooltip(e){let t=this.controller.s;switch(e){case"LOOP_FORWARD_REVERSE":return t("graphing-calculator-narration-slider-loop-forwards-and-backwards");case"LOOP_FORWARD":return t("graphing-calculator-narration-slider-repeat-one-direction");case"PLAY_ONCE":return t("graphing-calculator-narration-slider-play-once");case"PLAY_INDEFINITELY":return t("graphing-calculator-narration-slider-play-indefinitely")}}isSelected(e){return this.model.slider.loopMode===e}},rr=__dcg_shared_module_exports__.e(ne());function r$(e){let t=[],r=e.getAllItemModels();for(let n of r){let i=e.getItemRootNodeById(n.id);i&&t.push(i)}return t}function yce(e){let t=e.getAllItemModels();for(let r=t.length-1;r>=0;r--){let n=t[r];if(n.rootViewNode)return n.id}}function o$(e,t){let r=r$(e),n=0,i=r.length-1;for(;n<=i;){let o=n+Math.floor((i-n)/2),a=r[o],s=a.getBoundingClientRect();if(s.top>t)i=o-1;else if(s.bottom<t)n=o+1;else return a}}function xce(e,t){let r=r$(e),n=0,i=r.length-1,o;for(;n<=i;){let a=n+Math.floor((i-n)/2),s=r[a];s.getBoundingClientRect().top>t?(i=a-1,o=s):n=a+1}return o}function i$(e,t){let r=Tm(e);if(!r)return;if(t){let i=e.getItemRootNodeById(t);if(i){let o=i.getBoundingClientRect();if(o.height>0&&o.top<=r.top&&o.bottom>=r.top)return t}}let n=o$(e,r.top);return n?n.getAttribute("expr-id"):jO(e)}function n$(e,t){let r=Tm(e);if(!r)return;let n=yce(e);if(!n)return;if(t){let o=e.getItemRootNodeById(t);if(o){let a=o.getBoundingClientRect();if(a.height>0&&a.top<=r.bottom&&a.bottom>=r.bottom||t===n&&a.bottom<=r.bottom)return t}}let i=o$(e,r.bottom);return i&&i.getAttribute("expr-id")||n}function jO(e){let t=Tm(e);if(!t)return;let r=xce(e,t.top-2);if(r)return r.getAttribute("expr-id")}function L0(e){return e.findEl(".dcg-exppanel")}function Tm(e){let t=L0(e);if(t)return t.getBoundingClientRect()}function a$(e){let t=e.findEl(".dcg-exppanel-container");if(!t)return;let r=t.getBoundingClientRect(),n=t.scrollTop;return r.top-n}function s$(e){let t=e.findEl(".dcg-expressionlist");if(!t)return;let r=t.getBoundingClientRect();return{width:r.width,height:r.height}}function l$(e){let t=L0(e);if(!t)return;let r=t.querySelector(".dcg-drag-container > *");if(!r)return;let n=r.getBoundingClientRect();return{width:n.width,height:n.height}}qt();var fs=__dcg_shared_module_exports__.e(ne()),{If:wce}=fs.Components,qI=class extends fs.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return fs.createElement(wce,{predicate:()=>this.controller.shouldShowRegressionButton(this.model)},()=>fs.createElement("div",{class:fs.const("dcg-add-regression-view dcg-do-blur"),handleEvent:fs.const(!0)},fs.createElement(Le,{tooltip:this.bindFn(this.getTooltipText),gravity:()=>"e"},fs.createElement("i",{onTap:()=>{this.controller.dispatch({type:"create-table-regression",tableId:this.model.id,regressionType:"linear"})},role:fs.const("button"),tabIndex:fs.const("0"),"aria-label":this.bindFn(this.getTooltipText),class:fs.const("dcg-icon-points"),manageFocus:this.const(rt({controller:this.controller,location:{type:"add-table-regression-btn",id:this.model.id}}))}))))}getTooltipText(){return this.controller.s("graphing-calculator-button-add-table-regression")}},je=__dcg_shared_module_exports__.e(ne()),Ni=__dcg_shared_module_exports__.e(ne());qt();var vce='a, input, button:not([disabled]), textarea, select [role="textbox"], [tabIndex="0"], [role="option"], [role="button"], [role="link"], summary',ex=class{constructor({isOpen:e,closeMenu:t,anchorSelector:r,popoverSelector:n,itemNavigationKey:i}){this.handleKeydown=o=>{switch(this.itemNavigationKey){case"arrow":return this.onKeydownWithArrowTrapping(o);case"tab":return this.onKeydownWithTabTrapping(o)}},this.handleTap=o=>{let a=document.querySelector(this.popoverSelector);if(!a)return;let{target:s}=o,l=this.anchorSelector;l&&s.closest(l)||a.contains(s)||Array.from(document.querySelectorAll(".dcg-keypad,.dcg-show-keypad-container")).some(c=>c.contains(s))||this.closeMenu()},this.isOpen=e,this.closeMenu=t,this.anchorSelector=r,this.popoverSelector=n,this.itemNavigationKey=i}getFocusableItems(){let e=document.querySelector(this.popoverSelector);return e?Array.from(e.querySelectorAll(vce)).filter(t=>t.getAttribute("tabIndex")!=="-1").filter(t=>bp(t)):[]}focusAnchor(){var e;(e=document.querySelector(this.anchorSelector))==null||e.focus()}focusItemAtIdx(e){let t=this.getFocusableItems();return t.length&&t.length>e?(t[e].focus(),!0):!1}focusFirstItem(){this.focusItemAtIdx(0)}focusLastItem(){this.focusItemAtIdx(this.getFocusableItems().length-1)}getFocusedElement(){return this.getFocusableItems().find(e=>e.matches(":focus"))}moveFocusInDirection(e){let t=this.getFocusableItems(),r=t.findIndex(o=>o.matches(":focus"));if(r===-1)return!1;let n=r+e;if(n==-1||n==t.length)return!0;let i=t[n];return i?(i.focus(),!0):!1}isAnchorFocused(){var e;return(e=document.querySelector(this.anchorSelector))==null?void 0:e.matches(":focus")}isFirstItemFocused(){var e;let t=this.getFocusableItems();return t.length>0&&((e=t[0])==null?void 0:e.matches(":focus"))}isLastItemFocused(){var e;let t=this.getFocusableItems();return t.length>0&&((e=t[t.length-1])==null?void 0:e.matches(":focus"))}onKeydownWithArrowTrapping(e){if(this.isOpen())switch(ke(e)){case xa:this.moveFocusInDirection(-1)&&e.preventDefault();break;case Kn:this.moveFocusInDirection(1)&&e.preventDefault();break;case fp:e.preventDefault(),this.focusLastItem();break;case rl:e.preventDefault(),this.closeMenu();break;case kn:e.preventDefault(),e.stopPropagation(),this.closeMenu(),this.focusAnchor();break}}onKeydownWithTabTrapping(e){if(!this.isOpen())return;let t=ke(e);if(t===kn){e.preventDefault(),e.stopPropagation(),this.focusAnchor(),this.closeMenu();return}if(t==="Tab"&&!e.altKey&&!e.ctrlKey&&!e.metaKey){if(this.isAnchorFocused()){e.shiftKey?this.focusLastItem():this.focusFirstItem(),e.preventDefault(),e.stopPropagation();return}if(this.isLastItemFocused()&&!e.shiftKey){this.focusAnchor(),e.preventDefault(),e.stopPropagation();return}if(this.isFirstItemFocused()&&e.shiftKey){this.focusAnchor(),e.preventDefault(),e.stopPropagation();return}}}},{IfDefined:Cce,If:Sce}=Ni.Components,Ece=-7,HI=9,XO=class extends Ni.Class{didMountPopover(e){var t,r,n,i;(r=(t=this.props).didMount)==null||r.call(t,e);let o=(i=(n=this.props).focusHelper)==null?void 0:i.call(n);o&&(document.addEventListener("keydown",o.handleKeydown),o.focusFirstItem())}didUnmountPopover(){var e,t;let r=(t=(e=this.props).focusHelper)==null?void 0:t.call(e);r&&document.removeEventListener("keydown",r.handleKeydown)}isVisible(){return this.props.visible?this.props.visible():!0}getPositionClasses(){let e=this.props.position();return{"dcg-left":e==="left","dcg-right":e==="right","dcg-bottom":e==="bottom-left"||e==="bottom-right","dcg-top":e==="top-left"||e==="top-right"}}template(){return Ni.createElement("div",{class:()=>{var e,t,r,n,i,o;return ie(R({"dcg-dropdown-popover":!0,"dcg-dropdown-popover--with-arrow":!((t=(e=this.props).hideArrow)!=null&&t.call(e)),"dcg-dropdown-popover--constrain-height":(n=(r=this.props).constrainHeight)==null?void 0:n.call(r)},this.getPositionClasses()),{[((o=(i=this.props).className)==null?void 0:o.call(i))||""]:!!this.props.className})},role:Ni.const("region"),style:()=>{var e,t;return R({display:this.isVisible()?void 0:"none"},((t=(e=this.props).style)==null?void 0:t.call(e))||{})},didMount:this.bindFn(this.didMountPopover),didUnmount:this.bindFn(this.didUnmountPopover)},Ni.createElement("div",{class:Ni.const("dcg-dropdown-popover__interior")},Cce(()=>{var e,t;return(t=(e=this.props).title)==null?void 0:t.call(e)},e=>Ni.createElement("h2",{class:Ni.const("dcg-unstyled-heading dcg-dropdown-popover__title")},()=>e())),this.props.children),Ni.createElement(Sce,{predicate:()=>{var e,t;return!((t=(e=this.props).hideArrow)!=null&&t.call(e))}},()=>Ni.createElement("div",{class:Ni.const("dcg-arrow"),style:()=>{var e,t;return((t=(e=this.props).arrowStyle)==null?void 0:t.call(e))||{}}})))}},P0=class extends Ni.Class{constructor(){super(...arguments),this.showDropdown=!1,this.guid=this.props.guid(),this.dropdownStyle={},this.arrowStyle=void 0,this.debouncedPositionDynamically=__dcg_shared_module_exports__.A(this.bindFn(this.positionDynamically),200)}init(){var e,t;let r=(t=(e=this.props).manageFocus)==null?void 0:t.call(e);r&&(this.focusHelper=new ex({anchorSelector:`.dcg-popover-with-anchor__anchor--${this.guid}`,popoverSelector:`.dcg-popover-with-anchor__popover--${this.guid}`,isOpen:()=>this.isDropdownOpen(),closeMenu:()=>this.setDropdownOpen(!1),itemNavigationKey:r.itemNavigationKey}))}isDropdownOpen(){return this.props.controlled?this.props.controlled().isOpen:this.showDropdown}setDropdownOpen(e){var t,r,n;(r=(t=this.props).disabled)!=null&&r.call(t)||(this.props.controlled?this.props.controlled().setDropdownOpen(e):(this.showDropdown=e,this.update()),e&&(this.resetPosition(),this.positionDynamically(),(n=this.focusHelper)==null||n.focusFirstItem()))}didMountWrapper(e){var t,r;this.rootNode=e,window.addEventListener("resize",this.debouncedPositionDynamically);let n=(r=(t=this.props).boundingParentElement)==null?void 0:r.call(t);n&&(this.resizeObserver=new ResizeObserver(this.debouncedPositionDynamically),this.resizeObserver.observe(n)),ee(document.body).on(`dcg-tapstart.${this.guid}`,i=>{if(!(i.target===e||ee.contains(e,i.target))&&this.isDropdownOpen()){let o=e.querySelector(".dcg-popover-with-anchor__popover");if(ee.contains(o,i.target))return;let a=o.getBoundingClientRect();if(i.clientX!==void 0&&i.clientY!==void 0&&i.clientX>a.left&&i.clientX<a.right&&i.clientY>a.top&&i.clientY<a.bottom)return;this.setDropdownOpen(!1);return}})}didUnmountWrapper(){this.showDropdown=!1,ee(document.body).off(`.${this.guid}`),ee(document).off(`.${this.guid}`),window.removeEventListener("resize",this.debouncedPositionDynamically),this.resizeObserver&&this.resizeObserver.disconnect()}didMountDropdown(e){var t,r,n;this.dropdownNode=e,(t=this.rootNode)!=null&&t.querySelector(".dcg-arrow")&&(this.arrowStyle={}),this.resetPosition(),this.positionDynamically(),(n=(r=this.props.dropdownProps()).didMount)==null||n.call(r,e)}getDropdownOffset(){var e,t;return((t=(e=this.props).dropdownOffset)==null?void 0:t.call(e))||Ece}resetPosition(){var e;let t=this.props.dropdownProps().position();this.dropdownStyle={},(e=this.rootNode)!=null&&e.querySelector(".dcg-arrow")?this.arrowStyle={}:this.arrowStyle=void 0;let r=this.getDropdownOffset();switch(t){case"left":case"right":this.dropdownStyle.top=`${r}px`,this.arrowStyle&&(this.arrowStyle.top=`${HI}px`);break;case"top-right":case"bottom-right":this.dropdownStyle.left=`${r}px`,this.arrowStyle&&(this.arrowStyle.left=`${HI}px`);break;case"top-left":case"bottom-left":this.dropdownStyle.right=`${r}px`,this.arrowStyle&&(this.arrowStyle.right=`${HI}px`);break}this.update()}positionDynamically(){var e,t,r,n;let i=this.dropdownNode,o=this.rootNode;if(!o||!i||!this.isDropdownOpen())return;let a=i.getBoundingClientRect(),s=(r=(t=(e=this.props).boundingParentElement)==null?void 0:t.call(e))==null?void 0:r.getBoundingClientRect(),l=s?s.x+s.width:window.innerWidth,c=s?s.y+s.height:window.innerHeight,d=(n=s==null?void 0:s.left)!=null?n:0,u=a.bottom>c,p=a.right>l,g=a.left<d,f=this.props.dropdownProps().position(),y=o.getBoundingClientRect(),E=15,_=HI+this.getDropdownOffset();if((f==="left"||f==="right")&&u){let w=c-y.y-E,v=a.height-w;this.dropdownStyle.top=`${-1*v}px`,this.arrowStyle&&(this.arrowStyle.top=`${v+_}px`)}else if((f==="bottom-right"||f==="top-right")&&p){let w=l-y.x-E,v=a.width-w;this.dropdownStyle.left=`${-1*v}px`,this.arrowStyle&&(this.arrowStyle.left=`${v+_}px`)}else if((f==="bottom-left"||f==="top-left")&&g){let w=y.x+y.width-E-d,v=a.width-w;this.dropdownStyle.right=`${-1*v}px`,this.arrowStyle&&(this.arrowStyle.right=`${v+_}px`)}this.update()}getDropdownClassNames(){var e,t;let r=((t=(e=this.props.dropdownProps()).className)==null?void 0:t.call(e))||"";return`dcg-popover-with-anchor__popover dcg-popover-with-anchor__popover--${this.guid} ${r}`}template(){return Ni.createElement("div",{class:()=>{var e,t;return{"dcg-popover-with-anchor":!0,[((t=(e=this.props).containerClassName)==null?void 0:t.call(e))||""]:!!this.props.containerClassName}},didMount:this.bindFn(this.didMountWrapper),didUnmount:this.bindFn(this.didUnmountWrapper)},Ni.createElement("div",{role:Ni.const("link"),tabIndex:Ni.const(0),"aria-label":()=>{var e,t;return(t=(e=this.props).anchorAriaLabel)==null?void 0:t.call(e)},"aria-expanded":this.bindFn(this.isDropdownOpen),"aria-haspopup":Ni.const("true"),class:()=>({"dcg-popover-with-anchor__anchor":!0,[`dcg-popover-with-anchor__anchor--${this.guid}`]:!0,"dcg-popover-with-anchor__open":this.isDropdownOpen()}),onTap:()=>{this.setDropdownOpen(!this.isDropdownOpen())}},this.props.anchor()),Ni.createElement(XO,ie(R({},this.props.dropdownProps()),{className:this.bindFn(this.getDropdownClassNames),visible:this.bindFn(this.isDropdownOpen),focusHelper:()=>this.focusHelper,didMount:e=>this.didMountDropdown(e),arrowStyle:()=>this.arrowStyle,style:()=>this.dropdownStyle}),this.props.children))}},oa=__dcg_shared_module_exports__.e(ne());qt();var dr=__dcg_shared_module_exports__.e(ne()),{For:c$,If:KI,IfDefined:Tce,Switch:Dce}=dr.Components,WI=class extends dr.Class{template(){var e,t;return dr.createElement("div",{role:dr.const("list"),class:()=>{var r,n;return{"dcg-shared-options-dropdown":!0,[((n=(r=this.props).class)==null?void 0:n.call(r))||""]:!!this.props.class}}},dr.createElement(c$,{each:this.props.options,key:r=>`${r.key?r.key:r.title()}${r.disabled?"-disabled":""}`},r=>dr.createElement("div",{role:dr.const("listitem"),class:dr.const("dropdown-option-container")},dr.createElement(Dce,{key:()=>r},n=>"href"in n?dr.createElement("a",{"aria-disabled":()=>n.disabled,"aria-selected":()=>{var i;return(i=n.selected)==null?void 0:i.call(n)},id:this.const(n.key),tabIndex:()=>this.getTabIndex(n),class:()=>{var i;return{[n.class||""]:!!n.class,"dcg-standard-link-styling":!n.class,"dcg-dropdown-choice":!0,"dcg-disabled":n.disabled,"dcg-selected":(i=n.selected)==null?void 0:i.call(n)}},onTap:()=>!n.disabled&&this.props.onTap(n),href:()=>n.href,target:()=>n.target!==void 0?n.target:"",rel:()=>n.noreferrer?"noreferrer noopener":""},dr.createElement(KI,{predicate:()=>n.icon!=null},()=>dr.createElement("div",{class:dr.const("dcg-option-icon-container")},dr.createElement("i",{"aria-hidden":dr.const("true"),class:()=>`${n.icon} dcg-option-icon`}))),dr.createElement(es,{content:n.title,mqConfig:this.const({})})):dr.createElement("div",{role:dr.const("link"),tabIndex:()=>this.getTabIndex(n),"aria-disabled":()=>n.disabled,"aria-selected":()=>{var i;return(i=n.selected)==null?void 0:i.call(n)},id:this.const(n.key),class:()=>{var i;return{[n.class||""]:!!n.class,"dcg-standard-link-styling":!n.class,"dcg-dropdown-choice":!0,"dcg-disabled":n.disabled,"dcg-selected":(i=n.selected)==null?void 0:i.call(n)}},onTap:()=>!n.disabled&&this.props.onTap(n)},dr.createElement(KI,{predicate:()=>n.icon!=null},()=>dr.createElement("div",{class:dr.const("dcg-option-icon-container")},dr.createElement("i",{"aria-hidden":dr.const("true"),class:()=>`${n.icon} dcg-option-icon`}))),dr.createElement("span",{class:dr.const("option-title")},dr.createElement(es,{content:n.title,mqConfig:this.const({})})),Tce(()=>n.subtitle&&n.subtitle(),i=>dr.createElement("span",{class:dr.const("dcg-option-subtitle")},i)))),dr.createElement(KI,{predicate:()=>!!r.explanations},()=>dr.createElement("div",{class:dr.const("dcg-dropdown-explanations")},dr.createElement(c$,{each:()=>r.explanations||[],key:n=>n.flag},n=>dr.createElement("div",{class:dr.const("dcg-explanation")},()=>n.explanation,dr.const(" "),dr.createElement(KI,{predicate:()=>!!n.link},()=>dr.createElement("a",{class:dr.const("learn-more"),href:()=>n.link!==void 0?n.link:"",target:dr.const("_blank")},()=>n.linkText?n.linkText:Ls("shared-button-learn-more-capitalized"))))))))),(t=(e=this.props).buildFooter)==null?void 0:t.call(e))}getTabIndex(e){var t;return e.disabled&&!((t=e.selected)!=null&&t.call(e))?-1:0}},{If:kce,IfElse:_ce}=oa.Components,V0=class extends oa.Class{init(){var e,t;this.i18n=this.props.controller(),this.filter=(t=(e=this.props).defaultValue)==null?void 0:t.call(e),this.shouldShowResults=!1,this.uuid=Dd(),this.focusHelper=new ex({anchorSelector:`#dcg-select-dropdown-container-${this.props.id()} .dcg-dropdown-input`,popoverSelector:`#dcg-select-dropdown-container-${this.props.id()} .dcg-select-dropdown-list`,isOpen:()=>this.isOpen(),closeMenu:()=>this.setResultsOpen(!1),itemNavigationKey:"arrow"})}handleKeyDown(e){var t;switch(ke(e)){case Kn:if(!this.isOpen()){this.setResultsOpen(!0),e.preventDefault();return}break;case rl:if(this.isOpen()){let r=this.focusHelper.getFocusedElement();r&&(this.selectOptionById((t=r.getAttribute("id"))!=null?t:void 0),e.preventDefault());return}break}this.focusHelper.handleKeydown(e)}template(){return oa.createElement("div",{class:oa.const("dcg-select-dropdown-container"),onKeyDown:this.bindFn(this.handleKeyDown),didMount:this.bindFn(this.attachTapListener),didUnmount:this.bindFn(this.unmountTapListener),id:()=>`dcg-select-dropdown-container-${this.props.id()}`},oa.createElement("button",{class:()=>({"dcg-dropdown-input":!0,"dcg-results-hidden":!this.isOpen()}),"aria-haspopup":this.const("listbox"),"aria-expanded":()=>this.isOpen(),onTap:this.bindFn(this.toggleResultsOpen),didMount:e=>{var t,r;(r=(t=this.props).focusOnMount)!=null&&r.call(t)&&e.focus()},id:this.props.id,manageFocus:()=>{var e,t;return(t=(e=this.props).manageFocus)==null?void 0:t.call(e)}},oa.createElement(es,{content:this.bindFn(this.getFilterString),mqConfig:this.const({})}),_ce(()=>this.isOpen(),{true:()=>oa.createElement("i",{class:oa.const("dcg-icon-caret-up dcg-open-options"),"aria-label":()=>this.i18n.s("shared-calculator-button-hide-options")}),false:()=>oa.createElement("i",{class:oa.const("dcg-icon-caret-down dcg-open-options"),"aria-label":()=>this.i18n.s("shared-calculator-button-show-options")})})),oa.createElement(kce,{predicate:()=>this.isOpen()},()=>oa.createElement("div",{class:oa.const("dcg-options-dropdown__padded-bottom-container")},oa.createElement(WI,{options:()=>this.getOptions(),onTap:e=>this.selectOptionById(e.key),class:this.const("dcg-select-dropdown-list"),buildFooter:this.props.buildFooter}))))}getOptions(){return this.props.options().map(e=>({key:e.id,title:()=>e.label,selected:()=>e.label===this.getFilterString(),disabled:e.disabled,class:"dcg-select-dropdown-option"}))}isOpen(){return!!this.shouldShowResults}setResultsOpen(e){var t,r;if(this.shouldShowResults=e,this.update(),(r=(t=this.props).onOpenChange)==null||r.call(t,e),e)if(this.filter){let n=this.props.options().find(i=>i.id===this.filter);this.focusOption(n)}else if(this.props.externalControl){let n=this.props.externalControl().getValue(),i=this.props.options().find(o=>o.id===n);this.focusOption(i)}else this.focusHelper.focusFirstItem()}toggleResultsOpen(){this.setResultsOpen(!this.shouldShowResults)}focusOption(e){if(!e)return;let t=document.querySelector(`#dcg-select-dropdown-container-${this.props.id()} .dcg-select-dropdown-list #${e.id}`);t==null||t.focus()}onInputChange(e){this.props.externalControl?this.props.externalControl().onValueChange(e):this.filter=e,this.update()}getFilterString(){let e=this.props.options().find(t=>t.id===(this.props.externalControl?this.props.externalControl().getValue():this.filter));return(e==null?void 0:e.label)||""}selectOptionById(e){var t,r;let n=this.props.options().find(i=>i.id===e);n&&(this.onInputChange(n.id),this.setResultsOpen(!1),this.focusHelper.focusAnchor(),(r=(t=this.props).onChange)==null||r.call(t,n.id))}unmountTapListener(){ee(document.body).off(`dcg-tapstart.dcg-select-dropdown-container-${this.uuid}`)}attachTapListener(){ee(document.body).on(`dcg-tapstart.dcg-select-dropdown-container-${this.uuid}`,this.bindFn(this.tapListener))}tapListener(e){e.target.closest(`#dcg-select-dropdown-container-${this.props.id()}`)||this.setResultsOpen(!1)}};Ss();function d$(e){switch(e){case void 0:case"IDLE":case"UNPUBLISHED":case"RESOLVED":return!1;case"ANALYZING":case"GRAPHING":return!0;default:throw new Error(`Unexpected progress status: ${e}`)}}var aj=__dcg_shared_module_exports__.e(ne());qt();var O0=class{constructor(e){this.active=!1,this.controller=e;let t=this.controller.getExppanelElt();t&&(this.exppanel=t)}startDragging(e){this.active=!0,this.mousePt=e,this.setupEventListeners()}applyDrag(){var e;let t=this.controller.getListModel().dragState;if(!t)return;this.scheduleUpdateScroll();let r=this.measureDOM(t);if(!r)return;let{floatingPreviewRect:n,dragState:i,visibleRects:o}=r,a=this.controller.getItemModel(i.firstItemId);if(!a)return;let s=a.index,l=o[0];if(l&&l.id!==a.id){let w=this.controller.getItemModel(l.id);w&&w.index>s&&(s=w.index-1)}let{cachedNamedAssignmentLatex:c,cachedTokenAssignmentLatex:d}=i;for(let{id:w,rect:v}of o){if(w===a.id)continue;let T=this.controller.getItemModel(w);if(!T)return;if(T.index<a.index){if(n.top<v.top+v.height/2){s=T.index;break}}else n.bottom>v.top+v.height/2&&(s=T.index,T.type==="folder"&&T.collapsed&&(s+=this.controller.getNumberOfItemsInFolder(T.id)))}let u,p;s>a.index?(u=s,p=s+1):s<a.index?(u=s-1,p=s):(u=s-1,p=s+1);let g=this.controller.getItemModelByIndex(u),f=this.controller.getItemModelByIndex(p),y="",E="";g&&(g.type==="folder"?y=g.id:y=g.folderId),f&&(f.type==="folder"?E=f.id:E=f.folderId);let _="";if(y&&(E===y?a.type==="folder"?s=a.index:_=y:a.type!=="folder"&&this.isPreviewTopContainedInFolder(r,y)&&(_=y)),a.type==="expression")if(i.renderType==="token"){if(t.renderType==="expression"&&(c=a.latex,this.controller.convertToTokenAssignment(a,d)),i.dragTarget.type==="token")s=i.dragTarget.originalIndex,_=((e=this.controller.getGeometryFolder())==null?void 0:e.id)||"";else if(i.dragTarget.type==="expression"){let w=this.controller.getGeometryFolder();if(w){let v=this.controller.getNumberOfItemsInFolder(w.id);a.type==="expression"&&a.folderId===w.id&&(v-=1),s=w.index+v+1,_=w.id}}}else i.renderType==="expression"&&t.renderType==="token"&&(d=a.latex,this.controller.convertToNamedAssignment(a,c));return{dragState:ie(R({},i),{cachedNamedAssignmentLatex:c,cachedTokenAssignmentLatex:d}),newIndex:s,folderId:_}}measureDOM(e){var t;let r={x:((t=Tm(this.controller))==null?void 0:t.left)||0,y:a$(this.controller)},n=s$(this.controller),i=l$(this.controller);if(r.y===void 0||!n||!i)return;let o=n.height,a=i.height,s=!1,l=this.controller.getExppanelElt(),c=l==null?void 0:l.querySelector(".dcg-template-expressioneach"),d=c==null?void 0:c.getBoundingClientRect();d&&d.top<=e.mousePt.y&&(s=!0);let u=!1,p=l==null?void 0:l.querySelector(".dcg-geo-show-constructions-pane"),g=p==null?void 0:p.getBoundingClientRect();g&&g.bottom>e.mousePt.y&&(u=!0);let f=!1;(e.dragTarget.type==="token"&&!s||e.dragTarget.type==="expression"&&u&&!s&&this.controller.canDraggedItemBeMovedIntoTokenPane())&&(f=!0);let y=e.grabOffset;f?y={x:i.width/2+2.5,y:i.height/2}:e.dragTarget.type==="token"&&(y={x:0,y:i.height/2});let E=e.mousePt.y-y.y,_=__dcg_shared_module_exports__.Sb(E-r.y,-a/2,o-a),w=0;f&&(w=__dcg_shared_module_exports__.Sb(e.mousePt.x-y.x-r.x,0,n.width-i.width-4),_=Math.max(_,2));let v={left:w,top:E,bottom:E+a,height:a},T=this.controller.findFirstVisibleItem(),M=this.controller.findLastVisibleItem(),C=[];if(T&&M)for(let P=T.index;P<=M.index;P++){let F=this.controller.getItemModelByIndex(P);if(!F)continue;let B=this.controller.getItemRootNodeById(F.id);if(B&&F.id!==e.firstItemId){let x=B.getBoundingClientRect();C.push({id:F.id,rect:x})}}return{dragState:ie(R({},e),{itemTop:_,itemLeft:w,renderType:f?"token":"expression"}),floatingPreviewRect:v,visibleRects:C}}isPreviewTopContainedInFolder(e,t){let{visibleRects:r,floatingPreviewRect:n}=e;for(let{id:i,rect:o}of r)if(o.top<=n.top&&o.bottom>=n.top){let a=this.controller.getItemModel(i);if(!a)return!1;if(a.type==="folder"&&a.id===t||a.type!=="folder"&&a.folderId===t)return!0}return!1}scheduleUpdateScroll(){this.updateScrollScheduled||(this.updateScrollScheduled=!0,requestAnimationFrame(()=>{this.updateScroll(),this.updateScrollScheduled=!1}))}stop(){this.active=!1,this.tearDownEventListeners(),this.controller.dispatch({type:"stop-dragdrop"})}setupEventListeners(){ee(document).on("dcg-tapmove.dragdrop",e=>{this.mousePt.x=e.changedTouches[0].clientX,this.mousePt.y=e.changedTouches[0].clientY,this.controller.dispatch({type:"update-dragdrop",mousePt:this.mousePt})}),ee(document).on("dcg-tapend.dragdrop",e=>{this.stop(),e.handle("dragdrop")})}tearDownEventListeners(){ee(document).off(".dragdrop")}updateScroll(){if(!this.active)return;let e=this.exppanel.getBoundingClientRect(),t=0;t=Math.min(t,this.mousePt.y-e.top),t=Math.max(t,this.mousePt.y-e.bottom+30),t=t*e.height/900,t&&(this.exppanel.scrollTop=this.exppanel.scrollTop+t)}};function p$(e,t,r){let n=.5/(2*r*t);return ho(e-n,e+n)}function R0(e,t,r,n,i=0){let o=__dcg_shared_module_exports__.U(e.x,e.y,0,r[0],r[1],0,n[0],n[1],0);i&&(o+=i);let a=.5/(__dcg_shared_module_exports__.Ub(r,n)*t);return ho(o-a,o+a)}function Rc(e,t){for(let r of t)r&&(r.min!==void 0&&e<r.min?e=r.min:r.max!==void 0&&e>r.max&&(e=r.max));return e}function $I(e,t,r,n){if(!r)return 0;let i=e.mapx(1)-e.mapx(0);switch(r.valueType){case __dcg_shared_module_exports__.Na:{let o=t.x-r.value[0][0],a=t.y-r.value[0][1],s=Math.atan2(a,o)/(2*Math.PI);s<0&&(s+=1),s=p$(s,i,r.value[1]);let l=Rc(0,[n]),c=Rc(1,[n]);if(s>=l&&s<=c)return s;{let d=__dcg_shared_module_exports__._b(r.value,l),u=__dcg_shared_module_exports__._b(r.value,c),p=__dcg_shared_module_exports__.Ub(d,[t.x,t.y]),g=__dcg_shared_module_exports__.Ub(u,[t.x,t.y]);return p<=g?l:c}}case __dcg_shared_module_exports__.Pa:{let o=__dcg_shared_module_exports__.bc(r.value);if(!o)return 0;if(o.type==="segment"){let a=R0(t,i,o.start,o.end);return Rc(a,[{min:0,max:1},n])}else if(o.type==="rays"){let a=__dcg_shared_module_exports__.Ub(o.start1,[t.x,t.y]),s=__dcg_shared_module_exports__.Ub(o.start2,[t.x,t.y]),l=!n||n.min===void 0?-1/0:n.min,c=!n||n.max===void 0?1/0:n.max;return a<s?l>0?c>=1?1:l:Rc(-R0(t,i,o.start1,o.end1),[{min:void 0,max:0},n]):c<1?l<=0?0:c:Rc(R0(t,i,o.start2,o.end2,1),[{min:1,max:void 0},n])}else if(o.type=="arc"){let[a,s]=o.center,{radius:l,startAngle:c}=o,d=__dcg_shared_module_exports__.Wb(r.value),u=t.x-a,p=t.y-s,g=__dcg_shared_module_exports__.P(Math.atan2(p,u),c,d);if(g>=0&&g<=1)g=p$(g,i,l);else{let E=lk(t,{x:a+l*Math.cos(c),y:s+l*Math.sin(c)}),_=lk(t,{x:a+l*Math.cos(c+d),y:s+l*Math.sin(c+d)});E<=_?g=0:g=1}let f=Rc(0,[n]),y=Rc(1,[n]);if(g>=f&&g<=y)return g;{let E=__dcg_shared_module_exports__.$b(r.value,f),_=__dcg_shared_module_exports__.$b(r.value,y),w=__dcg_shared_module_exports__.Ub(E,[t.x,t.y]),v=__dcg_shared_module_exports__.Ub(_,[t.x,t.y]);return w<=v?f:y}}return Rc(0,[n])}case __dcg_shared_module_exports__.Ta:case __dcg_shared_module_exports__.La:case __dcg_shared_module_exports__.Ra:{let o=R0(t,i,r.value[0],r.value[1]);return Rc(o,[{min:r.valueType===__dcg_shared_module_exports__.Ra?void 0:0,max:r.valueType!==__dcg_shared_module_exports__.La?void 0:1},n])}case __dcg_shared_module_exports__.Ja:{let o=r.value,a=1/0,s=Rc(0,[n]),l=n&&n.min!==void 0?n.min:-1/0,c=n&&n.max!==void 0?n.max:1/0,d=Math.floor(Math.max(l,0)),u=Math.ceil(Math.min(c,o.length));for(let p=d;p<u;p++){let g=o[p],f=o[(p+1)%o.length],y=Rc(R0(t,i,g,f,p),[{min:p,max:p+1},n]),E=__dcg_shared_module_exports__.ac(r.value,y),_=__dcg_shared_module_exports__.Ub(E,[t.x,t.y]);_<a&&(a=_,s=y)}return s}case __dcg_shared_module_exports__.ya:case __dcg_shared_module_exports__.Va:case __dcg_shared_module_exports__.Xa:case __dcg_shared_module_exports__.Za:case __dcg_shared_module_exports__.$a:return 0;default:return r}}function u$(e,t){switch(e.valueType){case __dcg_shared_module_exports__.Na:return __dcg_shared_module_exports__._b(e.value,t);case __dcg_shared_module_exports__.Pa:return __dcg_shared_module_exports__.$b(e.value,t);case __dcg_shared_module_exports__.Ta:return __dcg_shared_module_exports__.Zb(e.value,t);case __dcg_shared_module_exports__.La:return __dcg_shared_module_exports__.Yb(e.value,t);case __dcg_shared_module_exports__.Ra:return __dcg_shared_module_exports__.Xb(e.value,t);case __dcg_shared_module_exports__.Ja:return __dcg_shared_module_exports__.ac(e.value,t);case __dcg_shared_module_exports__.ya:case __dcg_shared_module_exports__.Va:case __dcg_shared_module_exports__.Xa:case __dcg_shared_module_exports__.Za:case __dcg_shared_module_exports__.$a:return[NaN,NaN];default:return e}}function Ice(e,t){if(!t)return!1;let{left:r,right:n,top:i,bottom:o}=e.pixelCoordinates,{x:a,y:s}=t.mathPoint;if(t.transform){let l=t.model.formula.typed_constant_value;if((l==null?void 0:l.valueType)!==__dcg_shared_module_exports__.ya)throw new Error(`Expected movable point to be a Point but found ${l?__dcg_shared_module_exports__.ub(l.valueType):void 0} instead`);a=a!=null?a:l.value[0],s=s!=null?s:l.value[1],[a,s]=__dcg_shared_module_exports__.oc(t.transform.forward,[a,s])}if(a!==void 0){let l=e.mathToPixels.mapX(a);if(l<r-.5||l>n+.5)return!1}if(s!==void 0){let l=e.mathToPixels.mapY(s);if(l<i-.5||l>o+.5)return!1}return!0}function h$(e,t){if(t.length===1&&!Ice(e,t[0]))return!1;let r=!1;for(let n of t){if(n.newPointLatex){let i=n.model.latex;$a(n.model,n.newPointLatex),r=r||i!==n.model.latex}for(let i in n.sliderUpdates){let{value:o,model:a}=n.sliderUpdates[i];n.commitSliderSoftLimits&&yb(a);let s=a.latex;QE(a,o),r=r||s!==a.latex}}return r}function g$({projection:e,transform:t,controller:r,strategy:n,mode:i,clampToViewport:o}){var a;let s=r.getItemModel(n.id);if(!s||s.type!=="expression")throw new Error(`Programming error: updateSliderNonlinear move strategy should point to an expression item, but found ${s==null?void 0:s.type}`);let l=i==="up"||i==="bigup",c=((a=s.slider)==null?void 0:a.step)!==""&&(l&&!s.slider.hardMax||!l&&!s.slider.hardMin);n.compiled.fn||__dcg_shared_module_exports__.vc(n.compiled);let d=n.compiled.fn;t&&(d=M=>__dcg_shared_module_exports__.oc(t.forward,n.compiled.fn(M)));let u=M=>{let[C,P]=d(M);return{x:C,y:P}=e.mathToPixels.mapPoint({x:C,y:P}),[C,P]},p=al(s),[g,f]=u(p),y=dL(s,i,{ignoreSoftLimits:c}),E=y,[_,w]=u(E),v=__dcg_shared_module_exports__.S(_-g,w-f);if(v<1){let M=__dcg_shared_module_exports__.aa(u,[g+(_-g)/v,f+(w-f)/v],E,E>p?E:n.min,E<p?E:n.max,1);if(M){let C=ho(M[0],M[1]);(i==="bigup"||i==="bigdown")&&(C=p+(C-p)*5);let P=Ol(s,__dcg_shared_module_exports__.$(C,n.min,n.max),{ignoreSoftLimits:c}),[F,B]=u(P);__dcg_shared_module_exports__.S(F-g,B-f)>v&&(y=P)}}o&&(y=f$(e,al(s),y,d));let T=d(y);return{mathPoint:{x:T[0],y:T[1]},sliderUpdates:{[n.id]:{model:s,value:y}}}}function m$({controller:e,projection:t,transform:r,strategy:n,targetScreenPoint:i,clampToViewport:o}){let a={mathPoint:{},sliderUpdates:{}},s=e.getItemModel(n.id);if(!s||s.type!=="expression")throw new Error(`Programming error: updateSliderNonlinear move strategy should point to an expression item, but found ${s==null?void 0:s.type}`);n.compiled.fn||__dcg_shared_module_exports__.vc(n.compiled);let l=n.compiled.fn;r&&(l=v=>__dcg_shared_module_exports__.oc(r.forward,n.compiled.fn(v)));let c=v=>{let[T,M]=l(v);return{x:T,y:M}=t.mathToPixels.mapPoint({x:T,y:M}),[T,M]},d=n.initialValue,u=n.min,p=n.max,g=[i.x,i.y],f=__dcg_shared_module_exports__.aa(c,g,d,u,p,1);if(!f)return a;let y=ho(f[0],f[1]);u!==void 0&&y<u&&(y=u),p!==void 0&&y>p&&(y=p);let E=Ol(s,y,{ignoreSoftLimits:!0});o&&(E=f$(t,al(s),E,l));let[_,w]=l(E);return a.mathPoint.x=_,a.mathPoint.y=w,a.sliderUpdates[s.id]={value:E,model:s},a}function JO({controller:e,projection:t,transform:r,strategy:n,targetScreenPoint:i}){let o=t.reverse_map_pt(i);if(r){let d=__dcg_shared_module_exports__.oc(r.inverse,[o.x,o.y]);o={x:d[0],y:d[1]}}let a=n.type==="updateSliderForGlider"?{min:n.min,max:n.max}:void 0,s=$I(t,o,n.movesOn,a);if(!isFinite(s))return;let l=u$(n.movesOn,s),c={mathPoint:{x:l[0],y:l[1]},newPointLatex:void 0,sliderUpdates:{}};if(n.type==="updateGliderParameter"){let d=n.span;c.newPointLatex=d.input.slice(0,d.start)+__dcg_shared_module_exports__.ce(s)+d.input.slice(d.end)}else if(n.type==="updateSliderForGlider"){let d=e.getItemModel(n.id);d&&d.type==="expression"&&(c.sliderUpdates[d.id]={value:s,model:d})}return c}function f$(e,t,r,n){let i=d=>{let[u,p]=n(d);return e.mathToPixels.mapPoint({x:u,y:p})},o=({x:d,y:u})=>{let{left:p,right:g,top:f,bottom:y}=e.pixelCoordinates;return d>=p&&d<=g&&u>=f&&u<=y},a=t,s=i(t),l=r,c=i(r);if(o(c)||!o(s))return r;for(;;){let d=s.x-c.x,u=s.y-c.y;if(d*d+u*u<.5)break;let p=__dcg_shared_module_exports__._(a,l);if(p===a||p===l){[a,l]=o(s)?[a,a]:[l,l];break}let g=i(p);o(g)!==o(s)?[l,c]=[p,g]:[a,s]=[p,g]}return ho(a,l)}function QO({controller:e,projection:t,transform:r,formula:n,moveStrategy:i,dragMode:o,targetScreenPoint:a,clampToViewport:s}){if(r){let{x:g,y:f}=t.pixelsToMath.mapPoint(a),[y,E]=__dcg_shared_module_exports__.oc(r.inverse,[g,f]);a=t.mathToPixels.mapPoint({x:y,y:E})}let l=t.pixelsToMath.mapRect({left:a.x-.5,right:a.x+.5,top:a.y+.5,bottom:a.y-.5}),c=[{min:l.left,max:l.right},{min:l.top,max:l.bottom}],d={mathPoint:{},sliderUpdates:{}},[u,p]=i;if(u.type==="updateCoordinate"||p.type==="updateCoordinate"){let g=Ace(n,c,o);if(g){let{latex:f,x:y,y:E}=g;(y!==void 0||E!==void 0)&&(d.newPointLatex=f,d.mathPoint.x=y!=null?y:d.mathPoint.x,d.mathPoint.y=E!=null?E:d.mathPoint.y)}}for(let g of[0,1]){let f=i[g];if(F0(g,o)&&f.type==="updateSlider"){let y=e.getItemModel(f.id);if(!y||y.type!=="expression")continue;let[E,_]=f.coefficients,w=ho(_*c[g].min+E,_*c[g].max+E),v=Ol(y,w,{ignoreSoftLimits:!0}),T=(v-E)/_;if(!s||r){d.mathPoint[g===0?"x":"y"]=T,d.sliderUpdates[y.id]={value:v,model:y};continue}let[M,C]=g===0?[t.mathCoordinates.left,t.mathCoordinates.right]:[t.mathCoordinates.bottom,t.mathCoordinates.top],P=T<M?M:T>C?C:void 0;P!==void 0&&Rl(y)===void 0?(d.mathPoint[g===0?"x":"y"]=P,d.sliderUpdates[y.id]={value:_*P+E,model:y}):(d.mathPoint[g===0?"x":"y"]=T,d.sliderUpdates[y.id]={value:v,model:y})}}return d}function Ace(e,t,r){var n;if(!e.move_strategy)throw new Error("Programming error: expected move_strategy to be defined.");let i=ho(t[0].min,t[0].max),o=ho(t[1].min,t[1].max),[a,s]=e.move_strategy;if(((n=e.typed_constant_value)==null?void 0:n.valueType)===__dcg_shared_module_exports__.db&&a.type==="updateCoordinate"&&s.type==="updateCoordinate"){let[g,f]=e.typed_constant_value.value,y=F0(0,r),E=F0(1,r),_=y?i:g,w=E?o:f,v=a.inputSpan;return{latex:v.input.slice(0,v.start)+__dcg_shared_module_exports__.pa([_,w],{alwaysEmitImaginary:!0})+v.input.slice(v.end),x:y?i:void 0,y:E?o:void 0}}let l=!1,c=!1,d,u="",p=0;if(a.type==="updateCoordinate"&&F0(0,r)&&(d=a.inputSpan.input,l=!0,u+=d.slice(p,a.inputSpan.start),u+=__dcg_shared_module_exports__.ce(i),p=a.inputSpan.end),s.type==="updateCoordinate"&&F0(1,r)&&(d=s.inputSpan.input,c=!0,u+=d.slice(p,s.inputSpan.start),u+=__dcg_shared_module_exports__.ce(o),p=s.inputSpan.end),d!==void 0)return u+=d.slice(p),{latex:u,x:l?i:void 0,y:c?o:void 0}}function F0(e,t){switch(t){case"X":return e===0;case"Y":return e===1;case"XY":return!0;default:return!1}}function b$(e,t,r){r.forEach(n=>{Mce(e,t,n)})}function y$(e,t,r,n,i,o,a){var s;let l=!1,c=t.length===1,d=[];for(let u=0;u<t.length;u++){let p=t[u];if(p.tableInfo){Lce(e,p,n[u],i),l=!0;continue}let g=e.getItemModel(p.calcId);if(g){if(g.type==="image")l=l||Oce(e,g,p,n[u],i);else if(g.type==="expression"){let f=Rce({controller:e,movedExpr:g,dragMode:(s=Ro(g,{isReverseDrag:p.isReverseDrag}))!=null?s:"NONE",currentScreenPoint:r[u],targetScreenPoint:n[u],projection:i,transform:o&&o[u],isOnlyPoint:c,keyboardDirection:a});f&&d.push(f)}}}return l=l||h$(i,d),l}function x$(e,t){t.forEach(r=>{Gce(e)})}function Mce(e,t,r){if(r.tableInfo){Nr(t,void 0);let n=e.getItemModel(r.tableInfo.tableId);if(!n||n.type!=="table")return;RG(n,!0)}else{let n=e.getItemModel(r.calcId);if(!n||!(n.type==="expression"||n.type==="image")||!n.formula||!n.formula.move_strategy)return;let i=n.formula.move_strategy;for(let o=0;o<i.length;o++){let a=i[o];if(i[o].type==="updateCoordinate"||i[o].type==="updateGliderParameter")n.type==="image"?$G(n,!0):n.type==="expression"&&gL(n,!0);else if(a.type==="updateSlider"||a.type==="updateSliderNonlinear"||a.type==="updateSliderForGlider"){let s=e.getItemModel(a.id);if(!s||s.type!=="expression")continue;let l;if(n.type==="expression"?l=Ro(n,{isReverseDrag:r.isReverseDrag}):l=void 0,l==="NONE"||o===0&&l==="Y"||o===1&&l==="X")continue;Ww(s,!0)}}}}function Gce(e,t){for(let r of e.getAllItemModels())r.type==="table"?r.draggingOnGraphpaper&&RG(r,!1):r.type==="expression"?(r.sliderDragging&&Ww(r,!1),r.draggingOnGraphpaper&&gL(r,!1)):r.type==="image"&&r.draggingOnGraphpaper&&$G(r,!1)}function Lce(e,t,r,n){let i=t.tableInfo.tableId,o=t.tableInfo.rowIndex,a=t.tableInfo.columnId,s=t.tableInfo.dragX,l=t.tableInfo.dragY,c=e.getItemModel(i);if(!c||c.type!=="table")return;let d=Eo(c,a);if(!d)return;let u=n.closestPointOnScreen(r),p=n.pixelsToMath.mapRect(w$(u,.5)),g={x:__dcg_shared_module_exports__.be(ho(p.left,p.right)),y:__dcg_shared_module_exports__.be(ho(p.top,p.bottom))};if(s&&vp(c,{row:o+1,column:0},g.x),l){let f=d.index;vp(c,{row:o+1,column:f},g.y)}}function w$(e,t){return{left:e.x-t,right:e.x+t,top:e.y+t,bottom:e.y-t}}function Pce(e,t,r){if(r[0]===0&&r[1]===0)return{x:t.x,y:t.y,width:e.width,height:e.height};let n=Math.cos(e.radianAngle),i=Math.sin(e.radianAngle),o=t.x-e.x,a=t.y-e.y;if(r[0]===0)return{x:e.x,y:e.y,width:e.width,height:2*r[1]*(n*a+i*o)};if(r[1]===0)return{x:e.x,y:e.y,width:2*r[0]*(n*o-i*a),height:e.height};let s=2*(e.width*r[0]*(n*o-i*a)+e.height*r[1]*(i*o+n*a))/(e.width*e.width+e.height*e.height);return{x:e.x,y:e.y,width:s*e.width,height:s*e.height}}function Vce(e,t,r){let n=[{x:t.left,y:t.bottom},{x:t.left,y:t.top},{x:t.right,y:t.top},{x:t.right,y:t.bottom}],i=["x","y","width","height"],o={x:1/0,y:1/0,width:1/0,height:1/0},a={x:-1/0,y:-1/0,width:-1/0,height:-1/0};for(let s of n){let l=Pce(e,s,r);for(let c of i)o[c]=Math.min(o[c],l[c]),a[c]=Math.max(a[c],l[c])}return{min:o,max:a}}function N0(e){return e===void 0?NaN:e[0]}function Oce(e,t,r,n,i){var o;let a=t.formula;if(!a||((o=a.move_strategy)==null?void 0:o.length)!==4)return!1;let s=a.dimensions,l={x:N0(s.x),y:N0(s.y),width:N0(s.width),height:N0(s.height),radianAngle:N0(s.radianAngle)},c=r.scaleFactor||[0,0],d=c[0]!==0&&c[1]!==0,u=i.closestPointOnScreen(n),p=i.pixelsToMath.mapRect(w$(u,d?.05:.5)),g=Vce(l,p,c),f=i.mathToPixels.mapRect({left:l.x-.5*l.width,right:l.x+.5*l.width,top:l.y-.5*l.height,bottom:l.y+.5*l.height}),y=Math.abs(f.right-f.left),E=Math.abs(f.bottom-f.top),_=i.mathToPixels.mapRect({left:g.min.x-.5*g.min.width,right:g.min.x+.5*g.min.width,top:g.min.y-.5*g.min.height,bottom:g.min.y+.5*g.min.height}),w=Math.abs(_.right-_.left),v=Math.abs(_.bottom-_.top);if(w<y&&w<1||v<E&&v<1)return!1;let T=["width","height","x","y"],M=!1;for(let C=0;C<T.length;C++){let P=T[C],F=a.move_strategy[C];switch(F.type){case"updateCoordinate":let B=ho(g.min[P],g.max[P]),x=F.inputSpan.input,L=__dcg_shared_module_exports__.be(B);switch(P){case"width":case"height":ks(t,P,L);break;case"x":if(a.move_strategy[3].type==="updateCoordinate"){let N=a.move_strategy[3],O=ho(g.min.y,g.max.y),z=__dcg_shared_module_exports__.be(O),V=x.slice(0,F.inputSpan.start)+L+x.slice(F.inputSpan.end,N.inputSpan.start)+z+x.slice(N.inputSpan.end);ks(t,"center",V)}else{let N=x.slice(0,F.inputSpan.start)+L+x.slice(F.inputSpan.end);ks(t,"center",N)}break;case"y":if(a.move_strategy[2].type!=="updateCoordinate"){let N=x.slice(0,F.inputSpan.start)+L+x.slice(F.inputSpan.end);ks(t,"center",N)}break;default:return P}M=!0;break;case"updateSlider":{let N=e.getItemModel(F.id);if(!N||N.type!=="expression")continue;let O=F.coefficients[0],z=F.coefficients[1],V=z*g.min[P]+O,$=z*g.max[P]+O,G=ho(V,$),W=N.latex;QE(N,G),N.latex!==W&&(M=!0)}break}}return M}function Rce({controller:e,movedExpr:t,dragMode:r,currentScreenPoint:n,targetScreenPoint:i,projection:o,transform:a,isOnlyPoint:s,keyboardDirection:l}){var c,d;let u=t.formula;if(!u||((c=u.move_strategy)==null?void 0:c.length)!==2)return;let[p,g]=u.move_strategy;if(s&&p.type==="updateCoordinate"&&g.type==="updateCoordinate"){let E=o.reverse_map_pt(i),_=ZO(o,E);_&&(i=o.map_pt(_))}let f=s?o.closestPointOnScreen(i):i;if(!l){let E;switch(p.type){case"updateSliderNonlinear":E=m$({controller:e,projection:o,transform:a,strategy:p,targetScreenPoint:f,clampToViewport:s});break;case"updateGliderParameter":case"updateSliderForGlider":E=JO({controller:e,projection:o,transform:a,strategy:p,targetScreenPoint:f});break;default:E=QO({controller:e,projection:o,transform:a,formula:u,moveStrategy:u.move_strategy,dragMode:r,targetScreenPoint:f,clampToViewport:s})}return E&&ie(R({},E),{commitSliderSoftLimits:!1,transform:a,model:t})}let y;if(p.type==="updateSliderNonlinear"){if(!(l!=null&&l.x))return;y=g$({projection:o,transform:a,controller:e,strategy:p,mode:l.x,clampToViewport:s})}else if(p.type==="updateGliderParameter"||p.type==="updateSliderForGlider")y=JO({controller:e,projection:o,transform:a,strategy:p,targetScreenPoint:f});else{let E=l.x?0:1,_=l.x?f.x-n.x:f.y-n.y,w=u.move_strategy[E];if(w.type==="updateSlider"){let v=e.getItemModel(w.id);if((v==null?void 0:v.type)!=="expression")throw new Error(`Programming error: updateSlider move strategy should point to an expression item, but found ${v==null?void 0:v.type}`);let T=Rl(v);if(T){let M=o.mathToPixels.mapPoint({x:0,y:0}),C=w.coefficients[1],P=Math.abs(E===0?o.mathToPixels.mapX(T/C)-M.x:o.mathToPixels.mapY(T/C)-M.y),F=Math.ceil(1/P);_=P*F*(_>0?1:-1);let B=(d=l.x)!=null?d:l.y;(B==="bigup"||B==="bigdown")&&(_*=5)}}y=QO({controller:e,projection:o,transform:a,formula:u,moveStrategy:u.move_strategy,dragMode:r,targetScreenPoint:{x:n.x+(E===0?_:0),y:n.y+(E===1?_:0)},clampToViewport:s})}return y&&ie(R({},y),{commitSliderSoftLimits:!0,transform:a,model:t})}function ZO(e,t){if(!e.settings.showGrid)return;let r=gl(e),n=r.minorStepX,i=r.minorStepY,o=e.map_pt(t),a=Math.round(t.x/n)*n,s=Math.round(t.y/i)*i,l=5,c={x:a,y:s},d=e.map_pt(c);if(__dcg_shared_module_exports__.S(d.x-o.x,d.y-o.y)<=l)return c}function Fce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Nce="ID_",U0=function(){function e(){Fce(this,e),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}return e.prototype.register=function(t){var r=Nce+this._lastID++;return this._callbacks[r]=t,r},e.prototype.unregister=function(t){this._callbacks[t]||B0(!1,"Dispatcher.unregister(...): `%s` does not map to a registered callback.",t),delete this._callbacks[t]},e.prototype.waitFor=function(t){this._isDispatching||B0(!1,"Dispatcher.waitFor(...): Must be invoked while dispatching.");for(var r=0;r<t.length;r++){var n=t[r];if(this._isPending[n]){this._isHandled[n]||B0(!1,"Dispatcher.waitFor(...): Circular dependency detected while waiting for `%s`.",n);continue}this._callbacks[n]||B0(!1,"Dispatcher.waitFor(...): `%s` does not map to a registered callback.",n),this._invokeCallback(n)}},e.prototype.dispatch=function(t){this._isDispatching&&B0(!1,"Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch."),this._startDispatching(t);try{for(var r in this._callbacks)this._isPending[r]||this._invokeCallback(r)}finally{this._stopDispatching()}},e.prototype.isDispatching=function(){return this._isDispatching},e.prototype._invokeCallback=function(t){this._isPending[t]=!0,this._callbacks[t](this._pendingPayload),this._isHandled[t]=!0},e.prototype._startDispatching=function(t){for(var r in this._callbacks)this._isPending[r]=!1,this._isHandled[r]=!1;this._pendingPayload=t,this._isDispatching=!0},e.prototype._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},e}();function B0(e,t,r,n,i,o,a,s){if(t===void 0)throw new Error("invariant requires an error message argument");{var l;if(t===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[r,n,i,o,a,s],d=0;l=new Error(t.replace(/%s/g,function(){return c[d++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}}Ss();function Fc(e){return __dcg_shared_module_exports__.D(e)}function Nc(e){this.setState(e)}Nc.prototype.setState=function(e){this.state=e},Nc.prototype.getState=function(){return this.state},Nc.prototype.set=function(e,t){if(arguments.length===1){this.state=e;return}else if(typeof e=="string"){this.state=Fc(this.state),this.state[e]=t;return}let r=e.length-2,n=e[r+1],i;this.state=i=Fc(this.state);for(let o=0;o<=r;o++){let a=e[o];i=i[a]=Fc(i[a])}i[n]=t},Nc.prototype.deepMutate=function(e,t){if(arguments.length===1){t=e,this.state=__dcg_shared_module_exports__.Jc(this.state),t(this.state);return}else if(typeof e=="string"){this.state=Fc(this.state),this.state[e]=__dcg_shared_module_exports__.Jc(this.state[e]),t(this.state[e]);return}let r=e.length-2,n=e[r+1],i=this.state=Fc(this.state);for(let o=0;o<=r;o++){let a=e[o];i=i[a]=Fc(i[a])}i=i[n]=__dcg_shared_module_exports__.Jc(i[n]),t(i)},Nc.prototype.shallowMutate=function(e,t){if(arguments.length===1){t=e,this.state=Fc(this.state),t(this.state);return}else if(typeof e=="string"){this.state=Fc(this.state),this.state[e]=Fc(this.state[e]),t(this.state[e]);return}let r=e.length-1,n=this.state=Fc(this.state);for(let i=0;i<=r;i++){let o=e[i];n=n[o]=Fc(n[o])}t(n)},Nc.areShallowEqual=function(e,t){},Nc.areDeepEqual=function(e,t){};var v$=[{key:"compass",objects:"Segment + Point"},{key:"midpoint",objects:"Segment"},{key:"parallel",objects:"Line + Point"},{key:"perpendicular",objects:"Line + Point"},{key:"image",objects:"2 Points"}];function Bce(e,t){var r;if(t.typedRuntimeValue.valueType===__dcg_shared_module_exports__.Za||t.typedRuntimeValue.valueType===__dcg_shared_module_exports__._a)return[];let n=t.data.call;if(!n||!n.parents)return[];let i=n.symbol,o=n.parents.map(tx),a;switch(i){case"circle":{let[s,l]=o,c=l&&((r=e[l])==null?void 0:r.typedRuntimeValue.valueType);c&&__dcg_shared_module_exports__.Ab(c,__dcg_shared_module_exports__.La)?a=[s]:a=[s,l];break}case"apply":{a=[o[1]];break}case"parallel":case"perpendicular":{a=[o[1]];break}case"polygon":{a=o.every(s=>s!==void 0)?o:[];break}default:a=o}return a.filter(S$)}var Uce=[[1,0],[0,0],!1],z0=class Nl{constructor(t,r){let n=(t==null?void 0:t.list)||[];r&&(n=n.concat(r)),this.list=n;let i=(t==null?void 0:t.forward)||Uce;r&&(i=__dcg_shared_module_exports__.mc(i,r.value)),this.forward=i,this.inverse=__dcg_shared_module_exports__.nc(i)}add(t){return new Nl(this,t)}equals(t){if(this.list.length!==t.list.length)return!1;for(let r=this.list.length-1;r>=0;r--){let n=this.list[r],i=t.list[r];if(!__dcg_shared_module_exports__.E(n,i))return!1}return!0}isCompletelyRigid(){return this.list.length===0}};z0.COMPLETELY_RIGID=new z0(void 0);var jI=z0;function zce(e){var t,r;let n={},i={};for(let o in e){let a=e[o];if(!a)continue;for(let l of((t=a.data.call)==null?void 0:t.parents)||[]){let c=tx(l);c&&(n[c]||(n[c]=[]),(r=n[c])==null||r.push(a.assignment))}let s=Bce(e,a);i[a.assignment]=s}return{parentToChildren:n,childToReversibilityParents:i}}function C$(e){let t=[],r={};function n(i){var o;r[i]!==2&&(r[i]=1,(o=e[i])==null||o.forEach(n),r[i]=2,t.unshift(i))}for(let i in e)r[i]===void 0&&n(i);return t}function eR(e,t){var r,n,i,o,a,s,l,c,d,u;let p={},g={},f={},y={},E={};for(let M of t)E[M]=!0,f[M]=jI.COMPLETELY_RIGID;let{parentToChildren:_,childToReversibilityParents:w}=zce(e);for(let M of C$(w)){let C=e[M];if(!C)continue;let P=(r=C.data.call)==null?void 0:r.symbol,F=(((n=C.data.call)==null?void 0:n.parents)||[]).map(tx).filter(S$);if(f[C.assignment])if(C.typedRuntimeValue.valueType===__dcg_shared_module_exports__.ya&&!P)p[C.assignment]=f[C.assignment];else if(P==="glider"&&F.length&&!E[F[0]])g[C.assignment]=f[C.assignment];else{let B=f[C.assignment];if(P==="apply"){let L=(i=e[F[0]])==null?void 0:i.typedRuntimeValue;if((L==null?void 0:L.valueType)===__dcg_shared_module_exports__._a)return{};if((L==null?void 0:L.valueType)!==__dcg_shared_module_exports__.Za)continue;B=B.add(L)}let x=(o=w[C.assignment])!=null?o:[];for(let L of x)f[L]?B.equals(f[L])||(f[L]=jI.COMPLETELY_RIGID,y[L]=!0):f[L]=B}}let v={};for(let M in f)v[M]=!0;for(let M of C$(_))if(v[M]){for(let C of _[M]||[])v[C]=!0;if(f[M]){let C=w[M]||[];for(let P of C)y[P]&&(y[M]=!0)}}for(let M in g){let C=(((s=(a=e[M])==null?void 0:a.data.call)==null?void 0:s.parents)||[]).map(tx)[0];C&&v[C]&&(y[C]=!0)}for(let M in e){if(!v[M])continue;let C=e[M],P=(l=C==null?void 0:C.data.call)==null?void 0:l.symbol,F=(((c=C==null?void 0:C.data.call)==null?void 0:c.parents)||[]).map(tx);if(P==="apply"&&f[M]){let B=F[1],x=F[0];if(!B||!x)continue;let L=(((u=(d=e[x])==null?void 0:d.data.call)==null?void 0:u.parents)||[]).map(tx),N=L.some(O=>O&&v[O]);if(f[M].isCompletelyRigid()&&(!(B in f)||f[B].isCompletelyRigid())||N){y[B]=!0;for(let O of L)O&&(y[O]=!0)}}}let T=[];for(let M in y)E[M]||T.push(M);return T.length?eR(e,t.concat(T)):R(R({},p),g)}function tx(e){if(e.type==="arbitrary-expression")return;let t=__dcg_shared_module_exports__.Cc(e);return t?__dcg_shared_module_exports__.ma(t):void 0}function S$(e){return e!==void 0}var q0=class{constructor(){this._nextId=0,this._defs={}}clear(){this._nextId=0,this._defs={}}add(e,t){let r;t?(r=e.assignment,e.listIndex!==void 0&&(r+="\\left["+e.listIndex+"\\right]")):r="**geo-internal-id-"+this._nextId++,this._defs[r]=e}computeReversibilityLineages(e){var t;let r=this.buildAssignmentMap(),n={};for(let s in r){let l=r[s];l&&(n[l.calcId]=l)}let i=[];for(let s of e){let l=n[s];if(!l)return{};i.push(l.assignment)}let o=eR(this.buildAssignmentMap(),i),a={};for(let s in o){let l=(t=r[s])==null?void 0:t.calcId;l&&(a[l]=o[s])}return a}buildAssignmentMap(){let e={};for(let t in this._defs){let r=this._defs[t];r&&(e[r.assignment]=r)}return e}getDepthValues(){let e={},t={},r=this.buildAssignmentMap();for(let s in r){let l=r[s];if(!l)continue;let c=__dcg_shared_module_exports__.na(l.assignment),d=[];for(let u of l.data.parentDependencies)d.push(u),t[u]||(t[u]=[]),t[u].push(c);e[c]=d}let n={},i=s=>{if(n[s]!==void 0)return n[s];if(n[s]===-1)return n[s]=0,0;n[s]=-1;let l=-1,c=e[s]||[];for(let u=0;u<c.length;u++){let p=i(c[u]);p>l&&(l=p)}let d=l+1;return n[s]=d,d};for(let s in e)n[s]===void 0&&i(s);let o={},a={};for(let s in t){let l=n[s],c=1/0;t[s].forEach(d=>{let u=n[d];u>l&&(l=u),u<c&&(c=u)}),o[s]=l,a[s]=c}return{createdDepth:n,lastReferencedDepth:o,firstReferencedDepth:a}}};function Dm(e){return e?!!(qce(e)&&e!=="Vector"||e==="Circle"||e==="Arc"||e==="Polygon"):!1}function qce(e){if(!e)return!1;switch(e){case"Line":case"Ray":case"Vector":case"Segment":return!0}return!1}function D$(e,t){let r={i:0,x:NaN,y:NaN},n={i:1,x:NaN,y:NaN};if(!e||!t)return[r,n];let i=E$(e.typedRuntimeValue),o=E$(t.typedRuntimeValue);if(!i||!o)return[r,n];let a=T$(i,o);return r.x=a[0],r.y=a[1],a=T$(o,i),n.x=a[0],n.y=a[1],[r,n]}function E$(e){switch(e.valueType){case __dcg_shared_module_exports__.La:case __dcg_shared_module_exports__.Ra:case __dcg_shared_module_exports__.Ta:return{type:"straight",def:e.value};case __dcg_shared_module_exports__.$a:return{type:"straight",def:nm(e.value)};case __dcg_shared_module_exports__.Na:return{type:"circle",def:e.value};case __dcg_shared_module_exports__.Pa:return{type:"arc",def:e.value}}}function T$(e,t){switch(e.type){case"straight":switch(t.type){case"straight":return __dcg_shared_module_exports__.fc(e.def,t.def);case"circle":return __dcg_shared_module_exports__.dc(e.def,t.def);case"arc":return __dcg_shared_module_exports__.hc(e.def,t.def)}case"circle":switch(t.type){case"straight":return __dcg_shared_module_exports__.ec(e.def,t.def);case"circle":return __dcg_shared_module_exports__.cc(e.def,t.def);case"arc":return __dcg_shared_module_exports__.gc(e.def,t.def)}case"arc":switch(t.type){case"straight":return __dcg_shared_module_exports__.jc(e.def,t.def);case"circle":return __dcg_shared_module_exports__.ic(e.def,t.def);case"arc":return __dcg_shared_module_exports__.kc(e.def,t.def)}}return[NaN,NaN]}var Rh=class extends _c{constructor(e){super(e),this.model=e,this.displayName="graphing-calculator-text-geometry-tool-expression-edit-display-name",this.toolType="custom",this.toolName="expression-edit"}getHint(){let e=this.model.controller.getValidCursorContext();if((e==null?void 0:e.type)!=="expression-arguments"||!e.functionSymbol)return this.getGenericHint();let t=this.model.getTool(e.functionSymbol);if(!t)return this.getGenericHint();let r=e.argIndex;if(e.positionWithinArg==="end"&&(r+=1),t.toolType==="transformation"){if(e.argCount===0)return Ls("graphing-calculator-text-geometry-tool-expression-edit-starting-transformation-hint");r>0&&(r-=1)}return t.getExpressionEditHint(r)}getGenericHint(){let e=this.getAllValidNextInputTypes();if(e.some(r=>r===__dcg_shared_module_exports__.va||r===__dcg_shared_module_exports__.Aa))return Ls("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-any-object");let t=e.filter(r=>!(__dcg_shared_module_exports__.wb(r)&&e.find(n=>__dcg_shared_module_exports__.xb(r)===n))).map(r=>Fl(__dcg_shared_module_exports__.vb(r),Zw()));return t.length===0?Ls("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-0"):t.length===1?Ls("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-1",{type:t[0]}):t.length===2?Ls("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-2",{type1:t[0],type2:t[1]}):Ls("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-many",{types:Cd(jL(),t)})}getExpressionEditHint(e){return this.getHint()}getSpec(){let e=this.model.controller.getSelectedItem(),t=tR(this.model.controller.getValidCursorContext());return!t||!e||e.type!=="expression"?{inputs:[],outputs:[]}:{inputs:[{type:"union",valueTypes:t,id:"1"}],outputs:[{type:"expression-edit-preview-latex",rhsLatex:this.buildPreviewLatex(),hidden:!1,color:e.color,id:"2",parents:[]}]}}onMove(e){super.onMove(e);let{idMap:t,inputIndex:r}=this.model.getNonObjectsState().ui.currentTool,n=this.getSpec().inputs[r];return!!(n&&t[n.id])}buildPreviewLatex(){let e="",t="",r=this.model.controller.getValidCursorContext(),n=(r==null?void 0:r.type)==="permissive"?r.cursorContext:r;if((n==null?void 0:n.type)==="empty")return"";(n==null?void 0:n.type)==="expression-arguments"&&((n==null?void 0:n.positionWithinArg)==="end"?e=",":(n==null?void 0:n.positionWithinArg)==="start"&&(t=","));let i=this.model.getNonObjectsState().ui.currentTool.idMap[1];if(!i)return"";let o=this.model.controller.getSelectedItem();if((o==null?void 0:o.type)!=="expression")return"";let a=Fe.getFocusedMathquill(),s=a==null?void 0:a.selection();if((s==null?void 0:s.latex)!==o.latex)return"";let l=o.latex.slice(0,s.startIndex)+e+i+t+o.latex.slice(s.endIndex);return pi(o)?l.slice(o.latex.indexOf("=")+1):l}canNextInputBePoint(){let e=this.model.controller.getValidCursorContext();if((e==null?void 0:e.type)!=="expression-arguments"||e.expressionType!=="FunctionCall"&&e.expressionType!=="List")return!1;let t=tR(e);if(!t)return!1;let r=!1;for(let n of t){if(__dcg_shared_module_exports__.Ab(n,__dcg_shared_module_exports__.va))return!1;__dcg_shared_module_exports__.Ab(n,__dcg_shared_module_exports__.ya)&&(r=!0)}return r}shouldHighlightRelevantObjects(){let e=this.model.controller.getValidCursorContext();if((e==null?void 0:e.type)==="empty"||(e==null?void 0:e.type)==="permissive")return!1;let t=tR(e);return!(!t||t.some(r=>__dcg_shared_module_exports__.Ab(r,__dcg_shared_module_exports__.va))||t.every(r=>__dcg_shared_module_exports__.Ab(r,__dcg_shared_module_exports__.wa)||__dcg_shared_module_exports__.Ab(r,__dcg_shared_module_exports__.Va)||__dcg_shared_module_exports__.Ab(r,__dcg_shared_module_exports__.Xa)))}};function tR(e){if((e==null?void 0:e.type)==="permissive")return[__dcg_shared_module_exports__.va];if((e==null?void 0:e.type)==="empty")return[__dcg_shared_module_exports__.Va,__dcg_shared_module_exports__.Xa,__dcg_shared_module_exports__.Wa,__dcg_shared_module_exports__.Ya,__dcg_shared_module_exports__.$a];if((e==null?void 0:e.type)==="expression-arguments"&&e.expressionType==="FunctionCall"&&e.functionSymbol&&!__dcg_shared_module_exports__.qc[e.functionSymbol])return;let t=(e==null?void 0:e.type)==="expression-arguments"?e.allowedTypesForInsertedArg:e==null?void 0:e.allowedTypes;return t==null?void 0:t.filter(r=>!__dcg_shared_module_exports__.Ab(r,__dcg_shared_module_exports__.hb))}var rR="graphing-calculator-text-geometry-tool-angle-hint-1",oR="graphing-calculator-text-geometry-tool-angle-hint-2",iR="graphing-calculator-text-geometry-tool-angle-hint-3",nR="graphing-calculator-text-geometry-tool-angles-hint-1",Hce={name:"angle",displayName:"graphing-calculator-text-geometry-tool-angle-display-name",toolType:"complex",icon:[{type:"stroked-path",path:[40,30,30,70,70,70],color:"#bbb"},{type:"angle",x:30,y:70,radius:20,startAngle:-1.325817,deltaAngle:1.325817,isDirected:!1},{type:"point",x:30,y:70},{type:"point",x:40,y:30},{type:"point",x:70,y:70}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__.ya,__dcg_shared_module_exports__.ya,__dcg_shared_module_exports__.ya],hints:[rR,oR,iR]},output:[{type:"angle",parents:[0,1,2]}]},{input:{broadcast:!1,types:[__dcg_shared_module_exports__.Ja],hints:[nR]},output:({inputs:e})=>{if(e.length!==1||e[0].valueType!==__dcg_shared_module_exports__.Ja)throw new Error(`Programming error: expected a single polygon input, got ${JSON.stringify(e)}`);return e[0].value.map((t,r)=>({type:"polygon-angle",angleIndex:r+1,parents:[0]}))}}]},H0=class extends Vr{constructor(e){super(e,Hce),this.model=e}},Kce="graphing-calculator-text-geometry-tool-angle-bisector-hint-angle",Wce={name:"anglebisector",displayName:"graphing-calculator-text-geometry-tool-angle-bisector-display-name",toolType:"complex",icon:[{type:"stroked-path",color:"#ccc",path:[40,30,30,70,70,70]},{type:"angle",x:30,y:70,radius:20,startAngle:-1.325817,deltaAngle:1.325817,isDirected:!1},{type:"stroked-path",lineWidth:"large",path:[31,69,70,38.8]}],workflows:[{input:{broadcast:!1,types:[__dcg_shared_module_exports__.sb.of([__dcg_shared_module_exports__.Va,__dcg_shared_module_exports__.Xa])],hints:[Kce]},output:[{type:"anglebisector",parents:[0]}]}]},K0=class extends Vr{constructor(e){super(e,Wce),this.model=e}},$ce="graphing-calculator-text-geometry-tool-arc-hint-1",jce="graphing-calculator-text-geometry-tool-arc-hint-2",Yce="graphing-calculator-text-geometry-tool-arc-hint-3",km=50,YI=80,XI=80,aR=-3,k$=-2.6,sR=-1.7,Xce=[{type:"arc",x:YI,y:XI,radius:km,startAngle:aR,endAngle:sR},{type:"point",x:YI+km*Math.cos(aR),y:XI+km*Math.sin(aR)},{type:"point",x:YI+km*Math.cos(k$),y:XI+km*Math.sin(k$)},{type:"point",x:YI+km*Math.cos(sR),y:XI+km*Math.sin(sR)}],Jce={name:"arc",displayName:"graphing-calculator-text-geometry-tool-arc-display-name",toolType:"complex",icon:Xce,workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__.ya,__dcg_shared_module_exports__.ya,__dcg_shared_module_exports__.ya],hints:[$ce,jce,Yce]},output:[{type:"arc",parents:[0,1,2]}]}]},W0=class extends Vr{constructor(e){super(e,Jce),this.model=e}},Qce="graphing-calculator-text-geometry-tool-circle-hint-center",Zce="graphing-calculator-text-geometry-tool-circle-hint-radius",ede={name:"circle",displayName:"graphing-calculator-text-geometry-tool-circle-display-name",toolType:"simple",icon:[{type:"circle",x:50,y:50,radius:26},{type:"point",x:50,y:50},{type:"point",x:68,y:32}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__.ya,__dcg_shared_module_exports__.ya],hints:[Qce,Zce]},output:[{type:"circle",parents:[0,1]}]}]},$0=class extends Vr{constructor(e){super(e,ede),this.model=e}},tde="graphing-calculator-text-geometry-tool-compass-hint-segment",rde="graphing-calculator-text-geometry-tool-compass-hint-center",ode={name:"compass",displayName:"graphing-calculator-text-geometry-tool-circle-by-length-display-name",toolType:"complex",icon:[{type:"ellipse",x:50,y:65,rx:26,ry:11,color:__dcg_shared_module_exports__.Rd.GRAY,lineWidth:2},{type:"stroked-path",path:[50,65,78,65]},{type:"stroked-path",path:[50,65,62,36],lineWidth:"large",color:e=>__dcg_shared_module_exports__.Kd(e.circle,.3)},{type:"stroked-path",path:[78,65,66,36],lineWidth:"large",color:e=>__dcg_shared_module_exports__.Kd(e.circle,.3)},{type:"circle",radius:6,x:64,y:31,lineWidth:5,color:e=>__dcg_shared_module_exports__.Kd(e.circle,.3)},{type:"stroked-path",path:[64,24,64,18],lineWidth:"large",color:e=>__dcg_shared_module_exports__.Kd(e.circle,.3)},{type:"point",x:50,y:65},{type:"point",x:78,y:65}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__.La,__dcg_shared_module_exports__.ya],hints:[tde,rde]},output:[{type:"circle",parents:[1,0]}]}]},j0=class extends Vr{constructor(e){super(e,ode),this.model=e}},_$="graphing-calculator-text-geometry-tool-dilation-hint-center",I$="graphing-calculator-text-geometry-tool-dilation-hint-scale-factor",Y0=class extends Ic{constructor(e){super(e),this.model=e,this.displayName="graphing-calculator-text-geometry-tool-dilate-display-name",this.toolName="dilation",this.toolType="transformation"}getExpressionEditHint(e){return e===0?this.s(_$):this.s(I$)}getSpecIdToLockIn(e,t){return t===1?"2-number":super.getSpecIdToLockIn(e,t)}getSpec(){return{inputs:[{type:"point",id:"1",hint:_$},{type:"union",valueTypes:[],id:"2",hint:I$,numberInputInfo:{defaultLatex:"2",sliderInfo:{value:"2",min:"0",max:"5"}}}],outputs:[{id:"3",type:"dilate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2-number"}]}]}}},ide={name:"directedangle",displayName:"graphing-calculator-text-geometry-tool-directedangle-display-name",toolType:"complex",icon:[{type:"stroked-path",path:[40,30,30,70,70,70],color:"#bbb"},{type:"angle",x:30,y:70,radius:20,isDirected:!0,startAngle:-1.325817,deltaAngle:1.325817},{type:"stroked-path",path:[35,50,41,50,37,55,35,50],color:"#000",lineWidth:"medium"},{type:"point",x:30,y:70},{type:"point",x:40,y:30},{type:"point",x:70,y:70}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__.ya,__dcg_shared_module_exports__.ya,__dcg_shared_module_exports__.ya],hints:[rR,oR,iR]},output:[{type:"directedangle",parents:[0,1,2]}]},{input:{broadcast:!1,types:[__dcg_shared_module_exports__.Ja],hints:[nR]},output:({inputs:e})=>{if(e.length!==1||typeof e[0]!="object"||e[0].valueType!==__dcg_shared_module_exports__.Ja)throw new Error(`Programming error: expected a single polygon input, got ${JSON.stringify(e)}`);return e[0].value.map((t,r)=>({type:"polygon-directedangle",angleIndex:r+1,parents:[0]}))}}]},X0=class extends Vr{constructor(e){super(e,ide),this.model=e}},nde="graphing-calculator-text-geometry-tool-line-hint-start",ade="graphing-calculator-text-geometry-tool-line-hint-end",sde={name:"line",displayName:"graphing-calculator-text-geometry-tool-line-display-name",toolType:"simple",icon:[{type:"stroked-path",path:[78,22,22,78],lineWidth:"large"},{type:"point",x:68,y:32},{type:"point",x:32,y:68}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__.ya,__dcg_shared_module_exports__.ya],hints:[nde,ade]},output:[{type:"line",parents:[0,1]}]}]},J0=class extends Vr{constructor(e){super(e,sde),this.model=e}},A$="graphing-calculator-text-geometry-tool-midpoint-hint",lde={name:"midpoint",displayName:"graphing-calculator-text-geometry-tool-midpoint-display-name",toolType:"simple",icon:[{type:"stroked-path",path:[32,32,68,68]},{type:"point",x:50,y:50,size:"large"},{type:"point",x:32,y:32,size:"medium"},{type:"point",x:68,y:68,size:"medium"}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__.ya,__dcg_shared_module_exports__.ya],hints:[A$]},output:[{type:"midpoint",parents:[0,1]}]},{input:{broadcast:!0,types:[__dcg_shared_module_exports__.La],hints:[A$]},output:[{type:"midpoint",parents:[0]}]}]},Q0=class extends Vr{constructor(e){super(e,lde),this.model=e}},cde="graphing-calculator-text-geometry-tool-parallel-hint-straight-line",dde="graphing-calculator-text-geometry-tool-parallel-hint-point",pde={name:"parallel",displayName:"graphing-calculator-text-geometry-tool-parallel-display-name",toolType:"complex",icon:[{type:"stroked-path",color:"light",path:[25,50,75,30],lineWidth:"large"},{type:"stroked-path",path:[25,70,75,50],lineWidth:"large"},{type:"point",x:50,y:60,size:"medium"}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__.zb,__dcg_shared_module_exports__.ya],hints:[cde,dde]},output:[{type:"parallel",parents:[0,1]}]}]},Z0=class extends Vr{constructor(e){super(e,pde),this.model=e}},ude="graphing-calculator-text-geometry-tool-perpendicular-hint-straight-line",hde="graphing-calculator-text-geometry-tool-perpendicular-hint-point",gde={name:"perpendicular",displayName:"graphing-calculator-text-geometry-tool-perpendicular-display-name",toolType:"complex",icon:[{type:"stroked-path",color:"light",path:[40,25,60,75],lineWidth:"large"},{type:"stroked-path",path:[25,60,75,40],lineWidth:"large"},{type:"point",x:50,y:50,size:"medium"}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__.zb,__dcg_shared_module_exports__.ya],hints:[ude,hde]},output:[{type:"perpendicular",parents:[0,1]}]}]},e1=class extends Vr{constructor(e){super(e,gde),this.model=e}},mde="graphing-calculator-text-geometry-tool-point-hint",fde={name:"point",displayName:"graphing-calculator-text-geometry-tool-point-display-name",toolType:"simple",icon:[{type:"point",x:50,y:50,size:"large"}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__.ya],hints:[mde]},output:[]}]},t1=class extends Vr{constructor(e){super(e,fde),this.model=e}},bde="graphing-calculator-text-geometry-tool-polygon-hint-first-point",yde="graphing-calculator-text-geometry-tool-polygon-hint-next-point",xde="graphing-calculator-text-geometry-tool-polygon-hint-finish-point",wde={name:"polygon",displayName:"graphing-calculator-text-geometry-tool-polygon-display-name",toolType:"complex",icon:[{type:"filled-polygon",path:[55,30,30,30,35,70,70,60,55,30]},{type:"stroked-path",path:[55,30,30,30,35,70,70,60,55,30]},{type:"point",x:55,y:30},{type:"point",x:30,y:30},{type:"point",x:35,y:70},{type:"point",x:70,y:60}],isDegenerateInput:({previousInputs:e,proposedInput:t})=>!!(e.length===1&&__dcg_shared_module_exports__.E(e[0],t)),workflows:[{input:{broadcast:!0,types:{type:"variadic",initial:[__dcg_shared_module_exports__.ya,__dcg_shared_module_exports__.ya],rest:__dcg_shared_module_exports__.ya},hints:e=>e===0?bde:e<3?yde:xde},output:({inputs:e,isCommitting:t})=>((t||__dcg_shared_module_exports__.E(e[e.length-1],e[e.length-2]))&&(e=e.slice(0,-1)),[{type:"polygon",hidden:!1,parents:e.map((r,n)=>n)}]),canCommit:e=>{if(e.length<2)return!1;let t=e[e.length-1],r=e[e.length-2],n=e[0];return __dcg_shared_module_exports__.E(t,n)||__dcg_shared_module_exports__.E(t,r)}}]},r1=class extends Vr{constructor(e){super(e,wde),this.model=e}},vde="graphing-calculator-text-geometry-tool-ray-hint-start",Cde="graphing-calculator-text-geometry-tool-ray-hint-end",Sde={name:"ray",displayName:"graphing-calculator-text-geometry-tool-ray-display-name",toolType:"simple",icon:[{type:"stroked-path",path:[78,22,32,68],lineWidth:"large"},{type:"point",x:68,y:32},{type:"point",x:32,y:68}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__.ya,__dcg_shared_module_exports__.ya],hints:[vde,Cde]},output:[{type:"ray",parents:[0,1]}]}]},o1=class extends Vr{constructor(e){super(e,Sde),this.model=e}},M$="graphing-calculator-text-geometry-tool-reflection-hint-choose-line",i1=class extends Ic{constructor(e){super(e),this.model=e,this.displayName="graphing-calculator-text-geometry-tool-reflect-display-name",this.toolName="reflection",this.toolType="transformation"}getExpressionEditHint(e){return this.s(M$)}getSpec(){return{inputs:[{type:"straight",id:"1",hint:M$}],outputs:[{id:"2",type:"reflect",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"}]}]}}},Ede="graphing-calculator-text-geometry-tool-segment-hint-start",Tde="graphing-calculator-text-geometry-tool-segment-hint-end",Dde={name:"segment",displayName:"graphing-calculator-text-geometry-tool-segment-display-name",toolType:"simple",icon:[{type:"stroked-path",path:[68,32,32,68],lineWidth:"large"},{type:"point",x:68,y:32},{type:"point",x:32,y:68}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__.ya,__dcg_shared_module_exports__.ya],hints:[Ede,Tde]},output:[{type:"segment",parents:[0,1]}]}]},n1=class extends Vr{constructor(e){super(e,Dde),this.model=e}},a1=class{constructor(){this.displayName="graphing-calculator-text-geometry-tool-selection-display-name",this.toolType="selection",this.icon=[{type:"filled-polygon",color:"#000",path:[40,30,58,46,51,47,56,60,53,62,47,49,41,54,40,30]}]}getNumberInputLatex(){return""}clearTentativeOutputs(){}canNextInputBePoint(){return!1}getAllValidNextInputTypes(){return __dcg_shared_module_exports__.tb.filter(e=>this.isValidNextInputType(e))}isValidNextInputType(e){return e!==__dcg_shared_module_exports__.Za}getNonPointInputType(){}getHint(){return""}getExpressionEditHint(e){return this.getHint()}onNumberInput(e){}onMove(e){return!0}onFocus(e){}tryCommitResults(){return{committed:void 0}}shouldUseJitEdges(){return!1}shouldHighlightRelevantObjects(){return!1}},lR="graphing-calculator-text-geometry-tool-translation-hint-from-with-vector",G$="graphing-calculator-text-geometry-tool-translation-hint-to",s1=class extends Ic{constructor(e){super(e),this.model=e,this.displayName="graphing-calculator-text-geometry-tool-translate-display-name",this.toolName="translation",this.toolType="transformation"}getExpressionEditHint(e){return e===0?this.s(lR):this.s(G$)}firstInputIsVector(){let{idMap:e}=this.model.getNonObjectsState().ui.currentTool,t=e[1],r=t&&this.model.findDefsForInputId(t)[0];return r&&r.typedRuntimeValue.valueType===__dcg_shared_module_exports__.$a}getSpec(){return this.firstInputIsVector()?{inputs:[{type:"union",valueTypes:[__dcg_shared_module_exports__.ya,__dcg_shared_module_exports__.$a],id:"1",hint:lR}],outputs:[{id:"3",type:"translate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"}]}]}:{inputs:[{type:"union",valueTypes:[__dcg_shared_module_exports__.ya,__dcg_shared_module_exports__.$a],id:"1",hint:lR},{type:"point",id:"2",hint:G$}],outputs:[{id:"3",type:"translate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}},kde={selection:a1,point:t1,line:J0,segment:n1,ray:o1,vector:qv,circle:$0,arc:W0,parallel:Z0,perpendicular:e1,midpoint:Q0,polygon:r1,compass:j0,angle:H0,directedangle:X0,reflect:i1,translate:s1,rotate:im,dilate:Y0,anglebisector:K0,"box-selection":om,"expression-edit":Rh},cR=kde,_de=!0,Ide=!1,P$="**dcg_geo_tool_output_slider**";function Ade(){return{point:__dcg_shared_module_exports__.Rd.PURPLE,line:__dcg_shared_module_exports__.Rd.BLUE,circle:__dcg_shared_module_exports__.Rd.GREEN,polygon:__dcg_shared_module_exports__.Rd.BLUE,angle:__dcg_shared_module_exports__.Rd.BLACK}}function Mde(e,t){let r=[],n=e.parents;for(let i=0;i<n.length;i++){let o=n[i];o.type==="hardcoded"?r[i]=o.id:r[i]=t[o.id]}return r}var l1=class{constructor(e){this.availableInputTypes=new Set,this._nextObjectId=0,this.clear(),this.controller=e,this.s=this.controller.s,this._tools={};for(let t in cR)this._tools[t]=new cR[t](this)}onPreviewChange(){var e;let t=this.controller.getToolPreviewJSONState(),r=this.getUncommittedObjects();if(this.getCurrentTool()instanceof Rh&&!this.controller.getValidCursorContext()){r=R({},r);for(let i in t){let o=t[i];o.type==="expression-edit-preview-latex"&&(r[i]=o)}}let n=this.getNonObjectsState().ui.currentTool.lockedIds;for(let i in r){let o=r[i];o.type==="polygon-segment"&&(!n[i]||Object.keys(r).some(a=>!n[a]&&r[a].parents.includes(i)))&&(r[i]=ie(R({},o),{showAsSepratePreviewObject:!0}))}__dcg_shared_module_exports__.E(t,r)?this.controller.dispatch({type:"render"}):this.controller.dispatch({type:"set-tool-preview-state",state:r}),(e=this.controller.get2dPOIController())==null||e.updateGeoHoveredObjects()}peekNextObjectId(){return"\\token{"+this._nextObjectId.toString()+"}"}generateObjectId(){let e=this.peekNextObjectId();return this._nextObjectId+=1,e}updateNextObjectId(e){e>this._nextObjectId&&(this._nextObjectId=e)}clear(){let e={objects:{},ui:{currentTool:{name:"selection",idMap:{},reusableInputIdMap:{},lockedIds:{},inputIndex:0,outputHistory:{},forceSingleUse:!1},colors:Ade(),clickToInsertMode:"valid-type"},hoveredObjects:[],uncommittedIds:{},selectedIds:{},nextSelectionNumber:1,fadeAnimations:{},maxAnimationEndTime:0};this.store?this.store.set(e):this.store=new Nc(e)}onFocus(e){this.clearHoveredObjects(),this.getCurrentTool().onFocus(e),this.onPreviewChange()}onMouseAction(e,t){let r=this.getCurrentTool();if(r instanceof Rh&&!this.controller.getValidCursorContext())return{committed:void 0,handled:!1};switch(this.updateNextObjectId(this.controller.findLastTokenNumber()+1),this.clearHoveredObjects(),e){case"move":return{committed:void 0,handled:r.onMove(t)};case"release":r.onMove(t);let n=r.tryCommitResults();return n.committed?ie(R({},n),{handled:!0}):{committed:void 0,handled:!1}}}generatePureToolOutput(e,t){let r=this.getTool(e);if(!(r instanceof Vr))return;let n=t.map(c=>c.typedValue),i=r.getMatchingWorkflow(n);if(!i)return;let o=pV(i.firstMatch,n,!1),a={},s={};for(let c=0;c<t.length;c++)s[c]=t[c].referenceLatex;this.updateNextObjectId(this.controller.findLastTokenNumber()+1),this.generateIdsForNewToolOutputs(o);let{ui:l}=this.getNonObjectsState();for(let c of o){let d=l.currentTool.idMap[c.id];a[d]=ie(R({},c),{color:this.defaultColorForObject(l,c),id:d,parents:c.parents.map((u,p)=>{var g;return(g=s[p])!=null?g:""})})}return{canCommit:i.canCommit,outputs:a}}getNonObjectsState(){return ie(R({},this.store.getState()),{objects:void 0})}getCurrentTool(){return this.getTool(this.getToolMode())}getTool(e){return this._tools[e]}getClickToInsertMode(){return this.store.getState().ui.clickToInsertMode}setClickToInsertMode(e){this.store.set(["ui","clickToInsertMode"],e)}defaultColorForObject(e,t){switch(t.type){case"point":case"point-reference":case"midpoint":case"glider":case"intersection":case"vector-endpoint":return e.colors.point;case"polygon-segment":return t.polygonColor||e.colors.line;case"line":case"segment":case"ray":case"vector":case"vector-copy":case"perpendicular":case"parallel":case"anglebisector":return e.colors.line;case"circle":case"compass":case"arc":return e.colors.circle;case"polygon":return e.colors.polygon;case"angle":case"polygon-angle":case"directedangle":case"polygon-directedangle":return e.colors.angle;case"dilate":case"reflect":case"rotate":case"translate":return __dcg_shared_module_exports__.Rd.GRAY;case"slider":return __dcg_shared_module_exports__.Rd.BLACK;case"expression-edit-preview-latex":return t.color||__dcg_shared_module_exports__.Rd.BLACK;default:return t}}_deselectAll(){this.store.shallowMutate(e=>{e.nextSelectionNumber=1,e.selectedIds={}})}_modifySelection(e){let t=this.getNonObjectsState().nextSelectionNumber;this.store.shallowMutate("selectedIds",r=>{for(let n in e)e[n]?r[n]||(r[n]=t,t+=1):delete r[n]}),this.store.set("nextSelectionNumber",t)}_addObjects(e){this.store.shallowMutate("objects",t=>{for(let r of e)t[r.id]=r})}_deleteObjects(e){if(!e.length)return;let t={};this.store.shallowMutate("objects",r=>{for(let n of e)t[n]=Ide,delete r[n]}),this._modifySelection(t),this.store.shallowMutate("uncommittedIds",r=>{for(let n of e)delete r[n]})}createCustomToolOutput(e){var t;this.generateIdsForNewToolOutputs(e.outputs);let{idMap:r}=this.getNonObjectsState().ui.currentTool,n=[],i=this.getNonObjectsState().ui;for(let o of e.outputs){let a;o.type==="polygon-segment"?a=o.polygonColor:a=this.defaultColorForObject(i,o);let s=ie(R({},o),{id:r[o.id],color:a,parents:Mde(o,r)});n.push(s)}for(let o of e.inputs)if((t=o.numberInputInfo)!=null&&t.sliderInfo){let a=o.numberInputInfo.sliderInfo,s=r[`${o.id}-number`];if(ya(s)){let l=GN(s);if(l&&l in __dcg_shared_module_exports__.qc)continue;this.controller.getItemsByIdentifier(__dcg_shared_module_exports__.na(s)).length||n.push({type:"slider",lhsLatex:s,rhsLatex:a.value,sliderInfo:a,id:P$,parents:[],hidden:!1,color:"#000"})}}this._shouldNewObjectsBeMarkedUncommitted()&&this.store.shallowMutate("uncommittedIds",o=>{for(let a of n)o[a.id]=!0}),this._addObjects(n)}_getReusableIdForCurrentInput(e){let t=this.getCurrentTool();if(!t.getSpec)return;let{inputIndex:r,reusableInputIdMap:n}=this.getNonObjectsState().ui.currentTool,i=t.getSpec().inputs[r];if(!i)return;let o=i.id;return e!==void 0&&(o+="-"+e),n[o]}_createInputObject(e,t){let r,n=this._shouldNewObjectsBeMarkedUncommitted();n?r=this._getReusableIdForCurrentInput(t)||this.generateObjectId():r=this.generateObjectId(),n&&this.store.set(["uncommittedIds",r],!0);let i=this.defaultColorForObject(this.getNonObjectsState().ui,e),o=ie(R({hidden:e.type==="point"&&!!e.previewOnly},e),{id:r,color:i});return this._addObjects([o]),r}attemptLockToolInputIn(e){let{inputIndex:t,idMap:r}=this.getNonObjectsState().ui.currentTool,n=this.getCurrentTool();if(!(n instanceof _c))return;let i=n.getSpecIdToLockIn(e,t);if(!i)return;let o=r[i];if(!o){this.getCurrentTool().canNextInputBePoint()||this.controller.dispatch({type:"select-geo-tool",tool:"selection"});return}let a=o&&this.store.getState().objects[o];if(a&&a.type==="point"&&a.previewOnly){this.controller.dispatch({type:"select-geo-tool",tool:"selection"});return}this.store.set(["ui","currentTool","inputIndex"],t+1),this.store.set(["ui","currentTool","lockedIds",o],!0);for(let s=0;s<2;s++){let l=i+"-"+s,c=r[l];c&&this.store.set(["ui","currentTool","lockedIds",c],!0)}n.didLockInput(e),this.updateFadeAnimations()}generateIdsForNewToolOutputs(e){let{idMap:t}=this.getNonObjectsState().ui.currentTool,r=!1,n={};for(let i of e)t[i.id]||(r=!0,n[i.id]=this.generateObjectId());r&&this.store.set(["ui","currentTool","idMap"],R(R({},t),n))}tentativelyMatchToolInput(e,t){let{currentTool:r}=this.getNonObjectsState().ui,n=r.inputIndex,i=e.inputs[n];if(!i)return;let o=i.id;this.store.set(["ui","currentTool","idMap",o],t)}storeNumberInputLatex(e,t){let{currentTool:r}=this.getNonObjectsState().ui,n=r.inputIndex,i=e.inputs[n];if(!(i!=null&&i.numberInputInfo))return;let o=i.id;this.store.set(["ui","currentTool","idMap",`${o}-number`],t)}createToolInputDependency(e,t,r){let n=this._createInputObject(e,r),{currentTool:i}=this.getNonObjectsState().ui,o=i.inputIndex,a=t.inputs[o];if(!a)throw this.store.getState(),new Error("programming error: could not find input "+o+" in spec");let s=a.id;return this.store.set(["ui","currentTool","idMap",s+"-"+r],n),n}isObjectALockedToolInput(e){return!!this.getNonObjectsState().ui.currentTool.lockedIds[e]}isDegenerateInput(e){let t=this.getCurrentTool();return t instanceof _c?t.isDegenerateInput(e):!1}getEnabledAdditionalTools(){return v$.filter(e=>!0)}getAdditionalTools(){return this.getEnabledAdditionalTools()}isAnyAdditionalToolEnabled(){return this.getAdditionalTools().length>0}setObjectSelected(e){let t={};t[e]=_de,this._modifySelection(t)}setObjectsSelected(e){__dcg_shared_module_exports__.g(e,t=>{this.setObjectSelected(t)})}deleteSelectedObjects(){let e=this.getSelectedObjectIdsUnsorted();this._deleteObjects(e)}isObjectUncommitted(e){return!!this.getNonObjectsState().uncommittedIds[e]}getUncommittedObjectIds(){return Object.keys(this.getNonObjectsState().uncommittedIds)}getUncommittedObjects(){let e={},t=this.store.getState().objects,r=this.getUncommittedObjectIds();for(let n of r)e[n]=t[n];return e}isValidNextInputType(e){let t=this.getCurrentTool(),r=t.getNonPointInputType();return e&&__dcg_shared_module_exports__.wb(e)&&(e=__dcg_shared_module_exports__.xb(e)),!!(r&&e&&WD(e,r)||t.canNextInputBePoint()&&e&&WD(e,"point"))}recordCommittedOutput(e){this.store.shallowMutate(["ui","currentTool","outputHistory"],t=>{t[e]=!0})}updateFadeAnimations(){let e=this.controller.getAllItemModels(),t=Date.now(),r=-1/0;this.store.shallowMutate(["fadeAnimations"],n=>{var i,o;if(this.getCurrentTool().shouldHighlightRelevantObjects())for(let a of e){if(a.type!=="expression"||!a.latex)continue;let s=a.id,l=(i=a.formula)==null?void 0:i.geometry,c,d=l==null?void 0:l.valueType;l!=null&&l.unconstructable||this.controller.shouldIgnoreGraphInteractions(a)?c="fade-out":this.isValidNextInputType(__dcg_shared_module_exports__.ya)&&(Dm(KD(d))||__dcg_shared_module_exports__.wb(d)&&Dm(KD(__dcg_shared_module_exports__.xb(d))))||d&&__dcg_shared_module_exports__.Ab(d,__dcg_shared_module_exports__.Ja)&&this.isValidNextInputType(__dcg_shared_module_exports__.La)||this.isValidNextInputType(d)||this.store.getState().ui.currentTool.outputHistory[s]?c="fade-in":c="fade-out";let u=this.store.getState().fadeAnimations[s];if(u&&u.type!==c){let p=__dcg_shared_module_exports__.Sb(t-u.start,0,150),g=t+p-150;n[s]={type:c,start:g},r=Math.max(r,g)}else if(c==="fade-out"){let p=(o=u==null?void 0:u.start)!=null?o:t;n[s]={type:"fade-out",start:p},r=Math.max(r,p)}}else{for(let a in n)n[a]={type:"fade-in",start:t-150};r=t-150}}),isFinite(r)&&this.store.set("maxAnimationEndTime",r+150)}getToolFadeOpacity(e){let t=this.controller.getItemModel(e);if((t==null?void 0:t.type)!=="expression")return 1;let r=this.store.getState().fadeAnimations[t.id];if(!r)return 1;let n=Date.now(),i=__dcg_shared_module_exports__.Sb((n-r.start)/150,0,1),o=r.type==="fade-in"?.2:1,a=r.type==="fade-in"?1:.2;return o*(1-i)+a*i}updateAvailableInputTypes(){let e=this.controller.getAllItemModels();this.availableInputTypes=Pde(e)}isToolActuallyUsable(e){let t=this.controller.getGeoModel().getTool(e);if(t instanceof Vr){let r=t.getWorkflows();for(let n of this.availableInputTypes)if(r.some(i=>i.signature.matches([n])))return!0;return!1}return!0}isFading(){return Date.now()<=this.store.getState().maxAnimationEndTime}isObjectSelected(e){return!!this.getNonObjectsState().selectedIds[e]}getSelectedObjectIdsUnsorted(){return Object.keys(this.getNonObjectsState().selectedIds)}getSelectedObjectIdsSorted(){let e=this.getNonObjectsState().selectedIds,t=this.getSelectedObjectIdsUnsorted();return __dcg_shared_module_exports__.q(t,r=>e[r])}deselectAllObjects(){this._deselectAll()}getToolMode(){return this.getNonObjectsState().ui.currentTool.name}setToolMode(e){let t=this.getToolMode(),r=this.getNonObjectsState().ui.currentTool;this.store.set(["ui","currentTool"],{name:e,idMap:{},reusableInputIdMap:{},lockedIds:{},inputIndex:0,outputHistory:e!==t?{}:r.outputHistory,forceSingleUse:e!==t?!1:r.forceSingleUse}),this.updateFadeAnimations(),e!==t&&this.controller.isGraphPaperFocused()&&(e!=="expression-edit"&&yt(this.getCurrentToolDisplayName()+"."),this.speakCurrentGeoToolHint())}resetToolMode(){this.setToolMode(this.getToolMode())}markCurrentToolSingleUse(){this.store.set(["ui","currentTool","forceSingleUse"],!0)}areAnyObjectsHovered(){return!!this.getNonObjectsState().hoveredObjects.length}setObjectHovered(e){this.store.deepMutate(t=>{t.hoveredObjects.push(e)})}objectIsInstanceOf(e,t){let r=e==null?void 0:e.typedRuntimeValue.valueType;if(r)return WD(r,t)}getSelectionBox(){return this.getTool("selection").getSelectionBox()}commitObjects(){this.store.set("uncommittedIds",{}),this.store.set("objects",{})}applyTransformation(e){}getProjection(){return this.controller.get2dProjection()}_getPixelsAwayFromDef(e,t,r){let n=r.typedRuntimeValue;switch(n.valueType){case __dcg_shared_module_exports__.ya:{let i=t.mapx(n.value[0]),o=t.mapy(n.value[1]);return __dcg_shared_module_exports__.S(e.x-i,e.y-o)-6}case __dcg_shared_module_exports__.Ra:case __dcg_shared_module_exports__.La:case __dcg_shared_module_exports__.Ta:case __dcg_shared_module_exports__.$a:{let i,o,a,s;if(n.valueType===__dcg_shared_module_exports__.$a){let[[u,p],[g,f]]=nm(n.value);i=t.mapx(u),a=t.mapy(p),o=t.mapx(g),s=t.mapy(f)}else i=t.mapx(n.value[0][0]),a=t.mapy(n.value[0][1]),o=t.mapx(n.value[1][0]),s=t.mapy(n.value[1][1]);let l=n.valueType===__dcg_shared_module_exports__.Ra,c=n.valueType===__dcg_shared_module_exports__.Ra||n.valueType===__dcg_shared_module_exports__.Ta,d=__dcg_shared_module_exports__.W(e.x,e.y,i,a,o,s,l,c);return d?__dcg_shared_module_exports__.S(d[0]-e.x,d[1]-e.y):1/0}case __dcg_shared_module_exports__.Na:{let i=n.value[0][0],o=n.value[0][1],a=n.value[1],s=0,l=Math.PI*2,c=t.reverse_mapx(e.x),d=t.reverse_mapy(e.y),u=__dcg_shared_module_exports__.X(c,d,i,o,a,s,l);return u?t.screen.width/(t.viewport.xmax-t.viewport.xmin)*__dcg_shared_module_exports__.S(u[0]-c,u[1]-d):1/0}case __dcg_shared_module_exports__.Pa:{let i=__dcg_shared_module_exports__.bc(n.value);if(!i)return 1/0;let o=(a,s,l,c)=>{let d=t.mapx(a[0]),u=t.mapy(a[1]),p=t.mapx(s[0]),g=t.mapy(s[1]),f=__dcg_shared_module_exports__.W(e.x,e.y,d,u,p,g,l,c);return f?__dcg_shared_module_exports__.S(f[0]-e.x,f[1]-e.y):1/0};if(i.type==="arc"){let a=t.reverse_mapx(e.x),s=t.reverse_mapy(e.y),l=__dcg_shared_module_exports__.X(a,s,i.center[0],i.center[1],i.radius,i.startAngle,i.endAngle);return l?t.screen.width/(t.viewport.xmax-t.viewport.xmin)*__dcg_shared_module_exports__.S(l[0]-a,l[1]-s):1/0}else return i.type==="segment"?o(i.start,i.end,!1,!1):Math.min(o(i.start1,i.end1,!1,!0),o(i.start2,i.end2,!1,!0))}case __dcg_shared_module_exports__.Ja:{let i=[];return n.value.forEach(o=>{i.push(t.mapx(o[0]),t.mapy(o[1]))}),__dcg_shared_module_exports__.ba(i,[e.x,e.y])?0:1/0}case __dcg_shared_module_exports__.Va:case __dcg_shared_module_exports__.Xa:{let i=t.screen.width/(t.viewport.xmax-t.viewport.xmin),o=t.screen.height/(t.viewport.ymax-t.viewport.ymin),[[a,s],l,c]=n.value,d=Zu(c,t),u=d/i,p=t.reverse_mapx(e.x),g=t.reverse_mapy(e.y),f=1/0,y=g-s,E=p-a,_=Math.atan2(y,E);if(__dcg_shared_module_exports__.Q(_,l,c))__dcg_shared_module_exports__.S(y*o,E*i)<=d+7&&(f=0);else{let w=__dcg_shared_module_exports__.V(p,g,a+u*Math.cos(l),s+u*Math.sin(l),a,s),v=__dcg_shared_module_exports__.V(p,g,a+u*Math.cos(l+c),s+u*Math.sin(l+c),a,s),T=__dcg_shared_module_exports__.S(i*(w[0]-p),o*(w[1]-g)),M=__dcg_shared_module_exports__.S(i*(v[0]-p),o*(v[1]-g));f=Math.min(T,M)}return f}case __dcg_shared_module_exports__.Za:return 1/0;default:return 1/0}}getAllChoosableDefsUnordered(e,t){var r;if(!this.controller.isGeometry())return[];let n=[],i=e.mode==="tab",o=e.mode==="mouse",a=i&&this.controller.getActiveTool()==="box-selection",s=!1,l=!1;(r=t.isValidNextInputType)!=null&&r.call(t,__dcg_shared_module_exports__.ya)&&(s=!0),t.shouldUseJitEdges()&&(t.isValidNextInputType(__dcg_shared_module_exports__.La)||t.isValidNextInputType(__dcg_shared_module_exports__.Ra)||t.isValidNextInputType(__dcg_shared_module_exports__.Ta))&&(l=!0);let c=o&&s;c&&(l=!0);let{lockedIds:d,reusableInputIdMap:u}=this.store.getState().ui.currentTool;return Qg({controller:this.controller},(p,g)=>{var f,y;if(!p.isGraphableAndInteractive)return;let E=p.assignment;for(let _ in u)if(u[_]===E&&!d[E])return;if(!p.hidden&&!p.data.unconstructable&&!(this.getToolMode()==="expression-edit"&&(f=p.data)!=null&&f.depends_on_selected)&&!(a&&this.controller.isClickableId(p.calcId))&&!(i&&this.isDegenerateInput(p==null?void 0:p.assignment))&&!(i&&g)){if(p.typedRuntimeValue.valueType===__dcg_shared_module_exports__.Ja)if(p.typedRuntimeValue.value.length){if(l){let _=p;if(_.typedRuntimeValue.valueType===__dcg_shared_module_exports__.Ja){let w=_.typedRuntimeValue.value;for(let v=0;v<w.length;v++){let T=w[v],M=w[(v+1)%w.length],C=_.referenceLatex+".\\operatorname{segments}\\left["+(v+1)+"\\right]",P={calcId:_.calcId,listIndex:_.listIndex,hidden:_.hidden,isGraphableAndInteractive:!1,assignment:C,referenceLatex:C,data:_.data,typedRuntimeValue:{valueType:__dcg_shared_module_exports__.La,value:[T,M]},polygonEdgeInfo:{edgeNumber:v,polygonDef:_}};n.push(P)}}}}else return;if(c&&!__dcg_shared_module_exports__.Ab(p.typedRuntimeValue.valueType,__dcg_shared_module_exports__.Ja)){n.push(p);return}if((y=t.isValidNextInputType)!=null&&y.call(t,p.typedRuntimeValue.valueType)){n.push(p);return}}}),n}_getObjectsUnderMouse(e,t,r){let n=this.getAllChoosableDefsUnordered({mode:"mouse"},r),i=this.getProjection(),o=[];n.forEach(l=>{let c=this._getPixelsAwayFromDef(e,i,l),d=l.polygonEdgeInfo?-1:0;if(c<=t){let u={def:l,layerNumber:d,pixelsAway:c};o.push(u)}});let a=this.controller.get2dSketchOrder(),s={};for(let l=0;l<a.length;l++)s[a[l]]=l;return o.sort((l,c)=>{let d=c.layerNumber-l.layerNumber;if(d!==0)return d;let u=l.pixelsAway-c.pixelsAway;if(u!==0)return u;let p=s[l.def.calcId];return s[c.def.calcId]-p}),o}convertCanvasPixelsToPoint(e){return this.getProjection().reverse_map_pt(e)}convertPointToCanvasPixels(e){return this.getProjection().map_pt(e)}deleteObjectsAndRememberReusableId(e){for(let t in e)this._deleteObjects([e[t]]);this._deleteObjects([P$]),this.store.shallowMutate(["ui","currentTool"],t=>t.reusableInputIdMap=e)}getObjectDefUnderMouse(e,t,r){let n=this.convertPointToCanvasPixels(e),i=this._getObjectsUnderMouse(n,t,r);return i.length>0?i[0].def:void 0}getOrCreatePointNearMouse(e,t){let r=this.convertPointToCanvasPixels(e),n=this._getObjectsUnderMouse(r,t,this.getCurrentTool()),i=[];for(let u of n){let p=u.def,g=c6(p);g==="Point"?i.push({def:p,type:g}):(Dm(g)||g==="Vector")&&i.push({def:p,type:g})}let{def:o,type:a}=i[0]||{},{def:s,type:l}=i[1]||{},c=this.controller.isGeoToolEnabled("point");if(a==="Point")return{type:"def",def:o};if(Dm(a)&&Dm(l)){let u=D$(o,s).map(p=>({x:p.x,y:p.y,i:p.i,pixelsFromPoint:V$(this.getProjection(),dh(p.x-e.x,p.y-e.y))}));if(u.sort((p,g)=>p.pixelsFromPoint-g.pixelsFromPoint),u=u.filter(p=>p.pixelsFromPoint<5),u[0]){let p=u[0].i===0?[o,s]:[s,o],g=this.findIncidentPointDef(o,s);if(g!=null&&g.hidden){let f=!1,y;if(cV(g.typedRuntimeValue,(E,_)=>{let[w,v]=E.value,T=this.getProjection().mathToPixels.mapPoint({x:w,y:v});dh(T.x-r.x,T.y-r.y)<t&&(f=!0,y=_)}),f)return y!==void 0&&(g=dV(g,y)),{type:"spec",spec:{type:"point-reference",targetSpec:{type:"intersection",parentDefs:p},parentDefs:[g]}}}return{type:"spec",spec:{type:"intersection",parentDefs:p}}}else if(c)return O$(this.getProjection(),e,o)}else{if(c&&Dm(a))return O$(this.getProjection(),e,o);if(a==="Vector"){let u=nm(o.typedRuntimeValue.value).map((p,g)=>({index:g,point:{x:p[0],y:p[1]},pixelsFromPoint:V$(this.getProjection(),dh(p[0]-e.x,p[1]-e.y))})).sort((p,g)=>p.pixelsFromPoint-g.pixelsFromPoint).filter(p=>p.pixelsFromPoint<5);if(u.length>0)return Lde(o,u[0].index===1?1:0)}}let d=Gde(this.getProjection(),e);return{type:"spec",spec:{type:"point",x:d.x,y:d.y,parentDefs:[],previewOnly:!c}}}findIncidentPointDef(e,t){let r=e.typedRuntimeValue.valueType,n=t.typedRuntimeValue.valueType,i={};Qg({controller:this.controller,expandLists:!1},s=>{if(s.data.identifier&&__dcg_shared_module_exports__.Ab(s.typedRuntimeValue.valueType,__dcg_shared_module_exports__.ya)){let l=s.data.identifier;i[l]=s}});let o=__dcg_shared_module_exports__.Ec({getGeometryTree:s=>s.data.call,isPointOrListOfPoints:s=>__dcg_shared_module_exports__.Ab(s.typedRuntimeValue.valueType,__dcg_shared_module_exports__.ya),lookup:s=>i[s],resolvesTo:(s,l)=>s===l.data.identifier},e,r,t,n),a=o&&__dcg_shared_module_exports__.Cc(o);if(a){let s=i[a],l=o&&__dcg_shared_module_exports__.Bc(o);return l===void 0?s:dV(s,l)}}_shouldNewObjectsBeMarkedUncommitted(){return this.getToolMode()!=="selection"}clearHoveredObjects(){this.store.set("hoveredObjects",[])}getHoveredItems(){return this.store.getState().hoveredObjects}cancelToolplay(){this._deleteObjects(this.getUncommittedObjectIds()),this.clearHoveredObjects(),this.resetToolMode()}isToolplayActive(){return this.getNonObjectsState().ui.currentTool.inputIndex>0}getComputedBoard(){let e=new q0;return Qg({controller:this.controller},(t,r)=>{e.add(t,r)}),e}findDefsForInputId(e){let t=[];return Qg({controller:this.controller},r=>{(r.assignment===e||r.referenceLatex===e)&&t.push(r)}),t}isCreatingNewTransform(){return this.getCurrentTool().toolType==="transformation"}getCurrentToolDisplayName(){return this.controller.s(this.getCurrentTool().displayName)}isCurrentToolComplex(){return this.getCurrentTool().toolType==="complex"}isCurrentToolSingleUse(){return this.getCurrentTool().toolType==="transformation"||this.getNonObjectsState().ui.currentTool.forceSingleUse}getIconInstructionsForTool(e){let t=this.getTool(e);return t?t.icon:[]}getDisplayNameForTool(e){let t=this.getTool(e);return t?this.controller.s(t.displayName):""}speakCurrentGeoToolHint(){xe(this.getCurrentTool().getHint())}};function Gde(e,t){let r=ZO(e,t);r&&(t=r);let n=.5/R$(e);return{x:ho(t.x-n,t.x+n),y:ho(t.y-n,t.y+n)}}function R$(e){return e.mapx(1)-e.mapx(0)}function V$(e,t){return R$(e)*t-6}function O$(e,t,r){return{type:"spec",spec:{type:"glider",t:$I(e,t,r.typedRuntimeValue),parentDefs:[r]}}}function Lde(e,t){return{type:"spec",spec:{type:"vector-endpoint",location:t?"end":"start",parentDefs:[e]}}}function Pde(e){let t=new Set;t.add(__dcg_shared_module_exports__.ya);for(let r of e){if(r.type!=="expression"||!r.formula.typed_constant_value||r.hidden)continue;let n=r.formula.typed_constant_value.valueType,i=__dcg_shared_module_exports__.wb(n)?__dcg_shared_module_exports__.xb(n):n;__dcg_shared_module_exports__.yb(i)&&t.add(i),i===__dcg_shared_module_exports__.Ja&&t.add(__dcg_shared_module_exports__.La)}return t}function bi(e,t,r){let n=Vde(e,t,r);qr(e,n)}function qr(e,t){if(e.focusLocation=t,!t||(t.type==="ticker"&&(e.getListModel().ticker.playing=!1,Nr(e.getListModel(),void 0)),t.type==="settings"||t.type==="generic-menu"||t.type==="editable-label"||t.type==="add-item-btn"||t.type==="add-expression-btn"||t.type==="add-note-btn"||t.type==="add-table-btn"||t.type==="add-folder-btn"||t.type==="add-ticker-btn"||t.type==="add-image-btn"||t.type==="edit-list-toggle"||t.type==="hide-expression-list-btn"||t.type==="show-expression-list-btn"||t.type==="zoom-in-btn"||t.type==="zoom-restore-btn"||t.type==="search-expressions"||t.type==="replace-expressions"||t.type==="ticker"||t.type==="geo-token"||t.type==="geo-show-constructions-icon"||t.type==="geo-basic-tool"||t.type==="geo-basic-tool-menu-item"||t.type==="geo-construct-menu-existing-transformations"||t.type==="multi-select-more-icon"||t.type==="multi-select-construct-icon"||t.type==="multi-select-style-icon"||t.type==="multi-select-label-icon"||t.type==="geo-header-back-link"||t.type==="multi-select-show-hide-icon"||t.type==="new-transformation-number"||t.type==="label-points-icon"||t.type==="graph-paper"||t.type==="quest"||t.type==="global-mute-button"||t.type==="color-picker-option"||t.type==="multi-select-label-menu-label-input"))return;let r=e.getItemModel(t.id);if(t.type==="expression-menu"){Nr(e.getListModel(),void 0);return}else Nr(e.getListModel(),r);r&&r.type==="expression"&&As(r,!1)}function Vde(e,t,r){let n=e.getItemModel(t);if(!n)return;let i=e.isInEditListMode()||e.isItemReadonly(n.id);switch(n.type){case"expression":return{type:i?"readonly-expression":n.type,id:t};case"folder":case"text":return{type:n.type,id:t};case"table":{let o={row:1,column:0},a=!1;return r&&(r.location==="cell"?o={row:r.row,column:r.column}:r==="end"?o={row:Pl(n),column:0}:r==="start"?o={row:0,column:0}:r==="container"&&(a=!0)),a?{type:"table-container",id:t}:{type:n.type,id:t,location:o}}case"image":return{type:n.type,id:t,location:"name"};default:return n}}function F$(e){let t=e.getSelectedItem();if(t&&t.type==="expression"&&!t.readonly){bi(e,t.id);return}if(t&&t.type==="table"&&e.focusLocation&&!t.readonly)return;let r=e.getFirstFullyVisibleItem(),n=e.getListModel();for(;r&&(r.type!=="expression"||r.readonly);)r=Tw(n,r.index);if(r){bi(e,r.id);return}let i=e.createItemModel({type:"expression",id:e.generateId(),color:e.getNextColor()});ol(e.getListModel(),i),bi(e,i.id)}function N$(e){let t=e.focusLocation;if(t&&!(t.type==="settings"||t.type==="generic-menu"||t.type==="editable-label"||t.type==="add-item-btn"||t.type==="add-expression-btn"||t.type==="add-note-btn"||t.type==="add-table-btn"||t.type==="add-ticker-btn"||t.type==="add-folder-btn"||t.type==="add-image-btn"||t.type==="edit-list-toggle"||t.type==="hide-expression-list-btn"||t.type==="show-expression-list-btn"||t.type==="zoom-in-btn"||t.type==="zoom-restore-btn"||t.type==="search-expressions"||t.type==="replace-expressions"||t.type==="ticker"||t.type==="geo-token"||t.type==="geo-show-constructions-icon"||t.type==="geo-basic-tool"||t.type==="geo-basic-tool-menu-item"||t.type==="geo-construct-menu-existing-transformations"||t.type==="multi-select-more-icon"||t.type==="multi-select-construct-icon"||t.type==="multi-select-style-icon"||t.type==="multi-select-label-icon"||t.type==="geo-header-back-link"||t.type==="multi-select-show-hide-icon"||t.type==="new-transformation-number"||t.type==="label-points-icon"||t.type==="graph-paper"||t.type==="quest"||t.type==="global-mute-button"||t.type==="color-picker-option"||t.type==="multi-select-label-menu-label-input"))return e.getItemModel(t.id)}function ox(e,t,r){qr(e,{type:"table",id:t,location:r})}function U$(e,t,r){let n=e.getItemModel(t);if(!n||n.type!=="table")return;let i=n,o=wa(i),a=o?o.row:-1,s=o?o.column:-1,l=i.columnModels,c=Pl(i),d=l.length,u=(y,E)=>{y===-1?JI(e):y>c?QI(e):(E===-1?(E=d-1,y--):E===d&&(y++,E=0),ox(e,t,{row:y,column:E}))},p=y=>{c>2&&oz(i,a-1),ox(e,t,{row:y,column:s})},g=y=>{s===0||d<=2||(mw(i,s),ox(e,t,{row:a,column:y}))},f=!!Uf(i.columnModels[0]);switch(r){case"Left":u(a,s-1);break;case"Right":u(a,s+1);break;case"Up":u(a-1,s);break;case"Down":u(a+1,s);break;case"PageUp":return JI(e);case"PageDown":return QI(e);case"Enter":if(a>=c)return uR(e);if(s>0||f)return u(a+1,s);if(a===c-1){let y=iz(i,a);OG(i,a);for(let E=0;E<y.length;E++)vp(i,{row:a+1,column:E},y[E]);ox(e,t,{row:a+1,column:s});return}OG(i,a),ox(e,t,{row:a+1,column:s});break;case"Backspace":a===0?s===0?dR(e):s===d-1||s===1&&d===3?u(0,s-1):g(s-1):s!==0?u(a,s-1):a===c||f?u(a-1,s):p(a-1);break;case"Delete":a===0?s===0?pR(e):s<d-1&&g(s):a>=c||f||p(a);break}}function JI(e){if(e.inAudioTraceMode())return;let t=e.getFocusLocation(),r=e.getListModel();if((t==null?void 0:t.type)==="ticker"&&e.getExpressionSearchOpen())return qr(e,{type:"search-expressions"});let n=e.getSelectedItem();if(n)if(NE(r)){if(n=e.getSelectedItem(),!n)return;bi(e,n.id,e.isInEditListMode()&&n.type==="table"?"container":"end")}else e.getTickerVisible()?qr(e,{type:"ticker",location:"handler"}):e.getExpressionSearchOpen()&&qr(e,{type:"search-expressions"})}function QI(e){if(e.inAudioTraceMode())return;let t=e.getFocusLocation(),r=e.getListModel();if((t==null?void 0:t.type)==="search-expressions"&&e.getTickerVisible())return qr(e,{type:"ticker",location:"handler"});if((t==null?void 0:t.type)==="ticker"||(t==null?void 0:t.type)==="search-expressions"){let i=eb(r);if(i)return bi(e,i.id,e.isInEditListMode()&&i.type==="table"?"container":"start")}if(!BE(r)&&!e.isInEditListMode()){let i=e.createItemModel({type:"expression",id:e.generateId(),color:e.getNextColor()});ol(r,i),Nr(r,i)}let n=e.getSelectedItem();if(n)return bi(e,n.id,e.isInEditListMode()&&n.type==="table"?"container":"start")}function dR(e){if(e.isInEditListMode())return;let t=e.getSelectedItem();if(!t||e.getItemCount()===1&&t.type==="expression")return;let r=t.type==="text",n=Ca(t);if(n){let i=e.getNumberOfItemsInFolder(n.id);if(t.index===n.index+i){_n(t,"");return}}if(hR(e,{moveSelection:!0}),r&&tl&&mp){Nr(e.getListModel(),void 0);return}t=e.getSelectedItem(),t&&bi(e,t.id,"end")}function pR(e){if(e.isInEditListMode())return;let t=e.getSelectedItem();t&&(e.getItemCount()===1&&t.type==="expression"||(gR(e,{moveSelection:!0}),t=e.getSelectedItem(),t&&bi(e,t.id,"start")))}function uR(e){if(e.isInEditListMode())return;let t=e.getSelectedItem();if(!t)return;if(t.type==="text"&&tl&&mp){Jr(),Nr(e.getListModel(),void 0);return}if(t.type==="expression"&&Ep(t).length>0)return e.createSlidersForItem(t.id,Ep(t).concat(""));let r=Iw(t);if(r.length>0&&r.length<=zw&&e.areSlidersEnabled())return e.createSlidersForItem(t.id,Iw(t).concat(""));let n=e.createItemModel({type:"expression",id:e.generateId(),color:e.getNextColor()}),i=t.index+1;t.type==="folder"&&t.collapsed&&(i+=e.getNumberOfItemsInFolder(t.id)),_s(e.getListModel(),n,i),Nr(e.getListModel(),n),t.type==="folder"&&!t.collapsed?_n(n,t.id):t.type!=="folder"&&t.folderId&&_n(n,t.folderId),t=e.getSelectedItem(),t&&bi(e,t.id)}function hR(e,{moveSelection:t}){let r=e.getSelectedItem(),n=e.getListModel();if(!r||e.isItemReadonly(r.id))return;let i=Ew(n,r.index);if(e._removeExpressionSynchronously(r),t){if(!i){let o=eb(n);o&&(i=o)}Nr(n,i)}else Nr(n,void 0)}function gR(e,{moveSelection:t}){let r=e.getSelectedItem(),n=e.getListModel();if(!r||e.isItemReadonly(r.id))return;let i=Tw(n,r.index);if(e._removeExpressionSynchronously(r),t){if(!i){let o=PE(n);o&&(i=o)}Nr(n,i)}else Nr(n,void 0)}qt();var Rde={loga:(e,t)=>{Fe.canAcceptText(e,t.capExpressionSize,"\\log_{}\\left(\\right)")&&(e.write("\\log_{}"),e.typedText("("),e.keystroke("Left"),e.keystroke("Down"))},nthroot:(e,t)=>{Fe.canAcceptText(e,t.capExpressionSize,"\\sqrt[]{}")&&(e.write("\\sqrt[]{}"),e.keystroke("Left"),e.keystroke("Left"))},ddx:(e,t)=>{Fe.canAcceptText(e,t.capExpressionSize,"\\frac{d}{dx}")&&e.write("\\frac{d}{dx}")},arcsin:(e,t)=>{Fe.canAcceptText(e,t.capExpressionSize,"\\sin^{-1}\\left(\\right)")&&(e.write("sin^{-1}"),e.typedText("("))},arccos:(e,t)=>{Fe.canAcceptText(e,t.capExpressionSize,"\\cos^{-1}\\left(\\right)")&&(e.write("cos^{-1}"),e.typedText("("))},arctan:(e,t)=>{Fe.canAcceptText(e,t.capExpressionSize,"\\tan^{-1}\\left(\\right)")&&(e.write("tan^{-1}"),e.typedText("("))},arcsec:(e,t)=>{Fe.canAcceptText(e,t.capExpressionSize,"\\sec^{-1}\\left(\\right)")&&(e.write("sec^{-1}"),e.typedText("("))},arccsc:(e,t)=>{Fe.canAcceptText(e,t.capExpressionSize,"\\csc^{-1}\\left(\\right)")&&(e.write("csc^{-1}"),e.typedText("("))},arccot:(e,t)=>{Fe.canAcceptText(e,t.capExpressionSize,"\\cot^{-1}\\left(\\right)")&&(e.write("cot^{-1}"),e.typedText("("))},"A^T":(e,t)=>{Fe.canAcceptText(e,t.capExpressionSize,"^{T}")&&(e.typedText("^T"),e.keystroke("Right"))},"A^-1":(e,t)=>{Fe.canAcceptText(e,t.capExpressionSize,"^{-1}")&&(e.typedText("^-1"),e.keystroke("Right"))},"A^2":(e,t)=>{Fe.canAcceptText(e,t.capExpressionSize,"^{2}")&&(e.typedText("^2"),e.keystroke("Right"))},"a^2":(e,t)=>{Fe.canAcceptText(e,t.capExpressionSize,"^{2}")&&(e.typedText("^2"),e.keystroke("Right"))},"a^3":(e,t)=>{Fe.canAcceptText(e,t.capExpressionSize,"^{3}")&&(e.typedText("^3"),e.keystroke("Right"))},"a/b":(e,t)=>{Fe.canAcceptText(e,t.capExpressionSize,"\\frac{}{}")&&(e.write("\\frac{}{}"),e.keystroke("Left"))},integral:(e,t)=>{Fe.canAcceptText(e,t.capExpressionSize,"\\int_{}^{}")&&e.cmd("integral")}};function ZI(e,t,r){Rde[t](e,r)}var mR=e=>({value:e.degreeMode?"30":"0.5",min:"0",max:e.degreeMode?"360":"2\\pi"}),q$={min:"0",max:"5",value:"1"},ix=e=>({min:"0",max:"1",value:`${e}`}),Fde={latex:void 0,polarDomainMin:void 0,polarDomainMax:void 0,parametricDomainMin:void 0,parametricDomainMax:void 0,parametricDomain3DuMin:void 0,parametricDomain3DuMax:void 0,parametricDomain3DvMin:void 0,parametricDomain3DvMax:void 0,parametricDomain3DrMin:void 0,parametricDomain3DrMax:void 0,parametricDomain3DphiMin:void 0,parametricDomain3DphiMax:void 0,clickableInfoLatex:void 0,colorLatex:void 0,tableColumnColorLatex:void 0,cdfMin:()=>({value:"0",min:"-10",max:"10"}),cdfMax:()=>({value:"0",min:"-10",max:"10"}),pointSize:()=>({value:"8",min:"0",max:"20"}),movablePointSize:()=>({value:"8",min:"0",max:"20"}),tableColumnPointSize:()=>({value:"8",min:"0",max:"20"}),labelAngle:mR,labelSize:()=>({value:"1",min:"0",max:"5"}),lineWidth:()=>({value:2.5+"",min:"0",max:"10"}),resolution:()=>({value:"50",min:"2",max:"100",step:"1"}),tableColumnLineWidth:()=>({value:2.5+"",min:"0",max:"10"}),fillOpacity:()=>({value:.4+"",min:"0",max:"1"}),surfaceOpacity:()=>({value:"0.9",min:"0",max:"1"}),lineOpacity:()=>({value:"1",min:"0",max:"1"}),tableColumnLineOpacity:()=>ix(1),pointOpacity:()=>ix(1),tableColumnPointOpacity:()=>ix(1),sliderMin:void 0,sliderMax:void 0,sliderStep:void 0,residualVariable:void 0,tableHeader:void 0,tableCellValue:void 0,imageOpacity:()=>({value:"1",min:"0",max:"1"}),imageCenter:void 0,imageHeight:()=>({value:"10",min:"-10",max:"10"}),imageWidth:()=>({value:"10",min:"-10",max:"10"}),imageAngle:mR,tickerMinStep:()=>({value:"0",min:"0"}),tickerHandler:void 0},H$={tone:{paramBounds:e=>e===0?{value:"440",min:"110",max:"880"}:ix(.5)},glider:{paramBounds:e=>{if(e!==0)return ix(.5)}},dilate:{paramBounds:e=>{if(!(e<2))return{value:"2",min:"0",max:"5"}}},rotate:{paramBounds:(e,t)=>{if(!(e<2))return mR(t)}},circle:{paramBounds:e=>{if(e===1)return q$}},normaldist:{paramBounds:e=>{if(e===0)return{min:"-5",max:"5",value:"0"};if(e===1)return q$}},rgb:{paramBounds:e=>({value:"0",min:"0",max:"255",step:"1"})},hsv:{paramBounds:e=>e===0?{value:"0",min:"0",max:"360",step:"1"}:ix(.5)}};function K$(e,t,r){let n=e.map(o=>({location:o.location,parsed:__dcg_shared_module_exports__.Wc(o.latex)})),i={};for(let o of t)for(let a of n){let s=Nde(o,a,r);s&&s.length&&(i[o]=s[0])}return i}function Nde(e,{parsed:t,location:r},n){let i=__dcg_shared_module_exports__.na(e);if(t.type==="Identifier"&&t._symbol===i){let a=Fde[r];return a?[a(n)]:void 0}t.type==="Assignment"&&(t=t._expression);let o=[];switch(t.type){case"FunctionCall":{let a=t._symbol;if(H$.hasOwnProperty(a)){let s=H$[a];t.args.forEach((l,c)=>{if(l.type==="Identifier"&&l._symbol===i){let d=s.paramBounds(c,n);d&&o.push(d)}})}break}default:return}return o}var su=class nc{constructor(t=100){this.clear(),this._sizeLimit=t}clone(){let t=new nc(this._sizeLimit);return t._stack=this._stack.slice(),t._stackPointer=this._stackPointer,t}clear(){this._stack=[],this._stackPointer=-1}getState(){return this._stack[this._stackPointer]}serializeForBugsnag(){function t(r){try{return JSON.stringify(r,null,2)}catch(n){return"[[could not jsonify]]"}}return{currentState:t(this._stack[this._stackPointer]),undoState:t(this._stack[this._stackPointer-1]),redoState:t(this._stack[this._stackPointer+1])}}addState(t){this.canRedo()&&this._stack.splice(this._stackPointer+1),this._stack.push(t),this._stack.length>this._sizeLimit&&this._stack.shift(),this._stackPointer=this._stack.length-1}replaceState(t){this.canRedo()&&this._stack.splice(this._stackPointer+1),this.replaceInteriorState(t)}replaceInteriorState(t){this._stack.length===0?(this._stack.push(t),this._stackPointer=0):this._stack[this._stackPointer]=t}canUndo(){return this._stackPointer>0}canRedo(){return this._stackPointer<this._stack.length-1}undo(){this.canUndo()&&(this._stackPointer-=1)}redo(){this.canRedo()&&(this._stackPointer+=1)}};function Ude(e){switch(e){case"histogram":case"dotplot":return 12;case"boxplot":return 40}return 1/0}function zde(e){return e==="boxplot"||e==="dotplot"||e=="histogram"}function qde(e){return e==="boxplot"?3:.5}function Hde(e,t){if(e.type==="dotplot"||e.type==="histogram"){let r=Math.max(1,e.xmax-e.xmin)*80/(e.binWidth?e.binWidth:1),n=.5*(t.screen.width-r)/r;return Math.max(.2,n)}return .5}function Kde(e,t,r){e=__dcg_shared_module_exports__.Jc(e);let n=1.2;return t&&e.xmax<0&&e.xmin<0&&e.xmax/(e.xmin-e.xmax)<n&&(e.xmax=0),t&&e.xmax>0&&e.xmin>0&&e.xmin/(e.xmax-e.xmin)<n&&(e.xmin=0),r&&e.ymax<0&&e.ymin<0&&e.ymax/(e.ymin-e.ymax)<n&&(e.ymax=0),r&&e.ymax>0&&e.ymin>0&&e.ymin/(e.ymax-e.ymin)<n&&(e.ymin=0),e}function Wde(e,t,r,n){let i=e.type,o=Hde(e,t),a=qde(i),s,l,c,d;if(e.xmin===e.xmax&&(r?(e.xmin-=.5,e.xmax+=.5):(e.xmin*=.5,e.xmax/=.5)),e.ymin===e.ymax&&(n?(e.ymin-=.5,e.ymax+=.5):(e.ymin*=.5,e.ymax/=.5)),r){let u=(e.xmax-e.xmin)*o;s=e.xmin-u,l=e.xmax+u}else{let u=wr(e.xmax/e.xmin,o);s=e.xmin/u,l=e.xmax*u}if(n){let u=(e.ymax-e.ymin)*a;c=e.ymin-u,d=e.ymax+u}else{let u=wr(e.ymax/e.ymin,a);c=e.ymin/u,d=e.ymax*u}if(zde(i)){let u=t.screen.height/t.screen.width,p=(l-s)*u;if(p>e.ymax-e.ymin&&p<Ude(i)*(e.ymax-e.ymin)){let g=.5*(e.ymax+e.ymin);d=g+.5*p,c=g-.5*p}}return{xmin:s,xmax:l,ymin:c,ymax:d}}function eA(e,t){let r=c1(e,t);if(!r)return!1;let{xAxisScale:n,yAxisScale:i}=t.settings;if(!Br.fromObject(r).isValid({xAxisScale:n,yAxisScale:i}))return!1;let o=t.mapx(r.xmin),a=t.mapx(r.xmax),s=t.mapy(r.ymin),l=t.mapy(r.ymax),c=10;return!(Math.abs(o)<=c&&Math.abs(l)<=c&&Math.abs(a-t.screen.width)<=c&&Math.abs(s-t.screen.height)<=c)}function c1(e,t){let r=1/0,n=-1/0,i=1/0,o=-1/0,a=0,s=e.length,l=t.settings.xAxisScale==="linear",c=t.settings.yAxisScale==="linear";for(let d=0;d<s;d++){let u=Kde(e[d],l,c);if(!isFinite(u.xmax-u.xmin)||!isFinite(u.ymax-u.ymin)){a+=1;continue}if(!l&&!(u.xmax>0&&u.xmin>0)||!c&&!(u.ymax>0&&u.ymin>0)){a+=1;continue}let p=Wde(u,t,l,c);p.xmin<r&&(r=p.xmin),p.xmax>n&&(n=p.xmax),p.ymin<i&&(i=p.ymin),p.ymax>o&&(o=p.ymax)}if(a!==s)return{xmin:r,xmax:n,ymin:i,ymax:o}}function $de(e){var t,r;let n=e&&e.id,i=[];if(e&&e.type==="table"){e.columnModels.forEach(a=>{i.push(a.id)}),(t=e.regression)!=null&&t.id&&i.push(e.regression.id);let o=wa(e);if(!o){let a=e.controller.getFocusLocation();if((a==null?void 0:a.type)==="table-icon"){let s=e.columnModels.findIndex(l=>l.id===a.columnId);s>=0&&(o={row:0,column:s})}}if(o){let a=e.columnModels[o.column];n=a?a.id:void 0}else n=(r=e.regression)==null?void 0:r.id;return{selected:n?[n]:[],hoistedToTop:i}}return n?{selected:[n],hoistedToTop:[n]}:{selected:[],hoistedToTop:[]}}function W$(e,t,r){let n={},i={},o=e.getAllSelectedItems();for(let a of o){let s=$de(a);for(let l of s.selected)n[l]=!0,r.selected[l]||t.selectSketch(l);for(let l of s.hoistedToTop)i[l]=!0,r.hoistedToTop[l]||t.setSketchHoistedToTop(l,!0)}for(let a in r.selected)n[a]||t.deselectSketch(a);for(let a in r.hoistedToTop)i[a]||t.setSketchHoistedToTop(a,!1);return{selected:n,hoistedToTop:i}}function jde(e){for(let t in e)return!1;return!0}function Yde(e){var t;return e.type!=="expression"?void 0:e.formula.assignment||((t=e.formula.geometry)==null?void 0:t.identifier)}function Xde(e){var t,r,n;let i={lookupIdentifier:{},lookupCalcId:{}};for(let o of e){let a={calcId:o.id,identifier:Yde(o),referencesTheseIdentifiers:{},referencedByTheseCalcIds:{}};i.lookupCalcId[a.calcId]=a,a.identifier&&(i.lookupIdentifier[a.identifier]=a)}for(let o of e){let a=i.lookupCalcId[o.id];if(a){if(o.type==="expression"){o.folderId===__dcg_shared_module_exports__.xd&&(a.isGarbageCollectable=!o.readonly,(((r=(t=o.formula.geometry)==null?void 0:t.call)==null?void 0:r.symbol)==="segments"||mc(o))&&(a.deleteIfNotReferenced=!0));for(let s of((n=o.formula.geometry)==null?void 0:n.parentDependencies)||[])$$(i,a,s)}Jf(o,s=>{let l=s.match(/(\\token{[0-9]+})/g);if(l)for(let c of l){let d=__dcg_shared_module_exports__.na(c);d!==a.identifier&&$$(i,a,d)}})}}return i}function $$(e,t,r){t.referencesTheseIdentifiers[r]=!0;let n=e.lookupIdentifier[r];n&&(n.referencedByTheseCalcIds[t.calcId]=!0)}function Jde(e,t,r){var n;let i=[];for(let s of t){let l=e.lookupCalcId[s];if(!l)continue;i.push(l);let c=l.referencesTheseIdentifiers;for(let d in c){let u=e.lookupIdentifier[d];u&&delete u.referencedByTheseCalcIds[l.calcId]}}let o={};for(let s in r)for(let l of r[s]){let c=e.lookupIdentifier[l];c&&delete c.referencedByTheseCalcIds[s],o[l]=!0}let a={};for(let s of i){let l=s.referencesTheseIdentifiers;for(let d in l)o[d]=!0;let c=s.identifier;if(c){let d=(n=e.lookupIdentifier[c])==null?void 0:n.referencedByTheseCalcIds;if(d)for(let u in d){let p=e.lookupCalcId[u];p&&p.isGarbageCollectable&&(a[u]=!0)}}}for(let s in o){let l=e.lookupIdentifier[s];if(l&&l.deleteIfNotReferenced){let c=l.referencedByTheseCalcIds;l.calcId&&l.isGarbageCollectable&&jde(c)&&(a[l.calcId]=!0)}}for(let s of i)delete e.lookupCalcId[s.calcId],s.identifier&&delete e.lookupIdentifier[s.identifier];return Object.keys(a)}function j$(e,t,r){var n;let i=e.getAllItemModels(),o=t.map(d=>d.id),a=Xde(i.concat(t)),s={},l={};for(let d in r){let{nextLatex:u}=r[d],p=e.getItemModel(d);if((p==null?void 0:p.type)!=="expression")continue;let g={};for(let y of((n=p.formula.geometry)==null?void 0:n.parentDependencies)||[])g[y]=!0;for(let y in g)Il(u,__dcg_shared_module_exports__.ma(y))&&delete g[y];let f=Object.keys(g);f.length&&(l[d]=f)}let c=Object.keys(l).length>0;for(;o.length||c;){c=!1,o=Jde(a,o,l);for(let d of o)s[d]=!0}return Object.keys(s)}var Y$=Symbol("privateHistoryProperty"),tA=class{constructor(e,t){this.currentState=e,this.__historyThatShouldNotBeSerialized=Symbol("__historyThatShouldNotBeSerialized"),Object.defineProperty(this,Y$,{value:t.clone(),enumerable:!1,configurable:!1,writable:!1})}toJSON(){throw new Error("Operation unsupported: history should not be serialized.")}};function X$(e){let t=e;return{currentState:t.currentState,history:t[Y$]}}var J$={version:_l,randomSeed:"",graph:{product:"graphing-3d",threeDMode:!0,viewport:R({},__dcg_shared_module_exports__.xc)},expressions:{list:[{id:"1",type:"expression"}]}};function Q$(e){switch(e){case"letters":return"capitalLetters";case"noQwertyLetters":return"noQwertyCapitalLetters";case"noQwertyCapitalLetters":return"noQwertyLetters";default:return"letters"}}function Z$(e){switch(e){case"mainNumbers":return"mainNumbers3D";default:return e}}function fR(e){return{keypadMinimized:!Q5,keypadLayout:"mainNumbers",keypadFunctionsOpen:!1,graphSettingsOpen:!1,addExpressionOpen:!1,expressionsVisible:!!e.expressions,inEditListMode:!1,isFileDraggedOver:!1,expressionsHiddenTime:void 0}}var Yo=__dcg_shared_module_exports__.e(ne()),rA=class extends Yo.Class{template(){return Yo.createElement("form",{name:Yo.const("open_graph_on_web"),target:Yo.const("_blank"),method:Yo.const("POST"),action:()=>this.props.saveURL(),style:()=>({display:"none"})},Yo.createElement("input",{type:Yo.const("text"),name:Yo.const("is_open_on_web"),value:Yo.const("true")}),Yo.createElement("input",{type:Yo.const("text"),name:Yo.const("my_graphs"),value:Yo.const("false")}),Yo.createElement("input",{type:Yo.const("text"),name:Yo.const("is_update"),value:Yo.const("false")}),Yo.createElement("input",{type:Yo.const("text"),name:Yo.const("calc_state"),value:()=>this.props.stateData()}),Yo.createElement("input",{type:Yo.const("text"),name:Yo.const("thumb_data"),value:()=>this.props.thumbData()}))}},tj={xmin:"",xmax:"",xstep:"",ymin:"",ymax:"",ystep:"",zmin:"",zmax:""};function rj(e){return e in tj}function Qde(e){let t=e.split("×");return(t.length>1&&t[0]==="1"?t.slice(1):t).join("\\cdot")}function _m(e,t){let r=__dcg_shared_module_exports__.ea(e,t),n="";if(r.mantissa)n=Qde(r.mantissa)+"^{"+r.superscript+"}";else{let i=r.string.split("/");i.length===2?i[0][0]==="-"?n="-\\frac{"+i[0].slice(1)+"}{"+i[1]+"}":n="\\frac{"+i[0]+"}{"+i[1]+"}":n=r.string}return n=n.replace(/π/,"\\pi"),n}function Zde(e,t){let r=t.xAxisScale==="linear"?e.xmax-e.xmin:void 0,n=t.yAxisScale==="linear"?e.ymax-e.ymin:void 0,i={xmin:_m(e.xmin,r),xmax:_m(e.xmax,r),ymin:_m(e.ymin,n),ymax:_m(e.ymax,n)};return e.zmin!==void 0&&e.zmax!==void 0&&(i.zmin=_m(e.zmin,e.zmax-e.zmin),i.zmax=_m(e.zmax,e.zmax-e.zmin)),i}function ej(e,t){return e===0?"":_m(e,t)}function oj(e,t){return ie(R({},Zde(e,t.scales)),{xstep:ej(t.steps.xAxisStep,e.xmax-e.xmin),ystep:ej(t.steps.yAxisStep,e.ymax-e.ymin)})}function bR(){return{limitLatex:R({},tj)}}function ij(e){var t;switch(e.type){case"tick":case"tick-ticker":case"evaluator-progress-update":return!1;case"on-evaluator-changes":return!!((t=e.eventUpdates)!=null&&t.userAction);default:return!0}}var Im=class{constructor(e){this.__nextItemId=0,this.__pendingImageUploads={},this.__lastSelectedIdsForPropagation={selected:{},hoistedToTop:{}},this.nextSubscription=0,this.subscriptions={},this._queuedCallbacks=[],this._hasUnsavedChanges=!1,this.shouldScrollSelectedItemIntoViewAfterDispatch=!1,this.lastParsableObjects={},this.isExpressionSearchStrValidForReplace=!1,this.isExpressionReplaceStrValidForReplace=!1,this.expressionSearchCount=0,this.expressionSearchOpen=!1,this.geoUIActive=!1,this.showConstructionsOpen=!1,this.activeTool="selection",this.geometryGettingStartedMessageState="pick-a-tool",this.activeTokens={selected:void 0,hovered:void 0},this.apiMethodCallStackInfo={apiMethodCallDepth:0,withHistoryReplacementDepth:0},this.canShowKeyboardShortcuts=!1,this.progressUpdateLegendHidden=!1,this.shellViews={},this.toastData={},this.s=Ip(()=>this.graphSettings.config.language),this.raw=(n,i)=>Gs(n,i),this.hasTranslation=n=>{let i=this.graphSettings.config.language;return WL(n,i)},this.unpack=n=>{let i=this.graphSettings.config.language;return Fl(n,i)},this.dispatch=n=>{if(n.type==="blur-focus-location"&&this.dispatcher.isDispatching()){this.runAfterDispatch(()=>{this.dispatch(n)});return}if(n.type==="set-focus-location"&&this.dispatcher.isDispatching()){this.runAfterDispatch(()=>{this.dispatch(n)});return}if(n.type==="tick"&&this.dispatcher.isDispatching()){this.runAfterDispatch(()=>{this.dispatch(n)});return}n.type==="tick"||(""+this.bugsnagContext,n.type,void 0),this.dispatcher.isDispatching()&&(""+this.bugsnagContext,n.type,void 0),this.dispatcher.dispatch(n),this.onEventsEmitted&&this.onEventsEmitted(this.enqueuedEvents),this.logEventsFromDispatch(n);let i;for(;i=this._queuedCallbacks.shift();)i()},this._requiresTickNextFrame=!1,this.cachedGeoTokenDepths={},this.cachedGeoTokenInfo={},this.toolPreviewJSONState={},this.updateViews=()=>{for(let n in this.subscriptions)this.subscriptions[n]()},this.bugsnagContext="",this.inPrintMode=!1,this.lastInfiniteScrollFirstDOM=void 0,this.lastInfiniteScrollLastDOM=void 0,this.hasDispatchSinceLastInfiniteScrollUpdate=!1,this.stateStack=new su,this.isCurrentlyDoingSetState=!1,this.isCurrentlyDoingRestoreState=!1,this.expressionActionsToRestartIfSlow=new Array,this.getQuestIsActive=()=>!1,this.logEvent=n=>{},this.logEventsFromDispatch=n=>{};var t,r;this.graphSettings=e,(r=(t=this.graphSettings).setController)==null||r.call(t,this),this.listModel=M4(this),this.layoutModel=fR(this.graphSettings.config),this.layoutMeasurements={width:0,height:0},this.settingsViewModel=bR(),this.geometryToolbarModel=$z(),this.imageRetryState={lastAttemptTime:0,attempts:0},this.makeGeoAPI(),this.setupDispatcher(),this.toneAllowed()&&(this.toneController=new Nw(this)),this.graphSettings.config.observe("tone",()=>this._updateToneAvailability()),this.graphSettings.config.observe("audio",()=>this._updateToneAvailability())}setShellView(e,t){if(this.shellViews[e])throw new Error(`Shell view is already set: '${e}'.`);this.shellViews[e]=t}getShellView(e){var t;return(t=this.shellViews)==null?void 0:t[e]}hasUnsavedChanges(){return this._hasUnsavedChanges}getExpressionSearchOpen(){return this.expressionSearchOpen}getShowConstructionsOpen(){return this.showConstructionsOpen}getGeoToolbarSuppressedByAuthor(){return this.geometryToolbarModel.toolbar==="none"&&!this.shouldShowAuthorFeatures()}shouldShowGeoToolbar(){return this.isGeoUIActive()&&!this.getGeoToolbarSuppressedByAuthor()}isGeoUIActive(){return this.geoUIActive}isGeoToolActive(){return this.activeTool!=="selection"&&this.activeTool!=="box-selection"}getActiveTool(){return this.activeTool}canExpandListForItem(e){let t=this.getItemModel(e);return t?!this.isGeometry()||this.activeTool!=="selection"&&this.activeTool!=="box-selection"||this.isClickableId(e)||"label"in t&&t.label!=="":!1}getGeoModel(){return this.geoModel}getGeoToolbarGroupKeys(){return vw(this.geometryToolbarModel,this.shouldShowAuthorFeatures()).groups}getGeoToolbarItemsForGroup(e){let{items:t}=vw(this.geometryToolbarModel,this.shouldShowAuthorFeatures());return t[e]}getAllAvailableGeoTools(){let e=vw(this.geometryToolbarModel,this.shouldShowAuthorFeatures()),t=[];for(let r of e.groups){let n=e.items[r];n&&(n.dropdown?t.push(...n.dropdown):t.push(n.current))}return t}getAllVisibleGeoToolbarItems(){let e=this.getGeoToolbarGroupKeys(),t=[];for(let r of e){let n=this.getGeoToolbarItemsForGroup(r);n&&t.push(n)}return t}getTickerOpen(){return this.areActionsEnabled()?this.listModel.ticker.open:!1}getTickerVisible(){return this.getTickerOpen()&&!this.getTicker().filteredBySearch}getTickerPlaying(){return this.areActionsEnabled()?this.listModel.ticker.playing:!1}hasVisibleToast(){return!__dcg_shared_module_exports__.F(this.toastData)}hasVisibleAndUndoableToast(){return typeof this.toastData.undoCallback=="function"}toastUndo(){typeof this.toastData.undoCallback=="function"&&(this.toastData.undoCallback(),this.dispatch({type:"toast/close"}))}runAfterDispatch(e){this.dispatcher.isDispatching()?this._queuedCallbacks.push(e):e()}enqueueEvent(e,t){var r;let n=this.apiMethodCallStackInfo.apiMethodCallDepth>0,i=t&&!n&&ij(t)||!!((r=this.enqueuedEvents[e])!=null&&r.isUserInitiated)||e==="userMovedPoint";this.enqueuedEvents[e]={isUserInitiated:i}}getLanguage(){return this.graphSettings.config.language}pushWithHistoryReplacement(){this.apiMethodCallStackInfo.withHistoryReplacementDepth++}popWithHistoryReplacement(){if(this.apiMethodCallStackInfo.withHistoryReplacementDepth--,this.apiMethodCallStackInfo.withHistoryReplacementDepth<0)throw new Error("Programming Error: withHistoryReplacementDepth < 0")}pushAPIMethodCall(){this.apiMethodCallStackInfo.apiMethodCallDepth++}popAPIMethodCall(){this.apiMethodCallStackInfo.apiMethodCallDepth--}getGrapherDimensions(){let e=this.getGrapher();if(!e)return{width:0,height:0};let{width:t,height:r}=e.getProjection().screen;return{width:t,height:r}}setRandomSeed(e){this.graphSettings.setProperty("randomSeed",e)}getRandomSeed(){return this.graphSettings.randomSeed}setIncludeFunctionParametersInRandomSeed(e){this.graphSettings.setProperty("includeFunctionParametersInRandomSeed",e)}getIncludeFunctionParametersInRandomSeed(){return this.graphSettings.includeFunctionParametersInRandomSeed}shouldDispatchTickNextFrame(){return!!this._requiresTickNextFrame}markTickRequiredNextFrame(){this._requiresTickNextFrame=!0}handleTick(e){let t=this.handlePossiblySlowEvaluator();this.areActionsEnabled()&&k4(this.listModel.ticker,{currentFrameTime:e,previousFrameTime:this.lastFrameTime})?this.dispatch({type:"tick-ticker",time:e}):this.shouldDispatchTickNextFrame()?this.dispatch({type:"tick",time:e}):t&&this.dispatch({type:"render"}),this.getGeoModel().isFading()&&this.requestRedrawGraph(),this.lastFrameTime=e}setupDispatcher(){this.dispatcher=new U0,this.dispatcher.register(e=>{var t;let r=this.getFirstSelectedItem(),n=this.getFocusLocation();this.shouldScrollSelectedItemIntoViewAfterDispatch=!1;let i;this.enqueuedEvents={change:void 0,graphReset:void 0,clearUnsavedChanges:void 0,openDrawer:void 0,showHotkeysModal:void 0,userMovedPoint:void 0,userClickedObject:void 0,userEditedLabel:void 0},e.type==="tick"&&(this._requiresTickNextFrame=!1),this.isCurrentlyDoingSetState=!1,this.isCurrentlyDoingRestoreState=!1,this.handleDispatchedAction(e),this.constrainMultiSelect(),this.updateTheComputedWorld();let o=this.getImageToRetry();(this.getPlayingSliders().length>0||this.isDragDropActive()||o)&&this.markTickRequiredNextFrame(),o&&this.retryLoadingFailedImage(o),this.updateGeometryGettingStartedMessageState(),e.type!=="undo"&&e.type!=="redo"&&e.type!=="restore-history"&&!this.isDragDropActive()&&this.commitUndoRedoSynchronously(e),this.requestParseForAllItems(),this.isCurrentlyDoingSetState=!1,this.isCurrentlyDoingRestoreState=!1,this.enqueuedEvents.change&&((t=this.getGrapher2d())==null||t.markLabelsDirty()),this.enqueuedEvents.clearUnsavedChanges?this._hasUnsavedChanges=!1:this.enqueuedEvents.change&&(this._hasUnsavedChanges=!0);let a=this.getFirstSelectedItem();a?(!r||r.guid!==a.guid)&&(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0):this.shouldScrollSelectedItemIntoViewAfterDispatch=!1;let s=this.getFocusLocation();s&&!__dcg_shared_module_exports__.E(s,n)&&this.getFocusedItem()==a&&(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0),n&&r&&r.type==="table"&&n.type==="table"&&(!s||s.type!=="table"||n.id!==s.id)&&r.isExpanded&&(Nf(r,!1),s||(i=r)),s&&a&&a.type==="table"&&WU(a),(e.type==="adjust-slider-by-dragging-thumb"||e.type==="adjust-slider-by-keyboard")&&(i=this.getItemModel(e.id)),this.updateRenderShellsBeforePaint(),this.updateViews(),i?this.scrollItemIntoView(i):this.shouldScrollSelectedItemIntoViewAfterDispatch&&this.scrollSelectedItemIntoView(),this.updateDragDrop(),this.updateRenderShellsAfterDispatch()})}updateGeometryGettingStartedMessageState(){if(!this.isGeometry())return;let e=this.geometryGettingStartedMessageState,t=this.getActiveTool(),r=t==="selection"||t==="box-selection"||t==="expression-edit";if(e==="hidden")return;if(this.isGraphSettingsOpen()||this.getGraphSettings().showGrid||this.getGraphSettings().showYAxis){this.geometryGettingStartedMessageState="hidden";return}let n=this.getItemModelByIndex(1);if(this.getItemCount()>2||!n||n.type!=="expression"||n.latex!==""||this.geoModel.getNonObjectsState().ui.currentTool.inputIndex>0){this.geometryGettingStartedMessageState="hidden";return}r||(this.geometryGettingStartedMessageState="construct")}getGeometryGettingStartedMessageState(){return this.geometryGettingStartedMessageState}handleDispatchedAction(e){var t,r,n,i,o,a,s,l,c,d,u,p,g,f,y,E,_,w,v,T;switch(e.type){case"render":break;case"undo":this.isGeoToolActive()&&this.cancelGeoToolplay(),this.undo();break;case"redo":this.isGeoToolActive()&&this.cancelGeoToolplay(),this.redo();break;case"clear-undoredo-history":this.clearUndoRedoHistory();break;case"on-special-key-pressed":e.key==="Enter"?uR(this):e.key==="Up"||e.key==="PageUp"?JI(this):e.key==="Down"||e.key==="PageDown"?QI(this):e.key==="Backspace"?dR(this):e.key==="Delete"&&pR(this);break;case"select-previous-expression":NE(this.listModel);break;case"select-next-expression":BE(this.listModel);break;case"toggle-label-for-all-selected-points":this.toggleLabelForAllSelectedObjects();break;case"set-label-state-for-selected-points":{let x=[];for(let L of this.getAllSelectedItems())L.type==="expression"&&mc(L)&&x.push(L);this.setLabelStateForObjects(x,e.state);break}case"move-selected-item-to-expression-list":{let x=this.getSelectedItem();if(!x||x.type==="folder"||this.isItemReadonly(x.id))return;if(x.type==="expression"){let O=oT(x);O&&fd(this.listModel,O,this.getAutonameLatexForExpression(x,this.findLastSubscriptForLetters()))}Ag(this.listModel,x.id),"folderId"in x&&x.folderId===__dcg_shared_module_exports__.xd&&(x.folderId="");let L=this.getItemCount()-1,N=kg(this.listModel,L);if(N&&N.type==="expression"&&N.latex===""){this._toplevelReplaceItemAt(L,x,!1);return}ol(this.listModel,x)}break;case"update-all-selected-items":{let x=e.update;if(e.update.prop==="folderId"){let L;if(e.update.createFolder){L=this.generateId();let U=this.createItemModel({type:"folder",id:L,title:e.update.value}),D=this.getItemCount()-1,de=kg(this.listModel,D);de&&de.type==="expression"&&de.latex===""?this._toplevelReplaceItemAt(this.getItemCount()-1,U,!1):ol(this.listModel,U)}else L=e.update.value;let N=this.getItemModel(L);if(!N||N.type!=="folder")return;let O={},z={};this.getAllSelectedItems().forEach(U=>{var D;if(!(U.type==="folder"||U.folderId===L)&&!this.isItemReadonly(U.id)&&(O[U.id]=U,U.type==="expression")){let de=(D=U.formula.geometry)==null?void 0:D.call;if(de&&de.symbol==="apply"){let ge=de.parents[0],K=ge.type!=="arbitrary-expression"?__dcg_shared_module_exports__.Cc(ge):void 0;K&&(z[K]=!0)}}});for(let U in z){let D=Nu(this.listModel,U);D.length===1&&D[0].folderId!==L&&(O[D[0].id]=D[0])}let V={},$=[];for(let U in O){let D=O[U];$.push(D)}$.forEach(U=>{if(U.type==="expression"){let D=oT(U);D&&(V[U.id]=D)}}),$.sort((U,D)=>U.index-D.index);let G=this.findLastSubscriptForLetters();$.forEach(U=>{if(U.type==="expression"){let D=V[U.id];if(D){let de=this.getAutonameLatexForExpression(U,G);fd(this.listModel,D,de)}}}),$.forEach(U=>{Ag(this.listModel,U.id)});let W=N.index+this.getNumberOfItemsInFolder(L)+1;$.forEach(U=>{_s(this.listModel,U,W),W+=1}),$.forEach(U=>{_n(U,L)})}else if(x.prop==="visible")this.getAllSelectedItems().forEach(L=>{this.isItemReadonly(L.id)||(this._setItemHidden(L.id,!x.value),x.value===!1&&L.type==="expression"&&Ku(L,!1))});else if(e.update.prop==="color"){let L=e.update.value;this.getAllSelectedItems().forEach(N=>{N.type==="expression"&&iT(N,L)})}else if(e.update.prop==="colorLatex"){let L=e.update.value;this.getAllSelectedItems().forEach(N=>{N.type==="expression"&&Rw(N,L)})}else if(e.update.prop==="showLabel"){let L=e.update.value;this.getAllSelectedItems().forEach(N=>{N.type==="expression"&&Ku(N,L)})}else if(e.update.prop==="label"){let L=e.update.value;this.getAllSelectedItems().forEach(N=>{N.type==="expression"&&yd(N,L)})}else if(e.update.prop==="dragMode"){let L=e.update.value;this.getAllSelectedItems().forEach(N=>{N.type==="expression"&&Mg(N,L)})}else if(e.update.prop==="lineWidth"){let L=e.update.value;this.getAllSelectedItems().forEach(N=>{N.type==="expression"&&db(N,L)})}else if(e.update.prop==="lineOpacity"){let L=e.update.value;this.getAllSelectedItems().forEach(N=>{N.type==="expression"&&cb(N,L)})}else if(e.update.prop==="lineStyle"){let L=e.update.value;this.getAllSelectedItems().forEach(N=>{N.type==="expression"&&nT(N,L)})}else if(e.update.prop==="strictIntersection"){let L=e.update.value;this.getAllSelectedItems().forEach(N=>{N.type==="expression"&&eH(N,L)})}else if(e.update.prop==="disableGraphInteractions"){let L=e.update.value;this.getAllSelectedItems().forEach(N=>{N.type==="expression"?RL(N,L):N.type==="image"&&YG(N,L)})}}break;case"delete-all-selected-items":{let{deletedItems:x,readonlyItemsNotDeleted:L}=this.removeListOfItems(this.getSelectedExpressionIds());this.garbageCollectGeo(x,{}),this.ensureAtLeastOneVisibleItem(),x.length>0&&yt(this.s("graphing-calculator-narration-items-deleted",{count:__dcg_shared_module_exports__.ra(x.length)})),L>0&&yt(this.s("graphing-calculator-narration-locked-items-not-deleted",{count:__dcg_shared_module_exports__.ra(L)})),xe();break}case"upward-delete-selected-expression":hR(this,{moveSelection:!1});break;case"downward-delete-selected-expression":gR(this,{moveSelection:!1});break;case"table-show-more-rows":{let x=this.getItemModel(e.id);if(!x||x.type!=="table")return;let L=Eg(x);if(!L)return;Nr(this.listModel,x),Nf(x,!0),qr(this,{type:"table",id:x.id,location:{row:L.min,column:0}})}break;case"navigate-table-by-key":U$(this,e.id,e.key);break;case"delete-item-and-animate-out":this._deleteItemAndAnimateOut(e.id,e.setFocusAfterDelete);break;case"finish-deleting-item-after-animation":this._finishDeletingItemAfterAnimation(e.id,e.setFocusAfterDelete);break;case"expression-zoom-fit":this._expressionZoomFit(e.id,{focusAfterTap:e.focusAfterTap,synchronous:!1,justResiduals:!1});break;case"expression-zoom-fit-residuals":this._expressionZoomFit(e.id,{focusAfterTap:e.focusAfterTap,synchronous:!1,justResiduals:!0});break;case"set-expression-properties-from-api":this._setExpressionPropertiesFromAPI(e.id,e.properties);break;case"add-item-to-end-from-api":this._addItemToEndFromAPI(this.createItemModel(e.state));break;case"duplicate-expression":{let x=this.getItemModel(e.id);if(!x||x.type==="folder")return;this.copyExpressionToIndex(x,x.index+1)}break;case"duplicate-folder":{let{id:x}=e,L=this.getItemModel(x);if(!L||L.type!=="folder")return;let N=this.createItemModel(ie(R({},xE(L,{stripDefaults:!1})),{id:this.generateId()})),O=this.getNumberOfItemsInFolder(x),z=O+1;this._toplevelInsertItemAt(L.index+z,N,!1,void 0);let V=L.index+1,$=V+O;for(let G=V;G<=$;G++){let W=kg(this.listModel,G);if(!W||W.type==="folder")return;this.copyExpressionToIndex(W,G+z,N.id)}}break;case"insert-item-at-index":{let x=this.createItemModel(e.state);this._toplevelInsertItemAt(e.index,x,e.focus,e.folderId)}break;case"new-expression-at-end":{this.setGeoTool("selection");let x=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});this.setEditListMode(!1),ol(this.listModel,x),bi(this,x.id)}break;case"new-expression":{let x=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});this.setEditListMode(!1),this._toplevelNewItemAtSelection(x,{shouldFocus:!0}),this._closeAddExpression()}break;case"new-text":{let x=this.createItemModel({id:this.generateId(),type:"text"});this._toplevelNewItemAtSelection(x,{shouldFocus:!0}),this._closeAddExpression()}break;case"new-folder":{let x=this.createItemModel({type:"folder",id:this.generateId()});this._toplevelNewItemAtSelection(x,{shouldFocus:!0}),this._closeAddExpression()}break;case"new-images":this._uploadImagesAndWaitForThemToLoad({files:e.files}),this._closeAddExpression();break;case"change-image":this._uploadImagesAndWaitForThemToLoad({files:e.files,id:e.id});break;case"new-table":{let x=this._createTableItem();this._toplevelNewItemAtSelection(x,{shouldFocus:!0}),this._closeAddExpression()}break;case"paste-table":this._pasteTable(e.data);break;case"convert-or-create-table":this._convertOrCreateTable(e.index);break;case"insert-several-expressions":this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,this._insertSeveralExpressions(e.expressions);break;case"append-number-list":this._appendNumberList(e.latex);break;case"remove-item-by-id":Ag(this.listModel,e.id);break;case"replace-item-at-index":{let x=this.createItemModel(e.state);this._toplevelReplaceItemAt(e.index,x,e.focus)}break;case"create-sliders-for-item":this.createSlidersForItem(e.id,e.variables);break;case"create-sliders-for-ticker":this.createSlidersForTicker(e.variables);break;case"convert-image-to-draggable":this.convertImageToDraggable(e.id);break;case"start-dragdrop":{let x=this.getItemModel(e.dragTarget.calcId);if(!x)return;let L={x:0,y:0},N=this.getItemRootNodeById(x.id);if(N){let V=N.getBoundingClientRect();L.y=e.grabPt.y-V.top,L.x=e.grabPt.x-V.left}this.isItemSelected(x.id)?Nr(this.listModel,x):Nr(this.listModel,void 0),this.setGeoTool("selection");let O=!1,z=1;x.type==="folder"&&(z+=this.getNumberOfItemsInFolder(x.id),x.collapsed||(O=!0,Kf(x,!0))),_w(this.listModel,{firstItemId:x.id,numberOfItems:z,expandFolder:O,grabOffset:L,mousePt:e.mousePt,dragTarget:e.dragTarget,renderType:e.dragTarget.type,itemTop:0,itemLeft:0}),this.dragdrop_expressions.startDragging(e.mousePt)}break;case"update-dragdrop":{let x=this.listModel.dragState;if(!x)return;_w(this.listModel,ie(R({},x),{mousePt:e.mousePt}))}break;case"stop-dragdrop":{let x=this.listModel.dragState;if(!x)return;let L=this.getItemModel(x.firstItemId);if(!L)return;L.type==="folder"&&x.expandFolder&&Kf(L,!1),_w(this.listModel,void 0),this.ensureAtLeastOneVisibleItem()}break;case"set-selected-id":{let x=this.getItemModel(e.id);x?e.state==="selected"?Nr(this.listModel,x):(e.state,dq(this.listModel,x)):Nr(this.listModel,void 0)}break;case"set-all-selected-ids":rL(this.listModel,e.ids);break;case"toggle-selected-with-multi-select":tL(this.listModel,e.id,e.state);break;case"set-selected-index":{let x=this.getItemModelByIndex(e.index);Nr(this.listModel,x)}break;case"set-none-selected":Nr(this.listModel,void 0);break;case"commit-tentative-selection":{pq(this.listModel);break}case"clear-tentative-selection":{uq(this.listModel);break}case"set-focus-location":{let x=e.location?e.location.type:"";if(x==="expression"&&this.setGeoTool("selection"),x==="table"&&(this.layoutModel=ie(R({},this.layoutModel),{inEditListMode:!1})),x==="graph-paper"){this.setGraphPaperFocus({isFocused:!0});break}qr(this,e.location)}break;case"focus-first-expression":{this.focusFirstExpression();break}case"move-focus-to-item":bi(this,e.id,e.where);break;case"blur-focus-location":this.isFocusLocationFocused(e.location)&&qr(this,void 0),((t=e.location)==null?void 0:t.type)==="graph-paper"&&this.setGraphPaperFocus({isFocused:!1});break;case"set-folder-collapsed":{let x=this.getItemModel(e.id);if(!x||x.type!=="folder")return;Kf(x,e.isCollapsed)}break;case"set-all-folders-collapsed":xq(this.listModel,e.isCollapsed);break;case"set-item-secret":{let x=this.getItemModel(e.id);if(!x)return;fE(x,e.isSecret)}break;case"set-item-in-front-of-everything":{let x=this.getItemModel(e.id);if(!x||x.type!=="folder")return;Rz(x,e.inFrontOfEverything)}break;case"set-item-readonly":{let{id:x,readonly:L}=e,N=this.getItemModel(x);if(!N)return;if(yw(N,L),N.type==="folder")for(let O of O4(this.listModel,x))yw(O,L)}break;case"set-item-disable-graph-interactions":{let{id:x,disableGraphInteractions:L}=e,N=this.getItemModel(x);if(!N)return;switch(N.type){case"expression":RL(N,L);break;case"image":YG(N,L);break}break}case"set-tablecolumn-disable-graph-interactions":{let{tableId:x,columnId:L,disableGraphInteractions:N}=e,O=this.getItemModel(x);if(!O||O.type!=="table")return;let z=Eo(O,L);if(!z)return;Tz(z,N);break}case"set-tablecolumn-color":{let x=this.getItemModel(e.tableId);if(!x||x.type!=="table")return;mz(x,e.columnId,e.color)}break;case"set-tableregression-color":{let x=this.getItemModel(e.tableId);if(!x||x.type!=="table")return;fz(x,e.color)}break;case"set-tablecolumn-colorlatex":{let x=this.getItemModel(e.tableId);if(!x||x.type!=="table")return;lE(x,e.columnId,e.colorLatex)}break;case"set-show-cdf":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;fH(x,e.showCDF)}break;case"set-cdf-min":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;WE(x,e.latex)}break;case"set-cdf-max":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;$E(x,e.latex)}break;case"toggle-item-hidden":this._toggleItemHidden(e.id);break;case"toggle-tablecolumn-hidden":this._toggleTableColumnHidden(e.tableId,e.columnId);break;case"toggle-item-settings-menu":this.isItemSettingsMenuOpen(e.menu.guid)?this.closeItemSettingsMenu():(this.listModel.openItemMenu=e.menu,e.menu.focusFirstOption&&(e.menu.type==="geo-tool-dropdown"?qr(this,{type:"geo-basic-tool-menu-item",tool:e.menu.tools[0]}):e.menu.type==="multi-select-more"||e.menu.type==="multi-select-construct"||e.menu.type==="multi-select-style"||e.menu.type==="multi-select-label"?qr(this,{type:"generic-menu",where:"start"}):qr(this,{type:"expression-menu",id:e.menu.model.id,location:"start"})));break;case"close-item-settings-menu":this.closeItemSettingsMenu();break;case"toggle-fraction-evaluation":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;let L=Hu(x);$q(x,!L)}break;case"set-item-label":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;yd(x,e.label),this.enqueueEvent("userEditedLabel",e)}break;case"set-item-showlabel":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Ku(x,e.showLabel),!e.showLabel&&!zu(x)&&($w(x,!1),aT(x,"NONE"))}break;case"set-item-color":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;iT(x,e.color)}break;case"set-item-description":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression"&&x.type!=="image")return;x.type==="expression"?jq(x,e.description):x.type==="image"&&e4(x,e.description)}break;case"set-item-fill":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;xL(x,e.fill),this._setItemHidden(x.id,wb(x))}break;case"set-image-opacity":{let x=this.getItemModel(e.id);if(!x||x.type!=="image")return;o4(x,e.opacity),this._setItemHidden(x.id,!1)}break;case"set-image-in-foreground":{let x=this.getItemModel(e.id);if(!x||x.type!=="image")return;WG(x,e.foreground)}break;case"image-upload-error":this.__pendingImageUploads[e.token]&&(delete this.__pendingImageUploads[e.token],this._showToast({message:this.s("graphing-calculator-text-toast-image-upload-failed")}));break;case"image-upload-success":{if(this.__pendingImageUploads[e.token])if(delete this.__pendingImageUploads[e.token],e.id){let x=this.getItemModel(e.id);x&&x.type==="image"&&i4(x,e.url)}else{let x=this.createItemModel({type:"image",id:this.generateId(),width:e.width,height:e.height,image_url:e.url,name:e.name});this._toplevelNewItemAtSelection(x,{shouldFocus:!1})}this.isUploadingImages()||(this.toastData={})}break;case"image-load-success":{let x=this.getItemModel(e.id);if(!x||x.type!=="image")return;kE(x,"loaded"),this.imageRetryState={lastAttemptTime:0,attempts:0}}break;case"image-load-error":{let x=this.getItemModel(e.id);if(!x||x.type!=="image")return;kE(x,"failed")}break;case"image-retry-loading":{let x=this.getItemModel(e.id);if(!x||x.type!=="image")return;jG(x)}break;case"set-item-dragmode":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Mg(x,e.dragMode)}break;case"set-tablecolumn-dragmode":{let x=this.getItemModel(e.tableId);if(!x||x.type!=="table")return;gz(x,e.columnId,e.dragMode),e.dragMode!=="NONE"&&this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-points":{let x=this.getItemModel(e.tableId);if(!x||x.type!=="table")return;NG(x,e.columnId,e.bool),this._setTableColumnHidden(e.tableId,e.columnId,cE(x,e.columnId))}break;case"set-tablecolumn-lines":{let x=this.getItemModel(e.tableId);if(!x||x.type!=="table")return;pz(x,e.columnId,e.bool),this._setTableColumnHidden(e.tableId,e.columnId,cE(x,e.columnId))}break;case"set-tablecolumn-linestyle":{let x=this.getItemModel(e.tableId);if(!x||x.type!=="table")return;uz(x,e.columnId,e.lineStyle),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-linewidth":{let x=this.getItemModel(e.tableId);if(!x||x.type!=="table")return;iE(x,e.columnId,e.lineWidth),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-lineopacity":{let x=this.getItemModel(e.tableId);if(!x||x.type!=="table")return;nE(x,e.columnId,e.lineOpacity),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointsize":{let x=this.getItemModel(e.tableId);if(!x||x.type!=="table")return;aE(x,e.columnId,e.pointSize),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointopacity":{let x=this.getItemModel(e.tableId);if(!x||x.type!=="table")return;sE(x,e.columnId,e.pointOpacity),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointstyle":{let x=this.getItemModel(e.tableId);if(!x||x.type!=="table")return;dz(x,e.columnId,e.pointStyle),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-item-points":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;wL(x,e.points),this._setItemHidden(e.id,wb(x)),!e.points&&x.dragMode!=="NONE"&&Mg(x,"NONE")}break;case"set-item-pointstyle":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;vL(x,e.pointStyle),this._setItemHidden(e.id,!1)}break;case"set-item-lines":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;CL(x,e.lines),this._setItemHidden(e.id,wb(x))}break;case"set-item-extend-to-3D":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Xq(x,e.extendTo3D),this._setItemHidden(e.id,!1);let L=(r=this.grapher3d)==null?void 0:r.transition;L&&e.extendTo3D&&(L.objectIdExtendingTo3D&&((n=this.grapher3d)==null||n.webglLayer.setZboundsOnSurfaces(L.objectIdExtendingTo3D,-1/0,1/0)),L.objectIdExtendingTo3D=x.id,L.startTime=-1,L.duration=150)}break;case"set-item-linestyle":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;nT(x,e.lineStyle),this._setItemHidden(e.id,!1)}break;case"set-item-arrow-mode":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Jq(x,e.value),this._setItemHidden(e.id,!1);break}case"set-item-label-dropdown-open":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Yq(x,e.open)}break;case"set-item-fillopacity":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Lw(x,e.fillOpacity),this._setItemHidden(e.id,!1)}break;case"set-item-surfaceopacity":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Pw(x,e.surfaceOpacity),this._setItemHidden(e.id,!1)}break;case"set-item-lineopacity":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;cb(x,e.lineOpacity),this._setItemHidden(e.id,!1)}break;case"set-item-pointopacity":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Vw(x,e.pointOpacity),x.showLabel||this._setItemHidden(e.id,!1)}break;case"set-item-pointsize":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Ow(x,e.pointSize),this._setItemHidden(e.id,!1)}break;case"set-item-linewidth":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;db(x,e.lineWidth),this._setItemHidden(e.id,!1)}break;case"set-item-resolution":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;HE(x,e.resolution),this._setItemHidden(e.id,!1)}break;case"set-item-colorlatex":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Rw(x,e.colorLatex)}break;case"set-item-labelSize":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Fw(x,e.labelSize)}break;case"set-item-labelangle":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;KE(x,e.labelAngle)}break;case"set-item-label-orientation":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;SL(x,e.labelOrientation)}break;case"set-suppress-text-outline":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Qq(x,e.suppressTextOutline)}break;case"set-item-interactive-label":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;$w(x,e.interactiveLabel),e.interactiveLabel&&aT(x,"NONE")}break;case"set-item-editable-label-mode":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;x.editableLabelMode!=="NONE"&&e.editableLabelMode!=="NONE"&&x.editableLabelMode!==e.editableLabelMode&&yd(x,""),aT(x,e.editableLabelMode),e.editableLabelMode!=="NONE"&&$w(x,!1)}break;case"plot-residuals":{let x=this.getItemModel(e.id);if(!x)return;let L;if(x.type==="expression"?L=x.formula.regression:x.type==="table"&&((o=(i=x.formula)==null?void 0:i.table_regression)==null?void 0:o.status)==="success"&&(L=x.formula.table_regression.result),!L)return;let N=L.residualSuggestionId;if(!N)return;let O=this.getItemModel(N);if(!O)return;oE(O,{latex:L.residualVariable,columnIndex:O.columnModels.length-1}),qr(this,{type:"regression-output",id:e.id,parameter:"residual-zoom"})}break;case"toggle-logmode":{let x=this.getItemModel(e.id);if(!x)return;let L;x.type==="expression"?(L=x.isLogModeRegression,yL(x,!L)):x.type==="table"&&x.regression&&(L=x.regression.isLogMode,bz(x,!L)),L!==void 0&&this.logEvent({category:"regressions",action:L?"disable-log-mode":"enable-log-mode"})}break;case"set-item-latex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;let L=e.latex,N=x.latex;if(this.garbageCollectGeo([],{[x.id]:{prevLatex:N,nextLatex:L}}),(L==='"'||L==="note")&&this.areNotesEnabled()){let O=this.createItemModel({id:this.generateId(),type:"text"});this._toplevelReplaceItemAt(x.index,O,!0)}else if(L==="")CH(x);else if(L==="ticker"&&this.canAddTicker())this.listModel.ticker.open=!0,this.focusLocation={type:"ticker",location:"handler"},this._removeExpressionSynchronously(x);else if(L==="folder"&&this.areFoldersEnabled()){let O=this.createItemModel({id:this.generateId(),type:"folder"});Ca(x)?(this._toplevelNewItemAtSelection(O,{shouldFocus:!0}),$a(x,"")):this._toplevelReplaceItemAt(x.index,O,!0)}else if(L==="table"){let O=this._createTableItem();this._toplevelReplaceItemAt(x.index,O,!0)}else!this.isGeometry()&&(L==="betchacant"||L==="pride"||L==="teapot"&&this.is3dProduct())?this.runAfterDispatch(()=>{this.triggerEasterEgg&&this.triggerEasterEgg(L)}):($a(x,L),e.source==="user-edit"&&this.trackActionForPotentialEvaluatorRestart("edit",e.id))}break;case"set-visualization-prop":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Lq(x,e.prop,e.value)}break;case"set-clickableinfo-prop":{let x=this.getItemModel(e.id);if(!x)return;x.type==="expression"?Pq(x,e.prop,e.value):x.type==="image"&&_E(x,e.prop,e.value)}break;case"set-clickableinfo-rule-latex":{let x=this.getItemModel(e.id);if(!x)return;x.type==="expression"?UE(x,e.latex):x.type==="image"&&p4(x,e.latex)}break;case"set-folder-title":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let x=this.getItemModel(e.id);if(!x||x.type!=="folder")return;Pz(x,e.title)}break;case"set-image-mq-attribute":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let x=this.getItemModel(e.id);if(!x||x.type!=="image")return;ks(x,e.attribute,e.latex)}break;case"set-image-name":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let x=this.getItemModel(e.id);if(!x||x.type!=="image")return;t4(x,e.name)}break;case"set-image-draggable":{let x=this.getItemModel(e.id);if(!x||x.type!=="image")return;let L=jf(x);if(!L)return;KG(x,e.draggable),e.draggable&&(Ro(L)==="NONE"||L.dragMode==="AUTO")&&Mg(L,"XY")}break;case"update-degree-mode":{if(this.isComplexModeEnabled())return;this.graphSettings.setProperty("degreeMode",e.mode);break}case"set-graph-settings":{for(let x in e)x!=="type"&&(x==="xAxisScale"?this.switchAxisScale("xAxisScale",e.xAxisScale):x==="yAxisScale"?this.switchAxisScale("yAxisScale",e.yAxisScale):this.graphSettings.setProperty(x,e[x]));this.grapher3d&&this.isThreeDMode()&&(this.grapher2d.redrawAllLayersSynchronously(),"backgroundColor3d"in e&&this.grapher3d.webglLayer.setBackgroundColor(e.backgroundColor3d),this.apply3dProps(e))}break;case"set-polar-mode":if(this.graphSettings.setProperty("polarMode",e.polarMode),e.polarMode){let x=this.graphSettings.xAxisScale==="logarithmic"||this.graphSettings.yAxisScale==="logarithmic",L=this.getGrapher2d();x&&L&&(this.graphSettings.setProperty("xAxisScale","linear"),this.graphSettings.setProperty("yAxisScale","linear"),L.viewportController.setViewport(L.getDefaultViewport()),L.getProjection().updateScalePairs())}break;case"set-domain-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Ka(x,e.latex,e.variable)}break;case"set-domain-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Wa(x,e.latex,e.variable)}break;case"set-note-text":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let x=this.getItemModel(e.id);if(!x||x.type!=="text")return;XG(x,e.text)}break;case"set-edit-list-mode":{let x=Ig(this.listModel);if(this.setEditListMode(e.isEditListMode),e.focusExpressionList){if(x===void 0&&(x=this.getItemModelByIndex(0)),!x)return;bi(this,x.id,x.type==="table"&&e.isEditListMode?"container":"start")}else Nr(this.listModel,void 0),qr(this,void 0)}break;case"set-ghost-mode":this.getGraphSettings().config.setProperty("ghostMode",e.value);break;case"set-projector-mode":this.getGraphSettings().config.setProperty("projectorMode",e.value),this.isThreeDMode()&&this.grapher2d.redrawAllLayersSynchronously();break;case"set-inverted-colors":this.getGraphSettings().config.setProperty("invertedColors",e.value);break;case"set-tablecell-latex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let x=this.getItemModel(e.tableId);if(!x||x.type!=="table")return;vp(x,e.cell,e.latex)}break;case"set-state":this.externalSetState(e.state,e.opts);break;case"set-blank":this.externalSetState(this.getBlankState({degreeMode:e.degreeMode}),e.opts);break;case"restore-history":{let{currentState:x,history:L}=X$(e.history);this.setState(x),this.stateStack=L.clone()}break;case"clear-unsaved-changes":this.enqueueEvent("clearUnsavedChanges",e);break;case"reset-graph":{let x=this.getState();this.externalSetState(this.graphSettings.defaultState,{allowUndo:!0}),this.setGeoTool("selection"),this.graphSettings.config.expressions?this.focusFirstExpression():this.setGraphPaperFocus({isFocused:!0}),this._showToast({message:this.s("graphing-calculator-text-toast-graph-reset"),undoCallback:()=>this.dispatch({type:"set-state",state:x,opts:{allowUndo:!0}})}),this.enqueueEvent("graphReset",e)}break;case"clear-graph":{if(this.triggerClearGraph){this.runAfterDispatch(()=>this.triggerClearGraph());return}let x=this.getState();this.externalSetState(this.getBlankState(),{allowUndo:!0});let L=this.getItemModelByIndex(0);L&&bi(this,L.id,"end"),this._showToast({message:this.s("graphing-calculator-text-toast-graph-cleared"),undoCallback:()=>this.dispatch({type:"set-state",state:x,opts:{allowUndo:!0}})}),this.enqueueEvent("graphReset",e)}break;case"hide-progress-update-legend":this.progressUpdateLegendHidden=!0;break;case"evaluator-progress-update":this.handleEvaluatorProgressUpdates();break;case"on-evaluator-changes":{if(this.onEvaluatorChangesSpy&&this.onEvaluatorChangesSpy(e.changes,e.timingData,e.graphData,e.eventUpdates),this.clearSlowEvaluatorTracking(),this.evaluator.cancelRestartWorker(),lq(this.listModel,e.changes,e.dependencyOrder),(a=this.toneController)==null||a.recomputeAudio(),e.type==="on-evaluator-changes"&&!this.getIncludeFunctionParametersInRandomSeed()&&!gq(this.listModel)&&this.stateStack.getState()&&this.setIncludeFunctionParametersInRandomSeed(!0),!e.graphData)break;for(let x in e.graphData.addedGraphs){let L=e.graphData.addedGraphs[x];if(__dcg_shared_module_exports__.tc(L)){let N=L.filter(z=>!__dcg_shared_module_exports__.L(z.graphMode)),O=L.filter(z=>__dcg_shared_module_exports__.L(z.graphMode));(s=this.grapher2d)==null||s.updateSketch(x,N),(l=this.grapher3d)==null||l.updateSketch(x,O),sq(this.listModel,x,L)}}for(let x in e.graphData.removedGraphs)(c=this.grapher2d)==null||c.removeGraphSketch(x),(d=this.grapher3d)==null||d.removeGraphSketch(x);if(this.isThreeDMode())(u=this.grapher2d)==null||u.redrawAllLayersSynchronously();else{for(let x in e.graphData.intersections){let L=e.graphData.intersections[x];__dcg_shared_module_exports__.tc(L)&&((p=this.grapher2d)==null||p.updateIntersections(x,L))}(g=this.get2dPOIController())==null||g.handleTraceUpdate(),(f=this.getAudioGraph())==null||f.handleEvaluatorChange(e.graphData)}if(e.eventUpdates){let x=!1;for(let L in e.eventUpdates.updates)if(this.doesIdentifierBlockActionUpdate(L)){x=!0;break}if(!x){for(let L in e.eventUpdates.updates)this.updateLatexForIdentifier(L,e.eventUpdates.updates[L]);e.eventUpdates.objectClicked&&this.enqueueEvent("userClickedObject",e),this.onActionUpdatesAppliedSpy&&this.onActionUpdatesAppliedSpy(e.eventUpdates)}}}break;case"add-helper-expression":Y4(this.listModel,e.state);break;case"tick":this._tickSliders(e.time);break;case"tick-ticker":this.tickTicker(e.time);break;case"adjust-slider-by-keyboard":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Dq(x,e.adjustment)}break;case"adjust-slider-by-dragging-thumb":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;kq(x,e.target)}break;case"set-slider-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;sb(x,e.latex)}break;case"set-slider-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;lb(x,e.latex)}break;case"set-slider-steplatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Gw(x,e.latex)}break;case"set-slider-dragging":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Ww(x,e.dragging)}break;case"play-slider-from-min":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;let L=nl(x);if(isNaN(L))return;let N=qu(x.latex,L);As(x,!1),$a(x,N),As(x,!0)}break;case"set-slider-isplaying":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;As(x,e.isPlaying)}break;case"set-slider-loopmode":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Kq(x,e.loopMode)}break;case"set-slider-animationperiod":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression")return;Wq(x,e.animationPeriod)}break;case"show-expressions-list":this._showExpressions(e.focusHideIcon);break;case"hide-expressions-list":this._hideExpressions(e.focusShowIcon);break;case"open-drawer":this.enqueueEvent("openDrawer",e);break;case"re-randomize":this.setRandomSeed(rd());break;case"resize-exp-list":this._setExpListWidth(e.expListWidth);break;case"toast/show":this._showToast(e.toast);break;case"toast/close":this.closeToast();break;case"toast/undo":let M=this.toastData.undoCallback;M&&this.runAfterDispatch(M),this.toastData={};break;case"toast/learn-more":let C=this.toastData.learnMoreCallback;C&&this.runAfterDispatch(C),this.toastData={};break;case"start-moving-points":b$(this,this.listModel,e.points);break;case"stop-moving-points":x$(this,e.points);break;case"on-move-points":y$(this,e.points,e.previousScreenPts,e.screenPts,e.projection,e.transform,e.keyboardDirection)&&this.enqueueEvent("userMovedPoint",e);break;case"commit-user-requested-viewport":this._commitUserRequestedViewport(e.viewport);break;case"commit-user-requested-rotation":this.graphSettings.setProperty("worldRotation3D",e.worldRotation3D),this.graphSettings.setProperty("axis3D",e.axis3D),this.graphSettings.setProperty("speed3D",e.speed3D);break;case"toggle-lock-viewport":this.graphSettings.setProperty("userLockedViewport",!this.graphSettings.userLockedViewport);break;case"toggle-complex-mode":{let x=this.getState({avoidBackMigration:!0});x.graph.complex=!x.graph.complex,x.graph.degreeMode=!1,this.setState(x,{allowUndo:!0});break}case"set-axis-limit-latex":this._setAxisLimitLatex(e.limit,e.latex),e.updateYZAlso&&(this._setAxisLimitLatex(e.limit==="xmin"?"ymin":"ymax",e.latex),this._setAxisLimitLatex(e.limit==="xmin"?"zmin":"zmax",e.latex)),this.lastDirectlyEditedViewport=(y=this.getGrapher())==null?void 0:y.getCurrentViewport();break;case"toggle-graph-settings":this.layoutModel=ie(R({},this.layoutModel),{graphSettingsOpen:!this.layoutModel.graphSettingsOpen}),Nr(this.listModel,void 0),e.focusOnOpen&&(this.layoutModel.graphSettingsOpen?this.is3dProduct()?qr(this,{type:"settings",location:"reverse-contrast"}):this.getGraphSettings().config.projectorMode?qr(this,{type:"settings",location:"large-size"}):qr(this,{type:"settings",location:"default-size"}):qr(this,{type:"settings",location:"icon"}));break;case"close-graph-settings":this.layoutModel=ie(R({},this.layoutModel),{graphSettingsOpen:!1}),e.focusIconAfterClose&&qr(this,{type:"settings",location:"icon"});break;case"toggle-add-expression":this.layoutModel=ie(R({},this.layoutModel),{addExpressionOpen:!this.layoutModel.addExpressionOpen}),e.focusOnOpen&&this.layoutModel.addExpressionOpen&&qr(this,{type:"add-expression-btn"});break;case"close-add-expression":this._closeAddExpression(),e.focusIconAfterClose&&qr(this,{type:"add-item-btn"});break;case"ui/container-resized":this.layoutMeasurements={width:e.size.width,height:e.size.height},this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;break;case"enter-printmode":this.inPrintMode=!0;break;case"exit-printmode":this.inPrintMode=!1;break;case"expression-size-exceeded":this._showToast({message:this.s("graphing-calculator-text-toast-expression-size-limit")});break;case"keypad/set-layout":this.layoutModel=ie(R({},this.layoutModel),{keypadLayout:e.layout,keypadFunctionsOpen:!1});break;case"keypad/set-minimized":this.layoutModel=ie(R({},this.layoutModel),{keypadMinimized:e.minimized,keypadLayout:"mainNumbers"}),this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,this.needsFakeKeypad()||F$(this),xe(e.minimized?this.s("graphing-calculator-narration-keypad-hidden"):this.s("graphing-calculator-narration-keypad-visible"));break;case"keypad/type-text":this.layoutModel=ie(R({},this.layoutModel),{keypadFunctionsOpen:!1}),this.runAfterDispatch(()=>{let x=Fe.getFocusedMathquill();x&&Fe.canAcceptText(x,this.getCapExpressionSize(),e.text)&&(x.typedText(e.text),Fe.simulateUserChangedLatex(x))});break;case"keypad/press-key":this.layoutModel=ie(R({},this.layoutModel),{keypadFunctionsOpen:!1}),this.runAfterDispatch(()=>{let x=Fe.getFocusedMathquill();x&&Fe.simulateKeypressFromKeypad(x,e.key)});break;case"keypad/audio-trace":this.handleAudioTraceCommand(e.command);break;case"set-audio-trace-speed":this.setAudioTraceSpeed(e.speed);break;case"keypad/custom-command":this.layoutModel=ie(R({},this.layoutModel),{keypadFunctionsOpen:!1}),this.runAfterDispatch(()=>{let x=Fe.getFocusedMathquill();x&&(ZI(x,e.command,{capExpressionSize:this.getCapExpressionSize()}),Fe.simulateUserChangedLatex(x))});break;case"keypad/shift":this.layoutModel=ie(R({},this.layoutModel),{keypadLayout:Q$(this.getKeypadLayout()),keypadFunctionsOpen:!1});break;case"keypad/123":this.layoutModel=ie(R({},this.layoutModel),{keypadLayout:"mainNumbers",keypadFunctionsOpen:!1});break;case"keypad/abc":this.isQwertyKeyboardEnabled()?this.layoutModel=ie(R({},this.layoutModel),{keypadLayout:"letters",keypadFunctionsOpen:!1}):this.layoutModel=ie(R({},this.layoutModel),{keypadLayout:"noQwertyLetters",keypadFunctionsOpen:!1});break;case"keypad/audio":this.layoutModel=ie(R({},this.layoutModel),{keypadMinimized:!1,keypadLayout:"audio",keypadFunctionsOpen:!1});break;case"keypad/functions":this.layoutModel=ie(R({},this.layoutModel),{keypadFunctionsOpen:!this.isKeypadFunctionsPopoverOpen()});break;case"grapher/drag-start":break;case"grapher/drag-move":break;case"grapher/drag-end":break;case"open-on-web":this._openOnWeb();break;case"file-is-dragged-over":this.listModel.openItemMenu=void 0,this.layoutModel=ie(R({},this.layoutModel),{isFileDraggedOver:!0});break;case"file-is-not-dragged-over":this.layoutModel=ie(R({},this.layoutModel),{isFileDraggedOver:!1});break;case"zoom":(E=this.getGrapher())==null||E.viewportController.zoom(e.direction);break;case"set-hovered-image":{let x=this.getItemModel(e.id);if(!x||x.type!=="image")return;_E(x,"hoveredImage",e.url)}break;case"set-depressed-image":{let x=this.getItemModel(e.id);if(!x||x.type!=="image")return;_E(x,"depressedImage",e.url)}break;case"clickable-item-clicked":this.handleClickableItemClicked(e.id,e.listIndex);break;case"action-single-step":{let x=this.getItemModel(e.id);if(!x||x.type!=="expression"||!x.formula.action_value)return;this.evaluator.addActionStepEvent(x.id)}break;case"update-expression-search-str":this.updateExpressionSearchStr(e.str);break;case"update-expression-replace-str":this.updateExpressionReplaceStr(e.str);break;case"rename-identifier-global":fd(this.listModel,e.search,e.replace);break;case"rename-identifier-in-item":let P=this.getItemModel(e.id);P&&P.type==="folder"?fd(this.listModel,e.search,e.replace,{limitToFolder:e.id}):fd(this.listModel,e.search,e.replace,{limitToItem:e.id});break;case"update-ticker-handlerlatex":this.updateTickerHandlerLatex(e.latex);break;case"update-ticker-minsteplatex":this.updateTickerMinStepLatex(e.latex);break;case"set-braille-mode":this.setBrailleMode(e.mode);break;case"set-six-key-input":this.setSixKeyInput(e.useSixKeyInput);break;case"set-show-constructions-open":if(this.showConstructionsOpen=e.open,e.setFocus)if(!e.open)qr(this,{type:"geo-show-constructions-icon"});else for(let x in this.cachedGeoTokenInfo){let{calcId:L}=this.cachedGeoTokenInfo[x];if(this.getItemModel(L)){qr(this,{type:"geo-token",identifier:x});break}}break;case"select-geo-tool":this.listModel.openItemMenu=void 0,this.setGeoTool(e.tool),e.forceSingleUse&&this.geoModel.markCurrentToolSingleUse(),__dcg_shared_module_exports__.Dc(e.tool)||e.tool==="selection"||Nr(this.listModel,void 0),e.focusGraphPaper&&this.setGraphPaperFocus({isFocused:!0}),this.closeToast();break;case"cancel-geo-toolplay":this.cancelGeoToolplay(),this.geoModel.getNonObjectsState().ui.currentTool.forceSingleUse&&this.setGeoTool("selection");break;case"update-click-to-insert-mode":this.getGeoModel().setClickToInsertMode(e.clickToInsertMode);break;case"commit-geo-objects":{let x=[],L=[],N=this.findLastSubscriptForLetters(),O={},z=de=>{let ge=O[de];if(ge)return ge.assignmentLatex;let K=this.getItemModel(de);if(!K||K.type!=="expression")return de;let se=this._autoNameExpression(K,N);return ge=O[de]={model:K,assignmentLatex:se},ge.assignmentLatex},V=[],$=lV(e.committed,{isBeingCommitted:!0,getVariableNameForId:z});for(let de in e.committed){let ge=e.committed[de];__dcg_shared_module_exports__.Dc(ge.type)&&V.push(de);let K=$[de];(K==null?void 0:K.type)==="assignment"&&(K.sliderInfo?L.push({latex:K.latex,color:K.color,sliderInfo:K.sliderInfo}):x.push(ie(R({},K),{tokenId:de})))}let G=this.listModel.__toolPreviewIdToModel;if(x.length){let de=this.getGeometryFolder(),ge=de?de.index+this.getNumberOfItemsInFolder(de.id)+1:0;x.forEach(K=>{var se;let H;for(let Z in G){let ce=G[Z];if(((se=pi(ce))==null?void 0:se.latex)===K.tokenId){H=ce;break}}H?(H.latex=K.latex,H.color=K.color,H.showLabel=!!K.showLabel,H.showAngleLabel=K.showAngleLabel!==!1,de&&(H.folderId=de.id)):H=this.createItemModel({id:this.generateId(),type:"expression",showLabel:K.showLabel,showAngleLabel:K.showAngleLabel,latex:K.latex,folderId:de&&de.id,color:K.color}),de?(_s(this.listModel,H,ge),ge+=1):ol(this.listModel,H),this.getGeoModel().recordCommittedOutput(H.id)})}L.forEach(de=>{let ge;for(let K in G){let se=G[K];if(se.latex===de.latex){ge=se;break}}ge?(ge.latex=de.latex,ge.color=de.color,sb(ge,de.sliderInfo.min),lb(ge,de.sliderInfo.max)):ge=this.createItemModel({id:this.generateId(),type:"expression",latex:de.latex,color:de.color,slider:{hardMin:!0,hardMax:!0,min:de.sliderInfo.min,max:de.sliderInfo.max}}),_s(this.listModel,ge,0),this.getGeoModel().recordCommittedOutput(ge.id)}),V.length===1&&this.transformAllSelectedItemsByAssignmentLatex(V[0]),(this.geoModel.isCurrentToolSingleUse()||e.clearToolAndSelection)&&this.setGeoTool("selection"),e.clearToolAndSelection&&Nr(this.listModel,void 0);let W=e.toolIdToLatex[1],U=$[W],D=(U==null?void 0:U.type)==="inline"?U.rhs:W;if(this.geoModel.getToolMode()==="expression-edit"&&D){let de=sV(D,z);this.writeIdentifierIntoCurrentMathquill(de)}this.isGeometry()&&this.getGeoModel().updateFadeAnimations()}break;case"rename-identifier":{let x=e.from,L=e.to,N=__dcg_shared_module_exports__.na(x),O=this.getGeometryFolder();O&&this.getItemsByIdentifier(N).forEach(z=>{e.geoFolder&&z.folderId!==O.id?(_n(z,O.id),Uu(this.listModel,z.index,O.index+1,1)):!e.geoFolder&&z.folderId===O.id&&(Uu(this.listModel,z.index,O.index+this.getNumberOfItemsInFolder(O.id),1),_n(z,""))}),fd(this.listModel,x,L)}break;case"set-active-token":this.activeTokens[e.style]=e.identifier;break;case"unset-active-token":this.activeTokens[e.style]===e.identifier&&(this.activeTokens[e.style]=void 0);break;case"select-expression-that-defines-token":{let x=this.getExpressionIdForIdentifier(e.identifier);if(!x||(this.setGeoTool("selection"),this.isItemNotSelectableBecauseItsSecret(x)))return;e.multiSelectMode||e.toggle?tL(this.listModel,x,"selected"):this.tryInsertTokenIntoMathquill(x,void 0)||Nr(this.listModel,this.getItemModel(x))}break;case"close-expression-search":this.closeExpressionsSearch();break;case"open-expression-search":this.expressionSearchOpen=!0,this.focusLocation={type:"search-expressions"};let F=e.latex;e.rename&&!ya(F)&&(F="");let B=e.rename?F?`\\operatorname{rename}\\ ${F}\\to`:"\\operatorname{rename}\\ ":F;this.updateExpressionSearchStr(B);break;case"open-ticker":this.listModel.ticker.open=!0,this.focusLocation={type:"ticker",location:"handler"},this._closeAddExpression();break;case"close-ticker":this.listModel.ticker.open=!1,this.listModel.ticker.playing=!1,this.listModel.ticker.minStepLatex="",this.listModel.ticker.handlerLatex="";break;case"toggle-ticker":this.listModel.ticker.playing=!this.listModel.ticker.playing,this.listModel.ticker.lastTickTime=void 0,this.pauseAllSliders();break;case"set-tool-preview-state":this.setToolPreviewState(e.state);break;case"apply-transformation-to-selected":this.transformAllSelectedItemsByAssignmentLatex(e.assignmentLatex),this.closeItemSettingsMenu();break;case"set-geometry-toolbar":{jz(this.geometryToolbarModel,e.toolbar);break}case"set-geometry-custom-toolbar-setting":{vE(this.geometryToolbarModel,e.tool,e.value);break}case"set-author-mode":{this.setAuthorMode(e.enabled);break}case"set-translucent-surfaces":{this.getGraphSettings().config.setProperty("translucentSurfaces",e.value);break}case"set-perspective-distortion":{this.getGraphSettings().config.setProperty("perspectiveDistortion",e.value),(_=this.grapher3d)==null||_.redrawAllLayers();break}case"mute-global":case"unmute-global":{e.type==="unmute-global"&&this.runAfterDispatch(()=>{var x;(x=this.getAudioGraph())==null||x.exitAudioTrace()}),(w=this.toneController)==null||w.handleAction(e),this.getGraphSettings().config.setProperty("muted",e.type==="mute-global");break}case"mark-too-complex-for-gl":{for(let x of e.errors){let L=this.getItemModel(x);L&&L.type==="expression"&&(L.expressionTooComplex=!0)}for(let x of e.fixed){let L=this.getItemModel(x);L&&L.type==="expression"&&(L.expressionTooComplex=!1)}break}case"update-legacy-random-seed-behavior":{this.setIncludeFunctionParametersInRandomSeed(!0),this.setState(this.getState(),{allowUndo:!0});break}case"add-poi-expression":{let x=this.getNextColor();x===zf&&(x=this.getNextColor());let L=this.createItemModel({type:"expression",id:this.generateId(),latex:e.latex,color:x});this.setEditListMode(!1),ol(this.listModel,L),bi(this,L.id);break}case"create-table-regression":{let x=this.getItemModel(e.tableId);if((x==null?void 0:x.type)==="table"&&this.areTableRegressionsEnabled()){let L=e.columnIds;if(!L){let N=x.columnModels.slice(1).filter(O=>Cp(O)&&Ru(O));if(N.length===0)break;L={x:x.columnModels[0].id,y:N[0].id}}bw(x,{type:e.regressionType,columnIds:L,id:this.generateId(),color:this.getNextColor(),lineStyle:"SOLID",hidden:!1,isLogMode:this.areLogModeRegressionsDefault()||this.areLogModeRegressionsForced(),residualVariable:void 0}),qr(this,{type:"table-regression-type-dropdown",id:e.tableId})}break}case"remove-table-regression":{let x=this.getItemModel(e.tableId);if((x==null?void 0:x.type)==="table"){if(((T=(v=x.formula)==null?void 0:v.table_regression)==null?void 0:T.status)==="success"){let L=x.formula.table_regression.result.residualVariable;if(L){let N=x.columnModels.findIndex(O=>O.latex===L);N>=0&&mw(x,N)}}bw(x,void 0),qr(this,{type:"add-table-regression-btn",id:e.tableId})}break}case"update-table-regression":{let x=this.getItemModel(e.tableId);if((x==null?void 0:x.type)==="table"&&x.regression){let L=R(R({},x.regression),e.update);bw(x,L)}break}case"export-table-regression":{this.exportTableRegression(e.mode,e.tableId);break}default:return e}}areTableRegressionsEnabled(){return this.getGraphSettings().config.tableRegressions}switchAxisScale(e,t){var r;if(!t||t===this.graphSettings[e])return;this.graphSettings.setProperty("polarMode",!1);let n;this.getAllItemModels().forEach(i=>{if(this.isExpressionZoomFit(i)){if(!this.getBoundingBoxesForZoomFit(i))return;n=i.id}}),this.graphSettings.setProperty(e,t),(r=this.getGrapher2d())==null||r.getProjection().updateScalePairs(),!(n&&this._expressionZoomFit(n,{focusAfterTap:!1,synchronous:!0,justResiduals:!1}))&&this.enforceAxisLimitsForScale(e)}enforceAxisLimitsForScale(e){let t=this.getGrapher2d();if(!t)return;let r=t.getDefaultViewport();if(!r)return;e==="xAxisScale"?(this._setAxisLimitLatex("xmin",__dcg_shared_module_exports__.la(r.xmin)),this._setAxisLimitLatex("xmax",__dcg_shared_module_exports__.la(r.xmax))):(this._setAxisLimitLatex("ymin",__dcg_shared_module_exports__.la(r.ymin)),this._setAxisLimitLatex("ymax",__dcg_shared_module_exports__.la(r.ymax))),this.graphSettings.xAxisScale===this.graphSettings.yAxisScale&&(this.graphSettings.setProperty("lastChangedAxis",e==="xAxisScale"?"y":"x"),t.viewportController.zoomSquareImmediately(),this.markSquareAxesAfterUserEditedViewport());let n=t.viewportController.getViewport(),i=t.getProjection(),{xmin:o,xmax:a,ymin:s,ymax:l}=n,c=this.getGraphSettings().config.logScales;if(e==="xAxisScale"&&c){let d=i.mapx(o),u=i.mapx(a),p=ho(i.reverse_mapx(d-.25),i.reverse_mapx(d+.25)),g=ho(i.reverse_mapx(u-.25),i.reverse_mapx(u+.25));this._setAxisLimitLatex("xmin",__dcg_shared_module_exports__.la(p)),this._setAxisLimitLatex("xmax",__dcg_shared_module_exports__.la(g))}if(e==="yAxisScale"&&c){let d=i.mapy(s),u=i.mapy(l),p=ho(i.reverse_mapy(d-.25),i.reverse_mapy(d+.25)),g=ho(i.reverse_mapy(u-.25),i.reverse_mapy(u+.25));this._setAxisLimitLatex("ymin",__dcg_shared_module_exports__.la(p)),this._setAxisLimitLatex("ymax",__dcg_shared_module_exports__.la(g))}this.lastDirectlyEditedViewport=t.getCurrentViewport()}_convertOrCreateTable(e){let t=this.getItemModelByIndex(e),r=Sg(t),n=ZS(t);if((t==null?void 0:t.type)!=="expression")return;let i=this.isInEditListMode(),o;switch(r){case"point-list":o=DU(t);break;case"point-list-reference":o=kU(t);break;case"anonymous-function":o=_U(t);break;case"function-reference":o=MU(t);break;case"recursive-function":o=AU(t);break}if(i&&this.setEditListMode(!1),!r||!o){this._showToast({message:this.s("graphing-calculator-text-table-creation-error")}),t.latex;return}let a={id:this.generateId(),type:"table",readonly:t.readonly,columns:[ie(R({},dg),{id:this.generateId(),latex:o.headers[0],values:o.values[0]}),ie(R({},dg),{id:this.generateId(),latex:o.headers[1],values:o.values[1],color:t.color,lines:!n&&!!t.lines})]},s=this.createItemModel(a);if(n){let c=t.index+1;if(r==="recursive-function"){let d=t.formula.function_definition;for(;this.isBaseCaseItem(c,d);)c++}this._toplevelInsertItemAt(c,s,!0,t.folderId)}else this._toplevelReplaceItemAt(t.index,s,!0);let l=()=>{this.dispatch({type:"undo"}),i&&this.dispatch({type:"set-edit-list-mode",isEditListMode:!0,focusExpressionList:!1})};this._showToast({message:this.s("graphing-calculator-text-table-created"),undoCallback:l}),this.logEvent({category:"convert-to-table",action:r})}isBaseCaseItem(e,t){var r;let n=this.getItemModelByIndex(e);return!n||n.type!=="expression"||!t?!1:((r=n.formula.recursion_base_case)==null?void 0:r.symbol)===t}hasTableHeaderWithIdentifier(e){return!!e&&U4(this.listModel,e)}updateGraphSettingsViewportLimitsLatex(e){this._setAxisLimitLatex("xmin",e.xmin+""),this._setAxisLimitLatex("xmax",e.xmax+""),this._setAxisLimitLatex("ymin",e.ymin+""),this._setAxisLimitLatex("ymax",e.ymax+""),this._setAxisLimitLatex("zmin",e.zmin+""),this._setAxisLimitLatex("zmax",e.zmax+"")}transformAllSelectedItemsByAssignmentLatex(e){var t,r;let n=FE(this.listModel),i=this.findLastTokenNumber()+1,o=this.findLastSubscriptForLetters(),a=this.getGeometryFolder(),s=a?a.index+this.getNumberOfItemsInFolder(a.id)+1:0,l={};for(let d of n){if(d.type!=="expression"||!d.formula.geometry)continue;let u=(t=d.formula.typed_constant_value)==null?void 0:t.valueType;if(!u||__dcg_shared_module_exports__.Ab(u,__dcg_shared_module_exports__.Za))continue;let p=(r=pi(d))==null?void 0:r.latex;p||(p=this._autoNameExpression(d,o));let g=`\\token{${i}}`;i+=1;let f=`${g}=${e}\\left(${p}\\right)`,y=this.createItemModel({id:this.generateId(),type:"expression",showLabel:d.showLabel&&!d.label,showAngleLabel:d.showAngleLabel&&!d.label,latex:f,folderId:a&&a.id,color:d.color});l[y.id]=!0,a?(_s(this.listModel,y,s),s+=1):ol(this.listModel,y)}let c=Object.keys(l);if(c.length&&rL(this.listModel,l),c.length===1){let d=c[0];this.runAfterDispatch(()=>{this.getItemModel(d)&&this.get2dPOIController().keyboardAttentionManager.updateKeyboardAttention({calcId:d,listIndex:void 0,polygonEdge:void 0},{describe:!1})})}}convertToTokenAssignment(e,t=""){var r;let n=(r=pi(e))==null?void 0:r.latex,i=t?Nx(t)||"":"\\token{"+(this.findLastTokenNumber()+1)+"}";n?fd(this.listModel,n,i):$a(e,i+"="+e.latex)}convertToNamedAssignment(e,t=""){let r=oT(e);if(!r)return;let n=t?Nx(t):this.getAutonameLatexForExpression(e);n?fd(this.listModel,r,n):$a(e,t)}getAutonameLatexForExpression(e,t){if(t||(t=this.findLastSubscriptForLetters()),fL(e)==="point"&&e.label&&ya(e.label)&&this.countGlobalIdentifierOccurences(e.label)===0)return e.label;let r=Uq(e),n=(t[r]||0)+1;return t[r]=n,r+"_{"+n+"}"}_autoNameExpression(e,t){let r=this.getAutonameLatexForExpression(e,t);return $a(e,r+"="+e.latex),r}isGeoToolVisible(e,{ignoreAuthorMode:t}={ignoreAuthorMode:!1}){return!t&&this.shouldShowAuthorFeatures()?!0:Tg(this.geometryToolbarModel,e)}isGeoToolEnabled(e,{ignoreAuthorMode:t}={ignoreAuthorMode:!1}){return!t&&this.shouldShowAuthorFeatures()?!0:$f(this.geometryToolbarModel,e)}setGeoTool(e){!this.geoUIActive||this.activeTool===e||!this.isGeoToolEnabled(e)||(Yz(this.geometryToolbarModel,e,this.shouldShowAuthorFeatures()),this.activeTool=e,this.getGeoModel().setToolMode(e),this.cancelGeoToolplay())}cancelGeoToolplay(){var e;let t=this.getGeoModel();t.cancelToolplay(),t.deselectAllObjects(),this.setToolPreviewState({}),(e=this.get2dPOIController())==null||e.cancelGeoToolplay()}setToolPreviewState(e){var t;this.toolPreviewJSONState=e;let r=this.listModel.__toolPreviewIdToModel;this.listModel.__toolPreviewIdToModel={};let n=lV(e,{isBeingCommitted:!1});for(let i in e){let o=e[i],a=n[i];if(!a||a.type!=="assignment")continue;let s;for(let l in r){let c=r[o.type==="expression-edit-preview-latex"?Zf:l];if(((t=pi(c))==null?void 0:t.latex)===i){s=c;break}}if(s)s.latex=a.latex,s.color=a.color,s.showAngleLabel=!!a.showAngleLabel,s.hidden=o.hidden;else{let l=o.type==="expression-edit-preview-latex"?this.getSelectedItem():void 0,c=(l==null?void 0:l.type)==="expression"?Mw(l,{stripDefaults:!0}):void 0;s=zE(ie(R({},c),{id:o.type==="expression-edit-preview-latex"?Zf:this.generateId(),type:"expression",color:a.color,latex:a.latex,showAngleLabel:!!a.showAngleLabel,hidden:o.hidden}),this)}this.listModel.__toolPreviewIdToModel[s.id]=s}}isGeoItem(e){let t=this.getItemModel(e);return t&&t.type==="expression"&&t.formula&&t.formula.geometry&&!t.formula.error}getSelectedGeoExpression(){let e=this.getSelectedItem();if(e&&this.isGeoItem(e.id)&&e.type==="expression")return e}getGeometryFolder(){let e=this.getItemModel(__dcg_shared_module_exports__.xd);return e&&e.type==="folder"?e:void 0}isItemInGeoFolder(e){let t=this.getItemModel(e);return!t||t.type==="folder"?!1:t.folderId===__dcg_shared_module_exports__.xd}isGeoFolder(e){return e.id===__dcg_shared_module_exports__.xd}isItemNotSelectableBecauseItsSecret(e){return!(this.shouldShowAuthorFeatures()||this.isItemInGeoFolder(e)||!this.isItemSecret(e))}pauseAllSliders(){this.getPlayingSliders().forEach(e=>{As(e,!1)})}countGlobalIdentifierOccurences(e){return Cw(this.listModel,e)}handleClickableItemClicked(e,t){let r=this.getItemModel(e);nb(r)&&this.evaluator.addClickEvent(r.id,t)}canAddTicker(){return!this.getTickerOpen()}doesIdentifierBlockActionUpdate(e){let t=this.getFocusLocation(),r=Nu(this.listModel,e);for(let n of r)if((t==null?void 0:t.type)==="expression"&&t.id===n.id||Hq(n))return!0;return!1}getItemsByIdentifier(e){return Nu(this.listModel,e)}isAtLeastOnePointSelected(){let e=this.getAllSelectedItems();for(let t=0;t<e.length;t++){let r=e[t];if(r.type==="expression"&&mc(r))return!0}return!1}toggleLabelForAllSelectedObjects(){let e=[],t=[];this.getAllSelectedItems().forEach(r=>{r.type==="expression"&&mc(r)&&(r.showLabel?t.push(r):e.push(r))}),e.length?this.setLabelStateForObjects(e,"measurement"):t.length&&this.setLabelStateForObjects(t,"none")}setLabelStateForObjects(e,t){let r=/^([A-Z])([0-9]*)$/;if(t==="auto"){let n=0;this.getAllItemModels().forEach(i=>{if(i.type!=="expression"||!i.showLabel||!i.label)return;let o=i.label.match(r);if(!o)return;let a=o[1].charCodeAt(0)-65;o[2]&&(a+=parseInt(o[2])*26),a>=n&&(n=a+1)}),e.forEach(i=>{if(!i.label){let o=n;n++;let a=String.fromCharCode(o%26+65),s=Math.floor(o/26),l=s>0?s+"":"";yd(i,a+l)}Ku(i,!0)})}else if(t==="measurement")for(let n of e)yd(n,""),Ku(n,!0);else if(t==="none")for(let n of e)r.test(n.label)&&yd(n,""),Ku(n,!1)}updateLatexForIdentifier(e,t){let r=Nu(this.listModel,e);if(r.length===1){let n=r[0];n.slider.isPlaying?(As(n,!1),$a(n,t),As(n,!0)):$a(n,t)}}updateExpressionSearchStr(e){this.rawExpressionSearchStr=e;let t="\\operatorname{rename}";if(e.indexOf(t)===0){let r=e.slice(t.length).replace(/\\ /g,"").split(/\\to(?![a-zA-Z])/);r.length===2?(this.expressionSearchStr=r[0],this.isExpressionSearchStrValidForReplace=ya(this.expressionSearchStr),this.updateExpressionReplaceStr(r[1])):(this.expressionSearchStr=r[0],this.isExpressionSearchStrValidForReplace=!1,this.updateExpressionReplaceStr(""));let n=z4(this.listModel,this.getExpressionSearchStr());this.expressionSearchCount=this.expressionSearchOpen?n:0}else this.expressionSearchStr=e.length>1&&"rename".indexOf(e)===0?"":e,this.isExpressionSearchStrValidForReplace=!1,this.updateExpressionReplaceStr(""),this.filterItemsBySearch()}closeExpressionsSearch(){var e;if(this.expressionSearchOpen=!1,this.updateExpressionSearchStr(""),((e=this.getFocusLocation())==null?void 0:e.type)==="ticker")return;let t=this.getFirstSelectedItem(),r=this.getItemModelByIndex(0);!t&&r&&bi(this,r.id,"end"),t&&this.getSelectedItem()&&!this.getFocusedItem()&&bi(this,t.id,"end"),(t||r)&&(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0)}filterItemsBySearch(){if(!this.getExpressionReplaceStr()){let e=q4(this.listModel,this.getExpressionSearchStr());this.expressionSearchCount=this.expressionSearchOpen?e:0}}updateExpressionReplaceStr(e){this.expressionReplaceStr=e,this.isExpressionReplaceStrValidForReplace=ya(e)}getIsExpressionSearchStrValidForReplace(){return this.isExpressionSearchStrValidForReplace}getIsExpressionReplaceStrValidForReplace(){return this.isExpressionReplaceStrValidForReplace}isSearchReplaceValid(){return this.getIsExpressionSearchStrValidForReplace()&&this.getIsExpressionReplaceStrValidForReplace()}shouldShowReplaceIcon(){return this.isSearchReplaceValid()}updateTickerHandlerLatex(e){this.listModel.ticker.handlerLatex=e}updateTickerMinStepLatex(e){this.listModel.ticker.minStepLatex=e}getRawExpressionSearchStr(){return this.rawExpressionSearchStr||""}getExpressionSearchStr(){return this.expressionSearchStr||""}getExpressionReplaceStr(){return this.expressionReplaceStr||""}getExpressionSearchCount(){return this.expressionSearchCount||0}getTicker(){return this.listModel.ticker}getTickerHandlerLatex(){return this.listModel.ticker.handlerLatex||""}getTickerMinStepLatex(){return this.listModel.ticker.minStepLatex||""}getTickerAvgDelta(){return this.listModel.ticker.avgDelta}getBrailleMode(){return this.graphSettings.config.brailleMode}setBrailleMode(e){this.graphSettings.config.setProperty("brailleMode",e)}getSixKeyInput(){return this.graphSettings.config.sixKeyInput}setSixKeyInput(e){this.graphSettings.config.setProperty("sixKeyInput",e)}getBrailleControls(){return this.graphSettings.config.brailleControls}setBrailleControls(e){this.graphSettings.config.setProperty("brailleControls",e)}getAudio(){return this.graphSettings.config.audio}setAudio(e){this.graphSettings.config.setProperty("audio",e)}setEditListMode(e){this.layoutModel=ie(R({},this.layoutModel),{inEditListMode:e})}generateTableXSubscript(){return OE(this.listModel)}findLastTokenNumber(){return H4(this.listModel)}findLastSubscriptForLetters(){return K4(this.listModel)}_createTableItem(){let e=this.generateTableXSubscript(),t=FG(e,[[],[]],this);return this.createItemModel(t)}_populateSettingsViewLimitLatex(){let e=this.getGrapher();if(!e)return;let t=e.getCurrentViewport();this.isGraphSettingsOpen()&&__dcg_shared_module_exports__.E(t,this.lastDirectlyEditedViewport)||(this.settingsViewModel=ie(R({},this.settingsViewModel),{limitLatex:oj(t,{steps:this.getAxisStepSettings(),scales:this.getAxisScaleSettings()})}))}getAxisStepSettings(){return{xAxisStep:this.graphSettings.xAxisStep,yAxisStep:this.graphSettings.yAxisStep}}getAxisScaleSettings(){return{xAxisScale:this.graphSettings.xAxisScale,yAxisScale:this.graphSettings.yAxisScale}}getDefaultAxisScaleSettings(){var e,t;let{defaultState:r}=this.graphSettings;return{xAxisScale:((e=r==null?void 0:r.graph)==null?void 0:e.xAxisScale)||"linear",yAxisScale:((t=r==null?void 0:r.graph)==null?void 0:t.yAxisScale)||"linear"}}getSettingsViewModel(){return this.settingsViewModel}getListModel(){return this.listModel}getGeometryToolbarModel(){return this.geometryToolbarModel}hasBackgroundColor(){return this.getBackgroundColor()!=="#ffffff"}getBackgroundColor(){return this.getGraphSettings().getConfiguredBackgroundColor()}hasTextColor(){return this.getTextColor()!=="#000000"}getTextColor(){return this.getGraphSettings().getConfiguredTextColor()}getPillboxBackgroundColor(){return __dcg_shared_module_exports__.Kd(this.getBackgroundColor(),-.07)}subscribeToChanges(e){let t=this.nextSubscription;return this.nextSubscription+=1,this.subscriptions[t]=e,()=>{delete this.subscriptions[t]}}updateTheComputedWorld(){var e,t,r,n,i,o,a,s,l;_g(this.listModel);let c=this.getSelectedItem()&&this.activeTool==="expression-edit"&&this.listModel.__toolPreviewIdToModel[Zf]&&(e=this.getGrapher())!=null&&e.graphSketches[Zf]?"preview":"actual";W4(this.listModel,c),(t=this.grapher2d)==null||t.setTabOrder(this.listModel.tabOrder),(r=this.grapher3d)==null||r.setTabOrder(this.listModel.tabOrder),(n=this.grapher2d)==null||n.setDrawLayers(this.listModel.drawLayers),(i=this.grapher3d)==null||i.setDrawLayers(this.listModel.drawLayers);let d={},u=_=>{var w;let v=(w=pi(_))==null?void 0:w.identifier;v&&(v[0]==="$"||_.formula.geometry)&&v&&(d[v]?d[v].multiple=!0:d[v]={model:_,multiple:!1})};for(let _ of this.getAllToolPreviewItems())bL(_),u(_);for(let _ of this.getAllItemModels())switch(_.type){case"expression":bL(_),u(_);break;case"image":n4(_);break;case"table":tz(_);break;case"folder":Gz(_);break;case"text":f4(_);break;default:return _}this.geoUIActive=this.isGeometry()&&!this.getGraphSettings().config.hideGeoUI,this.cachedGeoTokenInfo={};for(let _ in d){let{multiple:w,model:v}=d[_],T="blue",M="unknown",C="unknown",P=!1,F=!1,B=!1,x=Hi(v);!w&&v?(T=Fu(v),P=Bq(v),C=qq(v),M=fL(v),v.error&&(F=!0,T="#")):(M="error",F=!0),M&&v?this.isItemSelected(v.id)&&(B=!0):F=!0;let L=(v==null?void 0:v.label)||"";this.cachedGeoTokenInfo[_]={groupType:M,iconType:C,isList:P,hasError:F,color:T,isSelected:B,isHidden:x,label:L,calcId:v&&v.id||""}}this.cachedGeoTokenDepths={};let{createdDepth:p,firstReferencedDepth:g}=this.geoModel.getComputedBoard().getDepthValues();for(let _ in this.cachedGeoTokenInfo){let{calcId:w}=this.cachedGeoTokenInfo[_],v=this.getItemModel(w);if(!v)continue;let T=_;if(!(_ in p)&&v.type==="expression"&&(w===this.getDraggedItemId()||v===this.getFocusedItem())){let x=v.formula.assignment;x&&x in p&&(T=x)}let M=p[T]||0,C=g[T];C=isFinite(C)?C:0;let P=Math.max(M,C-1)+"",F=this.cachedGeoTokenDepths[P];F||(F=[],this.cachedGeoTokenDepths[P]=F);let B=this.cachedGeoTokenInfo[_];!this.isItemInGeoFolder(v.id)&&(v.readonly||Ds(v))||F.push({color:B.color,groupType:B.groupType,identifier:_,calcId:w})}D4(this.listModel.ticker);let f=this.getFocusLocation();if(f&&f.type==="expression"&&f.isFakeGraphFocus&&(this.getValidCursorContext()||qr(this,ie(R({},f),{isFakeGraphFocus:void 0}))),this.isCurrentFocusLocationValid()||qr(this,void 0),this.listModel.openItemMenu){let _=this.getOpenMenuIcon();document.body&&_&&document.body.contains(_)||(this.listModel.openItemMenu=void 0)}let y=this.getSelectedItem();y&&!this.getItemModel(y.id)&&Nr(this.listModel,void 0),this._populateSettingsViewLimitLatex(),this.propagateSelection(),this.propagateActiveTokens(),this.isKeypadOpen()||(this.layoutModel=ie(R({},this.layoutModel),{keypadFunctionsOpen:!1})),yq(this.listModel),this.isGeometry()&&y&&y.type==="expression"?this.getValidCursorContext()?(this.setGeoTool("expression-edit"),this.geoModel.updateFadeAnimations()):this.geoModel.getToolMode()==="expression-edit"&&this.setGeoTool("selection"):this.geoModel.getToolMode()==="expression-edit"&&this.setGeoTool("selection"),this.isGeometry()&&this.getGeoModel().updateAvailableInputTypes();let E=this.getValidCursorContext();this.isGeometry()&&this.getGeoModel().getToolMode()==="expression-edit"&&!__dcg_shared_module_exports__.E(E,this.lastCursorContext)&&this.runAfterDispatch(()=>{var _;(_=this.get2dPOIController())==null||_.replayGeoTapMove()}),this.lastCursorContext=E,(a=(o=this.grapher2d)==null?void 0:o.poiController)!=null&&a.keyboardAttentionManager.getKeyboardAttention()&&!this.isGraphPaperFocused()&&((l=(s=this.grapher2d)==null?void 0:s.poiController)==null||l.keyboardAttentionManager.setKeyboardAttention(void 0)),this.isGeometry()&&(qz(this.geometryToolbarModel),this.isGeoToolEnabled(this.getActiveTool())||this.setGeoTool("selection")),this.runAfterDispatch(()=>{var _,w;this.isThreeDMode()||((_=this.grapher2d)==null||_.audioGraph.checkIfSelectedItemChanged(y?y.id:void 0),this.focusLocation&&this.focusLocation.type!=="graph-paper"&&((w=this.grapher2d)==null||w.audioGraph.exitAudioTrace()))})}getOpenMenuIconSelector(){let e=this.getOpenItemMenu();return e?`[dcg-open-menu-guid="${e.guid}"]`:void 0}getOpenMenuIcon(){let e=this.getOpenMenuIconSelector();return e?this.findEl(e):void 0}propagateSelection(){let e=this.getGrapher();e?this.__lastSelectedIdsForPropagation=W$(this,e,this.__lastSelectedIdsForPropagation):this.__lastSelectedIdsForPropagation={selected:{},hoistedToTop:{}}}propagateActiveTokens(){var e,t;this.isThreeDMode()||((e=this.grapher2d)==null||e.setActiveToken(this.getExpressionIdForIdentifier(this.activeTokens.selected),"selected"),(t=this.grapher2d)==null||t.setActiveToken(this.getExpressionIdForIdentifier(this.activeTokens.hovered),"hovered"))}getHoveredOrFocusedTokenIdentifier(){if(this.activeTokens.hovered)return this.activeTokens.hovered;let e=this.getFocusLocation();if(e&&e.type==="geo-token")return e.identifier}doesLatexContainToken(e){return zq(e)}getToolPreviewJSONState(){return this.toolPreviewJSONState}removeListOfItems(e){let t={},r=[],n=new Set;return e.forEach(i=>{if(this.isItemReadonly(i))n.add(i);else{let o=Ag(this.listModel,i);for(let a of o)t[a.id]||(t[a.id]=!0,r.push(a))}}),{deletedItems:r,readonlyItemsNotDeleted:n.size}}garbageCollectGeo(e,t){if(!this.isGeometry())return;let r=j$(this,e,t);r.length&&this.removeListOfItems(r)}ensureAtLeastOneVisibleItem(){if(Z4(this.listModel)){let e=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});ol(this.listModel,e)}}getExpressionIdForIdentifier(e){if(!e)return;let t=this.getItemsByIdentifier(e);if(t.length===1)return t[0].id}getValidCursorContext(){var e;let t=this.getSelectedItem();if(!t||t.type!=="expression")return;let r=t.formula.cursor_context,n=(e=Fe.getFocusedMathquill())==null?void 0:e.selection(),i=(t==null?void 0:t.type)==="expression"&&t.latex===(r==null?void 0:r.selection.input)&&(n==null?void 0:n.startIndex)===(r==null?void 0:r.selection.start)&&(n==null?void 0:n.endIndex)===(r==null?void 0:r.selection.end)&&(n==null?void 0:n.latex)===(r==null?void 0:r.selection.input);if(this.getGeoModel().getClickToInsertMode()==="permissive")return{type:"permissive",allowedTypes:[__dcg_shared_module_exports__.va],cursorContext:i?r:void 0};if(i){if((r==null?void 0:r.type)==="expression-arguments"){let{argIndex:o,positionWithinArg:a}=r;if(!(o===r.argCount-1&&a==="end"||r.positionWithinArg==="start-to-end"&&(n==null?void 0:n.startIndex)!==void 0&&(n==null?void 0:n.startIndex)===(n==null?void 0:n.endIndex)))return}return r}}tryInsertTokenIntoMathquill(e,t){if(!this.isGeometry()||!e)return!1;let r=this.getItemModel(e);if(!r||r.type!=="expression")return!1;let n=r.formula.typed_constant_value;t===0&&(!n||!__dcg_shared_module_exports__.wb(n.valueType))&&(t=void 0);let i,o,a=Ya(r);if(a?o=__dcg_shared_module_exports__.ma(a):r.formula.geometry&&(o=this.getAutonameLatexForExpression(r),i=o),!o)return!1;t!==void 0&&(o+="\\left["+(t+1)+"\\right]");let s=this.getFocusLocation();return!s||!this.seemsLikeInsertingTokenWillImproveThings(n==null?void 0:n.valueType)?!1:s.type==="expression"?(i&&(Ro(r)==="NONE"&&r.dragMode==="AUTO"&&Mg(r,"NONE"),$a(r,i+"="+r.latex)),this.writeIdentifierIntoCurrentMathquill(o),!0):!1}seemsLikeInsertingTokenWillImproveThings(e){let t=this.getValidCursorContext();if(t){if(!e)return!1;let r=__dcg_shared_module_exports__.wb(e)?__dcg_shared_module_exports__.xb(e):e;return t.type==="empty"&&__dcg_shared_module_exports__.yb(r)?!1:(t.type==="expression-arguments"?t.allowedTypesForInsertedArg:t.allowedTypes).some(n=>__dcg_shared_module_exports__.ua(r,n))}return!1}writeIdentifierIntoCurrentMathquill(e){this.runAfterDispatch(()=>{let t=Fe.getFocusedMathquill();if(!t)return;let r=this.getValidCursorContext(),n=(r==null?void 0:r.type)==="permissive"?r.cursorContext:r,i="",o="";(n==null?void 0:n.type)==="expression-arguments"&&((n==null?void 0:n.positionWithinArg)==="end"?i=",":(n==null?void 0:n.positionWithinArg)==="start"&&(o=","));let a=`${i}${e}${o}`,s=!1;if((n==null?void 0:n.type)==="expression-arguments"&&n.polygonVertices){let{argIndex:l,polygonVertices:c,positionWithinArg:d}=n;(e===c.firstLatex||e===c.lastLatex)&&(d==="end"||d==="start-to-end")&&l===n.argCount-1&&(a="",s=!0)}else(n==null?void 0:n.type)==="expression-arguments"&&(s=n.isLastValidArg);Fe.canAcceptText(t,this.getCapExpressionSize(),a)&&(t.write(a),Fe.simulateUserChangedLatex(t),s&&t.keystroke("Right"))})}getSelectedExpressionIds(){return tq(this.listModel)}hasTentativeSelection(){return cq(this.listModel)}getPropagatedSelectedIds(){return this.__lastSelectedIdsForPropagation}areParsableObjectsEqual(e,t){return e===t?!0:__dcg_shared_module_exports__.E(ie(R({},e),{regressionParameters:void 0}),ie(R({},t),{regressionParameters:void 0}))}requestParseForAllItems(){var e,t,r;(this.isCurrentlyDoingSetState||this.isCurrentlyDoingRestoreState)&&(this.lastParsableObjects={},this.evaluator.clearStatementsAndStartCompleteState(),this.isCurrentlyDoingRestoreState&&this.evaluator.markUndoRedoState());let n={},i=this.lastParsableObjects;for(let a of this.getAllItemModels())switch(a.type){case"expression":case"image":case"table":n[a.guid]=a.cachedParsableState;break;case"folder":case"text":break;default:return a}for(let a of N4(this.listModel))n[a.guid]=a.cachedParsableState;for(let a of rb(this.listModel)){let s=this.getSelectedItem(),l=this.activeTool==="polygon";if(this.activeTool==="expression-edit"&&(s==null?void 0:s.type)==="expression"&&((t=(e=s.formula.geometry)==null?void 0:e.call)==null?void 0:t.symbol)==="polygon"&&((r=s.formula.cursor_context)==null?void 0:r.type)==="expression-arguments"){let{positionWithinArg:c,argIndex:d}=s.formula.cursor_context;l=(c==="end"||c==="start-to-end")&&d===s.formula.geometry.call.parents.length-1}n[a.guid]=ie(R({},a.cachedParsableState),{shouldOmitLastPolygonSegment:l})}let o=this.getFocusedItem();if((o==null?void 0:o.type)==="expression"){let a=Fe.getFocusedMathquill(),s=a==null?void 0:a.selection();(s==null?void 0:s.latex)===o.latex&&this.shouldEvaluateSelection()&&(n[o.guid]=ie(R({},o.cachedParsableState),{latexSelection:{start:s.startIndex,end:s.endIndex}}))}if(this.is3dProduct()&&this.getTranslucentSurfaces())for(let a in n){let s=n[a];s.type==="statement"&&(n[a]=ie(R({},s),{surfaceOpacity:this.getGraphSettings().config.translucentOpacity}))}this.listModel.ticker.cachedParsableState&&(n[this.listModel.ticker.guid]=this.listModel.ticker.cachedParsableState);for(let a of Hz(this.geometryToolbarModel))n[a.id]=a;for(let a in i){let s=i[a],l=n[a];if(s.type==="image"&&(!l||l.type!==s.type||l.guid!==s.guid)&&this.grapher2d&&this.grapher2d.removeGraphImage(s.id),!l&&(this.evaluator.removeStatement(s.id),s.type==="table"))for(let c of s.columns)this.evaluator.removeStatement(c.id)}for(let a in n){let s=n[a],l=i[a];if(s.type==="image"&&(!l||s.type!==l.type||s.guid!==l.guid)&&this.grapher2d){let c=this.getItemModel(s.id);c&&c.type==="image"&&this.grapher2d.addGraphImage(c)}this.areParsableObjectsEqual(s,l)||(this.grapher2d&&s.type==="statement"&&s.latex===""&&this.grapher2d.removeGraphSketch(s.id),this.evaluator.addStatement(s))}this.lastParsableObjects=n}getViewState(){let e=this.getGrapher();if(e){let t=e.getProjection();return{viewport:t.viewport.toObject(),screen:t.screen,xAxisScale:t.settings.xAxisScale,yAxisScale:t.settings.yAxisScale,degreeMode:t.settings.degreeMode,complex:t.settings.complex}}else return}getTokenRenderInfoByIdentifier(e){let t=this.cachedGeoTokenInfo[e];return t||(t={iconType:"unknown",isList:!1,hasError:!0,isSelected:!1,groupType:"unknown",color:"",isHidden:!1,label:"",calcId:""}),t}setEvaluator(e){this.evaluator=e,e.clearSlowEvaluatorTracking=this.clearSlowEvaluatorTracking.bind(this)}getEvaluator(){return this.evaluator}setGrapher2d(e){this.grapher2d=e}setGrapher3d(e){this.grapher3d=e,this.grapher2d.poiController.add3DTouchEventHandlers(e)}getGrapher(){return this.isThreeDMode()?this.grapher3d:this.grapher2d}getGrapher2d(){return this.grapher2d}getGrapher3d(){return this.grapher3d}get2dPOIController(){var e;return(e=this.grapher2d)==null?void 0:e.poiController}isDefaultViewportRestored(){var e;return!!((e=this.getGrapher())!=null&&e.viewportController.isDefaultViewportRestored())}requestRedrawGraph(){var e,t;(e=this.grapher2d)==null||e.redrawAllLayers(),this.isThreeDMode()&&((t=this.grapher3d)==null||t.redrawAllLayers())}get2dProjection(){var e;return(e=this.grapher2d)==null?void 0:e.getProjection()}get2dSketchOrder(){return this.grapher2d?[...this.grapher2d.generateMergeDrawOrder()]:[]}getBoundingBoxesForZoomFit(e){if(!(!this.grapher2d&&!this.grapher3d)&&this.isZoomFitEnabled()&&!(e.type!=="expression"&&e.type!=="table")&&!(e.type==="expression"&&(e.error||!e.shouldGraph||!e.formula.is_graphable)))return e.boundingBoxes}getBoundingBoxForResidualsZoomFit(e){var t,r;if(!(!this.grapher2d&&!this.grapher3d)&&this.isZoomFitEnabled()&&!(e.type!=="expression"&&e.type!=="table")&&!(e.type==="expression"&&(e.error||!e.formula.is_graphable))){if(e.type==="table"&&((r=(t=e.formula)==null?void 0:t.table_regression)==null?void 0:r.status)==="success"&&e.boundingBoxes){let n=e.formula.table_regression.result.residualVariable;for(let i of e.boundingBoxes)if(i.symbol&&__dcg_shared_module_exports__.ma(i.symbol)===n)return[i]}if(e.type==="expression"&&e.formula.regression){let n=e.formula.regression.residualVariable;for(let i of this.getAllItemModels())if(i.type==="table"&&i.boundingBoxes){for(let o of i.boundingBoxes)if(o.symbol&&__dcg_shared_module_exports__.ma(o.symbol)===n)return[o]}}}}isExpressionZoomFit(e){if(this.isThreeDMode())return!1;let t=this.getBoundingBoxesForZoomFit(e),r=this.get2dProjection();return!r||!t?!1:!eA(t,r)&&!!c1(t,r)}viewportIsLocked(){return this.getLockViewportConfigSetting()||this.getLockViewportUserSetting()}showExpressionZoomFitButton(e){if(this.viewportIsLocked()||this.isGeometry()||this.is3dProduct())return!1;let t=this.getBoundingBoxesForZoomFit(e),r=this.get2dProjection();return!!(r&&t&&eA(t,r))}showResidualsZoomFitButton(e){if(this.viewportIsLocked()||this.isGeometry()||this.is3dProduct())return!1;let t=this.getBoundingBoxForResidualsZoomFit(e),r=this.get2dProjection();return!!(r&&t&&eA(t,r))}setBugsnagContext(e){this.bugsnagContext=e}getItemRootNodeById(e){let t=this.getItemModel(e);return t==null?void 0:t.rootViewNode}getItemNodeById(e){return this.getItemRootNodeById(e)}generateId(){let e=this.__nextItemId;return this.__nextItemId+=1,e+""}getNextColor(){return L4(this.listModel)}getNextDisplayIndex(){return this.listModel.nextDisplayIndex}_clearPendingImageUploads(){this.__pendingImageUploads={}}isUploadingImages(){return Object.keys(this.__pendingImageUploads).length>0}getExpressionAnalysis(){return this.listModel.expressionAnalysis}getHelperExpressions(){return j4(this.listModel).map(e=>e.proxy)}createItemModel(e){return Qf(this.listModel,e)}getItemModel(e,t){return bd(this.listModel,e,t)}getHiddenGeoItemCount(){return Q4(this.listModel)}getColorById(e){let t=this.getItemModel(e);return!t||t.type!=="expression"?"":cL(t)}getAllColorAssignments(){let e=[];for(let t of this.getAllItemModels()){if(t.type!=="expression")continue;let r=Ya(t);if(!r)continue;let n=this.getEvaluationValueForItem(t.id);(typeof n=="string"||Array.isArray(n)&&typeof n[0]=="string")&&e.push({id:t.id,assignmentLatex:__dcg_shared_module_exports__.ma(r)})}return e}getAllColorFunctionAssignments(){let e=[];if(!this.isBeta3DMode())return e;for(let t of this.getAllItemModels()){if(t.type!=="expression")continue;let r=Ya(t),n=mL(t);!r||!n||e.push({id:"shader",assignmentLatex:"shader:"+__dcg_shared_module_exports__.ma(r)})}return e}getShader(e){for(let t of this.getAllItemModels()){if(t.type!=="expression")continue;let r=Ya(t);if(r&&__dcg_shared_module_exports__.ma(r)===e){let n=mL(t);if(n)return n}}return{source:"",shaderFunctions:{},shaderUniforms:[]}}getItemModelByIndex(e){return kg(this.listModel,e)}getItemCount(){return kw(this.listModel)}getItemEditableLabelMode(e){let t=this.getItemModel(e);if(!(!t||t.type!=="expression"))return Zq(t)}isItemSecret(e){let t=this.getItemModel(e);return t?Xf(t):!1}isItemMarkedReadonly(e){let t=this.getItemModel(e);return t?!this.isListEnabled()&&!this.isItemInGeoFolder(e)?!0:R4(t):!1}isItemReadonly(e){return this.isItemMarkedReadonly(e)&&!this.shouldShowAuthorFeatures()}isItemSelected(e){let t=this.getItemModel(e);return!!t&&Sa(t)}getItemSelectedState(e){return bq(this.listModel,e)}isItemGraphing(e){return this.getEvaluatorStateForItem(e)==="GRAPHING"}getEvaluatorStateForItem(e){return this.evaluator.evaluationProgressById.get(e)}hasAnyItemsSelected(){return this.getAllSelectedItems().length>0}hasMultipleItemsSelected(){return this.getAllSelectedItems().length>1}isItemSelectable(e){let t=this.getItemModel(e);return t?tb(t):!1}anyItemDependsOnRandomSeed(){return hq(this.listModel)}areActionsEnabled(){return this.graphSettings.config.actions==="auto"?mq(this.listModel):!!this.graphSettings.config.actions}getAllItemModels(){return VE(this.listModel)}getAllToolPreviewItems(){return rb(this.listModel)}isToolPreviewItem(e){return $4(this.listModel,e)}getAllModelsWithSliders(){return eq(this.listModel)}getGraphSettings(){return this.graphSettings}getAudioGraph(){var e;if(!this.isThreeDMode())return(e=this.grapher2d)==null?void 0:e.audioGraph}inAudioTraceMode(){let e=this.getAudioGraph();return!!(e&&e.audioTraceActive)}canAudioTrace(){let e=this.getAudioGraph();return e?e.canAudioTraceCurrentExp():!1}isAudioTracing(){let e=this.getAudioGraph();return e?e.isAudioTracing():!1}expressionsAreFullWidth(){return this.isNarrow()||this.graphSettings.config.graphpaper===!1}getExpListWidthString(){return this.expressionsAreFullWidth()?"100%":this.rootElt?this._getExpListWidth()+"px":"0"}getExpListWidth(){return this.rootElt?this._getExpListWidth():0}findFirstVisibleItem(){let e=i$(this,this._previousFirstVisibleId);if(this._previousFirstVisibleId=e,e)return this.getItemModel(e)}findLastVisibleItem(){let e=n$(this,this._previousLastVisibleId);if(this._previousLastVisibleId=e,e)return this.getItemModel(e)}updateRenderShellsAfterDispatch(){if(!this.rootElt||!this.isListVisible())return;let e=this.findFirstVisibleItem(),t=this.findLastVisibleItem(),r=e&&this.getItemRootNodeById(e.id),n=t&&this.getItemRootNodeById(t.id);if(r===this.lastInfiniteScrollFirstDOM&&n===this.lastInfiniteScrollLastDOM&&!this.hasDispatchSinceLastInfiniteScrollUpdate)return;this.lastInfiniteScrollFirstDOM=r,this.lastInfiniteScrollLastDOM=n,this.hasDispatchSinceLastInfiniteScrollUpdate=!1;let i=!1,o=e?e.index:1/0,a=t?t.index:1/0,s=this.listModel.dragState&&this.listModel.dragState.firstItemId,l,c=this.getOpenItemMenu();c&&c.type!=="multi-select-more"&&c.type!=="multi-select-construct"&&c.type!=="multi-select-style"&&c.type!=="multi-select-label"&&c.type!=="geo-tool-dropdown"&&(l=c.model.id);for(let d of this.getAllItemModels()){let u=(d.index<o||d.index>a||d.isHiddenFromUI)&&!(d.type==="expression"&&d.sliderDragging);if(s==d.id&&(u=!1),l===d.id&&(u=!1),d.renderShell!==u&&(d.renderShell=u,i=!0,u)){let p=this.getItemRootNodeById(d.id);if(p){let g=p.getBoundingClientRect().height;g>0&&(d.cachedRenderHeight=g)}}}i&&this.markTickRequiredNextFrame()}updateRenderShellsBeforePaint(){if(this.hasDispatchSinceLastInfiniteScrollUpdate=!0,this.inPrintMode){for(let t of this.getAllItemModels())t.renderShell=!1;return}for(let t of this.getAllItemModels())t.isHiddenFromUI&&(t.renderShell=!0),t.type==="expression"&&t.sliderDragging&&(t.renderShell=!1);let e=this.getSelectedItem();e&&!this.isGeoItem(e.id)&&(e.renderShell=!1)}updateDragDrop(){let e=this.listModel.dragState;if(!e)return;let t=this.getItemModel(e.firstItemId);if(!t)return;let r=this.dragdrop_expressions.applyDrag();r&&(_w(this.listModel,r.dragState),_n(t,r.folderId),t.index!==r.newIndex&&Uu(this.listModel,t.index,r.newIndex,e.numberOfItems))}_tickSliders(e){this.getPlayingSliders().forEach(t=>{_q(t,e)})}tickTicker(e){let t=this.listModel.ticker.lastTickTime===void 0;this.evaluator.addClockTickEvent(this.listModel.ticker.id,t),_4(this.listModel.ticker,e)}stopAllSliders(){for(let e of this.getAllItemModels())e.type==="expression"&&e.slider.isPlaying&&As(e,!1)}getPlayingSliders(){let e=this.getAllItemModels(),t=[];for(let r of e)r.type==="expression"&&r.sliderExists&&r.slider.isPlaying&&t.push(r);return t}areAnyImagesLoading(){return G4(this.listModel)}_commitUserRequestedViewport(e){var t;(t=this.getGrapher())==null||t.setUserRequestedViewport(e)}_setAxisLimitLatex(e,t){this.settingsViewModel=ie(R({},this.settingsViewModel),{limitLatex:ie(R({},this.settingsViewModel.limitLatex),{[e]:t})});let r=t===""&&(e==="xstep"||e==="ystep")?0:io(t,this.graphSettings.degreeMode),n=this.getGrapher();switch(e){case"xstep":{if(!ay(r))return;this.graphSettings.setProperty("xAxisStep",r)}break;case"ystep":{if(!ay(r))return;this.graphSettings.setProperty("yAxisStep",r)}break;case"xmin":case"xmax":case"ymin":case"ymax":case"zmin":case"zmax":{if(!n)return;let i=n.viewportController.getViewport(),o="xmin";e==="xmin"&&(o="xmax"),e==="ymax"&&(o="ymin"),e==="ymin"&&(o="ymax"),e==="zmax"&&(o="zmin"),e==="zmin"&&(o="zmax");let a=io(this.settingsViewModel.limitLatex[o]||"",this.graphSettings.degreeMode),s=Br.fromObject(ie(R({},i.toObject()),{[e]:r,[o]:a}));if(!s.isValid(this.getAxisScaleSettings()))return;n.viewportController.setViewport(s);let l;switch(e){case"xmin":case"xmax":l="x";break;case"ymin":case"ymax":l="y";break;case"zmin":case"zmax":l="z";break;default:let c=e;throw new Error(`Invalid limit: ${c}`)}this.graphSettings.setProperty("lastChangedAxis",l),this.markSquareAxesAfterUserEditedViewport()}break}if(n){let i=n.viewportController.getViewport().toObject();this._commitUserRequestedViewport(i)}}unmarkLastChangedAxis(){this.graphSettings.setProperty("lastChangedAxis",void 0)}markSquareAxesAfterUserEditedViewport(){let e=this.getGrapher();if(!e)return;let t=e.viewportController.getViewport(),r=this.isThreeDMode()?t.isSquare3D():t.isSquare(e.getProjection().screen,this.getAxisScaleSettings());this.graphSettings.setProperty("squareAxes",r)}getLockViewportConfigSetting(){return this.graphSettings.config.lockViewport}getLockViewportUserSetting(){return this.graphSettings.userLockedViewport}canUserAddExpressions(){return!!this.graphSettings.config.expressions}areNotesEnabled(){return!!this.graphSettings.config.notes}areSlidersEnabled(){return!!this.graphSettings.config.sliders}areLinksEnabled(){return!!this.graphSettings.config.links}areImagesEnabled(){let e=window.FileReader,t=tl&&yg&&yg[0]===8&&yg[1]===0&&yg[2]===0;return!!(this.graphSettings.config.images&&e&&!t&&!this.is3dProduct())}areFoldersEnabled(){return!!this.graphSettings.config.folders}isDecimalToFractionEnabled(){return!!this.graphSettings.config.decimalToFraction}isTraceEnabled(){return!!this.graphSettings.config.trace}areFunctionsRestricted(){return!!this.graphSettings.config.restrictedFunctions}areGeometryFunctionsForceEnabled(){return!!this.graphSettings.config.forceEnableGeometryFunctions}isQwertyKeyboardEnabled(){return!!this.graphSettings.config.qwertyKeyboard}isZoomFitEnabled(){return!!this.graphSettings.config.zoomFit}canEditOnWeb(){return!!this.graphSettings.config.editOnWeb}hasTransparentBackground(){return!!this.graphSettings.config.transparentBackground}shouldAudioTraceReverseExpressions(){return!!this.graphSettings.config.audioTraceReverseExpressions}hasDefaultState(){return!!this.graphSettings.defaultState}getDefaultViewport(){var e;let t=this.graphSettings.defaultState;return t&&t.graph?t.graph.viewport:(e=this.getGrapher())==null?void 0:e.getDefaultViewport()}getColors(){return this.isThreeDMode()?__dcg_shared_module_exports__.Sd:this.graphSettings.config.colors}getImageOpacities(){return["0.2","0.4","0.6","0.8","1"]}getUIDragModes(){return["X","Y","XY"]}getNumberOfItemsInFolder(e){return P4(this.listModel,e)}getEnabledDragModesForItem(e){let t=this.getItemModel(e);if(!t||t.type!=="expression")return[];let r=t.formula,n=[];if(!r.move_strategy)return n;let i=r.move_strategy[0].type!=="none",o=r.move_strategy[1].type!=="none",a=i&&o;return i&&n.push("X"),o&&n.push("Y"),a&&n.push("XY"),n}shouldShowEvaluationForItem(e){let t=this.getItemModel(e);return!t||t.type!=="expression"?!1:lL(t)}shouldShowCDFEvaluationForItem(e){let t=this.getItemModel(e);return!t||t.type!=="expression"?!1:JE(t)}getEvaluationValueForItem(e){let t=this.getItemModel(e);return t?t.type!=="expression"?NaN:cL(t):NaN}getEvaluationValueTypeForItem(e){var t;let r=this.getItemModel(e);if(r&&r.type==="expression")return(t=r.formula.typed_constant_value)==null?void 0:t.valueType}canDisplayEvaluationForItemAsFraction(e){if(!this.isDecimalToFractionEnabled())return!1;let t=this.getItemModel(e);if(!t||t.type!=="expression"||qw(t))return!1;let r=this.getEvaluationValueForItem(e);return typeof r!="number"?!1:__dcg_shared_module_exports__.ia(r)}shouldEvaluationForItemDisplayAsFraction(e){if(!this.isDecimalToFractionEnabled())return!1;let t=this.getItemModel(e);return!t||t.type!=="expression"?!1:Hu(t)}getEvaluationLabelOptionsForItem(e){return ie(R({},__dcg_shared_module_exports__.ga),{displayAsFraction:this.shouldEvaluationForItemDisplayAsFraction(e)})}isInEditListMode(){return this.layoutModel.inEditListMode}authorFeaturesAvailable(){return!!this.graphSettings.config.authorFeatures}shouldShowAuthorFeatures(){return this.authorFeaturesAvailable()&&!!this.graphSettings.config.authorMode}shouldIgnoreGraphInteractions(e){return this.shouldShowAuthorFeatures()?!1:Ds(e)}toolWillBeHiddenOrDisabled(e){return this.shouldShowAuthorFeatures()&&(!this.isGeoToolVisible(e,{ignoreAuthorMode:!0})||!this.isGeoToolEnabled(e,{ignoreAuthorMode:!0}))}setAuthorMode(e){this.graphSettings.config.setProperty("authorMode",e)}getInvertedColors(){return!!this.graphSettings.config.invertedColors}invertSwatches(){return this.isThreeDMode()&&this.getInvertedColors()}canUseAdvancedStyling(){return this.graphSettings.config.advancedStyling}getDegreeMode(){return this.graphSettings.degreeMode}isThreeDMode(){return this.graphSettings.threeDMode}showPlane3D(){let{threeDMode:e,showAxis3D:t,showPlane3D:r}=this.graphSettings;return e&&t&&r}showNumbers3D(){let{threeDMode:e,showAxis3D:t,showNumbers3D:r}=this.graphSettings;return e&&t&&r}getTranslucentSurfaces(){return!!this.graphSettings.config.translucentSurfaces}getPerspectiveDistortion(){let e=this.graphSettings.config.perspectiveDistortion;return isNaN(e)?1:e<1e-4?0:__dcg_shared_module_exports__.Sb(e,0,f0)}isBeta3DMode(){return this.isThreeDMode()&&this.getGraphSettings().config.beta3d}areLogModeRegressionsForced(){return this.graphSettings.config.forceLogModeRegressions}areLogModeRegressionsDefault(){return this.graphSettings.config.defaultLogModeRegressions}setAllRegressionsToLogMode(){for(let e of this.getAllItemModels())e.type==="expression"&&e.formula&&e.formula.is_regression&&yL(e,!0)}isGraphSettingsOpen(){return this.layoutModel.graphSettingsOpen}isAddExpressionOpen(){return this.layoutModel.addExpressionOpen}shouldRenderList(){if(this.layoutModel.expressionsVisible)return!0;let e=this.layoutModel.expressionsHiddenTime;return e===void 0?!1:Date.now()-e<=500}isListVisible(){return this.layoutModel.expressionsVisible}isGrapherEnabled(){return this.graphSettings.config.graphpaper!==!1}isListEnabled(){return this.graphSettings.config.expressions!==!1}areDistributionsEnabled(){return this.graphSettings.config.distributions===!0}isExpressionListFocused(){let e=this.getFocusLocation();if(!e)return!1;switch(e.type){case"settings":case"generic-menu":case"expression-menu":case"editable-label":case"geo-token":case"multi-select-more-icon":case"multi-select-construct-icon":case"multi-select-label-icon":case"multi-select-style-icon":case"geo-header-back-link":case"multi-select-show-hide-icon":case"new-transformation-number":case"label-points-icon":case"geo-show-constructions-icon":case"geo-basic-tool":case"geo-basic-tool-menu-item":case"geo-construct-menu-existing-transformations":case"regression-output":case"stats-output":case"graph-paper":case"zoom-in-btn":case"zoom-restore-btn":case"quest":case"global-mute-button":case"color-picker-option":case"multi-select-label-menu-label-input":return!1;case"distribution-param":case"cdf-limit":case"slider-limit":case"domain-limit":case"expression":case"visualization-prop":case"search-expressions":case"replace-expressions":case"ticker":case"table":case"image":case"readonly-expression":case"add-table-regression-btn":case"table-regression-delete-btn":case"table-regression-type-dropdown":case"table-container":case"text":case"folder":case"add-item-btn":case"add-expression-btn":case"add-note-btn":case"add-table-btn":case"add-folder-btn":case"add-ticker-btn":case"add-image-btn":case"change-image-btn":case"edit-list-toggle":case"expression-icon":case"expression-evaluation":case"image-icon":case"slider-icon":case"slider-animation-properties-icon":case"slider-thumb":case"table-icon":case"table-regression-icon":case"action-icon":case"hide-expression-list-btn":case"show-expression-list-btn":case"top-level-icon":return!0;default:return e}}needsFakeKeypad(){if(this.inAudioTraceMode()&&this.isKeypadEnabled())return!0;let e=this.getFocusLocation();if(!e||this.getBrailleMode()!=="none"&&os())return!1;switch(e.type){case"settings":return rj(e.location);case"new-transformation-number":case"distribution-param":case"cdf-limit":case"slider-limit":case"domain-limit":case"expression":case"visualization-prop":case"search-expressions":case"replace-expressions":case"ticker":return!0;case"expression-menu":return e.location==="opacity"||e.location==="linewidth"||e.location==="lineopacity"||e.location==="pointopacity"||e.location==="pointsize"||e.location==="labelsize"||e.location==="labelangle"||e.location==="updaterule";case"table":{if(this.isInEditListMode())return!1;let t=e.location;if(t.row===0)return!0;let r=this.getItemModel(e.id);if(!r||r.type!=="table")return!1;let n=r.columnModels[t.column];return n?!Uf(n):!1}case"image":return e.location!=="name";case"readonly-expression":case"add-table-regression-btn":case"table-regression-delete-btn":case"table-regression-type-dropdown":case"regression-output":case"stats-output":case"graph-paper":case"table-container":case"text":case"folder":case"add-item-btn":case"add-expression-btn":case"add-note-btn":case"add-table-btn":case"add-folder-btn":case"add-ticker-btn":case"add-image-btn":case"change-image-btn":case"edit-list-toggle":case"hide-expression-list-btn":case"show-expression-list-btn":case"geo-token":case"multi-select-more-icon":case"multi-select-construct-icon":case"multi-select-label-icon":case"multi-select-style-icon":case"geo-header-back-link":case"multi-select-show-hide-icon":case"label-points-icon":case"geo-show-constructions-icon":case"geo-basic-tool":case"geo-basic-tool-menu-item":case"geo-construct-menu-existing-transformations":case"generic-menu":case"zoom-in-btn":case"zoom-restore-btn":case"quest":case"global-mute-button":case"color-picker-option":case"multi-select-label-menu-label-input":return!1;case"expression-icon":case"expression-evaluation":case"image-icon":case"slider-icon":case"action-icon":case"slider-animation-properties-icon":case"slider-thumb":case"table-icon":case"table-regression-icon":case"top-level-icon":return!1;case"editable-label":return this.getItemEditableLabelMode(e.id)==="MATH";default:return e}}isIdentifierRenameValid(e){return ya(e)?!B4(this.listModel,e):!1}getBrandingMode(){return this.getEditLink()?"static-edit-link":this.getGraphSettings().config.editOnWeb?"edit-link":"powered-by"}getEditLink(){return window.iframeEmbedBrandingLink}_expressionZoomFit(e,t){let r=this.getItemModel(e);if(this.isThreeDMode()||!this.grapher2d||!this.isZoomFitEnabled()||!r||r.type!=="expression"&&r.type!=="table"||(!r.boundingBoxes||!r.boundingBoxes.length)&&!t.justResiduals)return!1;let n=this.grapher2d.viewportController;if(!("zoomCustom"in n))return!1;let i=r.boundingBoxes;if(t.justResiduals){let a=this.getBoundingBoxForResidualsZoomFit(r);a!==void 0&&(i=a)}if(i===void 0)return!1;let o=c1(i,n.getProjection());return o?(t.synchronous?n.setViewport(Br.fromObject(o)):n.zoomCustom(o),t.focusAfterTap&&qr(this,{type:"zoom-restore-btn"}),!0):!1}_deleteItemAndAnimateOut(e,t){let r=this.getItemNodeById(e);r&&(Wn(r,{transition:.2+"s",opacity:"0",transform:"scale(.1, .1)"}),setTimeout(()=>{this.dispatch({type:"finish-deleting-item-after-animation",id:e,setFocusAfterDelete:t})},1e3*.2))}_finishDeletingItemAfterAnimation(e,t){let r=this.getItemModel(e);if(!r)return;let n=this.getItemNodeById(e),i=n&&document.activeElement&&n.contains(document.activeElement),o=Ew(this.listModel,r.index);if(this._removeExpressionSynchronously(r),!(!t||!i)){if(!o){let a=eb(this.listModel);a&&(o=a)}o&&bi(this,o.id,"end")}}_removeExpressionSynchronously(e){var t;if(e.type==="expression"){let n=(t=e.formula.regression)==null?void 0:t.residualVariable;if(n){for(let i of this.getAllItemModels())if(i.type==="table"){let o=i.columnModels.findIndex(a=>a.latex===n);if(o>=0){mw(i,o);break}}}}let r=ib(this.listModel,e.index);this.trackActionForPotentialEvaluatorRestart("remove",e.id),r.forEach(n=>this.trackActionForPotentialEvaluatorRestart("remove",n.id)),this.garbageCollectGeo(r,{}),this.ensureAtLeastOneVisibleItem()}setRootElt(e){this.rootElt=e,this.dragdrop_expressions=new O0(this)}getRootElt(){return this.rootElt}_hideExpressions(e){this.graphSettings.config.expressions&&(Nr(this.listModel,void 0),this.layoutModel=ie(R({},this.layoutModel),{expressionsVisible:!1,expressionsHiddenTime:Date.now()}),e?qr(this,{type:"show-expression-list-btn"}):Jr())}_showExpressions(e){this.graphSettings.config.expressions&&(this.layoutModel=ie(R({},this.layoutModel),{expressionsVisible:!0}),e?qr(this,{type:"hide-expression-list-btn"}):Jr())}_showToast(e){this.toastData=e,clearTimeout(this._hideToastTimeout);let t=typeof e.hideAfter=="number"?e.hideAfter:6e3;t>0&&(this._hideToastTimeout=setTimeout(()=>{this.dispatch({type:"toast/close",onHide:this.toastData.onHide})},t))}_setExpressionPropertiesFromAPI(e,t){let r=this.getItemModel(e);if(r)if(r.type==="table"&&t.columns){t=__dcg_shared_module_exports__.Jc(t);let n=cz(r,t),i=Qf(this.listModel,n);this._toplevelReplaceItemAt(r.index,i,!1)}else if(r.type==="text"){let n=this.getItemModel(e);if(!n)return;for(let i in t)if(t.hasOwnProperty(i))switch(i){case"text":XG(n,t.text);break;case"secret":fE(n,t.secret);break;case"readonly":yw(n,t.readonly);break}}else{let n=this.getItemModel(e);if(!n)return;for(let i in t)if(t.hasOwnProperty(i))switch(i){case"slider":{if(n.type!=="expression")continue;let o=t[i];o.hasOwnProperty("min")&&sb(n,o.min),o.hasOwnProperty("max")&&lb(n,o.max),o.hasOwnProperty("step")&&Gw(n,o.step),o.hasOwnProperty("isPlaying")&&As(n,o.isPlaying)}break;case"polarDomain":{if(n.type!=="expression")continue;Ka(n,__dcg_shared_module_exports__.be(t.polarDomain.min),"theta"),Wa(n,__dcg_shared_module_exports__.be(t.polarDomain.max),"theta")}break;case"parametricDomain":{if(n.type!=="expression")continue;Ka(n,__dcg_shared_module_exports__.be(t.parametricDomain.min),"t"),Wa(n,__dcg_shared_module_exports__.be(t.parametricDomain.max),"t")}break;case"parametricDomain3Du":{if(n.type!=="expression")continue;Ka(n,__dcg_shared_module_exports__.be(t.parametricDomain3Du.min),"u"),Wa(n,__dcg_shared_module_exports__.be(t.parametricDomain3Du.max),"u")}break;case"parametricDomain3Dv":{if(n.type!=="expression")continue;Ka(n,__dcg_shared_module_exports__.be(t.parametricDomain3Dv.min),"v"),Wa(n,__dcg_shared_module_exports__.be(t.parametricDomain3Dv.max),"v")}break;case"parametricDomain3Dr":{if(n.type!=="expression")continue;Ka(n,__dcg_shared_module_exports__.be(t.parametricDomain3Dr.min),"r"),Wa(n,__dcg_shared_module_exports__.be(t.parametricDomain3Dr.max),"r")}break;case"parametricDomain3Dphi":{if(n.type!=="expression")continue;Ka(n,__dcg_shared_module_exports__.be(t.parametricDomain3Dphi.min),"phi"),Wa(n,__dcg_shared_module_exports__.be(t.parametricDomain3Dphi.max),"phi")}break;case"hidden":this._setItemHidden(e,t.hidden);break;case"secret":fE(n,t.secret);break;case"readonly":yw(n,t.readonly);break;case"color":{if(n.type!=="expression")continue;iT(n,t.color)}break;case"dragMode":{if(n.type!=="expression")continue;Mg(n,t.dragMode)}break;case"label":{if(n.type!=="expression")continue;yd(n,t.label)}break;case"showLabel":{if(n.type!=="expression")continue;Ku(n,t.showLabel)}break;case"labelSize":{if(n.type!=="expression")continue;Fw(n,t.labelSize)}break;case"labelOrientation":{if(n.type!=="expression")continue;SL(n,t.labelOrientation)}break;case"latex":if(n.type!=="expression")continue;$a(n,t.latex);break;case"points":if(n.type!=="expression")continue;wL(n,!!t.points);break;case"lines":if(n.type!=="expression")continue;CL(n,!!t.lines);break;case"pointStyle":if(n.type!=="expression")continue;vL(n,t.pointStyle);break;case"pointSize":case"movablePointSize":if(n.type!=="expression")continue;Ow(n,t.pointSize);break;case"pointOpacity":if(n.type!=="expression")continue;Vw(n,t.pointOpacity);break;case"lineStyle":if(n.type!=="expression")continue;nT(n,t.lineStyle);break;case"lineWidth":if(n.type!=="expression")continue;db(n,t.lineWidth);break;case"lineOpacity":if(n.type!=="expression")continue;cb(n,t.lineOpacity);break;case"fill":if(n.type!=="expression")continue;xL(n,t.fill);break;case"fillOpacity":if(n.type!=="expression")continue;Lw(n,t.fillOpacity);break;case"surfaceOpacity":if(n.type!=="expression")continue;Pw(n,t.surfaceOpacity);break;case"id":case"type":case"domain":break;default:throw new Error("trying to call setProperty for: "+i)}}}_isParentFolderHidden(e){let t=this.getItemModel(e);if(!t)return!1;let r=Ca(t);return r?r.hidden:!1}_toggleItemHidden(e){var t;if(this._isParentFolderHidden(e))this._setItemHidden(e,!1);else{let r=this.getItemModel(e);if(!r)return;switch(r.type){case"expression":this._setItemHidden(e,!Hi(r));break;case"image":case"folder":this._setItemHidden(e,!r.hidden);break;case"table":case"text":break;default:return r}Is(r)&&(Hi(r)||this.logEvent({category:"tone",action:Hi(r)?"mute-local":"unmute-local"}),(t=this.toneController)==null||t.recomputeAudio())}}_toggleTableColumnHidden(e,t){if(this._isParentFolderHidden(e))this._setTableColumnHidden(e,t,!1);else{let r=this.getItemModel(e);if(!r||r.type!=="table")return;let n=Eo(r,t);if(!n)return;this._setTableColumnHidden(e,t,!n.hidden)}}_setTableColumnHidden(e,t,r){let n=this.getItemModel(e);if(!n||n.type!=="table")return;let i=cE(n,t);!r&&this._isParentFolderHidden(e)&&this._setItemHidden(n.folderId,!1),yz(n,t,r),!r&&i&&NG(n,t,!0)}_setItemHidden(e,t){let r=this.getItemModel(e);if(!r)return;!t&&r.type!=="folder"&&this._isParentFolderHidden(r.id)&&this._setItemHidden(r.folderId,!1);let n;switch(r.type){case"expression":{n=Hi(r),rH(r,t);break}case"folder":n=Oz(r),Vz(r,t);break;case"image":Qz(r,t);break;case"table":case"text":break;default:return r}n!==void 0&&t&&!n&&(r.type==="expression"?this.trackActionForPotentialEvaluatorRestart("hide",r.id):r.type==="folder"&&this.getAllItemModels().filter(i=>i.type==="expression"&&i.folderId===r.id).forEach(i=>this.trackActionForPotentialEvaluatorRestart("hide",i.id)))}_addItemToEndFromAPI(e){let t=PE(this.listModel);!e.secret&&t&&t.type==="expression"&&t.latex===""&&ib(this.listModel,t.index),ol(this.listModel,e)}copyExpressionToIndex(e,t,r){let n={stripDefaults:!1},i;switch(e.type){case"expression":i=Mw(e,n);break;case"table":i=Bf(e,n);let a={};i.columns&&i.columns.forEach(s=>{let l=this.generateId();a[s.id]=l,s.id=l}),i.regression&&(i.regression=ie(R({},i.regression),{id:this.generateId(),columnIds:{x:a[i.regression.columnIds.x],y:a[i.regression.columnIds.y]}}));break;case"image":i=DE(e,n);break;case"text":i=AE(e,n);break;default:return}let o=this.createItemModel(ie(R({},i),{id:this.generateId()}));this._toplevelInsertItemAt(t,o,!1,r||e.folderId)}_toplevelInsertItemAt(e,t,r,n){let i=t;_s(this.listModel,i,e),n&&_n(i,n),r&&bi(this,i.id)}_toplevelNewItemAtSelection(e,t){this.setGeoTool("selection");let r=this.getSelectedItem();if(r){let o=r.type==="expression"&&!r.latex;if(o&&!r.folderId&&(e.type!=="expression"||e.latex))return this._toplevelReplaceItemAt(r.index,e,t.shouldFocus);if(o&&r.folderId&&e.type!=="expression"&&e.type!=="folder")return this._toplevelReplaceItemAt(r.index,e,t.shouldFocus);if(r.type!=="folder"&&!r.folderId)return this._toplevelInsertItemAt(r.index+1,e,t.shouldFocus,void 0);if(r.type!=="folder"&&r.folderId&&e.type!=="folder")return this._toplevelInsertItemAt(r.index+1,e,t.shouldFocus,r.folderId);if(r.type==="folder"&&!r.collapsed&&e.type!=="folder")return this._toplevelInsertItemAt(r.index+1,e,t.shouldFocus,r.id)}let n=this.getFirstFullyVisibleItem();for(n&&n.type==="folder"&&(n=this.getItemModelByIndex(n.index+1));n&&n.type!=="folder"&&n.folderId;)n=this.getItemModelByIndex(n.index+1);let i=n?n.index:this.getItemCount();return this._toplevelInsertItemAt(i,e,t.shouldFocus,void 0)}getFirstFullyVisibleItem(){let e=jO(this);if(e)return bd(this.listModel,e)}findEl(e){if(this.rootElt)return this.rootElt.querySelector(e)||void 0}getExppanelElt(){return L0(this)}scrollItemIntoView(e){if(!this.rootElt||!this.isListVisible())return;let t=this.getItemNodeById(e.id),r=L0(this);if(!(!t||!r)){if(e.type==="table"){let n=t.querySelector(".dcg-select-dropdown-list");if(n){tc(n,r,60);return}let i=t.querySelector(".dcg-row .dcg-selected");if(i){tc(i,r,60);return}}tc(t,r,90)}}scrollSelectedItemIntoView(){let e=this.getFirstSelectedItem();if(e){if(e&&e.type!=="folder"&&e.folderId){let t=this.getItemModel(e.folderId);t&&t.type==="folder"&&t.collapsedChildIsSelected&&(e=t)}this.scrollItemIntoView(e)}}_pasteTable(e){let t=this.getGrapher();if(!t)return;let r=OE(this.listModel),n=FG(r,e,this),i=this.createItemModel(n);this._toplevelNewItemAtSelection(i,{shouldFocus:!0}),this._closeAddExpression();let o=t.getProjection(),a=o.viewport,s=__dcg_shared_module_exports__.h(e[0],d=>parseFloat(d)),l=__dcg_shared_module_exports__.h(e[1],d=>parseFloat(d));if(this.is3dProduct())return;let c={xmin:__dcg_shared_module_exports__.o(s),xmax:__dcg_shared_module_exports__.n(s),ymin:__dcg_shared_module_exports__.o(l),ymax:__dcg_shared_module_exports__.n(l),type:"table"};if(isFinite(c.xmin)&&isFinite(c.xmax)&&isFinite(c.ymin)&&isFinite(c.ymax)&&(c.xmax>a.xmax||c.xmin<a.xmin||c.ymax>a.ymax||c.ymin<a.ymin)){let d=c1([c],o);if(d&&!this.viewportIsLocked()){let u=new Br(d.xmin,d.xmax,d.ymin,d.ymax);t.viewportController.setViewport(u),this._showToast({message:this.s("graphing-calculator-text-toast-zoom-to-fit"),undoCallback:()=>{this.dispatch({type:"undo"})}}),this.markSquareAxesAfterUserEditedViewport()}}}_insertSeveralExpressions(e){for(let t=0;t<e.length;t++){let r=this.createItemModel(e[t]);this._toplevelNewItemAtSelection(r,{shouldFocus:!0})}}_appendNumberList(e){let t=this.getSelectedItem();if(t&&t.type==="expression"){let r=t.latex,n=this.createItemModel({type:"expression",id:this.generateId(),latex:r+e});return this._toplevelReplaceItemAt(t.index,n,!0)}}_openOnWeb(){this.runAfterDispatch(()=>{let e=this.getGrapher();if(!e)return;let t=JSON.stringify(this.getState()),r=e.screenshot({width:100,height:100}),n=(this.getGraphSettings().config.crossOriginSaveTest?"/":"https://www.desmos.com/")+"api/v1/calculator/cross_origin_save",i=document.createElement("div");aj.mountToNode(rA,i,{stateData:()=>t,thumbData:()=>r,saveURL:()=>n}),this.rootElt.append(i);let o=i.querySelector("form[name=open_graph_on_web]");ee(o).trigger("submit"),i.remove()})}notifyBugsnagAboutMissingSelectedItem(e,t){let r=Ig(this.listModel),n="";try{r?n=JSON.stringify(r.cachedUndoRedoFullState,null,2):n="undefined"}catch(a){n="[[could not stringify]]"}let i="";try{if(!r)i="undefined";else{let a={id:r.id,index:r.index,displayIndex:r.index,secretIndex:r.secretIndex,guid:r.guid,renderShell:r.renderShell,isHiddenFromUI:r.isHiddenFromUI,hasDCGView:!!r.rootViewNode,cachedRenderHeight:r.cachedRenderHeight};i=JSON.stringify(a,null,2)}}catch(a){i="[[could not stringify]]"}let o="";try{o=JSON.stringify(eL(this.listModel),null,2)}catch(a){o="[[could not stringify]]"}}_toplevelReplaceItemAt(e,t,r){let n=t,i=this.getItemModelByIndex(e);i||this.notifyBugsnagAboutMissingSelectedItem(e,r);let o=i.type!=="folder"&&i.folderId;ib(this.listModel,e),_s(this.listModel,n,e),o&&_n(n,o),r&&bi(this,n.id)}convertImageToDraggable(e){let t=this.getItemModel(e);if(!t||t.type!=="image")return;let r=t.folderId,n=t.index+1,i=t.center,o=OE(this.listModel),a=__dcg_shared_module_exports__.ma("C_"+o),s=this.createItemModel({id:this.generateId(),type:"expression",latex:a+"="+i,dragMode:"XY",hidden:!0});_s(this.listModel,s,n),r&&_n(s,r),ks(t,"center",a),KG(t,!0),WG(t,!0)}createSlidersForItem(e,t){let r=this.getItemModel(e);if(!r)return;let n=r.type!=="folder"&&r.folderId;return this.createSliders({model:r,folderId:n,index:r.index+1},t)}createSlidersForTicker(e){return this.createSliders({model:this.listModel.ticker,folderId:!1,index:0,doNotChangeFocus:!0},e)}createSliders({model:e,folderId:t,index:r,doNotChangeFocus:n},i){let o=[];e.type==="ticker"?ME(e,(d,u)=>{o.push({latex:d,location:u})}):Jf(e,(d,u)=>{o.push({latex:d,location:u.location})});let a=K$(o,i,{degreeMode:this.graphSettings.degreeMode}),s=e.formula?e.formula.action_value:void 0,l=i.map(d=>{let u=a[d],p="1";u&&u.value!==void 0&&(p=u.value);let g,f=__dcg_shared_module_exports__.na(d);d===""?g="":s&&s.hasOwnProperty(f)?g=s[f]:g=d+"="+p;let y={type:"expression",id:this.generateId(),latex:g,color:this.getNextColor(),hidden:!!g};return u&&(u.min!==void 0&&(y.slider||(y.slider={}),y.slider.hardMin=!0,y.slider.min=u.min),u.max!==void 0&&(y.slider||(y.slider={}),y.slider.hardMax=!0,y.slider.max=u.max),u.step!==void 0&&(y.slider||(y.slider={}),y.slider.step=u.step)),y});for(let d=l.length-1;d>=0;d--){let u=this.createItemModel(l[d]);_s(this.listModel,u,r),t&&_n(u,t)}if(n)return;let c=l[l.length-1];c.latex===""?bi(this,c.id):qr(this,void 0)}_uploadImagesAndWaitForThemToLoad(e){let{files:t,id:r}=e;if(!t||t.length===0){this._showToast({message:this.s("graphing-calculator-text-toast-no-file-selected")});return}if(r&&t.length>1){this._showToast({message:this.s("graphing-calculator-text-toast-choose-one-file")});return}let n=d4({controller:this,files:t,id:r}),i=n.errors[0];i&&this._showToast({message:i});for(let o of n.tokens)this.__pendingImageUploads[o]=!0;this.isUploadingImages()&&this._showToast({message:this.s("graphing-calculator-text-toast-uploading-images"),onHide:()=>{this._clearPendingImageUploads()}})}getImageToRetry(){let e;for(let t of this.getAllItemModels())t.type==="image"&&t.loadStatus==="failed"&&(!e||e.failures>t.failures)&&(e=t);return e}retryLoadingFailedImage(e){let t=Date.now(),r=t-this.imageRetryState.lastAttemptTime,n=1e3*Math.pow(2,this.imageRetryState.attempts);this.imageRetryState.attempts>0&&r<n||(jG(e),this.imageRetryState={lastAttemptTime:t,attempts:this.imageRetryState.attempts+1})}getSelectedItem(){return Ig(this.listModel)}getFirstSelectedItem(){let e=this.getAllSelectedItems(),t=e[0];if(t){for(let r=1;r<e.length;r++){let n=e[r];n.index<t.index&&(t=n)}return t}}getAllSelectedItems(){return FE(this.listModel)}getOpenItemMenu(){return this.listModel.openItemMenu}isItemSettingsMenuOpen(e){let t=this.listModel.openItemMenu;return t?t.guid===e:!1}closeItemSettingsMenu(){let e=this.getOpenItemMenu();e!==void 0&&(e.focusFirstOption&&(e.previousFocusLocation!==void 0?qr(this,e.previousFocusLocation):this.focusOpenMenuIcon()),this.listModel.openItemMenu=void 0)}focusOpenMenuIcon(){let e=this.getOpenItemMenu();e&&(e.type==="slider"?this.dispatch({type:"set-focus-location",location:{type:"slider-animation-properties-icon",id:e.model.id}}):e.type==="image"?this.dispatch({type:"set-focus-location",location:{type:"image-icon",id:e.model.id}}):e.type==="table-column"?this.dispatch({type:"set-focus-location",location:{type:"table-icon",id:e.model.table.id,columnId:e.model.id}}):e.type==="table-regression"?this.dispatch({type:"set-focus-location",location:{type:"table-regression-icon",id:e.model.id}}):e.type==="geo-tool-dropdown"?this.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:e.tools[0]}}):e.type==="multi-select-more"?this.dispatch({type:"set-focus-location",location:{type:"multi-select-more-icon"}}):e.type==="multi-select-construct"?this.dispatch({type:"set-focus-location",location:{type:"multi-select-construct-icon"}}):e.type==="multi-select-style"?this.dispatch({type:"set-focus-location",location:{type:"multi-select-style-icon"}}):e.type==="multi-select-label"?this.dispatch({type:"set-focus-location",location:{type:"multi-select-label-icon"}}):this.dispatch({type:"set-focus-location",location:{type:"expression-icon",id:e.model.id}}))}getFocusedItem(){return N$(this)}getFocusLocation(){return this.focusLocation}isFocusLocationFocused(e){let t=this.focusLocation,r=e;return!t||!r?!1:__dcg_shared_module_exports__.E(t,r)}isCurrentFocusLocationValid(){var e;let t=this.focusLocation;if(!t)return!0;if(t.type==="settings")return t.location==="icon"||this.isGraphSettingsOpen();if(t.type==="add-item-btn"||t.type==="edit-list-toggle"||t.type==="hide-expression-list-btn"||t.type==="show-expression-list-btn")return this.isListEnabled();if(t.type==="add-expression-btn"||t.type==="add-table-btn")return this.layoutModel.addExpressionOpen;if(t.type==="add-note-btn")return this.layoutModel.addExpressionOpen&&this.areNotesEnabled();if(t.type==="add-folder-btn")return this.layoutModel.addExpressionOpen&&this.areFoldersEnabled();if(t.type==="add-ticker-btn")return this.layoutModel.addExpressionOpen&&this.areActionsEnabled();if(t.type==="add-image-btn")return this.layoutModel.addExpressionOpen&&this.areImagesEnabled();if(t.type==="zoom-in-btn"||t.type==="zoom-restore-btn")return!0;if(t.type==="search-expressions"||t.type==="replace-expressions")return this.expressionSearchOpen;if(t.type==="ticker")return this.listModel.ticker.open;if(t.type==="generic-menu")return!!this.getOpenItemMenu();if(t.type==="graph-paper"){let i=this.getGrapher();return!!(i&&i.getIsVisible()&&i.settings.config.graphpaper)}if(t.type==="geo-show-constructions-icon"||t.type==="geo-token"||t.type==="multi-select-more-icon"||t.type==="multi-select-construct-icon"||t.type==="multi-select-style-icon"||t.type==="multi-select-label-icon"||t.type==="label-points-icon")return this.isGeoUIActive();if(t.type==="new-transformation-number"){let i=this.getGeoModel(),o=i.getCurrentTool(),a=i.getNonObjectsState().ui.currentTool.inputIndex,s=o.getSpec&&o.getSpec();return!!s&&!!s.inputs[a]&&!!s.inputs[a].numberInputInfo}if(t.type==="geo-header-back-link"||t.type==="multi-select-show-hide-icon")return this.isGeoUIActive()&&this.hasAnyItemsSelected();if(t.type==="geo-basic-tool")return this.isGeoUIActive()&&t.tool!=="expression-edit";if(t.type==="regression-output")return!!this.getItemModel(t.id)&&t.parameter!=="";if(t.type==="stats-output"){let i=this.getItemModel(t.id);return!!(i&&i.type==="expression"&&uT(i)&&t.parameter!=="")}if(t.type==="quest")return this.getQuestIsActive();let r=this.getOpenItemMenu();if(t.type==="geo-basic-tool-menu-item")return this.isGeoUIActive()&&t.tool!==""&&r!==void 0&&(r.type==="geo-tool-dropdown"||r.type==="multi-select-construct");if(t.type==="geo-construct-menu-existing-transformations")return this.isGeoUIActive()&&(r==null?void 0:r.type)==="multi-select-construct";if(t.type==="multi-select-label-menu-label-input")return this.isGeoUIActive()&&this.hasAnyItemsSelected()&&(r==null?void 0:r.type)==="multi-select-label";if(t.type==="global-mute-button")return!!((e=this.toneController)!=null&&e.someExpressionsShouldPlayTones());if(t.type==="color-picker-option")return!0;let n;if(r&&r.type==="table-column"?n=r.model.table:n=this.getItemModel(t.id),!n)return!1;if(t.type==="change-image-btn")return this.listModel&&n.type==="image"&&this.areImagesEnabled();if(t.type==="expression-menu"){let i=this.getOpenItemMenu();if(!i||(i.type==="expression"||i.type==="image"||i.type==="table-column")&&i.model.id!==t.id)return!1;if(t.location==="start"||t.location==="end"||t.location==="updaterule"||t.location==="anywhere"||n.type==="table")return!0;if(n.type!=="expression")return!1;let{points:o,lines:a,fill:s}=n;wd(n)&&(s=!0);let l=__dcg_shared_module_exports__.Zc(n.formula.expression_type,{points:o,lines:a,fill:s},c=>{});return!(!l.fill&&!l.points&&!l.lines&&!n.showLabel)}if(t.type==="add-table-regression-btn")return this.areTableRegressionsEnabled()&&n.type==="table"&&!n.regression;if(t.type==="table-regression-delete-btn"||t.type==="table-regression-type-dropdown")return this.areTableRegressionsEnabled()&&n.type==="table"&&!!n.regression;if(!this.isItemSelected(t.id)&&t.type!=="editable-label")return!1;switch(t.type){case"domain-limit":return!(n.type!=="expression"||!Wu(n)&&!Dp(n));case"expression-icon":case"top-level-icon":return!0;case"expression-evaluation":return this.shouldShowEvaluationForItem(n.id)||this.shouldShowCDFEvaluationForItem(n.id);case"image-icon":return n.type==="image"&&n.loadStatus!=="loading"&&n.loadStatus!=="failed"&&!n.error;case"action-icon":return!(n.type!=="expression"||!vb(n));case"slider-icon":case"slider-animation-properties-icon":case"slider-thumb":case"slider-limit":return!(n.type!=="expression"||!nH(n));case"table-icon":return n.type==="table"&&this.getGraphSettings().config.graphpaper;case"table-regression-icon":return this.areTableRegressionsEnabled()&&n.type==="table"&&!!n.regression;case"visualization-prop":return!(n.type!=="expression"||!pT(n));case"distribution-param":if(n.type!=="expression")return!1;let i=sl(n);return i?t.location in i.values:!1;case"cdf-limit":return n.type!=="expression"?!1:vd(n);case"image":return n.type==="image";case"folder":return n.type==="folder";case"text":return n.type==="text";case"expression":return!(n.type!=="expression"||this.isInEditListMode()||t.isFakeGraphFocus&&!this.getValidCursorContext());case"readonly-expression":return this.isItemReadonly(n.id)||n.type==="expression"&&this.isInEditListMode();case"table":return n.type!=="table"?!1:Cz(n,t.location);case"table-container":return n.type==="table"&&this.isInEditListMode();case"editable-label":return n.type!=="expression"?!1:xb(n);default:return t}}shouldAllowMovingPointsWithKeyboard(){let e=this.getActiveTool();return e==="selection"||e==="box-selection"}isDragDropActive(){return!!this.listModel.dragState}isItemBeingDragged(e){let t=this.listModel.dragState;return!(!t||t.firstItemId!==e)}shouldRenderDraggedItemAsToken(){let e=this.listModel.dragState;return e?e.renderType==="token":!1}canDraggedItemBeMovedIntoTokenPane(){var e,t,r;let n=this.getDraggedItemId();if(!n)return!1;let i=this.getItemModel(n);if(!i||i.type!=="expression"||this.isItemMarkedReadonly(i.id))return!1;let o=(e=i.formula.geometry)==null?void 0:e.valueType;return o===void 0||(t=i.formula.geometry)!=null&&t.unconstructable||i.formula.recursion_base_case||i.formula.function_definition&&!__dcg_shared_module_exports__.Ab(o,__dcg_shared_module_exports__.Za)?!1:!!((r=i.formula.geometry)!=null&&r.parentDependencies)}getDraggedItemId(){let e=this.listModel.dragState;return e&&e.firstItemId}getDraggedIdentifier(){var e;let t=this.getRawDragState();if(!t)return;let r=this.getItemModel(t.dragTarget.calcId);if(!(!r||r.type!=="expression"))return(e=pi(r))==null?void 0:e.identifier}getRawDragState(){return this.listModel.dragState}initStateStack(){this.stateStack=new su,this.stateStack.addState({diffState:this.getUndoRedoDiffState(),fullState:this.getUndoRedoFullState()})}getUndoRedoDiffState(){var e;return{randomSeed:this.getRandomSeed(),includeFunctionParametersInRandomSeed:this.getIncludeFunctionParametersInRandomSeed(),layoutModel:this.layoutModel,settingsViewModel:this.settingsViewModel,graph:(e=this.getGrapher())==null?void 0:e.getUndoRedoDiffState(),expressions:rq(this.listModel),geometryToolbar:zG(this.geometryToolbarModel),wasCompleteSetState:this.isCurrentlyDoingSetState}}getUndoRedoFullState(){var e;return{randomSeed:this.getRandomSeed(),includeFunctionParametersInRandomSeed:this.getIncludeFunctionParametersInRandomSeed(),layoutModel:this.layoutModel,settingsViewModel:this.settingsViewModel,graph:(e=this.getGrapher())==null?void 0:e.getUndoRedoFullState(),expressions:eL(this.listModel),geometryToolbar:zG(this.geometryToolbarModel),wasCompleteSetState:this.isCurrentlyDoingSetState}}getState(e){var t,r;let n={stripDefaults:!0};e&&e.hasOwnProperty("stripDefaults")&&(n.stripDefaults=!!e.stripDefaults);let i=(r=(t=this.getGrapher())==null?void 0:t.getState(n))!=null?r:ie(R({},this.getBlankState().graph),{degreeMode:this.graphSettings.degreeMode}),o={version:_l,randomSeed:this.getRandomSeed(),graph:i,expressions:oq(this.listModel,n)},a=this.getIncludeFunctionParametersInRandomSeed();if((!a||!n.stripDefaults)&&(o.includeFunctionParametersInRandomSeed=a),this.isGeometry()){let s=zz(this.geometryToolbarModel,n);s&&(o.geometryToolbar=s)}return e&&e.avoidBackMigration?__dcg_shared_module_exports__.Jc(o):VN(__dcg_shared_module_exports__.Jc(o))}getHistory(){return new tA(this.getState(),this.stateStack)}getProduct(){return this.graphSettings.config.product}isGeometry(){return this.getProduct()==="geometry-calculator"}is3dProduct(){return this.getProduct()==="graphing-3d"}isMultiSelectEnabled(){return this.isGeometry()}shouldEvaluateSelection(){return this.isGeometry()}canLoadPastedLink(e){return this.graphSettings.config.pasteGraphLink?this.isGeometry()?AI(e)||KO(e)||$O(e):this.is3dProduct()?WO(e):AI(e):!1}getBlankState(e){if(this.isGeometry())return nf;if(this.is3dProduct())return J$;let t;(e==null?void 0:e.degreeMode)!==void 0?t=e.degreeMode:t=this.graphSettings.config.clearIntoDegreeMode;let r=R({},Bx.graph);return t&&(r.degreeMode=!0),ie(R({},Bx),{graph:r})}externalSetState(e,t){var r;this._clearPendingImageUploads(),this.rootElt&&document.activeElement&&this.rootElt.contains(document.activeElement)&&ee(document.activeElement).trigger("blur"),t||(t={}),e||(e=this.getBlankState()),typeof e=="string"&&(e=JSON.parse(e));let n=dc(e);!this.canEnableComplexMode()&&(r=n==null?void 0:n.graph)!=null&&r.complex&&(n.graph.complex=!1,n.graph.degreeMode=e.graph.degreeMode);let i=this.graphSettings.config.product,o;if(!n.graph||n.graph.product===void 0?o="graphing":o=n.graph.product,o!==i)throw new Error(`Data Error: state appears to have been saved in the '${o}' product and cannot be opened in the '${i}' product.`);i==="geometry-calculator"&&(this.showConstructionsOpen=!1),Z5&&i==="graphing-3d"&&n.graph.speed3D&&delete n.graph.speed3D;let a=this.layoutModel;this.setState(n,t),J4(this.listModel),RE(this.listModel),this.layoutModel=ie(R({},fR(this.graphSettings.config)),{keypadMinimized:a.keypadMinimized,keypadLayout:a.keypadLayout,keypadFunctionsOpen:a.keypadFunctionsOpen,expressionsVisible:!!this.graphSettings.config.expressions&&(this.isListVisible()||!!t.forceExpressionsOpen)}),this.settingsViewModel=bR(),qr(this,void 0),t.forceUnsavedChanges?this.enqueueEvent("change"):this.enqueueEvent("clearUnsavedChanges")}setState(e,t){var r;if(this.isCurrentlyDoingSetState=!0,"graph"in e&&e.graph!==void 0){if("threeDMode"in e.graph&&e.graph.threeDMode&&this.grapher3d){if("showBox3D"in e.graph&&this.grapher3d.webglLayer.showBox(e.graph.showBox3D),"showAxis3D"in e.graph&&this.grapher3d.webglLayer.showAxes(!!e.graph.showAxis3D),"showAxisLabels3D"in e.graph&&this.grapher3d.webglLayer.updateAxes(),"showPlane3D"in e.graph||"showAxis3D"in e.graph){let o=("showPlane3D"in e.graph?!!e.graph.showPlane3D:this.graphSettings.showPlane3D)&&("showAxis3D"in e.graph?!!e.graph.showAxis3D:this.graphSettings.showAxis3D);this.grapher3d.webglLayer.showPlane(o)}let i=this.grapher3d.baseplaneWidth();this.grapher2d.setCanvasSizeFor3D(i,i),this.grapher3d.webglLayer.setBackgroundColor(e.graph.backgroundColor3d)}let n=this.getGrapher();n?n.setGrapherState(e.graph):am.copyGraphProperties(e.graph,this.graphSettings),"threeDMode"in e.graph&&e.graph.threeDMode&&this.grapher3d&&this.grapher3d.controls.copyWorldRotationToWorld()}if("expressions"in e){Nr(this.listModel,void 0);let n=iq(e.expressions);n>=this.__nextItemId&&(this.__nextItemId=n+1),nq(this.listModel,e.expressions,t||{})}if(e.layoutModel&&(this.layoutModel=e.layoutModel),e.settingsViewModel&&(this.settingsViewModel=e.settingsViewModel),(!t||!t.allowUndo)&&this.clearUndoRedoHistory(),this.setRandomSeed(e.randomSeed||rd()),this.setIncludeFunctionParametersInRandomSeed((r=e.includeFunctionParametersInRandomSeed)!=null?r:Os.includeFunctionParametersInRandomSeed),"geometryToolbar"in e){let n=e.geometryToolbar;this.geometryToolbarModel=wE(n)}}updateToState(e){if(this.isCurrentlyDoingRestoreState=!0,"graph"in e&&(e.graph.threeDMode?this.grapher3d&&this.grapher3d.setGrapherState(e.graph):this.grapher2d&&this.grapher2d.setGrapherState(e.graph,{doNotClear:!0})),"expressions"in e&&aq(this.listModel,e.expressions),e.layoutModel&&(this.layoutModel=e.layoutModel),e.settingsViewModel&&(this.settingsViewModel=e.settingsViewModel),"geometryToolbar"in e){let t=e.geometryToolbar;this.geometryToolbarModel=wE(t)}}commitUndoRedoSynchronously(e){let t=this.stateStack.getState(),r=t&&t.diffState,n=this.getUndoRedoDiffState();if(tpe(r,n))return;let i=this.apiMethodCallStackInfo.withHistoryReplacementDepth>0,o={diffState:n,fullState:this.getUndoRedoFullState()};if(!i&&ij(e))this.stateStack.addState(o),this.enqueueEvent("change",e);else{let a=t&&t.fullState.wasCompleteSetState||o.fullState.wasCompleteSetState,s={diffState:ie(R({},o.diffState),{wasCompleteSetState:a}),fullState:ie(R({},o.fullState),{wasCompleteSetState:a})};this.stateStack.replaceInteriorState(s)}}undo(){if(!this.canUndo())return;this.closeToast(),this.stateStack.undo();let e=this.stateStack.getState().fullState;e.wasCompleteSetState?this.setState(e,{allowUndo:!0}):this.updateToState(e),this.enqueueEvent("change",{type:"undo"})}redo(){if(!this.canRedo())return;this.stateStack.redo();let e=this.stateStack.getState().fullState;e.wasCompleteSetState?this.setState(e,{allowUndo:!0}):this.updateToState(e),this.enqueueEvent("change",{type:"undo"})}clearUndoRedoHistory(){this.stateStack.clear()}canUndo(){return this.stateStack.canUndo()}canRedo(){return this.stateStack.canRedo()}closeToast(){let e=this.toastData.onHide;e&&this.runAfterDispatch(e),this.toastData={}}_closeAddExpression(){this.layoutModel=ie(R({},this.layoutModel),{addExpressionOpen:!1})}doesDOMHaveSize(){return this.layoutMeasurements.width>0&&this.layoutMeasurements.height>0}_getExpListWidth(){let e;if(this.userSpecifiedExpListWidth!==void 0){let r=this.isGeometry()?320:200;e=Math.max(320,Math.min(this.layoutMeasurements.width-r,this.userSpecifiedExpListWidth))}else{if(e=this.layoutMeasurements.width,!e)return 356;let r=.2*e+160;e=Math.min(500,Math.max(280,r))}let t=this.layoutMeasurements.width-this.getGrapherHeight();return Math.abs(t-e)<=10?t:e}_setExpListWidth(e){this.userSpecifiedExpListWidth!==e&&(this.userSpecifiedExpListWidth=e)}getKeypadHeight(){return this.computeMajorLayout().keypad.height}isKeypadEnabled(){return!!this.graphSettings.config.keypad}isKeypadOpen(){if(!this.isKeypadEnabled())return!1;let e=this.layoutModel.keypadMinimized&&!this.isNarrow();return this.needsFakeKeypad()&&!e}isHideKeypadButtonVisible(){return this.getBrailleMode()==="none"&&this.isKeypadOpen()&&(!this.isNarrow()||this.inAudioTraceMode())}isKeypadFunctionsPopoverOpen(){return!!this.layoutModel.keypadFunctionsOpen}getKeypadLayout(){let e=this.layoutModel.keypadLayout;return this.isThreeDMode()?Z$(e):e}isLetterKeypadOpen(){let e=this.getKeypadLayout();return this.isKeypadOpen()&&(e==="letters"||e==="noQwertyLetters"||e==="capitalLetters"||e==="noQwertyCapitalLetters")}isFileDraggedOver(){return this.layoutModel.isFileDraggedOver}getGeoToolbarHeight(){return this.shouldShowGeoToolbar()?48:0}isNarrowGeometryHeader(){return this.computeMajorLayout().grapher.width<450}shouldShowMultiSelectHeader(){return this.getSelectedGeoExpression()||this.hasMultipleItemsSelected()}getGrapherHeight(){return this.layoutMeasurements.height-this.getGeoToolbarHeight()}computeMajorLayout(){let e=this.layoutMeasurements.width,t=this.layoutMeasurements.height,r=this.isNarrow(),n=this.isListVisible(),i=this.isKeypadOpen(),o=!this.isGrapherEnabled(),a=!this.isListEnabled(),s=!!this.getGraphSettings().config.projectorMode,l={left:0,top:0,width:0,height:0},c={left:0,top:0,width:0,height:0,paddingTop:0},d={left:0,top:t,width:e,height:s?r?185:193:169};a?(c.width=e,c.height=t):o?(l.width=e,l.height=t):n?r?(l.width=e,l.height=Math.round(.58*t),l.top=t-l.height,c.width=e,c.height=t-l.height):(l.width=this.getExpListWidth(),l.height=t,c.left=l.width,c.width=e-c.left,c.height=t):n||(r?(l.width=e,l.height=Math.round(.58*t),l.top=t,c.width=e,c.height=t):(l.width=this.getExpListWidth(),l.height=t,l.left=-l.width,c.width=e,c.height=t)),i&&(d.top-=d.height,a||(l.height-=d.height));let u=this.getGeoToolbarHeight();return u&&(c.top+=u,c.height-=u),{list:l,grapher:c,keypad:d}}isNarrow(){return this.isGeometry()?this.layoutMeasurements.width<600:this.layoutMeasurements.width<450}getLayoutMeasurements(){return this.layoutMeasurements}getCapExpressionSize(){return!!this.getGraphSettings().config.capExpressionSize}handleAudioTraceCommand(e){let t=this.getAudioGraph();if(t===void 0)return;let r=t.agNavigator;switch(e){case"on":this.runAfterDispatch(()=>{t.enterAudioTrace({fromKeypad:!0})});break;case"off":this.runAfterDispatch(()=>{t.exitAudioTrace()});break;case"hear-graph":t.hearGraph();break;case"stop-graph":t.stopGraph();break;case"volume-down":t.adjustVolume("down");break;case"volume-up":t.adjustVolume("up");break;case"speed-down":t.speedDown();break;case"speed-up":t.speedUp();break;case"previous-point":this.runAfterDispatch(()=>{t.reportAndMoveToPrevPoint()});break;case"next-point":this.runAfterDispatch(()=>{t.reportAndMoveToNextPoint()});break;case"previous-poi":this.runAfterDispatch(()=>{t.reportAndMoveToPrevPOI()});break;case"next-poi":this.runAfterDispatch(()=>{t.reportAndMoveToNextPOI()});break;case"previous-curve":this.runAfterDispatch(()=>{r.prevCurve()});break;case"next-curve":this.runAfterDispatch(()=>{r.nextCurve()});break;case"describe-point":t.describePoint();break;case"describe-curve":t.describeCurve();break;case"describe-axes":t.describeAxes();break;case"keyboard-shortcuts":this.enqueueEvent("showHotkeysModal",{type:"keypad/audio-trace",command:e});break;default:return e}}setAudioTraceSpeed(e){let t=this.getAudioGraph();t&&t.adjustPlaybackSpeed(e)}setGraphPaperFocus(e){var t;qr(this,e.isFocused?{type:"graph-paper"}:void 0),(t=this.get2dPOIController())==null||t.keyboardAttentionManager.setKeyboardAttention(void 0),this.requestRedrawGraph(),e.isFocused&&this.isGeoToolActive()&&this.runAfterDispatch(()=>{var r;(r=this.get2dPOIController())==null||r.keyboardAttentionManager.handleGrapherGainedFocus()})}isGraphPaperFocused(){let e=this.getFocusLocation();return e?!!(e.type==="graph-paper"||e.type==="expression"&&e.isFakeGraphFocus):!1}isVirtualMouseAllowed(){return!(!this.isGeometry()||!this.isGraphPaperFocused()||!this.geoModel.getCurrentTool().canNextInputBePoint())}isClickableId(e){return nb(this.getItemModel(e))}setCanShowKeyboardShortcuts(e){this.canShowKeyboardShortcuts=e}getCanShowKeyboardShortcuts(){return this.canShowKeyboardShortcuts}apply3dProps(e){if(!this.isThreeDMode()||!this.grapher3d)return;let t=this.grapher3d.webglLayer;for(let r in e)switch(r){case"showPlane3D":t.showPlane(this.showPlane3D());break;case"showBox3D":t.showBox(!!e[r]);break;case"showAxis3D":t.showAxes(!!e[r]),t.showPlane(this.showPlane3D());break;case"showAxisLabels3D":t.updateAxes();break}}getGeometryTokenCount(){if(!this.cachedGeoTokenDepths)return 0;let e=0;return __dcg_shared_module_exports__.h(__dcg_shared_module_exports__.C(this.cachedGeoTokenDepths),t=>e+=t?t.length:0),e}getAllGeometryConstructionIds(){return V4(this.listModel,__dcg_shared_module_exports__.xd)}makeGeoAPI(){this.geoModel=new l1(this)}getGeoTokenInfoFromIdentifier(e){if(e)return this.cachedGeoTokenInfo[e]}getGhostMode(){return this.getGraphSettings().config.getProperty("ghostMode")}getshowKeyboardShortcutsInTooltips(){return!!this.getGraphSettings().config.showKeyboardShortcutsInTooltips}isDispatching(){return this.dispatcher.isDispatching()}getSuggestedIdentifierRenameInfo(e){return this.listModel.renamePrompt.suggestionForId(e)}getMathquillConfig(e){let t=e.additionalOperators||[];return this.toneAllowed()&&t.push("tone"),ie(R({},Vf({additionalOperators:t,includeGeometryFunctions:this.isGeometry(),include3DFunctions:this.is3dProduct()})),{autoCommands:Pu({additionalCommands:this.isGeometry()?[]:["int"],disallowAns:this.isGeometry()})})}constrainMultiSelect(){if(this.isMultiSelectEnabled())return;let e=FE(this.listModel);e.length>1&&Nr(this.listModel,e[0])}focusFirstExpression(){if(!this.getGraphSettings().config.expressions)return;let e=eb(this.listModel);e&&bi(this,e.id,"end")}_updateToneAvailability(){let e=this.toneAllowed();e&&!this.toneController?this.toneController=new Nw(this):!e&&this.toneController&&(this.toneController=void 0)}toneItemsExist(){return this.toneEnabled()?this.getAllItemModels().some(e=>Is(e)):!1}toneAllowed(){return!!(this.graphSettings.config.audio&&this.graphSettings.config.tone)}toneEnabled(){return!!this.toneController}isAdaptivePeelingSettled(){let e=this.adaptiveDepthPeelingInfo;return(e==null?void 0:e.status)===2||(e==null?void 0:e.status)===1&&(e==null?void 0:e.peelLayers)>=zy}setAdaptiveDepthPeelingInfo(e){let t=this.adaptiveDepthPeelingInfo;this.adaptiveDepthPeelingInfo=e,this.isAdaptivePeelingSettled()||this.requestRedrawGraph(),(t==null?void 0:t.peelLayers)!==e.peelLayers&&this.dispatch({type:"render"})}getAdaptiveDepthPeelingInfo(){return this.adaptiveDepthPeelingInfo}handleEvaluatorProgressUpdates(){this.checkSlowAnalysis=!0,this.requestedEvaluatorRestart=!1}clearSlowEvaluatorTracking(){this.expressionActionsToRestartIfSlow=[],this.checkSlowAnalysis=!1,this.requestedEvaluatorRestart=!1}handlePossiblySlowEvaluator(){if(!this.isEvaluatorSlow())return!1;let e=!1;return this.expressionActionsToRestartIfSlow.some(({action:t,id:r})=>this.shouldRestartForAction(t,r))?(this.requestEvaluatorRestart(),e=!0):this.checkSlowAnalysis&&(e=!0,this.checkSlowAnalysis=!1),e}shouldRestartForAction(e,t){switch(e){case"edit":case"remove":return this.isActivelyComputing(t);case"hide":return this.getEvaluatorStateForItem(t)==="GRAPHING";default:return e}}isEvaluatorSlow(){return!this.requestedEvaluatorRestart&&this.evaluator.isCurrentlySlow()}requestEvaluatorRestart(){this.evaluator.requestRestartWorker(),this.clearSlowEvaluatorTracking(),this.requestedEvaluatorRestart=!0}shouldShowProgressUpdateLegend(){return this.getGraphSettings().config.debugProgressUpdates&&!this.progressUpdateLegendHidden}isItemSlowInEvaluator(e){return this.isActivelyComputing(e)&&this.isEvaluatorSlow()}isActivelyComputing(e){return d$(this.getEvaluatorStateForItem(e))}trackActionForPotentialEvaluatorRestart(e,t){this.expressionActionsToRestartIfSlow.push({action:e,id:t})}shouldShowProgressUpdateColors(){return this.shouldShowProgressUpdateLegend()}shouldShowProgressUpdateIcons(){return this.getGraphSettings().config.debugProgressUpdates}isComplexModeEnabled(){return this.canEnableComplexMode()&&this.graphSettings.complex}canEnableComplexMode(){return this.graphSettings.config.allowComplex}shouldShowSliderPrompt(e){let t=Ep(e);return t.length>0&&t.length<=4?!0:this.areSlidersEnabled()?ab(e).length>0:!1}shouldShowRegressionButton(e){return this.is3dProduct()||!this.areTableRegressionsEnabled()||e.type!=="table"||e.regression||e.columnModels.length<2?!1:Cp(e.columnModels[0])&&Ru(e.columnModels[0])&&e.columnModels.slice(1).some(t=>Cp(t)&&Ru(t))}renameTableColumnsForGlobalExport(e,t){let r=this.getExportedVariables();for(let n of t){let i=Eo(e,n);if(!i)continue;let o=i.latex;if(!ya(o))continue;let a=__dcg_shared_module_exports__.na(o);if(r.isMultiplyDefined(a,{includeRegressionExports:!0})){let s=a.split("_")[0],l=r.getLastSubscriptForName(s,{includeRegressionExports:!0}),c=`${s}_{${l+1}}`;fd(this.listModel,o,c,{limitToItem:e.id}),r.optimisticallyRegisterColumnName(__dcg_shared_module_exports__.na(c))}}}exportTableRegression(e,t){var r,n;let i=this.getItemModel(t);if((i==null?void 0:i.type)!=="table")return;let o=i.regression;if(!o)return;let a="";if(e==="regression"){this.renameTableColumnsForGlobalExport(i,[o.columnIds.x,o.columnIds.y]);let c=kz(i);if(!c)return;a=__dcg_shared_module_exports__.me(o.type,{operator:"~",variables:c});let d=__dcg_shared_module_exports__.oe(a),u=oL(this.listModel),p;d.some(g=>u.isDefined(g,{includeRegressionExports:!1}))&&(p=1+Math.max(...d.map(g=>u.getLastSubscriptForName(g,{includeRegressionExports:!1})))),a=a.replace(__dcg_shared_module_exports__.ne,(g,f)=>p!==void 0?`${f}_{${p}}`:f)}else{let c=((n=(r=i.formula)==null?void 0:r.table_regression)==null?void 0:n.status)==="success"?i.formula.table_regression.result:void 0;if(!c)return;a=__dcg_shared_module_exports__.me(o.type,{operator:"=",variables:["x","y"],parameterValues:yR(c)})}let s=this.createItemModel({type:"expression",id:this.generateId(),latex:Fe.normalizeLatex(a,this.getMathquillConfig({})),color:this.getNextColor(),hidden:!1}),l=1+i.index;_s(this.listModel,s,l),this.setEditListMode(!1),bi(this,s.id)}getExportedVariables(){return oL(this.listModel)}};function yR(e){let t={};for(let[r,n]of Object.entries(e.parameters)){let i=bP(n),o=Math.max(i,e.displayPrecision);t[r]=parseFloat(n.toPrecision(o))}return t}function nj(e){return e&&ie(R({},e),{wasCompleteSetState:void 0,layoutModel:void 0,settingsViewModel:void 0})}function tpe(e,t){return __dcg_shared_module_exports__.E(nj(e),nj(t))}var{SwitchUnion:rpe,If:oA,IfDefined:xR,IfElse:ope}=je.Components,iA=class extends je.Class{init(){this.model=this.props.table(),this.controller=this.props.controller(),this.dropdownOpen=!1}customRegressionsEnabled(){return this.controller.getGraphSettings().config.customRegressions}template(){return xR(()=>this.getRegression(),e=>je.createElement("div",{class:()=>({"dcg-table-regression":!0,"dcg-do-not-blur":!0}),handleEvent:je.const("true"),onKeyDown:this.bindFn(this.handleKeyDown)},je.createElement("div",{class:()=>({"dcg-dropdown-row":!0,"dcg-dropdown-row__has-column-picker":this.shouldShowColumnDropdown()})},je.createElement("div",{class:je.const("dcg-dropdown-row__plot-and-model")},je.createElement("div",{class:je.const("dcg-icon-container")},rpe("status",()=>e().evaluated)({error:t=>je.createElement(Di,{instant:this.const(!0),error:()=>this.controller.unpack(t().error)}),success:()=>je.createElement("div",{class:je.const("dcg-circular-icon-container"),role:je.const("button"),tabIndex:je.const("0"),"dcg-open-menu-guid":()=>this.getGuid(),"aria-label":this.bindFn(this.getIconAriaLabel),onTap:t=>{if(!t.wasLongheld()){if(t.shiftKey||this.optionsOpen()||this.controller.isInEditListMode())return this.toggleOptions();this.setHidden(!e().spec.hidden)}},onLongHold:t=>{t.handle("dcg-longhold"),t.handle("dcg-tap"),this.toggleOptions()},manageFocus:this.const(rt({controller:this.controller,location:{type:"table-regression-icon",id:this.model.id}}))},je.createElement($o,{iconType:()=>e().spec.hidden?"hidden":"graph-default",backgroundColor:()=>{var t;return{type:"single-color",value:(t=e().spec.color)!=null?t:""}},whiteIcon:this.const(!1),foregroundColor:this.const(""),iconModifier:this.const("none"),backgroundOpacity:this.const(1)}))})),je.createElement(V0,{id:()=>`regression-model-${this.model.id}`,controller:()=>this.controller,options:()=>this.getModelOptions(),onOpenChange:this.bindFn(this.onDropdownOpenChange),externalControl:this.const({getValue:()=>this.getRegressionType(),onValueChange:t=>{this.controller.dispatch({type:"update-table-regression",tableId:this.model.id,update:{type:t}})}}),manageFocus:this.const(rt({controller:this.controller,location:{type:"table-regression-type-dropdown",id:this.model.id}})),buildFooter:()=>this.customRegressionsEnabled()?je.createElement("div",{class:je.const("dcg-table-regression-view__custom-model-notice")},je.createElement(Oi,{i18n:this.const(this.controller),key:this.const("graphing-calculator-text-make-custom-regression")},je.const("Make a custom regression model in a new line using"),je.const(" "),je.createElement("span",{class:je.const("dcg-tilde")},je.const("~")),je.const("."),je.const(" "),je.createElement("a",{class:je.const("dcg-blue-link"),href:je.const("https://help.desmos.com/hc/en-us/articles/4406972958733-Regressions"),target:je.const("_blank")},je.const("Learn how")),je.const("."))):[]})),je.createElement("div",{class:je.const("dcg-dropdown-row__breakable")},je.createElement(oA,{predicate:()=>this.shouldShowColumnDropdown()},()=>je.createElement("div",{class:je.const("dcg-table-regression__dropdown-separator")},()=>this.controller.s("shared-calculator-label-for"))),je.createElement(oA,{predicate:()=>this.shouldShowColumnDropdown()},()=>je.createElement("div",{class:je.const("dcg-dropdown-row__column-selector")},je.createElement(V0,{id:()=>`regression-data-${this.model.id}`,controller:()=>this.controller,options:()=>this.getColumnOptions(),onOpenChange:this.bindFn(this.onDropdownOpenChange),externalControl:this.const({getValue:()=>`id-${e().spec.columnIds.y}`,onValueChange:t=>{this.controller.dispatch({type:"update-table-regression",tableId:this.model.id,update:{columnIds:{x:e().spec.columnIds.x,y:t.substring(3)}}})}})}))),ope(this.bindFn(this.customRegressionsEnabled),{true:()=>je.createElement(P0,{anchor:()=>je.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-text-view-regression-options")},je.createElement(by,null)),anchorAriaLabel:()=>this.controller.s("graphing-calculator-text-view-regression-options"),controlled:()=>({isOpen:this.dropdownOpen,setDropdownOpen:this.bindFn(this.setDropdownOpen)}),guid:()=>`view-source-regression-${this.model.id}`,dropdownProps:this.const({position:this.const("bottom-left")}),dropdownOffset:()=>-15,manageFocus:this.const({itemNavigationKey:"tab"})},je.createElement("div",{class:je.const("dcg-generic-options-menu")},je.createElement("div",{class:je.const("dcg-options-menu-section")},je.createElement("div",{class:je.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-table-regression-model-structure")),je.createElement("div",{class:je.const("dcg-regression-model")},je.createElement(pl,{controller:this.props.controller,latex:this.bindFn(this.buildLatexForRegressionModel),ariaLabel:()=>this.controller.s("graphing-calculator-heading-table-regression-model-structure"),focusLocation:this.const({type:"regression-output",id:this.model.id,parameter:"model"}),tabbable:this.const(!1)})),xR(()=>this.getExportErrorReason(),t=>je.createElement("div",{class:je.const("dcg-regression-popover__unexportable-warning dcg-text-selectable")},je.createElement(es,{content:()=>this.controller.unpack(t()),mqConfig:()=>this.controller.getMathquillConfig({})})))),je.createElement("div",{class:je.const("dcg-options-menu-section")},je.createElement(oA,{predicate:()=>!this.getExportErrorReason()},()=>je.createElement("button",{class:je.const("dcg-btn-light-gray dcg-regression-popover__export-to-list"),onTap:()=>this.copyToExpressionList("regression")},()=>this.controller.s("graphing-calculator-button-copy-table-regression-model-to-expression-list"))),je.createElement("button",{class:je.const("dcg-btn-red dcg-regression-popover__delete"),onTap:()=>{this.setDropdownOpen(!1),this.controller.dispatch({type:"remove-table-regression",tableId:this.model.id})},manageFocus:this.const(rt({controller:this.controller,location:{type:"table-regression-delete-btn",id:this.model.id}}))},()=>this.controller.s("graphing-calculator-button-delete-table-regression"))))),false:()=>je.createElement("i",{class:je.const("dcg-icon-remove"),role:je.const("button"),tabIndex:je.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-button-delete-table-regression"),onTap:()=>this.controller.dispatch({type:"remove-table-regression",tableId:this.model.id}),manageFocus:this.const(rt({controller:this.controller,location:{type:"table-regression-delete-btn",id:this.model.id}}))})}))),je.createElement(oA,{predicate:()=>e().evaluated.status==="success"},()=>je.createElement("div",null,je.createElement("div",{class:je.const("dcg-expression-footer-title dcg-expression-footer-title__equation")},()=>this.controller.s("graphing-calculator-heading-regression-equation"),je.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-text-export-snapshot")},je.createElement("button",{class:je.const("dcg-unstyled-button dcg-copy-regression-button"),onTap:()=>this.copyToExpressionList("equation"),"aria-label":()=>this.controller.s("graphing-calculator-text-export-snapshot")},je.createElement("i",{class:je.const("dcg-icon-insert"),"aria-hidden":je.const("true")})))),je.createElement("div",{class:je.const("dcg-regression-equation dcg-do-not-blur"),onTap:this.bindFn(this.ensureTableSelected),didMount:this.bindFn(this.didMountRegressionEquation),didUnmount:this.bindFn(this.didUnmountRegressionEquation)},je.createElement(pl,{controller:this.props.controller,latex:this.bindFn(this.buildLatexForRegressionEquation),ariaLabel:()=>this.controller.s("graphing-calculator-narration-table-regression-equation"),focusLocation:this.const({type:"regression-output",id:this.model.id,parameter:"equation"}),tabbable:this.const(!0)})),xR(()=>this.getRegressionDetails(),t=>je.createElement(Xb,{controller:()=>this.controller,model:()=>this.model,hideParameters:this.const(!0),regression:t,suppressRMSE:this.const(!0),suppressLogModeCheckbox:()=>!__dcg_shared_module_exports__.le(this.getRegressionType()),showRValue:()=>this.getRegressionType()==="linear"?"always":"never"}))))))}getExportErrorReason(){let e=this.getRegression();if(e){if(e.evaluated.status==="error")return e.evaluated.error;if(e.evaluated.export_info.status==="unexportable")return e.evaluated.export_info.reason}}buildLatexForRegressionEquation(){let e=this.getRegression();return!e||e.evaluated.status!=="success"?"":__dcg_shared_module_exports__.me(e.spec.type,{operator:"=",variables:["x","y"],parameterValues:yR(e.evaluated.result)})}buildLatexForRegressionModel(){let e=this.getRegression();return!e||e.evaluated.status!=="success"?"":__dcg_shared_module_exports__.me(e.spec.type,{operator:"~",variables:["x","y"],parameterValues:"canonical"})}didMountRegressionEquation(e){this.regEqNode=e}didUnmountRegressionEquation(){this.cachedRegEqLatex="",this.regEqNode=void 0}addLineBreaks(){if(!this.regEqNode)return;let e=this.buildLatexForRegressionEquation();e!==this.cachedRegEqLatex&&(this.cachedRegEqLatex=e,this.regEqNode.querySelectorAll(".dcg-mq-binary-operator").forEach(t=>{var r,n;t.textContent!=="+"&&t.textContent!=="−"||(n=(r=t.parentNode)==null?void 0:r.classList)!=null&&n.contains("dcg-mq-root-block")&&t.classList.add("dcg-break-before")}))}didUpdate(){this.addLineBreaks()}onDropdownOpenChange(e){e&&this.controller.scrollItemIntoView(this.model)}getRegressionType(){var e,t;return(t=(e=this.getRegression())==null?void 0:e.spec.type)!=null?t:"linear"}ensureTableSelected(){let e=this.model.id;this.controller.isItemSelected(e)||this.controller.dispatch({type:"set-selected-id",id:e,state:"selected"})}getRegressionDetails(){var e,t;if(((t=(e=this.model.formula)==null?void 0:e.table_regression)==null?void 0:t.status)==="success")return this.model.formula.table_regression.result}hasAnyNonPositiveXValues(){let e=this.model.regression;if(!e)return!1;let t=Eo(this.model,e.columnIds.x);return __dcg_shared_module_exports__.k((t==null?void 0:t.computedValues)||[],r=>parseFloat(r)<=0)}getRegression(){var e;if(!this.controller.areTableRegressionsEnabled())return;let t=this.model.regression,r=(e=this.model.formula)==null?void 0:e.table_regression;if(t){let n=Eo(this.model,t.columnIds.x),i=Eo(this.model,t.columnIds.y);!n||!i||n.hasNanOrErrorValue||i.hasNanOrErrorValue?r={status:"error",error:__dcg_shared_module_exports__.Jb().getError()}:t.type==="logarithmic"&&this.hasAnyNonPositiveXValues()&&(r={status:"error",error:__dcg_shared_module_exports__.Kb().getError()})}return t&&r?{spec:t,evaluated:r}:void 0}shouldShowColumnDropdown(){return this.getColumnOptions().length>1}getColumnOptions(){let e=new Set,t=this.model.regression;return t&&(e.add(t.columnIds.x),e.add(t.columnIds.y)),this.model.columnModels.slice(1).filter(r=>e.has(r.id)||Cp(r)).map(r=>({label:"`"+r.latex+"`",id:"id-"+r.id,disabled:!Ru(r)||!Cp(r)}))}setDropdownOpen(e){this.dropdownOpen=e,e&&this.controller.logEvent({category:"regressions",action:"view-regression-options",name:this.getRegressionType()}),this.update()}getModelOptions(){return[{id:"linear",label:this.controller.s("graphing-calculator-label-table-regression-type-linear")},{id:"quadratic",label:this.controller.s("graphing-calculator-label-table-regression-type-quadratic")},{id:"cubic",label:this.controller.s("graphing-calculator-label-table-regression-type-cubic")},{id:"quartic",label:this.controller.s("graphing-calculator-label-table-regression-type-quartic")},{id:"exponential",label:this.controller.s("graphing-calculator-label-table-regression-type-exponential")},{id:"logarithmic",label:this.controller.s("graphing-calculator-label-table-regression-type-logarithmic")},{id:"power",label:this.controller.s("graphing-calculator-label-table-regression-type-power")},{id:"logistic",label:this.controller.s("graphing-calculator-label-table-regression-type-logistic")},{id:"sinusoidal",label:this.controller.s("graphing-calculator-label-table-regression-type-sinusoidal")}]}copyToExpressionList(e){this.setDropdownOpen(!1),this.controller.dispatch({type:"export-table-regression",tableId:this.model.id,mode:e,regressionType:this.getRegressionType()})}getGuid(){return`table-regression-${this.model.guid}`}toggleOptions(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"table-regression",model:this.model,guid:this.getGuid(),focusFirstOption:!0}})}setHidden(e){this.controller.dispatch({type:"update-table-regression",tableId:this.model.id,update:{hidden:e}})}optionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getGuid())}getIconAriaLabel(){var e;return this.optionsOpen()?this.controller.s("graphing-calculator-narration-hide-options"):(e=this.model.regression)!=null&&e.hidden?this.controller.s("graphing-calculator-narration-show-table-regression"):this.controller.s("graphing-calculator-narration-hide-table-regression")}handleKeyDown(e){let t=Ko(e);if(!e.altKey&&e.ctrlKey&&!e.metaKey&&e.shiftKey&&t==="O"){if(e.preventDefault(),e.stopPropagation(),this.controller.getOpenItemMenu()!==void 0)return;this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"table-regression",model:this.model,guid:this.getGuid(),focusFirstOption:!0}})}}},bn=__dcg_shared_module_exports__.e(ne());qt();var{If:ipe,Switch:npe}=bn.Components,d1=class extends bn.Class{init(){this.column=this.props.column(),this.controller=this.props.controller(),this.table=this.column.table}template(){return bn.createElement("td",{class:()=>({"dcg-cell":!0,"dcg-do-not-blur":!0,"dcg-empty":this.isEmpty(),"dcg-non-editable":!!this.isDisabled(),"dcg-computed-cell":this.isComputed(),"dcg-error":!!this.hasError(),"dcg-selected":this.shouldFocus()&&!this.controller.isItemReadonly(this.table.id)}),onTapStart:this.bindFn(this.focusThisCell)},bn.createElement("div",{class:bn.const("dcg-inner-border")}),bn.createElement("div",null,bn.createElement(ipe,{predicate:this.bindFn(this.hasError)},()=>bn.createElement("span",{class:bn.const("dcg-table-icon-error-container")},bn.createElement(Di,{error:this.bindFn(this.getErrorMessage),size:this.const("small")}))),bn.createElement(npe,{key:this.bindFn(this.getType)},e=>{switch(e){case"editable":return bn.createElement(Mo,R({latex:()=>this.getValue(),operatorNames:()=>this.getMQConfig().autoOperatorNames,brailleShouldFocus:this.bindFn(this.shouldFocusEditableCell),ariaLabel:()=>this.getAriaLabel("braille"),onBrailleInput:t=>this.handleLatexChanged(t),onBrailleFocusedChanged:this.bindFn(this.handleFocusedChanged),onBrailleKeydown:this.bindFn(this.handleKeydownOnBrailleInput),selectOnFocus:this.const(!0)},ui(this.props.controller())),bn.createElement(Fe,{latex:()=>this.getValue(),isFocused:()=>this.shouldFocusEditableCell()&&!this.isBraille(),capExpressionSize:()=>this.controller.getCapExpressionSize(),tokenController:this.props.controller,noFadeout:this.const(!0),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech"),getAriaPostLabel:this.bindFn(this.getErrorMessage),hasError:this.const(!1),onUserPressedKey:(t,r)=>this.handlePressedKey(t,r),onUserChangedLatex:t=>this.handleLatexChanged(t),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:this.bindFn(this.handleFocusedChanged),selectOnFocus:this.const(!0),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}));case"tabbable":case"untabbable":return bn.createElement(pl,{controller:()=>this.controller,latex:this.bindFn(this.getValue),ariaLabel:()=>this.getAriaLabel("speech"),brailleAriaLabel:()=>this.getAriaLabel("braille"),onKeypress:t=>(this.handleKeydownOnReadonlyCell(t),!0),tabbable:()=>e==="tabbable",focusLocation:this.const({type:"table",id:this.table.id,location:this.lookupCellPosition()})})}})),bn.createElement("div",{class:bn.const("dcg-empty-line")}))}getType(){return this.controller.isInEditListMode()||this.column===this.table.columnModels[this.table.columnModels.length-1]?"untabbable":this.isColumnEditable()?"editable":"tabbable"}isBraille(){return this.controller.getBrailleMode()!=="none"}isDisabled(){return Uf(this.column)}isComputed(){return Ez(this.column)}focusThisCell(e){e.wasHandled()||this.controller.isItemReadonly(this.table.id)||(e.handle(),!this.shouldFocus()&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}))}handlePressedKey(e,t){let r=Fe.getFocusedMathquill();if(r){let n=Fe.handleKeystrokeAndDecideIfSpecialEvent(r,e,t);e===kn&&(Jr(),t==null||t.preventDefault()),n?(this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:e}),t==null||t.preventDefault()):this.handleLatexChanged(r.latex())}}handleKeydownOnBrailleInput(e){let t=ke(e);if(!t)return;t===kn&&Jr();let r=t==="Enter"||t==="Up"||t==="Down",n=os(),i=n&&t==="Left"&&n.selectionStart===0||t==="Right"&&n.selectionStart===n.value.length;(r||i||(t==="Del"||t==="Backspace")&&this.getValue().length===0)&&(this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:t==="Del"?"Delete":t}),e.preventDefault())}handleKeydownOnReadonlyCell(e){let t=ke(e);switch(t){case"Up":case"Down":case"Left":case"Right":case"Backspace":case"Del":case"Enter":return this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:t}),!0;case"Esc":return Jr(),!0}return!1}handleLatexChanged(e){this.getValue()!==e&&this.controller.dispatch({type:"set-tablecell-latex",tableId:this.table.id,cell:this.lookupCellPosition(),latex:e})}shouldFocus(){return __dcg_shared_module_exports__.E(this.lookupCellPosition(),wa(this.table))}shouldFocusReadonlyCell(){return!this.controller.isInEditListMode()&&(this.controller.isItemReadonly(this.table.id)||!!this.isDisabled())&&this.shouldFocus()}shouldFocusEditableCell(){return!this.isDisabled()&&this.shouldFocus()}isNodeWithinTableCell(e){if(!e||!e.closest(".dcg-cell"))return!1;let t=this.controller.getItemRootNodeById(this.table.id);return t?ee.contains(t,e):!1}handleFocusedChanged(e,t){e?this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}):this.isNodeWithinTableCell(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})}lookupCellPosition(){return{row:this.props.rowIdx(),column:this.column.index}}getPackedError(){return this.column.packedErrors[this.props.rowIdx()-1]}hasError(){return!!this.getPackedError()}getErrorMessage(){let e=this.getPackedError();return e?this.controller.unpack(e):""}getValue(){let e=this.props.rowIdx()-1,t=this.column.index;return dE(this.table,e,t)}isEmpty(){let e=os();return this.getValue()===""&&Wb(e)}getAriaLabel(e){if(e==="speech"&&this.isComputed())return this.controller.s("graphing-calculator-narration-computed-cell-role-description");if(e==="braille"){let t=this.lookupCellPosition(),r=t.row,n=t.column+1;return this.controller.raw("r__row__c__column__",{row:r.toString(),column:n.toString()})}return" "}isColumnEditable(){return!this.isDisabled()&&!this.controller.isItemReadonly(this.table.id)&&!this.controller.isInEditListMode()}getMQConfig(){return this.controller.getMathquillConfig({})}},so=__dcg_shared_module_exports__.e(ne());qt();var yn=__dcg_shared_module_exports__.e(ne()),{SwitchUnion:ape,If:spe}=yn.Components,p1=class extends yn.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return yn.createElement("div",{class:yn.const("dcg-table-icon-container")},ape(this.bindFn(this.typeOfIcon),{error:()=>yn.createElement(Di,{error:()=>this.controller.unpack(this.model.error)}),none:()=>yn.createElement("span",null),icon:()=>yn.createElement("div",{"aria-hidden":()=>!this.shouldIconBeFocused(),class:yn.const("dcg-circular-icon-container"),role:yn.const("button"),tabIndex:yn.const("0"),"aria-label":this.bindFn(this.getIconAriaLabel),handleEvent:yn.const("true"),"dcg-open-menu-guid":()=>this.getMenuGUID(),onTap:e=>{if(!e.wasHandled("dragdrop")&&!e.wasLongheld()){if(this.myOptionsOpen())return this.toggleOptions();if(this.controller.isInEditListMode()||e.shiftKey)return this.toggleOptions();this.toggleGraphShown()}},onLongHold:e=>{e.handle("dcg-longhold"),e.handle("dcg-tap"),this.toggleOptions()},manageFocus:this.const(rt({controller:this.controller,location:{type:"table-icon",id:this.model.table.id,columnId:this.model.id}}))},yn.createElement($o,{iconType:this.bindFn(this.getIcon),backgroundColor:this.bindFn(this.getModelColor)}),yn.createElement(spe,{predicate:()=>this.model.disableGraphInteractions},()=>yn.createElement("i",{class:yn.const("dcg-graph-interaction-disabled dcg-icon-lock"),"aria-hidden":yn.const("true")})))}))}getModelColor(){return xw(this.model)}getMenuGUID(){return this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"table-column",model:this.model,guid:this.getMenuGUID(),focusFirstOption:!1}})}toggleGraphShown(){this.controller.dispatch({type:"toggle-tablecolumn-hidden",tableId:this.model.table.id,columnId:this.model.id})}hasError(){return!!this.model.error}getIcon(){return this.model.shouldGraph?this.controller.isInEditListMode()?"none":this.model.points&&this.model.lines?"table-points-and-lines":this.model.points&&!this.model.lines?"table-points":!this.model.points&&this.model.lines?"table-lines":"none":"hidden"}typeOfIcon(){return this.model.latex===""||!this.controller.getGraphSettings().config.graphpaper?"none":this.model.error?"error":this.model.suppressIcon||this.model.index===0?"none":"icon"}getIconAriaLabel(){return this.myOptionsOpen()?this.controller.s("graphing-calculator-narration-hide-options"):this.controller.isInEditListMode()?this.controller.s("graphing-calculator-narration-show-options"):this.model.shouldGraph?this.controller.s("graphing-calculator-narration-hide-table-column"):this.controller.s("graphing-calculator-narration-show-table-column")}shouldIconBeFocused(){let e=this.controller.getFocusLocation();return __dcg_shared_module_exports__.E(e,{type:"table-icon",id:this.model.table.id,columnId:this.model.id})}},{If:u1}=so.Components,h1=class extends so.Class{init(){this.model=this.props.model(),this.controller=this.props.controller(),this.table=this.model.table}isRightSide(){return this.lookupCellPosition().column>=this.table.columnModels.length-1}template(){return so.createElement("th",{class:()=>({"dcg-cell":!0,"dcg-table-header":!0,"dcg-do-not-blur":!0,"dcg-left":this.model.index===0,"dcg-right":this.isRightSide(),"dcg-selected":this.shouldFocus()&&!this.table.readonly,"dcg-error":!!this.model.error&&!!this.model.latex,"dcg-leave-space-for-icon":this.leaveSpaceForIcon(),"dcg-leave-space-for-drag-icon":this.hasDragIcon(),"dcg-could-have-icon":!this.controller.is3dProduct()&&!this.isRightSide()&&this.model.index>0}),index:()=>this.model.index,onTapStart:this.bindFn(this.focusThisCell)},so.createElement("div",{class:so.const("dcg-inner-border")}),so.createElement(u1,{predicate:()=>!this.isRightSide()&&(!this.controller.is3dProduct()||!!this.model.error)},()=>so.createElement(p1,{model:this.props.model,controller:this.props.controller})),so.createElement("div",null,so.createElement(u1,{predicate:()=>!this.controller.isInEditListMode()&&!this.controller.isItemReadonly(this.table.id)},()=>so.createElement(Mo,R({latex:()=>this.model.latex||"",operatorNames:()=>this.getMQConfig().autoOperatorNames,brailleShouldFocus:this.bindFn(this.shouldFocus),ariaLabel:()=>this.getAriaLabel("braille"),onBrailleInput:e=>this.handleLatexChanged(e),onBrailleFocusedChanged:this.bindFn(this.handleMQFocusedChanged),selectOnFocus:this.const(!0),onBrailleKeydown:this.bindFn(this.handleKeydownOnBrailleInput)},ui(this.props.controller())),so.createElement(Fe,{latex:()=>this.model.latex||"",isFocused:()=>this.shouldFocus()&&this.controller.getBrailleMode()==="none",capExpressionSize:()=>this.controller.getCapExpressionSize(),tokenController:this.props.controller,noFadeout:this.const(!0),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech"),getAriaPostLabel:this.bindFn(this.getAriaPostLabel),hasError:this.const(!1),onUserPressedKey:(e,t)=>this.handlePressedKey(e,t),onUserChangedLatex:e=>this.handleLatexChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:this.bindFn(this.handleMQFocusedChanged),selectOnFocus:this.const(!0),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))),so.createElement(u1,{predicate:()=>this.controller.isInEditListMode()||this.controller.isItemReadonly(this.table.id)},()=>so.createElement(Mo,R({latex:()=>this.model.latex||"",operatorNames:()=>this.getMQConfig().autoOperatorNames,ariaLabel:()=>this.getAriaLabel("braille"),onBrailleInput:e=>this.handleLatexChanged(e),tabIndex:this.const(-1),isStatic:this.const(!0),brailleShouldFocus:this.bindFn(this.shouldFocusReadonlyCell),onBrailleFocusedChanged:this.bindFn(this.handleMQFocusedChanged)},ui(this.props.controller())),so.createElement(nt,{latex:()=>this.model.latex||"",config:this.bindFn(this.getMQConfig),tokenController:this.props.controller,getAriaLabel:()=>this.getAriaLabel("speech")},so.createElement("span",{class:so.const("dcg-math-field dcg-cell-math-content"),role:so.const("textbox"),"aria-readonly":so.const("true"),tabIndex:()=>this.controller.isInEditListMode()?-1:0,onKeyDown:this.bindFn(this.handleKeydownOnReadonlyCell),manageFocus:this.const({shouldBeFocused:()=>this.shouldFocusReadonlyCell()&&this.controller.getBrailleMode()==="none",onFocusedChanged:this.bindFn(this.handleFocusedChanged)})})))),so.createElement(u1,{predicate:this.bindFn(this.hasDragIcon)},()=>so.createElement("span",{class:so.const("dcg-drag-icon"),"dcg-drag-mode":()=>this.model.dragMode,style:()=>({color:this.model.color})},so.createElement("i",{class:()=>({"dcg-icon-move":this.model.dragMode==="XY","dcg-icon-move-horizontal":this.model.dragMode==="X","dcg-icon-move-vertical":this.model.dragMode==="Y"}),"aria-hidden":so.const("true")})))),so.createElement("div",{class:so.const("dcg-empty-line")}),so.createElement(u1,{predicate:()=>this.isRightSide()},()=>so.createElement("span",{class:so.const("dcg-fade-right")})))}hasDragIcon(){return this.model.dragMode!=="NONE"&&!this.model.error}leaveSpaceForIcon(){if(this.model.error||this.controller.is3dProduct()||this.model.suppressIcon)return!1;let{column:e}=this.lookupCellPosition(),t=gw(this.table);return e>0&&e<t-1}focusThisCell(e){e.wasHandled()||(e.handle(),!this.controller.isItemReadonly(this.table.id)&&(this.shouldFocus()||this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})))}handleFocusedChanged(e,t){e?this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}):this.isNodeWithinTableCell(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})}lookupCellPosition(){return{row:0,column:this.model.index}}getAriaLabel(e){let t=this.lookupCellPosition();return e==="speech"?" ":this.controller.raw("h__column__",{column:t.column+1})}getAriaPostLabel(){let e="",t=this.model;return t.shouldGraph&&(t.points||t.lines)&&!Sz(t)&&(e=this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph"),Zo?e+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-mac"):e+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-windows")),e}handlePressedKey(e,t){let r=Fe.getFocusedMathquill();r&&(Fe.handleKeystrokeAndDecideIfSpecialEvent(r,e,t)?this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:e}):this.handleLatexChanged(r.latex()))}handleKeydownOnBrailleInput(e){let t=ke(e);if(!t)return;let r=t==="Enter"||t==="Up"||t==="Down",n=os(),i=n&&t==="Left"&&n.selectionStart===0||t==="Right"&&n.selectionStart===n.value.length,o=this.model.latex.length===0&&Wb(n);(r||i||(t==="Del"||t==="Backspace")&&o)&&(this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:t==="Del"?"Delete":t}),e.preventDefault())}handleKeydownOnReadonlyCell(e){let t=ke(e);t!=="Tab"&&(t==="Esc"&&Jr(),t&&this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:t}),e.preventDefault())}handleLatexChanged(e){this.model.latex!==e&&this.controller.dispatch({type:"set-tablecell-latex",tableId:this.table.id,cell:this.lookupCellPosition(),latex:e})}shouldFocus(){return!this.controller.isInEditListMode()&&__dcg_shared_module_exports__.E(this.lookupCellPosition(),wa(this.table))}shouldFocusReadonlyCell(){return __dcg_shared_module_exports__.E(this.lookupCellPosition(),wa(this.table))}isNodeWithinTableCell(e){if(!e||!e.closest(".dcg-cell"))return!1;let t=this.controller.getItemRootNodeById(this.table.id);return t?ee.contains(t,e):!1}handleMQFocusedChanged(e,t){e?this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}):this.isNodeWithinTableCell(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})}getMQConfig(){return this.controller.getMathquillConfig({})}},{For:wR}=rr.Components,g1=class extends is{didMountRoot(e){this.onItemViewMounted(e),this.didMountContainer(e)}willUnmount(){this.onItemViewUnmounted()}template(){return rr.createElement("div",{class:()=>({"dcg-expressionitem":!0,"dcg-expressiontable":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-inFolder":!!this.model.folderId,"dcg-selected":!!this.controller.isItemSelected(this.id),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-faded-h":this.shouldFadeLastColumn(),"dcg-faded-v":this.shouldFadeLastRow()}),"expr-id":()=>this.model.id,didMount:this.bindFn(this.didMountRoot),onKeyDown:this.bindFn(this.onKeydown)},rr.createElement("div",{class:rr.const("dcg-fade-container dcg-disable-horizontal-scroll-to-cursor")},rr.createElement("div",{class:rr.const("dcg-main")},rr.createElement("div",{class:rr.const("dcg-table-container"),tabIndex:()=>this.controller.isInEditListMode()?0:-1,"aria-label":()=>this.controller.getBrailleMode()==="none"?this.controller.s("graphing-calculator-narration-expression-index-table",{index:this.model.displayIndex}):this.controller.s("graphing-calculator-narration-expression-index-table",{index:this.model.displayIndex}),didMount:this.bindFn(this.didMountContainer),manageFocus:this.const({shouldBeFocused:this.shouldBeFocused.bind(this),onFocusedChanged:this.onFocusedChanged.bind(this)})},rr.createElement("div",{class:rr.const("dcg-table-sliding-container"),style:()=>({transform:`translateX(${this.computeScrolledX()}px)`})},rr.createElement("table",{class:rr.const("dcg-tabledata")},rr.createElement(wR,{each:()=>this.getVisibleRows(),key:e=>this.getRowGUID(e)},e=>e.type==="show-more"?rr.createElement("tr",{class:rr.const("dcg-show-more-row")},rr.createElement("td",{colSpan:this.bindFn(this.getColSpan)},this.bindFn(this.missingRowMessage),rr.createElement("button",{class:rr.const("dcg-show-more dcg-blue-link dcg-unstyled-button"),onTap:()=>this.controller.dispatch({type:"table-show-more-rows",id:this.id})},()=>this.controller.s("graphing-calculator-button-show-all-table-rows")))):e.type==="spacer-row"?rr.createElement("tr",{class:rr.const("dcg-blank-row")},rr.createElement("td",{colSpan:this.bindFn(this.getColSpan),style:()=>({height:(e.endIdx-e.startIdx+1)*this.getRowHeight()+"px"})})):e.type==="header"?rr.createElement("tr",{"aria-rowindex":rr.const("0"),class:()=>({"dcg-row":!!e,"dcg-braille-row":this.controller.getBrailleMode()!=="none"})},rr.createElement(wR,{each:()=>this.model.columnModels,key:t=>t.guid},t=>rr.createElement(h1,{controller:this.props.controller,model:this.const(t)}))):rr.createElement("tr",{"aria-rowindex":()=>e.index,class:()=>({"dcg-row":!!e,"dcg-braille-row":this.controller.getBrailleMode()!=="none"})},rr.createElement(wR,{each:()=>this.model.columnModels,key:t=>t.guid},t=>rr.createElement(d1,{controller:this.props.controller,column:this.const(t),rowIdx:()=>e.index}))))))),rr.createElement(iA,{controller:this.props.controller,table:this.props.model})),rr.createElement(Wl,{controller:this.props.controller,model:this.props.model})),rr.createElement("span",{class:rr.const("dcg-tab dcg-action-drag"),handleEvent:rr.const("true"),tapboundary:rr.const("true"),disablescroll:rr.const("true"),onTapStart:this.bindFn(this.onDragPending)},rr.createElement("span",{class:rr.const("dcg-num")},()=>this.model.displayIndex),rr.createElement("div",{class:rr.const("dcg-tab-interior")}),rr.createElement(qI,{model:this.props.model,controller:this.props.controller}),rr.createElement(Qb,{model:this.props.model,controller:this.props.controller})),rr.createElement(Hl,{controller:this.props.controller,id:()=>this.model.id}))}getRowGUID(e){switch(e.type){case"header":return"header";case"show-more":return"show-more";case"spacer-row":return`spacer-${e.startIdx}-${e.endIdx}`;case"standard-row":return`row-${e.index}`}}getColSpan(){return this.model.columnModels.length-1}getRowHeight(){return this.controller.getGraphSettings().config.projectorMode?38:33}getVisibleRows(){var e,t,r;let n=[{type:"header"}],i=Pl(this.model)+1;if(i<=25){for(let f=1;f<i;f++)n.push({type:"standard-row",index:f});return n}let o=Eg(this.model);if(o!==void 0){for(let f=1;f<o.min;f++)n.push({type:"standard-row",index:f});n.push({type:"show-more"});for(let f=o.max;f<i;f++)n.push({type:"standard-row",index:f});return n}let a=Tm(this.controller),s=a?a.height:0,l=ee(this.node).offset(),c=(l?l.top:0)-(a?a.top:0),d=(r=(t=(e=this.node)==null?void 0:e.querySelector(".dcg-row"))==null?void 0:t.getBoundingClientRect().height)!=null?r:0,u=this.getRowHeight();if(s/u>i){for(let f=1;f<i;f++)n.push({type:"standard-row",index:f});return n}let p=(-c-d)/u,g=(s-c)/u;for(let f=1;f<i;f++){let y=wa(this.model);if(f===i-2||y&&y.row===f)n.push({type:"standard-row",index:f});else if(f>g||f<p){let E=n[n.length-1];E&&E.type==="spacer-row"?E.endIdx=f:n.push({type:"spacer-row",startIdx:f,endIdx:f})}else n.push({type:"standard-row",index:f})}return n}missingRowMessage(){let e=Eg(this.model);return e===void 0?"":this.controller.s("graphing-calculator-text-table-more-rows",{rowCount:e.max-e.min})}didMountContainer(e){this.node=e,ee(e).on("scroll",()=>e.scrollLeft=0)}getSelectedCell(){return wa(this.model)}computeScrolledX(){if(!this.getSelectedCell()||!this.node)return 0;let e=this.node.children[0],t=this.node.querySelector(".dcg-selected");if(e===null||t===null)return 0;let r=this.node.getBoundingClientRect(),n=t.getBoundingClientRect(),i=n.left-e.getBoundingClientRect().left,o=r.width-i-n.width-80,a=Math.min(0,r.width-e.scrollWidth-30);return o=Math.max(o,a),Math.min(0,o)}shouldFadeLastRow(){return Dz(this.model)&&!this.isBottomFocused()}shouldFadeLastColumn(){return!this.isRightFocused()}isBottomFocused(){let e=this.getSelectedCell();return!!e&&e.row===Pl(this.model)}isRightFocused(){let e=this.getSelectedCell();return!!e&&e.column===this.model.columnModels.length-1}isReadonly(){return this.controller.isItemReadonly(this.id)}isFocused(){return!!this.getSelectedCell()}onKeydown(e){this.controller.isInEditListMode()||e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey&&(ke(e)==="Up"?(e.preventDefault(),e.stopPropagation(),this.moveToFirstCellInColumn()):ke(e)==="Down"?(e.preventDefault(),e.stopPropagation(),this.moveToLastCellInColumn()):ke(e)==="Left"?(e.preventDefault(),e.stopPropagation(),this.moveToFirstCellInRow()):ke(e)==="Right"?(e.preventDefault(),e.stopPropagation(),this.moveToLastCellInRow()):Ko(e)==="H"&&(e.preventDefault(),e.stopPropagation(),this.speakColumnHeader()))}moveToFirstCellInColumn(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:0,column:e.column}}})}moveToLastCellInColumn(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:Pl(this.model),column:e.column}}})}moveToFirstCellInRow(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:e.row,column:0}}})}moveToLastCellInRow(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:e.row,column:Pl(this.model)-1}}})}speakColumnHeader(){let e=this.controller.s("graphing-calculator-narration-table-no-column-header"),t=this.getSelectedCell();if(t){let r=this.model.columnModels[t.column].latex;r&&(e=gc.StaticMath(document.createElement("span")).latex(r).mathspeak())}xe(e)}focusHelperOptions(){return{controller:this.controller,location:{type:"table-container",id:this.model.id}}}shouldBeFocused(){return Bg(this.focusHelperOptions())}onFocusedChanged(e){if(this.controller.isInEditListMode())return aP(this.focusHelperOptions(),e)}},Bi=__dcg_shared_module_exports__.e(ne()),m1=class extends is{didMountRoot(e){this.onItemViewMounted(e)}willUnmount(){this.onItemViewUnmounted()}template(){return Bi.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-expressiontext":!0,"dcg-inFolder":!!this.model.folderId,"dcg-selected":!!this.controller.isItemSelected(this.id),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id)}),"expr-id":()=>this.model.id,onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect),didMount:this.bindFn(this.didMountRoot)},Bi.createElement("div",{class:Bi.const("dcg-fade-container")},Bi.createElement("div",{class:Bi.const("dcg-main")},Bi.createElement(au,{shouldFocus:this.bindFn(this.isFocused),text:()=>this.model.text,showLinks:()=>this.controller.areLinksEnabled(),onInput:this.bindFn(this.onInput),onFocusChange:this.bindFn(this.onFocusChange),onSpecialKey:this.bindFn(this.onSpecialKey),readonly:()=>this.controller.isInEditListMode()||this.controller.isItemReadonly(this.id),readonlyAction:this.const({predicate:()=>this.controller.isInEditListMode(),action:()=>this.exitEditListMode()}),ariaLabel:()=>Xr(this.model,"edit_title"),placeholder:()=>this.controller.s("graphing-calculator-text-note-placeholder")})),Bi.createElement(Wl,{controller:this.props.controller,model:this.props.model})),Bi.createElement("span",{class:Bi.const("dcg-tab dcg-action-drag"),handleEvent:Bi.const("true"),tapboundary:Bi.const("true"),disablescroll:Bi.const("true"),onTapStart:this.bindFn(this.onDragPending)},Bi.createElement("span",{class:Bi.const("dcg-num")},()=>this.model.displayIndex),Bi.createElement("div",{class:Bi.const("dcg-tab-interior")}),Bi.createElement("i",{class:Bi.const("dcg-icon-text"),"aria-hidden":Bi.const("true")})),Bi.createElement(Hl,{controller:this.props.controller,id:()=>this.model.id}))}onInput(e){this.controller.dispatch({type:"set-note-text",id:this.id,text:e})}onFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"text",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"text",id:this.id}})}onSpecialKey(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})}isFocused(){let e=this.controller.getFocusLocation();return!(!e||e.type!=="text"||e.id!==this.id)}},Xt=__dcg_shared_module_exports__.e(ne()),{If:sj,IfDefined:lpe}=Xt.Components,nA=class extends Xt.Class{init(){this.controller=this.props.controller()}template(){return Xt.createElement("div",{class:()=>({"dcg-ticker":!0,"dcg-expressions-scrolled":this.props.expsScrolled()})},Xt.createElement("div",{class:Xt.const("dcg-ticker-settings-container")},Xt.createElement("div",{class:Xt.const("dcg-ticker-settings-internal")},Xt.createElement("div",{class:Xt.const("dcg-editable-mathquill-container dcg-action-definition")},Xt.createElement("span",{class:Xt.const("dcg-ticker-label")},()=>this.controller.raw("Run")),Xt.createElement(Mo,R({latex:()=>this.getHandlerLatex(),operatorNames:()=>this.getMQConfig().autoOperatorNames,ariaLabel:()=>this.controller.s("graphing-calculator-narration-tick-action"),brailleShouldFocus:()=>this.getFocusedInput()==="handler",onBrailleInput:e=>this.dispatchHandlerLatexIfChanged(e),onBrailleFocusedChanged:e=>this.handleFocusedChanged("handler",e),onBrailleKeydown:e=>this.handlePressedKey("handler",e.key,e)},ui(this.controller)),Xt.createElement(Fe,{hasError:()=>!!this.getHandlerErrorString(),getAriaPostLabel:()=>{let e=this.getHandlerErrorString();return e?this.controller.unpack(e):""},tokenController:this.props.controller,capExpressionSize:this.const(!1),onUserChangedLatex:e=>this.dispatchHandlerLatexIfChanged(e),latex:()=>this.getHandlerLatex(),getAriaLabel:()=>this.controller.s("graphing-calculator-narration-tick-action"),isFocused:()=>this.getFocusedInput()==="handler",config:()=>this.getMQConfig(),onFocusedChanged:e=>this.handleFocusedChanged("handler",e),selectOnFocus:this.const(!0),noFadeout:this.const(!0),onUserPressedKey:(e,t)=>{this.handlePressedKey("handler",e,t)}})),lpe(()=>this.getHandlerErrorString(),e=>Xt.createElement("span",{class:Xt.const("dcg-clickable-info-error-container")},Xt.createElement(Di,{error:()=>this.controller.unpack(e()),size:this.const("small")})))),Xt.createElement("div",{class:Xt.const("dcg-editable-mathquill-container dcg-action-frequency")},Xt.createElement("span",{class:Xt.const("dcg-ticker-label")},()=>this.controller.raw("every")),Xt.createElement(Mo,R({latex:()=>this.getMinStepLatex(),operatorNames:()=>this.getMQConfig().autoOperatorNames,ariaLabel:()=>this.controller.s("graphing-calculator-label-ticker-min-step"),brailleShouldFocus:()=>this.getFocusedInput()==="minstep",onBrailleInput:e=>this.dispatchMinStepLatexIfChanged(e),onBrailleFocusedChanged:e=>this.handleFocusedChanged("minstep",e),onBrailleKeydown:e=>this.handlePressedKey("minstep",e.key,e)},ui(this.controller)),Xt.createElement(Fe,{hasError:()=>!!this.getMinStepErrorString(),getAriaPostLabel:()=>{let e=this.getMinStepErrorString();return e?this.controller.unpack(e):""},capExpressionSize:this.const(!1),onUserChangedLatex:e=>this.dispatchMinStepLatexIfChanged(e),latex:()=>this.getMinStepLatex(),getAriaLabel:()=>this.controller.s("graphing-calculator-label-ticker-min-step"),isFocused:()=>this.getFocusedInput()==="minstep",config:this.bindFn(this.getMQConfig),onFocusedChanged:e=>this.handleFocusedChanged("minstep",e),tokenController:this.props.controller,selectOnFocus:this.const(!0),placeholder:this.const("0"),noFadeout:this.const(!0),onUserPressedKey:(e,t)=>{this.handlePressedKey("minstep",e,t)}})),()=>this.controller.raw("ms"),Xt.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-ticker-help-tooltip"),gravity:this.const("s")},Xt.createElement("a",{"aria-label":()=>this.controller.s("graphing-calculator-label-ticker-help-tooltip"),class:Xt.const("dcg-ticker-toggle-help"),target:Xt.const("_blank"),href:Xt.const("https://help.desmos.com/hc/en-us/articles/4407725009165#h_01FB2RZQRYM62C3EB94H2TRRAX")},Xt.createElement("i",{class:Xt.const("dcg-icon-question-sign"),"aria-hidden":Xt.const("true")})))),Xt.createElement(sj,{predicate:this.bindFn(this.shouldShowSliderPrompt)},()=>Xt.createElement(Ec,{model:()=>this.props.controller().getTicker(),controller:this.props.controller}))),Xt.createElement("div",{class:()=>({"dcg-circular-icon-container":!0,"dcg-disabled":this.iconDisabled()}),"aria-label":this.bindFn(this.getIconAriaLabel),role:Xt.const("button"),tabIndex:()=>this.iconDisabled()?-1:0,"aria-disabled":this.bindFn(this.iconDisabled),"aria-pressed":()=>this.controller.getTickerPlaying()&&!this.iconDisabled(),onTap:this.bindFn(this.toggleTicker),onTapStart:()=>{Jr()}},Xt.createElement($o,{iconType:this.const("metronome")}),Xt.createElement("div",{class:()=>({"dcg-metronome-bar":!0,"dcg-metronome-playing":this.controller.getTickerPlaying()&&!this.iconDisabled()})}),Xt.createElement(sj,{predicate:()=>!this.iconDisabled()},()=>Xt.createElement("div",{class:Xt.const("dcg-mini-play-pause")},Xt.createElement($o,{iconType:this.bindFn(this.getPlayIcon)}))))),Xt.createElement("i",{onTap:this.bindFn(this.closeTicker),tabIndex:()=>this.controller.isInEditListMode()?0:-1,"aria-label":()=>this.controller.s("graphing-calculator-label-ticker-close"),role:Xt.const("link"),class:Xt.const("dcg-icon-remove dcg-do-not-blur")}))}iconDisabled(){return!!(this.getMinStepErrorString()||this.getHandlerErrorString()||!this.isHandlerMaybeValid())}isHandlerMaybeValid(){var e;return((e=this.controller.getTicker().formula)==null?void 0:e.handler.status)==="maybe-valid"}closeTicker(){this.controller.dispatch({type:"close-ticker"})}toggleTicker(){this.iconDisabled()||this.controller.dispatch({type:"toggle-ticker"})}getPlayIcon(){return this.controller.getTickerPlaying()?"pause":"play"}getIconAriaLabel(){return this.controller.getTickerPlaying()?this.controller.s("graphing-calculator-label-ticker-pause"):this.controller.s("graphing-calculator-label-ticker-play")}getFocusedInput(){let e=this.controller.getFocusLocation();if(!(!e||e.type!=="ticker"))return e.location}handlePressedKey(e,t,r){let n=Fe.getFocusedMathquill();if(n){if(t==="PageUp"||t==="PageDown")return r==null||r.preventDefault(),r==null||r.stopPropagation(),this.controller.dispatch({type:"on-special-key-pressed",key:t});if(t==="Enter"&&this.shouldShowSliderPrompt()&&this.controller.dispatch({type:"create-sliders-for-ticker",variables:Sw(this.props.controller().getTicker())}),t==="Esc"&&this.controller.getExpressionSearchOpen()&&this.controller.dispatch({type:"close-expression-search"}),t==="Right"&&e==="handler"||t==="Left"&&e==="minstep"||t==="Down"||t==="Up"){if(!Fe.applyArrowKeyAndReturnIfWasAtBounds(n,t,r))return;if(t==="Down"||t==="Up")return this.controller.dispatch({type:"on-special-key-pressed",key:t});if(t==="Right"){this.handleFocusedChanged("minstep",!0);return}else if(t==="Left"){this.handleFocusedChanged("handler",!0);return}}n.keystroke(t,r),e==="handler"?this.dispatchHandlerLatexIfChanged(n.latex()):e==="minstep"&&this.dispatchMinStepLatexIfChanged(n.latex())}}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"ticker",location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"ticker",location:e}})}dispatchHandlerLatexIfChanged(e){this.getHandlerLatex()!==e&&this.controller.dispatch({type:"update-ticker-handlerlatex",latex:e})}dispatchMinStepLatexIfChanged(e){this.getMinStepLatex()!==e&&this.controller.dispatch({type:"update-ticker-minsteplatex",latex:e})}getHandlerLatex(){return this.controller.getTickerHandlerLatex()}getMinStepLatex(){return this.controller.getTickerMinStepLatex()}getMQConfig(){return this.controller.getMathquillConfig({additionalOperators:["dt"]})}getHandlerErrorString(){return this.getHandlerLatex()?I4(this.controller.getTicker()):void 0}getMinStepErrorString(){return A4(this.controller.getTicker())}shouldShowSliderPrompt(){return this.controller.areSlidersEnabled()?Sw(this.controller.getTicker()).length>0:!1}},{If:qs,IfDefined:nx,For:cpe,Switch:lj,SwitchUnion:dpe,IfElse:ppe}=tt.Components,f1=class extends tt.Class{constructor(){super(...arguments),this.guid=__dcg_shared_module_exports__.K("listView")}init(){this.controller=this.props.controller()}template(){return tt.createElement("div",{didMount:this.bindFn(this.didMountContainer)},tt.createElement("div",{class:tt.const("dcg-exppanel-outer"),onDrop:this.bindFn(this.onDrop),style:()=>this.computeExppanelOuterStyle()},tt.createElement(qs,{predicate:()=>this.controller.isFileDraggedOver()},()=>tt.createElement("div",{class:tt.const("dcg-drop-image")},tt.createElement("span",null,()=>this.controller.s("graphing-calculator-label-drop-image-here")))),tt.createElement("div",{class:()=>{var e;return{"dcg-exppanel-container":!0,"dcg-add-shadow":this.controller.shouldRenderList(),"dcg-global-mute-on":!!((e=this.controller.toneController)!=null&&e.isGlobalMuted())}},style:()=>({transform:this.controller.isListVisible()?void 0:this.controller.isNarrow()?"translate(0, 100%)":"translate(-100%, 0)"})},tt.createElement(qs,{predicate:()=>this.controller.shouldRenderList()},()=>tt.createElement(S0,{controller:this.props.controller,expsScrolled:()=>!!this.exppanel&&this.exppanel.scrollTop>0})),tt.createElement(qs,{predicate:()=>this.controller.getExpressionSearchOpen()},()=>tt.createElement(VI,{controller:this.props.controller,expsScrolled:()=>!!this.exppanel&&this.exppanel.scrollTop>0})),tt.createElement(qs,{predicate:()=>this.controller.getTickerVisible()},()=>tt.createElement(nA,{controller:this.props.controller,expsScrolled:()=>!!this.exppanel&&this.exppanel.scrollTop>0})),tt.createElement(qs,{predicate:()=>this.controller.shouldRenderList()},()=>tt.createElement("div",{class:()=>({"dcg-exppanel":!0,"dcg-disable-horizontal-scroll-to-cursor":!0,"dcg-isDragging":this.controller.isDragDropActive(),"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-edit-list-mode":this.controller.isInEditListMode()}),onPaste:this.bindFn(this.onPaste),onTapStart:this.bindFn(this.onExppanelTapstart),didMount:this.bindFn(this.didMountExppanel)},tt.createElement("div",{class:tt.const("dcg-expressionlist"),role:tt.const("region"),"aria-label":()=>this.controller.s("shared-calculator-narration-expression-list")},tt.createElement(qs,{predicate:()=>this.controller.getShowConstructionsOpen()},()=>tt.createElement(FI,{controller:this.props.controller,onDragPending:(e,t)=>this.onDragPending(e,t)})),tt.createElement("span",{class:tt.const("dcg-template-expressioneach")},tt.createElement(qs,{predicate:()=>this.controller.shouldShowProgressUpdateLegend()},()=>tt.createElement(I0,{controller:()=>this.props.controller()})),tt.createElement(cpe,{each:()=>this.controller.getAllItemModels(),key:e=>e.guid},e=>dpe(()=>Az(e),{shell:()=>this.makeShellViewForModel(e),render:()=>this.makeViewForModel(e),none:()=>{}}))),tt.createElement(_0,{controller:()=>this.props.controller()}),tt.createElement(lj,{key:()=>this.controller.getDraggedItemId()},e=>{if(e){let t=this.controller.getItemModel(e);return tt.createElement(x0,{controller:this.props.controller},this.makeDragCopyViewForModel(t))}else return}),tt.createElement("span",{style:tt.const("flex:1")}),nx(()=>this.controller.getShellView("notice"),e=>tt.createElement(qs,{predicate:()=>!this.controller.isKeypadOpen()},()=>{let t=e();return tt.createElement(t,null)})),tt.createElement(qs,{predicate:()=>!this.controller.isKeypadOpen()},()=>tt.createElement("div",{class:tt.const("dcg-expressions-branding")},ppe(()=>this.controller.canEditOnWeb(),{true:()=>tt.createElement("span",{role:tt.const("link"),tabIndex:tt.const(0),class:tt.const("dcg-edit-branding"),onTap:()=>this.controller.dispatch({type:"open-on-web"})},tt.createElement("div",{class:tt.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-graph-on-desmos")},()=>this.controller.s("graphing-calculator-button-edit-graph-on-desmos-logo")),tt.createElement("i",{class:tt.const("dcg-icon-desmos"),"aria-hidden":tt.const("true")})),false:()=>tt.createElement("div",null,tt.createElement("div",{class:tt.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-powered-by-desmos")},()=>this.controller.s("graphing-calculator-label-powered-by")),tt.createElement("i",{class:tt.const("dcg-icon-desmos"),"aria-hidden":tt.const("true")}))}))))))),tt.createElement(GI,{controller:this.props.controller})),tt.createElement(qs,{predicate:()=>this.isOptionsViewOpen("expression")},()=>tt.createElement(ps,R({menuType:this.const("expression"),menuButtonFocusLocation:()=>{let e=this.getActiveExpressionModelForOptionsView();return e?{type:"expression-icon",id:e.id}:void 0}},this.getSharedDropdownWrapperProps()),nx(this.bindFn(this.getActiveExpressionModelForOptionsView),e=>tt.createElement(ny,{controller:this.props.controller,model:e})))),tt.createElement(qs,{predicate:()=>this.isOptionsViewOpen("image")},()=>tt.createElement(ps,R({menuType:this.const("image"),menuButtonFocusLocation:()=>{let e=this.getActiveImageModelForOptionsView();return e?{type:"image-icon",id:e.id}:void 0}},this.getSharedDropdownWrapperProps()),nx(this.bindFn(this.getActiveImageModelForOptionsView),e=>tt.createElement(BI,{controller:this.props.controller,model:e})))),tt.createElement(qs,{predicate:()=>this.isOptionsViewOpen("slider")},()=>tt.createElement(ps,R({menuType:this.const("slider"),menuButtonFocusLocation:()=>{let e=this.getActiveSliderModelForOptionsView();return e?{type:"slider-icon",id:e.id}:void 0}},this.getSharedDropdownWrapperProps()),nx(this.bindFn(this.getActiveSliderModelForOptionsView),e=>tt.createElement(zI,{controller:this.props.controller,model:e})))),tt.createElement(qs,{predicate:()=>this.isOptionsViewOpen("table-column")},()=>tt.createElement(ps,R({menuType:this.const("table-column"),menuButtonFocusLocation:()=>{let e=this.getActiveColumnModelForOptionsView();return e?{type:"table-icon",id:e.table.id,columnId:e.id}:void 0}},this.getSharedDropdownWrapperProps()),nx(this.bindFn(this.getActiveColumnModelForOptionsView),e=>tt.createElement(LI,{controller:this.props.controller,model:e})))),tt.createElement(qs,{predicate:()=>this.isOptionsViewOpen("table-regression")},()=>tt.createElement(ps,R({menuType:this.const("table-regression"),menuButtonFocusLocation:()=>{let e=this.getActiveTableModelForOptionsView();return e?{type:"table-regression-icon",id:e.id}:void 0}},this.getSharedDropdownWrapperProps()),nx(this.bindFn(this.getActiveTableModelForOptionsView),e=>tt.createElement(PI,{controller:this.props.controller,model:e})))))}getSharedDropdownWrapperProps(){return{rootElSelector:this.const(".dcg-container"),openAriaAlert:this.const(this.controller.s("graphing-calculator-narration-options-menu-open")),closeAriaAlert:this.const(this.controller.s("graphing-calculator-narration-options-menu-closed")),focusOnOpen:this.bindFn(this.optionsViewFocusLocation),shouldHandleTabAndEscape:this.const(!0),controller:this.props.controller}}optionsViewFocusLocation(){let e=this.controller.getOpenItemMenu();if(!e||!("model"in e))return"none";let{model:t}=e;if(!t)return"none";let r=this.controller.getFocusLocation();if(!r||r.type!=="expression-menu"||r.id!==t.id)return"none";switch(r.location){case"start":return"first";case"end":return"last";default:return"none"}}getActiveSliderModelForOptionsView(){let e=this.controller.getOpenItemMenu();return e&&e.type==="slider"&&"model"in e?e.model:void 0}getActiveImageModelForOptionsView(){let e=this.controller.getOpenItemMenu();return e&&e.type==="image"&&"model"in e?e.model:void 0}getActiveExpressionModelForOptionsView(){let e=this.controller.getOpenItemMenu();return e&&e.type==="expression"&&"model"in e?e.model:void 0}getActiveColumnModelForOptionsView(){let e=this.controller.getOpenItemMenu();return e&&e.type==="table-column"&&"model"in e?e.model:void 0}getActiveTableModelForOptionsView(){let e=this.controller.getOpenItemMenu();return e&&e.type==="table-regression"&&"model"in e?e.model:void 0}isOptionsViewOpen(e){let t=this.controller.getOpenItemMenu();return!!t&&t.type===e}makeShellViewForModel(e){return tt.createElement(M0,{controller:this.props.controller,model:()=>e,onDragPending:()=>{},isDragCopy:()=>!1})}computeExppanelOuterStyle(){this.getListBottomAndUpdateLastExpressionPadding();let{list:e}=this.controller.computeMajorLayout(),t=0,r=e.top;return e.top>0&&!this.controller.isListVisible()&&(r-=e.height),{position:"absolute",left:t+"px",top:r+"px",width:e.width+"px",height:e.height+"px"}}makeDragCopyViewForModel(e){return this.makeViewForModel(e,!0)}makeViewForModel(e,t=!1){let r;if(e.type==="table")r=tt.createElement(g1,{controller:this.props.controller,model:()=>e,onDragPending:n=>this.onDragPending(n,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="folder")r=tt.createElement(E0,{controller:this.props.controller,model:()=>e,onDragPending:n=>this.onDragPending(n,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="text")r=tt.createElement(m1,{controller:this.props.controller,model:()=>e,onDragPending:n=>this.onDragPending(n,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="image")r=tt.createElement(k0,{controller:this.props.controller,model:()=>e,onDragPending:n=>this.onDragPending(n,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="expression")r=tt.createElement(lj,{key:()=>t&&this.controller.shouldRenderDraggedItemAsToken()},n=>n?tt.createElement(Ad,{showParentChildrenHover:this.const(!1),controller:this.props.controller,identifier:()=>this.controller.getDraggedIdentifier(),insideMQ:this.const(!1),insideGroup:this.const(!1),putInTabOrder:()=>!1}):tt.createElement(Wg,{controller:this.props.controller,model:()=>e,onDragPending:i=>this.onDragPending(i,{type:"expression",calcId:e.id}),isDragCopy:()=>t}));else return;return r}didUnmount(){ee(document.documentElement).off("."+this.guid)}didMountContainer(e){this.node=e,ee(document.documentElement).on("keydown."+this.guid,this.bindFn(this.handleKeyDown))}didMountExppanel(e){this.exppanel=e,e.onscroll=()=>this.controller.markTickRequiredNextFrame()}getListBottomAndUpdateLastExpressionPadding(){let e=this.controller.getKeypadHeight(),t=this.__listBottom||0;return this.__listBottom=e,e===0&&t!==0&&DG()&&this.padLastExpressionUntilTapEnd(t),e}padLastExpression(e){let t=this.node.querySelector(".dcg-expressionitem.dcg-new-expression");t.style.marginBottom=e+"px"}unpadLastExpression(){let e=this.node.querySelector(".dcg-expressionitem.dcg-new-expression");e.style.marginBottom="0"}padLastExpressionUntilTapEnd(e){this.padLastExpression(e),ee(document).on("dcg-tap.animating-bottom",()=>{this.unpadLastExpression(),ee(document).off("dcg-tap.animating-bottom")})}handleKeyDown(e){var t;if(this.controller.inAudioTraceMode())return;let r=ke(e),n=Ko(e),i=this.controller.getSelectedItem();if(!i){(r==="Backspace"||r==="Del")&&!this.controller.needsFakeKeypad()&&this.controller.hasMultipleItemsSelected()&&this.controller.dispatch({type:"delete-all-selected-items"});return}if(e.altKey&&!e.ctrlKey&&!e.metaKey&&e.shiftKey&&n==="T"&&i){if(!this.controller.isGeometry()||!il(i))return;e.preventDefault(),e.stopPropagation(),this.controller.convertToTokenAssignment(i);let a=this.controller.getGeometryFolder();if(a){let l=a.index+this.controller.getNumberOfItemsInFolder(a.id);_n(i,a.id),i.index!==l&&Uu(this.controller.getListModel(),i.index,l,1)}this.controller.ensureAtLeastOneVisibleItem();let s=(t=pi(i))==null?void 0:t.identifier;s&&this.controller.getShowConstructionsOpen()&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-token",identifier:s}});return}let o=this.controller.getFocusLocation();if(e.ctrlKey&&e.shiftKey&&!e.metaKey&&!e.altKey&&o!==void 0){if(n==="O"){if(e.preventDefault(),e.stopPropagation(),this.controller.getOpenItemMenu()!==void 0)return;let a;if(i.type==="expression")!i.sliderExists&&!vb(i)?(a={type:"expression",model:i,guid:i.guid,focusFirstOption:!0,previousFocusLocation:o},this.controller.dispatch({type:"set-focus-location",location:{type:"expression-icon",id:i.id}})):i.sliderExists&&(a={type:"slider",model:i,guid:"slider-"+i.guid,focusFirstOption:!0,previousFocusLocation:o},this.controller.dispatch({type:"set-focus-location",location:{type:"slider-animation-properties-icon",id:i.id}}));else if(i.type==="image")a={type:"image",model:i,guid:i.guid,focusFirstOption:!0,previousFocusLocation:o},this.controller.dispatch({type:"set-focus-location",location:{type:"image-icon",id:i.id}});else if(i.type==="table"&&(o.type==="table"||o.type==="table-icon")){let s;if(o.type==="table"){let l=o.location;if(!l)return;s=i.columnModels[l.column]}else s=Eo(i,o.columnId);if(!s||s.latex===""||!this.controller.getGraphSettings().config.graphpaper||s.error||s.index===0)return;a={type:"table-column",model:s,guid:s.guid,focusFirstOption:!0,previousFocusLocation:o},this.controller.dispatch({type:"set-focus-location",location:{type:"table-icon",id:i.id,columnId:s.id}})}if(!a)return;this.controller.dispatch({type:"toggle-item-settings-menu",menu:a});return}else if(n==="D"){if(this.controller.isItemReadonly(i.id)&&!this.controller.isInEditListMode())return;e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"delete-item-and-animate-out",id:i.id,setFocusAfterDelete:!0});return}}if(this.controller.isInEditListMode()&&!e.altKey&&!e.ctrlKey&&!e.metaKey){if(r==="Tab"&&o!==void 0){let a=this.controller.getItemModelByIndex(0);if(!a)return;let s=(o.type==="readonly-expression"&&a.type==="expression"||o.type==="table-container"&&a.type==="table"||o.type===a.type)&&o.id===a.id,l={type:"edit-list-toggle"},c=this.controller.isFocusLocationFocused(l);e.shiftKey&&s?(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-focus-location",location:l})):!e.shiftKey&&c&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"move-focus-to-item",id:a.id,where:a.type==="table"?"container":void 0}))}else(r==="Up"||r==="Down"||r==="PageUp"||r==="PageDown")&&this.controller.dispatch({type:"on-special-key-pressed",key:r==="Up"||r==="PageUp"?"PageUp":"PageDown"});return}if(r==="Esc"&&this.controller.getExpressionSearchOpen()&&this.controller.dispatch({type:"close-expression-search"}),!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(r==="PageUp"||r==="PageDown")){this.controller.dispatch({type:"on-special-key-pressed",key:r}),e.preventDefault();return}if(!(document.activeElement&&ee.contains(document.body,document.activeElement))&&!this.exppanel.contains(e.target)&&ee.contains(document.documentElement,e.target))switch(r){case"Up":e.preventDefault(),this.controller.dispatch({type:"select-previous-expression"});break;case"Down":e.preventDefault(),this.controller.dispatch({type:"select-next-expression"});break;case"Esc":e.preventDefault(),this.controller.dispatch({type:"set-none-selected"});break;case"Right":e.preventDefault(),i&&(i.type==="expression"&&i.sliderExists?(this.controller.dispatch({type:"adjust-slider-by-keyboard",id:i.id,adjustment:"up"}),this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:i.id}})):this.controller.dispatch({type:"move-focus-to-item",id:i.id,where:"start"}));break;case"Tab":e.preventDefault(),i&&this.controller.dispatch({type:"move-focus-to-item",id:i.id,where:"start"});break;case"Left":e.preventDefault(),i&&(i.type==="expression"&&i.sliderExists?(this.controller.dispatch({type:"adjust-slider-by-keyboard",id:i.id,adjustment:"down"}),this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:i.id}})):this.controller.dispatch({type:"move-focus-to-item",id:i.id,where:"end"}));break;case"Backspace":e.preventDefault(),i&&!this.controller.isItemReadonly(i.id)&&this.controller.dispatch({type:"upward-delete-selected-expression"});break;case"Del":e.preventDefault(),i&&!this.controller.isItemReadonly(i.id)&&this.controller.dispatch({type:"downward-delete-selected-expression"});break;case"Enter":e.wasHandled("create-expression-with-keyboard")||(e.preventDefault(),e.handle("create-expression-with-keyboard"),i&&this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"}));break;default:if(e.metaKey||e.ctrlKey||r==="Shift"||r==="Space")return;i&&(i.type==="table"||this.controller.dispatch({type:"move-focus-to-item",id:i.id,where:"end"}))}}onDragPending(e,t){e.preventDefault(),Jr();let r={x:e.touches[0].clientX,y:e.touches[0].clientY},n={x:r.x,y:r.y},i=setTimeout(()=>{ee(document).off(".dragpending"),this.onDragStart(e,t,r,n)},500);ee(document).on("dcg-tapmove.dragpending",o=>{n={x:o.touches[0].clientX,y:o.touches[0].clientY},(Math.abs(n.y-r.y)>3||Math.abs(n.x-r.x)>3)&&(clearTimeout(i),ee(document).off(".dragpending"),this.onDragStart(e,t,r,n))}),ee(document).on("dcg-tapend.dragpending",()=>{clearTimeout(i),ee(document).off(".dragpending")})}onDragStart(e,t,r,n){e.touches.length===1&&(e.wasHandled("dcg-longhold")||this.controller.dispatch({type:"start-dragdrop",dragTarget:t,grabPt:r,mousePt:n}))}onExppanelTapstart(e){e.device!=="mouse"&&(e.target.closest(".dcg-expressionitem")||Jr())}onPaste(e){let t=this.controller.getGraphSettings().config,r=j9(e);if(!r)return;let n=this.controller.getSelectedItem();if(this.controller.canLoadPastedLink(r)&&n&&n.type==="folder"&&n.title===""){e.stopPropagation(),e.preventDefault(),MI(this.controller,r,(o,a)=>a(null,o));return}if(n&&(n.type==="text"||n.type==="folder"))return;if(this.controller.canLoadPastedLink(r)){e.stopPropagation(),e.preventDefault();let o=t.pasteGraphLinkCallback?t.pasteGraphLinkCallback:(a,s)=>s(null,a);MI(this.controller,r,o);return}if(t.pasteTableData){let o=Q9(r);if(o!==void 0)return e.stopPropagation(),e.preventDefault(),this.controller.dispatch({type:"paste-table",data:o})}let i=J9(r);if(i!==void 0){e.stopPropagation(),e.preventDefault();let o=[];i.length===1&&i[0].numberList?this.controller.dispatch({type:"append-number-list",latex:i[0].content}):(i.forEach(a=>{o.push({type:"expression",id:this.controller.generateId(),latex:a.content})}),this.controller.dispatch({type:"insert-several-expressions",expressions:o}));return}}onDrop(e){if(!this.controller.areImagesEnabled())return;let t=e.dataTransfer&&e.dataTransfer.files;t&&t.length&&this.controller.dispatch({type:"new-images",files:t})}},oc=__dcg_shared_module_exports__.e(ne()),{If:upe}=oc.Components,hpe=3e3,aA=class extends oc.Class{willUpdate(){let e=this.props.controller(),t=e.getAdaptiveDepthPeelingInfo();(t==null?void 0:t.status)===1&&t.peelLayers===zy&&(this.visible=!0,clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.visible=!1,e.dispatch({type:"render"})},hpe))}template(){return oc.createElement(upe,{predicate:()=>this.visible},()=>oc.createElement("div",{class:oc.const("dcg-adaptive-peeling-warning"),style:()=>({left:`${this.props.controller().computeMajorLayout().grapher.left}px`})},oc.createElement("span",{class:oc.const("dcg-warning-content"),tabIndex:oc.const("0")},()=>this.props.controller().s("graphing-calculator-label-adaptive-peel-warning"))))}},Dr=__dcg_shared_module_exports__.e(ne());qt(),qt();var vR=class{constructor(){this.handlers=[],ee(document).on("keydown.delegator",e=>this.handleEvent(e))}push(e){let t=__dcg_shared_module_exports__.K("delegator_");return this.handlers.push({token:t,handler:e}),()=>this.handlers=__dcg_shared_module_exports__.i(this.handlers,r=>r.token!=t)}handleEvent(e){if(!e.isDefaultPrevented()&&this.handlers.length){let t=!1,r=()=>t=!0;for(let{handler:n}of this.handlers.slice().reverse())if(n(e,r),t)return}}},sA=new vR,Ui=__dcg_shared_module_exports__.e(ne()),fr=__dcg_shared_module_exports__.e(ne()),br=__dcg_shared_module_exports__.e(ne()),{If:CR}=br.Components,lA=class extends br.Class{constructor(){super(...arguments),this.i18n=this.props.i18n(),this.isMounted=!1,this.isTitleStuck=!1}template(){return br.createElement("div",{class:()=>({"dcg-shared-modal-container":!0,[this.props.class?this.props.class():""]:!!this.props.class}),didMount:this.bindFn(this.didMountRoot)},br.createElement("div",{class:()=>({"dcg-shared-modal-cover":!0,"dcg-shared-has-close-button":this.showX(),"dcg-shared-modal-fullscreen":this.props.size()==="fullscreen","dcg-shared-modal-wide":this.props.size()==="wide","dcg-shared-modal-medium":this.props.size()==="medium","dcg-shared-modal-narrow":this.props.size()==="narrow","dcg-shared-modal-tiny":this.props.size()==="tiny"})},br.createElement("div",{class:br.const("dcg-shared-modal-background"),onTap:this.props.onClose}),br.createElement("div",{class:br.const("dcg-shared-modal-transition-container")},br.createElement("div",{class:br.const("dcg-shared-modal"),role:br.const("dialog"),"aria-modal":br.const("true"),"aria-label":()=>{let e="";return this.props.ariaLabel?e=this.props.ariaLabel():this.props.title&&(e=this.props.title()),e}},br.createElement(CR,{predicate:()=>this.showX()},()=>br.createElement("div",{class:br.const("dcg-shared-close-cross-container")},br.createElement(Le,{tooltip:()=>this.i18n.s("shared-button-close-dialog")},br.createElement("div",{role:br.const("button"),tabIndex:br.const("0"),"aria-label":()=>this.i18n.s("shared-button-close-dialog"),class:br.const("dcg-shared-close-cross"),onTap:this.props.onClose},br.createElement("i",{class:br.const("dcg-icon-remove"),"aria-hidden":br.const("true")}))))),br.createElement("div",{class:br.const("dcg-shared-modal-contents-wrapper")},br.createElement(CR,{predicate:()=>!!this.props.title&&!!this.props.title()},()=>br.createElement("h1",{class:()=>{var e,t;return{"dcg-shared-modal-title":!0,"dcg-shared-left-align-title":this.leftAlignTitle(),"dcg-shared-modal-title--sticky":!!((t=(e=this.props).withStickyTitle)!=null&&t.call(e)),"dcg-shared-modal-title--stuck":this.isTitleStuck}}},br.createElement(CR,{predicate:()=>{var e,t;return!!((t=(e=this.props).withBackButton)!=null&&t.call(e))}},()=>br.createElement("button",{class:br.const("dcg-shared-back-button"),"aria-label":()=>this.i18n.s("shared-button-back"),tabIndex:br.const(0),onTap:this.props.onBack},br.createElement("i",{class:br.const("dcg-icon-chevron-left dcg-shared-back-button__icon"),"aria-hidden":br.const("true")}))),()=>this.props.title())),br.createElement("div",{class:br.const("dcg-shared-modal-scrollable-content")},this.props.children))))))}showX(){var e,t;return!!((t=(e=this.props).showX)!=null&&t.call(e))}leftAlignTitle(){return!!this.props.leftAlignTitle&&this.props.leftAlignTitle()}didMountRoot(e){var t,r,n,i;if(this.isMounted)return;this.isMounted=!0;let o=e.querySelector(".dcg-shared-modal-contents-wrapper"),a=e.querySelector(".dcg-shared-modal-title");if((r=(t=this.props).withStickyTitle)!=null&&r.call(t)&&o&&a){let y=()=>{this.intersectionObserver&&this.intersectionObserver.disconnect();let E=getComputedStyle(o).getPropertyValue("--dcg-modal-padding").trim();this.intersectionObserver=new IntersectionObserver(([_])=>{this.isTitleStuck=_.intersectionRatio<1,this.update()},{root:o,rootMargin:NS||E===""?void 0:`-${E} 0px 0px 0px`,threshold:[1]}),this.intersectionObserver.observe(a)};y(),this.resizeObserver=new ResizeObserver(y),this.resizeObserver.observe(o)}let s=()=>{var y;(y=e.querySelector(".dcg-shared-close-cross"))==null||y.focus()},l=()=>e.querySelector(".dcg-shared-modal-scrollable-content"),c=()=>{let y=l();y&&(y.tabIndex=y.tabIndex>=0?y.tabIndex:0,y.focus())},d=l(),u=(i=(n=this.props).setFocus)==null?void 0:i.call(n),p=u==="close"&&this.showX(),g=u==="content"||u==="close"&&!this.showX()&&d;p&&s(),g&&c();let f=x8(e);this.unsub=sA.push((y,E)=>{var _,w,v,T;ke(y)==kn&&(this.onClose(),E());let M=y.altKey||y.shiftKey||y.metaKey||y.ctrlKey;ke(y)===ld&&!M&&((w=(_=this.props).onArrowKey)==null||w.call(_,"Left")),ke(y)===cd&&!M&&((T=(v=this.props).onArrowKey)==null||T.call(v,"Right")),f(y)})}onClose(){this.props.onClose&&this.props.onClose()}didUnmount(){var e,t;this.isMounted&&(this.isMounted=!1,(e=this.intersectionObserver)==null||e.disconnect(),(t=this.resizeObserver)==null||t.disconnect(),this.unsub())}},{If:cA,Each:cj}=fr.Components,dA=class extends fr.Class{init(){this.controller=this.props.controller()}template(){return fr.createElement(cA,{predicate:this.props.visible},()=>fr.createElement(lA,{size:this.const("medium"),onClose:this.props.onClose,i18n:this.const(this.controller),class:this.const("dcg-custom-toolbar-settings-modal")},fr.createElement("div",{class:fr.const("dcg-btn-blue dcg-done-btn"),"aria-role":fr.const("button"),tabIndex:fr.const(0),didMount:e=>e.focus(),onTap:this.props.onClose},()=>this.controller.s("graphing-calculator-button-done")),fr.createElement("h1",{class:fr.const("dcg-shared-left-align-title")},()=>this.controller.s("shared-calculator-text-customize-toolbar")),cj(this.bindFn(this.getToolGroups),{key:e=>e.group,item:e=>fr.createElement("div",null,fr.createElement("div",{class:fr.const("dcg-configuration-heading-row dcg-configuration-grid-row")},fr.createElement("div",{class:fr.const("dcg-first-column")},()=>e.group,fr.const(" Tools")),fr.createElement("div",{class:fr.const("dcg-second-column")},fr.const("Disabled when:"))),cj(()=>e.dropdown||[e.current],{item:t=>fr.createElement("div",{class:fr.const("dcg-configuration-grid-row"),"dcg-geo-tool":this.const(t)},fr.createElement("div",{class:fr.const("dcg-first-column")},fr.createElement(mt,{disabled:()=>!this.isToolCustomizable(t),checked:()=>this.getToolInfo(t).visible,onChange:r=>{this.controller.dispatch({type:"set-geometry-custom-toolbar-setting",tool:t,value:ie(R({},this.getToolInfo(t)),{visible:r})})}},()=>t)),fr.createElement("div",{class:()=>({"dcg-disabled":!this.getToolInfo(t).visible||!this.isToolCustomizable(t),"dcg-mathquill-condition-container":!0,"dcg-second-column":!0})},fr.createElement(cA,{predicate:()=>!!this.getToolLatexError(t)&&this.getToolInfo(t).visible},()=>fr.createElement("div",{class:fr.const("dcg-latex-error-container")},fr.createElement(Di,{error:()=>this.getToolLatexError(t)||""}))),fr.createElement(cA,{predicate:()=>this.isToolCustomizable(t)&&this.getToolInfo(t).visible},()=>fr.createElement(Mo,R({latex:()=>this.getToolLatex(t),operatorNames:this.bindFn(this.autoOperatorNames),ariaLabel:()=>this.getToolAria(t),brailleShouldFocus:()=>this.focusedLatexTool===t,onBrailleInput:r=>{this.controller.dispatch({type:"set-geometry-custom-toolbar-setting",tool:t,value:ie(R({},this.getToolInfo(t)),{disabledLatex:r})})},onBrailleFocusedChanged:r=>{this.focusedLatexTool===t&&!r?this.focusedLatexTool=void 0:r&&(this.focusedLatexTool=t)},onBrailleKeydown:()=>{}},ui(this.controller)),fr.createElement(Fe,{latex:()=>this.getToolLatex(t),getAriaLabel:()=>this.getToolAria(t),noFadeout:this.const(!0),getAriaPostLabel:()=>this.getToolLatexError(t)||"",isFocused:()=>this.focusedLatexTool===t,tokenController:this.props.controller,capExpressionSize:()=>this.controller.getCapExpressionSize(),config:()=>this.controller.getMathquillConfig({}),hasError:()=>!!this.getToolLatexError(t),onUserChangedLatex:r=>{this.controller.dispatch({type:"set-geometry-custom-toolbar-setting",tool:t,value:ie(R({},this.getToolInfo(t)),{disabledLatex:r})})},onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:r=>{this.focusedLatexTool===t&&!r?this.focusedLatexTool=void 0:r&&(this.focusedLatexTool=t)},onSelectionChanged:()=>{this.controller.runAfterDispatch(()=>{this.controller.dispatch({type:"render"})})},needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))),fr.createElement(cA,{predicate:()=>!this.getToolInfo(t).visible},()=>fr.createElement("div",{class:fr.const("dcg-disabled-condition-wrapper")},fr.createElement(Mo,R({latex:()=>this.getToolLatex(t),operatorNames:this.bindFn(this.autoOperatorNames),ariaLabel:()=>this.getToolAria(t),isStatic:this.const(!0),brailleShouldFocus:this.const(!1),onBrailleFocusedChanged:()=>{}},ui(this.controller)),fr.createElement(nt,{latex:()=>this.getToolLatex(t),config:()=>this.controller.getMathquillConfig({}),getAriaLabel:()=>this.getToolAria(t)}))))))}))})))}getToolAria(e){return this.controller.s("shared-calculator-narration-disable-tool",{tool:e})}autoOperatorNames(){return this.props.controller().getMathquillConfig({}).autoOperatorNames}getToolLatex(e){return this.getToolInfo(e).disabledLatex||""}isToolCustomizable(e){return e!=="selection"&&e!=="box-selection"}getToolGroups(){let e={group:"transformation",current:"translate",dropdown:fy};return[...qG(),e]}getToolLatexError(e){let t=this.controller.getGeometryToolbarModel(),r=Kz(t,e);if(r)return this.controller.unpack(r)}getToolInfo(e){let t=this.controller.getGeometryToolbarModel();return R({tool:e},t.toolbarState[e])}},{If:dj}=Ui.Components,pA=class extends Ui.Class{init(){this.controller=this.props.controller()}template(){return Ui.createElement(dj,{predicate:()=>this.shouldShowAuthorFeaturesSection()},()=>Ui.createElement("div",{class:Ui.const("dcg-options-menu-section dcg-author-mode-section")},Ui.createElement("div",{class:Ui.const("dcg-options-menu-section-title")},()=>this.controller.s("shared-calculator-narration-author-mode"),Ui.createElement(go,{ariaLabel:()=>this.controller.s("shared-calculator-narration-author-mode"),toggled:this.bindFn(this.isAuthorMode),onChange:()=>{this.controller.dispatch({type:"set-author-mode",enabled:!this.isAuthorMode()})}})),Ui.createElement(dj,{predicate:()=>this.isAuthorMode()},()=>Ui.createElement("div",{class:Ui.const("dcg-author-features-container")},Ui.createElement("div",{class:Ui.const("dcg-toolbar-customization")},Ui.createElement("span",null,Ui.const("Geometry Tools:")),Ui.createElement(vo,{theme:this.const("mini"),ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-configure-toolbar"),staticConfig:this.bindFn(this.getConfigurationOptions)})),Ui.createElement(mt,{checked:()=>this.controller.getGraphSettings().hideCustomColors,onChange:e=>this.controller.dispatch({type:"set-graph-settings",hideCustomColors:e})},()=>this.controller.s("shared-calculator-label-hide-custom-colors")),Ui.createElement(dA,{controller:this.props.controller,onClose:()=>{this.customGeometryToolsSettingsModal=!1,this.controller.dispatch({type:"render"})},visible:()=>this.customGeometryToolsSettingsModal})))))}getToolbar(){return this.controller.getGeometryToolbarModel().toolbar}setToolbar(e){e==="custom"&&(this.customGeometryToolsSettingsModal=!0),this.controller.dispatch({type:"set-geometry-toolbar",toolbar:e})}getConfigurationOptions(){return[{key:"all",label:()=>this.controller.raw("All"),selected:()=>this.getToolbar()==="all",onSelect:()=>this.setToolbar("all")},{key:"none",label:()=>this.controller.raw("None"),selected:()=>this.getToolbar()==="none",onSelect:()=>this.setToolbar("none")},{key:"custom",label:()=>this.controller.raw("Custom"),selected:()=>this.getToolbar()==="custom",onSelect:()=>this.setToolbar("custom")}]}shouldShowAuthorFeaturesSection(){return this.controller.authorFeaturesAvailable()}isAuthorMode(){return this.controller.shouldShowAuthorFeatures()}},{If:uA}=Dr.Components,b1=class extends Dr.Class{init(){this.controller=this.props.controller()}template(){return Dr.createElement("div",{class:()=>({"dcg-geometry-settings-container":!0,"dcg-popover":!0,"dcg-left":!0,"dcg-constrained-height-popover":!0,"dcg-generic-options-menu":!0,"dcg-no-geometry-header":!this.controller.shouldShowGeoToolbar()}),style:this.bindFn(this.getContainerStyle),didMount:this.bindFn(this.didMountContainer),didUnmount:this.bindFn(this.didUnmountContainer)},Dr.createElement("div",{class:Dr.const("dcg-popover-interior"),role:Dr.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-geometry-settings")},Dr.createElement("div",{class:Dr.const("dcg-options-menu-section")},Dr.createElement(Xy,{controller:this.props.controller}),Dr.createElement(uA,{predicate:()=>!this.controller.getLockViewportConfigSetting()},()=>Dr.createElement(Sm,{controller:this.props.controller})),Dr.createElement(uA,{predicate:()=>this.controller.getHiddenGeoItemCount()>0},()=>Dr.createElement(mt,{onChange:this.bindFn(this.toggleGhostMode),checked:()=>this.controller.getGhostMode(),manageFocus:this.const(rt({controller:this.controller,location:{type:"settings",location:"hidden-objects"}}))},()=>this.controller.s("graphing-calculator-label-settings-hidden-objects",{count:this.controller.getHiddenGeoItemCount()})))),Dr.createElement("div",{class:Dr.const("dcg-options-menu-section")},Dr.createElement("div",{class:Dr.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-label-settings-grid"),Dr.createElement(go,{ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-grid"),toggled:this.bindFn(this.getShowGrid),onChange:this.bindFn(this.toggleGrid)})),Dr.createElement(uA,{predicate:this.bindFn(this.getShowGrid)},()=>Dr.createElement(mt,{onChange:this.bindFn(this.toggleMinorGridlines),checked:this.bindFn(this.getMinorGridlines)},()=>this.controller.s("graphing-calculator-label-settings-minor-gridlines")))),Dr.createElement("div",{class:Dr.const("dcg-options-menu-section")},Dr.createElement("div",{class:Dr.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-label-axes"),Dr.createElement(go,{ariaLabel:()=>this.controller.s("graphing-calculator-label-axes"),toggled:this.bindFn(this.getShowAxes),onChange:this.bindFn(this.toggleAxes)})),Dr.createElement(uA,{predicate:this.bindFn(this.getShowAxes)},()=>Dr.createElement("div",null,Dr.createElement(mt,{onChange:this.bindFn(this.toggleAxisNumbers),checked:this.bindFn(this.getAxisNumbers)},()=>this.controller.s("graphing-calculator-label-settings-axis-numbers")),Dr.createElement("div",null,Dr.createElement(mt,{onChange:this.bindFn(this.toggleArrows),checked:()=>this.getAxisArrowMode()!=="NONE"},()=>this.controller.s("graphing-calculator-label-settings-arrows")))))),Dr.createElement(Jy,{controller:this.props.controller}),Dr.createElement(pA,{controller:this.props.controller}),Dr.createElement(rc,{setup:this.const({controller:this.controller,type:"advanced"})}),Dr.createElement("div",{class:Dr.const("dcg-arrow")})))}toggleGhostMode(){this.controller.dispatch({type:"set-ghost-mode",value:!this.controller.getGhostMode()})}didMountContainer(e){this.node=e,ee(document.documentElement).on("dcg-tapstart.geometry-settings-view wheel.geometry-settings-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:t.device==="keyboard"})}),this.unsub=sA.push(t=>{let r=ke(t);if(r==="Esc"&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:!0}),this.controller.isGraphSettingsOpen()&&r==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let n=this.controller.getFocusLocation();if(!n||n.type!=="settings")return;t.shiftKey?t.shiftKey&&(n.location==="default-size"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation()):n.location==="icon"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"degree-mode"}}),t.preventDefault(),t.stopPropagation())):n.location==="icon"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"default-size"}}),t.preventDefault(),t.stopPropagation()):n.location==="degree-mode"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation())}})}didUnmountContainer(){ee(document.documentElement).off(".geometry-settings-view"),this.unsub()}didUpdate(){if(!this.controller.isGraphSettingsOpen())return;let e=this.controller.getKeypadHeight();e!==this.cachedKeypadHeight&&document.activeElement&&this.node.contains(document.activeElement)&&tc(document.activeElement,this.node.querySelector(".dcg-popover-interior"),50),this.cachedKeypadHeight=e}eventShouldClosePopover(e){let t=e.target,r=this.node.contains(t),n=!!t.closest(".dcg-action-settings"),i=this.isMathquillFocused()&&!!t.closest(".dcg-keypad"),o=!!t.closest(".dcg-action-undo")||!!t.closest(".dcg-action-redo");return!(r||n||i||o)}isMathquillFocused(){return this.getFocusedLimit()!==void 0}getFocusedLimit(){let e=this.controller.getFocusLocation();if(e&&e.type==="settings")return e.location}getShowXAxis(){return!!this.controller.getGraphSettings().showXAxis}toggleAxes(){this.controller.dispatch({type:"set-graph-settings",showXAxis:!this.getShowXAxis(),showYAxis:!this.getShowXAxis()})}getShowAxes(){return!!this.controller.getGraphSettings().showXAxis}getAxisNumbers(){return!!this.controller.getGraphSettings().xAxisNumbers}toggleAxisNumbers(){let e=this.getAxisNumbers();this.controller.dispatch({type:"set-graph-settings",xAxisNumbers:!e,yAxisNumbers:!e,polarNumbers:!e})}getMinorGridlines(){return this.controller.getGraphSettings().xAxisMinorSubdivisions===0}toggleMinorGridlines(){let e=this.getMinorGridlines()?1:0;this.controller.dispatch({type:"set-graph-settings",yAxisMinorSubdivisions:e,xAxisMinorSubdivisions:e})}getAxisArrowMode(){return this.controller.getGraphSettings().xAxisArrowMode}getShowGrid(){return this.controller.getGraphSettings().showGrid}toggleGrid(){this.controller.dispatch({type:"set-graph-settings",showGrid:!this.getShowGrid()})}toggleArrows(){let e=this.getAxisArrowMode()==="NONE"?"BOTH":"NONE";this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})}getContainerStyle(){return this.controller.getKeypadHeight()?"bottom: 0":""}},jd=__dcg_shared_module_exports__.e(ne()),{Switch:gpe}=jd.Components,mA=class extends jd.Class{constructor(){super(...arguments),this.frames=0,this.prevTime=0}init(){var e;this.current=0,this.panels={},this.panels.fps=new x1({name:"fps",yMax:120,fg:"#0ff",bg:"#002"}),this.panels.evaluator=new x1({name:"eval",yMax:250,fg:"#f80",bg:"#210"}),this.panels.mem=new x1({name:"MB",yMax:this.getMemory().jsHeapSizeLimit/wr(2,20),fg:"#f08",bg:"#201"}),this.list=Object.keys(this.panels),this.props.controller().onEvaluatorChangesSpy=(r,n)=>{var i;this.props.controller().isThreeDMode()||this.frame(),this.panels.evaluator.update((i=n.timeInWorker)!=null?i:NaN)};let t=(e=this.props.controller().getGrapher3d())==null?void 0:e.webglLayer;t&&(t.debugOnlyMeasureGPUTiming=!0,t.onRenderSpy=()=>{this.frame()})}willUnmount(){this.props.controller().onEvaluatorChangesSpy=void 0}template(){return jd.createElement("div",{class:jd.const("dcg-performance-meter"),onTap:()=>{this.current=(this.current+1)%this.list.length,this.update()}},jd.createElement(gpe,{key:()=>this.list[this.current]},e=>jd.createElement("div",{didMount:t=>{t.appendChild(this.panels[e].dom)}})))}frame(){this.frames++;let e=(performance||Date).now();return e>=this.prevTime+1e3&&(this.panels.fps.update(this.frames*1e3/(e-this.prevTime)),this.prevTime=e,this.frames=0,this.panels.mem.update(this.getMemory().usedJSHeapSize/wr(2,20))),e}getMemory(){if(self.performance&&"memory"in self.performance){let e=self.performance.memory;return{usedJSHeapSize:e.usedJSHeapSize,totalJSHeapSize:e.totalJSHeapSize,jsHeapSizeLimit:e.jsHeapSizeLimit}}else return{usedJSHeapSize:NaN,totalJSHeapSize:NaN,jsHeapSizeLimit:NaN}}},Hs=Math.round(window.devicePixelRatio||1),SR=80*Hs,pj=48*Hs,uj=3*Hs,hj=2*Hs,hA=3*Hs,y1=15*Hs,ER=74*Hs,gA=30*Hs,x1=class{constructor(e){this.values=[],this.minValue=1/0,this.maxValue=0,this.dom=document.createElement("canvas"),this.name=e.name,this.yMax=e.yMax,this.fg=e.fg,this.bg=e.bg,this.dom.width=SR,this.dom.height=pj,this.dom.style.cssText="width:80px;height:48px";let t=this.dom.getContext("2d");if(!t)throw new Error("Could not get context");this.context=t,t.font="bold "+9*Hs+"px Helvetica,Arial,sans-serif",t.textBaseline="top",t.fillStyle=this.bg,t.fillRect(0,0,SR,pj),t.fillStyle=this.fg,t.fillText(this.name,uj,hj),t.fillRect(hA,y1,ER,gA),t.fillStyle=this.bg,t.globalAlpha=.9,t.fillRect(hA,y1,ER,gA)}update(e){this.values.push(e),this.values.length>ER/Hs&&this.values.shift(),this.minValue=Math.min(this.minValue,e),this.maxValue=Math.max(this.maxValue,e),this.draw()}draw(){this.context.fillStyle=this.bg,this.context.globalAlpha=1,this.context.fillRect(0,0,SR,y1),this.context.fillStyle=this.fg,this.context.fillText(Math.round(this.values[this.values.length-1])+" "+this.name+" ("+Math.round(this.minValue)+"-"+Math.round(this.maxValue)+")",uj,hj),this.context.fillStyle=this.fg,this.context.fillRect(hA+Hs,y1,this.values.length*Hs,gA),this.context.fillStyle=this.bg,this.context.globalAlpha=.9;for(let e=0;e<this.values.length;e++){let t=this.values[e];this.context.fillRect(hA+(e+1)*Hs,y1,Hs,Math.round((1-t/this.yMax)*gA))}}},{If:Fh}=Wt.Components,w1=class extends Wt.Class{init(){this.controller=this.props.controller()}settings(){return this.controller.getGraphSettings()}template(){return Wt.createElement("div",{class:this.const(cf),style:Wt.const("width: 100%; height: 100%; position: relative;")},Wt.createElement("div",{class:()=>({"dcg-container":!0,"dcg-fullscreen":!this.controller.isListVisible(),"dcg-narrow":this.controller.isNarrow(),"dcg-projector-mode":this.settings().config.projectorMode,"dcg-inverted-colors":!!this.settings().config.invertedColors,"dcg-inverted-swatches":this.controller.invertSwatches(),"dcg-EDIT-LIST-MODE":this.controller.isInEditListMode(),"dcg-no-graphpaper":!this.settings().config.graphpaper,"dcg-no-branding":!this.settings().config.branding,"dcg-no-expression-topbar":!this.settings().config.expressionsTopbar,"dcg-default-border":!!this.settings().config.border,"dcg-no-hyperlinks":!this.settings().config.links,"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-is-interactive":this.settings().config.expressions||!(this.settings().config.lockViewport||this.settings().userLockedViewport)}),style:()=>({"font-size":this.settings().config.fontSize+"px",background:this.controller.hasTransparentBackground()?"none":void 0,"--dcg-custom-background-color":this.controller.hasBackgroundColor()?this.controller.getBackgroundColor():void 0,"--dcg-custom-background-color-shaded":this.controller.hasBackgroundColor()?this.controller.getPillboxBackgroundColor():void 0,"--dcg-custom-text-color":this.controller.hasTextColor()?this.controller.getTextColor():void 0}),role:Wt.const("application"),"aria-label":()=>this.controller.isGeometry()?this.controller.s("graphing-calculator-narration-main-desmos-geometry"):this.controller.s("graphing-calculator-narration-main-desmos-graphing-calculator"),"x-ms-format-detection":Wt.const("none"),didMount:this.bindFn(this.didMountRoot)},Wt.createElement(Fh,{predicate:()=>this.controller.getGraphSettings().config.expressions},()=>Wt.createElement(f1,{controller:this.props.controller})),Wt.createElement(Fh,{predicate:()=>this.controller.isListEnabled()&&!this.controller.isListVisible()&&(!this.controller.isGeometry()||this.controller.isNarrow())},()=>Wt.createElement("div",{class:()=>({"dcg-overgraph-icon-container":!0,"dcg-bottom-right":this.controller.isNarrow()})},Wt.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-show-list"),gravity:()=>this.controller.isNarrow()?"n":"s"},Wt.createElement("div",{class:()=>({"dcg-show-expressions-tab":!0,"dcg-overgraph-icon":!0,"dcg-rotated":this.controller.isNarrow()}),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-show-list"),role:Wt.const("button"),tabIndex:Wt.const("0"),onTap:e=>{this.controller.dispatch({type:"show-expressions-list",focusHideIcon:e.device==="keyboard"})},manageFocus:this.const(rt({controller:this.controller,location:{type:"show-expression-list-btn"}}))},Wt.createElement("i",{class:Wt.const("dcg-icon-show"),"aria-hidden":Wt.const("true")}))))),Wt.createElement(Fh,{predicate:this.bindFn(this.showHamburger)},()=>Wt.createElement("div",{class:Wt.const("dcg-overgraph-icon-container")},Wt.createElement(Le,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),gravity:this.const("s")},Wt.createElement("div",{role:Wt.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),class:Wt.const("dcg-action-opendrawer dcg-in-api-action-opendrawer dcg-overgraph-icon"),onTap:()=>this.controller.dispatch({type:"open-drawer"})},Wt.createElement("i",{class:Wt.const("dcg-icon-hamburger"),"aria-hidden":Wt.const("true")}))))),Wt.createElement(kI,{controller:this.props.controller}),Wt.createElement(aA,{controller:this.props.controller}),Wt.createElement(Fh,{predicate:()=>this.controller.isGeoUIActive()&&this.controller.getGraphSettings().config.settingsMenu&&this.controller.isGraphSettingsOpen()},()=>Wt.createElement(b1,{controller:this.props.controller})),Wt.createElement(Fh,{predicate:()=>this.controller.shouldShowGeoToolbar()},()=>Wt.createElement(yI,{controller:this.props.controller})),Wt.createElement(_I,{controller:this.props.controller}),Wt.createElement("div",{class:Wt.const("dcg-grapher dcg-grapher-2d"),style:()=>({visibility:this.controller.isThreeDMode()?"hidden":"visible","pointer-events":this.controller.isThreeDMode()?"none":"auto"})}),Wt.createElement(Fh,{predicate:()=>this.controller.is3dProduct()},()=>Wt.createElement("div",{class:Wt.const("dcg-grapher dcg-grapher-3d"),style:()=>({visibility:this.controller.isThreeDMode()?"visible":"hidden","pointer-events":this.controller.isThreeDMode()?"auto":"none"})})),Wt.createElement(Fh,{predicate:()=>this.settings().config.showPerformanceMeter&&!!this.props.controller().getGrapher()},()=>Wt.createElement(mA,{controller:this.props.controller})),Wt.createElement(Fh,{predicate:()=>this.controller.getGraphSettings().config.keypad},()=>Wt.createElement(gI,{controller:this.props.controller}))))}showHamburger(){return!this.controller.getGraphSettings().config.showHamburger||this.controller.isGeometry()?!1:this.controller.isNarrow()}didMountRoot(e){nw(e),this.controller.getGraphSettings().config.disableScrollFix||mI(e),this.setupFileDragDrop(e)}setupFileDragDrop(e){FO(e);let t=new Set,r=this;function n(){t=new Set,ee(e).off(".filedraggedover"),r.controller.dispatch({type:"file-is-not-dragged-over"})}ee(e).on("dragenter",i=>{this.controller.areImagesEnabled()&&(i.target.closest(".dcg-notice")||(t.size===0&&ee(e).on("dcg-tapstart.filedraggedover",n),t=t.add(i.target),this.controller.dispatch({type:"file-is-dragged-over"})))}).on("dragleave",i=>{t.delete(i.target),t.size===0&&n()}).on("drop",n)}};qt();function gj(e){let t={},r=new __dcg_shared_module_exports__.re(n);function n(i,o){e({type:i,payload:o})}return t.postMessage=function(i){setTimeout(()=>{r.processChangeSet(i)},0)},t}var mj=$5("workerThrottle"),TR=0;function fj(e){return mj?function(t){var r,n;let i=((n=(r=t.data)==null?void 0:r.originalMessage)==null?void 0:n.type)==="evaluatorProgressUpdate"?0:mj;TR=Math.max(Date.now(),TR)+i,setTimeout(e,TR-Date.now(),t)}:e}var ax=class{constructor(e=1/0){this.workers=[],this.maxWorkers=e}allowedToSpawnWorker(){return!!__dcg_worker_source_exports__.createWorker&&this.workers.length<this.maxWorkers}killWorker(e){__dcg_shared_module_exports__.x(this.workers,e)!==-1&&(e.terminate(),this.workers=__dcg_shared_module_exports__.u(this.workers,e),__dcg_shared_module_exports__.p(__dcg_shared_module_exports__.C(e.__connections)).forEach(t=>{t&&t.onWorkerKilled&&t.onWorkerKilled()}))}spawnWorker(){if(!__dcg_worker_source_exports__.createWorker)return null;try{let e=__dcg_worker_source_exports__.createWorker();return e.__connections={},e.__isFake=!1,e.onerror=function(t){__dcg_shared_module_exports__.qe.log(t)},e.addEventListener("message",fj(t=>{let r=t.data;if(!(r&&r.log)&&r&&r.connectionId){let n=e.__connections[r.connectionId];n&&n.onResponse(r.originalMessage)}})),this.workers.push(e),e}catch(e){return null}}spawnFakeWorker(){let e=gj(fj(t=>{let r=__dcg_shared_module_exports__.C(e.__connections)[0];r&&r.onResponse(t)}));return e.__isFake=!0,e.__connections={},e}findLeastUsedWorker(){let e=function(t){return __dcg_shared_module_exports__.s(t.__connections)};return __dcg_shared_module_exports__.q(this.workers,e)[0]}allocateWorker(){let e=null;return this.allowedToSpawnWorker()&&(e=this.spawnWorker()),e||(e=this.findLeastUsedWorker()),e||(e=this.spawnFakeWorker()),e}},bA=class{constructor(e){this.workerPool=e,this.guid=__dcg_shared_module_exports__.K("worker-pool-connection"),this.worker=e.allocateWorker(),this.worker.__connections[this.guid]=this}destroy(){this.sendMessage({type:"destroy"}),delete this.worker.__connections[this.guid]}killWorker(){this.worker.__isFake||this.workerPool.killWorker(this.worker)}onWorkerKilled(){}onResponse(e){}sendMessage(e){this.worker.__isFake?this.worker.postMessage(e):this.worker.postMessage({connectionId:this.guid,originalMessage:e})}},yA=class{constructor(e){this.onChangeSetChanged=e,this.changeSet=null,this.cumulativeChangeSet={},this.changed=!1}hasPendingChanges(){return!!this.changeSet}pendingChangesAreCompleteState(){return!!this.changeSet&&this.changeSet.isCompleteState}pendingChangesSyncId(){var e;return(e=this.changeSet)==null?void 0:e.syncId}popChangeSet(){let e=this.changeSet;return this.changeSet=null,this.changed=!1,e}applyToChangeSets(e){this.changed=!0,this.changeSet||(this.changeSet={}),this.cumulativeChangeSet||(this.cumulativeChangeSet={}),e(this.changeSet),e(this.cumulativeChangeSet),this.onChangeSetChanged()}_clearStatementsAndStartCompleteState(){this.applyToChangeSets(e=>{e.isCompleteState=!0,delete e.statements})}markDroppedJob(){this.changeSet=__dcg_shared_module_exports__.Jc(this.cumulativeChangeSet),this.changed=!0}markWorkerKilledWhileIdle(){this.changeSet=__dcg_shared_module_exports__.Jc(this.cumulativeChangeSet),this.changed=!1}markSyncId(e){this.applyToChangeSets(t=>{t.syncId=e})}markUndoRedoState(){this.applyToChangeSets(e=>{e.isUndoRedoState=!0})}addStatement(e){this.applyToChangeSets(t=>{t.statements||(t.statements={}),t.statements[e.id]=__dcg_shared_module_exports__.Jc(e)})}removeStatement(e){this.applyToChangeSets(t=>{t.statements||(t.statements={}),t.removes||(t.removes={}),delete t.statements[e],t.removes[e]=!0})}addActionStepEvent(e){this.applyToChangeSets(t=>{t.events||(t.events=[]),t.events.push({type:"step",expressionId:e})})}addClockTickEvent(e,t){this.applyToChangeSets(r=>{r.events||(r.events=[]),r.events.push({type:"clock-tick",id:e,isFirstTick:t})})}addClickEvent(e,t){this.applyToChangeSets(r=>{r.events||(r.events=[]),t===void 0&&(t=0),r.events.push({type:"click",expressionId:e,indexVar:t})})}_applyIfChanged(e,t){let r=this.cumulativeChangeSet&&this.cumulativeChangeSet[t],n=e[t];__dcg_shared_module_exports__.E(r,n)||this.applyToChangeSets(i=>{i[t]=n})}},mpe=4e3,fpe=250,bpe=500,Nh=class extends yA{constructor(e){super(()=>this.processChangeSet()),this.droppedMessage=!1,this.__hasBufferedProgressUpdates=!1,this.evaluationProgressById=new Map,this.lastProgressUpdateTime=-1,this.requestedIntentionalRestart=!1,this.debouncedRestart=__dcg_shared_module_exports__.A(()=>{this.requestedIntentionalRestart=!0,this.restartWorker()},fpe),this.__ticksEnabled=!0,this.listeners={evaluatorProgressUpdate(t){this.lastProgressUpdateTime=Date.now(),t.ids.forEach(r=>this.evaluationProgressById.set(r,t.update)),this.__hasBufferedProgressUpdates=!0},processChangeSet(t){this.clearProgressUpdates();let r={},n={};for(let s in t.graphChanges){let l=t.graphChanges[s];l===void 0?n[s]=!0:(__dcg_shared_module_exports__.uc(l),r[s]=l)}let i={};for(let s in t.intersectionChanges)n[s]||(i[s]=t.intersectionChanges[s]);let o=this.hasPendingChanges();this.onEvaluatorResults({evaluationStates:t.statusChanges,graphData:{addedGraphs:r,removedGraphs:n,intersections:i},renderSlowly:!!t.isCompleteState,timingData:t.timingData,eventUpdates:t.eventUpdates,dependencyOrder:t.dependencyOrder});let a=t.syncId;for(;this.syncRequests.length&&a!==void 0&&this.syncRequests[0].id<=a;)this.syncRequests.shift().callback();this.markJobFinished(),o&&this._processChangeSet()}},this.syncId=1,this.syncRequests=[],this.workerPool=e!=null?e:new ax,this.createWorkerPoolConnection()}privateGetWorkerPool(){return this.workerPool}privateGetWorkerPoolConnection(){return this.workerPoolConnection}createWorkerPoolConnection(){this.workerPoolConnection&&(this.workerPoolConnection.onResponse=function(){},this.workerPoolConnection.onWorkerKilled=function(){}),this.workerPoolConnection=new bA(this.workerPool),this.markJobFinished(),this.workerPoolConnection.onResponse=e=>{this.shouldIgnoreWorkerMessage(e)?e.type==="processChangeSet"&&(this.markJobFinished(),this._processChangeSet()):this.listeners[e.type].call(this,e.payload)},this.workerPoolConnection.onWorkerKilled=()=>{this.cancelRestartWorker();let e=this.hasJobInWorker();this.createWorkerPoolConnection(),e?(this.markDroppedJob(),this.droppedMessage=!this.requestedIntentionalRestart):this.markWorkerKilledWhileIdle(),this.clearProgressUpdates(),this.processChangeSet(),this.requestedIntentionalRestart=!1}}destroy(){this.workerPoolConnection&&(this.workerPoolConnection.onResponse=function(){},this.workerPoolConnection.onWorkerKilled=function(){},this.workerPoolConnection.destroy())}restartWorker(){this.workerPoolConnection.killWorker()}requestRestartWorker(){this.debouncedRestart()}cancelRestartWorker(){this.debouncedRestart.cancel()}shouldIgnoreWorkerMessage(e){return this.__suspendUntilSyncId?!e||!e.payload?!0:!(e.payload.syncId>=this.__suspendUntilSyncId):!1}suspend(){this.clearProgressUpdates(),this.pendingChangesSyncId()===void 0&&(this.syncId++,this.markSyncId(this.syncId)),this.__suspendUntilSyncId=this.pendingChangesSyncId()}markJobFinished(){this.droppedMessage=!1,this.__jobStartTime=-1,this.__suspendUntilSyncId=void 0}startJobTimer(){this.__jobStartTime=Date.now()}hasJobInWorker(){return this.__jobStartTime!==-1}getJobElapsedTime(){return this.hasJobInWorker()?Date.now()-this.__jobStartTime:NaN}setTicksEnabled(e){this.__ticksEnabled=e}tick(){var e;this.__ticksEnabled&&(this.__hasBufferedProgressUpdates&&((e=this.onEvaluatorProgressUpdate)==null||e.call(this)),this.__hasBufferedProgressUpdates=!1,this._processChangeSet())}processChangeSet(){this.__processChangeSetRequested=!0}_processChangeSet(){var e;if(this._syncEvaluatorConfig(),!this.__processChangeSetRequested)return;let t=this.getJobElapsedTime()>=mpe;if(this.droppedMessage&&t){this.restartWorker();return}this.changed&&this.hasPendingChanges()&&(this.pendingChangesSyncId()===void 0&&(this.syncId++,this.markSyncId(this.syncId)),this.hasJobInWorker()?this.pendingChangesAreCompleteState()&&t&&this.restartWorker():(this.startJobTimer(),this.workerPoolConnection.sendMessage(this.popChangeSet()),this.__processChangeSetRequested=!1,(e=this.clearSlowEvaluatorTracking)==null||e.call(this)))}notifyWhenSynced(e){if(this._syncEvaluatorConfig(),!this.hasJobInWorker()&&!this.hasPendingChanges()){setTimeout(e,0);return}this.syncId++,this.syncRequests.push({id:this.syncId,callback:e}),this.markSyncId(this.syncId)}clearStatementsAndStartCompleteState(){this.hasJobInWorker()&&this.suspend(),this._clearStatementsAndStartCompleteState()}_syncEvaluatorConfig(){if(!this.readEvaluatorConfig)return;let e=this.readEvaluatorConfig();for(let t in e)this._applyIfChanged(e,t)}clearProgressUpdates(){this.evaluationProgressById=new Map,this.__hasBufferedProgressUpdates=!1}isCurrentlySlow(){return this.lastProgressUpdateTime>-1&&Date.now()-this.lastProgressUpdateTime>=bpe}};qt();var v1=class{constructor(e){this.previousPaneFocusLocations={main:void 0,quest:void 0},this.controller=e}markKeyDownAsHandled(e){e.stopPropagation(),e.preventDefault()}handleKeydown(e){var t,r,n,i,o;let a=Ko(e);if(Zx(e))this.markKeyDownAsHandled(e),this.controller.hasVisibleAndUndoableToast()?this.controller.toastUndo():this.controller.dispatch({type:"undo"});else if(ew(e))this.markKeyDownAsHandled(e),this.controller.dispatch({type:"redo"});else if(e.altKey&&!e.ctrlKey&&!e.metaKey&&e.shiftKey&&a==="Z"){let s=this.controller.getSelectedItem();s&&s.id&&(this.markKeyDownAsHandled(e),this.controller.dispatch({type:"expression-zoom-fit",id:s.id,focusAfterTap:!1}))}else if(e.altKey!==Zo&&e.metaKey===Zo&&!e.ctrlKey&&e.shiftKey&&a==="A"&&this.controller.isDecimalToFractionEnabled()){let s=this.controller.getSelectedItem();s&&s.type==="expression"&&(this.markKeyDownAsHandled(e),this.controller.dispatch({type:"toggle-fraction-evaluation",id:s.id}),this.controller.runAfterDispatch(()=>{Hu(s)?xe(this.controller.s("shared-calculator-narration-show-as-fraction")):xe(this.controller.s("shared-calculator-narration-show-as-decimal"))}))}else if(!e.altKey&&e.ctrlKey!==Zo&&e.metaKey===Zo&&a==="F"){if(this.controller.isExpressionListFocused()){let s=Fe.getFocusedMathquill(),l="";try{l=s.__controller.cursor.selection.join("latex")||""}catch(c){}this.controller.dispatch({type:"open-expression-search",rename:!!e.shiftKey,latex:l}),this.markKeyDownAsHandled(e)}}else if((e.altKey||e.metaKey)&&!e.ctrlKey&&!e.shiftKey&&a===void 0){if(ke(e)===xa){let s=this.controller.getSelectedItem();s&&s.type==="folder"&&(this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-folder-collapsed",id:s.id,isCollapsed:!0}),xe(this.controller.s("graphing-calculator-narration-folder-collapsed")))}else if(ke(e)===Kn){let s=this.controller.getSelectedItem();s&&s.type==="folder"&&(this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-folder-collapsed",id:s.id,isCollapsed:!1}),xe(this.controller.s("graphing-calculator-narration-folder-expanded")))}}else if(e.shiftKey&&(e.altKey||e.metaKey)&&!e.ctrlKey){if(ke(e)===xa)this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-all-folders-collapsed",isCollapsed:!0}),xe(this.controller.s("graphing-calculator-narration-all-folders-collapsed"));else if(ke(e)===Kn)this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-all-folders-collapsed",isCollapsed:!1}),xe(this.controller.s("graphing-calculator-narration-all-folders-expanded"));else if(a==="H"){let s=this.controller.getSelectedItem();s&&"hidden"in s&&(this.markKeyDownAsHandled(e),this.controller.dispatch({type:"toggle-item-hidden",id:s.id}),this.controller.runAfterDispatch(()=>{s.hidden?xe(this.controller.s("graphing-calculator-narration-item-hidden")):xe(this.controller.s("graphing-calculator-narration-item-visible"))}))}else if(a==="O"){if(!this.controller.authorFeaturesAvailable())return;this.controller.dispatch({type:"set-author-mode",enabled:!this.controller.shouldShowAuthorFeatures()}),xe(this.controller.shouldShowAuthorFeatures()?this.controller.s("shared-calculator-narration-author-mode-on"):this.controller.s("shared-calculator-narration-author-mode-off")),this.markKeyDownAsHandled(e)}else if(a==="E"){if(!this.controller.isListEnabled())return;this.controller.isListVisible()?(this.controller.dispatch({type:"hide-expressions-list",focusShowIcon:!1}),xe(this.controller.s("graphing-calculator-narration-hide-expression-list"))):(this.controller.dispatch({type:"show-expressions-list",focusHideIcon:!1}),this.focusExpressionList()),this.markKeyDownAsHandled(e)}}else if(e.ctrlKey&&(e.altKey||e.metaKey)&&!e.shiftKey){if(a==="E"){if(!this.controller.isListEnabled())return;this.markKeyDownAsHandled(e),this.focusExpressionList()}else if(a==="X"){if(!this.controller.isListEnabled())return;this.markKeyDownAsHandled(e),this.controller.canUserAddExpressions()?(xe(this.controller.s("graphing-calculator-narration-add-expression")),this.controller.dispatch({type:"new-expression"})):xe(this.controller.s("graphing-calculator-narration-unable-to-add-expression"))}else if(a==="O"){if(!this.controller.isListEnabled())return;this.markKeyDownAsHandled(e),this.controller.canUserAddExpressions()&&this.controller.areNotesEnabled()?(xe(this.controller.s("graphing-calculator-narration-add-note")),this.controller.dispatch({type:"new-text"})):xe(this.controller.s("graphing-calculator-narration-unable-to-add-note"))}else if(a==="F"&&this.controller.canUserAddExpressions()&&this.controller.areFoldersEnabled())this.markKeyDownAsHandled(e),xe(this.controller.s("graphing-calculator-narration-add-folder")),this.controller.dispatch({type:"new-folder"});else if(a==="I"&&this.controller.canUserAddExpressions()&&this.controller.areImagesEnabled())this.markKeyDownAsHandled(e),this.controller.dispatch({type:"toggle-add-expression",focusOnOpen:!1}),this.controller.runAfterDispatch(()=>{let s=this.controller.findEl(".dcg-add-expression-container input[type=file]");s&&(ee(s).trigger("click"),xe(this.controller.s("graphing-calculator-narration-add-image")))});else if(a==="T")this.markKeyDownAsHandled(e),this.controller.canUserAddExpressions()?(xe(this.controller.s("graphing-calculator-narration-add-table")),this.controller.dispatch({type:"new-table"})):xe(this.controller.s("graphing-calculator-narration-unable-to-add-table"));else if(a==="R"){let s=this.controller.getSelectedItem();if(!this.controller.isListEnabled())return;this.markKeyDownAsHandled(e),this.controller.canUserAddExpressions()&&s&&this.controller.shouldShowRegressionButton(s)?(xe(this.controller.s("graphing-calculator-button-add-table-regression")),this.controller.dispatch({type:"create-table-regression",tableId:s.id,regressionType:"linear"})):xe(this.controller.s("graphing-calculator-narration-unable-to-add-table-regression"))}else if(a==="M"&&this.controller.isGeoUIActive())if(this.markKeyDownAsHandled(e),this.controller.getGeoToolbarGroupKeys().length>0){let s=this.controller.getActiveTool();if(this.controller.shouldShowMultiSelectHeader()){let l=this.controller.getAllSelectedItems().filter(c=>!this.controller.isItemReadonly(c.id)).length>0;this.controller.dispatch({type:"set-focus-location",location:{type:l?"multi-select-show-hide-icon":"multi-select-style-icon"}})}else s==="expression-edit"&&(s="selection"),this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:s}})}else xe(this.controller.s("graphing-calculator-narration-no-geometry-tools-available"));else if(a==="C"&&this.controller.isGeoUIActive())this.markKeyDownAsHandled(e),this.controller.getGeometryTokenCount()>0?this.controller.dispatch({type:"set-show-constructions-open",open:!0,setFocus:!0}):xe(this.controller.raw("Object navigator has no items."));else if(a==="G")this.markKeyDownAsHandled(e),this.controller.dispatch({type:"toggle-graph-settings",focusOnOpen:!0});else if(a==="P"){if(this.markKeyDownAsHandled(e),this.controller.isGeometry()){let s=this.controller.getFocusLocation(),l=this.controller.getValidCursorContext();if(s&&s.type==="expression"&&l&&l.type!=="empty"){this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:s.id,isFakeGraphFocus:!0}}),(r=(t=this.controller.getGrapher2d())==null?void 0:t.poiController)==null||r.keyboardAttentionManager.handleGrapherGainedFocus();return}}this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}})}else if(a==="Z"){let s=this.controller.getSelectedItem();s&&s.id&&this.controller.dispatch({type:"expression-zoom-fit",id:s.id,focusAfterTap:!1})}else if(a==="D"&&this.controller.canUserAddExpressions()){this.markKeyDownAsHandled(e);let s=!this.controller.isInEditListMode();this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:s,focusExpressionList:!0})}}else if(gG(e)&&this.controller.getQuestIsActive()){((n=this.controller.focusLocation)==null?void 0:n.type)==="quest"?(this.previousPaneFocusLocations.quest=this.controller.focusLocation,this.previousPaneFocusLocations.main?this.controller.dispatch({type:"set-focus-location",location:this.previousPaneFocusLocations.main}):this.focusExpressionList()):(this.previousPaneFocusLocations.main=this.controller.focusLocation,this.controller.dispatch({type:"set-focus-location",location:(i=this.previousPaneFocusLocations.quest)!=null?i:{type:"quest",location:"quest-pane"}})),this.markKeyDownAsHandled(e);return}else if(!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey){if(ke(e)===_u)(!document.activeElement||!wp(document.activeElement))&&e.preventDefault();else if(ke(e)===kn&&!this.controller.getOpenItemMenu()&&!this.controller.isGraphSettingsOpen()){if(this.controller.isGeoUIActive()){let s=!1,l=this.controller.getGeoModel();if(this.controller.hasAnyItemsSelected()&&(this.controller.dispatch({type:"set-none-selected"}),s=!0),l.isToolplayActive()&&(this.controller.dispatch({type:"cancel-geo-toolplay"}),xe(this.controller.s("graphing-calculator-narration-geometry-tool-cancelled")),s=!0),this.controller.isGraphPaperFocused()&&(this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:this.controller.getActiveTool()}}),s=!0),this.controller.getActiveTool()!=="selection"&&!s){this.controller.dispatch({type:"select-geo-tool",tool:"selection"});let c=this.controller.getFocusLocation();c&&c.type==="geo-basic-tool"&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:this.controller.getActiveTool()}}),s=!0}if(s){this.markKeyDownAsHandled(e);return}}this.controller.isInEditListMode()&&!this.controller.findEl(".dcg-options-menu")&&(this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!0}))}}else if(!e.metaKey&&!e.shiftKey&&e.ctrlKey===Zo&&e.altKey===!Zo){if(a==="N"){if(!this.controller.getBrailleControls())return;this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-braille-mode",mode:"nemeth"}),xe(this.controller.s("shared-calculator-narration-hotkey-braille-mode-nemeth"))}else if(a==="U"){if(!this.controller.getBrailleControls())return;this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-braille-mode",mode:"ueb"}),xe(this.controller.s("shared-calculator-narration-hotkey-braille-mode-ueb"))}else if(a==="Q"||a==="X"){if(!this.controller.getBrailleControls())return;this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-braille-mode",mode:"none"}),xe(this.controller.s("shared-calculator-narration-hotkey-braille-mode-off"))}else if(a==="6"){if(!this.controller.getBrailleControls())return;this.markKeyDownAsHandled(e);let s=!this.controller.getSixKeyInput();this.controller.dispatch({type:"set-six-key-input",useSixKeyInput:s}),xe(s?this.controller.s("shared-calculator-narration-six-key-mode-on"):this.controller.s("shared-calculator-narration-six-key-mode-off"))}else if(a==="D"){if(this.controller.isComplexModeEnabled()){xe(this.controller.s("shared-calculator-text-complex-radian-mode"));return}this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-graph-settings",degreeMode:!this.controller.getGraphSettings().degreeMode}),xe(this.controller.getGraphSettings().degreeMode?this.controller.s("graphing-calculator-button-settings-degrees"):this.controller.s("graphing-calculator-button-settings-radians"))}else if(a==="K"){if(!this.controller.isKeypadEnabled()||this.controller.inAudioTraceMode())return;this.markKeyDownAsHandled(e),this.controller.dispatch({type:"keypad/set-minimized",minimized:this.controller.isHideKeypadButtonVisible()})}else a==="M"&&((o=this.controller.toneController)==null||o.handleMuteKeyShortcut(),this.markKeyDownAsHandled(e));if(a==="+"||a==="="){this.zoom("in"),this.markKeyDownAsHandled(e);return}else if(a==="-"){this.zoom("out"),this.markKeyDownAsHandled(e);return}else if(a==="0"&&!e.shiftKey){this.setDefaultViewport(),this.markKeyDownAsHandled(e);return}}}focusExpressionList(){let e=this.controller.getSelectedItem();e?this.controller.dispatch({type:"move-focus-to-item",id:e.id}):this.controller.dispatch({type:"focus-first-expression"})}zoom(e){var t;(t=this.controller.getGrapher())==null||t.viewportController.zoom(e)}setDefaultViewport(){var e;(e=this.controller.getGrapher())==null||e.viewportController.setDefaultViewport()}};function bj(e){let{left:t,right:r,bottom:n,top:i}=e;return{left:t,right:r,bottom:n,top:i,xmin:t,xmax:r,ymin:n,ymax:i,width:Math.abs(r-t),height:Math.abs(i-n)}}var ype=0,C1=class{constructor(e,t,r,n){e||(e=document.createElement("div"));let i=document.createElement("div");i.className="dcg-dom-change-wrapper",i.style.width="100%",i.style.height="100%",e.appendChild(i),this.__id=ype++;let o=new Bp;this.graphSettings=o;for(let p in r)o.config.setProperty(p,r[p]);let a=new Im(o);this.controller=a,n&&a.dispatch({type:"ui/container-resized",size:n}),this.rootElt=i,this.view=sx.mountToNode(w1,this.rootElt,{controller:sx.const(a)});let s=new Nh(t);this.controller.setEvaluator(s),this.controller.setRootElt(this.rootElt);let l=this.controller.findEl(".dcg-grapher-2d"),c=new am(l,o,this.controller,s);if(this.controller.setGrapher2d(c),this.controller.is3dProduct()){let p=this.controller.findEl(".dcg-grapher-3d"),g=new rI(p,o,this.controller,s);this.controller.setGrapher3d(g),this.grapher=g}else this.grapher=c;this.controller.initStateStack(),s.readEvaluatorConfig=()=>({product:o.config.product,beta3d:o.config.beta3d,evaluationMode:a.isGeometry()?"geometry":this.controller.isThreeDMode()?"graphing_3d":"graphing",globalRandomSeed:o.randomSeed,includeFunctionParametersInRandomSeed:o.includeFunctionParametersInRandomSeed,degreeMode:o.degreeMode,viewState:a.getViewState(),selectedIds:a.getPropagatedSelectedIds().selected,restrictedFunctions:o.config.restrictedFunctions,forceEnableGeometryFunctions:o.config.forceEnableGeometryFunctions,distributions:o.config.distributions,pointsOfInterest:o.config.pointsOfInterest,plotSingleVariableImplicitEquations:o.config.plotSingleVariableImplicitEquations,plotImplicits:o.config.plotImplicits,plotInequalities:o.config.plotInequalities,sliders:o.config.sliders,actions:!!o.config.actions,substitutions:o.config.substitutions,intervalComprehensions:o.config.intervalComprehensions,recursion:o.config.recursion,recursionDepthLimit:o.config.recursionDepthLimit,dimensions:a.getGrapherDimensions(),logInternalErrors:o.config.logInternalErrors,complex:o.complex,customRegressions:o.config.customRegressions}),s.onEvaluatorProgressUpdate=()=>{this.controller.dispatch({type:"evaluator-progress-update"})},s.onEvaluatorResults=p=>{this.controller.dispatch({type:"on-evaluator-changes",changes:p.evaluationStates,timingData:p.timingData,graphData:p.graphData,eventUpdates:p.eventUpdates,dependencyOrder:p.dependencyOrder}),this.controller.requestRedrawGraph()},this.unsubFunc=this.controller.subscribeToChanges(()=>{this.controller.doesDOMHaveSize()&&(this.view.update(),this.grapher=this.controller.isThreeDMode()?this.controller.getGrapher3d()||this.controller.getGrapher2d():this.controller.getGrapher2d(),this.grapher.update());let p=!1;u()&&(p=!0),p&&this.controller.doesDOMHaveSize()&&(this.view.update(),this.grapher.update())});let d=new cs({pixelCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0},mathCoordinates:bj({top:0,bottom:0,left:0,right:0})});this.graphpaperBounds=d;let u=()=>{let p=!1,g=a.computeMajorLayout(),f={left:g.grapher.left,right:g.grapher.left+g.grapher.width,width:g.grapher.width,top:g.grapher.top,bottom:g.grapher.top+g.grapher.height,height:g.grapher.height},y=this.grapher.getCurrentViewport(),E=ie(R({},bj({left:y.xmin,right:y.xmax,bottom:y.ymin,top:y.ymax})),{zmin:y.zmin,zmax:y.zmax});return __dcg_shared_module_exports__.E(E,d.mathCoordinates)||(d.setProperty("mathCoordinates",E),p=!0),f.height>0&&f.width>0&&!__dcg_shared_module_exports__.E(f,d.pixelCoordinates)&&(d.setProperty("pixelCoordinates",f),p=!0),p};ee(this.rootElt).on("keydown.calculator-"+this.__id,p=>{this.grapher instanceof am&&this.grapher.audioGraph.handleKeydown(p),this.instanceHotkeys.handleKeydown(p)}),ee(document.documentElement).on("dcg-tapstart.calculator-"+this.__id,p=>{var g;let f=p.target,y=!!this.rootElt.contains(f),E=p.wasHandled("create-expression-with-keyboard"),_=!!f.classList.contains("dcg-shell");!y&&!_&&!E&&a.dispatch({type:"set-none-selected"});let w=(g=this.controller.getGrapher2d())==null?void 0:g.traceLayer;if(!p.wasHandled("do-not-clear-poi-labels")&&w&&(w.clearOpenedPOI(),this.controller.requestRedrawGraph()),a.isInEditListMode()){let v=!f.closest(".dcg-exppanel")&&!f.closest(".dcg-options-menu")&&!f.closest(".dcg-expression-top-bar")&&!f.closest(".dcg-keypad");(!y||v)&&a.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!1})}}),this.evaluator=s,this.controller.dispatch({type:"set-blank",degreeMode:!!r.degreeMode}),o.config.expressionsCollapsed&&this.setOptions({expressionsCollapsed:!0}),o.config.capExpressionSize&&this.setOptions({capExpressionSize:!0}),o.config.hasOwnProperty("pointsOfInterest")&&this.setOptions({pointsOfInterest:o.config.pointsOfInterest}),o.config.hasOwnProperty("backgroundColor")&&this.setOptions({backgroundColor:o.config.backgroundColor}),o.config.hasOwnProperty("textColor")&&this.setOptions({textColor:o.config.textColor}),o.config.observe("language",()=>{let p=this.controller.getState();this.controller.dispatch({type:"set-state",state:p})}),o.config.observe("forceLogModeRegressions",()=>{o.config.forceLogModeRegressions&&this.controller.setAllRegressionsToLogMode()}),this.instanceHotkeys=new v1(a)}setOption(e,t){this.controller.getGraphSettings().config.setProperty(e,t)}setOptions(e){let t,r=this.controller.getGraphSettings().config,n=R({},e);e.hasOwnProperty("backgroundColor")&&(__dcg_shared_module_exports__.Jd(e.backgroundColor)||(__dcg_shared_module_exports__.qe.warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)"),delete n.backgroundColor)),e.hasOwnProperty("textColor")&&(__dcg_shared_module_exports__.Jd(e.textColor)||(__dcg_shared_module_exports__.qe.warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)"),delete n.textColor)),e.hasOwnProperty("menus")&&(__dcg_shared_module_exports__.qe.warn("Deprecated option: menus. Setting settingsMenu and expressionsTopbar instead."),e.hasOwnProperty("settingsMenu")||(n.settingsMenu=!!e.menus),e.hasOwnProperty("expressionsTopbar")||(n.expressionsTopbar=!!e.menus),delete n.menus),e.hasOwnProperty("solutions")&&(__dcg_shared_module_exports__.qe.warn("Deprecated option: solutions. Setting pointsOfInterest instead."),e.hasOwnProperty("pointsOfInterest")||(n.pointsOfInterest=!!e.solutions),delete n.solutions),e.hasOwnProperty("administerSecretFolders")&&(__dcg_shared_module_exports__.qe.warn("Deprecated option: administerSecretFolders. Setting authorFeatures instead."),e.hasOwnProperty("authorFeatures")||(n.authorFeatures=!!e.administerSecretFolders),delete n.administerSecretFolders),e.hasOwnProperty("singleVariableSolutions")&&(__dcg_shared_module_exports__.qe.warn("Deprecated option: singleVariableSolutions has been removed."),delete n.singleVariableSolutions),e.graphpaper===!1&&(e.expressionsCollapsed&&(n.expressionsCollapsed=!1,__dcg_shared_module_exports__.qe.warn("Cannot set graphpaper: false with expressionsCollapsed: true. Proceeding with expressionsCollapsed: false.")),r.expressionsCollapsed&&(n.expressionsCollapsed=!1,__dcg_shared_module_exports__.qe.warn("Disabling the graphpaper with the expressions list collapsed is not supported.Setting expressionsCollapsed: false.")),e.zoomButtons&&(n.zoomButtons=!1,__dcg_shared_module_exports__.qe.warn("Cannot set graphpaper: false with zoomButtons: true. Proceeding with zoomButtons: false.")),e.showResetButtonOnGraphpaper&&(n.showResetButtonOnGraphpaper=!1,__dcg_shared_module_exports__.qe.warn("Cannot set graphpaper: false with showResetButtonOnGraphpaper: true. Proceeding with showResetButtonOnGraphpaper: false.")),r.zoomButtons&&(n.zoomButtons=!1,__dcg_shared_module_exports__.qe.warn("Disabling the graphpaper with the zoomButtons visible is not supported. Setting zoomButtons: false.")),r.showResetButtonOnGraphpaper&&(n.showResetButtonOnGraphpaper=!1,__dcg_shared_module_exports__.qe.warn("Disabling the graphpaper with the reset button visible is not supported. Setting showResetButtonOnGraphpaper: false."))),r.graphpaper===!1&&(e.expressionsCollapsed||e.zoomButtons||e.showResetButtonOnGraphpaper)&&(n.graphpaper=!0,__dcg_shared_module_exports__.qe.warn("Must have visible graphpaper to proceed. Setting graphpaper: true.")),e.lockViewport&&e.zoomButtons&&(n.zoomButtons=!1,__dcg_shared_module_exports__.qe.warn("Cannot set zoomButtons: true and lockViewport: true. Proceeding with zoomButtons: false.")),r.lockViewport&&e.zoomButtons&&(n.lockViewport=!1,__dcg_shared_module_exports__.qe.warn("Cannot set zoomButtons: true while the viewport is locked. Setting lockViewport: false.")),r.zoomButtons&&e.lockViewport&&(n.zoomButtons=!1,__dcg_shared_module_exports__.qe.warn("Cannot lock the viewport without hiding the zoom buttons. Setting zoomButtons: false."));function i(c){let{notes:d,folders:u,images:p}=c;return d===!1||u===!1||p===!1}let o=i(e),a=i(R(R({},r),e)),s=r.pasteGraphLink,l=e.pasteGraphLink;o?(l||s)&&(n.pasteGraphLink=!1,__dcg_shared_module_exports__.qe.warn("Cannot disable creating note, folder, or image expressions without disabling graph link pasting. Setting pasteGraphLink: false.")):l&&a&&(n.notes=!0,n.folders=!0,n.images=!0,__dcg_shared_module_exports__.qe.warn("Cannot enable graph link pasting while the creation of notes, folders, or images is disable. Setting notes: true, folders: true, images: true.")),e.language&&(n.language=Ld(e.language)),this.controller.isGeometry()&&(e.logScales&&(__dcg_shared_module_exports__.qe.warn("Cannot set logScales: true in the geometry calculator"),delete n.logScales),e.allowComplex&&(__dcg_shared_module_exports__.qe.warn("Cannot set allowComplex: true in the geometry calculator"),delete n.allowComplex));for(t in n)if(n.hasOwnProperty(t))switch(t){case"expressionsCollapsed":this.setOption("expressionsCollapsed",!!n.expressionsCollapsed),n.expressionsCollapsed?this.controller.dispatch({type:"hide-expressions-list",focusShowIcon:!1}):this.controller.dispatch({type:"show-expressions-list",focusHideIcon:!1});break;case"qwertyKeyboard":this.setOption("qwertyKeyboard",!!n.qwertyKeyboard),this.controller.isLetterKeypadOpen()&&this.controller.dispatch({type:"keypad/abc"});break;case"degreeMode":this.setOption("degreeMode",!!n.degreeMode),this.controller.dispatch({type:"set-graph-settings",degreeMode:!!n.degreeMode});break;case"actions":{let c=n[t];if(c===void 0||c===this.controller.getGraphSettings().config.actions)break;this.setOption(t,c),this.setState(this.getState(),{allowUndo:!0});break}case"substitutions":{let c=n[t];if(c===void 0||c===this.controller.getGraphSettings().config.substitutions)break;this.setOption(t,c),this.setState(this.getState(),{allowUndo:!0});break}case"intervalComprehensions":{let c=n[t];if(c===void 0||c===this.controller.getGraphSettings().config.intervalComprehensions)break;this.setOption(t,c),this.setState(this.getState(),{allowUndo:!0});break}case"recursion":{let c=n[t];if(c===void 0||c===this.controller.getGraphSettings().config.recursion)break;this.setOption(t,c),this.setState(this.getState(),{allowUndo:!0});break}case"product":case"beta3d":{__dcg_shared_module_exports__.qe.warn(`Cannot update '${t}' setting.`);break}case"logScales":{let c=n[t];c!==void 0&&(c===!1&&this.controller.dispatch({type:"set-graph-settings",xAxisScale:"linear",yAxisScale:"linear"}),this.setOption(t,c));break}case"graphDescription":{let c=n[t];typeof c=="string"||typeof c=="undefined"?this.setOption(t,c):__dcg_shared_module_exports__.qe.warn("Invalid graphDescription. graphDescription must be of type string or undefined.");break}case"muted":{let c=n[t];if(c===void 0||c===this.controller.getGraphSettings().config.muted)break;c?this.controller.dispatch({type:"mute-global"}):this.controller.dispatch({type:"unmute-global"});break}case"adaptivePeeling":case"advancedStyling":case"allowComplex":case"audio":case"audioTraceSimult":case"audioTraceReverseExpressions":case"authorFeatures":case"authorMode":case"autosize":case"backgroundColor":case"border":case"brailleControls":case"brailleMode":case"branding":case"cacheRenderedSvgs":case"capExpressionSize":case"clearIntoDegreeMode":case"colors":case"crossOriginSaveTest":case"customRegressions":case"decimalToFraction":case"debug3dRender":case"debugPeelLayers":case"debugPixelRatio":case"disableLighting":case"disableWorkerOnZoom":case"defaultLogModeRegressions":case"disableMouseInteractions":case"disableScrollFix":case"distributions":case"editOnWeb":case"enableTabindex":case"expressions":case"expressionsTopbar":case"folders":case"fontSize":case"forceEnableGeometryFunctions":case"forceLogModeRegressions":case"functionDefinition":case"ghostMode":case"graphpaper":case"hideGeoUI":case"imageUploadCallback":case"images":case"invertedColors":case"keypad":case"language":case"links":case"lockViewport":case"nativeOnscreenKeypad":case"notes":case"onlyTraceSelected":case"orientationButtons":case"pasteGraphLink":case"pasteGraphLinkCallback":case"pasteTableData":case"pauseWhenOffscreen":case"peelFloatTexture":case"peelUpsample":case"debugScale":case"perspectiveDistortion":case"plaidMode":case"plotImplicits":case"plotInequalities":case"plotSingleVariableImplicitEquations":case"pointsOfInterest":case"projectorMode":case"restrictedFunctions":case"settingsMenu":case"showHamburger":case"showKeyboardShortcutsInTooltips":case"showPerformanceMeter":case"showResetButtonOnGraphpaper":case"sixKeyInput":case"sliders":case"tableRegressions":case"textColor":case"tone":case"trace":case"translucentSurfaces":case"transparentBackground":case"translucentOpacity":case"wireframe":case"zoomButtons":case"recursionDepthLimit":case"debugProgressUpdates":case"logInternalErrors":case"reflectionArc":case"zoomFit":{let c=n[t];c!==void 0&&this.setOption(t,c);break}default:return t}}setViewport(e){let t=new Br(e.xmin,e.xmax,e.ymin,e.ymax,e.zmin,e.zmax);this.grapher.viewportController.setViewport(t),this.controller.dispatch({type:"commit-user-requested-viewport",viewport:t})}resize(e){e&&this.controller.dispatch({type:"ui/container-resized",size:e})}destroy(){var e;ee(document.documentElement).off(".calculator-"+this.__id),ee(this.rootElt).off(".calculator-"+this.__id),this.unsubFunc(),this.graphSettings.unobserveAll(),this.controller&&((e=this.controller.toneController)==null||e.unload()),this.evaluator&&this.evaluator.destroy(),this.grapher&&this.grapher.remove(),sx.unmountFromNode(this.rootElt),this.rootElt.remove()}tick(e,t){t||(this.controller.handleTick(e),this.controller.updateRenderShellsAfterDispatch()),this.evaluator.tick(),this.grapher&&this.grapher.tick(e)}getState(e){return this.controller.getState(e)}setBlank(e){this.controller.dispatch({type:"set-blank",opts:e||{}})}setState(e,t){this.controller.dispatch({type:"set-state",state:e,opts:t||{}})}};function xpe(e){function t(r){requestAnimationFrame(t),e(r)}requestAnimationFrame(t)}function wpe(e){function t(){setTimeout(t,lx),e(Date.now())}setTimeout(t,lx)}var yj=Du("timeoutLoop"),lx=0;typeof yj=="string"&&(lx=parseFloat(yj),isNaN(lx)&&(lx=1e3/60));var xj=lx>0?wpe:xpe,kR=new Kl;xj(e=>{kR.triggerEvent("tick",e)});var DR=0;function Am(e){return DR+=1,kR.observeEvent("tick."+DR,(t,r)=>{e(r)}),DR}function Mm(e){kR.unobserveEvent("tick."+e)}var wj=Du("nworkers"),vj=4;wj&&(vj=parseInt(wj,10));var cx=new ax(vj);function Cj(e,t){let r={},n={};for(let i in e)FP(i)?r[i]=e[i]:kK(i)?n[i]=e[i]:t||__dcg_shared_module_exports__.qe.warn("Unrecognized setting: "+i+". Ignoring.");return{configOptions:r,settingsOptions:n}}function Sj(e,t){let r={};return t.hasOwnProperty("x")&&(r.x=e.mapX(t.x)),t.hasOwnProperty("y")&&(r.y=e.mapY(t.y)),r}var Tj=[],IR=!1,Ej=new Map;function vpe(e){let t=Ej.get(e);return t||(t=new e,Ej.set(e,t)),t}function Dj(e){if(!e||IR)return;let t;for(;(t=Tj.shift())&&t.api._destroyed;);if(!t)return;let r=t;IR=!0;let{options:n,mathBounds:i,state:o,callback:a,api:s}=r,l=vpe(e),c=s._calc.controller.getGraphSettings().config,d={};Object.keys(c).forEach(y=>{FP(y)&&y!=="product"&&y!=="beta3d"&&y!=="projectorMode"&&(d[y]=c[y])}),l.updateSettings(d),l.setState(o),l.setMathBounds(i);let u=l._calc.evaluator,p=()=>{l._calc.grapher.asyncScreenshot(n,y=>{IR=!1,Dj(e),a(y)})},g=r.api._calc.controller,f=Am(()=>{g.areAnyImagesLoading()||(Mm(f),u.notifyWhenSynced(p))})}var lu=class extends cs{constructor(e,t,r){super(),this._eventBus=new Kl,this._destroyed=!1,this.isOffscreen=!1;let n=Cj(t||{},!0),i=DD(n.configOptions),o=n.settingsOptions;this._calc=new C1(e,cx,i),this.controller=this._calc.controller,this.controller.onEventsEmitted=a=>{let s=this.controller.getSelectedItem();this.setProperty("isAnyExpressionSelected",!!s),this.setProperty("selectedExpressionId",s?s.id:void 0),this.setProperty("expressionAnalysis",this.controller.getExpressionAnalysis());let l=Fe.getFocusedMathquill();this.setProperty("focusedMathQuill",l?new TD(l):void 0);for(let c in a){if(!a.hasOwnProperty(c))continue;let d=a[c];d&&this._eventBus.triggerEvent(c,d)}},this._calc.graphpaperBounds.observeAndSync("mathCoordinates",this._syncGraphpaperBounds.bind(this)),this._calc.graphpaperBounds.observeAndSync("pixelCoordinates",this._syncGraphpaperBounds.bind(this)),this.colors=this.controller.getColors(),this._initGraphSettings(),this.updateSettings(o),this._sharedClockBusToken=Am(a=>this.withControllerInAPIMode(()=>{let s=this._calc.grapher.settings.config.pauseWhenOffscreen&&this.isOffscreen;this._calc.tick(a,s)})),this.domChangeDetector=new Yg(e,a=>this.withControllerInAPIMode(()=>{switch(this.isOffscreen=a.isOffscreen,a.type){case"offscreen-noop":break;case"added":this._calc.resize(a.size);break;case"removed":break;case"resized":this._calc.resize(a.size);break}})),i.autosize?this.domChangeDetector.startWatching():this.domChangeDetector.checkForChanges(),typeof r=="function"&&r(this)}destroy(){this.controller.onEventsEmitted=function(){},this._calc.destroy(),Mm(this._sharedClockBusToken),this.domChangeDetector.destroy();function e(n){__dcg_shared_module_exports__.qe.warn("You've destroyed this API instance. You can no longer call ."+n+"()")}let t={},r=this;for(;r;)Object.getOwnPropertyNames(r).forEach(n=>t[n]=!0),r=Object.getPrototypeOf(r);for(let n in t)typeof this[n]=="function"?this[n]=e.bind(this,n):this.hasOwnProperty(n)&&delete this[n];this.destroy=function(){},this._destroyed=!0}withHistoryReplacement(e){try{this.controller.pushWithHistoryReplacement(),e()}finally{this.controller.popWithHistoryReplacement()}}withControllerInAPIMode(e){try{return this.controller.pushAPIMethodCall(),e()}finally{this.controller.popAPIMethodCall()}}_syncGraphpaperBounds(){return this.withControllerInAPIMode(()=>{this.controller.runAfterDispatch(()=>{this.setProperty("graphpaperBounds",{mathCoordinates:this._calc.graphpaperBounds.mathCoordinates,pixelCoordinates:this._calc.graphpaperBounds.pixelCoordinates})})})}observeEvent(e,t){return this._eventBus.observeEvent(e,t)}unobserveEvent(e){this._eventBus.unobserveEvent(e)}_initGraphSettings(){return this.withControllerInAPIMode(()=>{let e=new cs;this.settings=this.graphSettings=e,DK.forEach(t=>{this._calc.grapher.settings.observeAndSync(t,()=>{this.controller.runAfterDispatch(()=>{e.setProperty(t,this._calc.grapher.settings[t])})})}),IK.forEach(t=>{this._calc.grapher.settings.config.observeAndSync(t,()=>{this.controller.runAfterDispatch(()=>{e.setProperty(t,this._calc.grapher.settings.config[t])})})})})}updateSettings(e){return this.withControllerInAPIMode(()=>{let t=Cj(e,!1),r=t.configOptions,n=t.settingsOptions;__dcg_shared_module_exports__.F(r)||this._calc.setOptions(r),__dcg_shared_module_exports__.F(n)||this.controller.dispatch(R({type:"set-graph-settings"},this.controller.getGraphSettings().validateSettings(n))),this.notifyControllerOfAPICall()})}setGraphSettings(e){return this.withControllerInAPIMode(()=>{__dcg_shared_module_exports__.qe.warn("As of API v0.8 the 'setGraphSettings' method is deprecated and has been renamed 'updateSettings.'"),this.updateSettings(e),this.setGraphSettings=this.updateSettings,this.notifyControllerOfAPICall()})}setDefaultState(e){return this.withControllerInAPIMode(()=>{this._calc.grapher.settings.setProperty("defaultState",e),this.notifyControllerOfAPICall()})}mathToPixels(e){return this.withControllerInAPIMode(()=>{let t=__dcg_shared_module_exports__.jd.fromRects(this.graphpaperBounds.mathCoordinates,this.graphpaperBounds.pixelCoordinates,{xAxisScale:this._calc.grapher.settings.xAxisScale,yAxisScale:this._calc.grapher.settings.yAxisScale});return Sj(t,e)})}pixelsToMath(e){return this.withControllerInAPIMode(()=>{let t=__dcg_shared_module_exports__.jd.fromRects(this.graphpaperBounds.mathCoordinates,this.graphpaperBounds.pixelCoordinates,{xAxisScale:this._calc.grapher.settings.xAxisScale,yAxisScale:this._calc.grapher.settings.yAxisScale}).inverse();return Sj(t,e)})}notifyControllerOfAPICall(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"render"})})}setExpression(e){return this.withControllerInAPIMode(()=>{let t=this.controller.getItemModel(e.id),r=t&&t.type,n=uD(e,r,this.controller);if(n)if(r)this.controller.dispatch({type:"set-expression-properties-from-api",id:n.id,properties:n});else{if(n.type==="image")return;this.controller.dispatch({type:"add-item-to-end-from-api",state:n})}})}setExpressions(e){return this.withControllerInAPIMode(()=>{e.forEach(this.setExpression.bind(this))})}removeExpression(e){return this.withControllerInAPIMode(()=>{let t=e.id.toString();this.controller.dispatch({type:"remove-item-by-id",id:t})})}removeExpressions(e){return this.withControllerInAPIMode(()=>{e.forEach(this.removeExpression.bind(this))})}removeSelected(){return this.withControllerInAPIMode(()=>{let e=this.controller.getSelectedItem();if(!e)return;let{id:t}=e;return this.controller.dispatch({type:"remove-item-by-id",id:t}),t})}setMathBounds(e){return this.withControllerInAPIMode(()=>{var t,r,n,i;let o=e,a=(t=o.xmin)!=null?t:o.left,s=(r=o.xmax)!=null?r:o.right,l=(n=o.ymin)!=null?n:o.bottom,c=(i=o.ymax)!=null?i:o.top,{zmin:d,zmax:u}=o,p,g;d===void 0&&u===void 0?(p=!0,g=!1):d===void 0||u===void 0?(p=!1,g=!0):(p=d<u,g=!0),a<s&&l<c&&p?(this._calc.setViewport({xmin:a,xmax:s,ymin:l,ymax:c,zmin:d,zmax:u}),this._calc.controller.unmarkLastChangedAxis(),this._calc.controller.markSquareAxesAfterUserEditedViewport()):__dcg_shared_module_exports__.qe.warn("Invalid bounds argument. "+g?"Expected a bounds object with bounds.xmin < bounds.xmax, bounds.ymin < bounds.ymax, and bounds.zmin < bounds.zmax. ":"Expected a bounds object with bounds.xmin < bounds.xmax, and bounds.ymin < bounds.ymax. Got "+JSON.stringify(e)),this.notifyControllerOfAPICall()})}setViewport(e){let[t,r,n,i]=e;return this.withControllerInAPIMode(()=>{e.length==4&&e[1]>e[0]&&e[3]>e[2]?(this._calc.setViewport({xmin:t,xmax:r,ymin:n,ymax:i}),this._calc.controller.markSquareAxesAfterUserEditedViewport()):__dcg_shared_module_exports__.qe.warn("Invalid viewport.  Expected [xmin, xmax, ymin, ymax].  Got "+e),this.notifyControllerOfAPICall()})}resize(){return this.withControllerInAPIMode(()=>{this.domChangeDetector.checkForChanges()})}getState(e){return this.withControllerInAPIMode(()=>this.controller.getState(e))}getExpressions(){return this.withControllerInAPIMode(()=>this.getState({stripDefaults:!1}).expressions.list.map(pD))}setBlank(e){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"set-blank",opts:e||{}})})}setState(e,t){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"set-state",state:e,opts:t||{}})})}undo(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"undo"})})}redo(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"redo"})})}clearHistory(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"clear-undoredo-history"})})}getHistory(){return this.withControllerInAPIMode(()=>this.controller.getHistory())}restoreHistory(e){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"restore-history",history:e})})}newRandomSeed(){return this.withControllerInAPIMode(()=>{this.updateSettings({randomSeed:rd()})})}screenshot(e){return this.withControllerInAPIMode(()=>(e||(e={}),e=this._validateBrailleScreenshotOptions(e),this._calc.grapher.screenshot(e)))}_getMathAspectRatio(){return this.withControllerInAPIMode(()=>{let e=this.graphpaperBounds.mathCoordinates,t=this._calc.grapher.getProjection().pixelCoordinates,r=t.right-t.left,n=t.bottom-t.top,i=e.width/r,o=e.height/n;return i/o})}isProjectionUniform(){return this.withControllerInAPIMode(()=>!!this._calc.grapher.getProjection().settings.squareAxes)}_validateBrailleScreenshotOptions(e){return this.withControllerInAPIMode(()=>{e=__dcg_shared_module_exports__.Jc(e);let t=e.braille;if(t){let r=t.embosserModel;if(!r)return __dcg_shared_module_exports__.qe.warn("Screenshot braille options requires an embosser model to be specified. "),__dcg_shared_module_exports__.qe.warn("Continuing with non-braille screenshot."),delete e.braille,e;if(r==="etc"&&(t.embosserModel="etc11"),r==="vpmax"&&(t.embosserModel="vpmax11"),t.embosserModel!=="etc8"&&t.embosserModel!=="etc11"&&t.embosserModel!=="vpmax8"&&t.embosserModel!=="vpmax11")return __dcg_shared_module_exports__.qe.warn('Unknown screenshot braille embosser model. Valid models are "etc" and "vpmax".'),__dcg_shared_module_exports__.qe.warn("Continuing with non-braille screenshot."),delete e.braille,e;t.brailleMode!=="nemeth"&&t.brailleMode!=="ueb"&&(__dcg_shared_module_exports__.qe.warn("Screenshot options braille.brailleMode must be nemeth or ueb. Proceeding with nemeth."),t.brailleMode="nemeth"),e.width&&(__dcg_shared_module_exports__.qe.warn("Screenshot width option is ignored when exporting Braille."),delete e.width),e.height&&(__dcg_shared_module_exports__.qe.warn("Screenshot height option is ignored when exporting Braille."),delete e.height),e.targetPixelRatio&&(__dcg_shared_module_exports__.qe.warn("Screenshot targetPixelRatio option is ignored when exporting Braille."),delete e.targetPixelRatio),e.preserveAxisNumbers&&(__dcg_shared_module_exports__.qe.warn("Screenshot preserveAxisNumbers option is ignored when exporting Braille."),delete e.preserveAxisNumbers)}return e})}_validateAsyncScreenshotOpts(e){return this.withControllerInAPIMode(()=>{e=__dcg_shared_module_exports__.Jc(e);let t=e.mode||(this.controller.getGraphSettings().squareAxes?"preserveX":"stretch"),r=e.width||e.height||this.graphpaperBounds.pixelCoordinates.width,n=e.height||e.width||this.graphpaperBounds.pixelCoordinates.height,i=e.targetPixelRatio||1;i<1&&(i=1);let o=e.preserveAxisNumbers;e.hasOwnProperty("format")||(e.svg?(e.format="svg",delete e.svg):e.format="png");let a=e.mathBounds||{},s=this._getMathAspectRatio(),l=this.graphpaperBounds.pixelCoordinates.width/this.graphpaperBounds.pixelCoordinates.height,c=_K({mode:t,width:r,height:n,currentBounds:this.graphpaperBounds.mathCoordinates,graphpaperAspectRatio:l,mathAspectRatio:s,mathBounds:a});return{opts:ie(R({},e),{width:r,height:n,targetPixelRatio:i,preserveAxisNumbers:o}),mathBounds:c}})}asyncScreenshot(...e){var t;if(!e.length){__dcg_shared_module_exports__.qe.warn("asyncScreenshot expects a callback");return}let r,n;if(e.length===1)if(typeof e[0]!="function"){__dcg_shared_module_exports__.qe.warn("asyncScreenshot expects a callback");return}else n=e[0],r={};else n=e[1],r=(t=e[0])!=null?t:{};return this.withControllerInAPIMode(()=>{r=this._validateBrailleScreenshotOptions(r);let{opts:i,mathBounds:o}=this._validateAsyncScreenshotOpts(r);Tj.push({api:this,options:i,mathBounds:o,state:this.getState(),callback:n}),Dj(this.constructor)})}setOptions(e){return this.withControllerInAPIMode(()=>{let t=this._calc.setOptions(e);return this.notifyControllerOfAPICall(),t})}focusFirstExpression(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"focus-first-expression"})})}openKeypad(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"keypad/set-minimized",minimized:!1})})}HelperExpression(e){return this.withControllerInAPIMode(()=>{let t=(e==null?void 0:e.latex)||"",r=new cs({latex:t});return this.controller.dispatch({type:"add-helper-expression",state:{type:"helper-expression",id:this.controller.generateId(),latex:t,proxy:r}}),r})}getHelperExpressions(){return this.withControllerInAPIMode(()=>this.controller.getHelperExpressions())}},dx=class extends lu{constructor(e,t,r){super(e,ie(R({},t),{product:"graphing-3d"}),r),this.mathToPixels=void 0,this.pixelsToMath=void 0}asyncScreenshot(){throw new Error("asyncScreenshot() is currently unimplemented in 3D. Use screenshot() instead.")}};mg(),Ss();var S1=class{constructor({evaluationMode:e,additionalFunctions:t,disableParentheses:r,functionDefinition:n,replaceRoundWithReciprocal:i,workerPool:o}){this._evaluations={},this._nextObjectId=0,this.store=new Nc({expressions:{1:{id:"1",latex:"",braille:"",type:"latex",displayAsFraction:!1}},order:["1"],settings:{degreeMode:!1,complex:!1},ui:{focus:void 0}}),this.evaluationMode=e,this.additionalFunctions=t,this.disableParentheses=r,this.functionDefinition=n,this.replaceRoundWithReciprocal=i,this.workerPool=o,this._setupEvaluator(),this.clear(),this._sharedClockBusToken=Am(()=>{this._evaluator.tick()})}isSingleExpression(){return this.evaluationMode==="singleExpressionScientific"||this.evaluationMode==="singleExpressionFourFunction"}destroy(){Mm(this._sharedClockBusToken)}generateObjectId(){return(this._nextObjectId++).toString()}updateNextObjectId(){let e=this.store.getState().order;this._nextObjectId=0;let t=/^[0-9]+$/;for(let r of e)if(t.test(r)){let n=parseInt(r,10);n>=this._nextObjectId&&(this._nextObjectId=n+1)}}clearShouldDebounceUndoRedo(){this._shouldDebounceUndoRedo=!1}markShouldDebounceUndoRedo(){this._shouldDebounceUndoRedo=!0}getShouldDebounceUndoRedo(){return this._shouldDebounceUndoRedo}clearCachedBrailleValues(){for(let e of this.getExpressionOrder())this.store.set(["expressions",e,"braille"],"")}getState(){return this.store.getState()}getPersistedState(){let{expressions:e,order:t,settings:r}=this.getState();return{expressions:{list:t.map(n=>{let i=e[n];return{id:i.id,latex:i.latex,displayAsFraction:i.displayAsFraction}})},settings:r}}setState(e){this.store.set(e),this._updateIndexes(),this.updateNextObjectId()}setStateFromAPI(e){let t=[],r={},{settings:n}=e;n.complex&&n.degreeMode&&(n=ie(R({},n),{degreeMode:!1})),e.expressions.list.forEach(({id:i,latex:o,displayAsFraction:a})=>{t.push(i),r[i]={id:i,latex:o,displayAsFraction:a,braille:"",type:"latex"}}),this.setState({expressions:r,order:t,settings:n,ui:{focus:void 0}})}canClear(){if(this.getNumberOfExpressions()>1)return!0;let e=this.getExpressionOrder()[0];return this.getExpressionLatex(e)!==""}clear(){this.setState({expressions:{1:{id:"1",type:"latex",latex:"",braille:"",displayAsFraction:!1}},ui:{focus:void 0},order:["1"],settings:this.getState().settings})}getExpressionOrder(){return this.store.getState().order}getNumberOfExpressions(){return this.getExpressionOrder().length}getExpressionById(e){return this.getState().expressions[e]}getExpressionIndex(e){return this._indexes[e]}_getExpressionByIndex(e){let t=this.getExpressionOrder()[e];return this.getExpressionById(t)}_updateIndexes(){this._indexes={};let e=0;for(let t of this.getExpressionOrder())this._indexes[t]=e,e+=1;this._evaluate()}_usesAnsById(e){return this.getExpressionById(e).latex.indexOf("\\operatorname{ans}")!==-1}_getPreviousExpById(e){let t=this.getExpressionIndex(e);return this._getExpressionByIndex(t-1)}createBlankAfterId(e){if(this.isSingleExpression()||!this.getExpressionById(e).latex)return;let t=this.getExpressionIndex(e),r=this.generateObjectId();this.store.shallowMutate("order",n=>{n.splice(t+1,0,r)}),this.store.shallowMutate("expressions",n=>{n[r]={id:r,latex:"",braille:"",type:"latex",displayAsFraction:!1}}),this._updateIndexes(),this.setFocusedById(r,!0)}conditionallyCopyPrevious(e){let t=this._getPreviousExpById(e),r=this.getExpressionById(e);t!=null&&r.latex===""&&this._usesAnsById(t.id)&&this.setLatexById(e,t.latex)}backspaceAtFrontOfId(e){if(this.getExpressionById(e).latex!==""||this.getNumberOfExpressions()===1)return;let t=this.getExpressionIndex(e);this.store.shallowMutate("order",r=>{r.splice(t,1)}),this.store.shallowMutate("expressions",r=>{delete r[e]}),this._updateIndexes(),this._setFocusedByIndex(Math.max(t-1,0),!0)}setLatexById(e,t){this.store.set(["expressions",e,"latex"],t),this.store.set(["expressions",e,"braille"],""),t===""&&this.setFractionEvaluation(e,!1),this._evaluate()}setLatexAndBrailleById(e,t,r){this.store.set(["expressions",e,"latex"],t),this.store.set(["expressions",e,"braille"],r),t===""&&this.setFractionEvaluation(e,!1),this._evaluate()}setFractionEvaluation(e,t){this.store.set(["expressions",e,"displayAsFraction"],t)}setLatexOfFocusedExpression(e){let t=this.getFocusedExpressionId();t&&this.setLatexById(t,e)}isExpressionFocused(e){return this.getFocusedExpressionId()===e}getExpressionLatex(e){return this.getExpressionById(e).latex}getExpressionError(e){var t;return(t=this._evaluations[e])==null?void 0:t.error}getExpressionValue(e){var t,r;return(r=(t=this._evaluations[e])==null?void 0:t.typedConstantValue)==null?void 0:r.value}getExpressionTypedConstantValue(e){var t;return(t=this._evaluations[e])==null?void 0:t.typedConstantValue}getExpressionAns(e){var t,r;let n=(t=this._evaluations[e])==null?void 0:t.ansId;return n!==void 0?(r=this._evaluations[n])==null?void 0:r.typedConstantValue:n}getExpressionAnsId(e){var t;return(t=this._evaluations[e])==null?void 0:t.ansId}shouldShowEvaluationForExpression(e){let t=this._evaluations[e];return t?t.showEvaluation:!1}isRationalizableConstant(e){let t=this._evaluations[e];return t?t.isRationalizableConstant:!1}canDisplayEvaluationAsFraction(e){let t=this.getExpressionValue(e);return!t||typeof t!="number"?!1:__dcg_shared_module_exports__.ia(t)}isEvaluationList(e){var t;return __dcg_shared_module_exports__.wb((t=this.getExpressionTypedConstantValue(e))==null?void 0:t.valueType)}_setFocusedByIndex(e,t){let r=this._getExpressionByIndex(e),n=this.store.getState().ui.focus,i=t?{type:"latex-expression",id:r.id}:void 0;if(!__dcg_shared_module_exports__.E(n,i)){if(n){let o=n.id;this.store.deepMutate("expressions",a=>{let s=a[o];s&&(s.braille="")})}!t&&this.getFocusedExpressionId()!==r.id||this.store.shallowMutate("ui",o=>{o.focus=i})}}setFocusedById(e,t){let r=this.getExpressionIndex(e);this._setFocusedByIndex(r,t)}focusPrevById(e){let t=this.getExpressionIndex(e)-1;t>=0&&this._setFocusedByIndex(t,!0)}focusNextById(e){let t=this.getExpressionIndex(e)+1;t<this.getNumberOfExpressions()?this._setFocusedByIndex(t,!0):this.createAtEnd()}getFocusedExpression(){let e=this.getFocusedExpressionId();if(e)return this.getExpressionById(e)}getFocusedExpressionId(){let e=this.getState().ui.focus;return e&&e.id}clearFocusedExpression(){let e=this.getFocusedExpression();e&&this.setLatexById(e.id,"")}shouldShowClear(){if(this.getNumberOfExpressions()===1)return!1;let e=this.getFocusedExpression();return!!e&&!!e.latex}getLastExpression(){return this._getExpressionByIndex(this.getNumberOfExpressions()-1)}isLastExpressionEmpty(){return!!this.getLastExpression().latex}createAtEnd(){this.createBlankAfterId(this.getLastExpression().id)}focusLastExpression(){this._setFocusedByIndex(this.getNumberOfExpressions()-1,!0)}focusFirstExpression(){this._setFocusedByIndex(0,!0)}getDegreeMode(){return this.getState().settings.degreeMode}setDegreeMode(e){this.getComplexMode()||(this.store.set(["settings","degreeMode"],e),this._evaluate())}getComplexMode(){return!!this.getState().settings.complex}setComplexMode(e){this.store.set(["settings","complex"],e),e&&this.store.set(["settings","degreeMode"],!1),this._evaluate()}_cleanupLatex(e){return e=__dcg_shared_module_exports__.oa(e),e.substr(e.length-1)==="="&&(e=e.substr(0,e.length-1)),e}_evaluate(){this._evaluator.clearStatementsAndStartCompleteState(),this.getExpressionOrder().forEach(e=>this._evaluator.addStatement({id:e,index:this.getExpressionIndex(e),latex:this._cleanupLatex(this.getExpressionLatex(e)),shouldGraph:!1,type:"statement"}))}getAdditionalFunctions(){return this.getComplexMode()?[...this.additionalFunctions,...__dcg_shared_module_exports__.Hb]:this.additionalFunctions}_setupEvaluator(){this._evaluator=new Nh(this.workerPool),this._evaluator.readEvaluatorConfig=()=>({degreeMode:this.getDegreeMode(),evaluationMode:this.evaluationMode,additionalFunctions:this.getAdditionalFunctions(),disableParentheses:this.disableParentheses,functionDefinition:this.functionDefinition,replaceRoundWithReciprocal:this.replaceRoundWithReciprocal,complex:this.getComplexMode(),actions:!1}),this._evaluator.onEvaluatorResults=e=>{var t;let r=e.evaluationStates;this._evaluations={};for(let i in r){let o=r[i];if(!this.getExpressionById(i))continue;let{value:a,valueType:s}=(t=o.typed_constant_value)!=null?t:{},l=!o.is_evaluable&&s===__dcg_shared_module_exports__.wa&&__dcg_shared_module_exports__.ia(a);this._evaluations[i]={error:o.error,ansId:void 0,typedConstantValue:o.typed_constant_value,showEvaluation:o.is_evaluable||l||s===__dcg_shared_module_exports__.Ba,isRationalizableConstant:l}}let n;for(let i of this.getExpressionOrder()){let o=this._evaluations[i];n&&o&&(o.ansId=n),n=i}typeof this.onEvaluationUpdate=="function"&&this.onEvaluationUpdate()}}reloadState(){this.setState(this.getState())}getFunctionDefinition(){return!!this.functionDefinition}enableFunctionDefinition(){this.functionDefinition=!0,this.reloadState()}disableFunctionDefinition(){this.functionDefinition=!1,this.reloadState()}getReplaceRoundWithReciprocal(){return!!this.replaceRoundWithReciprocal}enableReplaceRoundWithReciprocal(){this.replaceRoundWithReciprocal=!0,this.reloadState()}disableReplaceRoundWithReciprocal(){this.replaceRoundWithReciprocal=!1,this.reloadState()}},E1=class{constructor(e,t){this.keyboardMode="main",this.fontSize=16,this.invertedColors=!1,this.backgroundColor="",this.textColor="",this.projectorMode=!1,this.capExpressionSize=!1,this.decimalToFraction=!0,this.settingsMenu=!0,this.settingsMenuOpen=!1,this.language="en",this.brailleMode="none",this.sixKeyInput=!1,this.brailleControls=!0,this.brailleExpressionDownload=!0,this.replaceCommaWith10Exp=!1,this.typingAsteriskWritesTimesSymbol=!1,this.stateStack=new su,this.dispatcher=new U0,this.s=Ip(()=>this.language),this.raw=Gs,this.dispatch=r=>{r.type,this.dispatcher.dispatch(r);let n;for(;n=this._queuedCallbacks.shift();)n()},this._queuedCallbacks=[],this.logEvent=r=>{},this.stateStack=new su,this.dispatcher=new U0,this.options=e,this.model=new S1({evaluationMode:this.options.evaluationMode,additionalFunctions:this.options.additionalFunctions,disableParentheses:this.options.disableParentheses,functionDefinition:this.options.functionDefinition,replaceRoundWithReciprocal:this.options.replaceRoundWithReciprocal,workerPool:t.workerPool}),this.model.setComplexMode(e.complex),this.model.setDegreeMode(e.degreeMode),this.setLanguage(e.language),this.setBrailleMode(e.brailleMode),this.setSixKeyInput(e.sixKeyInput),this.setBrailleControls(e.brailleControls),this.setBrailleExpressionDownload(e.brailleExpressionDownload),this.setReplaceCommaWith10Exp(e.replaceCommaWith10Exp),this.setReplaceRoundWithReciprocal(e.replaceRoundWithReciprocal),this.setTypingAsteriskWritesTimesSymbol(e.typingAsteriskWritesTimesSymbol),this.setProjectorMode(e.projectorMode),this.setCapExpressionSize(e.capExpressionSize),this.setDecimalToFraction(e.decimalToFraction),this.invertedColors=e.invertedColors,this.backgroundColor=e.backgroundColor,this.textColor=e.textColor,this.settingsMenu=e.settingsMenu,this.model.onEvaluationUpdate=()=>this.dispatch({type:"render"}),this.settingsProxy=t.settingsProxy,this.syncPublicSettings(),this.hookUpDispatcher(),this.containerSize={width:0,height:0}}runAfterDispatch(e){this._queuedCallbacks.push(e)}enqueueEvent(e){this.runAfterDispatch(()=>{this.onEventEmitted&&this.onEventEmitted(e)})}getSettingsMenu(){return this.settingsMenu}getBrailleMode(){return this.brailleMode}renderAsBraille(){return this.brailleMode!=="none"}setBrailleMode(e){this.brailleMode=e}getSixKeyInput(){return this.sixKeyInput}setSixKeyInput(e){this.sixKeyInput=e}getBrailleControls(){return this.brailleControls}setBrailleControls(e){this.brailleControls=e}getBrailleExpressionDownload(){return this.brailleExpressionDownload}setBrailleExpressionDownload(e){this.brailleExpressionDownload=e}getRestrictedEditing(){return this.options.restrictedEditing}getKeyboardMode(){return this.keyboardMode}getFontSize(){return this.fontSize}getInvertedColors(){return this.invertedColors}hasBackgroundColor(){return this.getBackgroundColor()!=="#ffffff"}getBackgroundColor(){return __dcg_shared_module_exports__.Id(this.backgroundColor||"#fff")}hasTextColor(){return this.getTextColor()!=="#000000"}getTextColor(){return __dcg_shared_module_exports__.Id(this.textColor||"#000")}getAdditionalFunctions(){return this.options.additionalFunctions}getDisableParentheses(){return this.options.disableParentheses}getTypingSlashWritesDivisionSymbol(){return this.options.typingSlashWritesDivisionSymbol}setTypingAsteriskWritesTimesSymbol(e){this.typingAsteriskWritesTimesSymbol=e}getTypingAsteriskWritesTimesSymbol(){return this.typingAsteriskWritesTimesSymbol}setProjectorMode(e){this.projectorMode=e}isProjectorMode(){return this.projectorMode}getReplaceCommaWith10Exp(){return this.replaceCommaWith10Exp}setReplaceCommaWith10Exp(e){this.replaceCommaWith10Exp=e}getReplaceRoundWithReciprocal(){return this.model.getReplaceRoundWithReciprocal()}setReplaceRoundWithReciprocal(e){e?this.model.enableReplaceRoundWithReciprocal():this.model.disableReplaceRoundWithReciprocal()}setCapExpressionSize(e){this.capExpressionSize=e}getCapExpressionSize(){return this.capExpressionSize}setDecimalToFraction(e){this.decimalToFraction=e}setLanguage(e){e!=="en"&&!_T(e)?__dcg_shared_module_exports__.qe.warn(`Translation for '${e}' isn't currently available. Using '${this.language}' instead.`):this.language=e}getLanguage(){return this.language}getDecimalToFraction(){return this.decimalToFraction}isScientificCalc(){let e=this.options.evaluationMode;return e==="scientific"||e==="singleExpressionScientific"}isFourFunctionCalc(){return this.options.evaluationMode==="fourFunction"||this.options.evaluationMode==="singleExpressionFourFunction"}getAllowLinks(){return this.options.links}canUndo(){return this.stateStack.canUndo()}canRedo(){return this.stateStack.canRedo()}undo(e){if(!this.canUndo())return;this.stateStack.undo();let t=this.stateStack.getState();e.restoreFocus||(t=ie(R({},t),{ui:{focus:void 0}})),this.model.setState(t),this.enqueueEvent("change")}redo(e){if(!this.canRedo())return;this.stateStack.redo();let t=this.stateStack.getState();e.restoreFocus||(t=ie(R({},t),{ui:{focus:void 0}})),this.model.setState(t),this.enqueueEvent("change")}clearHistory(){this.stateStack.clear()}canBackspace(){let e=this.model.getFocusedExpression();return e&&(e.latex.length>0||this.model.getNumberOfExpressions()>1)}focusLastExpression(){this.model.focusLastExpression()}shouldRender(){return this.containerSize.width>0&&this.containerSize.height>0}canClear(){return this.model.canClear()}shouldShowClear(){return this.model.shouldShowClear()}enableSettingsMenu(){this.settingsMenu=!0}disableSettingsMenu(){this.closeSettingsMenu(),this.settingsMenu=!1}closeSettingsMenu(){this.settingsMenuOpen=!1}toggleSettingsMenu(){this.settingsMenuOpen=!this.settingsMenuOpen}isSettingsMenuOpen(){return this.settingsMenuOpen}isLastExpressionEmpty(){return this.model.isLastExpressionEmpty()}createAtEnd(){this.model.createAtEnd()}clearFocusedExpression(){this.model.clearFocusedExpression()}setLatexById(e,t){this.model.setLatexById(e,t)}setLatexAndBrailleById(e,t,r){this.model.setLatexAndBrailleById(e,t,r)}setLatexOfFocusedExpression(e){this.model.setLatexOfFocusedExpression(e)}toggleFractionEvaluationById(e){this.model.setFractionEvaluation(e,!this.model.getExpressionById(e).displayAsFraction)}conditionallyCopyPrevious(e){this.model.conditionallyCopyPrevious(e)}createBlankAfterId(e){this.model.createBlankAfterId(e)}backspaceAtFrontOfId(e){this.model.backspaceAtFrontOfId(e)}areStatesDifferentEnoughForUndoRedo(e,t){let r={focus:void 0};return __dcg_shared_module_exports__.E(ie(R({},e),{ui:r}),ie(R({},t),{ui:r}))}commitUndoRedoDebounced(){let e=this.model.getState(),t=this.stateStack.getState();if(this.areStatesDifferentEnoughForUndoRedo(e,t))return;let r=new Date().getTime();r-this._lastDebouncedTime<1e3?this.stateStack.replaceState(e):this.stateStack.addState(e),this._lastDebouncedTime=r,this.enqueueEvent("change")}commitUndoRedoSynchronously(){let e=this.model.getState(),t=this.stateStack.getState();this.areStatesDifferentEnoughForUndoRedo(e,t)||(this._lastDebouncedTime=0,this.stateStack.addState(e),this.enqueueEvent("change"))}updateKeyboardMode(e){this.keyboardMode=e}getFocusedMathquill(){if(this.model.getFocusedExpressionId())return Fe.getFocusedMathquill()}ensureMathquillIsFocusedAndReturnFocusedMathquill(){let e=this.getFocusedMathquill();if(e)return e;if(this.isLastExpressionEmpty()&&!this.model.isSingleExpression()?this.createAtEnd():this.focusLastExpression(),this.onEventEmitted&&this.onEventEmitted("render"),e=this.getFocusedMathquill(),!e)throw new Error("No focused mathquill found");return e}typeIntoFocusedMathquill(e){e=e.replace(/\r|\n/g,"");let t=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();t&&Fe.canAcceptText(t,this.getCapExpressionSize(),e)&&(t.typedText(e),this.setLatexOfFocusedExpression(t.latex()),this.model.markShouldDebounceUndoRedo())}pressKeyInFocusedMathquill(e){if(this.getBrailleMode()!=="none")return;let t=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();if(!t)return;let{key:r,source:n,evt:i}=e;if(r==="Up"||r==="Down"||r==="Left"||r==="Right"){let o=n==="keypad"?Fe.temporarilyOverrideLeftRightIntoCommandGoes(t,void 0):void 0,a=Fe.applyArrowKeyAndReturnIfWasAtBounds(t,r,i);o==null||o(),a&&this.moveFocusInDirection(r)}else r==="Enter"?(i&&(i.preventDefault(),i.stopPropagation()),this.handleEnter()):r==="Backspace"?this.attemptToMoveFocusWithBackspace()||(t.keystroke(r,i),this.setLatexOfFocusedExpression(t.latex())):r==="Delete"?(t.keystroke(r,i),this.setLatexOfFocusedExpression(t.latex())):(t.keystroke(r,i),this.setLatexOfFocusedExpression(t.latex()))}moveFocusInDirection(e){let t=this.model.getFocusedExpressionId();t&&(e==="Up"?this.model.focusPrevById(t):e==="Down"&&this.model.focusNextById(t))}handleEnter(){if(this.model.isSingleExpression())return;let e=this.model.getFocusedExpressionId();e&&(this.conditionallyCopyPrevious(e),this.createBlankAfterId(e))}attemptToMoveFocusWithBackspace(){let e=this.model.getFocusedExpression();if(!e)return!1;let{latex:t,id:r}=e;return t===""?(this.backspaceAtFrontOfId(r),!0):!1}executeCommandInFocusedMathquill(e){let t=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();t&&(ZI(t,e,{capExpressionSize:this.getCapExpressionSize()}),this.setLatexOfFocusedExpression(t.latex()))}syncPublicSettings(){this.settingsProxy.setProperty("language",this.language),this.settingsProxy.setProperty("fontSize",this.fontSize),this.settingsProxy.setProperty("degreeMode",this.model.getDegreeMode()),this.settingsProxy.setProperty("invertedColors",this.invertedColors),this.settingsProxy.setProperty("backgroundColor",this.backgroundColor),this.settingsProxy.setProperty("textColor",this.textColor),this.settingsProxy.setProperty("brailleMode",this.brailleMode),this.settingsProxy.setProperty("sixKeyInput",this.sixKeyInput),this.settingsProxy.setProperty("brailleControls",this.brailleControls),this.settingsProxy.setProperty("brailleExpressionDownload",this.brailleExpressionDownload),this.settingsProxy.setProperty("projectorMode",this.projectorMode),this.settingsProxy.setProperty("capExpressionSize",this.capExpressionSize),this.settingsProxy.setProperty("decimalToFraction",this.decimalToFraction),this.settingsProxy.setProperty("qwertyKeyboard",this.options.qwertyKeyboard),this.settingsProxy.setProperty("links",this.options.links),this.settingsProxy.setProperty("settingsMenu",this.settingsMenu),this.settingsProxy.setProperty("functionDefinition",this.model.getFunctionDefinition()),this.settingsProxy.setProperty("replaceCommaWith10Exp",this.replaceCommaWith10Exp),this.settingsProxy.setProperty("replaceRoundWithReciprocal",this.model.getReplaceRoundWithReciprocal()),this.settingsProxy.setProperty("typingAsteriskWritesTimesSymbol",this.typingAsteriskWritesTimesSymbol)}getDegreeMode(){return this.model.getDegreeMode()}hookUpDispatcher(){this.dispatcher.register(e=>{this.enqueueEvent("render");let t=!1,r=this.getRestrictedEditing();switch(e.type){case"update-options":{this.options=R(R({},this.options),e.options);break}case"keypad/shift":{let o;switch(this.keyboardMode){case"qwerty":o="capitalQwerty";break;case"capitalQwerty":o="qwerty";break;case"letters":o="capitalLetters";break;case"capitalLetters":o="letters";break;default:o="qwerty"}this.updateKeyboardMode(o)}break;case"undo":r||(this.undo({restoreFocus:e.source==="keyboard-shortcut"}),t=!0);break;case"redo":r||(this.redo({restoreFocus:e.source==="keyboard-shortcut"}),t=!0);break;case"clear-history":this.clearHistory();break;case"set-state-from-api":e.opts.allowUndo||this.clearHistory(),this.model.setStateFromAPI(e.state);break;case"main":this.updateKeyboardMode("main");break;case"ABC":this.options.qwertyKeyboard?this.updateKeyboardMode("qwerty"):this.updateKeyboardMode("letters");break;case"functions":this.updateKeyboardMode("functions");break;case"degrees":this.model.setDegreeMode(!this.model.getDegreeMode());break;case"update-degree-mode":this.model.setDegreeMode(!!e.mode);break;case"update-font-size":let n=e.size;if(typeof n!="number"&&(n=parseInt(n,10)),isNaN(n))return;this.fontSize=n;break;case"update-inverted-colors":this.invertedColors=!!e.mode;break;case"update-background-color":this.backgroundColor=e.color;break;case"update-text-color":this.textColor=e.color;break;case"update-projector-mode":this.setProjectorMode(!!e.mode);break;case"update-cap-expression-size":this.setCapExpressionSize(!!e.mode);break;case"update-decimal-to-fraction":this.setDecimalToFraction(!!e.mode);break;case"update-language":this.setLanguage(e.language);break;case"set-blank":e.opts.allowUndo||this.clearHistory(),this.model.clear(),this.focusLastExpression();break;case"clear":this.model.clearFocusedExpression();break;case"set-braille-mode":let i=e.mode;i!=="nemeth"&&i!=="ueb"&&i!=="none"?__dcg_shared_module_exports__.qe.warn(`Valid Braille modes are 'nemeth', 'none', and 'ueb'. You passed '${i}'.`):(this.model.clearCachedBrailleValues(),this.setBrailleMode(e.mode));break;case"set-six-key-input":this.setSixKeyInput(!!e.useSixKeyInput);break;case"set-braille-controls":this.setBrailleControls(!!e.value);break;case"set-braille-expression-download":this.setBrailleExpressionDownload(!!e.mode);break;case"set-replace-comma-with-10-exp":this.setReplaceCommaWith10Exp(!!e.replace);break;case"set-replace-round-with-reciprocal":this.setReplaceRoundWithReciprocal(!!e.replace);break;case"set-typing-asterisk-writes-times-symbol":this.setTypingAsteriskWritesTimesSymbol(!!e.mode);break;case"update-latex":this.model.markShouldDebounceUndoRedo(),this.setLatexById(e.id,e.latex);break;case"update-latex-from-braille":this.model.markShouldDebounceUndoRedo(),this.setLatexAndBrailleById(e.id,e.latex,e.braille);break;case"focusin":this.model.setFocusedById(e.id,!0);break;case"focusout":this.model.setFocusedById(e.id,!1);break;case"focus-first-expression":this.model.focusFirstExpression();break;case"focus-prev-expression":this.moveFocusInDirection("Up");break;case"focus-next-expression":this.moveFocusInDirection("Down");break;case"focus-last-expression":this.model.focusLastExpression();break;case"insert-blank-expression":this.handleEnter();break;case"backspace-from-braille":this.attemptToMoveFocusWithBackspace();break;case"keypad/type-text":this.typeIntoFocusedMathquill(e.text);break;case"keypad/press-key":this.pressKeyInFocusedMathquill(e);break;case"keypad/custom-command":this.executeCommandInFocusedMathquill(e.command);break;case"keypad/123":case"keypad/abc":case"keypad/audio-trace":break;case"enable-settings-menu":this.enableSettingsMenu();break;case"disable-settings-menu":this.disableSettingsMenu();break;case"toggle-settings-menu":this.toggleSettingsMenu();break;case"close-settings-menu":this.closeSettingsMenu();break;case"render":break;case"ui/container-resized":this.containerSize=e.size;break;case"toggle-fraction-evaluation":this.toggleFractionEvaluationById(e.id);break;case"toggle-complex-mode":this.isComplexModeAllowed()&&this.model.setComplexMode(e.enabled);break;case"toggle-complex-allowed":this.options.allowComplex=e.enabled;break;default:return e}this.runAfterDispatch(()=>this.syncPublicSettings()),t||(this.model.getShouldDebounceUndoRedo()?(this.commitUndoRedoDebounced(),this.model.clearShouldDebounceUndoRedo()):this.commitUndoRedoSynchronously())})}getMathquillConfig(){let e=this.getAdditionalFunctions(),t=this.isFourFunctionCalc()&&(!e||e.indexOf("fraction")===-1);return R({typingAsteriskWritesTimesSymbol:this.getTypingAsteriskWritesTimesSymbol(),typingSlashWritesDivisionSymbol:this.getTypingSlashWritesDivisionSymbol(),disableCopyPaste:this.getRestrictedEditing(),autoCommands:Pu({disallowFrac:t})},Vf())}isComplexModeEnabled(){return this.model.getComplexMode()&&this.isComplexModeAllowed()}isComplexModeAllowed(){return this.options.evaluationMode==="scientific"&&this.options.allowComplex}canDisplayEvaluationAsFraction(e){return this.getDecimalToFraction()&&this.model.canDisplayEvaluationAsFraction(e)}shouldDisplayEvaluationAsFraction(e){return this.canDisplayEvaluationAsFraction(e)&&this.model.getExpressionById(e).displayAsFraction}getEvaluationDigits(){return this.isScientificCalc()?10:7}getLabelOptionsForExpression(e){let t=this.model.getExpressionTypedConstantValue(e);return(t==null?void 0:t.valueType)===__dcg_shared_module_exports__.db?ie(R({},__dcg_shared_module_exports__.ha),{digits:Math.min(this.getEvaluationDigits(),__dcg_shared_module_exports__.ha.digits)}):{digits:this.getEvaluationDigits(),bigCutoff:1e9,displayAsFraction:this.shouldDisplayEvaluationAsFraction(e)}}getEvaluationMode(){return this.options.evaluationMode}};mg();var yr=__dcg_shared_module_exports__.e(ne()),ma=__dcg_shared_module_exports__.e(ne());qt();var kj=__dcg_shared_module_exports__.e(ne()),nr=class extends kj.Class{init(){this.controller=this.props.controller(),this.model=this.controller.model,this.dispatch=this.controller.dispatch,this.s=this.controller.s}},$t=__dcg_shared_module_exports__.e(ne()),{If:cu,Input:Cpe,Textarea:Spe}=$t.Components,T1=class extends nr{constructor(){super(...arguments),this.lastBrailleModeDuringFocusChange="none"}getAriaLabel(){let e=this.getIndex()+1+"";return this.s("shared-calculator-narration-expression-index",{index:e})}didUpdate(){this.renderAnsValue()}didMountMQ(e){this.mq=e}getExp(){return this.model.getExpressionById(this.props.id())}getLatex(){return this.getExp().latex}getValue(){return this.model.getExpressionValue(this.props.id())}getBraille(){let e=this.getExp().braille;if(e!=="")return e;{let t=qb(this.getLatex(),this.controller.getBrailleMode());return t.isError?"":sa.toExpandedBrailleAscii(t.value)}}getIndex(){return this.model.getExpressionIndex(this.props.id())}getShowEvaluation(){return this.model.shouldShowEvaluationForExpression(this.props.id())}isFractionEvaluation(){return this.getExp().displayAsFraction}toggleFractionEvaluation(){this.dispatch({type:"toggle-fraction-evaluation",id:this.props.id()})}getFractionDisplayAriaLabel(){return this.controller.shouldDisplayEvaluationAsFraction(this.props.id())?this.controller.s("basic-calculator-narration-convert-to-decimal"):this.controller.s("basic-calculator-narration-convert-to-fraction")}getError(){let e=this.model.getExpressionError(this.props.id());return e&&this.getLatex().length>0?Fl(e,this.controller.getLanguage()):""}showError(){return!!this.getError()}getFractionMessage(){return this.controller.shouldDisplayEvaluationAsFraction(this.props.id())?this.s("basic-calculator-label-convert-to-decimal"):this.s("basic-calculator-label-convert-to-fraction")}getIsFocused(){return!this.controller.isSettingsMenuOpen()&&this.model.isExpressionFocused(this.props.id())}onFocusedChanged(e){let t=this.controller.getBrailleMode(),r=t!==this.lastBrailleModeDuringFocusChange;this.lastBrailleModeDuringFocusChange=t,!(!this.getExp()||r)&&(e?this.dispatch({type:"focusin",id:this.props.id()}):this.dispatch({type:"focusout",id:this.props.id()}))}onMQReflow(){this.cachedRenderedAnsString=void 0,this.renderAnsValue()}renderAnsValue(){if(!this.mq)return;let e=this.model.getExpressionAnsId(this.props.id()),t;if(e!==void 0){let r=this.controller.getLabelOptionsForExpression(e),n=this.model.getExpressionTypedConstantValue(e);switch(n==null?void 0:n.valueType){case __dcg_shared_module_exports__.db:t=__dcg_shared_module_exports__.pa(n.value,ie(R({},r),{digits:5,scientificNotationDigits:3}),"html");break;case __dcg_shared_module_exports__.wa:t=__dcg_shared_module_exports__.ka(n.value,r);break;default:__dcg_shared_module_exports__.wb(n==null?void 0:n.valueType)&&(t="[...]");break}}t!==this.cachedRenderedAnsString&&(this.mq.querySelectorAll(".dcg-mq-ans").forEach(r=>{t?(r.classList.remove("dcg-invalid"),r.innerHTML=t):(r.classList.add("dcg-invalid"),r.innerHTML='<i class="dcg-icon-error" aria-hidden="true"></i>')}),this.cachedRenderedAnsString=t)}getEvaluationLatex(){let e=this.props.id();if(this.model.isRationalizableConstant(e)&&!this.controller.shouldDisplayEvaluationAsFraction(e))return"";let t=this.controller.getLabelOptionsForExpression(e),r=this.model.getExpressionTypedConstantValue(e),n;switch(r==null?void 0:r.valueType){case __dcg_shared_module_exports__.db:n=__dcg_shared_module_exports__.pa(r.value,t,"latex");break;case __dcg_shared_module_exports__.wa:n=__dcg_shared_module_exports__.la(r.value,t);break;default:if(__dcg_shared_module_exports__.wb(r==null?void 0:r.valueType))return`\\mathrm{${r.value.length}\\ element\\ list}`;break}return(n==="undefined"||n===void 0)&&(n="\\mathrm{undefined}"),`=${n}`}getEvaluationBraille(){let e=this.getEvaluationLatex(),t=qb(e,this.controller.getBrailleMode());return t.isError?"":sa.toExpandedBrailleAscii(t.value)}didMountBrailleInput(e){this.brailleInputNode=e}didUnmountBrailleInput(){this.brailleInputNode=void 0}handleBrailleFocus(e){let t=e.target;t&&setTimeout(this.bindIfMounted(()=>{t.setSelectionRange(0,0)}))}handleBrailleKeydown(e){!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(ke(e)===xa?(this.forceModelFocus(),this.dispatch({type:"focus-prev-expression"}),e.preventDefault()):ke(e)===Kn?(this.forceModelFocus(),this.dispatch({type:"focus-next-expression"}),e.preventDefault()):ke(e)===xg?(this.forceModelFocus(),this.dispatch({type:"insert-blank-expression"}),e.preventDefault()):ke(e)===_u&&document.activeElement===this.brailleInputNode&&this.getBraille()===""&&(this.dispatch({type:"backspace-from-braille"}),e.preventDefault()))}forceModelFocus(){document.activeElement!==this.brailleInputNode&&this.onFocusedChanged(!0)}getPostLabel(){let e=this.props.id(),t=this.controller.getLabelOptionsForExpression(e);if(this.showError())return this.getError();if(this.getShowEvaluation()){let r=this.model.getExpressionTypedConstantValue(e),n="";switch(r==null?void 0:r.valueType){case __dcg_shared_module_exports__.db:n=__dcg_shared_module_exports__.pa(r.value,t);break;case __dcg_shared_module_exports__.wa:n=__dcg_shared_module_exports__.la(r.value,t);break;default:if(__dcg_shared_module_exports__.wb(r==null?void 0:r.valueType))return`${r.value.length} element list`;break}return"equals "+Ao(n!=null?n:"undefined")}return""}onBrailleInput(e){this.controller.isSettingsMenuOpen()&&this.controller.dispatch({type:"close-settings-menu"});let t=YT(sa.coerceToSixDotCells(e),this.controller.getBrailleMode()),r=t.isError?"":t.value;(!this.controller.getCapExpressionSize()||Of(r)<=zb)&&this.controller.dispatch({type:"update-latex-from-braille",latex:r,braille:e,id:this.props.id()})}getIndexSubscript(){return`_{${this.getIndex()+1}}`}onMountContainer(e){this.containerNode=e}onTapContainer(e){e.target===this.containerNode&&!this.getShowEvaluation()&&!this.showError()&&this.forceModelFocus()}template(){return $t.createElement("div",{class:()=>({"dcg-basic-expression":!0,"dcg-focused":this.getIsFocused(),"dcg-braille-io":this.controller.renderAsBraille()}),onTap:this.bindFn(this.onTapContainer),onMount:this.bindFn(this.onMountContainer)},$t.createElement(cu,{predicate:()=>this.controller.renderAsBraille()},()=>$t.createElement("div",{class:$t.const("dcg-braille-input")},$t.createElement(Ug,{ariaLabel:()=>{let e=qb(`eq${this.getIndexSubscript()}`,this.controller.getBrailleMode());return e.isError?"":sa.toExpandedBrailleAscii(e.value)},didMount:this.bindFn(this.didMountBrailleInput),didUnmount:this.bindFn(this.didUnmountBrailleInput),onFocusedChanged:this.bindFn(this.onFocusedChanged),shouldFocus:this.bindFn(this.getIsFocused),onKeyDown:this.bindFn(this.handleBrailleKeydown),onInput:this.bindFn(this.onBrailleInput),sixKeyInput:()=>this.controller.getSixKeyInput(),value:()=>this.getBraille(),isStatic:this.const(!1)}))),$t.createElement(cu,{predicate:()=>this.controller.renderAsBraille()},()=>$t.createElement("div",{class:$t.const("dcg-braille-evaluation-container")},$t.createElement(cu,{predicate:()=>this.getShowEvaluation()},()=>$t.createElement("div",{class:$t.const("dcg-braille-evaluation")},$t.createElement(Cpe,{readOnly:this.const(!0),class:this.const("dcg-braille-evaluation-inner"),value:()=>this.getEvaluationBraille(),onFocus:this.bindFn(this.handleBrailleFocus),onKeyDown:this.bindFn(this.handleBrailleKeydown),onInput:()=>{}}))),$t.createElement(cu,{predicate:()=>this.showError()},()=>$t.createElement("div",{class:$t.const("dcg-braille-error")},$t.createElement("div",{class:$t.const("dcg-basic-expression-error")},$t.createElement("i",{class:$t.const("dcg-icon-error"),"aria-hidden":$t.const("true")})),$t.createElement(Spe,{readOnly:this.const(!0),class:this.const("dcg-braille-error-inner"),value:()=>this.getError(),onFocus:this.bindFn(this.handleBrailleFocus),onKeyDown:this.bindFn(this.handleBrailleKeydown),onInput:()=>{}}))))),$t.createElement(cu,{predicate:()=>this.controller.renderAsBraille()},()=>$t.createElement("div",{class:$t.const("dcg-exp-mathquill-container"),didMount:this.bindFn(this.didMountMQ),onTap:this.bindFn(this.forceModelFocus)},$t.createElement(nt,{latex:()=>this.getLatex(),config:this.const({}),onReflow:this.bindFn(this.onMQReflow)}))),$t.createElement(cu,{predicate:()=>!this.controller.renderAsBraille()},()=>$t.createElement("div",{class:$t.const("dcg-exp-mathquill-container"),didMount:this.bindFn(this.didMountMQ)},$t.createElement(Fe,{latex:()=>this.getLatex(),onReflow:this.bindFn(this.onMQReflow),isFocused:this.bindFn(this.getIsFocused),capExpressionSize:()=>this.controller.getCapExpressionSize(),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel(),getAriaPostLabel:()=>this.getPostLabel(),hasError:()=>!1,onUserPressedKey:(e,t)=>{this.controller.isSettingsMenuOpen()&&this.controller.dispatch({type:"close-settings-menu"}),this.dispatch({type:"keypad/press-key",key:e,evt:t,source:"keyboard"})},onUserTypedText:e=>this.dispatch({type:"keypad/type-text",text:e}),onUserChangedLatex:e=>{this.dispatch({type:"update-latex",id:this.props.id(),latex:e})},onFocusedChanged:this.bindFn(this.onFocusedChanged),disableSpace:()=>this.controller.getRestrictedEditing()}))),$t.createElement("div",{class:$t.const("dcg-exp-output-container")},$t.createElement(cu,{predicate:()=>this.showError()&&!this.controller.renderAsBraille()},()=>$t.createElement(Di,{error:this.bindFn(this.getError),gravity:this.const("w")})),$t.createElement(cu,{predicate:()=>this.getShowEvaluation()},()=>$t.createElement("div",{class:()=>({"dcg-basic-expression-value":!0,"dcg-basic-evaluation-gray":this.model.isEvaluationList(this.props.id())})},$t.createElement(nt,{config:this.const({}),latex:()=>this.getEvaluationLatex()}),$t.createElement(cu,{predicate:()=>this.controller.canDisplayEvaluationAsFraction(this.props.id())},()=>$t.createElement(Le,{tooltip:this.bindFn(this.getFractionMessage),gravity:this.const("s")},$t.createElement("span",{role:$t.const("button"),tabIndex:$t.const("0"),"aria-label":this.bindFn(this.getFractionDisplayAriaLabel),class:()=>({"dcg-basic-fraction-toggle":!0,"dcg-selected":this.isFractionEvaluation()}),onTap:this.bindFn(this.toggleFractionEvaluation)},$t.createElement("i",{class:$t.const("dcg-icon-fraction"),"aria-hidden":$t.const("true")}))))))))}getMQConfig(){return this.controller.getMathquillConfig()}},{For:Epe,If:Tpe}=ma.Components,D1=class extends nr{constructor(){super(...arguments),this.didShowAnswerHint=!1,this.didHideAnswerHint=!1}template(){return ma.createElement("div",{class:ma.const("dcg-basic-list-container"),role:ma.const("region"),"aria-label":()=>this.controller.s("shared-calculator-narration-expression-list"),didMount:this.bindFn(this.didMountContainer)},ma.createElement("div",{class:ma.const("dcg-basic-list-placeholder"),didMount:this.bindFn(this.didMountPlaceholder)},ma.createElement(Tpe,{predicate:this.bindFn(this.showAnswerHint)},()=>ma.createElement("div",{class:ma.const("dcg-answer-hint")},()=>this.controller.s("basic-calculator-label-answer-hint"),ma.createElement("i",{class:ma.const("dcg-icon-curved-arrow")})))),ma.createElement("div",{class:()=>({"dcg-basic-list":!0,"dcg-projector-mode":this.controller.isProjectorMode()})},ma.createElement(Epe,{each:()=>this.model.getExpressionOrder()},e=>ma.createElement(T1,{controller:this.props.controller,id:this.const(e)}))))}didMountPlaceholder(e){ee(e).on("dcg-tap",Jr)}showAnswerHint(){if(this.didHideAnswerHint)return!1;let e=this.model.getExpressionOrder()[0];return this.model.shouldShowEvaluationForExpression(e)||this.didShowAnswerHint?(this.didShowAnswerHint=!0,this.model.getNumberOfExpressions()>1||this.model.getExpressionLatex(e)===""?(this.didHideAnswerHint=!0,!1):!0):!1}didUpdate(){if(!this.container)return;let e=this.container.querySelector(".dcg-focused");e&&tc(e,this.container,50)}didMountContainer(e){this.container=e}},Co=__dcg_shared_module_exports__.e(ne()),bs=__dcg_shared_module_exports__.e(ne()),{For:Dpe}=bs.Components,px=class extends bs.Class{template(){return bs.createElement("tr",null,bs.createElement("td",null,bs.createElement(Dpe,{each:()=>this.getBrailleAscii(this.props.latex()),key:e=>e.key},e=>bs.createElement("span",{class:bs.const("dcg-key-press")},()=>e.char))),bs.createElement("td",{class:bs.const("dcg-braille-font")},()=>this.getBrailleUnicode(this.props.latex())),bs.createElement("td",null,bs.createElement(nt,{config:this.const({}),latex:()=>this.props.latex()})))}getBrailleAscii(e){let t=sa.toExpandedBrailleAscii(this.getBrailleUnicode(e)),r=[];for(let n=0;n<t.length;n++)r.push({char:t[n],key:n+")"+t[n]});return r}getBrailleUnicode(e){let t;return this.props.brailleMode()==="nemeth"?t=lp(e):this.props.brailleMode()==="ueb"&&(t=cp(e)),t&&t.value?t.value:""}},Gm=class extends nr{template(){return Co.createElement("div",{class:()=>({"dcg-braille-io-keypad-container":!0,"dcg-has-background-color":this.controller.hasBackgroundColor()})},Co.createElement("div",{class:Co.const("dcg-braille-io-keypad")},Co.createElement("div",{class:Co.const("dcg-braille-description")},Co.createElement("div",{class:Co.const("dcg-braille-title")},()=>this.controller.s("basic-calculator-text-braille-mode-is-on",{mode:this.brailleType()})),Co.createElement("div",{class:Co.const("dcg-braille-info-text")},()=>this.controller.s("basic-calculator-text-how-to-type-braille")),Co.createElement("div",{class:Co.const("dcg-btn-blue"),role:Co.const("button"),tabIndex:Co.const(0),onTap:()=>this.controller.dispatch({type:"set-braille-mode",mode:"none"})},()=>this.controller.s("basic-calculator-button-turn-braille-mode-off",{mode:this.brailleType()}))),Co.createElement("div",{class:Co.const("dcg-braille-examples-table-container")},Co.createElement("table",{class:Co.const("dcg-braille-examples-table")},Co.createElement("tr",null,Co.createElement("th",null,()=>this.controller.s("basic-calculator-heading-braille-table-type-this")),Co.createElement("th",null,()=>this.brailleType()),Co.createElement("th",null,()=>this.controller.s("basic-calculator-heading-braille-table-typeset"))),Co.createElement(px,{brailleMode:()=>this.controller.getBrailleMode(),latex:this.const("2+2")}),Co.createElement(px,{brailleMode:()=>this.controller.getBrailleMode(),latex:this.const("\\frac{1}{2}")}),Co.createElement(px,{brailleMode:()=>this.controller.getBrailleMode(),latex:this.const("\\sqrt{4}")})),Co.createElement("div",{class:Co.const("dcg-more-examples-link")},Co.createElement("a",{href:()=>"https://www.desmos.com/braille-examples?"+this.controller.getBrailleMode(),target:Co.const("_blank")},()=>this.controller.s("basic-calculator-link-view-braille-examples"))))))}brailleType(){return this.controller.getBrailleMode()==="nemeth"?"Nemeth":this.controller.getBrailleMode()==="ueb"?"UEB":""}},qo=__dcg_shared_module_exports__.e(ne()),Lm=__dcg_shared_module_exports__.e(ne()),Bc=class extends Cm{template(){return Lm.createElement("div",{class:Lm.const("dcg-keypad-control-bar dcg-do-not-blur"),role:Lm.const("group"),"aria-label":()=>this.controller.s("shared-calculator-narration-keypad-controlbar")},Lm.createElement("div",{class:Lm.const("dcg-keypad-control-bar-contents")},this.props.children))}},ux=__dcg_shared_module_exports__.e(ne()),_o=class extends ux.Class{template(){return ux.createElement("div",{class:()=>({"dcg-keypad-control-btn":!0,"dcg-disabled":this.isDisabled(),"dcg-selected":!this.isDisabled()&&this.isSelected(),"dcg-selectable-btn":!this.isDisabled()&&this.isSelectable(),"dcg-narrow-control-btn":this.props.narrowButton&&this.props.narrowButton()}),didMount:this.bindFn(this.didMount),role:ux.const("button"),"aria-disabled":()=>this.isDisabled()||void 0,"aria-label":()=>this.getAriaLabel(),"dcg-command":this.props.command,onTap:this.bindFn(this.handleTap),"aria-pressed":()=>!this.hasPopup()&&!this.isDisabled()&&this.isSelectable()?this.isSelected():void 0,"aria-expanded":()=>this.hasPopup()&&!this.isDisabled()?this.isSelected():void 0,tabIndex:this.bindFn(this.getTabIndex)},this.props.children)}getTabIndex(){if(!this.isDisabled())return this.props.ignoreInTabOrder&&this.props.ignoreInTabOrder()?-1:0}handleTap(e){this.isDisabled()||this.props.onTap(e)}getAriaLabel(){return this.props.ariaLabel?this.props.ariaLabel():this.props.command()}hasPopup(){var e,t;return!!((t=(e=this.props).ariaPopup)!=null&&t.call(e))}isDisabled(){var e,t;return!!((t=(e=this.props).disabled)!=null&&t.call(e))}isSelected(){var e,t;return!!((t=(e=this.props).selected)!=null&&t.call(e))}isSelectable(){var e,t;return!!((t=(e=this.props).selectable)!=null&&t.call(e))}didMount(e){this.props.didMount&&this.props.didMount(e)}},lo=__dcg_shared_module_exports__.e(ne()),Yd=__dcg_shared_module_exports__.e(ne());function kpe(){if(!NS)return!1;let e=navigator.userAgent.match(/Version\/(\d+)/);return!e||!e[1]?!1:parseFloat(e[1])<11}function _j(){return!Y5&&!kpe()&&typeof document.createElement("a").download!="undefined"}function Ij(){return _j()||navigator.msSaveBlob!==void 0}var k1=class extends Yd.Class{init(){this.supportsDirectDownload=_j()}template(){return Yd.createElement("a",{role:Yd.const("button"),tabIndex:()=>this.props.enabled()?0:-1,"aria-disabled":()=>this.props.enabled()?void 0:!0,class:()=>{var e,t,r,n,i,o;return{"dcg-download-button":!0,"dcg-btn-blue":((t=(e=this.props).buttonType)==null?void 0:t.call(e))==="primary","dcg-btn-blue-outline":((n=(r=this.props).buttonType)==null?void 0:n.call(r))==="secondary","dcg-primary-link":((o=(i=this.props).buttonType)==null?void 0:o.call(i))==="link","dcg-disabled":!this.props.enabled()}},didMount:this.bindFn(this.didMountDownload),didUnmount:this.bindFn(this.didUnmountDownload),didUpdate:this.bindFn(this.didUpdate),download:()=>this.supportsDirectDownload?this.props.filename():void 0,onTap:e=>{var t,r;if((r=(t=this.props).triggerLogEvent)==null||r.call(t),this.supportsDirectDownload||!navigator.msSaveOrOpenBlob)return;let n=this.props.data();n&&(navigator.msSaveOrOpenBlob(n,this.props.filename()),e.preventDefault())}},Yd.createElement("i",{class:Yd.const("dcg-icon-download"),"aria-hidden":Yd.const("true")}),Yd.createElement("span",null,()=>this.props.text()))}didMountDownload(e){this.downloadLink=e,this.didUpdate()}didUnmountDownload(){this.revokeBlobURL()}didUpdate(){this.updateDownloadURL(),this.cachedObjectURL&&(this.downloadLink.href=this.cachedObjectURL)}updateDownloadURL(){if(this.revokeBlobURL(),!this.supportsDirectDownload)return;let e=this.props.data();e&&(this.cachedObjectURL=URL.createObjectURL(e))}revokeBlobURL(){this.cachedObjectURL&&URL.revokeObjectURL(this.cachedObjectURL)}};qt();function xA(e,t,r=!1){if(r&&(e=e.replace(/ /g,"\\ ")),t==="none")return e;let n=t==="nemeth"?lp(e):cp(e);return n.isError?"":sa.toBrailleAscii(n.value)}function Aj(e,t){if(t==="none")return"";let r=[];r.push(xA("Expression List",t,!0)),r.push(""),r.push("");for(let n of e.getExpressionOrder()){let i=_pe(""+(e.getExpressionIndex(n)+1),t),o=e.getExpressionLatex(n),a=e.getExpressionValue(n);a!==void 0&&(o+=`=${a}`),r.push(`${i}  ${xA(o,t,!1)}`)}return r.join(`
`)}function _pe(e,t){return t==="nemeth"?`${xA(e,t,!1)}_4`:t==="ueb"?xA(`${e}.`,t,!1):""}var{If:_1}=lo.Components,wA=class extends nr{template(){return lo.createElement("div",{class:()=>({"dcg-settings-dropdown":!0,"dcg-popover":!0,"dcg-point-left":this.controller.containerSize.height<=420}),role:lo.const("region"),"aria-label":lo.const("Settings Menu"),didMount:this.bindFn(this.didMountSettingsDropdown),didUnmount:this.bindFn(this.didUnmountSettingsDropdown)},lo.createElement("div",{class:lo.const("dcg-popover-interior")},lo.createElement("div",{class:()=>({"dcg-settings-menu-option":!0,"dcg-displaysize-container":!0})},lo.createElement(vo,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size"),staticConfig:this.bindFn(this.getProjectorModeOptions)})),lo.createElement(mt,{onChange:this.bindFn(this.onToggleInvertedColors),checked:()=>this.controller.getInvertedColors(),class:this.const("dcg-settings-menu-option dcg-do-not-blur dcg-reverse-contrast")},lo.createElement("span",{class:lo.const("dcg-checkbox-label")},()=>this.controller.s("basic-calculator-label-reverse-contrast"))),lo.createElement(_1,{predicate:()=>this.controller.getBrailleControls()},()=>lo.createElement("div",null,lo.createElement(mt,{onChange:this.bindFn(this.onToggleBrailleMode),checked:()=>this.controller.renderAsBraille(),class:this.const("dcg-settings-menu-option dcg-do-not-blur dcg-braille-mode")},lo.createElement("span",{class:lo.const("dcg-checkbox-label")},()=>this.controller.s("shared-calculator-narration-braille-mode"))),lo.createElement(_1,{predicate:()=>this.controller.renderAsBraille()},()=>lo.createElement("div",{class:()=>({"dcg-settings-menu-option":!0,"dcg-braille-container":!0})},lo.createElement(Gh,{showBrailleNote:this.const(!1),controller:this.props.controller}),lo.createElement("div",{class:lo.const("dcg-braille-options-container")},lo.createElement(_1,{predicate:()=>!Df&&Ij()&&this.controller.getBrailleExpressionDownload()},()=>lo.createElement(k1,{data:()=>{let e=Aj(this.model,this.controller.getBrailleMode());return new Blob([e],{type:"text/plain"})},enabled:this.const(!0),filename:this.const("desmos-equations.brl"),text:()=>this.controller.s("basic-calculator-link-download-braille-equations"),buttonType:this.const("link")}))))))),lo.createElement(_1,{predicate:()=>this.controller.isComplexModeAllowed()},()=>lo.createElement(Lh,{controller:this.props.controller,isComplexModeEnabled:()=>this.controller.isComplexModeEnabled(),toggleComplexMode:this.bindFn(this.onToggleComplexMode),product:this.const("scientific")})),lo.createElement(_1,{predicate:()=>!!this.getVersionNumber()},()=>lo.createElement("div",{class:lo.const("dcg-version-number")},lo.const("Version: "),()=>this.getVersionNumber()))))}getProjectorModeOptions(){return[{key:"default",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-default"),class:()=>"dcg-displaysize-default",selected:()=>!this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!1)},{key:"large",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-large"),class:()=>"dcg-displaysize-large",selected:()=>this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!0)}]}onSelectProjectorModeOption(e){this.controller.dispatch({type:"update-projector-mode",mode:e})}getVersionNumber(){let e=window;if(e&&e.AppBridge)return e.AppBridge.versionNumber}didUnmountSettingsDropdown(){ee(document).off(".dcg-settings-view")}didMountSettingsDropdown(e){this.settingsGroupNode=e,ee(document).on("dcg-tapstart.dcg-settings-view",t=>{t.target.closest(".dcg-basic-settings-container")||this.controller.dispatch({type:"close-settings-menu"})}),ee(document).on("keydown.dcg-settings-view",t=>{if(ke(t)==="Esc"&&(this.controller.dispatch({type:"close-settings-menu"}),this.controller.dispatch({type:"focus-last-expression"})),ke(t)==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let r=document.activeElement,n=this.props.settingsButtonNode(),i=[...this.settingsGroupNode.querySelectorAll(".dcg-settings-menu-option")].slice(-1)[0];!t.shiftKey&&r===i?(n.focus(),t.preventDefault(),t.stopPropagation()):t.shiftKey&&r===n&&(i.focus(),t.preventDefault(),t.stopPropagation())}})}onToggleBrailleMode(){this.controller.dispatch({type:"set-braille-mode",mode:this.controller.renderAsBraille()?"none":"nemeth"})}onToggleInvertedColors(){let e=!this.controller.getInvertedColors();this.controller.dispatch({type:"update-inverted-colors",mode:e})}onToggleComplexMode(){this.controller.dispatch({type:"toggle-complex-mode",enabled:!this.controller.isComplexModeEnabled()})}getProjectorMode(){return this.controller.isProjectorMode()}},ic=__dcg_shared_module_exports__.e(ne()),{If:Ape}=ic.Components,hx=class extends nr{template(){let e=this.props.controller();return ic.createElement("div",{class:ic.const("dcg-basic-settings-container")},ic.createElement(_o,{didMount:t=>this.settingsButtonNode=t,command:this.const("settings"),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-settings"),onTap:this.bindFn(this.onToggleSettingsMenu),selected:()=>this.controller.isSettingsMenuOpen(),ariaPopup:this.const(!0)},ic.createElement("i",{class:ic.const("dcg-icon-wrench"),"aria-hidden":ic.const("true")})),ic.createElement(Ape,{predicate:()=>this.controller.isSettingsMenuOpen()},()=>ic.createElement(wA,{controller:this.props.controller,settingsButtonNode:()=>this.settingsButtonNode})))}onToggleSettingsMenu(){this.controller.dispatch({type:"toggle-settings-menu"})}},{If:I1,IfElse:Mpe}=qo.Components,vA=class extends nr{template(){let e=this.props.controller();return qo.createElement(Bc,{controller:this.props.controller},qo.createElement(I1,{predicate:()=>this.showUndoRedo()},()=>qo.createElement(_o,{command:this.const("undo"),disabled:()=>!e.canUndo(),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-undo"),onTap:t=>e.dispatch({type:"undo",source:t.device==="keyboard"?"button-keyboard":"button-tap"})},qo.createElement("i",{class:qo.const("dcg-icon-undo"),"aria-hidden":qo.const("true")}))),qo.createElement(I1,{predicate:()=>this.showUndoRedo()},()=>qo.createElement(_o,{command:this.const("redo"),disabled:()=>!e.canRedo(),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-redo"),onTap:t=>e.dispatch({type:"redo",source:t.device==="keyboard"?"button-keyboard":"button-tap"})},qo.createElement("i",{class:qo.const("dcg-icon-redo"),"aria-hidden":qo.const("true")}))),Mpe(()=>e.shouldShowClear(),{true:()=>qo.createElement(_o,{command:this.const("clear"),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-clear"),onTap:()=>e.dispatch({type:"clear"})},()=>e.s("basic-calculator-button-controlbar-clear")),false:()=>qo.createElement(_o,{command:this.const("clearall"),disabled:()=>!e.canClear(),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-clear-all"),onTap:()=>e.dispatch({type:"set-blank",opts:{allowUndo:!0}})},()=>e.s("basic-calculator-button-controlbar-clear-all"))}),qo.createElement(I1,{predicate:()=>!this.showUndoRedo()},()=>qo.createElement("div",{class:qo.const("dcg-spacer-2")})),qo.createElement(I1,{predicate:()=>e.getBrailleMode()==="none"},()=>qo.createElement(_o,{command:this.const("backspace"),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-backspace"),disabled:()=>!e.canBackspace(),onTap:()=>e.dispatch({type:"keypad/press-key",key:"Backspace",source:"keypad"})},qo.createElement("i",{class:qo.const("dcg-icon-delete"),"aria-hidden":qo.const("true")}))),qo.createElement(I1,{predicate:()=>this.props.controller().getSettingsMenu()},()=>qo.createElement(hx,{controller:this.props.controller})))}showUndoRedo(){return!(this.controller.getRestrictedEditing()||this.controller.getDisableParentheses())}onToggleSettingsMenu(){this.controller.dispatch({type:"toggle-settings-menu"})}},Ks=__dcg_shared_module_exports__.e(ne()),{Switch:Mj}=Ks.Components,A1=class extends nr{template(){return Ks.createElement("div",{role:Ks.const("region"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},Ks.createElement(Or,{controller:this.props.controller},Ks.createElement($e,null,Ks.createElement(Mj,{key:this.bindFn(this.getTopLeftButtons)},e=>{switch(e){case"parens":return I(this,"(",{colspan:this.parenColspan()});case"undoredo":return I(this,"undo",{colspan:this.parenColspan(),disabled:()=>!this.controller.canUndo()});case"none":return to(this.parenColspan())}}),Ks.createElement(Mj,{key:this.bindFn(this.getTopLeftButtons)},e=>{switch(e){case"parens":return I(this,")",{colspan:this.parenColspan()});case"undoredo":return I(this,"redo",{colspan:this.parenColspan(),disabled:()=>!this.controller.canRedo()});case"none":return to(this.parenColspan())}}),this.makeAdditionalFunctionKey(0),this.makeAdditionalFunctionKey(1),I(this,"division")),Ks.createElement($e,null,I(this,"7",{style:"highlight"}),I(this,"8",{style:"highlight"}),I(this,"9",{style:"highlight"}),I(this,"multiplication")),Ks.createElement($e,null,I(this,"4",{style:"highlight"}),I(this,"5",{style:"highlight"}),I(this,"6",{style:"highlight"}),I(this,"-")),Ks.createElement($e,null,I(this,"1",{style:"highlight"}),I(this,"2",{style:"highlight"}),I(this,"3",{style:"highlight"}),I(this,"+")),Ks.createElement($e,null,I(this,"0",{style:"highlight"}),I(this,".",{style:"highlight"}),I(this,"ans"),I(this,"enter",{style:"blue"}))))}getTopLeftButtons(){return this.showParens()?"parens":this.controller.getRestrictedEditing()?"none":"undoredo"}showParens(){return!this.controller.getDisableParentheses()}parenColspan(){return this.controller.getAdditionalFunctions().length>1?.5:1}makeAdditionalFunctionKey(e){let t=this.controller.getAdditionalFunctions()[e];return t==="exponent"?I(this,"a^b"):t==="percent"?I(this,"%"):t==="sqrt"?I(this,"sqrt"):t==="fraction"?I(this,"a/b"):void 0}},Gi=__dcg_shared_module_exports__.e(ne()),{If:AR,IfElse:Gpe}=Gi.Components,CA=class extends nr{template(){let e=this.props.controller();return Gi.createElement(Bc,{controller:this.props.controller},Gi.createElement(_o,{command:this.const("main"),selected:()=>e.getKeyboardMode()==="main",disabled:()=>this.controller.renderAsBraille(),selectable:this.const(!0),onTap:()=>e.dispatch({type:"main"}),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-main")},()=>e.s("basic-calculator-button-controlbar-main")),Gi.createElement(_o,{command:this.const("ABC"),selected:()=>["qwerty","capitalQwerty","letters"].indexOf(e.getKeyboardMode())!==-1,disabled:()=>this.controller.renderAsBraille(),selectable:this.const(!0),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-abc"),onTap:()=>e.dispatch({type:"ABC"})},()=>e.s("basic-calculator-button-controlbar-abc")),Gi.createElement(_o,{command:this.const("functions"),selected:()=>["functions","restrictedFunctions"].indexOf(e.getKeyboardMode())!==-1,ariaLabel:()=>e.s("basic-calculator-narration-controlbar-functions"),disabled:()=>this.controller.renderAsBraille(),selectable:this.const(!0),onTap:()=>e.dispatch({type:"functions"})},()=>e.s("basic-calculator-button-controlbar-func")),Gi.createElement(rc,{setup:this.const({type:"basic",controller:this.controller})}),Gi.createElement(AR,{predicate:()=>!this.controller.getRestrictedEditing()},()=>Gi.createElement(_o,{command:this.const("undo"),disabled:()=>!e.canUndo(),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-undo"),onTap:t=>e.dispatch({type:"undo",source:t.device==="keyboard"?"button-keyboard":"button-tap"})},Gi.createElement("i",{class:Gi.const("dcg-icon-undo"),"aria-hidden":Gi.const("true")}))),Gi.createElement(AR,{predicate:()=>!this.controller.getRestrictedEditing()},()=>Gi.createElement(_o,{command:this.const("redo"),disabled:()=>!e.canRedo(),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-redo"),onTap:t=>e.dispatch({type:"redo",source:t.device==="keyboard"?"button-keyboard":"button-tap"})},Gi.createElement("i",{class:Gi.const("dcg-icon-redo"),"aria-hidden":Gi.const("true")}))),Gpe(()=>e.shouldShowClear(),{true:()=>Gi.createElement(_o,{command:this.const("clear"),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-clear"),onTap:()=>e.dispatch({type:"clear"})},()=>e.s("basic-calculator-button-controlbar-clear")),false:()=>Gi.createElement(_o,{command:this.const("clearall"),disabled:()=>!e.canClear(),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-clear-all"),onTap:()=>e.dispatch({type:"set-blank",opts:{allowUndo:!0}})},()=>e.s("basic-calculator-button-controlbar-clear-all"))}),Gi.createElement(AR,{predicate:()=>this.props.controller().getSettingsMenu()},()=>Gi.createElement(hx,{controller:this.props.controller})))}},vl=__dcg_shared_module_exports__.e(ne()),gx=__dcg_shared_module_exports__.e(ne()),M1=class extends nr{template(){return gx.createElement(Or,{controller:this.props.controller},gx.createElement($e,null,I(this,"A"),I(this,"B"),I(this,"C"),I(this,"D"),I(this,"E"),I(this,"F"),I(this,"G"),I(this,"H"),I(this,"I"),I(this,"J")),gx.createElement($e,null,I(this,"K"),I(this,"L"),I(this,"M"),I(this,"N"),I(this,"O"),I(this,"P"),I(this,"Q"),I(this,"R"),I(this,"S"),I(this,"T")),gx.createElement($e,null,I(this,"=",{style:"highlight"}),I(this,","),I(this,"U"),I(this,"V"),I(this,"W"),I(this,"X"),I(this,"Y"),I(this,"Z"),I(this,"pi"),I(this,"backspace",{style:"highlight"})),gx.createElement($e,null,I(this,"shift",{style:"highlight",colspan:2}),I(this,"("),I(this,")"),I(this,"["),I(this,"]"),I(this,"!"),I(this,"'"),I(this,"enter",{style:"blue",colspan:2})))}},Uc=__dcg_shared_module_exports__.e(ne()),G1=class extends nr{template(){return Uc.createElement(Or,{controller:this.props.controller},Uc.createElement($e,null,I(this,"Q"),I(this,"W"),I(this,"E"),I(this,"R"),I(this,"T"),I(this,"Y"),I(this,"U"),I(this,"I"),I(this,"O"),I(this,"P")),Uc.createElement($e,null,Uc.createElement("div",{class:Uc.const("dcg-half-width-placeholder")}),I(this,"A"),I(this,"S"),I(this,"D"),I(this,"F"),I(this,"G"),I(this,"H"),I(this,"J"),I(this,"K"),I(this,"L"),Uc.createElement("div",{class:Uc.const("dcg-half-width-placeholder")})),Uc.createElement($e,null,I(this,"=",{style:"highlight"}),I(this,"Z"),I(this,"X"),I(this,"C"),I(this,"V"),I(this,"B"),I(this,"N"),I(this,"M"),I(this,","),I(this,"backspace",{style:"highlight"})),Uc.createElement($e,null,I(this,"shift",{style:"highlight",colspan:1.5}),I(this,"("),I(this,")"),I(this,"["),I(this,"]"),I(this,"!"),I(this,"'"),I(this,"pi"),I(this,"enter",{style:"blue",colspan:1.5})))}},Fn=__dcg_shared_module_exports__.e(ne()),{IfElse:Lpe}=Fn.Components,L1=class extends nr{template(){return Fn.createElement("div",{class:Fn.const("dcg-sci-func-keypad")},Fn.createElement(Or,{controller:this.props.controller},Fn.createElement($e,null,I(this,"sin"),I(this,"cos"),I(this,"tan"),Fn.createElement("div",{class:Fn.const("dcg-partition-placeholder")}),I(this,"a^b"),I(this,"sqrt"),I(this,"nthroot")),Fn.createElement($e,null,I(this,"arcsin"),I(this,"arccos"),I(this,"arctan"),Fn.createElement("div",{class:Fn.const("dcg-partition-placeholder")}),I(this,"e^x"),I(this,"abs"),Lpe(()=>this.controller.getReplaceRoundWithReciprocal(),{true:()=>I(this,"a^{-1}"),false:()=>I(this,"round")})),Fn.createElement($e,null,I(this,"mean"),I(this,"stdev"),I(this,"stdevp"),Fn.createElement("div",{class:Fn.const("dcg-partition-placeholder")}),I(this,"ln"),I(this,"log"),I(this,"backspace",{style:"highlight"})),Fn.createElement($e,null,I(this,"nPr"),I(this,"nCr"),I(this,"!"),Fn.createElement("div",{class:Fn.const("dcg-partition-placeholder")}),I(this,"e"),I(this,"pi"),I(this,"enter",{style:"blue"}))))}},Nn=__dcg_shared_module_exports__.e(ne()),{IfElse:Ppe}=Nn.Components,P1=class extends nr{template(){return Nn.createElement("div",{class:Nn.const("dcg-sci-func-keypad dcg-sci-func-keypad--complex")},Nn.createElement(Or,{controller:this.props.controller},Nn.createElement($e,null,I(this,"sin"),I(this,"cos"),I(this,"tan"),Nn.createElement("div",{class:Nn.const("dcg-partition-placeholder")}),I(this,"%"),I(this,"pi"),I(this,"e"),I(this,"e^x")),Nn.createElement($e,null,I(this,"arcsin"),I(this,"arccos"),I(this,"arctan"),Nn.createElement("div",{class:Nn.const("dcg-partition-placeholder")}),I(this,"real"),I(this,"imag"),I(this,"conj"),I(this,"arg")),Nn.createElement($e,null,I(this,"mean"),I(this,"stdev"),I(this,"stdevp"),Nn.createElement("div",{class:Nn.const("dcg-partition-placeholder")}),I(this,"ln"),I(this,"log"),I(this,"sqrt"),I(this,"backspace",{style:"highlight"})),Nn.createElement($e,null,I(this,"nPr"),I(this,"nCr"),I(this,"!"),Nn.createElement("div",{class:Nn.const("dcg-partition-placeholder")}),I(this,"abs"),Ppe(()=>this.controller.getReplaceRoundWithReciprocal(),{true:()=>I(this,"a^{-1}"),false:()=>I(this,"round")}),I(this,"nthroot"),I(this,"enter",{style:"blue"}))))}},ai=__dcg_shared_module_exports__.e(ne()),{IfElse:Gj}=ai.Components,V1=class extends nr{template(){return ai.createElement(Or,{controller:this.props.controller},ai.createElement($e,null,I(this,"a^2"),I(this,"a^b"),I(this,"|a|"),ai.createElement("div",{class:ai.const("dcg-partition-placeholder")}),I(this,"7",{style:"highlight"}),I(this,"8",{style:"highlight"}),I(this,"9",{style:"highlight"}),I(this,"division"),ai.createElement("div",{class:ai.const("dcg-partition-placeholder")}),Gj(()=>{var e,t;return(t=(e=this.controller).isComplexModeEnabled)==null?void 0:t.call(e)},{true:()=>I(this,"i"),false:()=>I(this,"%")}),I(this,"a/b")),ai.createElement($e,null,I(this,"sqrt"),I(this,"nthroot"),I(this,"pi"),ai.createElement("div",{class:ai.const("dcg-partition-placeholder")}),I(this,"4",{style:"highlight"}),I(this,"5",{style:"highlight"}),I(this,"6",{style:"highlight"}),I(this,"multiplication"),ai.createElement("div",{class:ai.const("dcg-partition-placeholder")}),I(this,"left",{style:"highlight"}),I(this,"right",{style:"highlight"})),ai.createElement($e,null,I(this,"sin"),I(this,"cos"),I(this,"tan"),ai.createElement("div",{class:ai.const("dcg-partition-placeholder")}),I(this,"1",{style:"highlight"}),I(this,"2",{style:"highlight"}),I(this,"3",{style:"highlight"}),I(this,"-"),ai.createElement("div",{class:ai.const("dcg-partition-placeholder")}),to(.5),I(this,"backspace",{style:"highlight",colspan:1.5})),ai.createElement($e,null,I(this,"("),I(this,")"),Gj(()=>this.controller.getReplaceCommaWith10Exp(),{true:()=>I(this,"10^n"),false:()=>I(this,",")}),ai.createElement("div",{class:ai.const("dcg-partition-placeholder")}),I(this,"0",{style:"highlight"}),I(this,".",{style:"highlight"}),I(this,"ans"),I(this,"+"),ai.createElement("div",{class:ai.const("dcg-partition-placeholder")}),I(this,"enter",{style:"blue",colspan:2})))}},mx=__dcg_shared_module_exports__.e(ne()),O1=class extends nr{template(){return mx.createElement(Or,{controller:this.props.controller},mx.createElement($e,null,I(this,"a"),I(this,"b"),I(this,"c"),I(this,"d"),I(this,"e"),I(this,"f"),I(this,"g"),I(this,"h"),I(this,"i"),I(this,"j")),mx.createElement($e,null,I(this,"k"),I(this,"l"),I(this,"m"),I(this,"n"),I(this,"o"),I(this,"p"),I(this,"q"),I(this,"r"),I(this,"s"),I(this,"t")),mx.createElement($e,null,I(this,"=",{style:"highlight"}),I(this,","),I(this,"u"),I(this,"v"),I(this,"w"),I(this,"x"),I(this,"y"),I(this,"z"),I(this,"pi"),I(this,"backspace",{style:"highlight"})),mx.createElement($e,null,I(this,"shift",{style:"highlight",colspan:2}),I(this,"("),I(this,")"),I(this,"["),I(this,"]"),I(this,"!"),I(this,"'"),I(this,"enter",{style:"blue",colspan:2})))}},zc=__dcg_shared_module_exports__.e(ne()),R1=class extends nr{template(){return zc.createElement(Or,{controller:this.props.controller},zc.createElement($e,null,I(this,"q"),I(this,"w"),I(this,"e"),I(this,"r"),I(this,"t"),I(this,"y"),I(this,"u"),I(this,"i"),I(this,"o"),I(this,"p")),zc.createElement($e,null,zc.createElement("div",{class:zc.const("dcg-half-width-placeholder")}),I(this,"a"),I(this,"s"),I(this,"d"),I(this,"f"),I(this,"g"),I(this,"h"),I(this,"j"),I(this,"k"),I(this,"l"),zc.createElement("div",{class:zc.const("dcg-half-width-placeholder")})),zc.createElement($e,null,I(this,"=",{style:"highlight"}),I(this,"z"),I(this,"x"),I(this,"c"),I(this,"v"),I(this,"b"),I(this,"n"),I(this,"m"),I(this,","),I(this,"backspace",{style:"highlight"})),zc.createElement($e,null,I(this,"shift",{style:"highlight",colspan:1.5}),I(this,"("),I(this,")"),I(this,"["),I(this,"]"),I(this,"!"),I(this,"'"),I(this,"pi"),I(this,"enter",{style:"blue",colspan:1.5})))}},{SwitchUnion:Vpe,IfElse:Ope}=vl.Components,F1=class extends nr{template(){return vl.createElement("div",{role:vl.const("region"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},Vpe(()=>this.controller.getKeyboardMode(),{qwerty:()=>vl.createElement(R1,{controller:this.props.controller}),letters:()=>vl.createElement(O1,{controller:this.props.controller}),capitalQwerty:()=>vl.createElement(G1,{controller:this.props.controller}),capitalLetters:()=>vl.createElement(M1,{controller:this.props.controller}),functions:()=>Ope(()=>this.controller.isComplexModeEnabled(),{true:()=>vl.createElement(P1,{controller:this.props.controller}),false:()=>vl.createElement(L1,{controller:this.props.controller})}),main:()=>vl.createElement(V1,{controller:this.props.controller})}))}},yi=__dcg_shared_module_exports__.e(ne()),{If:SA}=yi.Components,EA=class extends nr{template(){let e=this.props.controller();return yi.createElement(Bc,{controller:this.props.controller},yi.createElement(SA,{predicate:()=>!this.controller.getRestrictedEditing()},()=>yi.createElement(_o,{command:this.const("undo"),disabled:()=>!e.canUndo(),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-undo"),onTap:t=>e.dispatch({type:"undo",source:t.device==="keyboard"?"button-keyboard":"button-tap"})},yi.createElement("i",{class:yi.const("dcg-icon-undo"),"aria-hidden":yi.const("true")}))),yi.createElement(SA,{predicate:()=>!this.controller.getRestrictedEditing()},()=>yi.createElement(_o,{command:this.const("redo"),disabled:()=>!e.canRedo(),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-redo"),onTap:t=>e.dispatch({type:"redo",source:t.device==="keyboard"?"button-keyboard":"button-tap"})},yi.createElement("i",{class:yi.const("dcg-icon-redo"),"aria-hidden":yi.const("true")}))),yi.createElement(_o,{command:this.const("clear"),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-clear"),onTap:()=>e.dispatch({type:"clear"})},()=>e.s("basic-calculator-button-controlbar-clear")),yi.createElement(SA,{predicate:()=>this.controller.getRestrictedEditing()},()=>yi.createElement("div",{class:yi.const("dcg-spacer-2")})),yi.createElement(SA,{predicate:()=>e.getBrailleMode()==="none"},()=>yi.createElement(_o,{command:this.const("backspace"),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-backspace"),disabled:()=>!e.canBackspace(),onTap:()=>e.dispatch({type:"keypad/press-key",key:"Backspace",source:"keypad"})},yi.createElement("i",{class:yi.const("dcg-icon-delete"),"aria-hidden":yi.const("true")}))))}},Xd=__dcg_shared_module_exports__.e(ne()),N1=class extends nr{template(){return Xd.createElement("div",{role:Xd.const("region"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},Xd.createElement(Or,{controller:this.props.controller},Xd.createElement($e,null,I(this,"(",{colspan:this.parenColspan()}),I(this,")",{colspan:this.parenColspan()}),this.makeAdditionalFunctionKey(1)),Xd.createElement($e,null,I(this,"7",{style:"highlight"}),I(this,"8",{style:"highlight"}),I(this,"9",{style:"highlight"}),I(this,"division")),Xd.createElement($e,null,I(this,"4",{style:"highlight"}),I(this,"5",{style:"highlight"}),I(this,"6",{style:"highlight"}),I(this,"multiplication")),Xd.createElement($e,null,I(this,"1",{style:"highlight"}),I(this,"2",{style:"highlight"}),I(this,"3",{style:"highlight"}),I(this,"-")),Xd.createElement($e,null,I(this,"0",{style:"highlight"}),I(this,".",{style:"highlight",colspan:this.dotColspan()}),this.makeAdditionalFunctionKey(0),I(this,"+"))))}parenColspan(){return this.controller.getAdditionalFunctions().length===2?1.5:2}dotColspan(){return this.controller.getAdditionalFunctions().length?1:2}makeAdditionalFunctionKey(e){let t=this.controller.getAdditionalFunctions()[e];return t==="exponent"?I(this,"a^b"):t==="percent"?I(this,"%"):t==="sqrt"?I(this,"sqrt"):void 0}},si=__dcg_shared_module_exports__.e(ne()),{If:Lj}=si.Components,TA=class extends nr{template(){let e=this.props.controller();return si.createElement(Bc,{controller:this.props.controller},si.createElement(rc,{setup:this.const({type:"basic",controller:this.controller})}),si.createElement("div",{class:si.const("dcg-spacer")}),si.createElement(Lj,{predicate:()=>!this.controller.getRestrictedEditing()},()=>si.createElement(_o,{command:this.const("undo"),disabled:()=>!e.canUndo(),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-undo"),onTap:t=>e.dispatch({type:"undo",source:t.device==="keyboard"?"button-keyboard":"button-tap"})},si.createElement("i",{class:si.const("dcg-icon-undo"),"aria-hidden":si.const("true")}))),si.createElement(Lj,{predicate:()=>!this.controller.getRestrictedEditing()},()=>si.createElement(_o,{command:this.const("redo"),disabled:()=>!e.canRedo(),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-redo"),onTap:t=>e.dispatch({type:"redo",source:t.device==="keyboard"?"button-keyboard":"button-tap"})},si.createElement("i",{class:si.const("dcg-icon-redo"),"aria-hidden":si.const("true")}))),si.createElement("div",{class:si.const("dcg-spacer")}),si.createElement(_o,{narrowButton:this.const(!0),command:this.const("clear"),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-clear"),onTap:()=>e.dispatch({type:"clear"})},()=>e.s("basic-calculator-button-controlbar-clear")),si.createElement(_o,{narrowButton:this.const(!0),command:this.const("backspace"),ariaLabel:()=>e.s("basic-calculator-narration-controlbar-backspace"),onTap:()=>e.dispatch({type:"keypad/press-key",key:"Backspace",source:"keypad"})},si.createElement("i",{class:si.const("dcg-icon-delete"),"aria-hidden":si.const("true")})))}},ia=__dcg_shared_module_exports__.e(ne()),B1=class extends nr{template(){return ia.createElement(Or,{controller:this.props.controller},ia.createElement($e,null,I(this,"("),I(this,")"),I(this,"x^2"),I(this,"sqrt"),ia.createElement("div",{class:ia.const("dcg-partition-placeholder")}),I(this,"x^3"),I(this,"x^y"),I(this,"ythroot")),ia.createElement($e,null,I(this,"7",{style:"highlight"}),I(this,"8",{style:"highlight"}),I(this,"9",{style:"highlight"}),I(this,"division"),ia.createElement("div",{class:ia.const("dcg-partition-placeholder")}),I(this,"pi"),I(this,"e^x"),I(this,"!")),ia.createElement($e,null,I(this,"4",{style:"highlight"}),I(this,"5",{style:"highlight"}),I(this,"6",{style:"highlight"}),I(this,"multiplication"),ia.createElement("div",{class:ia.const("dcg-partition-placeholder")}),I(this,"log"),I(this,"ln"),I(this,"|x|")),ia.createElement($e,null,I(this,"1",{style:"highlight"}),I(this,"2",{style:"highlight"}),I(this,"3",{style:"highlight"}),I(this,"-"),ia.createElement("div",{class:ia.const("dcg-partition-placeholder")}),I(this,"sin"),I(this,"cos"),I(this,"tan")),ia.createElement($e,null,I(this,"0",{style:"highlight"}),I(this,".",{style:"highlight"}),I(this,"x/y"),I(this,"+"),ia.createElement("div",{class:ia.const("dcg-partition-placeholder")}),I(this,"arcsin"),I(this,"arccos"),I(this,"arctan")))}},{If:U1,IfElse:DA}=yr.Components,z1=class extends nr{template(){return yr.createElement(U1,{predicate:()=>this.controller.shouldRender()},()=>yr.createElement("div",{class:this.const(cf),style:yr.const("width: 100%; height: 100%; position: relative;")},yr.createElement("div",{class:()=>({"dcg-calc-basic-main-wrapper":!0,"dcg-narrow":this.controller.containerSize.width<570,"dcg-narrower":this.controller.containerSize.width<380,"dcg-short":this.controller.containerSize.height<=540,"dcg-scientific-calculator":this.controller.isScientificCalc(),"dcg-four-function-calculator":this.controller.isFourFunctionCalc(),"dcg-container":!0}),onKeyDown:this.bindFn(this.handleRootKeydown),didMount:this.bindFn(this.didMountRoot),"x-ms-format-detection":yr.const("none"),style:()=>({"--dcg-custom-background-color":this.controller.hasBackgroundColor()?this.controller.getBackgroundColor():void 0,"--dcg-custom-text-color":this.controller.hasTextColor()?this.controller.getTextColor():void 0})},yr.createElement("div",{role:yr.const("application"),"aria-label":()=>this.controller.isScientificCalc()?this.controller.s("basic-calculator-narration-calc-description-scientific"):this.controller.isFourFunctionCalc()?this.controller.s("basic-calculator-narration-calc-description-fourfunction"):"",class:()=>({"dcg-calc-basic-main":!0,"dcg-inverted-colors":this.controller.getInvertedColors(),"dcg-projector-mode":this.controller.isProjectorMode(),"dcg-ipad":tl,"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-no-hyperlinks":!this.controller.getAllowLinks()}),style:()=>({"font-size":`${this.controller.getFontSize()}px`,filter:this.controller.getInvertedColors()?"invert(100%)":"none"})},yr.createElement(D1,{controller:this.props.controller}),yr.createElement(U1,{predicate:()=>this.controller.isScientificCalc()&&this.model.isSingleExpression()},()=>yr.createElement("div",null,yr.createElement(TA,{controller:this.props.controller}),yr.createElement("div",{class:yr.const("dcg-basic-keypad-container")},DA(()=>this.controller.renderAsBraille(),{true:()=>yr.createElement(Gm,{controller:this.props.controller}),false:()=>yr.createElement(B1,{controller:this.props.controller})})))),yr.createElement(U1,{predicate:()=>this.controller.isScientificCalc()&&!this.model.isSingleExpression()},()=>yr.createElement("div",null,yr.createElement(CA,{controller:this.props.controller}),yr.createElement("div",{class:yr.const("dcg-basic-keypad-container")},DA(()=>this.controller.renderAsBraille(),{true:()=>yr.createElement(Gm,{controller:this.props.controller}),false:()=>yr.createElement(F1,{controller:this.props.controller})})))),yr.createElement(U1,{predicate:()=>this.controller.isFourFunctionCalc()&&this.model.isSingleExpression()},()=>yr.createElement("div",null,yr.createElement(EA,{controller:this.props.controller}),yr.createElement("div",{class:yr.const("dcg-basic-keypad-container")},DA(()=>this.controller.renderAsBraille(),{true:()=>yr.createElement(Gm,{controller:this.props.controller}),false:()=>yr.createElement(N1,{controller:this.props.controller})})))),yr.createElement(U1,{predicate:()=>this.controller.isFourFunctionCalc()&&!this.model.isSingleExpression()},()=>yr.createElement("div",null,yr.createElement(vA,{controller:this.props.controller}),yr.createElement("div",{class:yr.const("dcg-basic-keypad-container")},DA(()=>this.controller.renderAsBraille(),{true:()=>yr.createElement(Gm,{controller:this.props.controller}),false:()=>yr.createElement(A1,{controller:this.props.controller})}))))))))}didMountRoot(e){nw(e)}handleRootKeydown(e){let t=Ko(e),r=this.controller.model;if(Zx(e))return this.dispatch({type:"undo",source:"keyboard-shortcut"}),!1;if(ew(e))return this.dispatch({type:"redo",source:"keyboard-shortcut"}),!1;if(e.altKey!==Zo&&e.metaKey===Zo&&!e.ctrlKey&&e.shiftKey&&t==="A"&&this.controller.getDecimalToFraction()){let n=r.getFocusedExpression();n&&r.canDisplayEvaluationAsFraction(n.id)&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"toggle-fraction-evaluation",id:n.id}),this.controller.runAfterDispatch(()=>{r.getFocusedExpression().displayAsFraction?xe(this.controller.s("shared-calculator-narration-show-as-fraction")):xe(this.controller.s("shared-calculator-narration-show-as-decimal"))}))}else if(!e.metaKey&&!e.shiftKey){if(!e.ctrlKey&&!e.altKey&&ke(e)===_u){if(!document.activeElement||wp(document.activeElement))return!1}else if(e.ctrlKey===Zo&&e.altKey===!Zo){if(t==="N")return this.controller.getBrailleControls()?(this.dispatch({type:"set-braille-mode",mode:"nemeth"}),xe(this.controller.s("shared-calculator-narration-hotkey-braille-mode-nemeth")),!1):void 0;if(t==="U")return this.controller.getBrailleControls()?(this.dispatch({type:"set-braille-mode",mode:"ueb"}),xe(this.controller.s("shared-calculator-narration-hotkey-braille-mode-ueb")),!1):void 0;if(t==="Q"||t==="X")return this.controller.getBrailleControls()?(this.dispatch({type:"set-braille-mode",mode:"none"}),xe(this.controller.s("shared-calculator-narration-hotkey-braille-mode-off")),!1):void 0;if(t==="6"){if(!this.controller.getBrailleControls())return;let n=!this.controller.getSixKeyInput();return this.dispatch({type:"set-six-key-input",useSixKeyInput:n}),xe(n?this.controller.s("basic-calculator-narration-hotkey-six-key-input-on"):this.controller.s("basic-calculator-narration-hotkey-six-key-input-off")),!1}else if(t==="D")return this.controller.isScientificCalc()?(e.preventDefault(),this.controller.dispatch({type:"degrees"}),xe(r.getDegreeMode()?this.controller.s("basic-calculator-narration-controlbar-degrees"):this.controller.s("basic-calculator-narration-controlbar-radians")),!1):void 0}}return!0}},bx=__dcg_shared_module_exports__.e(ne()),q1=class{constructor(e){if(this.eventModel=new Kl,this.rootElt=e,!e)throw new Error("must pass an HTMLElement to the API")}setupDomChangeDetector(e){this.autoSize=e,mI(this.rootElt),this.domChangeDetector=new Yg(this.rootElt,t=>{switch(t.type){case"added":this.view=this.onCreateView(),this.onResizeView(t.size);break;case"removed":this.onDestroyView(),this.view=void 0;break;case"resized":this.onResizeView(t.size);break}}),this.autoSize!==!1?this.domChangeDetector.startWatching():this.domChangeDetector.checkForChanges()}detach(){__dcg_shared_module_exports__.qe.warn(".detach() is deprecated. It should no longer be necessary")}destroy(){this.view&&this.onDestroyView(),this.domChangeDetector.destroy();function e(n){__dcg_shared_module_exports__.qe.warn("You've destroyed this API instance. You can no longer call ."+n+"()")}let t={},r=this;for(;r;)Object.getOwnPropertyNames(r).forEach(n=>t[n]=!0),r=Object.getPrototypeOf(r);for(let n in t)typeof this[n]=="function"?this[n]=e.bind(this,n):this.hasOwnProperty(n)&&delete this[n];this.destroy=function(){}}resize(){this.domChangeDetector.checkForChanges()}updateView(){this.view&&document.body&&document.body.contains(this.rootElt)&&this.view.update()}triggerEvent(e,t){this.eventModel.triggerEvent(e,t)}observeEvent(e,t){this.eventModel.observeEvent(e,t)}unobserveEvent(e){this.eventModel.unobserveEvent(e)}},Rpe={allowComplex:!0,autosize:!0,backgroundColor:"#fff",brailleControls:!0,brailleExpressionDownload:!0,brailleMode:"none",capExpressionSize:!1,complex:!1,decimalToFraction:!0,degreeMode:!1,functionDefinition:!0,invertedColors:!1,language:"en",links:!0,projectorMode:!1,qwertyKeyboard:!0,replaceCommaWith10Exp:!1,replaceRoundWithReciprocal:!1,settingsMenu:!0,sixKeyInput:!1,textColor:"#000"},Fpe={additionalFunctions:["sqrt"],disableParentheses:!1,evaluationMode:"scientific",restrictedEditing:!1,typingAsteriskWritesTimesSymbol:!1,typingSlashWritesDivisionSymbol:!1},Npe=["allowComplex","backgroundColor","brailleControls","brailleExpressionDownload","brailleMode","capExpressionSize","complex","decimalToFraction","degreeMode","functionDefinition","invertedColors","language","links","projectorMode","qwertyKeyboard","replaceCommaWith10Exp","replaceRoundWithReciprocal","settingsMenu","sixKeyInput","textColor","restrictedEditing","typingAsteriskWritesTimesSymbol","fontSize"];GB();var fx=class extends q1{constructor(e){super(e)}init(e){e=__dcg_shared_module_exports__.Jc(e),e.backgroundColor&&!__dcg_shared_module_exports__.Jd(e.backgroundColor)&&(__dcg_shared_module_exports__.qe.warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)"),delete e.backgroundColor),e.textColor&&!__dcg_shared_module_exports__.Jd(e.textColor)&&(__dcg_shared_module_exports__.qe.warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)"),delete e.textColor),e.allowComplex||(e.complex&&__dcg_shared_module_exports__.qe.warn("complex: true is not compatible with allowComplex: false. Forcing complex: false"),delete e.complex),e.complex&&e.degreeMode&&(__dcg_shared_module_exports__.qe.warn("degreeMode: true is not compatible with complex: true. Forcing degreeMode: false"),delete e.degreeMode);let t=R(R(R({},Fpe),Rpe),e);this.settings=new cs;let r={workerPool:cx,settingsProxy:this.settings};this.controller=new E1(t,r),this.controller.onEventEmitted=n=>{n==="render"&&this.updateView(),this.triggerEvent(n,void 0)},this.setupDomChangeDetector(t.autosize)}onCreateView(){return bx.mountToNode(z1,this.rootElt,{controller:bx.const(this.controller)})}setState(e,t){t||(t={}),!this.controller.isComplexModeAllowed()&&e.settings.complex&&(e=ie(R({},e),{settings:ie(R({},e.settings),{complex:!1})})),this.controller.dispatch({type:"set-state-from-api",state:e,opts:{allowUndo:!!t.allowUndo}})}getState(){return __dcg_shared_module_exports__.Jc(this.controller.model.getPersistedState())}undo(){this.controller.dispatch({type:"undo",source:"api"})}redo(){this.controller.dispatch({type:"redo",source:"api"})}clearHistory(){this.controller.dispatch({type:"clear-history"})}setBlank(e){e||(e={}),this.controller.dispatch({type:"set-blank",opts:{allowUndo:!!e.allowUndo}})}updateSettings(e){e=__dcg_shared_module_exports__.Jc(e),(!e.allowComplex&&!this.controller.isComplexModeAllowed()||this.controller.getEvaluationMode()!=="scientific")&&(delete e.complex,delete e.allowComplex);for(let t of Npe)if(t in e)switch(t){case"fontSize":let r=e[t];if(r===void 0)continue;this.controller.dispatch({type:"update-font-size",size:r});break;case"invertedColors":let n=e[t];if(n===void 0)continue;this.controller.dispatch({type:"update-inverted-colors",mode:n});break;case"backgroundColor":let i=e[t];if(i===void 0||!__dcg_shared_module_exports__.Jd(i)){__dcg_shared_module_exports__.qe.warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)");continue}this.controller.dispatch({type:"update-background-color",color:i});break;case"textColor":let o=e[t];if(o===void 0||!__dcg_shared_module_exports__.Jd(o)){__dcg_shared_module_exports__.qe.warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)");continue}this.controller.dispatch({type:"update-text-color",color:o});break;case"degreeMode":let a=e[t];if(a===void 0)continue;this.controller.dispatch({type:"update-degree-mode",mode:a});break;case"brailleMode":let s=e[t];this.controller.dispatch({type:"set-braille-mode",mode:s});break;case"sixKeyInput":let l=e[t];if(l===void 0)continue;this.controller.dispatch({type:"set-six-key-input",useSixKeyInput:l});break;case"brailleControls":{let _=e[t];if(_===void 0)continue;this.controller.dispatch({type:"set-braille-controls",value:_});break}case"brailleExpressionDownload":let c=e[t];if(c===void 0)continue;this.controller.dispatch({type:"set-braille-expression-download",mode:c});break;case"projectorMode":let d=e[t];if(d===void 0)continue;this.controller.dispatch({type:"update-projector-mode",mode:d});break;case"capExpressionSize":let u=e[t];if(u===void 0)continue;this.controller.dispatch({type:"update-cap-expression-size",mode:u});break;case"language":let p=e[t];if(p===void 0)continue;this.controller.dispatch({type:"update-language",language:Ld(p)});break;case"settingsMenu":e.settingsMenu?this.controller.dispatch({type:"enable-settings-menu"}):this.controller.dispatch({type:"disable-settings-menu"});break;case"qwertyKeyboard":{this.controller.dispatch({type:"update-options",options:{qwertyKeyboard:!!e.qwertyKeyboard}});let _=this.controller.getKeyboardMode();(_==="qwerty"||_==="letters")&&this.controller.dispatch({type:"ABC"})}break;case"functionDefinition":e.functionDefinition?this.controller.model.enableFunctionDefinition():this.controller.model.disableFunctionDefinition();break;case"links":this.controller.dispatch({type:"update-options",options:{links:!!e.links}});break;case"decimalToFraction":let g=e[t];if(g===void 0)continue;this.controller.dispatch({type:"update-decimal-to-fraction",mode:g});break;case"replaceCommaWith10Exp":let f=e[t];if(f===void 0)continue;this.controller.dispatch({type:"set-replace-comma-with-10-exp",replace:f});break;case"replaceRoundWithReciprocal":let y=e[t];if(y===void 0)continue;this.controller.dispatch({type:"set-replace-round-with-reciprocal",replace:y});break;case"restrictedEditing":{this.controller.dispatch({type:"update-options",options:{restrictedEditing:!!e.restrictedEditing}});break}case"typingAsteriskWritesTimesSymbol":let E=e[t];if(E===void 0)continue;this.controller.dispatch({type:"set-typing-asterisk-writes-times-symbol",mode:E});break;case"allowComplex":this.controller.dispatch({type:"toggle-complex-allowed",enabled:!!e[t]});break;case"complex":this.controller.dispatch({type:"toggle-complex-mode",enabled:!!e[t]});break;default:console.warn(`Unsupported setting: ${t}`);break}}focusFirstExpression(){this.controller.dispatch({type:"focus-first-expression"})}onResizeView(e){this.controller.dispatch({type:"ui/container-resized",size:e})}onDestroyView(){bx.unmountFromNode(this.rootElt)}destroy(){this.controller.model.destroy(),super.destroy()}},yx=class extends fx{constructor(e,t){super(e),this.init(Bpe(t||{}))}};function Bpe(e){if(e=__dcg_shared_module_exports__.Jc(e),e.hasOwnProperty("typingSlashWritesDivisionSymbol")||(e.typingSlashWritesDivisionSymbol=!0),e.hasOwnProperty("typingAsteriskWritesTimesSymbol")||(e.typingAsteriskWritesTimesSymbol=!0),e.exponentButtonForSquareRoot&&(__dcg_shared_module_exports__.qe.warn(`As of API version 1.0, the 'exponentButtonForSquareRoot' option is deprecated.Use 'additionalFunctions: "exponent"' instead.`),e.additionalFunctions=["exponent"]),e.additionalFunctions){let t=e.additionalFunctions;typeof t=="string"&&(t=[t]),t.length>2&&(__dcg_shared_module_exports__.qe.warn("additionalFunctions can only take up to 2 new functions. Using the first two."),t=t.slice(0,2));let r=!0;for(let n=0;n<t.length;n++)["sqrt","exponent","percent","fraction"].indexOf(t[n])===-1&&(__dcg_shared_module_exports__.qe.warn("Unrecognized value: '"+t[n]+`' for 'additionalFunction'. Valid values are 'sqrt', 'percent', 'exponent', or 'fraction'. Using default ("sqrt")`),r=!1);e.additionalFunctions=r?t:["sqrt"]}return(!e.additionalFunctions||!e.additionalFunctions.length)&&(e.additionalFunctions=["sqrt"]),e.singleExpression?(e.evaluationMode="singleExpressionFourFunction",e.disableParentheses&&(delete e.disableParentheses,__dcg_shared_module_exports__.qe.warn("Incompatible options: singleExpression can't be used in combination with disableParentheses. Ignoring disableParentheses."))):e.evaluationMode="fourFunction",delete e.singleExpression,e.hasOwnProperty("decimalToFraction")||(e.decimalToFraction=!1),e.language&&(e.language=Ld(e.language)),delete e.allowComplex,delete e.complex,e}var xx=class extends lu{constructor(e,t,r){super(e,ie(R({},t),{allowComplex:!1,product:"geometry-calculator"}),r),this.setState(nf),this.clearHistory()}},wx=class extends lu{constructor(e,t,r){super(e,ie(R({},t),{product:"graphing"}),r)}},kA=class{constructor(e,t){let r=new Bp;for(let o in t)r.config.setProperty(o,t[o]);this.controller=new Im(r);let n=new Nh(e);this.controller.setEvaluator(n),n.readEvaluatorConfig=()=>({product:this.controller.getGraphSettings().config.product,beta3d:t.beta3d,evaluationMode:this.controller.isGeometry()?"geometry":"graphing",globalRandomSeed:r.randomSeed,includeFunctionParametersInRandomSeed:r.includeFunctionParametersInRandomSeed,degreeMode:r.degreeMode,restrictedFunctions:r.config.restrictedFunctions,distributions:r.config.distributions,pointsOfInterest:r.config.pointsOfInterest,plotSingleVariableImplicitEquations:r.config.plotSingleVariableImplicitEquations,plotImplicits:r.config.plotImplicits,plotInequalities:r.config.plotInequalities,sliders:r.config.sliders,actions:r.config.actions,recursion:!!r.config.recursion}),n.onEvaluatorResults=o=>{this.controller.dispatch({type:"on-evaluator-changes",changes:o.evaluationStates,timingData:o.timingData,eventUpdates:o.eventUpdates,dependencyOrder:o.dependencyOrder})};let i=new cs({pixelCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0},mathCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0}});this.graphpaperBounds=i,this.evaluator=n,this.setBlank()}setBlank(e){this.controller.dispatch({type:"set-blank",opts:e})}tick(){this.evaluator.tick()}destroy(){this.evaluator.destroy()}},vx=class{constructor(e){this._calc=new kA(cx,DD(R({},e))),this.controller=this._calc.controller,this._sharedClockBusToken=Am(()=>{this._calc.tick()})}destroy(){this._calc.destroy(),Mm(this._sharedClockBusToken);function e(n){__dcg_shared_module_exports__.qe.warn("You've destroyed this API instance. You can no longer call ."+n+"()")}let t={},r=this;for(;r;)Object.getOwnPropertyNames(r).forEach(n=>t[n]=!0),r=Object.getPrototypeOf(r);for(let n in t)typeof this[n]=="function"?this[n]=e.bind(this,n):this.hasOwnProperty(n)&&delete this[n];this.destroy=function(){}}setExpression(e){let t=this.controller.getItemModel(e.id),r=t&&t.type,n=uD(e,r,this.controller);if(n)if(r)this.controller.dispatch({type:"set-expression-properties-from-api",id:n.id,properties:n});else{if(n.type==="image")return;this.controller.dispatch({type:"add-item-to-end-from-api",state:n})}}setExpressions(e){e.forEach(this.setExpression.bind(this))}removeExpression(e){let t=e.id.toString();this.controller.dispatch({type:"remove-item-by-id",id:t})}removeExpressions(e){e.forEach(this.removeExpression.bind(this))}getState(e){return this.controller.getState(e)}getExpressions(){return this.getState({stripDefaults:!1}).expressions.list.map(pD)}setBlank(e){this.controller.dispatch({type:"set-blank",opts:e||{}})}setState(e,t){this.controller.dispatch({type:"set-state",state:e,opts:t||{}})}HelperExpression(e){let t=e&&e.latex||"",r=new cs({latex:t});return this.controller.dispatch({type:"add-helper-expression",state:{type:"helper-expression",id:this.controller.generateId(),latex:t,proxy:r}}),r}getHelperExpressions(){return this.controller.getHelperExpressions()}resize(){}},Cx=class extends fx{constructor(e,t){super(e),this.init(Upe(t||{}))}};function Upe(e){return e=__dcg_shared_module_exports__.Jc(e),e.singleExpression?(e.evaluationMode="singleExpressionScientific",delete e.allowComplex,delete e.complex):e.evaluationMode="scientific",delete e.singleExpression,e.language&&(e.language=Ld(e.language)),e}var H1;typeof Desmos!="undefined"?H1=Desmos:(H1={},window.Desmos=H1);var qpe={SMALL:"0.85",MEDIUM:"1",LARGE:"1.35"};function MR(...e){return new wx(...e)}MR.prototype=wx.prototype;function GR(...e){return new xx(...e)}GR.prototype=xx.prototype;function LR(...e){return new vx(...e)}LR.prototype=vx.prototype;function Pj(...e){return new yx(...e)}Pj.prototype=yx.prototype;function Vj(...e){return new Cx(...e)}Vj.prototype=Cx.prototype;function Oj(...e){return new dx(...e)}Oj.prototype=dx.prototype;var _A={Colors:{RED:pE,BLUE:uE,GREEN:hE,ORANGE:mE,PURPLE:gE,BLACK:zf},imageFileToDataURL:cD,supportedLanguages:["en"].concat(typeof desmosLocaleData=="object"?Object.keys(desmosLocaleData):[]),Styles:R(R({},DP),TP),ColumnModes:Sv,DragModes:kP,AxisArrowModes:__dcg_shared_module_exports__.pd,FontSizes:hD,LabelSizes:qpe,LabelOrientations:_P,GraphingCalculator:MR,Calculator:MR,FourFunctionCalculator:Pj,ScientificCalculator:Vj,Geometry:GR,Calculator3D:Oj,Abraham:td,Private:{Abraham:td,Mathtools:sS,Graphtools:{ScalePair:__dcg_shared_module_exports__.jd,getClippingGraphType:Rx,mapSegmentToCanvas:vu,computeDrawingCommandsForDOMLabel:UT,drawCommandsToCtx:zT},MathquillConfig:{getAutoCommands:Pu,getAutoOperators:kG},Parser:__dcg_shared_module_exports__.fe,extractSliderValueFromLatex:dw,__compareBranches:{getSliderMin:nl,getSliderMax:bc,valueTypes:__dcg_shared_module_exports__.rb,migrateGeoStateToCalcState:ug,Mathtools:sS},GeometryBeta:GR,migrateGeoStateToCalcState:ug,HeadlessGraphingCalculator:LR,maybeNotifyUserChangedLatex:Fe.simulateUserChangedLatex,Fragile:{DCGView:zpe,PromptSliderView:Ec,Checkbox:mt,SegmentedControl:vo,MathquillView:Fe,InlineMathInputView:lr,StaticMathquillView:nt,Tooltip:Le,ExpressionOptionsMenuView:ny,ExpressionView:Wg,ImageIconView:$g,evaluateLatex:io,Keys:sr,getReconciledExpressionProps:__dcg_shared_module_exports__.Zc,List:{moveItemsTo:Uu,removeItemById:Ag},currentLanguage:Zw}},TestInternal:{fetchLanguage:e=>qH(e)},MathQuill:gc,HeadlessGraphingCalculator:LR};function K1(e){let t=H1.enabledFeatures;return!t||t[e]}function Sx(e){_A[e]=function(){throw new Error("The Desmos "+e+" is not enabled for this API key.")}}K1("GraphingCalculator")||(Sx("GraphingCalculator"),Sx("Calculator")),K1("FourFunctionCalculator")||Sx("FourFunctionCalculator"),K1("ScientificCalculator")||Sx("ScientificCalculator"),K1("GeometryCalculator")||Sx("Geometry"),K1("Calculator3D")||Sx("Calculator3D");for(let e in _A)_A.hasOwnProperty(e)&&(H1[e]=_A[e]);qt(),typeof Desmos=="undefined"&&(Desmos={});function Rj(){Desmos.$=ee,Desmos.$.noConflict(!0)}typeof Desmos=="undefined"&&(Desmos={}),Rj();/*!
 * jQuery JavaScript Library v3.6.0
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2021-03-02T17:08Z
 *//*!!
 *  Canvas 2 Svg v1.0.19
 *  A low level canvas to SVG converter. Uses a mock canvas context to build an SVG document.
 *
 *  Licensed under the MIT license:
 *  http://www.opensource.org/licenses/mit-license.php
 *
 *  Author:
 *  Kerry Liu
 *
 *  Copyright (c) 2014 Gliffy Inc.
 *
 *  Modifications by Desmos:
 *  - wrapped in AMD pattern
 *  - added ctx.ellipse() method
 *  - fixed image opacity bug
 *  - added ability to add classNames to exported svg elements
 *  - added ability to add named groups
 *  - removed dominant-basline attribute. Editors appear to ignore it. Must solve baseline issues using transformations
 */})()}()})(typeof window!==void 0?window:this||{})})()});export default Hc();
